/*! For license information please see main.09565c50.js.LICENSE.txt */
(()=>{var e={45:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(8587);function i(e,t){if(null==e)return{};var n,i,o=(0,r.A)(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},218:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.Action=void 0;var r=n(2670);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return r.Action}});var i=n(7053),o=n(894);t.initialize=function(){return(0,o.actionWrapper)({group:i.Group.Client,type:r.Action.INITIALIZE})}},579:(e,t,n)=>{"use strict";e.exports=n(2799)},713:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.networkAction=t.persistenceAction=t.unsupportedOperationAction=t.unexpectedAction=t.invalidAction=t.invalidActionType=t.invalidPayload=t.Message=t.fromAction=t.Action=t.permissionAction=t.isErrorEventName=t.throwError=t.invalidOriginAction=t.AppBridgeError=t.AppActionType=void 0;var r=n(8197);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return r.Action}}),Object.defineProperty(t,"fromAction",{enumerable:!0,get:function(){return r.fromAction}});var i,o=n(894),a=n(7053),s=n(8197);function c(e,t,n){var r=t.payload;return(0,o.actionWrapper)({type:e,group:a.Group.Error,payload:{action:t,message:n,type:e,id:r&&r.id?r.id:void 0}})}Object.defineProperty(t,"AppActionType",{enumerable:!0,get:function(){return s.AppActionType}}),Object.defineProperty(t,"AppBridgeError",{enumerable:!0,get:function(){return s.AppBridgeError}}),Object.defineProperty(t,"invalidOriginAction",{enumerable:!0,get:function(){return s.invalidOriginAction}}),Object.defineProperty(t,"throwError",{enumerable:!0,get:function(){return s.throwError}}),Object.defineProperty(t,"isErrorEventName",{enumerable:!0,get:function(){return s.isErrorEventName}}),Object.defineProperty(t,"permissionAction",{enumerable:!0,get:function(){return s.permissionAction}}),function(e){e.MISSING_PAYLOAD="Missing payload",e.INVALID_PAYLOAD_ID="Id in payload is missing or invalid"}(i||(t.Message=i={})),t.invalidPayload=function(e,t){return c(r.Action.INVALID_PAYLOAD,e,t||"The action's payload is missing required properties or has invalid properties")},t.invalidActionType=function(e,t){return(0,o.actionWrapper)({group:a.Group.Error,payload:{action:e,message:t||"The action type is invalid or unsupported",type:r.Action.INVALID_ACTION_TYPE},type:r.Action.INVALID_ACTION_TYPE})},t.invalidAction=function(e,t){return(0,o.actionWrapper)({group:a.Group.Error,payload:{action:e,message:t||"The action's has missing/invalid values for `group`, `type` or `version`",type:r.Action.INVALID_ACTION},type:r.Action.INVALID_ACTION})},t.unexpectedAction=function(e,t){return(0,o.actionWrapper)({group:a.Group.Error,payload:{action:e,message:t||"Action cannot be called at this time",type:r.Action.UNEXPECTED_ACTION},type:r.Action.UNEXPECTED_ACTION})},t.unsupportedOperationAction=function(e,t){return c(r.Action.UNSUPPORTED_OPERATION,e,t||"The action type is unsupported")},t.persistenceAction=function(e,t){return c(r.Action.PERSISTENCE,e,t||"Action cannot be persisted on server")},t.networkAction=function(e,t){return c(r.Action.NETWORK,e,t||"Network error")}},742:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.isUnframed=t.isClient=t.isServer=void 0,t.isServer="undefined"===typeof window,t.isClient=!t.isServer,t.isUnframed=t.isClient&&(null===(r=null===(n=window.navigator)||void 0===n?void 0:n.userAgent)||void 0===r?void 0:r.indexOf("Unframed"))>0},830:(e,t,n)=>{"use strict";n.d(t,{U1:()=>be,zD:()=>Ne,Z0:()=>Le});var r=n(45),i=n(4705),o=n(9379),a=Symbol.for("immer-nothing"),s=Symbol.for("immer-draftable"),c=Symbol.for("immer-state");function l(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var d=Object.getPrototypeOf;function u(e){return!!e&&!!e[c]}function h(e){var t;return!!e&&(f(e)||Array.isArray(e)||!!e[s]||!(null===(t=e.constructor)||void 0===t||!t[s])||E(e)||y(e))}var p=Object.prototype.constructor.toString(),m=new WeakMap;function f(e){if(!e||"object"!==typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!==typeof n)return!1;let r=m.get(n);return void 0===r&&(r=Function.toString.call(n),m.set(n,r)),r===p}function g(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===_(e)){(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,r)=>t(r,n,e))}function _(e){const t=e[c];return t?t.type_:Array.isArray(e)?1:E(e)?2:y(e)?3:0}function v(e,t){return 2===_(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function b(e,t,n){const r=_(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function E(e){return e instanceof Map}function y(e){return e instanceof Set}function S(e){return e.copy_||e.base_}function T(e,t){if(E(e))return new Map(e);if(y(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=f(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[c];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(d(e),t)}{const t=d(e);if(null!==t&&n)return(0,o.A)({},e);const r=Object.create(t);return Object.assign(r,e)}}function C(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return R(e)||u(e)||!h(e)||(_(e)>1&&Object.defineProperties(e,{set:w,add:w,clear:w,delete:w}),Object.freeze(e),t&&Object.values(e).forEach(e=>C(e,!0))),e}var w={value:function(){l(2)}};function R(e){return null===e||"object"!==typeof e||Object.isFrozen(e)}var A,I={};function N(e){const t=I[e];return t||l(0),t}function O(){return A}function P(e,t){t&&(N("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function k(e){D(e),e.drafts_.forEach(L),e.drafts_=null}function D(e){e===A&&(A=e.parent_)}function x(e){return A={drafts_:[],parent_:A,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function L(e){const t=e[c];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function M(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[c].modified_&&(k(t),l(4)),h(e)&&(e=U(t,e),t.parent_||j(t,e)),t.patches_&&N("Patches").generateReplacementPatches_(n[c].base_,e,t.patches_,t.inversePatches_)):e=U(t,n,[]),k(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==a?e:void 0}function U(e,t,n){if(R(t))return t;const r=e.immer_.shouldUseStrictIteration(),i=t[c];if(!i)return g(t,(r,o)=>F(e,i,t,r,o,n),r),t;if(i.scope_!==e)return t;if(!i.modified_)return j(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const t=i.copy_;let o=t,a=!1;3===i.type_&&(o=new Set(t),t.clear(),a=!0),g(o,(r,o)=>F(e,i,t,r,o,n,a),r),j(e,t,!1),n&&e.patches_&&N("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function F(e,t,n,r,i,o,a){if(null==i)return;if("object"!==typeof i&&!a)return;const s=R(i);if(!s||a){if(u(i)){const a=U(e,i,o&&t&&3!==t.type_&&!v(t.assigned_,r)?o.concat(r):void 0);if(b(n,r,a),!u(a))return;e.canAutoFreeze_=!1}else a&&n.add(i);if(h(i)&&!s){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[r]===i&&s)return;U(e,i),t&&t.scope_.parent_||"symbol"===typeof r||!(E(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||j(e,i)}}}function j(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&C(t,n)}var V={get(e,t){if(t===c)return e;const n=S(e);if(!v(n,t))return function(e,t,n){var r;const i=H(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!h(r)?r:r===W(e.base_,t)?(z(e),e.copy_[t]=K(r,e)):r},has:(e,t)=>t in S(e),ownKeys:e=>Reflect.ownKeys(S(e)),set(e,t,n){const r=H(S(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=W(S(e),t),a=null===r||void 0===r?void 0:r[c];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((i=n)===(o=r)?0!==i||1/i===1/o:i!==i&&o!==o)&&(void 0!==n||v(e.base_,t)))return!0;z(e),G(e)}var i,o;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==W(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,z(e),G(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=S(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){l(11)},getPrototypeOf:e=>d(e.base_),setPrototypeOf(){l(12)}},B={};function W(e,t){const n=e[c];return(n?S(n):e)[t]}function H(e,t){if(!(t in e))return;let n=d(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=d(n)}}function G(e){e.modified_||(e.modified_=!0,e.parent_&&G(e.parent_))}function z(e){e.copy_||(e.copy_=T(e.base_,e.scope_.immer_.useStrictShallowCopy_))}g(V,(e,t)=>{B[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),B.deleteProperty=function(e,t){return B.set.call(this,e,t,void 0)},B.set=function(e,t,n){return V.set.call(this,e[0],t,n,e[0])};function K(e,t){const n=E(e)?N("MapSet").proxyMap_(e,t):y(e)?N("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:O(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,o=V;n&&(i=[r],o=B);const{revoke:a,proxy:s}=Proxy.revocable(i,o);return r.draft_=s,r.revoke_=a,s}(e,t);return(t?t.scope_:O()).drafts_.push(n),n}function Y(e){if(!h(e)||R(e))return e;const t=e[c];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=T(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=T(e,!0);return g(n,(e,t)=>{b(n,e,Y(t))},r),t&&(t.finalized_=!1),n}var q=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return r.produce(e,e=>t.call(this,e,...o))}}let r;if("function"!==typeof t&&l(6),void 0!==n&&"function"!==typeof n&&l(7),h(e)){const i=x(this),o=K(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?k(i):D(i)}return P(i,n),M(r,i)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===a&&(r=void 0),this.autoFreeze_&&C(r,!0),n){const t=[],i=[];N("Patches").generateReplacementPatches_(e,r,t,i),n(t,i)}return r}l(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,t=>e(t,...i))};let r,i;return[this.produce(e,n,(e,t)=>{r=e,i=t}),r,i]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){h(e)||l(8),u(e)&&(e=function(e){u(e)||l(10);return Y(e)}(e));const t=x(this),n=K(e,void 0);return n[c].isManual_=!0,D(t),n}finishDraft(e,t){const n=e&&e[c];n&&n.isManual_||l(9);const{scope_:r}=n;return P(r,t),M(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=N("Patches").applyPatches_;return u(e)?r(e,t):this.produce(e,e=>r(e,t))}},X=q.produce,J=q.setUseStrictIteration.bind(q);function Z(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var Q=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),$=()=>Math.random().toString(36).substring(7).split("").join("."),ee={INIT:"@@redux/INIT".concat($()),REPLACE:"@@redux/REPLACE".concat($()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat($())};function te(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function ne(e,t,n){if("function"!==typeof e)throw new Error(Z(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(Z(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(Z(1));return n(ne)(e,t)}let r=e,i=t,o=new Map,a=o,s=0,c=!1;function l(){a===o&&(a=new Map,o.forEach((e,t)=>{a.set(t,e)}))}function d(){if(c)throw new Error(Z(3));return i}function u(e){if("function"!==typeof e)throw new Error(Z(4));if(c)throw new Error(Z(5));let t=!0;l();const n=s++;return a.set(n,e),function(){if(t){if(c)throw new Error(Z(6));t=!1,l(),a.delete(n),o=null}}}function h(e){if(!te(e))throw new Error(Z(7));if("undefined"===typeof e.type)throw new Error(Z(8));if("string"!==typeof e.type)throw new Error(Z(17));if(c)throw new Error(Z(9));try{c=!0,i=r(i,e)}finally{c=!1}return(o=a).forEach(e=>{e()}),e}h({type:ee.INIT});return{dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!==typeof e)throw new Error(Z(10));r=e,h({type:ee.REPLACE})},[Q]:function(){const e=u;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(Z(11));function n(){const e=t;e.next&&e.next(d())}n();return{unsubscribe:e(n)}},[Q](){return this}}}}}function re(e){const t=Object.keys(e),n={};for(let a=0;a<t.length;a++){const r=t[a];0,"function"===typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let i;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:ee.INIT}))throw new Error(Z(12));if("undefined"===typeof n(void 0,{type:ee.PROBE_UNKNOWN_ACTION()}))throw new Error(Z(13))})}(n)}catch(o){i=o}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(i)throw i;let o=!1;const a={};for(let i=0;i<r.length;i++){const s=r[i],c=n[s],l=e[s],d=c(l,t);if("undefined"===typeof d){t&&t.type;throw new Error(Z(14))}a[s]=d,o=o||d!==l}return o=o||r.length!==Object.keys(e).length,o?a:e}}function ie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce((e,t)=>function(){return e(t(...arguments))})}function oe(e){return t=>{let{dispatch:n,getState:r}=t;return t=>i=>"function"===typeof i?i(n,r,e):t(i)}}var ae=oe(),se=oe;const ce=["reducerPath"];var le="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?ie:ie.apply(null,arguments)},de=("undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__,e=>e&&"function"===typeof e.match);function ue(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error(Ge(0));return(0,o.A)((0,o.A)({type:e,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>function(e){return te(e)&&"type"in e&&"string"===typeof e.type}(t)&&t.type===e,n}var he=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function pe(e){return h(e)?X(e,()=>{}):e}function me(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var fe=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=null!==e&&void 0!==e?e:{};let o=new he;return t&&("boolean"===typeof t?o.push(ae):o.push(se(t.extraArgument))),o},ge="RTK_autoBatch",_e=e=>t=>{setTimeout(t,e)},ve=e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let r=new he(e);return n&&r.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let r=!0,i=!1,o=!1;const a=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:_e(10):"callback"===e.type?e.queueNotification:_e(e.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(e=>e()))};return Object.assign({},n,{subscribe(e){const t=n.subscribe(()=>r&&e());return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){try{var t;return r=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[ge]),i=!r,i&&(o||(o=!0,s(c))),n.dispatch(e)}finally{r=!0}}})}}("object"===typeof n?n:void 0)),r};function be(e){const t=fe(),{reducer:n,middleware:r,devTools:i=!0,duplicateMiddlewareCheck:a=!0,preloadedState:s,enhancers:c}=e||{};let l,d;if("function"===typeof n)l=n;else{if(!te(n))throw new Error(Ge(1));l=re(n)}d="function"===typeof r?r(t):t();let u=ie;i&&(u=le((0,o.A)({trace:!1},"object"===typeof i&&i)));const h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,r)=>{const i=e(n,r);let a=()=>{throw new Error(Z(15))};const s={getState:i.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a(e,...n)}},c=t.map(e=>e(s));return a=ie(...c)(i.dispatch),(0,o.A)((0,o.A)({},i),{},{dispatch:a})}}(...d),p=ve(h);return ne(l,s,u(..."function"===typeof c?c(p):p()))}function Ee(e){const t={},n=[];let r;const i={addCase(e,n){const r="string"===typeof e?e:e.type;if(!r)throw new Error(Ge(28));if(r in t)throw new Error(Ge(29));return t[r]=n,i},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),i),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),i),addDefaultCase:e=>(r=e,i)};return e(i),[t,n,r]}J(!1);var ye=(e,t)=>de(e)?e.match(t):e(t);function Se(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.some(t=>ye(t,e))}var Te=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e},Ce=["name","message","stack","code"],we=class{constructor(e,t){(0,i.A)(this,"_type",void 0),this.payload=e,this.meta=t}},Re=class{constructor(e,t){(0,i.A)(this,"_type",void 0),this.payload=e,this.meta=t}},Ae=e=>{if("object"===typeof e&&null!==e){const t={};for(const n of Ce)"string"===typeof e[n]&&(t[n]=e[n]);return t}return{message:String(e)}},Ie="External signal was aborted",Ne=(()=>{function e(e,t,n){const r=ue(e+"/fulfilled",(e,t,n,r)=>({payload:e,meta:(0,o.A)((0,o.A)({},r||{}),{},{arg:n,requestId:t,requestStatus:"fulfilled"})})),i=ue(e+"/pending",(e,t,n)=>({payload:void 0,meta:(0,o.A)((0,o.A)({},n||{}),{},{arg:t,requestId:e,requestStatus:"pending"})})),a=ue(e+"/rejected",(e,t,r,i,a)=>({payload:i,error:(n&&n.serializeError||Ae)(e||"Rejected"),meta:(0,o.A)((0,o.A)({},a||{}),{},{arg:r,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null===e||void 0===e?void 0:e.name),condition:"ConditionError"===(null===e||void 0===e?void 0:e.name)})}));return Object.assign(function(e){let{signal:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(s,c,l)=>{const d=null!==n&&void 0!==n&&n.idGenerator?n.idGenerator(e):Te(),u=new AbortController;let h,p;function m(e){p=e,u.abort()}o&&(o.aborted?m(Ie):o.addEventListener("abort",()=>m(Ie),{once:!0}));const f=async function(){let o;try{var f,g;let a=null===n||void 0===n||null===(f=n.condition)||void 0===f?void 0:f.call(n,e,{getState:c,extra:l});if(null!==(_=a)&&"object"===typeof _&&"function"===typeof _.then&&(a=await a),!1===a||u.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const v=new Promise((e,t)=>{h=()=>{t({name:"AbortError",message:p||"Aborted"})},u.signal.addEventListener("abort",h)});s(i(d,e,null===n||void 0===n||null===(g=n.getPendingMeta)||void 0===g?void 0:g.call(n,{requestId:d,arg:e},{getState:c,extra:l}))),o=await Promise.race([v,Promise.resolve(t(e,{dispatch:s,getState:c,extra:l,requestId:d,signal:u.signal,abort:m,rejectWithValue:(e,t)=>new we(e,t),fulfillWithValue:(e,t)=>new Re(e,t)})).then(t=>{if(t instanceof we)throw t;return t instanceof Re?r(t.payload,d,e,t.meta):r(t,d,e)})])}catch(v){o=v instanceof we?a(null,d,e,v.payload,v.meta):a(v,d,e)}finally{h&&u.signal.removeEventListener("abort",h)}var _;return n&&!n.dispatchConditionRejection&&a.match(o)&&o.meta.condition||s(o),o}();return Object.assign(f,{abort:m,requestId:d,arg:e,unwrap:()=>f.then(Oe)})}},{pending:i,rejected:a,fulfilled:r,settled:Se(a,r),typePrefix:e})}return e.withTypes=()=>e,e})();function Oe(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var Pe=Symbol.for("rtk-slice-createasyncthunk");function ke(e,t){return"".concat(e,"/").concat(t)}function De(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[Pe];return function(e){const{name:t,reducerPath:i=t}=e;if(!t)throw new Error(Ge(11));const a=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return(0,o.A)({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},s=Object.keys(a),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error(Ge(12));if(n in c.sliceCaseReducersByType)throw new Error(Ge(13));return c.sliceCaseReducersByType[n]=t,l},addMatcher:(e,t)=>(c.sliceMatchers.push({matcher:e,reducer:t}),l),exposeAction:(e,t)=>(c.actionCreators[e]=t,l),exposeCaseReducer:(e,t)=>(c.sliceCaseReducersByName[e]=t,l)};function d(){const[t={},n=[],r]="function"===typeof e.extraReducers?Ee(e.extraReducers):[e.extraReducers],i=(0,o.A)((0,o.A)({},t),c.sliceCaseReducersByType);return function(e,t){let n,[r,i,o]=Ee(t);if("function"===typeof e)n=()=>pe(e());else{const t=pe(e);n=()=>t}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,a=[r[t.type],...i.filter(e=>{let{matcher:n}=e;return n(t)}).map(e=>{let{reducer:t}=e;return t})];return 0===a.filter(e=>!!e).length&&(a=[o]),a.reduce((e,n)=>{if(n){if(u(e)){const r=n(e,t);return void 0===r?e:r}if(h(e))return X(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return a.getInitialState=n,a}(e.initialState,e=>{for(let t in i)e.addCase(t,i[t]);for(let t of c.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}s.forEach(r=>{const i=a[r],o={reducerName:r,type:ke(t,r),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(i)?function(e,t,n){let r,i,{type:o,reducerName:a,createNotation:s}=e;if("reducer"in t){if(s&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(Ge(17));r=t.reducer,i=t.prepare}else r=t;n.addCase(o,r).exposeCaseReducer(a,r).exposeAction(a,i?ue(o,i):ue(o))}(o,i,l):function(e,t,n,r){let{type:i,reducerName:o}=e;if(!r)throw new Error(Ge(18));const{payloadCreator:a,fulfilled:s,pending:c,rejected:l,settled:d,options:u}=t,h=r(i,a,u);n.exposeAction(o,h),s&&n.addCase(h.fulfilled,s);c&&n.addCase(h.pending,c);l&&n.addCase(h.rejected,l);d&&n.addMatcher(h.settled,d);n.exposeCaseReducer(o,{fulfilled:s||Me,pending:c||Me,rejected:l||Me,settled:d||Me})}(o,i,l,n)});const p=e=>e,m=new Map,f=new WeakMap;let g;function _(e,t){return g||(g=d()),g(e,t)}function v(){return g||(g=d()),g.getInitialState()}function b(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(e){let i=e[t];return"undefined"===typeof i&&n&&(i=me(f,r,v)),i}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;const r=me(m,n,()=>new WeakMap);return me(r,t,()=>{const r={};for(const[o,a]of Object.entries(null!==(i=e.selectors)&&void 0!==i?i:{})){var i;r[o]=xe(a,t,()=>me(f,t,v),n)}return r})}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}const E=(0,o.A)((0,o.A)({name:t,reducer:_,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v},b(i)),{},{injectInto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=t,a=(0,r.A)(t,ce);const s=null!==n&&void 0!==n?n:i;return e.inject({reducerPath:s,reducer:_},a),(0,o.A)((0,o.A)({},E),b(s,!0))}});return E}}function xe(e,t,n,r){function i(i){let o=t(i);"undefined"===typeof o&&r&&(o=n());for(var a=arguments.length,s=new Array(a>1?a-1:0),c=1;c<a;c++)s[c-1]=arguments[c];return e(o,...s)}return i.unwrapped=e,i}var Le=De();function Me(){}var Ue="listener",Fe="completed",je="cancelled";"task-".concat(je),"task-".concat(Fe),"".concat(Ue,"-").concat(je),"".concat(Ue,"-").concat(Fe);var{assign:Ve}=Object,Be="listenerMiddleware",We=Ve(ue("".concat(Be,"/add")),{withTypes:()=>We}),He=("".concat(Be,"/removeAll"),Ve(ue("".concat(Be,"/remove")),{withTypes:()=>He}));Symbol.for("rtk-state-proxy-original");function Ge(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}},894:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPackageName=t.getVersion=t.getMergedProps=t.updateActionFromPayload=t.isValidOptionalString=t.isValidOptionalNumber=t.NonSnakeCaseGroup=t.getEventNameSpace=t.forEachInEnum=t.findMatchInEnum=t.actionWrapper=void 0;var r=n(8154);Object.defineProperty(t,"actionWrapper",{enumerable:!0,get:function(){return r.actionWrapper}}),Object.defineProperty(t,"findMatchInEnum",{enumerable:!0,get:function(){return r.findMatchInEnum}}),Object.defineProperty(t,"forEachInEnum",{enumerable:!0,get:function(){return r.forEachInEnum}}),Object.defineProperty(t,"getEventNameSpace",{enumerable:!0,get:function(){return r.getEventNameSpace}}),Object.defineProperty(t,"NonSnakeCaseGroup",{enumerable:!0,get:function(){return r.NonSnakeCaseGroup}}),Object.defineProperty(t,"isValidOptionalNumber",{enumerable:!0,get:function(){return r.isValidOptionalNumber}}),Object.defineProperty(t,"isValidOptionalString",{enumerable:!0,get:function(){return r.isValidOptionalString}}),Object.defineProperty(t,"updateActionFromPayload",{enumerable:!0,get:function(){return r.updateActionFromPayload}}),Object.defineProperty(t,"getMergedProps",{enumerable:!0,get:function(){return r.getMergedProps}});var i=n(5024);t.getVersion=function(){return i.version},t.getPackageName=function(){return i.name}},992:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app=t.Action=void 0;var r=n(1852);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return r.Action}}),Object.defineProperty(t,"app",{enumerable:!0,get:function(){return r.app}})},1635:function(e,t,n){e.exports=function(){"use strict";function e(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i=function(e){try{return!!e()}catch(e){return!0}},o=!i(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),a=o,s=Function.prototype,c=s.call,l=a&&s.bind.bind(c,c),d=a?l:function(e){return function(){return c.apply(e,arguments)}},u=d({}.isPrototypeOf),h=function(e){return e&&e.Math===Math&&e},p=h("object"==typeof globalThis&&globalThis)||h("object"==typeof window&&window)||h("object"==typeof self&&self)||h("object"==typeof t&&t)||h("object"==typeof t&&t)||function(){return this}()||Function("return this")(),m=o,f=Function.prototype,g=f.apply,_=f.call,v="object"==typeof Reflect&&Reflect.apply||(m?_.bind(g):function(){return _.apply(g,arguments)}),b=d,E=b({}.toString),y=b("".slice),S=function(e){return y(E(e),8,-1)},T=S,C=d,w=function(e){if("Function"===T(e))return C(e)},R="object"==typeof document&&document.all,A=void 0===R&&void 0!==R?function(e){return"function"==typeof e||e===R}:function(e){return"function"==typeof e},I={},N=!i(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),O=o,P=Function.prototype.call,k=O?P.bind(P):function(){return P.apply(P,arguments)},D={},x={}.propertyIsEnumerable,L=Object.getOwnPropertyDescriptor,M=L&&!x.call({1:2},1);D.f=M?function(e){var t=L(this,e);return!!t&&t.enumerable}:x;var U,F,j=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},V=i,B=S,W=Object,H=d("".split),G=V(function(){return!W("z").propertyIsEnumerable(0)})?function(e){return"String"===B(e)?H(e,""):W(e)}:W,z=function(e){return null==e},K=z,Y=TypeError,q=function(e){if(K(e))throw new Y("Can't call method on "+e);return e},X=G,J=q,Z=function(e){return X(J(e))},Q=A,$=function(e){return"object"==typeof e?null!==e:Q(e)},ee={},te=ee,ne=p,re=A,ie=function(e){return re(e)?e:void 0},oe=function(e,t){return arguments.length<2?ie(te[e])||ie(ne[e]):te[e]&&te[e][t]||ne[e]&&ne[e][t]},ae=p.navigator,se=ae&&ae.userAgent,ce=se?String(se):"",le=p,de=ce,ue=le.process,he=le.Deno,pe=ue&&ue.versions||he&&he.version,me=pe&&pe.v8;me&&(F=(U=me.split("."))[0]>0&&U[0]<4?1:+(U[0]+U[1])),!F&&de&&(!(U=de.match(/Edge\/(\d+)/))||U[1]>=74)&&(U=de.match(/Chrome\/(\d+)/))&&(F=+U[1]);var fe=F,ge=fe,_e=i,ve=p.String,be=!!Object.getOwnPropertySymbols&&!_e(function(){var e=Symbol("symbol detection");return!ve(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ge&&ge<41}),Ee=be&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ye=oe,Se=A,Te=u,Ce=Object,we=Ee?function(e){return"symbol"==typeof e}:function(e){var t=ye("Symbol");return Se(t)&&Te(t.prototype,Ce(e))},Re=String,Ae=function(e){try{return Re(e)}catch(e){return"Object"}},Ie=A,Ne=Ae,Oe=TypeError,Pe=function(e){if(Ie(e))return e;throw new Oe(Ne(e)+" is not a function")},ke=Pe,De=z,xe=function(e,t){var n=e[t];return De(n)?void 0:ke(n)},Le=k,Me=A,Ue=$,Fe=TypeError,je={exports:{}},Ve=p,Be=Object.defineProperty,We=p,He=function(e,t){try{Be(Ve,e,{value:t,configurable:!0,writable:!0})}catch(r){Ve[e]=t}return t},Ge="__core-js_shared__",ze=je.exports=We[Ge]||He(Ge,{});(ze.versions||(ze.versions=[])).push({version:"3.46.0",mode:"pure",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Ke=je.exports,Ye=Ke,qe=function(e,t){return Ye[e]||(Ye[e]=t||{})},Xe=q,Je=Object,Ze=function(e){return Je(Xe(e))},Qe=Ze,$e=d({}.hasOwnProperty),et=Object.hasOwn||function(e,t){return $e(Qe(e),t)},tt=d,nt=0,rt=Math.random(),it=tt(1.1.toString),ot=function(e){return"Symbol("+(void 0===e?"":e)+")_"+it(++nt+rt,36)},at=qe,st=et,ct=ot,lt=be,dt=Ee,ut=p.Symbol,ht=at("wks"),pt=dt?ut.for||ut:ut&&ut.withoutSetter||ct,mt=function(e){return st(ht,e)||(ht[e]=lt&&st(ut,e)?ut[e]:pt("Symbol."+e)),ht[e]},ft=k,gt=$,_t=we,vt=xe,bt=function(e,t){var n,r;if("string"===t&&Me(n=e.toString)&&!Ue(r=Le(n,e)))return r;if(Me(n=e.valueOf)&&!Ue(r=Le(n,e)))return r;if("string"!==t&&Me(n=e.toString)&&!Ue(r=Le(n,e)))return r;throw new Fe("Can't convert object to primitive value")},Et=TypeError,yt=mt("toPrimitive"),St=function(e,t){if(!gt(e)||_t(e))return e;var n,r=vt(e,yt);if(r){if(void 0===t&&(t="default"),n=ft(r,e,t),!gt(n)||_t(n))return n;throw new Et("Can't convert object to primitive value")}return void 0===t&&(t="number"),bt(e,t)},Tt=we,Ct=function(e){var t=St(e,"string");return Tt(t)?t:t+""},wt=$,Rt=p.document,At=wt(Rt)&&wt(Rt.createElement),It=function(e){return At?Rt.createElement(e):{}},Nt=It,Ot=!N&&!i(function(){return 7!==Object.defineProperty(Nt("div"),"a",{get:function(){return 7}}).a}),Pt=N,kt=k,Dt=D,xt=j,Lt=Z,Mt=Ct,Ut=et,Ft=Ot,jt=Object.getOwnPropertyDescriptor;I.f=Pt?jt:function(e,t){if(e=Lt(e),t=Mt(t),Ft)try{return jt(e,t)}catch(e){}if(Ut(e,t))return xt(!kt(Dt.f,e,t),e[t])};var Vt=i,Bt=A,Wt=/#|\.prototype\./,Ht=function(e,t){var n=zt[Gt(e)];return n===Yt||n!==Kt&&(Bt(t)?Vt(t):!!t)},Gt=Ht.normalize=function(e){return String(e).replace(Wt,".").toLowerCase()},zt=Ht.data={},Kt=Ht.NATIVE="N",Yt=Ht.POLYFILL="P",qt=Ht,Xt=Pe,Jt=o,Zt=w(w.bind),Qt=function(e,t){return Xt(e),void 0===t?e:Jt?Zt(e,t):function(){return e.apply(t,arguments)}},$t={},en=N&&i(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),tn=$,nn=String,rn=TypeError,on=function(e){if(tn(e))return e;throw new rn(nn(e)+" is not an object")},an=N,sn=Ot,cn=en,ln=on,dn=Ct,un=TypeError,hn=Object.defineProperty,pn=Object.getOwnPropertyDescriptor,mn="enumerable",fn="configurable",gn="writable";$t.f=an?cn?function(e,t,n){if(ln(e),t=dn(t),ln(n),"function"==typeof e&&"prototype"===t&&"value"in n&&gn in n&&!n[gn]){var r=pn(e,t);r&&r[gn]&&(e[t]=n.value,n={configurable:fn in n?n[fn]:r[fn],enumerable:mn in n?n[mn]:r[mn],writable:!1})}return hn(e,t,n)}:hn:function(e,t,n){if(ln(e),t=dn(t),ln(n),sn)try{return hn(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new un("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var _n=$t,vn=j,bn=N?function(e,t,n){return _n.f(e,t,vn(1,n))}:function(e,t,n){return e[t]=n,e},En=p,yn=v,Sn=w,Tn=A,Cn=I.f,wn=qt,Rn=ee,An=Qt,In=bn,Nn=et,On=function(e){var t=function(n,r,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,i)}return yn(e,this,arguments)};return t.prototype=e.prototype,t},Pn=function(e,t){var n,r,i,o,a,s,c,l,d,u=e.target,h=e.global,p=e.stat,m=e.proto,f=h?En:p?En[u]:En[u]&&En[u].prototype,g=h?Rn:Rn[u]||In(Rn,u,{})[u],_=g.prototype;for(o in t)r=!(n=wn(h?o:u+(p?".":"#")+o,e.forced))&&f&&Nn(f,o),s=g[o],r&&(c=e.dontCallGetSet?(d=Cn(f,o))&&d.value:f[o]),a=r&&c?c:t[o],(n||m||typeof s!=typeof a)&&(l=e.bind&&r?An(a,En):e.wrap&&r?On(a):m&&Tn(a)?Sn(a):a,(e.sham||a&&a.sham||s&&s.sham)&&In(l,"sham",!0),In(g,o,l),m&&(Nn(Rn,i=u+"Prototype")||In(Rn,i,{}),In(Rn[i],o,a),e.real&&_&&(n||!_[o])&&In(_,o,a)))},kn=Math.ceil,Dn=Math.floor,xn=Math.trunc||function(e){var t=+e;return(t>0?Dn:kn)(t)},Ln=xn,Mn=function(e){var t=+e;return t!=t||0===t?0:Ln(t)},Un=Mn,Fn=Math.max,jn=Math.min,Vn=function(e,t){var n=Un(e);return n<0?Fn(n+t,0):jn(n,t)},Bn=Mn,Wn=Math.min,Hn=function(e){var t=Bn(e);return t>0?Wn(t,9007199254740991):0},Gn=Hn,zn=function(e){return Gn(e.length)},Kn=Z,Yn=Vn,qn=zn,Xn=function(e){return function(t,n,r){var i=Kn(t),o=qn(i);if(0===o)return!e&&-1;var a,s=Yn(r,o);if(e&&n!=n){for(;o>s;)if((a=i[s++])!=a)return!0}else for(;o>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},Jn={includes:Xn(!0),indexOf:Xn(!1)},Zn=Jn.includes;Pn({target:"Array",proto:!0,forced:i(function(){return!Array(1).includes()})},{includes:function(e){return Zn(this,e,arguments.length>1?arguments[1]:void 0)}});var Qn=p,$n=ee,er=function(e,t){var n=$n[e+"Prototype"],r=n&&n[t];if(r)return r;var i=Qn[e],o=i&&i.prototype;return o&&o[t]},tr=er("Array","includes"),nr=$,rr=S,ir=mt("match"),or=function(e){var t;return nr(e)&&(void 0!==(t=e[ir])?!!t:"RegExp"===rr(e))},ar=or,sr=TypeError,cr={};cr[mt("toStringTag")]="z";var lr="[object z]"===String(cr),dr=lr,ur=A,hr=S,pr=mt("toStringTag"),mr=Object,fr="Arguments"===hr(function(){return arguments}()),gr=dr?hr:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=mr(e),pr))?n:fr?hr(t):"Object"===(r=hr(t))&&ur(t.callee)?"Arguments":r},_r=gr,vr=String,br=function(e){if("Symbol"===_r(e))throw new TypeError("Cannot convert a Symbol value to a string");return vr(e)},Er=mt("match"),yr=Pn,Sr=function(e){if(ar(e))throw new sr("The method doesn't accept regular expressions");return e},Tr=q,Cr=br,wr=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[Er]=!1,"/./"[e](t)}catch(e){}}return!1},Rr=d("".indexOf);yr({target:"String",proto:!0,forced:!wr("includes")},{includes:function(e){return!!~Rr(Cr(Tr(this)),Cr(Sr(e)),arguments.length>1?arguments[1]:void 0)}});var Ar=er("String","includes"),Ir=u,Nr=tr,Or=Ar,Pr=Array.prototype,kr=String.prototype,Dr=function(e){var t=e.includes;return e===Pr||Ir(Pr,e)&&t===Pr.includes?Nr:"string"==typeof e||e===kr||Ir(kr,e)&&t===kr.includes?Or:t},xr=r(Dr),Lr=Pe,Mr=Ze,Ur=G,Fr=zn,jr=TypeError,Vr="Reduce of empty array with no initial value",Br=function(e){return function(t,n,r,i){var o=Mr(t),a=Ur(o),s=Fr(o);if(Lr(n),0===s&&r<2)throw new jr(Vr);var c=e?s-1:0,l=e?-1:1;if(r<2)for(;;){if(c in a){i=a[c],c+=l;break}if(c+=l,e?c<0:s<=c)throw new jr(Vr)}for(;e?c>=0:s>c;c+=l)c in a&&(i=n(i,a[c],c,o));return i}},Wr={left:Br(!1),right:Br(!0)},Hr=i,Gr=function(e,t){var n=[][e];return!!n&&Hr(function(){n.call(null,t||function(){return 1},1)})},zr=p,Kr=ce,Yr=S,qr=function(e){return Kr.slice(0,e.length)===e},Xr=qr("Bun/")?"BUN":qr("Cloudflare-Workers")?"CLOUDFLARE":qr("Deno/")?"DENO":qr("Node.js/")?"NODE":zr.Bun&&"string"==typeof Bun.version?"BUN":zr.Deno&&"object"==typeof Deno.version?"DENO":"process"===Yr(zr.process)?"NODE":zr.window&&zr.document?"BROWSER":"REST",Jr="NODE"===Xr,Zr=Wr.left;Pn({target:"Array",proto:!0,forced:!Jr&&fe>79&&fe<83||!Gr("reduce")},{reduce:function(e){var t=arguments.length;return Zr(this,e,t,t>1?arguments[1]:void 0)}});var Qr=er("Array","reduce"),$r=u,ei=Qr,ti=Array.prototype,ni=function(e){var t=e.reduce;return e===ti||$r(ti,e)&&t===ti.reduce?ei:t},ri=ni,ii=r(ri),oi=S,ai=Array.isArray||function(e){return"Array"===oi(e)},si=Pn,ci=ai,li=d([].reverse),di=[1,2];si({target:"Array",proto:!0,forced:String(di)===String(di.reverse())},{reverse:function(){return ci(this)&&(this.length=this.length),li(this)}});var ui=er("Array","reverse"),hi=u,pi=ui,mi=Array.prototype,fi=function(e){var t=e.reverse;return e===mi||hi(mi,e)&&t===mi.reverse?pi:t},gi=fi,_i=r(gi),vi=ot,bi=qe("keys"),Ei=function(e){return bi[e]||(bi[e]=vi(e))},yi=!i(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Si=et,Ti=A,Ci=Ze,wi=yi,Ri=Ei("IE_PROTO"),Ai=Object,Ii=Ai.prototype,Ni=wi?Ai.getPrototypeOf:function(e){var t=Ci(e);if(Si(t,Ri))return t[Ri];var n=t.constructor;return Ti(n)&&t instanceof n?n.prototype:t instanceof Ai?Ii:null},Oi=d,Pi=Pe,ki=$,Di=function(e){return ki(e)||null===e},xi=String,Li=TypeError,Mi=function(e,t,n){try{return Oi(Pi(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}},Ui=$,Fi=q,ji=function(e){if(Di(e))return e;throw new Li("Can't set "+xi(e)+" as a prototype")},Vi=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Mi(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return Fi(n),ji(r),Ui(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0),Bi={},Wi={},Hi=et,Gi=Z,zi=Jn.indexOf,Ki=Wi,Yi=d([].push),qi=function(e,t){var n,r=Gi(e),i=0,o=[];for(n in r)!Hi(Ki,n)&&Hi(r,n)&&Yi(o,n);for(;t.length>i;)Hi(r,n=t[i++])&&(~zi(o,n)||Yi(o,n));return o},Xi=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ji=qi,Zi=Xi.concat("length","prototype");Bi.f=Object.getOwnPropertyNames||function(e){return Ji(e,Zi)};var Qi={};Qi.f=Object.getOwnPropertySymbols;var $i=oe,eo=Bi,to=Qi,no=on,ro=d([].concat),io=$i("Reflect","ownKeys")||function(e){var t=eo.f(no(e)),n=to.f;return n?ro(t,n(e)):t},oo=et,ao=io,so=I,co=$t,lo={},uo=qi,ho=Xi,po=Object.keys||function(e){return uo(e,ho)},mo=N,fo=en,go=$t,_o=on,vo=Z,bo=po;lo.f=mo&&!fo?Object.defineProperties:function(e,t){_o(e);for(var n,r=vo(t),i=bo(t),o=i.length,a=0;o>a;)go.f(e,n=i[a++],r[n]);return e};var Eo,yo=oe("document","documentElement"),So=on,To=lo,Co=Xi,wo=Wi,Ro=yo,Ao=It,Io="prototype",No="script",Oo=Ei("IE_PROTO"),Po=function(){},ko=function(e){return"<"+No+">"+e+"</"+No+">"},Do=function(e){e.write(ko("")),e.close();var t=e.parentWindow.Object;return e=null,t},xo=function(){try{Eo=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;xo="undefined"!=typeof document?document.domain&&Eo?Do(Eo):(t=Ao("iframe"),n="java"+No+":",t.style.display="none",Ro.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(ko("document.F=Object")),e.close(),e.F):Do(Eo);for(var r=Co.length;r--;)delete xo[Io][Co[r]];return xo()};wo[Oo]=!0;var Lo=Object.create||function(e,t){var n;return null!==e?(Po[Io]=So(e),n=new Po,Po[Io]=null,n[Oo]=e):n=xo(),void 0===t?n:To.f(n,t)},Mo=$,Uo=bn,Fo=Error,jo=d("".replace),Vo=String(new Fo("zxcasd").stack),Bo=/\n\s*at [^:]*:[^\n]*/,Wo=Bo.test(Vo),Ho=j,Go=!i(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Ho(1,7)),7!==e.stack)}),zo=bn,Ko=function(e,t){if(Wo&&"string"==typeof e&&!Fo.prepareStackTrace)for(;t--;)e=jo(e,Bo,"");return e},Yo=Go,qo=Error.captureStackTrace,Xo={},Jo=Xo,Zo=mt("iterator"),Qo=Array.prototype,$o=function(e){return void 0!==e&&(Jo.Array===e||Qo[Zo]===e)},ea=gr,ta=xe,na=z,ra=Xo,ia=mt("iterator"),oa=function(e){if(!na(e))return ta(e,ia)||ta(e,"@@iterator")||ra[ea(e)]},aa=k,sa=Pe,ca=on,la=Ae,da=oa,ua=TypeError,ha=function(e,t){var n=arguments.length<2?da(e):t;if(sa(n))return ca(aa(n,e));throw new ua(la(e)+" is not iterable")},pa=k,ma=on,fa=xe,ga=function(e,t,n){var r,i;ma(e);try{if(!(r=fa(e,"return"))){if("throw"===t)throw n;return n}r=pa(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return ma(r),n},_a=Qt,va=k,ba=on,Ea=Ae,ya=$o,Sa=zn,Ta=u,Ca=ha,wa=oa,Ra=ga,Aa=TypeError,Ia=function(e,t){this.stopped=e,this.result=t},Na=Ia.prototype,Oa=function(e,t,n){var r,i,o,a,s,c,l,d=n&&n.that,u=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),m=!(!n||!n.INTERRUPTED),f=_a(t,d),g=function(e){return r&&Ra(r,"normal"),new Ia(!0,e)},_=function(e){return u?(ba(e),m?f(e[0],e[1],g):f(e[0],e[1])):m?f(e,g):f(e)};if(h)r=e.iterator;else if(p)r=e;else{if(!(i=wa(e)))throw new Aa(Ea(e)+" is not iterable");if(ya(i)){for(o=0,a=Sa(e);a>o;o++)if((s=_(e[o]))&&Ta(Na,s))return s;return new Ia(!1)}r=Ca(e,i)}for(c=h?e.next:r.next;!(l=va(c,r)).done;){try{s=_(l.value)}catch(e){Ra(r,"throw",e)}if("object"==typeof s&&s&&Ta(Na,s))return s}return new Ia(!1)},Pa=br,ka=Pn,Da=u,xa=Ni,La=Vi,Ma=function(e,t,n){for(var r=ao(t),i=co.f,o=so.f,a=0;a<r.length;a++){var s=r[a];oo(e,s)||n&&oo(n,s)||i(e,s,o(t,s))}},Ua=Lo,Fa=bn,ja=j,Va=function(e,t){Mo(t)&&"cause"in t&&Uo(e,"cause",t.cause)},Ba=function(e,t,n,r){Yo&&(qo?qo(e,t):zo(e,"stack",Ko(n,r)))},Wa=Oa,Ha=function(e,t){return void 0===e?arguments.length<2?"":t:Pa(e)},Ga=mt("toStringTag"),za=Error,Ka=[].push,Ya=function(e,t){var n,r=Da(qa,this);La?n=La(new za,r?xa(this):qa):(n=r?this:Ua(qa),Fa(n,Ga,"Error")),void 0!==t&&Fa(n,"message",Ha(t)),Ba(n,Ya,n.stack,1),arguments.length>2&&Va(n,arguments[2]);var i=[];return Wa(e,Ka,{that:i}),Fa(n,"errors",i),n};La?La(Ya,za):Ma(Ya,za,{name:!0});var qa=Ya.prototype=Ua(za.prototype,{constructor:ja(1,Ya),message:ja(1,""),name:ja(1,"AggregateError")});ka({global:!0,constructor:!0,arity:2},{AggregateError:Ya});var Xa,Ja,Za,Qa=A,$a=p.WeakMap,es=Qa($a)&&/native code/.test(String($a)),ts=p,ns=$,rs=bn,is=et,os=Ke,as=Ei,ss=Wi,cs="Object already initialized",ls=ts.TypeError,ds=ts.WeakMap;if(es||os.state){var us=os.state||(os.state=new ds);us.get=us.get,us.has=us.has,us.set=us.set,Xa=function(e,t){if(us.has(e))throw new ls(cs);return t.facade=e,us.set(e,t),t},Ja=function(e){return us.get(e)||{}},Za=function(e){return us.has(e)}}else{var hs=as("state");ss[hs]=!0,Xa=function(e,t){if(is(e,hs))throw new ls(cs);return t.facade=e,rs(e,hs,t),t},Ja=function(e){return is(e,hs)?e[hs]:{}},Za=function(e){return is(e,hs)}}var ps,ms,fs,gs={set:Xa,get:Ja,has:Za,enforce:function(e){return Za(e)?Ja(e):Xa(e,{})},getterFor:function(e){return function(t){var n;if(!ns(t)||(n=Ja(t)).type!==e)throw new ls("Incompatible receiver, "+e+" required");return n}}},_s=N,vs=et,bs=Function.prototype,Es=_s&&Object.getOwnPropertyDescriptor,ys=vs(bs,"name"),Ss={EXISTS:ys,PROPER:ys&&"something"===function(){}.name,CONFIGURABLE:ys&&(!_s||_s&&Es(bs,"name").configurable)},Ts=bn,Cs=function(e,t,n,r){return r&&r.enumerable?e[t]=n:Ts(e,t,n),e},ws=i,Rs=A,As=$,Is=Lo,Ns=Ni,Os=Cs,Ps=mt("iterator"),ks=!1;[].keys&&("next"in(fs=[].keys())?(ms=Ns(Ns(fs)))!==Object.prototype&&(ps=ms):ks=!0);var Ds=!As(ps)||ws(function(){var e={};return ps[Ps].call(e)!==e});Rs((ps=Ds?{}:Is(ps))[Ps])||Os(ps,Ps,function(){return this});var xs={IteratorPrototype:ps,BUGGY_SAFARI_ITERATORS:ks},Ls=gr,Ms=lr?{}.toString:function(){return"[object "+Ls(this)+"]"},Us=lr,Fs=$t.f,js=bn,Vs=et,Bs=Ms,Ws=mt("toStringTag"),Hs=function(e,t,n,r){var i=n?e:e&&e.prototype;i&&(Vs(i,Ws)||Fs(i,Ws,{configurable:!0,value:t}),r&&!Us&&js(i,"toString",Bs))},Gs=xs.IteratorPrototype,zs=Lo,Ks=j,Ys=Hs,qs=Xo,Xs=function(){return this},Js=function(e,t,n,r){var i=t+" Iterator";return e.prototype=zs(Gs,{next:Ks(+!r,n)}),Ys(e,i,!1,!0),qs[i]=Xs,e},Zs=Pn,Qs=k,$s=Js,ec=Ni,tc=Hs,nc=Cs,rc=Xo,ic=xs,oc=Ss.PROPER,ac=ic.BUGGY_SAFARI_ITERATORS,sc=mt("iterator"),cc="keys",lc="values",dc="entries",uc=function(){return this},hc=function(e,t,n,r,i,o,a){$s(n,t,r);var s,c,l,d=function(e){if(e===i&&f)return f;if(!ac&&e&&e in p)return p[e];switch(e){case cc:case lc:case dc:return function(){return new n(this,e)}}return function(){return new n(this)}},u=t+" Iterator",h=!1,p=e.prototype,m=p[sc]||p["@@iterator"]||i&&p[i],f=!ac&&m||d(i),g="Array"===t&&p.entries||m;if(g&&(s=ec(g.call(new e)))!==Object.prototype&&s.next&&(tc(s,u,!0,!0),rc[u]=uc),oc&&i===lc&&m&&m.name!==lc&&(h=!0,f=function(){return Qs(m,this)}),i)if(c={values:d(lc),keys:o?f:d(cc),entries:d(dc)},a)for(l in c)(ac||h||!(l in p))&&nc(p,l,c[l]);else Zs({target:t,proto:!0,forced:ac||h},c);return a&&p[sc]!==f&&nc(p,sc,f,{name:i}),rc[t]=f,c},pc=function(e,t){return{value:e,done:t}},mc=Z,fc=Xo,gc=gs;$t.f;var _c=hc,vc=pc,bc="Array Iterator",Ec=gc.set,yc=gc.getterFor(bc);_c(Array,"Array",function(e,t){Ec(this,{type:bc,target:mc(e),index:0,kind:t})},function(){var e=yc(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,vc(void 0,!0);switch(e.kind){case"keys":return vc(n,!1);case"values":return vc(t[n],!1)}return vc([n,t[n]],!1)},"values"),fc.Arguments=fc.Array;var Sc=$t,Tc=function(e,t,n){return Sc.f(e,t,n)},Cc=oe,wc=Tc,Rc=N,Ac=mt("species"),Ic=u,Nc=TypeError,Oc=function(e,t){if(Ic(t,e))return e;throw new Nc("Incorrect invocation")},Pc=A,kc=Ke,Dc=d(Function.toString);Pc(kc.inspectSource)||(kc.inspectSource=function(e){return Dc(e)});var xc=kc.inspectSource,Lc=d,Mc=i,Uc=A,Fc=gr,jc=xc,Vc=function(){},Bc=oe("Reflect","construct"),Wc=/^\s*(?:class|function)\b/,Hc=Lc(Wc.exec),Gc=!Wc.test(Vc),zc=function(e){if(!Uc(e))return!1;try{return Bc(Vc,[],e),!0}catch(e){return!1}},Kc=function(e){if(!Uc(e))return!1;switch(Fc(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Gc||!!Hc(Wc,jc(e))}catch(e){return!0}};Kc.sham=!0;var Yc,qc,Xc,Jc,Zc=!Bc||Mc(function(){var e;return zc(zc.call)||!zc(Object)||!zc(function(){e=!0})||e})?Kc:zc,Qc=Zc,$c=Ae,el=TypeError,tl=on,nl=function(e){if(Qc(e))return e;throw new el($c(e)+" is not a constructor")},rl=z,il=mt("species"),ol=function(e,t){var n,r=tl(e).constructor;return void 0===r||rl(n=tl(r)[il])?t:nl(n)},al=d([].slice),sl=TypeError,cl=function(e,t){if(e<t)throw new sl("Not enough arguments");return e},ll=/(?:ipad|iphone|ipod).*applewebkit/i.test(ce),dl=p,ul=v,hl=Qt,pl=A,ml=et,fl=i,gl=yo,_l=al,vl=It,bl=cl,El=ll,yl=Jr,Sl=dl.setImmediate,Tl=dl.clearImmediate,Cl=dl.process,wl=dl.Dispatch,Rl=dl.Function,Al=dl.MessageChannel,Il=dl.String,Nl=0,Ol={},Pl="onreadystatechange";fl(function(){Yc=dl.location});var kl=function(e){if(ml(Ol,e)){var t=Ol[e];delete Ol[e],t()}},Dl=function(e){return function(){kl(e)}},xl=function(e){kl(e.data)},Ll=function(e){dl.postMessage(Il(e),Yc.protocol+"//"+Yc.host)};Sl&&Tl||(Sl=function(e){bl(arguments.length,1);var t=pl(e)?e:Rl(e),n=_l(arguments,1);return Ol[++Nl]=function(){ul(t,void 0,n)},qc(Nl),Nl},Tl=function(e){delete Ol[e]},yl?qc=function(e){Cl.nextTick(Dl(e))}:wl&&wl.now?qc=function(e){wl.now(Dl(e))}:Al&&!El?(Jc=(Xc=new Al).port2,Xc.port1.onmessage=xl,qc=hl(Jc.postMessage,Jc)):dl.addEventListener&&pl(dl.postMessage)&&!dl.importScripts&&Yc&&"file:"!==Yc.protocol&&!fl(Ll)?(qc=Ll,dl.addEventListener("message",xl,!1)):qc=Pl in vl("script")?function(e){gl.appendChild(vl("script"))[Pl]=function(){gl.removeChild(this),kl(e)}}:function(e){setTimeout(Dl(e),0)});var Ml={set:Sl,clear:Tl},Ul=p,Fl=N,jl=Object.getOwnPropertyDescriptor,Vl=function(e){if(!Fl)return Ul[e];var t=jl(Ul,e);return t&&t.value},Bl=function(){this.head=null,this.tail=null};Bl.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Wl,Hl,Gl,zl,Kl,Yl=Bl,ql=/ipad|iphone|ipod/i.test(ce)&&"undefined"!=typeof Pebble,Xl=/web0s(?!.*chrome)/i.test(ce),Jl=p,Zl=Vl,Ql=Qt,$l=Ml.set,ed=Yl,td=ll,nd=ql,rd=Xl,id=Jr,od=Jl.MutationObserver||Jl.WebKitMutationObserver,ad=Jl.document,sd=Jl.process,cd=Jl.Promise,ld=Zl("queueMicrotask");if(!ld){var dd=new ed,ud=function(){var e,t;for(id&&(e=sd.domain)&&e.exit();t=dd.get();)try{t()}catch(e){throw dd.head&&Wl(),e}e&&e.enter()};td||id||rd||!od||!ad?!nd&&cd&&cd.resolve?((zl=cd.resolve(void 0)).constructor=cd,Kl=Ql(zl.then,zl),Wl=function(){Kl(ud)}):id?Wl=function(){sd.nextTick(ud)}:($l=Ql($l,Jl),Wl=function(){$l(ud)}):(Hl=!0,Gl=ad.createTextNode(""),new od(ud).observe(Gl,{characterData:!0}),Wl=function(){Gl.data=Hl=!Hl}),ld=function(e){dd.head||Wl(),dd.add(e)}}var hd=ld,pd=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},md=p.Promise,fd=p,gd=md,_d=A,vd=qt,bd=xc,Ed=mt,yd=Xr,Sd=fe,Td=gd&&gd.prototype,Cd=Ed("species"),wd=!1,Rd=_d(fd.PromiseRejectionEvent),Ad=vd("Promise",function(){var e=bd(gd),t=e!==String(gd);if(!t&&66===Sd)return!0;if(!Td.catch||!Td.finally)return!0;if(!Sd||Sd<51||!/native code/.test(e)){var n=new gd(function(e){e(1)}),r=function(e){e(function(){},function(){})};if((n.constructor={})[Cd]=r,!(wd=n.then(function(){})instanceof r))return!0}return!(t||"BROWSER"!==yd&&"DENO"!==yd||Rd)}),Id={CONSTRUCTOR:Ad,REJECTION_EVENT:Rd,SUBCLASSING:wd},Nd={},Od=Pe,Pd=TypeError,kd=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw new Pd("Bad Promise constructor");t=e,n=r}),this.resolve=Od(t),this.reject=Od(n)};Nd.f=function(e){return new kd(e)};var Dd,xd,Ld,Md=Pn,Ud=Jr,Fd=p,jd=ee,Vd=k,Bd=Cs,Wd=Hs,Hd=function(e){var t=Cc(e);Rc&&t&&!t[Ac]&&wc(t,Ac,{configurable:!0,get:function(){return this}})},Gd=Pe,zd=A,Kd=$,Yd=Oc,qd=ol,Xd=Ml.set,Jd=hd,Zd=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(e){}},Qd=pd,$d=Yl,eu=gs,tu=md,nu=Id,ru=Nd,iu="Promise",ou=nu.CONSTRUCTOR,au=nu.REJECTION_EVENT,su=eu.getterFor(iu),cu=eu.set,lu=tu&&tu.prototype,du=tu,uu=lu,hu=Fd.TypeError,pu=Fd.document,mu=Fd.process,fu=ru.f,gu=fu,_u=!!(pu&&pu.createEvent&&Fd.dispatchEvent),vu="unhandledrejection",bu=function(e){var t;return!(!Kd(e)||!zd(t=e.then))&&t},Eu=function(e,t){var n,r,i,o=t.value,a=1===t.state,s=a?e.ok:e.fail,c=e.resolve,l=e.reject,d=e.domain;try{s?(a||(2===t.rejection&&wu(t),t.rejection=1),!0===s?n=o:(d&&d.enter(),n=s(o),d&&(d.exit(),i=!0)),n===e.promise?l(new hu("Promise-chain cycle")):(r=bu(n))?Vd(r,n,c,l):c(n)):l(o)}catch(e){d&&!i&&d.exit(),l(e)}},yu=function(e,t){e.notified||(e.notified=!0,Jd(function(){for(var n,r=e.reactions;n=r.get();)Eu(n,e);e.notified=!1,t&&!e.rejection&&Tu(e)}))},Su=function(e,t,n){var r,i;_u?((r=pu.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Fd.dispatchEvent(r)):r={promise:t,reason:n},!au&&(i=Fd["on"+e])?i(r):e===vu&&Zd("Unhandled promise rejection",n)},Tu=function(e){Vd(Xd,Fd,function(){var t,n=e.facade,r=e.value;if(Cu(e)&&(t=Qd(function(){Ud?mu.emit("unhandledRejection",r,n):Su(vu,n,r)}),e.rejection=Ud||Cu(e)?2:1,t.error))throw t.value})},Cu=function(e){return 1!==e.rejection&&!e.parent},wu=function(e){Vd(Xd,Fd,function(){var t=e.facade;Ud?mu.emit("rejectionHandled",t):Su("rejectionhandled",t,e.value)})},Ru=function(e,t,n){return function(r){e(t,r,n)}},Au=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,yu(e,!0))},Iu=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw new hu("Promise can't be resolved itself");var r=bu(t);r?Jd(function(){var n={done:!1};try{Vd(r,t,Ru(Iu,n,e),Ru(Au,n,e))}catch(t){Au(n,t,e)}}):(e.value=t,e.state=1,yu(e,!1))}catch(t){Au({done:!1},t,e)}}};ou&&(uu=(du=function(e){Yd(this,uu),Gd(e),Vd(Dd,this);var t=su(this);try{e(Ru(Iu,t),Ru(Au,t))}catch(e){Au(t,e)}}).prototype,(Dd=function(e){cu(this,{type:iu,done:!1,notified:!1,parent:!1,reactions:new $d,rejection:!1,state:0,value:null})}).prototype=Bd(uu,"then",function(e,t){var n=su(this),r=fu(qd(this,du));return n.parent=!0,r.ok=!zd(e)||e,r.fail=zd(t)&&t,r.domain=Ud?mu.domain:void 0,0===n.state?n.reactions.add(r):Jd(function(){Eu(r,n)}),r.promise}),xd=function(){var e=new Dd,t=su(e);this.promise=e,this.resolve=Ru(Iu,t),this.reject=Ru(Au,t)},ru.f=fu=function(e){return e===du||e===Ld?new xd(e):gu(e)}),Md({global:!0,constructor:!0,wrap:!0,forced:ou},{Promise:du}),Ld=jd.Promise,Wd(du,iu,!1,!0),Hd(iu);var Nu=mt("iterator"),Ou=!1;try{var Pu=0,ku={next:function(){return{done:!!Pu++}},return:function(){Ou=!0}};ku[Nu]=function(){return this},Array.from(ku,function(){throw 2})}catch(e){}var Du=md,xu=function(e,t){try{if(!t&&!Ou)return!1}catch(e){return!1}var n=!1;try{var r={};r[Nu]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Lu=Id.CONSTRUCTOR||!xu(function(e){Du.all(e).then(void 0,function(){})}),Mu=k,Uu=Pe,Fu=Nd,ju=pd,Vu=Oa;Pn({target:"Promise",stat:!0,forced:Lu},{all:function(e){var t=this,n=Fu.f(t),r=n.resolve,i=n.reject,o=ju(function(){var n=Uu(t.resolve),o=[],a=0,s=1;Vu(e,function(e){var c=a++,l=!1;s++,Mu(n,t,e).then(function(e){l||(l=!0,o[c]=e,--s||r(o))},i)}),--s||r(o)});return o.error&&i(o.value),n.promise}});var Bu=Pn,Wu=Id.CONSTRUCTOR;md&&md.prototype,Bu({target:"Promise",proto:!0,forced:Wu,real:!0},{catch:function(e){return this.then(void 0,e)}});var Hu=k,Gu=Pe,zu=Nd,Ku=pd,Yu=Oa;Pn({target:"Promise",stat:!0,forced:Lu},{race:function(e){var t=this,n=zu.f(t),r=n.reject,i=Ku(function(){var i=Gu(t.resolve);Yu(e,function(e){Hu(i,t,e).then(n.resolve,r)})});return i.error&&r(i.value),n.promise}});var qu=Nd;Pn({target:"Promise",stat:!0,forced:Id.CONSTRUCTOR},{reject:function(e){var t=qu.f(this);return(0,t.reject)(e),t.promise}});var Xu=on,Ju=$,Zu=Nd,Qu=function(e,t){if(Xu(e),Ju(t)&&t.constructor===e)return t;var n=Zu.f(e);return(0,n.resolve)(t),n.promise},$u=Pn,eh=md,th=Id.CONSTRUCTOR,nh=Qu,rh=oe("Promise"),ih=!th;$u({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return nh(ih&&this===rh?eh:this,e)}});var oh=k,ah=Pe,sh=Nd,ch=pd,lh=Oa;Pn({target:"Promise",stat:!0,forced:Lu},{allSettled:function(e){var t=this,n=sh.f(t),r=n.resolve,i=n.reject,o=ch(function(){var n=ah(t.resolve),i=[],o=0,a=1;lh(e,function(e){var s=o++,c=!1;a++,oh(n,t,e).then(function(e){c||(c=!0,i[s]={status:"fulfilled",value:e},--a||r(i))},function(e){c||(c=!0,i[s]={status:"rejected",reason:e},--a||r(i))})}),--a||r(i)});return o.error&&i(o.value),n.promise}});var dh=k,uh=Pe,hh=oe,ph=Nd,mh=pd,fh=Oa,gh="No one promise resolved";Pn({target:"Promise",stat:!0,forced:Lu},{any:function(e){var t=this,n=hh("AggregateError"),r=ph.f(t),i=r.resolve,o=r.reject,a=mh(function(){var r=uh(t.resolve),a=[],s=0,c=1,l=!1;fh(e,function(e){var d=s++,u=!1;c++,dh(r,t,e).then(function(e){u||l||(l=!0,i(e))},function(e){u||l||(u=!0,a[d]=e,--c||o(new n(a,gh)))})}),--c||o(new n(a,gh))});return a.error&&o(a.value),r.promise}});var _h=Pn,vh=v,bh=al,Eh=Nd,yh=Pe,Sh=pd,Th=p.Promise,Ch=!1;_h({target:"Promise",stat:!0,forced:!Th||!Th.try||Sh(function(){Th.try(function(e){Ch=8===e},8)}).error||!Ch},{try:function(e){var t=arguments.length>1?bh(arguments,1):[],n=Eh.f(this),r=Sh(function(){return vh(yh(e),void 0,t)});return(r.error?n.reject:n.resolve)(r.value),n.promise}});var wh=Nd;Pn({target:"Promise",stat:!0},{withResolvers:function(){var e=wh.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Rh=Pn,Ah=md,Ih=i,Nh=oe,Oh=A,Ph=ol,kh=Qu,Dh=Ah&&Ah.prototype;Rh({target:"Promise",proto:!0,real:!0,forced:!!Ah&&Ih(function(){Dh.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=Ph(this,Nh("Promise")),n=Oh(e);return this.then(n?function(n){return kh(t,e()).then(function(){return n})}:e,n?function(n){return kh(t,e()).then(function(){throw n})}:e)}});var xh=d,Lh=Mn,Mh=br,Uh=q,Fh=xh("".charAt),jh=xh("".charCodeAt),Vh=xh("".slice),Bh=function(e){return function(t,n){var r,i,o=Mh(Uh(t)),a=Lh(n),s=o.length;return a<0||a>=s?e?"":void 0:(r=jh(o,a))<55296||r>56319||a+1===s||(i=jh(o,a+1))<56320||i>57343?e?Fh(o,a):r:e?Vh(o,a,a+2):i-56320+(r-55296<<10)+65536}},Wh={codeAt:Bh(!1),charAt:Bh(!0)},Hh=Wh.charAt,Gh=br,zh=gs,Kh=hc,Yh=pc,qh="String Iterator",Xh=zh.set,Jh=zh.getterFor(qh);Kh(String,"String",function(e){Xh(this,{type:qh,string:Gh(e),index:0})},function(){var e,t=Jh(this),n=t.string,r=t.index;return r>=n.length?Yh(void 0,!0):(e=Hh(n,r),t.index+=e.length,Yh(e,!1))});var Zh=ee.Promise,Qh={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},$h=p,ep=Hs,tp=Xo;for(var np in Qh)ep($h[np],np),tp[np]=tp.Array;var rp=Zh,ip=r(rp),op=er("Array","values"),ap=gr,sp=et,cp=u,lp=op,dp=Array.prototype,up={DOMTokenList:!0,NodeList:!0},hp=function(e){var t=e.values;return e===dp||cp(dp,e)&&t===dp.values||sp(up,ap(e))?lp:t},pp=r(hp),mp=Ae,fp=TypeError,gp=al,_p=Math.floor,vp=function(e,t){var n=e.length;if(n<8)for(var r,i,o=1;o<n;){for(i=o,r=e[o];i&&t(e[i-1],r)>0;)e[i]=e[--i];i!==o++&&(e[i]=r)}else for(var a=_p(n/2),s=vp(gp(e,0,a),t),c=vp(gp(e,a),t),l=s.length,d=c.length,u=0,h=0;u<l||h<d;)e[u+h]=u<l&&h<d?t(s[u],c[h])<=0?s[u++]:c[h++]:u<l?s[u++]:c[h++];return e},bp=vp,Ep=ce.match(/firefox\/(\d+)/i),yp=!!Ep&&+Ep[1],Sp=/MSIE|Trident/.test(ce),Tp=ce.match(/AppleWebKit\/(\d+)\./),Cp=!!Tp&&+Tp[1],wp=Pn,Rp=d,Ap=Pe,Ip=Ze,Np=zn,Op=function(e,t){if(!delete e[t])throw new fp("Cannot delete property "+mp(t)+" of "+mp(e))},Pp=br,kp=i,Dp=bp,xp=Gr,Lp=yp,Mp=Sp,Up=fe,Fp=Cp,jp=[],Vp=Rp(jp.sort),Bp=Rp(jp.push),Wp=kp(function(){jp.sort(void 0)}),Hp=kp(function(){jp.sort(null)}),Gp=xp("sort"),zp=!kp(function(){if(Up)return Up<70;if(!(Lp&&Lp>3)){if(Mp)return!0;if(Fp)return Fp<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)jp.push({k:t+r,v:n})}for(jp.sort(function(e,t){return t.v-e.v}),r=0;r<jp.length;r++)t=jp[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}});wp({target:"Array",proto:!0,forced:Wp||!Hp||!Gp||!zp},{sort:function(e){void 0!==e&&Ap(e);var t=Ip(this);if(zp)return void 0===e?Vp(t):Vp(t,e);var n,r,i=[],o=Np(t);for(r=0;r<o;r++)r in t&&Bp(i,t[r]);for(Dp(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:Pp(t)>Pp(n)?1:-1}}(e)),n=Np(i),r=0;r<n;)t[r]=i[r++];for(;r<o;)Op(t,r++);return t}});var Kp=er("Array","sort"),Yp=u,qp=Kp,Xp=Array.prototype,Jp=function(e){var t=e.sort;return e===Xp||Yp(Xp,e)&&t===Xp.sort?qp:t},Zp=r(Jp),Qp=Pn,$p=d,em=Vn,tm=RangeError,nm=String.fromCharCode,rm=String.fromCodePoint,im=$p([].join);Qp({target:"String",stat:!0,arity:1,forced:!!rm&&1!==rm.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;r>i;){if(t=+arguments[i++],em(t,1114111)!==t)throw new tm(t+" is not a valid code point");n[i]=t<65536?nm(t):nm(55296+((t-=65536)>>10),t%1024+56320)}return im(n,"")}});var om=i,am=mt("iterator"),sm=!om(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return e.pathname="c%20d",t.forEach(function(e,n){t.delete("b"),r+=n+e}),n.delete("a",2),n.delete("b",void 0),!e.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",void 0)||n.has("b")||!t.size&&!0||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[am]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("https://a#\u0431").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host}),cm=Cs,lm=Pn,dm=p,um=Vl,hm=oe,pm=k,mm=d,fm=N,gm=sm,_m=Cs,vm=Tc,bm=function(e,t,n){for(var r in t)n&&n.unsafe&&e[r]?e[r]=t[r]:cm(e,r,t[r],n);return e},Em=Hs,ym=Js,Sm=gs,Tm=Oc,Cm=A,wm=et,Rm=Qt,Am=gr,Im=on,Nm=$,Om=br,Pm=Lo,km=j,Dm=ha,xm=oa,Lm=pc,Mm=cl,Um=bp,Fm=mt("iterator"),jm="URLSearchParams",Vm=jm+"Iterator",Bm=Sm.set,Wm=Sm.getterFor(jm),Hm=Sm.getterFor(Vm),Gm=um("fetch"),zm=um("Request"),Km=um("Headers"),Ym=zm&&zm.prototype,qm=Km&&Km.prototype,Xm=dm.TypeError,Jm=dm.encodeURIComponent,Zm=String.fromCharCode,Qm=hm("String","fromCodePoint"),$m=parseInt,ef=mm("".charAt),tf=mm([].join),nf=mm([].push),rf=mm("".replace),of=mm([].shift),af=mm([].splice),sf=mm("".split),cf=mm("".slice),lf=mm(/./.exec),df=/\+/g,uf=/^[0-9a-f]+$/i,hf=function(e,t){var n=cf(e,t,t+2);return lf(uf,n)?$m(n,16):NaN},pf=function(e){for(var t=0,n=128;n>0&&0!=(e&n);n>>=1)t++;return t},mf=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},ff=function(e){for(var t=(e=rf(e,df," ")).length,n="",r=0;r<t;){var i=ef(e,r);if("%"===i){if("%"===ef(e,r+1)||r+3>t){n+="%",r++;continue}var o=hf(e,r+1);if(o!=o){n+=i,r++;continue}r+=2;var a=pf(o);if(0===a)i=Zm(o);else{if(1===a||a>4){n+="\ufffd",r++;continue}for(var s=[o],c=1;c<a&&!(3+ ++r>t||"%"!==ef(e,r));){var l=hf(e,r+1);if(l!=l){r+=3;break}if(l>191||l<128)break;nf(s,l),r+=2,c++}if(s.length!==a){n+="\ufffd";continue}var d=mf(s);null===d?n+="\ufffd":i=Qm(d)}}n+=i,r++}return n},gf=/[!'()~]|%20/g,_f={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},vf=function(e){return _f[e]},bf=function(e){return rf(Jm(e),gf,vf)},Ef=ym(function(e,t){Bm(this,{type:Vm,target:Wm(e).entries,index:0,kind:t})},jm,function(){var e=Hm(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,Lm(void 0,!0);var r=t[n];switch(e.kind){case"keys":return Lm(r.key,!1);case"values":return Lm(r.value,!1)}return Lm([r.key,r.value],!1)},!0),yf=function(e){this.entries=[],this.url=null,void 0!==e&&(Nm(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===ef(e,0)?cf(e,1):e:Om(e)))};yf.prototype={type:jm,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,o,a,s,c=this.entries,l=xm(e);if(l)for(n=(t=Dm(e,l)).next;!(r=pm(n,t)).done;){if(o=(i=Dm(Im(r.value))).next,(a=pm(o,i)).done||(s=pm(o,i)).done||!pm(o,i).done)throw new Xm("Expected sequence with length 2");nf(c,{key:Om(a.value),value:Om(s.value)})}else for(var d in e)wm(e,d)&&nf(c,{key:d,value:Om(e[d])})},parseQuery:function(e){if(e)for(var t,n,r=this.entries,i=sf(e,"&"),o=0;o<i.length;)(t=i[o++]).length&&(n=sf(t,"="),nf(r,{key:ff(of(n)),value:ff(tf(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],nf(n,bf(e.key)+"="+bf(e.value));return tf(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Sf=function(){Tm(this,Tf);var e=Bm(this,new yf(arguments.length>0?arguments[0]:void 0));fm||(this.size=e.entries.length)},Tf=Sf.prototype;if(bm(Tf,{append:function(e,t){var n=Wm(this);Mm(arguments.length,2),nf(n.entries,{key:Om(e),value:Om(t)}),fm||this.length++,n.updateURL()},delete:function(e){for(var t=Wm(this),n=Mm(arguments.length,1),r=t.entries,i=Om(e),o=n<2?void 0:arguments[1],a=void 0===o?o:Om(o),s=0;s<r.length;){var c=r[s];if(c.key!==i||void 0!==a&&c.value!==a)s++;else if(af(r,s,1),void 0!==a)break}fm||(this.size=r.length),t.updateURL()},get:function(e){var t=Wm(this).entries;Mm(arguments.length,1);for(var n=Om(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){var t=Wm(this).entries;Mm(arguments.length,1);for(var n=Om(e),r=[],i=0;i<t.length;i++)t[i].key===n&&nf(r,t[i].value);return r},has:function(e){for(var t=Wm(this).entries,n=Mm(arguments.length,1),r=Om(e),i=n<2?void 0:arguments[1],o=void 0===i?i:Om(i),a=0;a<t.length;){var s=t[a++];if(s.key===r&&(void 0===o||s.value===o))return!0}return!1},set:function(e,t){var n=Wm(this);Mm(arguments.length,1);for(var r,i=n.entries,o=!1,a=Om(e),s=Om(t),c=0;c<i.length;c++)(r=i[c]).key===a&&(o?af(i,c--,1):(o=!0,r.value=s));o||nf(i,{key:a,value:s}),fm||(this.size=i.length),n.updateURL()},sort:function(){var e=Wm(this);Um(e.entries,function(e,t){return e.key>t.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,n=Wm(this).entries,r=Rm(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new Ef(this,"keys")},values:function(){return new Ef(this,"values")},entries:function(){return new Ef(this,"entries")}},{enumerable:!0}),_m(Tf,Fm,Tf.entries,{name:"entries"}),_m(Tf,"toString",function(){return Wm(this).serialize()},{enumerable:!0}),fm&&vm(Tf,"size",{get:function(){return Wm(this).entries.length},configurable:!0,enumerable:!0}),Em(Sf,jm),lm({global:!0,constructor:!0,forced:!gm},{URLSearchParams:Sf}),!gm&&Cm(Km)){var Cf=mm(qm.has),wf=mm(qm.set),Rf=function(e){if(Nm(e)){var t,n=e.body;if(Am(n)===jm)return t=e.headers?new Km(e.headers):new Km,Cf(t,"content-type")||wf(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Pm(e,{body:km(0,Om(n)),headers:km(0,t)})}return e};if(Cm(Gm)&&lm({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return Gm(e,arguments.length>1?Rf(arguments[1]):{})}}),Cm(zm)){var Af=function(e){return Tm(this,Ym),new zm(e,arguments.length>1?Rf(arguments[1]):{})};Ym.constructor=Af,Af.prototype=Ym,lm({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Af})}}var If,Nf={URLSearchParams:Sf,getState:Wm},Of=ee.URLSearchParams,Pf=N,kf=d,Df=k,xf=i,Lf=po,Mf=Qi,Uf=D,Ff=Ze,jf=G,Vf=Object.assign,Bf=Object.defineProperty,Wf=kf([].concat),Hf=!Vf||xf(function(){if(Pf&&1!==Vf({b:1},Vf(Bf({},"a",{enumerable:!0,get:function(){Bf(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol("assign detection"),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!==Vf({},e)[n]||Lf(Vf({},t)).join("")!==r})?function(e,t){for(var n=Ff(e),r=arguments.length,i=1,o=Mf.f,a=Uf.f;r>i;)for(var s,c=jf(arguments[i++]),l=o?Wf(Lf(c),o(c)):Lf(c),d=l.length,u=0;d>u;)s=l[u++],Pf&&!Df(a,c,s)||(n[s]=c[s]);return n}:Vf,Gf=on,zf=ga,Kf=N,Yf=$t,qf=j,Xf=function(e,t,n){Kf?Yf.f(e,t,qf(0,n)):e[t]=n},Jf=Qt,Zf=k,Qf=Ze,$f=function(e,t,n,r){try{return r?t(Gf(n)[0],n[1]):t(n)}catch(t){zf(e,"throw",t)}},eg=$o,tg=Zc,ng=zn,rg=Xf,ig=ha,og=oa,ag=Array,sg=d,cg=2147483647,lg=/[^\0-\u007E]/,dg=/[.\u3002\uFF0E\uFF61]/g,ug="Overflow: input needs wider integers to process",hg=RangeError,pg=sg(dg.exec),mg=Math.floor,fg=String.fromCharCode,gg=sg("".charCodeAt),_g=sg([].join),vg=sg([].push),bg=sg("".replace),Eg=sg("".split),yg=sg("".toLowerCase),Sg=function(e){return e+22+75*(e<26)},Tg=function(e,t,n){var r=0;for(e=n?mg(e/700):e>>1,e+=mg(e/t);e>455;)e=mg(e/35),r+=36;return mg(r+36*e/(e+38))},Cg=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=gg(e,n++);if(i>=55296&&i<=56319&&n<r){var o=gg(e,n++);56320==(64512&o)?vg(t,((1023&i)<<10)+(1023&o)+65536):(vg(t,i),n--)}else vg(t,i)}return t}(e);var n,r,i=e.length,o=128,a=0,s=72;for(n=0;n<e.length;n++)(r=e[n])<128&&vg(t,fg(r));var c=t.length,l=c;for(c&&vg(t,"-");l<i;){var d=cg;for(n=0;n<e.length;n++)(r=e[n])>=o&&r<d&&(d=r);var u=l+1;if(d-o>mg((cg-a)/u))throw new hg(ug);for(a+=(d-o)*u,o=d,n=0;n<e.length;n++){if((r=e[n])<o&&++a>cg)throw new hg(ug);if(r===o){for(var h=a,p=36;;){var m=p<=s?1:p>=s+26?26:p-s;if(h<m)break;var f=h-m,g=36-m;vg(t,fg(Sg(m+f%g))),h=mg(f/g),p+=36}vg(t,fg(Sg(h))),s=Tg(a,u,l===c),a=0,l++}}a++,o++}return _g(t,"")},wg=Pn,Rg=N,Ag=sm,Ig=p,Ng=Qt,Og=d,Pg=Cs,kg=Tc,Dg=Oc,xg=et,Lg=Hf,Mg=function(e){var t=Qf(e),n=tg(this),r=arguments.length,i=r>1?arguments[1]:void 0,o=void 0!==i;o&&(i=Jf(i,r>2?arguments[2]:void 0));var a,s,c,l,d,u,h=og(t),p=0;if(!h||this===ag&&eg(h))for(a=ng(t),s=n?new this(a):ag(a);a>p;p++)u=o?i(t[p],p):t[p],rg(s,p,u);else for(s=n?new this:[],d=(l=ig(t,h)).next;!(c=Zf(d,l)).done;p++)u=o?$f(l,i,[c.value,p],!0):c.value,rg(s,p,u);return s.length=p,s},Ug=al,Fg=Wh.codeAt,jg=function(e){var t,n,r=[],i=Eg(bg(yg(e),dg,"."),".");for(t=0;t<i.length;t++)n=i[t],vg(r,pg(lg,n)?"xn--"+Cg(n):n);return _g(r,".")},Vg=br,Bg=Hs,Wg=cl,Hg=Nf,Gg=gs,zg=Gg.set,Kg=Gg.getterFor("URL"),Yg=Hg.URLSearchParams,qg=Hg.getState,Xg=Ig.URL,Jg=Ig.TypeError,Zg=Ig.parseInt,Qg=Math.floor,$g=Math.pow,e_=Og("".charAt),t_=Og(/./.exec),n_=Og([].join),r_=Og(1.1.toString),i_=Og([].pop),o_=Og([].push),a_=Og("".replace),s_=Og([].shift),c_=Og("".split),l_=Og("".slice),d_=Og("".toLowerCase),u_=Og([].unshift),h_="Invalid scheme",p_="Invalid host",m_="Invalid port",f_=/[a-z]/i,g_=/[\d+-.a-z]/i,__=/\d/,v_=/^0x/i,b_=/^[0-7]+$/,E_=/^\d+$/,y_=/^[\da-f]+$/i,S_=/[\0\t\n\r #%/:<>?@[\\\]^|]/,T_=/[\0\t\n\r #/:<>?@[\\\]^|]/,C_=/^[\u0000-\u0020]+/,w_=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,R_=/[\t\n\r]/g,A_=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)u_(t,e%256),e=Qg(e/256);return n_(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n?r:t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=r_(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},I_={},N_=Lg({},I_,{" ":1,'"':1,"<":1,">":1,"`":1}),O_=Lg({},N_,{"#":1,"?":1,"{":1,"}":1}),P_=Lg({},O_,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),k_=function(e,t){var n=Fg(e,0);return n>32&&n<127&&!xg(t,e)?e:encodeURIComponent(e)},D_={ftp:21,file:null,http:80,https:443,ws:80,wss:443},x_=function(e,t){var n;return 2===e.length&&t_(f_,e_(e,0))&&(":"===(n=e_(e,1))||!t&&"|"===n)},L_=function(e){var t;return e.length>1&&x_(l_(e,0,2))&&(2===e.length||"/"===(t=e_(e,2))||"\\"===t||"?"===t||"#"===t)},M_=function(e){return"."===e||"%2e"===d_(e)},U_={},F_={},j_={},V_={},B_={},W_={},H_={},G_={},z_={},K_={},Y_={},q_={},X_={},J_={},Z_={},Q_={},$_={},ev={},tv={},nv={},rv={},iv=function(e,t,n){var r,i,o,a=Vg(e);if(t){if(i=this.parse(a))throw new Jg(i);this.searchParams=null}else{if(void 0!==n&&(r=new iv(n,!0)),i=this.parse(a,null,r))throw new Jg(i);(o=qg(new Yg)).bindURL(this),this.searchParams=o}};iv.prototype={type:"URL",parse:function(e,t,n){var r,i,o,a,s,c=this,l=t||U_,d=0,u="",h=!1,p=!1,m=!1;for(e=Vg(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=a_(e,C_,""),e=a_(e,w_,"$1")),e=a_(e,R_,""),r=Mg(e);d<=r.length;){switch(i=r[d],l){case U_:if(!i||!t_(f_,i)){if(t)return h_;l=j_;continue}u+=d_(i),l=F_;break;case F_:if(i&&(t_(g_,i)||"+"===i||"-"===i||"."===i))u+=d_(i);else{if(":"!==i){if(t)return h_;u="",l=j_,d=0;continue}if(t&&(c.isSpecial()!==xg(D_,u)||"file"===u&&(c.includesCredentials()||null!==c.port)||"file"===c.scheme&&!c.host))return;if(c.scheme=u,t)return void(c.isSpecial()&&D_[c.scheme]===c.port&&(c.port=null));u="","file"===c.scheme?l=J_:c.isSpecial()&&n&&n.scheme===c.scheme?l=V_:c.isSpecial()?l=G_:"/"===r[d+1]?(l=B_,d++):(c.cannotBeABaseURL=!0,o_(c.path,""),l=tv)}break;case j_:if(!n||n.cannotBeABaseURL&&"#"!==i)return h_;if(n.cannotBeABaseURL&&"#"===i){c.scheme=n.scheme,c.path=Ug(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,l=rv;break}l="file"===n.scheme?J_:W_;continue;case V_:if("/"!==i||"/"!==r[d+1]){l=W_;continue}l=z_,d++;break;case B_:if("/"===i){l=K_;break}l=ev;continue;case W_:if(c.scheme=n.scheme,i===If)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ug(n.path),c.query=n.query;else if("/"===i||"\\"===i&&c.isSpecial())l=H_;else if("?"===i)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ug(n.path),c.query="",l=nv;else{if("#"!==i){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ug(n.path),c.path.length--,l=ev;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Ug(n.path),c.query=n.query,c.fragment="",l=rv}break;case H_:if(!c.isSpecial()||"/"!==i&&"\\"!==i){if("/"!==i){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,l=ev;continue}l=K_}else l=z_;break;case G_:if(l=z_,"/"!==i||"/"!==e_(u,d+1))continue;d++;break;case z_:if("/"!==i&&"\\"!==i){l=K_;continue}break;case K_:if("@"===i){h&&(u="%40"+u),h=!0,o=Mg(u);for(var f=0;f<o.length;f++){var g=o[f];if(":"!==g||m){var _=k_(g,P_);m?c.password+=_:c.username+=_}else m=!0}u=""}else if(i===If||"/"===i||"?"===i||"#"===i||"\\"===i&&c.isSpecial()){if(h&&""===u)return"Invalid authority";d-=Mg(u).length+1,u="",l=Y_}else u+=i;break;case Y_:case q_:if(t&&"file"===c.scheme){l=Q_;continue}if(":"!==i||p){if(i===If||"/"===i||"?"===i||"#"===i||"\\"===i&&c.isSpecial()){if(c.isSpecial()&&""===u)return p_;if(t&&""===u&&(c.includesCredentials()||null!==c.port))return;if(a=c.parseHost(u))return a;if(u="",l=$_,t)return;continue}"["===i?p=!0:"]"===i&&(p=!1),u+=i}else{if(""===u)return p_;if(a=c.parseHost(u))return a;if(u="",l=X_,t===q_)return}break;case X_:if(!t_(__,i)){if(i===If||"/"===i||"?"===i||"#"===i||"\\"===i&&c.isSpecial()||t){if(""!==u){var v=Zg(u,10);if(v>65535)return m_;c.port=c.isSpecial()&&v===D_[c.scheme]?null:v,u=""}if(t)return;l=$_;continue}return m_}u+=i;break;case J_:if(c.scheme="file","/"===i||"\\"===i)l=Z_;else{if(!n||"file"!==n.scheme){l=ev;continue}switch(i){case If:c.host=n.host,c.path=Ug(n.path),c.query=n.query;break;case"?":c.host=n.host,c.path=Ug(n.path),c.query="",l=nv;break;case"#":c.host=n.host,c.path=Ug(n.path),c.query=n.query,c.fragment="",l=rv;break;default:L_(n_(Ug(r,d),""))||(c.host=n.host,c.path=Ug(n.path),c.shortenPath()),l=ev;continue}}break;case Z_:if("/"===i||"\\"===i){l=Q_;break}n&&"file"===n.scheme&&!L_(n_(Ug(r,d),""))&&(x_(n.path[0],!0)?o_(c.path,n.path[0]):c.host=n.host),l=ev;continue;case Q_:if(i===If||"/"===i||"\\"===i||"?"===i||"#"===i){if(!t&&x_(u))l=ev;else if(""===u){if(c.host="",t)return;l=$_}else{if(a=c.parseHost(u))return a;if("localhost"===c.host&&(c.host=""),t)return;u="",l=$_}continue}u+=i;break;case $_:if(c.isSpecial()){if(l=ev,"/"!==i&&"\\"!==i)continue}else if(t||"?"!==i)if(t||"#"!==i){if(i!==If&&(l=ev,"/"!==i))continue}else c.fragment="",l=rv;else c.query="",l=nv;break;case ev:if(i===If||"/"===i||"\\"===i&&c.isSpecial()||!t&&("?"===i||"#"===i)){if(".."===(s=d_(s=u))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(c.shortenPath(),"/"===i||"\\"===i&&c.isSpecial()||o_(c.path,"")):M_(u)?"/"===i||"\\"===i&&c.isSpecial()||o_(c.path,""):("file"===c.scheme&&!c.path.length&&x_(u)&&(c.host&&(c.host=""),u=e_(u,0)+":"),o_(c.path,u)),u="","file"===c.scheme&&(i===If||"?"===i||"#"===i))for(;c.path.length>1&&""===c.path[0];)s_(c.path);"?"===i?(c.query="",l=nv):"#"===i&&(c.fragment="",l=rv)}else u+=k_(i,O_);break;case tv:"?"===i?(c.query="",l=nv):"#"===i?(c.fragment="",l=rv):i!==If&&(c.path[0]+=k_(i,I_));break;case nv:t||"#"!==i?i!==If&&("'"===i&&c.isSpecial()?c.query+="%27":c.query+="#"===i?"%23":k_(i,I_)):(c.fragment="",l=rv);break;case rv:i!==If&&(c.fragment+=k_(i,N_))}d++}},parseHost:function(e){var t,n,r;if("["===e_(e,0)){if("]"!==e_(e,e.length-1))return p_;if(t=function(e){var t,n,r,i,o,a,s,c=[0,0,0,0,0,0,0,0],l=0,d=null,u=0,h=function(){return e_(e,u)};if(":"===h()){if(":"!==e_(e,1))return;u+=2,d=++l}for(;h();){if(8===l)return;if(":"!==h()){for(t=n=0;n<4&&t_(y_,h());)t=16*t+Zg(h(),16),u++,n++;if("."===h()){if(0===n)return;if(u-=n,l>6)return;for(r=0;h();){if(i=null,r>0){if(!("."===h()&&r<4))return;u++}if(!t_(__,h()))return;for(;t_(__,h());){if(o=Zg(h(),10),null===i)i=o;else{if(0===i)return;i=10*i+o}if(i>255)return;u++}c[l]=256*c[l]+i,2!=++r&&4!==r||l++}if(4!==r)return;break}if(":"===h()){if(u++,!h())return}else if(h())return;c[l++]=t}else{if(null!==d)return;u++,d=++l}}if(null!==d)for(a=l-d,l=7;0!==l&&a>0;)s=c[l],c[l--]=c[d+a-1],c[d+--a]=s;else if(8!==l)return;return c}(l_(e,1,-1)),!t)return p_;this.host=t}else if(this.isSpecial()){if(e=jg(e),t_(S_,e))return p_;if(t=function(e){var t,n,r,i,o,a,s,c=c_(e,".");if(c.length&&""===c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""===(i=c[r]))return e;if(o=10,i.length>1&&"0"===e_(i,0)&&(o=t_(v_,i)?16:8,i=l_(i,8===o?1:2)),""===i)a=0;else{if(!t_(10===o?E_:8===o?b_:y_,i))return e;a=Zg(i,o)}o_(n,a)}for(r=0;r<t;r++)if(a=n[r],r===t-1){if(a>=$g(256,5-t))return null}else if(a>255)return null;for(s=i_(n),r=0;r<n.length;r++)s+=n[r]*$g(256,3-r);return s}(e),null===t)return p_;this.host=t}else{if(t_(T_,e))return p_;for(t="",n=Mg(e),r=0;r<n.length;r++)t+=k_(n[r],I_);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return xg(D_,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&x_(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,c=e.fragment,l=t+":";return null!==i?(l+="//",e.includesCredentials()&&(l+=n+(r?":"+r:"")+"@"),l+=A_(i),null!==o&&(l+=":"+o)):"file"===t&&(l+="//"),l+=e.cannotBeABaseURL?a[0]:a.length?"/"+n_(a,"/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw new Jg(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new ov(e.path[0]).origin}catch(e){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+A_(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Vg(e)+":",U_)},getUsername:function(){return this.username},setUsername:function(e){var t=Mg(Vg(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=k_(t[n],P_)}},getPassword:function(){return this.password},setPassword:function(e){var t=Mg(Vg(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=k_(t[n],P_)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?A_(e):A_(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Y_)},getHostname:function(){var e=this.host;return null===e?"":A_(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,q_)},getPort:function(){var e=this.port;return null===e?"":Vg(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=Vg(e))?this.port=null:this.parse(e,X_))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+n_(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,$_))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=Vg(e))?this.query=null:("?"===e_(e,0)&&(e=l_(e,1)),this.query="",this.parse(e,nv)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=Vg(e))?("#"===e_(e,0)&&(e=l_(e,1)),this.fragment="",this.parse(e,rv)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ov=function(e){var t=Dg(this,av),n=Wg(arguments.length,1)>1?arguments[1]:void 0,r=zg(t,new iv(e,!1,n));Rg||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},av=ov.prototype,sv=function(e,t){return{get:function(){return Kg(this)[e]()},set:t&&function(e){return Kg(this)[t](e)},configurable:!0,enumerable:!0}};if(Rg&&(kg(av,"href",sv("serialize","setHref")),kg(av,"origin",sv("getOrigin")),kg(av,"protocol",sv("getProtocol","setProtocol")),kg(av,"username",sv("getUsername","setUsername")),kg(av,"password",sv("getPassword","setPassword")),kg(av,"host",sv("getHost","setHost")),kg(av,"hostname",sv("getHostname","setHostname")),kg(av,"port",sv("getPort","setPort")),kg(av,"pathname",sv("getPathname","setPathname")),kg(av,"search",sv("getSearch","setSearch")),kg(av,"searchParams",sv("getSearchParams")),kg(av,"hash",sv("getHash","setHash"))),Pg(av,"toJSON",function(){return Kg(this).serialize()},{enumerable:!0}),Pg(av,"toString",function(){return Kg(this).serialize()},{enumerable:!0}),Xg){var cv=Xg.createObjectURL,lv=Xg.revokeObjectURL;cv&&Pg(ov,"createObjectURL",Ng(cv,Xg)),lv&&Pg(ov,"revokeObjectURL",Ng(lv,Xg))}Bg(ov,"URL"),wg({global:!0,constructor:!0,forced:!Ag,sham:!Rg},{URL:ov});var dv=Pn,uv=i,hv=cl,pv=br,mv=sm,fv=oe("URL"),gv=mv&&uv(function(){fv.canParse()}),_v=uv(function(){return 1!==fv.canParse.length});dv({target:"URL",stat:!0,forced:!gv||_v},{canParse:function(e){var t=hv(arguments.length,1),n=pv(e),r=t<2||void 0===arguments[1]?void 0:pv(arguments[1]);try{return!!new fv(n,r)}catch(e){return!1}}});var vv=Pn,bv=cl,Ev=br,yv=sm,Sv=oe("URL");vv({target:"URL",stat:!0,forced:!yv},{parse:function(e){var t=bv(arguments.length,1),n=Ev(e),r=t<2||void 0===arguments[1]?void 0:Ev(arguments[1]);try{return new Sv(n,r)}catch(e){return null}}});var Tv=r(ee.URL);let Cv=!0,wv=!0;function Rv(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function Av(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Iv(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Cv=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Nv(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(wv=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Ov(){if("object"==typeof window){if(Cv)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function Pv(e,t){wv&&console.warn(e+" is deprecated, please use "+t+" instead.")}function kv(e){return"[object Object]"===Object.prototype.toString.call(e)}function Dv(e){var t;return kv(e)?ii(t=Object.keys(e)).call(t,function(t,n){const r=kv(e[n]),i=r?Dv(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})},{}):e}function xv(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?xv(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(t=>{xv(e,e.get(t),n)})}))}function Lv(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&xv(e,n,i)})}),i}const Mv=Ov;function Uv(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const a=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{n=n.filter(e=>"videoinput"===e.kind);let a=n.find(e=>t.some(t=>{var n;return xr(n=e.label.toLowerCase()).call(n,t)}));return!a&&n.length&&xr(t).call(t,"back")&&(a=n[n.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=r(e.video),Mv("chrome: "+JSON.stringify(e)),i(e)})}e.video=r(e.video)}return Mv("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,e=>{n.webkitGetUserMedia(e,t,e=>{r&&r(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>ip.reject(o(e))))}}}function Fv(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function jv(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Av(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Vv(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Bv(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach(e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t[n.id]=n}),t},o=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new ip((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])}).then(n,r)}}function Wv(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>Lv(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),Av(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>Lv(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?ip.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():ip.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Hv(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),i.apply(this,arguments)}}function Gv(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Hv(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find(e=>e.track===t);if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),ip.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=r[t]});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function zv(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]})}function Kv(e,t){Av(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var Yv=Object.freeze({__proto__:null,fixNegotiationNeeded:Kv,shimAddTrackRemoveTrack:Gv,shimAddTrackRemoveTrackWithNative:Hv,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:Vv,shimGetStats:Bv,shimGetUserMedia:Uv,shimMediaStream:Fv,shimOnTrack:jv,shimPeerConnection:zv,shimSenderReceiverGetStats:Wv});function qv(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){Pv("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function Xv(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Jv(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then(e=>{if(t.version<53&&!i)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(i,o)}}function Zv(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):ip.resolve(new Map)}}function Qv(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),Av(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function $v(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){Pv("removeStream","removeTrack"),this.getSenders().forEach(t=>{var n;t.track&&xr(n=e.getTracks()).call(n,t.track)&&this.removeTrack(t)})})}function eb(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function tb(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach(e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return r})}function nb(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function rb(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?ip.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ib(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?ip.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var ob=Object.freeze({__proto__:null,shimAddTransceiver:tb,shimCreateAnswer:ib,shimCreateOffer:rb,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,ip.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:nb,shimGetUserMedia:qv,shimOnTrack:Xv,shimPeerConnection:Jv,shimRTCDataChannel:eb,shimReceiverGetStats:Qv,shimRemoveStream:$v,shimSenderGetStats:Zv});function ab(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n;this._localStreams||(this._localStreams=[]),xr(n=this._localStreams).call(n,e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r&&r.forEach(e=>{var t;this._localStreams?xr(t=this._localStreams).call(t,e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{xr(n).call(n,e.track)&&this.removeTrack(e)})})}}function sb(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{var t;if(this._remoteStreams||(this._remoteStreams=[]),xr(t=this._remoteStreams).call(t,e))return;this._remoteStreams.push(e);const n=new Event("addstream");n.stream=e,this.dispatchEvent(n)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function cb(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),ip.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),ip.resolve()):i};let s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),ip.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),ip.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),ip.resolve()):r},t.addIceCandidate=s}function lb(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(db(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function db(e){return e&&void 0!==e.video?Object.assign({},e,{video:Dv(e.video)}):e}function ub(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(Pv("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function hb(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pb(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function mb(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var fb=Object.freeze({__proto__:null,shimAudioContext:mb,shimCallbacksAPI:cb,shimConstraints:db,shimCreateOfferLegacy:pb,shimGetUserMedia:lb,shimLocalStreamsAPI:ab,shimRTCIceServerUrls:ub,shimRemoteStreamsAPI:sb,shimTrackEventTransceiver:hb}),gb="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",_b=q,vb=br,bb=gb,Eb=d("".replace),yb=RegExp("^["+bb+"]+"),Sb=RegExp("(^|[^"+bb+"])["+bb+"]+$"),Tb=function(e){return function(t){var n=vb(_b(t));return 1&e&&(n=Eb(n,yb,"")),2&e&&(n=Eb(n,Sb,"$1")),n}},Cb={start:Tb(1),end:Tb(2),trim:Tb(3)},wb=Ss.PROPER,Rb=i,Ab=gb,Ib=Cb.trim;Pn({target:"String",proto:!0,forced:function(e){return Rb(function(){return!!Ab[e]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[e]()||wb&&Ab[e].name!==e})}("trim")},{trim:function(){return Ib(this)}});var Nb=er("String","trim"),Ob=u,Pb=Nb,kb=String.prototype,Db=function(e){var t=e.trim;return"string"==typeof e||e===kb||Ob(kb,e)&&t===kb.trim?Pb:t},xb=r(Db),Lb={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},t.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(e=>0===e.indexOf(n))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const r=e.substring(e.indexOf(" ")+1).split(";");for(let i=0;i<r.length;i++)n=r[i].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substring(12),password:i.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" ");n.profile=r[2];for(let o=3;o<r.length;o++){const i=r[o],a=t.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){const r=t.parseRtpMap(a),o=t.matchPrefix(e,"a=fmtp:"+i+" ");switch(r.parameters=o.length?t.parseFmtp(o[0]):{},r.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(t.parseRtcpFb),n.codecs.push(r),r.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(r.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach(e=>{n.headerExtensions.push(t.parseExtmap(e))});const i=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(e=>{i.forEach(t=>{e.rtcpFeedback.find(e=>e.type===t.type&&e.parameter===t.parameter)||e.rtcpFeedback.push(t)})}),n},t.writeRtpDescription=function(e,n){let r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(e=>{r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)});let i=0;return n.codecs.forEach(e=>{e.maxptime>i&&(i=e.maxptime)}),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(e=>{r+=t.writeExtmap(e)}),r},t.parseRtpEncodingParameters=function(e){const n=[],r=t.parseRtpParameters(e),i=-1!==r.fecMechanisms.indexOf("RED"),o=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substring(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),r.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),i&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});let d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substring(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substring(5),10)*.95-16e3:void 0,n.forEach(e=>{e.maxBitrate=d})),n},t.parseRtcpParameters=function(e){const n={},r=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const r=t.matchPrefix(e,"a=msid:");if(1===r.length)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const i=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return i.length>0?(n=i[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");let i;r.length>0&&(i=parseInt(r[0].substring(19),10)),isNaN(i)&&(i=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:i};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:i}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,r){let i;const o=void 0!==n?n:2;return i=e||t.generateSessionId(),"v=0\r\no="+(r||"thisisadapterortc")+" "+i+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const r=t.splitLines(e);for(let t=0;t<r.length;t++)switch(r[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(Lb);var Mb=Lb.exports,Ub=r(Mb),Fb=e({__proto__:null,default:Ub},[Mb]);function jb(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=Ub.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Av(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Vb(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Av(e,"icecandidate",e=>{if(e.candidate){const t=Ub.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Bb(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=Ub.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=Ub.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=Ub.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=o(arguments[0],e);let a;a=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const s={};Object.defineProperty(s,"maxMessageSize",{get:()=>a}),this._sctp=s}return a.apply(this,arguments)}}function Wb(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Av(e,"datachannel",e=>(t(e.channel,e.target),e))}function Hb(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function Gb(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==xb(e).call(e)).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function zb(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?ip.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),ip.resolve())})}function Kb(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(e=>n.apply(this,[e]))})}var Yb=Object.freeze({__proto__:null,removeExtmapAllowMixed:Gb,shimAddIceCandidateNullOrEmpty:zb,shimConnectionState:Hb,shimMaxMessageSize:Bb,shimParameterlessSetLocalDescription:Kb,shimRTCIceCandidate:jb,shimRTCIceCandidateRelayProtocol:Vb,shimSendThrowTypeError:Wb});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Ov,r=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Rv(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Rv(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Rv(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:Yb,extractVersion:Rv,disableLog:Iv,disableWarnings:Nv,sdp:Fb};switch(r.browser){case"chrome":if(!Yv||!zv||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Yv,zb(e,r),Kb(e),Uv(e,r),Fv(e),zv(e,r),jv(e),Gv(e,r),Vv(e),Bv(e),Wv(e),Kv(e,r),jb(e),Vb(e),Hb(e),Bb(e,r),Wb(e),Gb(e,r);break;case"firefox":if(!ob||!Jv||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=ob,zb(e,r),Kb(e),qv(e,r),Jv(e,r),Xv(e),$v(e),Zv(e),Qv(e),eb(e),tb(e),nb(e),rb(e),ib(e),jb(e),Hb(e),Bb(e,r),Wb(e);break;case"safari":if(!fb||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=fb,zb(e,r),Kb(e),ub(e),pb(e),cb(e),ab(e),sb(e),hb(e),lb(e),mb(e),jb(e),Vb(e),Bb(e,r),Wb(e),Gb(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var qb=i,Xb=p.RegExp,Jb=!qb(function(){var e=!0;try{Xb(".","d")}catch(t){e=!1}var t={},n="",r=e?"dgimsy":"gimsy",i=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(o.hasIndices="d"),o)i(a,o[a]);return Object.getOwnPropertyDescriptor(Xb.prototype,"flags").get.call(t)!==r||n!==r}),Zb=on,Qb=k,$b=et,eE=u,tE={correct:Jb},nE=function(){var e=Zb(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},rE=RegExp.prototype,iE=tE.correct?function(e){return e.flags}:function(e){return tE.correct||!eE(rE,e)||$b(e,"flags")?e.flags:Qb(nE,e)},oE=d,aE=Ze,sE=Math.floor,cE=oE("".charAt),lE=oE("".replace),dE=oE("".slice),uE=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,hE=/\$([$&'`]|\d{1,2})/g,pE=Pn,mE=k,fE=d,gE=q,_E=A,vE=$,bE=or,EE=br,yE=xe,SE=iE,TE=function(e,t,n,r,i,o){var a=n+e.length,s=r.length,c=hE;return void 0!==i&&(i=aE(i),c=uE),lE(o,c,function(o,c){var l;switch(cE(c,0)){case"$":return"$";case"&":return e;case"`":return dE(t,0,n);case"'":return dE(t,a);case"<":l=i[dE(c,1,-1)];break;default:var d=+c;if(0===d)return o;if(d>s){var u=sE(d/10);return 0===u?o:u<=s?void 0===r[u-1]?cE(c,1):r[u-1]+cE(c,1):o}l=r[d-1]}return void 0===l?"":l})},CE=mt("replace"),wE=TypeError,RE=fE("".indexOf),AE=fE("".replace),IE=fE("".slice),NE=Math.max;pE({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,o,a,s,c,l,d,u,h=gE(this),p=0,m="";if(vE(e)){if((n=bE(e))&&(r=EE(gE(SE(e))),!~RE(r,"g")))throw new wE("`.replaceAll` does not allow non-global regexes");if(i=yE(e,CE))return mE(i,e,h,t);if(n)return AE(EE(h),e,t)}for(o=EE(h),a=EE(e),(s=_E(t))||(t=EE(t)),c=a.length,l=NE(1,c),d=RE(o,a);-1!==d;)u=s?EE(t(a,d,o)):TE(a,o,d,[],void 0,t),m+=IE(o,p,d)+u,p=d+c,d=d+l>o.length?-1:RE(o,a,d+l);return p<o.length&&(m+=IE(o,p)),m}});var OE=er("String","replaceAll"),PE=u,kE=OE,DE=String.prototype,xE=function(e){var t=e.replaceAll;return"string"==typeof e||e===DE||PE(DE,e)&&t===DE.replaceAll?kE:t},LE=r(xE),ME=p;Pn({global:!0,forced:ME.globalThis!==ME},{globalThis:ME});var UE=r(p),FE={exports:{}};!function(e,n){!function(t,r){var i="function",o="undefined",a="object",s="string",c="major",l="model",d="name",u="type",h="vendor",p="version",m="architecture",f="console",g="mobile",_="tablet",v="smarttv",b="wearable",E="embedded",y="Amazon",S="Apple",T="ASUS",C="BlackBerry",w="Browser",R="Chrome",A="Firefox",I="Google",N="Honor",O="Huawei",P="LG",k="Microsoft",D="Motorola",x="Nvidia",L="OnePlus",M="Opera",U="OPPO",F="Samsung",j="Sharp",V="Sony",B="Xiaomi",W="Zebra",H="Facebook",G="Chromium OS",z="Mac OS",K=" Browser",Y=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},q=function(e,t){return typeof e===s&&-1!==X(t).indexOf(X(e))},X=function(e){return e.toLowerCase()},J=function(e,t){if(typeof e===s)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},Z=function(e,t){for(var n,o,s,c,l,d,u=0;u<t.length&&!l;){var h=t[u],p=t[u+1];for(n=o=0;n<h.length&&!l&&h[n];)if(l=h[n++].exec(e))for(s=0;s<p.length;s++)d=l[++o],typeof(c=p[s])===a&&c.length>0?2===c.length?typeof c[1]==i?this[c[0]]=c[1].call(this,d):this[c[0]]=c[1]:3===c.length?typeof c[1]!==i||c[1].exec&&c[1].test?this[c[0]]=d?d.replace(c[1],c[2]):r:this[c[0]]=d?c[1].call(this,d,c[2]):r:4===c.length&&(this[c[0]]=d?c[3].call(this,d.replace(c[1],c[2])):r):this[c]=d||r;u+=2}},Q=function(e,t){for(var n in t)if(typeof t[n]===a&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(q(t[n][i],e))return"?"===n?r:n}else if(q(t[n],e))return"?"===n?r:n;return t.hasOwnProperty("*")?t["*"]:e},$={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ee={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[d,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[d,p],[/opios[\/ ]+([\w\.]+)/i],[p,[d,M+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[p,[d,M+" GX"]],[/\bopr\/([\w\.]+)/i],[p,[d,M]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[d,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[p,[d,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[d,p],[/quark(?:pc)?\/([-\w\.]+)/i],[p,[d,"Quark"]],[/\bddg\/([\w\.]+)/i],[p,[d,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[d,"UC"+w]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[d,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[d,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[d,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[d,"Smart Lenovo "+w]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure "+w],p],[/\bfocus\/([\w\.]+)/i],[p,[d,A+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[d,M+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[d,M+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[d,"MIUI"+K]],[/fxios\/([\w\.-]+)/i],[p,[d,A]],[/\bqihoobrowser\/?([\w\.]*)/i],[p,[d,"360"]],[/\b(qq)\/([\w\.]+)/i],[[d,/(.+)/,"$1Browser"],p],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1"+K],p],[/samsungbrowser\/([\w\.]+)/i],[p,[d,F+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[p,[d,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[d,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[d,p],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[d],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[p,d],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[d,H],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[d,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[d,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[d,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[d,R+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[d,R+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[d,"Android "+w]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[d,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[d,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,d],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[d,[p,Q,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[d,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[d,"Netscape"],p],[/(wolvic|librewolf)\/([\w\.]+)/i],[d,p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[d,A+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[d,[p,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[d,[p,/master.|lts./,""]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[m,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[m,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[m,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[m,/ower/,"",X]],[/ sun4\w[;\)]/i],[[m,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[m,X]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[h,F],[u,_]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[l,[h,F],[u,g]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[l,[h,S],[u,g]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[h,S],[u,_]],[/(macintosh);/i],[l,[h,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[h,j],[u,g]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[l,[h,N],[u,_]],[/honor([-\w ]+)[;\)]/i],[l,[h,N],[u,g]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[l,[h,O],[u,_]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[h,O],[u,g]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[l,/_/g," "],[h,B],[u,_]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[l,/_/g," "],[h,B],[u,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[h,U],[u,g]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[l,[h,Q,{OnePlus:["304","403","203"],"*":U}],[u,_]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[h,"Vivo"],[u,g]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[l,[h,"Realme"],[u,g]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[h,D],[u,g]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[h,D],[u,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[h,P],[u,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv|watch)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[h,P],[u,g]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[l,[h,"Lenovo"],[u,_]],[/(nokia) (t[12][01])/i],[h,l,[u,_]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[l,/_/g," "],[u,g],[h,"Nokia"]],[/(pixel (c|tablet))\b/i],[l,[h,I],[u,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[h,I],[u,g]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[h,V],[u,g]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[h,V],[u,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[h,L],[u,g]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[h,y],[u,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[h,y],[u,g]],[/(playbook);[-\w\),; ]+(rim)/i],[l,h,[u,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[h,C],[u,g]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[h,T],[u,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[h,T],[u,g]],[/(nexus 9)/i],[l,[h,"HTC"],[u,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[l,/_/g," "],[u,g]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[l,[h,"TCL"],[u,_]],[/(itel) ((\w+))/i],[[h,X],l,[u,Q,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[h,"Acer"],[u,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[h,"Meizu"],[u,g]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[l,[h,"Ulefone"],[u,g]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[l,[h,"Energizer"],[u,g]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[l,[h,"Cat"],[u,g]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[l,[h,"Smartfren"],[u,g]],[/droid.+; (a(?:015|06[35]|142p?))/i],[l,[h,"Nothing"],[u,g]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[l,[h,"Archos"],[u,_]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[l,[h,"Archos"],[u,g]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[h,l,[u,_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (hmd|imo) ([\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[h,l,[u,g]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,l,[u,_]],[/(surface duo)/i],[l,[h,k],[u,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[h,"Fairphone"],[u,g]],[/(u304aa)/i],[l,[h,"AT&T"],[u,g]],[/\bsie-(\w*)/i],[l,[h,"Siemens"],[u,g]],[/\b(rct\w+) b/i],[l,[h,"RCA"],[u,_]],[/\b(venue[\d ]{2,7}) b/i],[l,[h,"Dell"],[u,_]],[/\b(q(?:mv|ta)\w+) b/i],[l,[h,"Verizon"],[u,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[h,"Barnes & Noble"],[u,_]],[/\b(tm\d{3}\w+) b/i],[l,[h,"NuVision"],[u,_]],[/\b(k88) b/i],[l,[h,"ZTE"],[u,_]],[/\b(nx\d{3}j) b/i],[l,[h,"ZTE"],[u,g]],[/\b(gen\d{3}) b.+49h/i],[l,[h,"Swiss"],[u,g]],[/\b(zur\d{3}) b/i],[l,[h,"Swiss"],[u,_]],[/\b((zeki)?tb.*\b) b/i],[l,[h,"Zeki"],[u,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],l,[u,_]],[/\b(ns-?\w{0,9}) b/i],[l,[h,"Insignia"],[u,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[h,"NextBook"],[u,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],l,[u,g]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],l,[u,g]],[/\b(ph-1) /i],[l,[h,"Essential"],[u,g]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[h,"Envizen"],[u,_]],[/\b(trio[-\w\. ]+) b/i],[l,[h,"MachSpeed"],[u,_]],[/\btu_(1491) b/i],[l,[h,"Rotor"],[u,_]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[l,[h,x],[u,_]],[/(sprint) (\w+)/i],[h,l,[u,g]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[h,k],[u,g]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[h,W],[u,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[h,W],[u,g]],[/smart-tv.+(samsung)/i],[h,[u,v]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[h,F],[u,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,P],[u,v]],[/(apple) ?tv/i],[h,[l,S+" TV"],[u,v]],[/crkey/i],[[l,R+"cast"],[h,I],[u,v]],[/droid.+aft(\w+)( bui|\))/i],[l,[h,y],[u,v]],[/(shield \w+ tv)/i],[l,[h,x],[u,v]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[l,[h,j],[u,v]],[/(bravia[\w ]+)( bui|\))/i],[l,[h,V],[u,v]],[/(mi(tv|box)-?\w+) bui/i],[l,[h,B],[u,v]],[/Hbbtv.*(technisat) (.*);/i],[h,l,[u,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,J],[l,J],[u,v]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[l,[u,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,l,[u,f]],[/droid.+; (shield)( bui|\))/i],[l,[h,x],[u,f]],[/(playstation \w+)/i],[l,[h,V],[u,f]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[h,k],[u,f]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[l,[h,F],[u,b]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[h,l,[u,b]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[l,[h,U],[u,b]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[l,[h,S],[u,b]],[/(opwwe\d{3})/i],[l,[h,L],[u,b]],[/(moto 360)/i],[l,[h,D],[u,b]],[/(smartwatch 3)/i],[l,[h,V],[u,b]],[/(g watch r)/i],[l,[h,P],[u,b]],[/droid.+; (wt63?0{2,3})\)/i],[l,[h,W],[u,b]],[/droid.+; (glass) \d/i],[l,[h,I],[u,b]],[/(pico) (4|neo3(?: link|pro)?)/i],[h,l,[u,b]],[/; (quest( \d| pro)?)/i],[l,[h,H],[u,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[u,E]],[/(aeobc)\b/i],[l,[h,y],[u,E]],[/(homepod).+mac os/i],[l,[h,S],[u,E]],[/windows iot/i],[[u,E]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[l,[u,g]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[u,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[u,g]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[l,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[d,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[d,p],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[d,p],[/ladybird\//i],[[d,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,d]],os:[[/microsoft (windows) (vista|xp)/i],[d,p],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[d,[p,Q,$]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,Q,$],[d,"Windows"]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[d,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[d,z],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,d],[/(ubuntu) ([\w\.]+) like android/i],[[d,/(.+)/,"$1 Touch"],p],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/; ]?([\d\.]*)/i],[d,p],[/\(bb(10);/i],[p,[d,C]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[p,[d,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[d,A+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[d,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[d,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[d,R+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[d,G],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[d,p],[/(sunos) ?([\w\.\d]*)/i],[[d,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[d,p]]},te=function(e,n){if(typeof e===a&&(n=e,e=r),!(this instanceof te))return new te(e,n).getResult();var f=typeof t!==o&&t.navigator?t.navigator:r,v=e||(f&&f.userAgent?f.userAgent:""),b=f&&f.userAgentData?f.userAgentData:r,E=n?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(ee,n):ee,y=f&&f.userAgent==v;return this.getBrowser=function(){var e={};return e[d]=r,e[p]=r,Z.call(e,v,E.browser),e[c]=function(e){return typeof e===s?e.replace(/[^\d\.]/g,"").split(".")[0]:r}(e[p]),y&&f&&f.brave&&typeof f.brave.isBrave==i&&(e[d]="Brave"),e},this.getCPU=function(){var e={};return e[m]=r,Z.call(e,v,E.cpu),e},this.getDevice=function(){var e={};return e[h]=r,e[l]=r,e[u]=r,Z.call(e,v,E.device),y&&!e[u]&&b&&b.mobile&&(e[u]=g),y&&"Macintosh"==e[l]&&f&&typeof f.standalone!==o&&f.maxTouchPoints&&f.maxTouchPoints>2&&(e[l]="iPad",e[u]=_),e},this.getEngine=function(){var e={};return e[d]=r,e[p]=r,Z.call(e,v,E.engine),e},this.getOS=function(){var e={};return e[d]=r,e[p]=r,Z.call(e,v,E.os),y&&!e[d]&&b&&b.platform&&"Unknown"!=b.platform&&(e[d]=b.platform.replace(/chrome os/i,G).replace(/macos/i,z)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return v},this.setUA=function(e){return v=typeof e===s&&e.length>500?J(e,500):e,this},this.setUA(v),this};te.VERSION="0.7.41",te.BROWSER=Y([d,p,c]),te.CPU=Y([m]),te.DEVICE=Y([l,h,u,f,g,v,_,b,E]),te.ENGINE=te.OS=Y([d,p]),e.exports&&(n=e.exports=te),n.UAParser=te;var ne=typeof t!==o&&(t.jQuery||t.Zepto);if(ne&&!ne.ua){var re=new te;ne.ua=re.getResult(),ne.ua.get=function(){return re.getUA()},ne.ua.set=function(e){re.setUA(e);var t=re.getResult();for(var n in t)ne.ua[n]=t[n]}}}("object"==typeof window?window:t)}(FE,FE.exports);var jE=r(FE.exports),VE=Ml.clear;Pn({global:!0,bind:!0,enumerable:!0,forced:p.clearImmediate!==VE},{clearImmediate:VE});var BE=p,WE=v,HE=A,GE=Xr,zE=ce,KE=al,YE=cl,qE=BE.Function,XE=/MSIE .\./.test(zE)||"BUN"===GE&&function(){var e=BE.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),JE=Pn,ZE=p,QE=Ml.set,$E=function(e,t){var n=t?2:1;return XE?function(r,i){var o=YE(arguments.length,1)>n,a=HE(r)?r:qE(r),s=o?KE(arguments,n):[],c=o?function(){WE(a,this,s)}:a;return t?e(c,i):e(c)}:e},ey=ZE.setImmediate?$E(QE,!1):QE;JE({global:!0,bind:!0,enumerable:!0,forced:ZE.setImmediate!==ey},{setImmediate:ey});var ty=r(ee.setImmediate),ny=p,ry=hd,iy=Pe,oy=cl,ay=N;Pn({global:!0,enumerable:!0,dontCallGetSet:!0,forced:i(function(){return ay&&1!==Object.getOwnPropertyDescriptor(ny,"queueMicrotask").value.length})},{queueMicrotask:function(e){oy(arguments.length,1),ry(iy(e))}});var sy=r(ee.queueMicrotask);function cy(e,t){return function(){return e.apply(t,arguments)}}const{toString:ly}=Object.prototype,{getPrototypeOf:dy}=Object,{iterator:uy,toStringTag:hy}=Symbol,py=(my=Object.create(null),e=>{const t=ly.call(e);return my[t]||(my[t]=t.slice(8,-1).toLowerCase())});var my;const fy=e=>(e=e.toLowerCase(),t=>py(t)===e),gy=e=>t=>typeof t===e,{isArray:_y}=Array,vy=gy("undefined");function by(e){return null!==e&&!vy(e)&&null!==e.constructor&&!vy(e.constructor)&&Sy(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ey=fy("ArrayBuffer"),yy=gy("string"),Sy=gy("function"),Ty=gy("number"),Cy=e=>null!==e&&"object"==typeof e,wy=e=>{if("object"!==py(e))return!1;const t=dy(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||hy in e||uy in e)},Ry=fy("Date"),Ay=fy("File"),Iy=fy("Blob"),Ny=fy("FileList"),Oy=fy("URLSearchParams"),[Py,ky,Dy,xy]=["ReadableStream","Request","Response","Headers"].map(fy);function Ly(e,t){let n,r,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e)if("object"!=typeof e&&(e=[e]),_y(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(by(e))return;const r=i?Object.getOwnPropertyNames(e):Object.keys(e),o=r.length;let a;for(n=0;n<o;n++)a=r[n],t.call(null,e[a],a,e)}}function My(e,t){if(by(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const Uy=void 0!==UE?UE:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n.g,Fy=e=>!vy(e)&&e!==Uy,jy=(Vy="undefined"!=typeof Uint8Array&&dy(Uint8Array),e=>Vy&&e instanceof Vy);var Vy;const By=fy("HTMLFormElement"),Wy=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),Hy=fy("RegExp"),Gy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Ly(n,(n,i)=>{let o;!1!==(o=t(n,i,e))&&(r[i]=o||n)}),Object.defineProperties(e,r)},zy=fy("AsyncFunction"),Ky=(Yy="function"==typeof ty,qy=Sy(Uy.postMessage),Yy?ty:qy?(Xy="axios@".concat(Math.random()),Jy=[],Uy.addEventListener("message",e=>{let{source:t,data:n}=e;t===Uy&&n===Xy&&Jy.length&&Jy.shift()()},!1),e=>{Jy.push(e),Uy.postMessage(Xy,"*")}):e=>setTimeout(e));var Yy,qy,Xy,Jy;const Zy=void 0!==sy?sy.bind(Uy):"undefined"!=typeof process&&process.nextTick||Ky;var Qy={isArray:_y,isArrayBuffer:Ey,isBuffer:by,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Sy(e.append)&&("formdata"===(t=py(e))||"object"===t&&Sy(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Ey(e.buffer),t},isString:yy,isNumber:Ty,isBoolean:e=>!0===e||!1===e,isObject:Cy,isPlainObject:wy,isEmptyObject:e=>{if(!Cy(e)||by(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(e){return!1}},isReadableStream:Py,isRequest:ky,isResponse:Dy,isHeaders:xy,isUndefined:vy,isDate:Ry,isFile:Ay,isBlob:Iy,isRegExp:Hy,isFunction:Sy,isStream:e=>Cy(e)&&Sy(e.pipe),isURLSearchParams:Oy,isTypedArray:jy,isFileList:Ny,forEach:Ly,merge:function e(){const{caseless:t,skipUndefined:n}=Fy(this)&&this||{},r={},i=(i,o)=>{const a=t&&My(r,o)||o;wy(r[a])&&wy(i)?r[a]=e(r[a],i):wy(i)?r[a]=e({},i):_y(i)?r[a]=i.slice():n&&vy(i)||(r[a]=i)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&Ly(arguments[o],i);return r},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ly(t,(t,r)=>{n&&Sy(t)?e[r]=cy(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>xb(e)?xb(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,o,a;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)a=i[o],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&dy(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:py,kindOfTest:fy,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(_y(e))return e;let t=e.length;if(!Ty(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[uy]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:By,hasOwnProperty:Wy,hasOwnProp:Wy,reduceDescriptors:Gy,freezeMethods:e=>{Gy(e,(t,n)=>{if(Sy(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Sy(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return _y(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:My,global:Uy,isContextDefined:Fy,isSpecCompliantForm:function(e){return!!(e&&Sy(e.append)&&"FormData"===e[hy]&&e[uy])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Cy(e)){if(t.indexOf(e)>=0)return;if(by(e))return e;if(!("toJSON"in e)){t[r]=e;const i=_y(e)?[]:{};return Ly(e,(e,t)=>{const o=n(e,r+1);!vy(o)&&(i[t]=o)}),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:zy,isThenable:e=>e&&(Cy(e)||Sy(e))&&Sy(e.then)&&Sy(e.catch),setImmediate:Ky,asap:Zy,isIterable:e=>null!=e&&Sy(e[uy])};function $y(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Qy.inherits($y,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Qy.toJSONObject(this.config),code:this.code,status:this.status}}});const eS=$y.prototype,tS={};function nS(e){return Qy.isPlainObject(e)||Qy.isArray(e)}function rS(e){return Qy.endsWith(e,"[]")?e.slice(0,-2):e}function iS(e,t,n){return e?e.concat(t).map(function(e,t){return e=rS(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{tS[e]={value:e}}),Object.defineProperties($y,tS),Object.defineProperty(eS,"isAxiosError",{value:!0}),$y.from=(e,t,n,r,i,o)=>{const a=Object.create(eS);Qy.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const s=e&&e.message?e.message:"Error",c=null==t&&e?e.code:t;return $y.call(a,s,c,n,r,i),e&&null==a.cause&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",o&&Object.assign(a,o),a};const oS=Qy.toFlatObject(Qy,{},null,function(e){return/^is[A-Z]/.test(e)});function aS(e,t,n){if(!Qy.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=Qy.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Qy.isUndefined(t[e])})).metaTokens,i=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Qy.isSpecCompliantForm(t);if(!Qy.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Qy.isDate(e))return e.toISOString();if(Qy.isBoolean(e))return e.toString();if(!s&&Qy.isBlob(e))throw new $y("Blob is not supported. Use a Buffer instead.");return Qy.isArrayBuffer(e)||Qy.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,i){let s=e;if(e&&!i&&"object"==typeof e)if(Qy.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(Qy.isArray(e)&&function(e){return Qy.isArray(e)&&!e.some(nS)}(e)||(Qy.isFileList(e)||Qy.endsWith(n,"[]"))&&(s=Qy.toArray(e)))return n=rS(n),s.forEach(function(e,r){!Qy.isUndefined(e)&&null!==e&&t.append(!0===a?iS([n],r,o):null===a?n:n+"[]",c(e))}),!1;return!!nS(e)||(t.append(iS(i,n,o),c(e)),!1)}const d=[],u=Object.assign(oS,{defaultVisitor:l,convertValue:c,isVisitable:nS});if(!Qy.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!Qy.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),Qy.forEach(n,function(n,o){!0===(!(Qy.isUndefined(n)||null===n)&&i.call(t,n,Qy.isString(o)?xb(o).call(o):o,r,u))&&e(n,r?r.concat(o):[o])}),d.pop()}}(e),t}function sS(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function cS(e,t){this._pairs=[],e&&aS(e,this,t)}const lS=cS.prototype;function dS(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function uS(e,t,n){if(!t)return e;const r=n&&n.encode||dS;Qy.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let o;if(o=i?i(t,n):Qy.isURLSearchParams(t)?t.toString():new cS(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}lS.append=function(e,t){this._pairs.push([e,t])},lS.toString=function(e){const t=e?function(t){return e.call(this,t,sS)}:sS;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};var hS=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Qy.forEach(this.handlers,function(t){null!==t&&e(t)})}},pS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mS={exports:{}},fS=Pn,gS=N,_S=$t.f;fS({target:"Object",stat:!0,forced:Object.defineProperty!==_S,sham:!gS},{defineProperty:_S});var vS=ee.Object,bS=mS.exports=function(e,t,n){return vS.defineProperty(e,t,n)};vS.defineProperty.sham&&(bS.sham=!0);var ES=r(mS.exports),yS=TypeError,SS=ai,TS=Zc,CS=$,wS=mt("species"),RS=Array,AS=function(e){var t;return SS(e)&&(t=e.constructor,(TS(t)&&(t===RS||SS(t.prototype))||CS(t)&&null===(t=t[wS]))&&(t=void 0)),void 0===t?RS:t},IS=function(e,t){return new(AS(e))(0===t?0:t)},NS=i,OS=fe,PS=mt("species"),kS=function(e){return OS>=51||!NS(function(){var t=[];return(t.constructor={})[PS]=function(){return{foo:1}},1!==t[e](Boolean).foo})},DS=Pn,xS=i,LS=ai,MS=$,US=Ze,FS=zn,jS=function(e){if(e>9007199254740991)throw yS("Maximum allowed index exceeded");return e},VS=Xf,BS=IS,WS=kS,HS=fe,GS=mt("isConcatSpreadable"),zS=HS>=51||!xS(function(){var e=[];return e[GS]=!1,e.concat()[0]!==e}),KS=function(e){if(!MS(e))return!1;var t=e[GS];return void 0!==t?!!t:LS(e)};DS({target:"Array",proto:!0,arity:1,forced:!zS||!WS("concat")},{concat:function(e){var t,n,r,i,o,a=US(this),s=BS(a,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(KS(o=-1===t?a:arguments[t]))for(i=FS(o),jS(c+i),n=0;n<i;n++,c++)n in o&&VS(s,c,o[n]);else jS(c+1),VS(s,c++,o);return s.length=c,s}});var YS={},qS=S,XS=Z,JS=Bi.f,ZS=al,QS="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];YS.f=function(e){return QS&&"Window"===qS(e)?function(e){try{return JS(e)}catch(e){return ZS(QS)}}(e):JS(XS(e))};var $S={},eT=mt;$S.f=eT;var tT=ee,nT=et,rT=$S,iT=$t.f,oT=function(e){var t=tT.Symbol||(tT.Symbol={});nT(t,e)||iT(t,e,{value:rT.f(e)})},aT=k,sT=oe,cT=mt,lT=Cs,dT=function(){var e=sT("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,r=cT("toPrimitive");t&&!t[r]&&lT(t,r,function(e){return aT(n,this)},{arity:1})},uT=Qt,hT=G,pT=Ze,mT=zn,fT=IS,gT=d([].push),_T=function(e){var t=1===e,n=2===e,r=3===e,i=4===e,o=6===e,a=7===e,s=5===e||o;return function(c,l,d,u){for(var h,p,m=pT(c),f=hT(m),g=mT(f),_=uT(l,d),v=0,b=u||fT,E=t?b(c,g):n||a?b(c,0):void 0;g>v;v++)if((s||v in f)&&(p=_(h=f[v],v,m),e))if(t)E[v]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return v;case 2:gT(E,h)}else switch(e){case 4:return!1;case 7:gT(E,h)}return o?-1:r||i?i:E}},vT={forEach:_T(0),map:_T(1),filter:_T(2),some:_T(3),every:_T(4),find:_T(5),findIndex:_T(6),filterReject:_T(7)},bT=Pn,ET=p,yT=k,ST=d,TT=N,CT=be,wT=i,RT=et,AT=u,IT=on,NT=Z,OT=Ct,PT=br,kT=j,DT=Lo,xT=po,LT=Bi,MT=YS,UT=Qi,FT=I,jT=$t,VT=lo,BT=D,WT=Cs,HT=Tc,GT=qe,zT=Wi,KT=ot,YT=mt,qT=$S,XT=oT,JT=dT,ZT=Hs,QT=gs,$T=vT.forEach,eC=Ei("hidden"),tC="Symbol",nC="prototype",rC=QT.set,iC=QT.getterFor(tC),oC=Object[nC],aC=ET.Symbol,sC=aC&&aC[nC],cC=ET.RangeError,lC=ET.TypeError,dC=ET.QObject,uC=FT.f,hC=jT.f,pC=MT.f,mC=BT.f,fC=ST([].push),gC=GT("symbols"),_C=GT("op-symbols"),vC=GT("wks"),bC=!dC||!dC[nC]||!dC[nC].findChild,EC=function(e,t,n){var r=uC(oC,t);r&&delete oC[t],hC(e,t,n),r&&e!==oC&&hC(oC,t,r)},yC=TT&&wT(function(){return 7!==DT(hC({},"a",{get:function(){return hC(this,"a",{value:7}).a}})).a})?EC:hC,SC=function(e,t){var n=gC[e]=DT(sC);return rC(n,{type:tC,tag:e,description:t}),TT||(n.description=t),n},TC=function(e,t,n){e===oC&&TC(_C,t,n),IT(e);var r=OT(t);return IT(n),RT(gC,r)?(n.enumerable?(RT(e,eC)&&e[eC][r]&&(e[eC][r]=!1),n=DT(n,{enumerable:kT(0,!1)})):(RT(e,eC)||hC(e,eC,kT(1,DT(null))),e[eC][r]=!0),yC(e,r,n)):hC(e,r,n)},CC=function(e,t){IT(e);var n=NT(t),r=xT(n).concat(IC(n));return $T(r,function(t){TT&&!yT(wC,n,t)||TC(e,t,n[t])}),e},wC=function(e){var t=OT(e),n=yT(mC,this,t);return!(this===oC&&RT(gC,t)&&!RT(_C,t))&&(!(n||!RT(this,t)||!RT(gC,t)||RT(this,eC)&&this[eC][t])||n)},RC=function(e,t){var n=NT(e),r=OT(t);if(n!==oC||!RT(gC,r)||RT(_C,r)){var i=uC(n,r);return!i||!RT(gC,r)||RT(n,eC)&&n[eC][r]||(i.enumerable=!0),i}},AC=function(e){var t=pC(NT(e)),n=[];return $T(t,function(e){RT(gC,e)||RT(zT,e)||fC(n,e)}),n},IC=function(e){var t=e===oC,n=pC(t?_C:NT(e)),r=[];return $T(n,function(e){!RT(gC,e)||t&&!RT(oC,e)||fC(r,gC[e])}),r};CT||(aC=function(){if(AT(sC,this))throw new lC("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?PT(arguments[0]):void 0,t=KT(e),n=function(e){var r=void 0===this?ET:this;r===oC&&yT(n,_C,e),RT(r,eC)&&RT(r[eC],t)&&(r[eC][t]=!1);var i=kT(1,e);try{yC(r,t,i)}catch(e){if(!(e instanceof cC))throw e;EC(r,t,i)}};return TT&&bC&&yC(oC,t,{configurable:!0,set:n}),SC(t,e)},WT(sC=aC[nC],"toString",function(){return iC(this).tag}),WT(aC,"withoutSetter",function(e){return SC(KT(e),e)}),BT.f=wC,jT.f=TC,VT.f=CC,FT.f=RC,LT.f=MT.f=AC,UT.f=IC,qT.f=function(e){return SC(YT(e),e)},TT&&HT(sC,"description",{configurable:!0,get:function(){return iC(this).description}})),bT({global:!0,constructor:!0,wrap:!0,forced:!CT,sham:!CT},{Symbol:aC}),$T(xT(vC),function(e){XT(e)}),bT({target:tC,stat:!0,forced:!CT},{useSetter:function(){bC=!0},useSimple:function(){bC=!1}}),bT({target:"Object",stat:!0,forced:!CT,sham:!TT},{create:function(e,t){return void 0===t?DT(e):CC(DT(e),t)},defineProperty:TC,defineProperties:CC,getOwnPropertyDescriptor:RC}),bT({target:"Object",stat:!0,forced:!CT},{getOwnPropertyNames:AC}),JT(),ZT(aC,tC),zT[eC]=!0;var NC=be&&!!Symbol.for&&!!Symbol.keyFor,OC=Pn,PC=oe,kC=et,DC=br,xC=qe,LC=NC,MC=xC("string-to-symbol-registry"),UC=xC("symbol-to-string-registry");OC({target:"Symbol",stat:!0,forced:!LC},{for:function(e){var t=DC(e);if(kC(MC,t))return MC[t];var n=PC("Symbol")(t);return MC[t]=n,UC[n]=t,n}});var FC=Pn,jC=et,VC=we,BC=Ae,WC=NC,HC=qe("symbol-to-string-registry");FC({target:"Symbol",stat:!0,forced:!WC},{keyFor:function(e){if(!VC(e))throw new TypeError(BC(e)+" is not a symbol");if(jC(HC,e))return HC[e]}});var GC=ai,zC=A,KC=S,YC=br,qC=d([].push),XC=Pn,JC=oe,ZC=v,QC=k,$C=d,ew=i,tw=A,nw=we,rw=al,iw=function(e){if(zC(e))return e;if(GC(e)){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];"string"==typeof i?qC(n,i):"number"!=typeof i&&"Number"!==KC(i)&&"String"!==KC(i)||qC(n,YC(i))}var o=n.length,a=!0;return function(e,t){if(a)return a=!1,t;if(GC(this))return t;for(var r=0;r<o;r++)if(n[r]===e)return t}}},ow=be,aw=String,sw=JC("JSON","stringify"),cw=$C(/./.exec),lw=$C("".charAt),dw=$C("".charCodeAt),uw=$C("".replace),hw=$C(1.1.toString),pw=/[\uD800-\uDFFF]/g,mw=/^[\uD800-\uDBFF]$/,fw=/^[\uDC00-\uDFFF]$/,gw=!ow||ew(function(){var e=JC("Symbol")("stringify detection");return"[null]"!==sw([e])||"{}"!==sw({a:e})||"{}"!==sw(Object(e))}),_w=ew(function(){return'"\\udf06\\ud834"'!==sw("\udf06\ud834")||'"\\udead"'!==sw("\udead")}),vw=function(e,t){var n=rw(arguments),r=iw(t);if(tw(r)||void 0!==e&&!nw(e))return n[1]=function(e,t){if(tw(r)&&(t=QC(r,this,aw(e),t)),!nw(t))return t},ZC(sw,null,n)},bw=function(e,t,n){var r=lw(n,t-1),i=lw(n,t+1);return cw(mw,e)&&!cw(fw,i)||cw(fw,e)&&!cw(mw,r)?"\\u"+hw(dw(e,0),16):e};sw&&XC({target:"JSON",stat:!0,arity:3,forced:gw||_w},{stringify:function(e,t,n){var r=rw(arguments),i=ZC(gw?vw:sw,null,r);return _w&&"string"==typeof i?uw(i,pw,bw):i}});var Ew=Qi,yw=Ze;Pn({target:"Object",stat:!0,forced:!be||i(function(){Ew.f(1)})},{getOwnPropertySymbols:function(e){var t=Ew.f;return t?t(yw(e)):[]}}),oT("asyncDispose"),oT("asyncIterator"),oT("dispose"),oT("hasInstance"),oT("isConcatSpreadable"),oT("iterator"),oT("match"),oT("matchAll"),oT("replace"),oT("search"),oT("species"),oT("split");var Sw=dT;oT("toPrimitive"),Sw();var Tw=oe,Cw=Hs;oT("toStringTag"),Cw(Tw("Symbol"),"Symbol"),oT("unscopables"),Hs(p.JSON,"JSON",!0);var ww=ee.Symbol,Rw=mt,Aw=$t.f,Iw=Rw("metadata"),Nw=Function.prototype;void 0===Nw[Iw]&&Aw(Nw,Iw,{value:null}),oT("metadata");var Ow=ww,Pw=d,kw=oe("Symbol"),Dw=kw.keyFor,xw=Pw(kw.prototype.valueOf),Lw=kw.isRegisteredSymbol||function(e){try{return void 0!==Dw(xw(e))}catch(e){return!1}};Pn({target:"Symbol",stat:!0},{isRegisteredSymbol:Lw});for(var Mw=qe,Uw=oe,Fw=d,jw=we,Vw=mt,Bw=Uw("Symbol"),Ww=Bw.isWellKnownSymbol,Hw=Uw("Object","getOwnPropertyNames"),Gw=Fw(Bw.prototype.valueOf),zw=Mw("wks"),Kw=0,Yw=Hw(Bw),qw=Yw.length;Kw<qw;Kw++)try{var Xw=Yw[Kw];jw(Bw[Xw])&&Vw(Xw)}catch(e){}var Jw=function(e){if(Ww&&Ww(e))return!0;try{for(var t=Gw(e),n=0,r=Hw(zw),i=r.length;n<i;n++)if(zw[r[n]]==t)return!0}catch(e){}return!1};Pn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:Jw}),oT("customMatcher"),oT("observable"),Pn({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Lw}),Pn({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:Jw}),oT("matcher"),oT("metadataKey"),oT("patternMatch"),oT("replaceAll");var Zw=r(Ow),Qw=r($S.f("iterator"));function $w(e){return $w="function"==typeof Zw&&"symbol"==typeof Qw?function(e){return typeof e}:function(e){return e&&"function"==typeof Zw&&e.constructor===Zw&&e!==Zw.prototype?"symbol":typeof e},$w(e)}var eR=r($S.f("toPrimitive"));function tR(e){var t=function(e,t){if("object"!=$w(e)||!e)return e;var n=e[eR];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$w(t)?t:t+""}function nR(e,t,n){return(t=tR(t))in e?ES(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rR=r(Of),iR={isBrowser:!0,classes:{URLSearchParams:void 0!==rR?rR:cS,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const oR="undefined"!=typeof window&&"undefined"!=typeof document,aR="object"==typeof navigator&&navigator||void 0,sR=oR&&(!aR||["ReactNative","NativeScript","NS"].indexOf(aR.product)<0),cR="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,lR=oR&&window.location.href||"http://localhost";function dR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function uR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dR(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var hR=uR(uR({},Object.freeze({__proto__:null,hasBrowserEnv:oR,hasStandardBrowserEnv:sR,hasStandardBrowserWebWorkerEnv:cR,navigator:aR,origin:lR})),iR);function pR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mR(e,t){return aS(e,new hR.classes.URLSearchParams,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pR(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({visitor:function(e,t,n,r){return hR.isNode&&Qy.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}var fR=Wh.charAt,gR=k,_R=on,vR=A,bR=S,ER=/./.exec,yR=TypeError,SR=Pn,TR=k,CR=w,wR=Js,RR=pc,AR=q,IR=Hn,NR=br,OR=on,PR=$,kR=S,DR=or,xR=iE,LR=xe,MR=i,UR=ol,FR=function(e,t,n){return t+(n?fR(e,t).length:1)},jR=function(e,t){var n=e.exec;if(vR(n)){var r=gR(n,e,t);return null!==r&&_R(r),r}if("RegExp"===bR(e))return gR(ER,e,t);throw new yR("RegExp#exec called on incompatible receiver")},VR=gs,BR=mt("matchAll"),WR="RegExp String",HR=WR+" Iterator",GR=VR.set,zR=VR.getterFor(HR),KR=TypeError,YR=CR("".indexOf),qR=CR("".matchAll),XR=!!qR&&!MR(function(){qR("a",/./)}),JR=wR(function(e,t,n,r){GR(this,{type:HR,regexp:e,string:t,global:n,unicode:r,done:!1})},WR,function(){var e=zR(this);if(e.done)return RR(void 0,!0);var t=e.regexp,n=e.string,r=jR(t,n);return null===r?(e.done=!0,RR(void 0,!0)):e.global?(""===NR(r[0])&&(t.lastIndex=FR(n,IR(t.lastIndex),e.unicode)),RR(r,!1)):(e.done=!0,RR(r,!1))}),ZR=function(e){var t,n,r,i=OR(this),o=NR(e),a=UR(i,RegExp),s=NR(xR(i));return t=new a(a===RegExp?i.source:i,s),n=!!~YR(s,"g"),r=!!~YR(s,"u"),t.lastIndex=IR(i.lastIndex),new JR(t,o,n,r)};SR({target:"String",proto:!0,forced:XR},{matchAll:function(e){var t,n,r,i,o=AR(this);if(PR(e)){if(DR(e)&&(t=NR(AR(xR(e))),!~YR(t,"g")))throw new KR("`.matchAll` does not allow non-global regexes");if(XR)return qR(o,e);if(void 0===(r=LR(e,BR))&&"RegExp"===kR(e)&&(r=ZR),r)return TR(r,e,o)}else if(XR)return qR(o,e);return n=NR(o),i=new RegExp(e,"g"),TR(ZR,i,n)}});var QR=er("String","matchAll"),$R=u,eA=QR,tA=String.prototype,nA=function(e){var t=e.matchAll;return"string"==typeof e||e===tA||$R(tA,e)&&t===tA.matchAll?eA:t},rA=r(nA);function iA(e){function t(e,n,r,i){let o=e[i++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),s=i>=e.length;return o=!o&&Qy.isArray(r)?r.length:o,s?(Qy.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!a):(r[o]&&Qy.isObject(r[o])||(r[o]=[]),t(e,n,r[o],i)&&Qy.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}(r[o])),!a)}if(Qy.isFormData(e)&&Qy.isFunction(e.entries)){const n={};return Qy.forEachEntry(e,(e,r)=>{t(function(e){return rA(Qy).call(Qy,/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null}const oA={transitional:pS,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=Qy.isObject(e);if(i&&Qy.isHTMLForm(e)&&(e=new FormData(e)),Qy.isFormData(e))return r?JSON.stringify(iA(e)):e;if(Qy.isArrayBuffer(e)||Qy.isBuffer(e)||Qy.isStream(e)||Qy.isFile(e)||Qy.isBlob(e)||Qy.isReadableStream(e))return e;if(Qy.isArrayBufferView(e))return e.buffer;if(Qy.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return mR(e,this.formSerializer).toString();if((o=Qy.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return aS(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(Qy.isString(e))try{return(t||JSON.parse)(e),xb(Qy).call(Qy,e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||oA.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(Qy.isResponse(e)||Qy.isReadableStream(e))return e;if(e&&Qy.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(e){if(n){if("SyntaxError"===e.name)throw $y.from(e,$y.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:hR.classes.FormData,Blob:hR.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Qy.forEach(["delete","get","head","post","put","patch"],e=>{oA.headers[e]={}});var aA=oA;const sA=Qy.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),cA=Symbol("internals");function lA(e){var t;return e&&xb(t=String(e)).call(t).toLowerCase()}function dA(e){return!1===e||null==e?e:Qy.isArray(e)?e.map(dA):String(e)}function uA(e,t,n,r,i){return Qy.isFunction(r)?r.call(this,t,n):(i&&(t=n),Qy.isString(t)?Qy.isString(r)?-1!==t.indexOf(r):Qy.isRegExp(r)?r.test(t):void 0:void 0)}class hA{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=lA(t);if(!i)throw new Error("header name must be a non-empty string");const o=Qy.findKey(r,i);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=dA(e))}const o=(e,t)=>Qy.forEach(e,(e,n)=>i(e,n,t));if(Qy.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(Qy.isString(e)&&(e=xb(e).call(e))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(xb(a=e).call(a)))o((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach(function(e){var o,a;i=e.indexOf(":"),n=xb(o=e.substring(0,i)).call(o).toLowerCase(),r=xb(a=e.substring(i+1)).call(a),!n||t[n]&&sA[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(Qy.isObject(e)&&Qy.isIterable(e)){let n,r,i={};for(const t of e){if(!Qy.isArray(t))throw TypeError("Object iterator must return a key-value pair");i[r=t[0]]=(n=i[r])?Qy.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}o(i,t)}else null!=e&&i(t,e,n);var a;return this}get(e,t){if(e=lA(e)){const n=Qy.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(Qy.isFunction(t))return t.call(this,e,n);if(Qy.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=lA(e)){const n=Qy.findKey(this,e);return!(!n||void 0===this[n]||t&&!uA(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=lA(e)){const i=Qy.findKey(n,e);!i||t&&!uA(0,n[i],i,t)||(delete n[i],r=!0)}}return Qy.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!uA(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return Qy.forEach(this,(r,i)=>{var o;const a=Qy.findKey(n,i);if(a)return t[a]=dA(r),void delete t[i];const s=e?function(e){return xb(e).call(e).toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(i):xb(o=String(i)).call(o);s!==i&&delete t[i],t[s]=dA(r),n[s]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Qy.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&Qy.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[cA]=this[cA]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=lA(e);t[r]||(function(e,t){const n=Qy.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})})}(n,e),t[r]=!0)}return Qy.isArray(e)?e.forEach(r):r(e),this}}hA.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Qy.reduceDescriptors(hA.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),Qy.freezeMethods(hA);var pA=hA;function mA(e,t){const n=this||aA,r=t||n,i=pA.from(r.headers);let o=r.data;return Qy.forEach(e,function(e){o=e.call(n,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function fA(e){return!(!e||!e.__CANCEL__)}function gA(e,t,n){$y.call(this,null==e?"canceled":e,$y.ERR_CANCELED,t,n),this.name="CanceledError"}function _A(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new $y("Request failed with status code "+n.status,[$y.ERR_BAD_REQUEST,$y.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}Qy.inherits(gA,$y,{__CANCEL__:!0});const vA=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const i=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];i||(i=c),n[o]=s,r[o]=c;let d=a,u=0;for(;d!==o;)u+=n[d++],d%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),c-i<t)return;const h=l&&c-l;return h?Math.round(1e3*u/h):void 0}}(50,250);return function(e,t){let n,r,i=0,o=1e3/t;const a=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();i=o,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[function(){const e=Date.now(),t=e-i;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];t>=o?a(c,e):(n=c,r||(r=setTimeout(()=>{r=null,a(n)},o-t)))},()=>n&&a(n)]}(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,s=o-r,c=i(s);r=o,e({loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&o<=a?(a-o)/c:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},bA=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},EA=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Qy.asap(()=>e(...n))};var yA=hR.hasStandardBrowserEnv?((e,t)=>n=>(n=new Tv(n,hR.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new Tv(hR.origin),hR.navigator&&/(msie|trident)/i.test(hR.navigator.userAgent)):()=>!0,SA=hR.hasStandardBrowserEnv?{write(e,t,n,r,i,o,a){if("undefined"==typeof document)return;const s=["".concat(e,"=").concat(encodeURIComponent(t))];Qy.isNumber(n)&&s.push("expires=".concat(new Date(n).toUTCString())),Qy.isString(r)&&s.push("path=".concat(r)),Qy.isString(i)&&s.push("domain=".concat(i)),!0===o&&s.push("secure"),Qy.isString(a)&&s.push("SameSite=".concat(a)),document.cookie=s.join("; ")},read(e){if("undefined"==typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function TA(e,t,n){let r=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}function CA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?CA(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const RA=e=>e instanceof pA?wA({},e):e;function AA(e,t){t=t||{};const n={};function r(e,t,n,r){return Qy.isPlainObject(e)&&Qy.isPlainObject(t)?Qy.merge.call({caseless:r},e,t):Qy.isPlainObject(t)?Qy.merge({},t):Qy.isArray(t)?t.slice():t}function i(e,t,n,i){return Qy.isUndefined(t)?Qy.isUndefined(e)?void 0:r(void 0,e,0,i):r(e,t,0,i)}function o(e,t){if(!Qy.isUndefined(t))return r(void 0,t)}function a(e,t){return Qy.isUndefined(t)?Qy.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,o){return o in t?r(n,i):o in e?r(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t,n)=>i(RA(e),RA(t),0,!0)};return Qy.forEach(Object.keys(wA(wA({},e),t)),function(r){const o=c[r]||i,a=o(e[r],t[r],r);Qy.isUndefined(a)&&o!==s||(n[r]=a)}),n}var IA=e=>{const t=AA({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:a,auth:s}=t;if(t.headers=a=pA.from(a),t.url=uS(TA(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),Qy.isFormData(n))if(hR.hasStandardBrowserEnv||hR.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(Qy.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,r]=e;xr(t).call(t,n.toLowerCase())&&a.set(n,r)})}if(hR.hasStandardBrowserEnv&&(r&&Qy.isFunction(r)&&(r=r(t)),r||!1!==r&&yA(t.url))){const e=i&&o&&SA.read(o);e&&a.set(i,e)}return t},NA="undefined"!=typeof XMLHttpRequest&&function(e){return new ip(function(t,n){const r=IA(e);let i=r.data;const o=pA.from(r.headers).normalize();let a,s,c,l,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=r;function m(){l&&l(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let f=new XMLHttpRequest;function g(){if(!f)return;const r=pA.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());_A(function(e){t(e),m()},function(e){n(e),m()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f}),f=null}f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new $y("Request aborted",$y.ECONNABORTED,e,f)),f=null)},f.onerror=function(t){const r=new $y(t&&t.message?t.message:"Network Error",$y.ERR_NETWORK,e,f);r.event=t||null,n(r),f=null},f.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||pS;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new $y(t,i.clarifyTimeoutError?$y.ETIMEDOUT:$y.ECONNABORTED,e,f)),f=null},void 0===i&&o.setContentType(null),"setRequestHeader"in f&&Qy.forEach(o.toJSON(),function(e,t){f.setRequestHeader(t,e)}),Qy.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),u&&"json"!==u&&(f.responseType=r.responseType),p&&([c,d]=vA(p,!0),f.addEventListener("progress",c)),h&&f.upload&&([s,l]=vA(h),f.upload.addEventListener("progress",s),f.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(a=t=>{f&&(n(!t||t.type?new gA(null,e,f):t),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));const _=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);_&&-1===hR.protocols.indexOf(_)?n(new $y("Unsupported protocol "+_+":",$y.ERR_BAD_REQUEST,e)):f.send(i||null)})},OA=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const i=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;r.abort(t instanceof $y?t:new gA(t instanceof Error?t.message:t))}};let o=t&&setTimeout(()=>{o=null,i(new $y("timeout ".concat(t," of ms exceeded"),$y.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)}),e=null)};e.forEach(e=>e.addEventListener("abort",i));const{signal:s}=r;return s.unsubscribe=()=>Qy.asap(a),s}},PA=r(rp),kA=$S.f("asyncIterator"),DA=r(kA);function xA(e,t){this.v=e,this.k=t}function LA(e){return function(){return new MA(e.apply(this,arguments))}}function MA(e){var t,n;function r(t,n){try{var o=e[t](n),a=o.value,s=a instanceof xA;PA.resolve(s?a.v:a).then(function(n){if(s){var c="return"===t?"return":"next";if(!a.k||n.done)return r(c,n);n=e[c](n).value}i(o.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new PA(function(o,a){var s={key:e,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function UA(e){return new xA(e,0)}function FA(e){var t={},n=!1;function r(t,r){return n=!0,r=new PA(function(n){n(e[t](r))}),{done:!1,value:new xA(r,1)}}return t[void 0!==Zw&&Qw||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}MA.prototype["function"==typeof Zw&&DA||"@@asyncIterator"]=function(){return this},MA.prototype.next=function(e){return this._invoke("next",e)},MA.prototype.throw=function(e){return this._invoke("throw",e)},MA.prototype.return=function(e){return this._invoke("return",e)};var jA=r(kA);function VA(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=jA,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new BA(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function BA(e){function t(e){if(Object(e)!==e)return ip.reject(new TypeError(e+" is not an object."));var t=e.done;return ip.resolve(e.value).then(function(e){return{value:e,done:t}})}return BA=function(e){this.s=e,this.n=e.next},BA.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?ip.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?ip.reject(e):t(n.apply(this.s,arguments))}},new BA(e)}const WA=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,i=0;for(;i<n;)r=i+t,yield e.slice(i,r),i=r},HA=function(){var e=LA(function*(e,t){var n,r=!1,i=!1;try{for(var o,a=VA(GA(e));r=!(o=yield UA(a.next())).done;r=!1){const e=o.value;yield*FA(VA(WA(e,t)))}}catch(e){i=!0,n=e}finally{try{r&&null!=a.return&&(yield UA(a.return()))}finally{if(i)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),GA=function(){var e=LA(function*(e){if(e[jA])return void(yield*FA(VA(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield UA(t.read());if(e)break;yield n}}finally{yield UA(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),zA=(e,t,n,r)=>{const i=HA(e,t);let o,a=0,s=e=>{o||(o=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await i.next();if(t)return s(),void e.close();let o=r.byteLength;if(n){let e=a+=o;n(e)}e.enqueue(new Uint8Array(r))}catch(e){throw s(e),e}},cancel:e=>(s(e),i.return())},{highWaterMark:2})};function KA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function YA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KA(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const{isFunction:qA}=Qy,XA=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(Qy.global),{ReadableStream:JA,TextEncoder:ZA}=Qy.global,QA=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(e){return!1}},$A=e=>{e=Qy.merge.call({skipUndefined:!0},XA,e);const{fetch:t,Request:n,Response:r}=e,i=t?qA(t):"function"==typeof fetch,o=qA(n),a=qA(r);if(!i)return!1;const s=i&&qA(JA),c=i&&("function"==typeof ZA?(l=new ZA,e=>l.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var l;const d=o&&s&&QA(()=>{let e=!1;const t=new n(hR.origin,{body:new JA,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),u=a&&s&&QA(()=>Qy.isReadableStream(new r("").body)),h={stream:u&&(e=>e.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!h[e]&&(h[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new $y("Response type '".concat(e,"' is not supported"),$y.ERR_NOT_SUPPORT,n)})});const p=async(e,t)=>{const r=Qy.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(Qy.isBlob(e))return e.size;if(Qy.isSpecCompliantForm(e)){const t=new n(hR.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Qy.isArrayBufferView(e)||Qy.isArrayBuffer(e)?e.byteLength:(Qy.isURLSearchParams(e)&&(e+=""),Qy.isString(e)?(await c(e)).byteLength:void 0)})(t):r};return async e=>{let{url:i,method:a,data:s,signal:c,cancelToken:l,timeout:m,onDownloadProgress:f,onUploadProgress:g,responseType:_,headers:v,withCredentials:b="same-origin",fetchOptions:E}=IA(e),y=t||fetch;_=_?(_+"").toLowerCase():"text";let S=OA([c,l&&l.toAbortSignal()],m),T=null;const C=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let w;try{if(g&&d&&"get"!==a&&"head"!==a&&0!==(w=await p(v,s))){let e,t=new n(i,{method:"POST",body:s,duplex:"half"});if(Qy.isFormData(s)&&(e=t.headers.get("content-type"))&&v.setContentType(e),t.body){const[e,n]=bA(w,vA(EA(g)));s=zA(t.body,65536,e,n)}}Qy.isString(b)||(b=b?"include":"omit");const t=o&&"credentials"in n.prototype,c=YA(YA({},E),{},{signal:S,method:a.toUpperCase(),headers:v.normalize().toJSON(),body:s,duplex:"half",credentials:t?b:void 0});T=o&&new n(i,c);let l=await(o?y(T,E):y(i,c));const m=u&&("stream"===_||"response"===_);if(u&&(f||m&&C)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=l[t]});const t=Qy.toFiniteNumber(l.headers.get("content-length")),[n,i]=f&&bA(t,vA(EA(f),!0))||[];l=new r(zA(l.body,65536,n,()=>{i&&i(),C&&C()}),e)}_=_||"text";let R=await h[Qy.findKey(h,_)||"text"](l,e);return!m&&C&&C(),await new ip((t,n)=>{_A(t,n,{data:R,headers:pA.from(l.headers),status:l.status,statusText:l.statusText,config:e,request:T})})}catch(t){if(C&&C(),t&&"TypeError"===t.name&&/Load failed|fetch/i.test(t.message))throw Object.assign(new $y("Network Error",$y.ERR_NETWORK,e,T),{cause:t.cause||t});throw $y.from(t,t&&t.code,e,T)}}},eI=new Map,tI=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:i}=t,o=[r,i,n];let a,s,c=o.length,l=eI;for(;c--;)a=o[c],s=l.get(a),void 0===s&&l.set(a,s=c?new Map:$A(t)),l=s;return s};tI();const nI={http:null,xhr:NA,fetch:{get:tI}};Qy.forEach(nI,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}});const rI=e=>"- ".concat(e),iI=e=>Qy.isFunction(e)||null===e||!1===e;var oI={getAdapter:function(e,t){e=Qy.isArray(e)?e:[e];const{length:n}=e;let r,i;const o={};for(let a=0;a<n;a++){let n;if(r=e[a],i=r,!iI(r)&&(i=nI[(n=String(r)).toLowerCase()],void 0===i))throw new $y("Unknown adapter '".concat(n,"'"));if(i&&(Qy.isFunction(i)||(i=i.get(t))))break;o[n||"#"+a]=i}if(!i){const e=Object.entries(o).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});throw new $y("There is no suitable adapter to dispatch the request "+(n?e.length>1?"since :\n"+e.map(rI).join("\n"):" "+rI(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return i},adapters:nI};function aI(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new gA(null,e)}function sI(e){return aI(e),e.headers=pA.from(e.headers),e.data=mA.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),oI.getAdapter(e.adapter||aA.adapter,e)(e).then(function(t){return aI(e),t.data=mA.call(e,e.transformResponse,t),t.headers=pA.from(t.headers),t},function(t){return fA(t)||(aI(e),t&&t.response&&(t.response.data=mA.call(e,e.transformResponse,t.response),t.response.headers=pA.from(t.response.headers))),ip.reject(t)})}const cI="1.13.2",lI={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{lI[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const dI={};lI.transitional=function(e,t,n){function r(e,t){return"[Axios v"+cI+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,o)=>{if(!1===e)throw new $y(r(i," has been removed"+(t?" in "+t:"")),$y.ERR_DEPRECATED);return t&&!dI[i]&&(dI[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}},lI.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};var uI={assertOptions:function(e,t,n){if("object"!=typeof e)throw new $y("options must be an object",$y.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new $y("option "+o+" must be "+n,$y.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new $y("Unknown option "+o,$y.ERR_BAD_OPTION)}},validators:lI};const hI=uI.validators;let pI=class{constructor(e){this.defaults=e||{},this.interceptors={request:new hS,response:new hS}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=AA(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&uI.assertOptions(n,{silentJSONParsing:hI.transitional(hI.boolean),forcedJSONParsing:hI.transitional(hI.boolean),clarifyTimeoutError:hI.transitional(hI.boolean)},!1),null!=r&&(Qy.isFunction(r)?t.paramsSerializer={serialize:r}:uI.assertOptions(r,{encode:hI.function,serialize:hI.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),uI.assertOptions(t,{baseUrl:hI.spelling("baseURL"),withXsrfToken:hI.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&Qy.merge(i.common,i[t.method]);i&&Qy.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=pA.concat(o,i);const a=[];let s=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const c=[];let l;this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected)});let d,u=0;if(!s){const e=[sI.bind(this),void 0];for(e.unshift(...a),e.push(...c),d=e.length,l=ip.resolve(t);u<d;)l=l.then(e[u++],e[u++]);return l}d=a.length;let h=t;for(;u<d;){const t=a[u++],n=a[u++];try{h=t(h)}catch(e){n.call(this,e);break}}try{l=sI.call(this,h)}catch(e){return ip.reject(e)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return uS(TA((e=AA(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Qy.forEach(["delete","get","head","options"],function(e){pI.prototype[e]=function(t,n){return this.request(AA(n||{},{method:e,url:t,data:(n||{}).data}))}}),Qy.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,i){return this.request(AA(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}pI.prototype[e]=t(),pI.prototype[e+"Form"]=t(!0)});var mI=pI;class fI{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new ip(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new ip(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,i){n.reason||(n.reason=new gA(e,r,i),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new fI(function(t){e=t}),cancel:e}}}var gI=fI;const _I={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(_I).forEach(e=>{let[t,n]=e;_I[n]=t});var vI=_I;const bI=function e(t){const n=new mI(t),r=cy(mI.prototype.request,n);return Qy.extend(r,mI.prototype,n,{allOwnKeys:!0}),Qy.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(AA(t,n))},r}(aA);bI.Axios=mI,bI.CanceledError=gA,bI.CancelToken=gI,bI.isCancel=fA,bI.VERSION=cI,bI.toFormData=aS,bI.AxiosError=$y,bI.Cancel=bI.CanceledError,bI.all=function(e){return ip.all(e)},bI.spread=function(e){return function(t){return e.apply(null,t)}},bI.isAxiosError=function(e){return Qy.isObject(e)&&!0===e.isAxiosError},bI.mergeConfig=AA,bI.AxiosHeaders=pA,bI.formToJSON=e=>iA(Qy.isHTMLForm(e)?new FormData(e):e),bI.getAdapter=oI.getAdapter,bI.HttpStatusCode=vI,bI.default=bI;var EI=bI;const yI=()=>{};function SI(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:yI};return e.promise=new ip((t,n)=>{e.resolve=n=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(n),e.value=n)},e.reject=t=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,n(t))}}),e}const TI=new Map,CI=new Map,wI=new Map;let RI=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),AI=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const II=new jE;let NI=II.getResult(),OI=null;function PI(e){if(!OI){e&&II.setUA(e),NI=II.getResult();const t=function(e){if("Blink"===e.engine.name&&"WeChat"!==e.browser.name)return AI.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return AI.CHROME;case"Safari":case"Mobile Safari":return AI.SAFARI;case"Edge":return AI.EDGE;case"Firefox":return AI.FIREFOX;case"QQ":case"QQBrowser":return AI.QQ;case"Opera":return AI.OPERA;case"WeChat":return AI.WECHAT;default:return e.browser.name||""}}(NI),n=kI(NI),r=function(e){return"Windows"===e.os.name?e.os.version?e.os.name+" "+e.os.version:e.os.name:e.os.name||""}(NI),i=NI.os.version,o=kI(NI,!1),a=NI.device.type;if(!(t&&n&&r&&i))return{name:t,version:n,os:r,osVersion:i,browserVersion:o,deviceType:a};OI={name:t,version:n,os:r,osVersion:i,browserVersion:o,deviceType:a}}return OI}function kI(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",n?t.split(".")[0]:t}function DI(){return PI().os}function xI(){const e=PI();return"".concat(e.os," ").concat(e.osVersion)}function LI(){const e=PI();return!!("WebKit"===NI.engine.name&&e.os===RI.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==AI.SAFARI||BI()&&e.name!==AI.SAFARI)}function MI(){return PI().name===AI.CHROME}function UI(){return PI().name===AI.SAFARI}function FI(){const e=PI();if(e.name!==AI.SAFARI||!e.browserVersion)return!1;const t=e.browserVersion.split(".");return Number(t[0])>15||15===Number(t[0])&&Number(t[1])>=4}function jI(){return PI().name===AI.EDGE}function VI(){return PI().name===AI.FIREFOX}function BI(){return PI().os===RI.IOS}function WI(e){const t=PI();return!(t.name!==AI.CHROME||!t.osVersion)&&Number(t.version)>=e}function HI(e){const t=PI();return!(t.name!==AI.CHROME||!t.osVersion)&&Number(t.version)<e}function GI(e,t,n){const r=PI();return!(r.name!==e||!r.osVersion)&&(n?Number(r.version)>=t&&Number(r.version)<=n:Number(r.version)===t)}function zI(e){const t=PI();return!(t.name!==AI.EDGE||!t.osVersion)&&Number(t.version)>=e}function KI(e){const t=PI();return!(t.name!==AI.FIREFOX||!t.osVersion)&&Number(t.version)>=e}function YI(e){const t=PI();return!(t.name!==AI.SAFARI||!t.osVersion)&&Number(t.version)>=e}function qI(e,t,n){const r=PI();if(r.os!==RI.IOS||!r.osVersion)return!1;const i=r.osVersion.split(".");return n?t&&Number(i[0])===e&&Number(i[1])>t||Number(i[0])>e:t?Number(i[0])===e&&Number(i[1])>=t||Number(i[0])>e:Number(i[0])>=e}function XI(e,t,n){const r=PI();if(r.os!==RI.IOS||!r.osVersion)return!1;const i=r.osVersion.split(".");return n?t&&Number(i[0])===e&&Number(i[1])<t||Number(i[0])<e:t?Number(i[0])===e&&Number(i[1])<=t||Number(i[0])<e:Number(i[0])<=e}function JI(e,t,n){const r=PI();if(r.name!==AI.SAFARI||!r.osVersion||!r.browserVersion)return!1;const i=r.browserVersion.split(".");return n?t&&Number(i[0])===e&&Number(i[1])<t||Number(i[0])<e:t?Number(i[0])===e&&Number(i[1])<=t||Number(i[0])<e:Number(i[0])<=e}function ZI(e){const t=PI();return!(t.name!==AI.OPERA||!t.osVersion)&&Number(t.version)>=e}function QI(){const e=PI();if(e.os!==RI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||14===Number(t[0])&&Number(t[1])<=6}function $I(){const e=PI();if(e.os!==RI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function eN(){const e=PI();if(e.os!==RI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 16===Number(t[0])}function tN(){const e=PI();if(e.os!==RI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function nN(){return UI()&&navigator.maxTouchPoints>0}function rN(){return PI().name===AI.WECHAT}function iN(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function oN(){const e=DI();return function(){const{deviceType:e}=PI();return"mobile"===e||"tablet"===e}()||e===RI.ANDROID||e===RI.IOS||e===RI.HARMONY_OS}function aN(){const e=PI();return e.name!==AI.EDGE&&e.name!==AI.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function sN(){return DI()===RI.ANDROID}function cN(){const e=PI();return sN()&&(e.name===AI.CHROME||e.name===AI.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function lN(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function uN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dN(Object(n),!0).forEach(function(t){lN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let hN=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),pN=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(t),lN(this,"code",void 0),lN(this,"message",void 0),lN(this,"data",void 0),lN(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=n}toString(){return this.data?"".concat(this.message,"\ndata: ").concat(JSON.stringify(this.data)):this.message}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return"error"===e&&(t||console).error(this.toString()),"warning"===e&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function mN(e,t){if("boolean"!=typeof e)throw new pN(hN.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function fN(e,t,n){if(!xr(n).call(n,e))throw new pN(hN.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(n)))}function gN(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<n||e>r||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!function(e){return"number"==typeof e&&e%1==0}(e))throw new pN(hN.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(n,", ").concat(r,"]. integer only"))}function _N(e,t){if("number"!=typeof e){if(!(e.min||e.max||e.ideal||e.exact))throw new pN(hN.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));void 0!==e.min&&gN(e.min,"".concat(t,".min"),0,1/0),void 0!==e.max&&gN(e.max,"".concat(t,".max"),1,1/0),void 0!==e.exact&&gN(e.exact,"".concat(t,".exact"),1,1/0),void 0!==e.ideal&&gN(e.ideal,"".concat(t,".ideal"),1,1/0)}else gN(e,t,1,1/0)}function vN(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new pN(hN.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!yN(e,n,r,i))throw new pN(hN.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))}function bN(e,t){if(!Array.isArray(e))throw new pN(hN.INVALID_PARAMS,"".concat(t," should be an array"))}function EN(e){return null==e}function yN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&e.length<=n&&e.length>=t&&(!r||function(e){if("string"!=typeof e)return!1;for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}(e))}function SN(e,t,n){if("getBigUint64"in DataView.prototype)return e.getBigUint64(t,n);const r=e.getUint32(t,n),i=e.getUint32(t+4,n),o=Number(!!n),a=Number(!n);return BigInt(r*a+i*o)<<BigInt(32)|BigInt(r*o+i*a)}function TN(e,t,n,r){if("setBigUint64"in DataView.prototype)return e.setBigUint64(t,n,r);const i=Number(n>>BigInt(32)),o=Number(n&BigInt(4294967295));r?(e.setUint32(t+4,i,r),e.setUint32(t,o,r)):(e.setUint32(t,i,r),e.setUint32(t+4,o,r))}var CN=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(CN||{}),wN=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(wN||{});const RN=new class{constructor(){lN(this,"_clientSize",null),lN(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),lN(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),lN(this,"getStyle",e=>window.getComputedStyle(e,null)),lN(this,"checkCssVisibleProperty",e=>{var t;let n=!0;const r=this.getStyle(e),{display:i,visibility:o,opacity:a,filter:s}=r;return("none"===i||xr(t=["hidden","collapse"]).call(t,o)||Number(a)<.1)&&(n=!1),!!n&&(s&&s.split(" ").filter(e=>{var t;const n=e.split("(")[0];return xr(t=["brightness","blur","opacity"]).call(t,n)}).map(e=>{const[t,n]=e.split(/\(|\)/);return[t,Number(n.match(/^[0-9\.]+/))]}).forEach(e=>{const[t,r]=e;switch(t){case"brightness":(r<.1||r>3)&&(n=!1);break;case"blur":r>3&&(n=!1);break;case"opacity":r<.1&&(n=!1)}}),n)}),lN(this,"checkPropertyUpToAllParentNodes",(e,t)=>{let n=!0,r=!0;const i=e=>t(e);let o=e;for(;o&&r;)i(o)||(n=!1,r=!1),o=o.parentElement,o||(r=!1);return n}),lN(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),lN(this,"getSizeAboutClient",e=>{const{width:t,height:n,left:r,right:i,top:o,bottom:a}=e.getBoundingClientRect(),s=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:n,left:r,right:i,top:o,bottom:a,clientWidth:s,clientHeight:c,clientMin:Math.min(s,c)}}),lN(this,"checkActualSize",()=>{const{width:e,height:t,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(e,t,n)}),lN(this,"elementFromPoint",(e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null),lN(this,"checkCoverForAPoint",(e,t,n)=>{const r=this.elementFromPoint(e,t);return null!==r&&r!==n}),lN(this,"getPointPositionList",()=>{const{width:e,height:t,left:n,top:r}=this._clientSize,i=e/6,o=t/6,a=[],s=10**6;for(let c=0;c<5;c++)for(let e=0;e<5;e++){const t=(n*s+(0===c?.1:4===c?(i*c*s-1e5)/s:i*c)*s)/s,l=(r*s+(0===e?.1:4===e?(o*e*s-1e5)/s:o*e)*s)/s;a.push({x:t,y:l})}return[...a]}),lN(this,"checkElementCover",e=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,e)).filter(e=>!!e).length>6),lN(this,"checkSizeIsVisible",(e,t,n)=>(e>50||n/e<=10)&&(t>50||n/t<=10)),lN(this,"checkSizeOfPartInClient",()=>{const{left:e,right:t,top:n,bottom:r,clientHeight:i,clientWidth:o,clientMin:a}=this._clientSize;let s,c,l,d;if(e<0)s=0;else{if(!(e<o))return!1;s=e}if(t<0)return!1;if(c=t<o?t:o,n<0)l=0;else{if(!(n<i))return!1;l=n}if(r<0)return!1;d=r<i?r:i;const u=c-s,h=d-l;return this.checkSizeIsVisible(u,h,a)}),lN(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),lN(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(CN.COVERED);{const e=this.checkActualSize(),t=this.checkSizeOfPartInClient();return e&&!t?this.returnHiddenResult(CN.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(CN.SIZE)}}return this.returnHiddenResult(CN.STYLE)}return this.returnHiddenResult(wN.UNMOUNTED)}return this.returnHiddenResult(wN.INVALID_HTML_ELEMENT)}),lN(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,e=>"HTML"!==e.nodeName.toUpperCase()?null!==e.parentElement:!!document.documentElement))}};function AN(e){return(new TextEncoder).encode(e)}const IN=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n},NN=async e=>function(e,t){let n="";return new Uint8Array(e).forEach(e=>{n+=e.toString(t).padStart(2,"0")}),n}(await crypto.subtle.digest("SHA-256",AN(e)),16);let ON=class{constructor(){lN(this,"_events",{}),lN(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map(e=>e.listener):[]}on(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map(e=>e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(let o=0;o<t.length;o+=1){const n=t[o];n.once&&this.off(e,n.listener),n.listener.apply(this,r||[])}}safeEmit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];[...this._events[e]||[]].forEach(t=>{t.once&&this.off(e,t.listener);try{t.listener.apply(this,n)}catch(t){console.error("safeEmit event:".concat(e," error ").concat(null==t?void 0:t.toString()))}})}_indexOfListener(e,t){let n=e.length;for(;n--;)if(e[n].listener===t)return n;return-1}},PN=null;function kN(){if(PN)return PN;if(window.electron)return PN=window.electron;if(!window.require)return null;try{return PN=window.require("electron"),PN}catch(e){return null}}let DN=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",e.PRELOAD_MEDIA_FAILED="preloadMediaFailed",e.MISMATCH_DTLS_PARAMETERS="mismatchDtlsParameters",e.VOS_FALLBACK_CN="vosFallbackCN",e.DATACHANNEL_FAILBACK="datachannelFailback",e}({}),xN=function(e){return e.TRACER="tracer",e}({});function LN(e){return gN(e.timeout,"config.timeout",0,1e5),gN(e.timeoutFactor,"config.timeoutFactor",0,100,!1),gN(e.maxRetryCount,"config.maxRetryConfig",0,1/0),gN(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let MN=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),UN=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e.FALLBACK_TO_HLS="FALLBACK_TO_HLS",e.UID_CONFLICT="UID_CONFLICT",e}({});function FN(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(e=>{if(!e.urls)throw Error()})}catch(e){return!1}return!0}function jN(e){return vN(e.turnServerURL,"turnServerURL"),vN(e.username,"username"),vN(e.password,"password"),e.udpport&&gN(e.udpport,"udpport",1,99999,!0),e.forceturn&&mN(e.forceturn,"forceturn"),e.security&&mN(e.security,"security"),e.tcpport&&gN(e.tcpport,"tcpport",1,99999,!0),!0}let VN=function(e){return e[e.AUTO_SIMULCAST_STREAM=-1]="AUTO_SIMULCAST_STREAM",e[e.DISABLE_SIMULCAST_STREM=0]="DISABLE_SIMULCAST_STREM",e[e.ENABLE_SIMULCAST_STREAM=1]="ENABLE_SIMULCAST_STREAM",e}({});function BN(e){return void 0!==e.level&&fN(e.level,"level",[1,2,3]),void 0!==e.delay&&gN(e.delay,"delay",0,3e3,!0),!0}let WN=function(e){return e.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",e.AUDIO_METADATA="audio-metadata",e.AUDIO_PTS="audio-pts",e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e.FALLBACK_TO_HLS="fallback-to-hls",e.FIRST_VIDEO_BUFFER_READY="first-video-buffer-ready",e.FIRST_VIDEO_PRE_RENDER="first-video-pre-render",e.AV1_DECODABLE_RESULT="av1-decodable-result",e}({}),HN=function(e){return e.CONFIG="config",e.VOSERROR="vos_error",e.AP_ERROR="ap_error",e}({}),GN=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",e}({}),zN=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),KN=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function YN(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return 0===e.getListeners(t).length?ip.reject(new pN(hN.UNEXPECTED_ERROR,"can not emit promise")):new ip((n,i)=>{e.emit(t,...r,n,i)})}function qN(e,t){if(0===e.getListeners(t).length)return ip.resolve();for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return YN(e,t,...r)}function XN(e,t){if(0===e.getListeners(t).length)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return JN(e,t,...r)}function JN(e,t){let n=null,r=null;for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];if(e.emit(t,...o,e=>{n=e},e=>{r=e}),null!==r)throw r;if(null===n)throw new pN(hN.UNEXPECTED_ERROR,"handler is not sync");return n}const ZN=new class extends ON{set networkState(e){this.emit(KN.NETWORK_STATE_CHANGE,e,this._networkState),e===zN.ONLINE?this.emit(KN.ONLINE):e===zN.OFFLINE&&(this.onlineWaiter=new ip(e=>{this.once(KN.ONLINE,()=>{this.onlineWaiter=void 0,e(zN.ONLINE)})}),this.emit(KN.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===zN.ONLINE}constructor(){super(),lN(this,"_moduleName","network-indicator"),lN(this,"_networkState",zN.ONLINE),lN(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=zN.ONLINE}),window.addEventListener("offline",()=>{this.networkState=zN.OFFLINE})}},QN=[];for(let n=0;n<256;++n)QN.push((n+256).toString(16).slice(1));const $N="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);let eO;const tO=new Uint8Array(16);function nO(){return $N?$N():function(e,t,n){var r,i,o,a;const s=null!==(r=null!==(i=(e=e||{}).random)&&void 0!==i?i:null===(o=(a=e).rng)||void 0===o?void 0:o.call(a))&&void 0!==r?r:function(){if(!eO){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");eO=crypto.getRandomValues.bind(crypto)}return eO(tO)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError("UUID byte range ".concat(n,":").concat(n+15," is out of buffer bounds"));for(let e=0;e<16;++e)t[n+e]=s[e];return t}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(QN[e[t+0]]+QN[e[t+1]]+QN[e[t+2]]+QN[e[t+3]]+"-"+QN[e[t+4]]+QN[e[t+5]]+"-"+QN[e[t+6]]+QN[e[t+7]]+"-"+QN[e[t+8]]+QN[e[t+9]]+"-"+QN[e[t+10]]+QN[e[t+11]]+QN[e[t+12]]+QN[e[t+13]]+QN[e[t+14]]+QN[e[t+15]]).toLowerCase()}(s)}(e,t,void 0);var e,t}function rO(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function iO(e){const t=[];return e.forEach(e=>{-1===t.indexOf(e)&&t.push(e)}),t}function oO(e){void 0!==ip?ip.resolve().then(e):setTimeout(e,0)}function aO(e){return JSON.parse(JSON.stringify(e))}function sO(e){try{return aO(e)}catch(t){return e}}const cO={};function lO(e,t){cO[t]||(cO[t]=!0,e())}function dO(e){const t=window.atob(e),n=new Uint8Array(new ArrayBuffer(t.length));for(let r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return n}function uO(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}function hO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=(new TextEncoder).encode(e);if(n.length>t)n=n.slice(0,t);else if(n.length<t){const e=new Uint8Array(t);e.set(n),n=e}return n}function pO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=ii(t).call(t,(e,t)=>e+t.length,0),i=new Uint8Array(new ArrayBuffer(r));let o=0;return t.forEach(e=>{i.set(e,o),o+=e.length}),i}function mO(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function fO(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach(e=>{t+="string"==typeof e?mO(e):e.size}),t+138}function gO(e){const t=new pN(hN.TIMEOUT,"timeout");return new ip((n,r)=>{window.setTimeout(()=>r(t),e)})}function _O(e){return new ip(t=>{window.setTimeout(t,e)})}function vO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+vO(e-n.length,"")}function bO(){let e,t=!1;try{var n;e=LE(n=nO()).call(n,"-","")}catch(e){t=!0}return!t&&e&&32===e.length||(e=vO(32,"")),e.toUpperCase()}const EO=()=>{},yO=new class{constructor(){lN(this,"fnMap",new Map)}throttleByKey(e,t,n,r){for(var i=arguments.length,o=new Array(i>4?i-4:0),a=4;a<i;a++)o[a-4]=arguments[a];if(this.fnMap.has(t)){const i=this.fnMap.get(t);if(i.threshold!==n){i.fn(...i.args),clearTimeout(i.timer);const a=window.setTimeout(()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)},n);this.fnMap.set(t,{fn:e,threshold:n,timer:a,args:o,skipFn:r})}else i.skipFn&&i.skipFn(...i.args),this.fnMap.set(t,uN(uN({},i),{},{fn:e,args:o,skipFn:r}))}else{const i=window.setTimeout(()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)},n);this.fnMap.set(t,{fn:e,threshold:n,timer:i,args:o,skipFn:r})}}},SO=yO.throttleByKey.bind(yO);function TO(e){return"object"==typeof e&&null!==e&&!(e instanceof RegExp)}function CO(e,t){if(!TO(e)||!TO(t))return t;if(Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const n=[...e];for(let r=0;r<t.length;r++)n[r]=CO(e[r],t[r]);return n}{const n=uN({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)?n[r]=CO(e[r],t[r]):n[r]=t[r]);return n}}function wO(e,t){let n=[0];if(t&&(n=new Array(t).fill(0)),0===e)return n;let r=0;for(;e>0&&(n[r]=255&e,e>>=8,r++,!t||r!==t););return n}function RO(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function AO(e,t){try{return"object"==typeof e&&"object"==typeof t&&JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}}function IO(e){return ii(e).call(e,(e,t)=>e+t,0)}function NO(e){const t="0123456789abcdef";function n(e){let n,r="";for(n=0;n<=3;n++)r+=t.charAt(e>>8*n+4&15)+t.charAt(e>>8*n&15);return r}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,a){return r(function(e,t){return e<<t|e>>>32-t}(r(r(t,e),r(i,a)),o),n)}function o(e,t,n,r,o,a,s){return i(t&n|~t&r,e,t,o,a,s)}function a(e,t,n,r,o,a,s){return i(t&r|n&~r,e,t,o,a,s)}function s(e,t,n,r,o,a,s){return i(t^n^r,e,t,o,a,s)}function c(e,t,n,r,o,a,s){return i(n^(t|~r),e,t,o,a,s)}const l=function(e){let t;const n=1+(e.length+8>>6),r=new Array(16*n);for(t=0;t<16*n;t++)r[t]=0;for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<t%4*8;return r[t>>2]|=128<<t%4*8,r[16*n-2]=8*e.length,r}(e);let d,u,h,p,m,f=1732584193,g=-271733879,_=-1732584194,v=271733878;for(d=0;d<l.length;d+=16)u=f,h=g,p=_,m=v,f=o(f,g,_,v,l[d+0],7,-680876936),v=o(v,f,g,_,l[d+1],12,-389564586),_=o(_,v,f,g,l[d+2],17,606105819),g=o(g,_,v,f,l[d+3],22,-1044525330),f=o(f,g,_,v,l[d+4],7,-176418897),v=o(v,f,g,_,l[d+5],12,1200080426),_=o(_,v,f,g,l[d+6],17,-1473231341),g=o(g,_,v,f,l[d+7],22,-45705983),f=o(f,g,_,v,l[d+8],7,1770035416),v=o(v,f,g,_,l[d+9],12,-1958414417),_=o(_,v,f,g,l[d+10],17,-42063),g=o(g,_,v,f,l[d+11],22,-1990404162),f=o(f,g,_,v,l[d+12],7,1804603682),v=o(v,f,g,_,l[d+13],12,-40341101),_=o(_,v,f,g,l[d+14],17,-1502002290),g=o(g,_,v,f,l[d+15],22,1236535329),f=a(f,g,_,v,l[d+1],5,-165796510),v=a(v,f,g,_,l[d+6],9,-1069501632),_=a(_,v,f,g,l[d+11],14,643717713),g=a(g,_,v,f,l[d+0],20,-373897302),f=a(f,g,_,v,l[d+5],5,-701558691),v=a(v,f,g,_,l[d+10],9,38016083),_=a(_,v,f,g,l[d+15],14,-660478335),g=a(g,_,v,f,l[d+4],20,-405537848),f=a(f,g,_,v,l[d+9],5,568446438),v=a(v,f,g,_,l[d+14],9,-1019803690),_=a(_,v,f,g,l[d+3],14,-187363961),g=a(g,_,v,f,l[d+8],20,1163531501),f=a(f,g,_,v,l[d+13],5,-1444681467),v=a(v,f,g,_,l[d+2],9,-51403784),_=a(_,v,f,g,l[d+7],14,1735328473),g=a(g,_,v,f,l[d+12],20,-1926607734),f=s(f,g,_,v,l[d+5],4,-378558),v=s(v,f,g,_,l[d+8],11,-2022574463),_=s(_,v,f,g,l[d+11],16,1839030562),g=s(g,_,v,f,l[d+14],23,-35309556),f=s(f,g,_,v,l[d+1],4,-1530992060),v=s(v,f,g,_,l[d+4],11,1272893353),_=s(_,v,f,g,l[d+7],16,-155497632),g=s(g,_,v,f,l[d+10],23,-1094730640),f=s(f,g,_,v,l[d+13],4,681279174),v=s(v,f,g,_,l[d+0],11,-358537222),_=s(_,v,f,g,l[d+3],16,-722521979),g=s(g,_,v,f,l[d+6],23,76029189),f=s(f,g,_,v,l[d+9],4,-640364487),v=s(v,f,g,_,l[d+12],11,-421815835),_=s(_,v,f,g,l[d+15],16,530742520),g=s(g,_,v,f,l[d+2],23,-995338651),f=c(f,g,_,v,l[d+0],6,-198630844),v=c(v,f,g,_,l[d+7],10,1126891415),_=c(_,v,f,g,l[d+14],15,-1416354905),g=c(g,_,v,f,l[d+5],21,-57434055),f=c(f,g,_,v,l[d+12],6,1700485571),v=c(v,f,g,_,l[d+3],10,-1894986606),_=c(_,v,f,g,l[d+10],15,-1051523),g=c(g,_,v,f,l[d+1],21,-2054922799),f=c(f,g,_,v,l[d+8],6,1873313359),v=c(v,f,g,_,l[d+15],10,-30611744),_=c(_,v,f,g,l[d+6],15,-1560198380),g=c(g,_,v,f,l[d+13],21,1309151649),f=c(f,g,_,v,l[d+4],6,-145523070),v=c(v,f,g,_,l[d+11],10,-1120210379),_=c(_,v,f,g,l[d+2],15,718787259),g=c(g,_,v,f,l[d+9],21,-343485551),f=r(f,u),g=r(g,h),_=r(_,p),v=r(v,m);return n(f)+n(g)+n(_)+n(v)}let OO=1,PO=console,kO=class{static setLogger(e){PO=e}constructor(e,t){lN(this,"id",void 0),lN(this,"lockingPromise",ip.resolve()),lN(this,"locks",0),lN(this,"name",""),lN(this,"lockId",void 0),this.lockId=OO++,e&&(this.name=e),t&&(this.id=t),this.logger("created")}logger(e,t){const n=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),r="created"===e?"is ".concat(e,"."):"is ".concat(e,", current queue ").concat(this.locks,". ").concat(null!=t?t:"");PO.debug("".concat(n," ").concat(r))}setId(e){this.id=e}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,this.logger("locked",e);const n=new ip(n=>{t=()=>{this.locks-=1,this.logger("unlocked",e),n()}}),r=this.lockingPromise.then(()=>t);return this.lockingPromise=this.lockingPromise.then(()=>n),r}};function DO(e,t){return function(n,r,i){const o=i.value;if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const n=this[t];if(!n)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const i=await n.lock("From ".concat(e,".").concat(r));try{for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return await o.apply(this,s)}finally{i()}},i}}const xO={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function LO(e,t){const n=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,n)}function MO(e,t,n,r){const i=Object.assign({},xO,r);let o=i.timeout;const a=async()=>{await function(e){return new ip(t=>{window.setTimeout(t,e)})}(o),o*=i.timeoutFactor,o=Math.min(i.maxRetryTimeout,o)};let s=!1;const c=new ip(async(r,o)=>{t=t||(()=>!1),n=n||(()=>!0);for(let c=0;c<i.maxRetryCount;c+=1){if(s)return o(new pN(hN.OPERATION_ABORTED));try{const n=await e();if(!t(n,c))return r(n);if(c+1===i.maxRetryCount)return r(n);await a()}catch(e){if(!n(e,c))return o(e);if(c+1===i.maxRetryCount)return o(e);await a()}}});return c.cancel=()=>s=!0,c}let UO,FO=class{constructor(e){lN(this,"input",[]),lN(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return 0===this.input.length?0:ii(e=this.input).call(e,(e,t)=>e+t)/this.input.length}},jO=0,VO=0;function BO(e,t,n,r){return new ip((i,o)=>{t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),jO+=mO(t.data)):n&&(t.data.size?jO+=t.data.size:t.data instanceof FormData?jO+=fO(t.data):jO+=mO(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,EI.request(t).then(e=>{"string"==typeof e.data?VO+=mO(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?VO+=e.data.byteLength:VO+=mO(JSON.stringify(e.data)),r&&i({data:e.data,headers:e.headers}),i(e.data)}).catch(e=>{EI.isCancel(e)?o(new pN(hN.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new pN(hN.NETWORK_TIMEOUT,e.message)):e.response?o(new pN(hN.NETWORK_RESPONSE_ERROR,e.response.status)):o(new pN(hN.NETWORK_ERROR,e.message))})})}async function WO(e,t){const n=new Blob([t.data],{type:"buffer"});return await BO(e,uN(uN({},t),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}const HO=()=>void 0!==window.isSecureContext;function GO(e){if(Array.isArray(e))return e.map(e=>e);if(!zO(e))return e;const t={};for(const n in e){const r=e[n];zO(r)||Array.isArray(r)?t[n]=GO(r):t[n]=r}return t}function zO(e){return!("object"!=typeof e||Array.isArray(e)||!e)}let KO=class{constructor(e){lN(this,"input",[]),lN(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const YO={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},qO={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],transport:{bytesSent:0,bytesReceived:0,packetsSent:0,packetsReceived:0},selectedCandidatePair:{id:"unknown",localCandidate:YO,remoteCandidate:YO},updateInterval:0},XO={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},JO={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},ZO={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},QO={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let $O=class{constructor(e,t){lN(this,"onFirstVideoReceived",void 0),lN(this,"onFirstVideoDecoded",void 0),lN(this,"onFirstAudioReceived",void 0),lN(this,"onFirstVideoDecodedTimeout",void 0),lN(this,"onFirstAudioDecoded",void 0),lN(this,"onSelectedLocalCandidateChanged",void 0),lN(this,"onSelectedRemoteCandidateChanged",void 0),lN(this,"videoIsReady",!1),lN(this,"videoIsReady2",{}),lN(this,"pc",void 0),lN(this,"options",void 0),lN(this,"intervalTimer",void 0),lN(this,"stats",GO(qO)),lN(this,"isFirstVideoReceived",{}),lN(this,"isFirstVideoDecoded",{}),lN(this,"isFirstAudioReceived",{}),lN(this,"isFirstAudioDecoded",{}),lN(this,"isFirstVideoDecodedTimeout",{}),lN(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new ip(e=>{e({local:uN({},YO),remote:uN({},YO)})})}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const t=this.lossRateWindowStats.length,n=["videoSend","audioSend","videoRecv","audioRecv"];let r=0,i=0,o=0,a=0;for(const s of n)e[s].forEach((e,n)=>{if(!this.lossRateWindowStats[t-1][s][n]||!this.lossRateWindowStats[0][s][n])return;const c=this.lossRateWindowStats[t-1][s][n].packets-this.lossRateWindowStats[0][s][n].packets,l=this.lossRateWindowStats[t-1][s][n].packetsLost-this.lossRateWindowStats[0][s][n].packetsLost;"videoSend"===s||"audioSend"===s?(r+=c,o+=l):(i+=c,a+=l),Number.isNaN(c)||Number.isNaN(c)?e.packetLostRate=0:e.packetLostRate=c<=0||l<=0?0:l/(c+l)});e.sendPacketLossRate=r<=0||o<=0?0:o/(r+o),e.recvPacketLossRate=i<=0||a<=0?0:a/(i+a)}},eP=class extends $O{constructor(){super(...arguments),lN(this,"_stats",qO),lN(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=GO(qO);const n=t.filter(e=>"ssrc"===e.type);this.processSSRCStats(n);const r=t.find(e=>"VideoBwe"===e.type);r&&this.processBandwidthStats(r),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach(e=>{var t;const n=xr(t=e.id).call(t,"send");switch("".concat(e.mediaType,"_").concat(n?"send":"recv")){case"video_send":{const t=GO(JO);t.codec=e.googCodecName,t.adaptionChangeReason="none",e.googCpuLimitedResolution&&(t.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(t.adaptionChangeReason="bandwidth"),t.avgEncodeMs=Number(e.googAvgEncodeMs),t.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.firsCount=Number(e.googFirReceived),t.nacksCount=Number(e.googNacksReceived),t.plisCount=Number(e.googPlisReceived),t.frameCount=Number(e.framesEncoded),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.videoSend.push(t),this._stats.rtt=t.rttMs;break}case"video_recv":{const t=GO(XO),n=this.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(t.codec=e.googCodecName,t.targetDelayMs=Number(e.googTargetDelayMs),t.renderDelayMs=Number(e.googRenderDelayMs),t.currentDelayMs=Number(e.googCurrentDelayMs),t.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),t.decodeMs=Number(e.googDecodeMs),t.maxDecodeMs=Number(e.googMaxDecodeMs),t.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},t.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},t.decodeFrameRate=Number(e.googFrameRateDecoded),t.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},t.jitterBufferMs=Number(e.googJitterBufferMs),t.firsCount=Number(e.googFirsSent),t.nacksCount=Number(e.googNacksSent),t.plisCount=Number(e.googPlisSent),t.framesDecodeCount=Number(e.framesDecoded),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,t.decodedFrame.width,t.decodedFrame.height),this.isFirstVideoDecoded[t.ssrc]=!0),n){const r=n.stats,i=Date.now()-n.lts;t.framesDecodeFreezeTime=r.framesDecodeFreezeTime,t.framesDecodeInterval=r.framesDecodeInterval,t.framesDecodeCount>r.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=i,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc,10))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<n.stats.framesDecodeCount&&(t.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:uN({},t),lts:Date.now()}),this._stats.videoRecv.push(t);break}case"audio_recv":{const t=GO(QO);t.codec=e.googCodecName,t.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,t.decodingCNG=Number(e.googDecodingCNG),t.decodingCTN=Number(e.googDecodingCTN),t.decodingCTSG=Number(e.googDecodingCTSG),t.decodingNormal=Number(e.googDecodingNormal),t.decodingPLC=Number(e.googDecodingPLC),t.decodingPLCCNG=Number(e.googDecodingPLCCNG),t.expandRate=Number(e.googExpandRate),t.accelerateRate=Number(e.googAccelerateRate),t.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),t.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),t.speechExpandRate=Number(e.googSpeechExpandRate),t.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),t.jitterBufferMs=Number(e.googJitterBufferMs),t.jitterMs=Number(e.googJitterReceived),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),t.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.decodingNormal>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),this._stats.audioRecv.push(t);break}case"audio_send":{const t=GO(ZO);t.codec=e.googCodecName,t.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,t.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),t.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),t.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),t.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.rtt=t.rttMs,this._stats.audioSend.push(t);break}}})}_getStats(){return new ip((e,t)=>{this.pc.getStats(e,t)})}statsResponsesToObjects(e){const t=[];return e.result().forEach(e=>{const n={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t.push(n)}),t}},tP=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({}),nP=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),rP=function(e){return e[e.new=0]="new",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.disconnected=3]="disconnected",e[e.failed=4]="failed",e[e.closed=5]="closed",e}({}),iP=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({});var oP=function(e){return e[e.kNone=1]="kNone",e[e.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",e[e.kBytesToBits=8]="kBytesToBits",e}(oP||{});function aP(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:oP.kNone;if(!t)return;const o=Number(t[n]);if("number"!=typeof o)return;const a=Number(t[r]);if("number"!=typeof a)return;if(!e)return a?o/a*i:void 0;const s=Number(e[n]);if("number"!=typeof s)return;const c=Number(e[r]);if("number"!=typeof c)return;const l=a-c;return l?(o-s)/l*i:void 0}let sP=class extends $O{constructor(){super(...arguments),lN(this,"_stats",qO),lN(this,"report",void 0),lN(this,"lastDecodeVideoReceiverStats",new Map),lN(this,"lastVideoFramesRecv",new Map),lN(this,"lastVideoFramesSent",new Map),lN(this,"lastVideoFramesDecode",new Map),lN(this,"lastVideoFramesOutput",new Map),lN(this,"lastVideoJBDelay",new Map),lN(this,"lastAudioJBDelay",new Map),lN(this,"mediaBytesSent",new Map),lN(this,"mediaBytesRetransmit",new Map),lN(this,"mediaBytesTargetEncode",new Map),lN(this,"lastDecodeAudioReceiverStats",new Map),lN(this,"lastAudioConcealment",new Map),lN(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=GO(qO),this.report.forEach(e=>{switch(e.type){case iP.OUTBOUND:case iP.INBOUND:{const t=e.mediaType||e.kind,n=!t&&"frameWidth"in e,r=!t&&!("frameWidth"in e);e.type===iP.OUTBOUND?"audio"===t||r?this.processAudioOutboundStats(e):("video"===t||n)&&this.processVideoOutboundStats(e):e.type===iP.INBOUND&&("audio"===t||r?this.processAudioInboundStats(e):("video"===t||n)&&this.processVideoInboundStats(e));break}case iP.TRANSPORT:{this.processTransportStats(e);const t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case iP.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),t={local:uN({},YO),remote:uN({},YO)};return e.forEach(n=>{let r;if(n.type===iP.TRANSPORT&&(r=e.get(n.selectedCandidatePairId)),n.type===iP.CANDIDATE_PAIR&&n.selected&&(r=n),r){const n=(e,t)=>{e.type=t.type,e.id=t.id,t.address&&(e.address=t.address),t.candidateType&&(e.candidateType=t.candidateType),t.port&&(e.port=t.port),t.priority&&(e.priority=t.priority),t.protocol&&(e.protocol=t.protocol),t.relayProtocol&&(e.relayProtocol=t.relayProtocol)};if(r.localCandidateId){const i=e.get(r.localCandidateId);i&&n(t.local,i)}if(r.remoteCandidateId){const i=e.get(r.remoteCandidateId);i&&n(t.remote,i)}}}),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.audioSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){const t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===iP.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===iP.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===iP.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(uN({},t),uN({},this.stats.selectedCandidatePair.localCandidate)),e.type===iP.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(uN({},t),uN({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find(t=>t.ssrc===e.ssrc);t||(t=GO(QO),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.packetsDiscarded=e.packetsDiscarded,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived,t.totalProcessingDelay=e.totalProcessingDelay,t.jitterBufferEmittedCount=e.jitterBufferEmittedCount,t.estimatedPlayoutTimestamp=e.estimatedPlayoutTimestamp;const n=this.lastDecodeAudioReceiverStats.get(t.ssrc);t.avgProcessingDelayMs=aP(n,t,"totalProcessingDelay","jitterBufferEmittedCount",oP.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(e,e.trackId,t),this.calculateAudioFreeze(t,n,e),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),"number"==typeof e.concealedSamples&&(t.concealedSamples=e.concealedSamples),this.lastDecodeAudioReceiverStats.set(t.ssrc,uN({},t))}calculateAudioFreeze(e,t,n){const r=this.lastAudioConcealment.get(e.ssrc);if(null!=t&&null!=r){const i=r.lts,o=n.timestamp,a=o-i;if(a<=0)return;const s=e.concealedSamples-t.concealedSamples-0,c=r.nonSilent+s,l=e.totalSamplesReceived-t.totalSamplesReceived;if(l<=0)return;const d=80*l/a,u=200*l/a,h=a/l;let p=0;e.freezeSamples80=t.freezeSamples80,e.freezeMs80=t.freezeMs80,c>d&&(r.plc80>0?(e.freezeSamples80+=s,e.freezeMs80+=Math.round(s*h)):(e.freezeSamples80+=c,e.freezeMs80+=Math.round(c*h)),p=r.plc80+1);let m=0;e.freezeSamples200=t.freezeSamples200,e.freezeMs200=t.freezeMs200,c>u&&(r.plc200>0?(e.freezeSamples200+=s,e.freezeMs200+=Math.round(s*h)):(e.freezeSamples200+=c,e.freezeMs200+=Math.round(c*h)),m=r.plc200+1),this.lastAudioConcealment.set(e.ssrc,{nonSilent:s,lts:o,plc80:p,plc200:m})}else e.freezeSamples80=0,e.freezeSamples200=0,e.freezeMs80=0,e.freezeMs200=0,this.lastAudioConcealment.set(e.ssrc,{nonSilent:0,lts:n.timestamp,plc80:0,plc200:0})}processVideoInboundStats(e){let t=this._stats.videoRecv.find(t=>t.ssrc===e.ssrc);t||(t=GO(XO),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.framesDroppedCount=e.framesDropped,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,t.totalFreezesDuration=e.totalFreezesDuration,t.totalProcessingDelay=e.totalProcessingDelay,t.packetsDiscarded=e.packetsDiscarded,t.framesAssembledFromMultiplePackets=e.framesAssembledFromMultiplePackets,t.totalAssemblyTime=e.totalAssemblyTime,t.keyFramesDecoded=e.keyFramesDecoded,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived,t.estimatedPlayoutTimestamp=e.estimatedPlayoutTimestamp;const n=this.lastDecodeVideoReceiverStats.get(t.ssrc),r=this.lastVideoFramesDecode.get(t.ssrc),i=this.lastVideoFramesOutput.get(t.ssrc),o=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){const e=t.decodedFrame?t.decodedFrame.width:0,n=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,e,n),this.isFirstVideoDecoded[t.ssrc]=!0}if(n){const r=n.stats,i=o-n.lts;t.framesDecodeFreezeTime=r.framesDecodeFreezeTime,t.framesDecodeInterval=r.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&i>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>r.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=i,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<r.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(n.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-n.qpSum)/(e.framesDecoded-n.stats.framesDecodeCount))}e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime,t.avgDecodeMs=aP(null==n?void 0:n.stats,t,"decodeMs","framesDecodeCount")),t.avgProcessingDelayMs=aP(null==n?void 0:n.stats,t,"totalProcessingDelay","framesDecodeCount",oP.kMillisecondsFromSeconds),t.avgFramesAssembledFromMultiplePacketsMs=aP(null==n?void 0:n.stats,t,"totalAssemblyTime","framesAssembledFromMultiplePackets",oP.kMillisecondsFromSeconds),t.avgInterFrameDelayMs=aP(null==n?void 0:n.stats,t,"totalInterFrameDelay","framesDecodeCount",oP.kMillisecondsFromSeconds),r&&o-r.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-r.count)/((o-r.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:o,rate:t.decodeFrameRate})):r?t.decodeFrameRate=r.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:o,rate:0}),t.framesDroppedCount&&e.framesReceived&&(i&&o-i.lts>=800?(t.outputFrameRate=Math.round((e.framesReceived-t.framesDroppedCount-i.count)/((o-i.lts)/1e3)),this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:o,rate:Math.max(t.outputFrameRate,0)})):i?t.outputFrameRate=i.rate:this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:o,rate:0})),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:uN({},t),lts:n?n.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find(t=>t.ssrc===e.ssrc);t||(t=GO(JO),this._stats.videoSend.push(t));const n=this.mediaBytesSent.get(e.ssrc);if(n)n.add(e.bytesSent);else{const t=new KO(10);t.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,t)}if(void 0!==e.retransmittedBytesSent){const t=this.mediaBytesRetransmit.get(e.ssrc);if(t)t.add(e.retransmittedBytesSent);else{const t=new KO(10);t.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,t)}}if(e.totalEncodedBytesTarget){const t=this.mediaBytesTargetEncode.get(e.ssrc);if(t)t.add(e.totalEncodedBytesTarget);else{const t=new KO(10);t.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,t)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,t.hugeFramesSent=e.hugeFramesSent,t.keyFramesEncoded=e.keyFramesEncoded,t.targetBitrate=e.targetBitrate,e.totalEncodeTime&&e.framesEncoded){const n=this.lastEncoderMs.get(e.ssrc);if(!n||n.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const r=e.framesEncoded-n.lastFrameCount,i=e.totalEncodeTime-n.lastEncoderTime;t.avgEncodeMs=1e3*i/r}}if(e.framesEncoded&&e.qpSum){const n=this.lastEncoderMs.get(e.ssrc);!n||n.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-n.lastQpSum)/(e.framesEncoded-n.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const n=this.findRemoteStatsId(e.ssrc,iP.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find(t=>t.ssrc===e.ssrc);if(t||(t=GO(ZO),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const n=this.findRemoteStatsId(e.ssrc,iP.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}}processTransportStats(e){this._stats.transport.bytesReceived=e.bytesReceived||this._stats.transport.bytesReceived,this._stats.transport.bytesSent=e.bytesSent||this._stats.transport.bytesSent,this._stats.transport.packetsReceived=e.packetsReceived||this._stats.transport.packetsReceived,this._stats.transport.packetsSent=e.packetsSent||this._stats.transport.packetsSent}findRemoteStatsId(e,t){var n;const r=Array.from(pp(n=this.report).call(n)).find(n=>n.type===t&&n.ssrc===e);return r?r.id:null}processVideoMediaSource(e,t){const n=this.report.get(e);n&&n.width&&n.height&&n.framesPerSecond&&(t.inputFrame={width:n.width,height:n.height,frameRate:n.framesPerSecond})}processAudioMediaSource(e,t){const n=this.report.get(e);n&&(t.inputLevel=n.audioLevel)}processVideoTrackSenderStats(e,t,n){var r,i,o,a;const s=t?this.report.get(t):void 0,c=null!==(r=null==s?void 0:s.framesSent)&&void 0!==r?r:e.framesSent;if("number"!=typeof c)return;let l=null!==(i=null==s?void 0:s.frameWidth)&&void 0!==i?i:e.frameWidth,d=null!==(o=null==s?void 0:s.frameHeight)&&void 0!==o?o:e.frameHeight,u=null!==(a=null==s?void 0:s.framesPerSecond)&&void 0!==a?a:e.framesPerSecond;if("number"==typeof l&&"number"==typeof d||(l=0,d=0),null==u){const e=Date.now(),t=this.lastVideoFramesSent.get(n.ssrc);t&&e-t.lts>=800?(u=Math.round((c-t.count)/((e-t.lts)/1e3)),this.lastVideoFramesSent.set(n.ssrc,{count:c,lts:e,rate:u})):t?u=t.rate:this.lastVideoFramesSent.set(n.ssrc,{count:c,lts:e,rate:0})}n.sentFrame={width:l,height:d,frameRate:Math.max(0,u)}}processVideoTrackReceiverStats(e,t,n){var r,i,o,a,s;const c=t?this.report.get(t):void 0,l=null!==(r=null==c?void 0:c.framesReceived)&&void 0!==r?r:e.framesReceived,d=null!==(i=null==c?void 0:c.frameWidth)&&void 0!==i?i:e.frameWidth,u=null!==(o=null==c?void 0:c.frameHeight)&&void 0!==o?o:e.frameHeight,h=null!==(a=null==c?void 0:c.jitterBufferDelay)&&void 0!==a?a:e.jitterBufferDelay,p=null!==(s=null==c?void 0:c.jitterBufferEmittedCount)&&void 0!==s?s:e.jitterBufferEmittedCount;if("number"==typeof l){const e=this.lastVideoFramesRecv.get(n.ssrc),t=Date.now();n.framesReceivedCount=l;let r=0;e&&t-e.lts>=800?(r=Math.round((l-e.count)/((t-e.lts)/1e3)),this.lastVideoFramesRecv.set(n.ssrc,{count:l,lts:t,rate:r})):e?r=e.rate:this.lastVideoFramesRecv.set(n.ssrc,{count:l,lts:t,rate:0}),n.receivedFrame={width:d||0,height:u||0,frameRate:r||0},n.decodedFrame={width:d||0,height:u||0,frameRate:n.decodeFrameRate||0},n.outputFrame={width:d||0,height:u||0,frameRate:n.outputFrameRate||n.decodeFrameRate||0}}if(h&&p){const e=this.lastVideoJBDelay.get(n.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const r=p-e.jitterBufferEmittedCount;r>0&&(t=1e3*(h-e.jitterBufferDelay)/r),n.jitterBufferMs=t,n.currentDelayMs=Math.round(t),this.lastVideoJBDelay.set(n.ssrc,{jitterBufferDelay:h,jitterBufferEmittedCount:p,jitterBufferMs:n.currentDelayMs})}}processAudioTrackSenderStats(e,t,n){var r,i,o,a;const s=t?this.report.get(t):void 0,c=null!==(r=null!==(i=null==s?void 0:s.echoReturnLoss)&&void 0!==i?i:e.echoReturnLoss)&&void 0!==r?r:0,l=null!==(o=null!==(a=null==s?void 0:s.echoReturnLossEnhancement)&&void 0!==a?a:e.echoReturnLossEnhancement)&&void 0!==o?o:0;n.aecReturnLoss=c,n.aecReturnLossEnhancement=l}processAudioTrackReceiverStats(e,t,n){var r,i,o,a,s,c,l,d,u;const h=t?this.report.get(t):void 0,p=null!==(r=null==h?void 0:h.removedSamplesForAcceleration)&&void 0!==r?r:e.removedSamplesForAcceleration,m=null!==(i=null==h?void 0:h.totalSamplesReceived)&&void 0!==i?i:e.totalSamplesReceived,f=null!==(o=null==h?void 0:h.jitterBufferDelay)&&void 0!==o?o:e.jitterBufferDelay,g=null!==(a=null==h?void 0:h.jitterBufferEmittedCount)&&void 0!==a?a:e.jitterBufferEmittedCount,_=null!==(s=null==h?void 0:h.audioLevel)&&void 0!==s?s:null==e?void 0:e.audioLevel,v=null!==(c=null==h?void 0:h.totalSamplesDuration)&&void 0!==c?c:null==e?void 0:e.totalSamplesDuration,b=null!==(l=null==h?void 0:h.concealedSamples)&&void 0!==l?l:e.concealedSamples,E=null!==(d=null==h?void 0:h.silentConcealedSamples)&&void 0!==d?d:e.silentConcealedSamples,y=null!==(u=null==h?void 0:h.concealmentEvents)&&void 0!==u?u:e.concealmentEvents;if("number"==typeof m&&(n.totalSamplesReceived=m),"number"==typeof E&&(n.silentConcealedSamples=E),"number"==typeof y&&(n.concealmentEvents=y),"number"==typeof b&&(n.concealedSamples=b),p&&m&&(n.accelerateRate=p/m),f&&g){const e=this.lastAudioJBDelay.get(n.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const r=g-e.jitterBufferEmittedCount;r>0&&(t=1e3*(f-e.jitterBufferDelay)/r),n.jitterBufferMs=Math.round(t),this.lastAudioJBDelay.set(n.ssrc,{jitterBufferDelay:f,jitterBufferEmittedCount:g,jitterBufferMs:n.jitterBufferMs})}n.outputLevel=_;let S=1920;v&&m&&(S=m/v/50,n.receivedFrames=Math.round(m/S)),b&&(n.droppedFrames=Math.round(b/S))}processRemoteInboundStats(e,t){const n=this.report.get(e);n&&(t.packetsLost=n.packetsLost,n.roundTripTime&&(t.rttMs=1e3*n.roundTripTime),n.jitter&&(t.jitterMs=1e3*n.jitter),n.timestamp&&(t.timestamp=n.timestamp))}getCodecFromCodecStats(e){const t=this.report.get(e);if(!t)return"";const n=t.mimeType.match(/\/(.*)$/);return n&&n[1]?n[1]:""}updateSendBitrate(){let e=0,t=null,n=null;this.mediaBytesSent.forEach(t=>{e+=t.diffMean()}),this.mediaBytesRetransmit.forEach(e=>{t=null===t?e.diffMean():t+e.diffMean()}),this.mediaBytesTargetEncode.forEach(e=>{n=null===n?e.diffMean():n+e.diffMean()});const r=null!==t?e-t:e;this._stats.bitrate={actualEncoded:8*r/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==n&&(this._stats.bitrate.targetEncoded=8*n/(this.options.updateInterval/1e3))}},cP=class extends $O{updateStats(){return ip.resolve()}};function lP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4;const o=function(){const e=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return e&&e[0]?Number(e[0].split("/")[1]):null}();return o?o<76?new eP(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):new sP(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):function(e){if(!window.RTCStatsReport)return!1;const t=e.getStats();return!!(t instanceof ip||function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}(t))}(e)?new sP(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):new cP(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i})}const dP="websdk_ng_install_id";function uP(){try{if(SP("INSTALL_ID"))return SP("INSTALL_ID");let e=window.localStorage.getItem(dP);return e||(e=bO(),window.localStorage.setItem(dP,e)),yP("INSTALL_ID",e),e}catch(e){return}}const hP=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(t&&t[1]&&t[2]){const e=t[1],n=t[2];return"".concat(e,".").concat(n)}return"4.0.0.999"}("4.24.2"),pP=function(){try{return!0===JSON.parse("true")}catch(e){return!0}}();let mP=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const fP=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const r=n.join(""),i=[];for(let s=0;s<6;s++)i.push("1");const o=i.join(""),a={};return a[e]=r,a[t]=o,Object.assign(a,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=fP;const gP={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!0,FORCE_ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:1,ENABLE_AUT_FEEDBACK:!0,SVC_EXTENDED:["VP9"]},_P={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},vP="v4.24.2-0-g002485b1-dirty(12/12/2025, 5:26:54 PM)",bP={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",TURN_DOMAINS:["edge.agora.io"],USE_TURN_IP:!0,NEW_TURN_MODE:4,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1,FLS_FALLBACK_TIMEOUT:3e4,RTE_DETAIL_REPORT_INTERVAL:6e4,ENCODE_EXCEPTION_TIMES:5,ENABLE_ENCODE_EXCEPTION:!0,ENCODE_EXCEPTION_VALIDATE_CODEC:["h264"],VIDEO_ENCODER_CONFIG_LIST:[{width:240,height:180},{width:320,height:240},{width:400,height:300},{width:480,height:360},{width:560,height:420},{width:640,height:480}],DELETE_NEQ_AFTER_USER_LEAVE:!0,UPDATE_RTP_CAP_IN_HOST:!1,IOS_BG_TAG:!0,IOS_AUTO_RESTART_BG_TAG:!0,IGNORE_UID_CHECK:!1,ENABLE_UP_SPS_PPS:!1,ENABLE_DOWN_SPS_PPS:!1,NO_EDGES_RETRY:!0,BUFFER_READY_FRAMES:3,FLS_SYNC_AV_PLAY_LIMIT:0,FLS_BUFFER_WAIT_TIME:1500,VOS_CONFIGURE:void 0,ENABLE_QUALITY_FALLBACK:!1,QUALITY_FALLBACK_REHEARSAL:!0,ENABLE_FLS_AV1_FIRST:!1,ENABLE_AP_MULTI_IP:!0,FLS_ENABLE_AV1_DETECT:!0,FLS_ENABLE_AV1_DECODE_DETECT:!0},EP=uN(uN(uN(uN({},bP),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_MANAGER_WSS:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_WSS:"",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ENABLE_ABSSENDTIME_AS_SENTTS:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,DC_JOIN_WITH_FAILBACK:4e3,DC_CONNECTION_TIMEOUT:2e3,DC_PINGPONG_INTERVAL:2e3,DC_DEBUG_LOG:!1,UNSUPPORTED_VIDEO_UPLINK_CODEC:[],UNSUPPORTED_VIDEO_DOWNLINK_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:_P,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},gP),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,REMOTE_VIDEO_STREAM_TYPE:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1,ENABLE_FORCE_HLS:!1,MAX_WEBAUDIO_VOLUME:300,ENABLE_VOS_FALLBACK:!1,ENABLE_FALLBACK_TO_HLS:!1,ENABLE_PRE_RENDER:!1,FORCE_DISABLE_AUTO_SUB:!1,ENABLE_PRE_SUB_WITH_PRE_PC:!0,PRE_USE_LOCAL_CODECS:!0},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:2,BASELINE_MORE_H264_BITRATE_RATIO:1.1,IGNORE_RTC_DEVICE_CHECK:!1,FLS_AUTOPLAY_EMITS:!1,ENABLE_DUAL_STREAM_FLAG:!1,FORBID_MODIFY_LOCAL_OFFER_SDP:!1,RESERVE_MID_1_MLINE:!1});function yP(e,t,n){var r,i,o;xr(r=Object.keys(EP)).call(r,e)&&(!n&&xr(i=Object.keys(CP)).call(i,e)||(EP[e]=t,"ENABLE_VIDEO_SEI"!==e&&"ENABLE_AUDIO_TOPN"!==e&&"ENABLE_AUDIO_METADATA"!==e&&"ENABLE_AUDIO_PTS"!==e||!0!==t||(EP.ENABLE_ENCODED_TRANSFORM=!0),"USE_NEW_NETWORK_CONFIG"===e&&t&&(o=!!t,EP.USE_NEW_NETWORK_CONFIG=o,o&&(EP.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],EP.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],EP.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],EP.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],EP.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",EP.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",EP.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),"ENABLE_PRE_SUB"===e&&t&&(EP.ENABLE_INSTANT_VIDEO=!0,EP.ENABLE_PREALLOC_PC=!0),"ENABLE_SVC"===e&&t&&(EP.ENABLE_AUT_CC=!0),"NEW_FORCE_TURN"===e&&t&&(EP.NEW_TURN_MODE||(EP.NEW_TURN_MODE=4))))}function SP(e){if("TURN_DOMAINS"===e){const e=EP.TURN_DOMAINS;return xr(e).call(e,SP("TURN_DOMAIN"))?e:[SP("TURN_DOMAIN")].concat(e)}return EP[e]}pP||(EP.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],EP.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],EP.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],EP.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],EP.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],EP.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EP.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",EP.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",EP.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",EP.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",EP.AREAS=["NORTH_AMERICA","OVERSEA"]);let TP=function(e){return e[e.REALTIME=1]="REALTIME",e}({});const CP={};var wP=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_RTE_URL="SET_RTE_URL",e.SET_RTE_SID="SET_RTE_SID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.KEY_METRIC_PRELOAD_START="KEY_METRIC_PRELOAD_START",e.KEY_METRIC_PRELOAD_END="KEY_METRIC_PRELOAD_END",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_REQUEST_SUA_END="KEY_METRIC_REQUEST_SUA_END",e.KEY_METRIC_BEFORE_CONNECT="KEY_METRIC_BEFORE_CONNECT",e.KEY_METRIC_PEER_RECEIVER="KEY_METRIC_PEER_RECEIVER",e.KEY_METRIC_SIGNAL_CONNECTED="KEY_METRIC_SIGNAL_CONNECTED",e.KEY_METRIC_JOIN_REQ="KEY_METRIC_JOIN_REQ",e.KEY_METRIC_JOIN_REP="KEY_METRIC_JOIN_REP",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED="KEY_METRIC_FIRST_VIDEO_FRAME_DECODED",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.RESET_FIRST_VIDEO_FRAME_DECODED="RESET_FIRST_VIDEO_FRAME_DECODED",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(wP||{});let RP=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});!function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"}({});const AP=128,IP=96,NP=1e3,OP=10;let PP=0;var kP=(()=>{var e={8:(e,t,n)=>{n.r(t),n.d(t,{Parser:()=>S,Printer:()=>A,parse:()=>P,print:()=>k});const r="\n",i="".concat("\r").concat(r),o=" ";let a;function s(e){return e>="0"&&e<="9"}function c(e){return e>="!"&&e<="~"}function l(e){return c(e)||e>="\x80"&&e<="\xff"}function d(e){return"!"===e||e>="#"&&e<="'"||e>="*"&&e<="+"||e>="-"&&e<="."||e>="0"&&e<="9"||e>="A"&&e<="Z"||e>="^"&&e<="~"}function u(e){return e>="1"&&e<="9"}function h(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function p(e){return"d"===e||"h"===e||"m"===e||"s"===e}function m(e){return e>"\x01"&&e<"\t"||e>"\v"&&e<"\f"||e>"\x0e"&&e<"\xff"}function f(e){return h(e)||s(e)||"+"===e||"/"===e}function g(e){return s(e)||h(e)||"+"===e||"/"===e||"-"===e||"_"===e}function _(e){return h(e)||s(e)||"+"===e||"/"===e}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.VERSION="v",e.ORIGIN="o",e.SESSION_NAME="s",e.INFORMATION="i",e.URI="u",e.EMAIL="e",e.PHONE="p",e.CONNECTION="c",e.BANDWIDTH="b",e.TIME="t",e.REPEAT="r",e.ZONE_ADJUSTMENTS="z",e.KEY="k",e.ATTRIBUTE="a",e.MEDIA="m"}(a||(a={}));class y{consumeText(e,t){let n=t;for(;n<e.length;){const t=e[n];if("\0"===t||"\r"===t||t===r)break;n+=1}if(n-t==0)throw new Error("Invalid text, at ".concat(e));return n}consumeUnicastAddress(e,t,n){return this.consumeTill(e,t,o)}consumeOneOrMore(e,t,n){let r=t;for(;n(e[r]);)r++;if(r-t==0)throw new Error("Invalid rule at ".concat(t,"."));return r}consumeSpace(e,t){if(e[t]===o)return t+1;throw new Error("Invalid space at ".concat(t,"."))}consumeIP4Address(e,t){let n=t;for(let r=0;r<4;r++)if(n=this.consumeDecimalUChar(e,n),3!==r){if("."!==e[n])throw new Error("Invalid IP4 address.");n++}return n}consumeDecimalUChar(e,t){let n=t;for(let i=0;i<3&&s(e[n]);i++,n++);if(n-t==0)throw new Error("Invalid decimal uchar.");const r=parseInt(e.slice(t,n));if(r>=0&&r<=255)return n;throw new Error("Invalid decimal uchar")}consumeIP6Address(e,t){let n=this.consumeHexpart(e,t);return":"===e[n]?(n+=1,n=this.consumeIP4Address(e,n),n):n}consumeHexpart(e,t){let n=t;if(":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}if(n=this.consumeHexseq(e,n),":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}return n}consumeHexseq(e,t){let n=t;for(;n=this.consumeHex4(e,n),":"===e[n]&&":"!==e[n+1];)n+=1;return n}consumeHex4(e,t){let n=0;for(;n<4;n++)if(!((r=e[t+n])>="0"&&r<="9"||r>="a"&&r<="f"||r>="A"&&r<="F")){if(0===n)throw new Error("Invalid hex 4");break}var r;return t+n}consumeFQDN(e,t){let n=t;for(;s(e[n])||h(e[n])||"-"===e[n]||"."===e[n];)n+=1;if(n-t<4)throw new Error("Invalid FQDN");return n}consumeExtnAddr(e,t){return this.consumeOneOrMore(e,t,l)}consumeMulticastAddress(e,t,n){switch(n){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e,t);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e,t);default:try{return this.consumeFQDN(e,t)}catch(n){return this.consumeExtnAddr(e,t)}}}consumeIP6MulticastAddress(e,t){const n=this.consumeHexpart(e,t);return"/"===e[n]?this.consumeInteger(e,n+1):n}consumeIP4MulticastAddress(e,t){let n=t+3;const r=e.slice(t,n),i=parseInt(r);if(i<224||i>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let o=0;o<3;o++){if("."!==e[n])throw new Error("Invalid IP4 multicast address.");n+=1,n=this.consumeDecimalUChar(e,n)}return"/"===e[n]&&(n+=1),n=this.consumeTTL(e,n),"/"===e[n]&&(n=this.consumeInteger(e,n)),n}consumeInteger(e,t){if(!u(e[t]))throw new Error("Invalid integer.");for(t+=1;s(e[t]);)t+=1;return t}consumeTTL(e,t){if("0"===e[t])return t+1;if(!u(e[t]))throw new Error("Invalid TTL.");t+=1;for(let n=0;n<2&&s(e[t]);n++)t+=1;return t}consumeToken(e,t){return this.consumeOneOrMore(e,t,d)}consumeTime(e,t){let n=t;if("0"===e[n])return n+1;for(u(e[n])&&(n+=1);s(e[n]);)n++;if(n-t<10)throw new Error("Invalid time");return n}consumeAddress(e,t){return this.consumeTill(e,t,o)}consumeTypedTime(e,t){let n=t;return n=this.consumeOneOrMore(e,n,s),p(e[n])?n+1:n}consumeRepeatInterval(e,t){if(!u(e[t]))throw new Error("Invalid repeat interval");for(t+=1;s(e[t]);)t+=1;return p(e[t])&&(t+=1),t}consumePort(e,t){return this.consumeOneOrMore(e,t,s)}consume(e,t,n){for(let r=0;r<n.length;r++){if(t+r>=e.length)throw new Error("consume exceeding value length");if(e[t+r]!==n[r])throw new Error("consume ".concat(n," failed at ").concat(r))}return t+n.length}consumeTill(e,t,n){let r=t;for(;r<e.length&&("string"!=typeof n||e[r]!==n)&&("function"!=typeof n||!n(e[r]));)r++;return r}}class S extends y{constructor(){super(),E(this,"records",[]),E(this,"currentLine",0)}parse(e){const t=this.probeEOL(e);this.records=e.split(t).filter(e=>!!xb(e).call(e)).map(this.parseLine),this.currentLine=0;const n=this.parseVersion(),r=this.parseOrigin(),i=this.parseSessionName(),o=this.parseInformation(),a=this.parseUri(),s=this.parseEmail(),c=this.parsePhone(),l=this.parseConnection(),d=this.parseBandWidth(),u=this.parseTimeFields(),h=this.parseKey(),p=this.parseSessionAttribute(),m=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:n,origin:r,sessionName:i,information:o,uri:a,emails:s,phones:c,connection:l,bandwidths:d,timeFields:u,key:h,attributes:p,mediaDescriptions:m}}getCurrentRecord(){const e=this.records[this.currentLine];if(!e)throw new Error("Record doesn't exit.");return e}probeEOL(e){for(let t=0;t<e.length;t++)if(e[t]===r)return"\r"===e[t-1]?i:r;throw new Error("Invalid newline character.")}parseLine(e,t){if(e.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const n=e[0];if("="!==e[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:n,value:e.slice(2),line:t,cur:0}}parseSessionAttribute(){const e=new C;for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==a.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(t,e=>d(e)&&":"!==e),_cur:0};":"===t.value[t.cur]&&(t.cur+=1,n.attValue=this.extractOneOrMore(t,m)),e.parse(n),this.currentLine++}return e.digest()}parseMediaAttributes(e){const t=new w(e);for(;this.currentLine<this.records.length;){const e=this.getCurrentRecord();if(e.type!==a.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(e,e=>d(e)&&":"!==e),_cur:0};":"===e.value[e.cur]&&(e.cur+=1,n.attValue=this.extractOneOrMore(e,m)),t.parse(n),this.currentLine++}return t.digest()}parseKey(){const e=this.getCurrentRecord();if(e.type===a.KEY){if("prompt"===e.value||"clear:"===e.value||"base64:"===e.value||"uri:"===e.value)return e.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e=this.getCurrentRecord();if(e.type===a.ZONE_ADJUSTMENTS){const t=[];for(;;)try{const n=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);let r=!1;"-"===e.value[e.cur]&&(r=!0,e.cur+=1);const i=this.extract(e,this.consumeTypedTime);t.push({time:n,typedTime:i,back:r})}catch(e){break}if(0===t.length)throw new Error("Invalid zone adjustments");return this.currentLine++,t}return[]}parseRepeat(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.REPEAT)break;{const n=this.extract(t,this.consumeRepeatInterval),r=this.parseTypedTime(t);e.push({repeatInterval:n,typedTimes:r}),this.currentLine++}}return e}parseTypedTime(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeTypedTime))}catch(e){break}if(0===t.length)throw new Error("Invalid typed time.");return t}parseTime(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);const n=this.extract(e,this.consumeTime);return this.currentLine++,{startTime:t,stopTime:n}}parseBandWidth(){const e=[];for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==a.BANDWIDTH)break;{const n=this.extractOneOrMore(t,d);if(":"!==t.value[t.cur])throw new Error("Invalid bandwidth field.");t.cur++;const r=this.extractOneOrMore(t,s);e.push({bwtype:n,bandwidth:r}),this.currentLine++}}return e}parseVersion(){const e=this.getCurrentRecord();if(e.type!==a.VERSION)throw new Error("first sdp record must be version");const t=e.value.slice(0,this.consumeOneOrMore(e.value,0,s));if(t.length!==e.value.length)throw new Error('invalid proto version, "v='.concat(e.value,'"'));return this.currentLine++,t}parseOrigin(){const e=this.getCurrentRecord();if(e.type!==a.ORIGIN)throw new Error("second line of sdp must be origin");const t=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,s);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,s);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const o=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const c=this.extract(e,this.consumeUnicastAddress);return this.currentLine++,{username:t,sessId:n,sessVersion:r,nettype:i,addrtype:o,unicastAddress:c}}parseSessionName(){const e=this.getCurrentRecord();if(e.type===a.SESSION_NAME){const t=this.extract(e,this.consumeText);return this.currentLine++,t}}parseInformation(){const e=this.getCurrentRecord();if(e.type!==a.INFORMATION)return;const t=this.extract(e,this.consumeText);return this.currentLine++,t}parseUri(){const e=this.getCurrentRecord();if(e.type===a.URI)return this.currentLine++,e.value}parseEmail(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.EMAIL)break;e.push(t.value),this.currentLine++}return e}parsePhone(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==a.PHONE)break;e.push(t.value),this.currentLine++}return e}parseConnection(){const e=this.getCurrentRecord();if(e.type===a.CONNECTION){const t=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const r=this.extract(e,this.consumeAddress);return this.currentLine++,{nettype:t,addrtype:n,address:r}}}parseMedia(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeToken);this.consumeSpaceForRecord(e);let n=this.extract(e,this.consumePort);"/"===e.value[e.cur]&&(e.cur+=1,n+=this.extract(e,this.consumeInteger)),this.consumeSpaceForRecord(e);const r=[];for(r.push(this.extract(e,this.consumeToken));"/"===e.value[e.cur];)e.cur+=1,r.push(this.extract(e,this.consumeToken));if(0===r.length)throw new Error("Invalid proto");const i=this.parseFmt(e);return this.currentLine++,{mediaType:t,port:n,protos:r,fmts:i}}parseTimeFields(){const e=[];for(;this.getCurrentRecord().type===a.TIME;){const t=this.parseTime(),n=this.parseRepeat(),r=this.parseZone();e.push({time:t,repeats:n,zones:r})}return e}parseMediaDescription(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===a.MEDIA;){const t=this.parseMedia(),n=this.parseInformation(),r=this.parseConnections(),i=this.parseBandWidth(),o=this.parseKey(),a=this.parseMediaAttributes(t);e.push({media:t,information:n,connections:r,bandwidths:i,key:o,attributes:a})}return e}parseConnections(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===a.CONNECTION;)e.push(this.parseConnection());return e}parseFmt(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeToken))}catch(e){break}if(0===t.length)throw new Error("Invalid fmts");return t}extract(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];const o=t.call(this,e.value,e.cur,...r),a=e.value.slice(e.cur,o);return e.cur=o,a}extractOneOrMore(e,t){const n=this.consumeOneOrMore(e.value,e.cur,t),r=e.value.slice(e.cur,n);return e.cur=n,r}consumeSpaceForRecord(e){if(e.value[e.cur]!==o)throw new Error("Invalid space at ".concat(e.cur,"."));e.cur+=1}}class T extends y{constructor(){super(...arguments),E(this,"attributes",void 0),E(this,"digested",!1)}extractOneOrMore(e,t,n){const r=this.consumeOneOrMore(e.attValue,e._cur,t),i=e.attValue.slice(e._cur,r),[o,a]=n||[];if("number"==typeof o&&i.length<o)throw new Error("error in length, should be more or equal than ".concat(o," characters."));if("number"==typeof a&&i.length>a)throw new Error("error in length, should be less or equal than ".concat(a," characters."));return e._cur=r,i}consumeAttributeSpace(e){if(e.attValue[e._cur]!==o)throw new Error("Invalid space at ".concat(e._cur,"."));e._cur+=1}extract(e,t){if(!e.attValue)throw new Error("Nothing to extract from attValue.");for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];const o=t.call(this,e.attValue,e._cur,...r),a=e.attValue.slice(e._cur,o);return e._cur=o,a}atEnd(e){if(!e.attValue)throw new Error;return e._cur>=e.attValue.length}peekChar(e){if(!e.attValue)throw new Error;return e.attValue[e._cur]}peek(e,t){if(!e.attValue)throw new Error;for(let n=0;n<t.length;n++)if(t[n]!==e.attValue[e._cur+n])return!1;return!0}parseIceUfrag(e){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e,f,[4,256])}parseIcePwd(e){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e,f,[22,256])}parseIceOptions(e){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const t=[];for(;!this.atEnd(e);){t.push(this.extractOneOrMore(e,f));try{this.consumeAttributeSpace(e)}catch(t){if(this.atEnd(e))break;throw t}}this.attributes.iceOptions=t}parseFingerprint(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill);this.attributes.fingerprints.push({hashFunction:t,fingerprint:n})}parseExtmap(e){const t=this.extractOneOrMore(e,s);let n;"/"===this.peekChar(e)&&(this.extract(e,this.consume,"/"),n=this.extract(e,this.consumeToken)),this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,o),i=b(b({entry:parseInt(t,10)},n&&{direction:n}),{},{extensionName:r});this.peekChar(e)===o&&(this.consumeAttributeSpace(e),i.extensionAttributes=this.extract(e,this.consumeTill)),this.attributes.extmaps.push(i)}parseSetup(e){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const t=this.extract(e,this.consumeTill);if("active"!==t&&"passive"!==t&&"actpass"!==t&&"holdconn"!==t)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=t}}class C extends T{constructor(){super(...arguments),E(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"group":this.parseGroup(e);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"fingerprint":this.parseFingerprint(e);break;case"setup":this.parseSetup(e);break;case"tls-id":this.parseTlsId(e);break;case"identity":this.parseIdentity(e);break;case"extmap":this.parseExtmap(e);break;case"msid-semantic":this.parseMsidSemantic(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing session attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;)this.consumeAttributeSpace(e),n.push(this.extract(e,this.consumeToken));this.attributes.groups.push({semantic:t,identificationTag:n})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e,g)}parseIdentity(e){const t=this.extractOneOrMore(e,_),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.extract(e,this.consume,"=");const r=this.extractOneOrMore(e,e=>e!==o&&m(e));n.push({name:t,value:r})}this.attributes.identities.push({assertionValue:t,extensions:n})}parseMsidSemantic(e){this.peekChar(e)===o&&this.consumeAttributeSpace(e);const t={semantic:this.extract(e,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e)}catch(e){break}if("*"===this.peekChar(e)){this.extract(e,this.consume,"*"),t.applyForAll=!0;break}{const n=this.extract(e,this.consumeTill,o);t.identifierList.push(n)}}this.attributes.msidSemantic=t}}class w extends T{constructor(e){super(),E(this,"attributes",void 0),-1!==e.protos.indexOf("RTP")||e.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"extmap":this.parseExtmap(e);break;case"setup":this.parseSetup(e);break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"candidate":this.parseCandidate(e);break;case"remote-candidate":this.parseRemoteCandidate(e);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e);break;case"rtpmap":this.parseRtpmap(e);break;case"ptime":this.parsePtime(e);break;case"maxptime":this.parseMaxPtime(e);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e);break;case"ssrc":this.parseSSRC(e);break;case"fmtp":this.parseFmtp(e);break;case"rtcp-fb":this.parseRtcpFb(e);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e);break;case"mid":this.parseMid(e);break;case"msid":this.parseMsid(e);break;case"imageattr":this.parseImageAttr(e);break;case"rid":this.parseRid(e);break;case"simulcast":this.parseSimulcast(e);break;case"sctp-port":this.parseSctpPort(e);break;case"max-message-size":this.parseMaxMessageSize(e);break;case"ssrc-group":this.parseSSRCGroup(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing media attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}parseCandidate(e){const t=this.extractOneOrMore(e,f,[1,32]);this.consumeAttributeSpace(e);const n=this.extractOneOrMore(e,s,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const i=this.extractOneOrMore(e,s,[1,10]);this.consumeAttributeSpace(e);const a=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const l=this.extract(e,this.consumePort);this.consumeAttributeSpace(e),this.extract(e,this.consume,"typ"),this.consumeAttributeSpace(e);const d={foundation:t,componentId:n,transport:r,priority:i,connectionAddress:a,port:l,type:this.extract(e,this.consumeToken),extension:{}};for(this.peek(e," raddr")&&(this.extract(e,this.consume," raddr"),this.consumeAttributeSpace(e),d.relAddr=this.extract(e,this.consumeAddress)),this.peek(e," rport")&&(this.extract(e,this.consume," rport"),this.consumeAttributeSpace(e),d.relPort=this.extract(e,this.consumePort));this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e),d.extension[t]=this.extractOneOrMore(e,c)}this.attributes.candidates.push(d)}parseRemoteCandidate(e){const t=[];for(;;){const n=this.extractOneOrMore(e,s,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumePort);t.push({componentId:n,connectionAddress:r,port:i});try{this.consumeAttributeSpace(e)}catch(e){break}}this.attributes.remoteCandidatesList.push(t)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,"/");this.extract(e,this.consume,"/");const r={encodingName:n,clockRate:this.extractOneOrMore(e,s)};this.atEnd(e)||"/"!==this.peekChar(e)||(this.extract(e,this.consume,"/"),r.encodingParameters=parseInt(this.extract(e,this.consumeTill),10));const i=this.attributes.payloads.find(e=>e.payloadType===parseInt(t,10));i?i.rtpMap=r:this.attributes.payloads.push({payloadType:parseInt(t,10),rtpMap:r,rtcpFeedbacks:[]})}parsePtime(e){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e,this.consumeTill)}parseMaxPtime(e){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e,this.consumeTill)}parseDirection(e){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e.attField}parseSSRC(e){const t=this.extractOneOrMore(e,s);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,":");let r;":"===this.peekChar(e)&&(this.extract(e,this.consume,":"),r=this.extract(e,this.consumeTill));const i=this.attributes.ssrcs.find(e=>e.ssrcId===parseInt(t,10));i?i.attributes[n]=r:this.attributes.ssrcs.push({ssrcId:parseInt(t,10),attributes:{[n]:r}})}parseFmtp(e){const t=this.extract(e,this.consumeTill,o);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill),r={};n.split(";").forEach(e=>{let[t,n]=e.split("=");t=xb(t).call(t);const i="string"==typeof n?xb(n).call(n):null;"string"==typeof t&&t.length>0&&(r[t]=i)});const i=this.attributes.payloads.find(e=>e.payloadType===parseInt(t,10));i?i.fmtp={parameters:r}:this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[],fmtp:{parameters:r}})}parseFmtParameters(e){const t={},n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");for(t[n]=r;";"===e.attValue[e._cur];){const n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");t[n]=r}return t}parseRtcpFb(e){let t="";t="*"===this.peekChar(e)?this.extract(e,this.consume,"*"):this.extract(e,this.consumeTill,o),this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,o);let r;if("trr-int"===n)r={type:n,interval:this.extract(e,this.consumeTill)};else{const t={type:n};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.parameter=this.extract(e,this.consumeToken),this.peekChar(e)===o&&(t.additional=this.extract(e,this.consumeTill))),r=t}if("*"===t)this.attributes.rtcpFeedbackWildcards.push(r);else{const e=this.attributes.payloads.find(e=>e.payloadType===parseInt(t,10));e?e.rtcpFeedbacks.push(r):this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[r]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const t={port:this.extract(e,this.consumePort)};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.netType=this.extractOneOrMore(e,d),this.consumeAttributeSpace(e),t.addressType=this.extractOneOrMore(e,d),this.consumeAttributeSpace(e),t.address=this.extract(e,this.consumeAddress)),this.attributes.rtcp=t}parseMsid(e){const t={id:this.extractOneOrMore(e,d,[1,64])};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.appdata=this.extractOneOrMore(e,d,[1,64])),this.attributes.msids.push(t)}parseImageAttr(e){this.attributes.imageattr.push(e.attValue)}parseRid(e){const t=this.extractOneOrMore(e,e=>h(e)||s(e)||"_"===e||"-"===e);this.consumeAttributeSpace(e);const n={id:t,direction:this.extract(e,this.consumeToken),params:[]};if(this.peekChar(e)===o){if(this.consumeAttributeSpace(e),this.peek(e,"pt=")){this.extract(e,this.consume,"pt=");const t=[];for(;;){const n=this.extract(e,this.consumeToken);t.push(n);try{this.extract(e,this.consume,",")}catch(e){break}}n.payloads=t,this.peekChar(e)===o&&this.extract(e,this.consume,o)}for(;;){const t=this.extract(e,this.consumeToken);switch(t){case"depend":{const r={type:t,rids:this.extract(e,this.consume,"=").split(",")};n.params.push(r);break}default:{const r={type:t};"="===this.peekChar(e)&&(this.extract(e,this.consume,"="),r.val=this.extract(e,this.consumeTill,";")),n.params.push(r)}}try{this.extract(e,this.consume,";")}catch(e){break}}}this.attributes.rids.push(n)}parseSimulcast(e){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e.attValue,this.extract(e,this.consumeTill)}parseSctpPort(e){this.attributes.sctpPort=this.extractOneOrMore(e,s,[1,5])}parseMaxMessageSize(e){this.attributes.maxMessageSize=this.extractOneOrMore(e,s,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e){this.attributes.mid=this.extract(e,this.consumeToken)}parseSSRCGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;;)try{this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeInteger);n.push(parseInt(t,10))}catch(e){break}this.attributes.ssrcGroups.push({semantic:t,ssrcIds:n})}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A{constructor(){R(this,"eol",i)}print(e,t){let n="";return t&&(this.eol=t),n+=this.printVersion(e.version),n+=this.printOrigin(e.origin),n+=this.printSessionName(e.sessionName),n+=this.printInformation(e.information),n+=this.printUri(e.uri),n+=this.printEmail(e.emails),n+=this.printPhone(e.phones),n+=this.printConnection(e.connection),n+=this.printBandwidth(e.bandwidths),n+=this.printTimeFields(e.timeFields),n+=this.printKey(e.key),n+=this.printSessionAttributes(e.attributes),n+=this.printMediaDescription(e.mediaDescriptions),n}printVersion(e){return"v=".concat(e).concat(this.eol)}printOrigin(e){return"o=".concat(e.username," ").concat(e.sessId," ").concat(e.sessVersion," ").concat(e.nettype," ").concat(e.addrtype," ").concat(e.unicastAddress).concat(this.eol)}printSessionName(e){return e?"s=".concat(e).concat(this.eol):""}printInformation(e){return e?"i=".concat(e).concat(this.eol):""}printUri(e){return e?"u=".concat(e).concat(this.eol):""}printEmail(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printPhone(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printConnection(e){return e?"c=".concat(e.nettype," ").concat(e.addrtype," ").concat(e.address).concat(this.eol):""}printBandwidth(e){let t="";for(const n of e)t+="b=".concat(n.bwtype,":").concat(n.bandwidth).concat(this.eol);return t}printTimeFields(e){let t="";for(const n of e){t+="t=".concat(n.time.startTime," ").concat(n.time.startTime).concat(this.eol);for(const e of n.repeats)t+="r=".concat(e.repeatInterval," ").concat(e.typedTimes.join(" ")).concat(this.eol);n.zoneAdjustments&&(t+="z=",t+="z=".concat(n.zoneAdjustments.map(e=>"".concat(e.time," ").concat(e.back?"-":""," ").concat(e.typedTime)).join(" ")).concat(this.eol),t+=this.eol)}return t}printKey(e){return e?"k=".concat(e).concat(this.eol):""}printAttributes(e){let t="";for(const n of e)t+="a=".concat(n.attField).concat(n.attValue?":".concat(n.attValue):"").concat(this.eol);return t}printMediaDescription(e){let t="";for(const n of e)t+=this.printMedia(n.media),t+=this.printInformation(n.information),t+=this.printConnections(n.connections),t+=this.printBandwidth(n.bandwidths),t+=this.printKey(n.key),t+=this.printMediaAttributes(n);return t}printConnections(e){let t="";for(const n of e)t+=this.printConnection(n);return t}printMedia(e){return"m=".concat(e.mediaType," ").concat(e.port," ").concat(e.protos.join("/")," ").concat(e.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e){return new N(this.eol).print(e)}printMediaAttributes(e){return new O(this.eol).print(e)}}class I{constructor(e){R(this,"eol",void 0),this.eol=e}printIceUfrag(e){return void 0===e?"":"a=ice-ufrag:".concat(e).concat(this.eol)}printIcePwd(e){return void 0===e?"":"a=ice-pwd:".concat(e).concat(this.eol)}printIceOptions(e){return void 0===e?"":"a=ice-options:".concat(e.join(o)).concat(this.eol)}printFingerprints(e){return e.length>0?e.map(e=>"a=fingerprint:".concat(e.hashFunction).concat(o).concat(e.fingerprint)).join(this.eol)+this.eol:""}printExtmap(e){return e.map(e=>"a=extmap:".concat(e.entry).concat(e.direction?"/".concat(e.direction):"").concat(o).concat(e.extensionName).concat(e.extensionAttributes?"".concat(o).concat(e.extensionAttributes):"").concat(this.eol)).join("")}printSetup(e){return void 0===e?"":"a=setup:".concat(e).concat(this.eol)}printUnrecognized(e){return e.map(e=>"a=".concat(e.attField).concat(e.attValue?":".concat(e.attValue):"").concat(this.eol)).join("")}}class N extends I{print(e){let t="";return t+=this.printGroups(e.groups),t+=this.printMsidSemantic(e.msidSemantic),t+=this.printIceLite(e.iceLite),t+=this.printIceUfrag(e.iceUfrag),t+=this.printIcePwd(e.icePwd),t+=this.printIceOptions(e.iceOptions),t+=this.printFingerprints(e.fingerprints),t+=this.printSetup(e.setup),t+=this.printTlsId(e.tlsId),t+=this.printIdentity(e.identities),t+=this.printExtmap(e.extmaps),t+=this.printUnrecognized(e.unrecognized),t}printGroups(e){let t="";return e.length>0&&(t+=e.map(e=>"a=group:".concat(e.semantic).concat(e.identificationTag.map(e=>"".concat(o).concat(e)).join("")).concat(this.eol)).join("")),t}printIceLite(e){return void 0===e?"":"a=ice-lite"+this.eol}printTlsId(e){return e?"a=tls-id:".concat(e).concat(this.eol):""}printIdentity(e){return 0===e.length?"":e.map(e=>"a=identity:".concat(e.assertionValue).concat(e.extensions.map(e=>"".concat(o).concat(e.name).concat(e.value?"=".concat(e.value):"")))).join(this.eol)+this.eol}printMsidSemantic(e){if(!e)return"";let t="a=msid-semantic:".concat(e.semantic);return e.applyForAll?t+="".concat(o,"*"):e.identifierList.length>0&&(t+=e.identifierList.map(e=>"".concat(o).concat(e))),t+this.eol}}class O extends I{print(e){const t=e.attributes;let n="";return n+=this.printRTCP(t.rtcp),n+=this.printIceUfrag(t.iceUfrag),n+=this.printIcePwd(t.icePwd),n+=this.printIceOptions(t.iceOptions),n+=this.printCandidates(t.candidates),n+=this.printRemoteCandidatesList(t.remoteCandidatesList),n+=this.printEndOfCandidates(t.endOfCandidates),n+=this.printFingerprints(t.fingerprints),n+=this.printSetup(t.setup),n+=this.printMid(t.mid),n+=this.printExtmap(t.extmaps),n+=this.printRTPRelated(t),n+=this.printPtime(t.ptime),n+=this.printMaxPtime(t.maxPtime),n+=this.printDirection(t.direction),n+=this.printSSRCGroups(t.ssrcGroups),n+=this.printSSRC(t.ssrcs),n+=this.printRTCPMux(t.rtcpMux),n+=this.printRTCPMuxOnly(t.rtcpMuxOnly),n+=this.printRTCPRsize(t.rtcpRsize),n+=this.printMSId(t.msids),n+=this.printImageattr(t.imageattr),n+=this.printRid(t.rids),n+=this.printSimulcast(t.simulcast),n+=this.printSCTPPort(t.sctpPort),n+=this.printMaxMessageSize(t.maxMessageSize),n+=this.printUnrecognized(t.unrecognized),n}printCandidates(e){return e.map(e=>"a=candidate:".concat(e.foundation).concat(o).concat(e.componentId).concat(o).concat(e.transport).concat(o).concat(e.priority).concat(o).concat(e.connectionAddress).concat(o).concat(e.port).concat(o,"typ").concat(o).concat(e.type).concat(e.relAddr?"".concat(o,"raddr").concat(o).concat(e.relAddr):"").concat(e.relPort?"".concat(o,"rport").concat(o).concat(e.relPort):"").concat(Object.keys(e.extension).map(t=>"".concat(o).concat(t).concat(o).concat(e.extension[t])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(e){return e.map(e=>"a=remote-candidates:".concat(e.join(o)).concat(this.eol)).join("")}printEndOfCandidates(e){return void 0===e?"":"a=end-of-candidates"+this.eol}printRTPRelated(e){if(!e.payloads)return"";const t=e.payloads;let n="";n+=e.rtcpFeedbackWildcards.map(e=>this.printRTCPFeedback("*",e)).join("");for(const r of t)n+=this.printRtpMap(r.payloadType,r.rtpMap),n+=this.printFmtp(r.payloadType,r.fmtp),n+=r.rtcpFeedbacks.map(e=>this.printRTCPFeedback(r.payloadType,e)).join("");return n}printFmtp(e,t){if(!t)return"";const n=Object.keys(t.parameters);return 1===n.length&&null===t.parameters[n[0]]?"a=fmtp:".concat(e).concat(o).concat(n[0]).concat(this.eol):"a=fmtp:".concat(e).concat(o).concat(Object.keys(t.parameters).map(e=>"".concat(e,"=").concat(t.parameters[e])).join(";")).concat(this.eol)}printRtpMap(e,t){return t?"a=rtpmap:".concat(e).concat(o).concat(t.encodingName,"/").concat(t.clockRate).concat(t.encodingParameters?"/".concat(t.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e,t){let n="a=rtcp-fb:".concat(e).concat(o),r=t;return"trr-int"===r.type?n+="ttr-int".concat(o).concat(r.interval):(n+="".concat(r.type),r.parameter&&(n+="".concat(o).concat(r.parameter),r.additional&&(n+="".concat(o).concat(r.additional)))),n+this.eol}printPtime(e){return void 0===e?"":"a=ptime:".concat(e).concat(this.eol)}printMaxPtime(e){return void 0===e?"":"a=maxptime:".concat(e).concat(this.eol)}printDirection(e){return void 0===e?"":"a=".concat(e).concat(this.eol)}printSSRC(e){return e.map(e=>Object.keys(e.attributes).map(t=>"a=ssrc:".concat(e.ssrcId.toString(10)).concat(o).concat(t).concat(e.attributes[t]?":".concat(e.attributes[t]):"").concat(this.eol)).join("")).join("")}printRTCPMux(e){return void 0===e?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e){return void 0===e?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e){return void 0===e?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e){if(void 0===e)return"";let t="a=rtcp:".concat(e.port);return e.netType&&(t+="".concat(o).concat(e.netType)),e.addressType&&(t+="".concat(o).concat(e.addressType)),e.address&&(t+="".concat(o).concat(e.address)),t+this.eol}printMSId(e){return e.map(e=>"a=msid:".concat(e.id).concat(e.appdata?"".concat(o).concat(e.appdata):"").concat(this.eol)).join("")}printImageattr(e){return e.map(e=>"a=imageattr:".concat(e).concat(this.eol)).join("")}printRid(e){return e.map(e=>{let t="a=rid:".concat(e.id).concat(o).concat(e.direction);return e.payloads&&(t+="".concat(o,"pt=").concat(e.payloads.join(","))),e.params.length>0&&(t+="".concat(o).concat(e.params.map(e=>"depend"===e.type?"depend=".concat(e.rids.join(",")):"".concat(e.type,"=").concat(e.val)).join(";"))),t+this.eol}).join("")}printSimulcast(e){return void 0===e?"":"a=simulcast:".concat(e).concat(this.eol)}printSCTPPort(e){return void 0===e?"":"a=sctp-port:".concat(e).concat(this.eol)}printMaxMessageSize(e){return void 0===e?"":"a=max-message-size:".concat(e).concat(this.eol)}printMid(e){return void 0===e?"":"a=mid:".concat(e).concat(this.eol)}printSSRCGroups(e){return e.map(e=>"a=ssrc-group:".concat(e.semantic).concat(e.ssrcIds.map(e=>"".concat(o).concat(e.toString(10))).join("")).concat(this.eol)).join("")}}function P(e){return(new S).parse(e)}function k(e,t){return(new A).print(e,t)}}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8)})();function DP(e){return kP.parse(e)}function xP(e,t){return kP.print(e,t)}var LP=er("Array","keys"),MP=gr,UP=et,FP=u,jP=LP,VP=Array.prototype,BP={DOMTokenList:!0,NodeList:!0},WP=function(e){var t=e.keys;return e===VP||FP(VP,e)&&t===VP.keys||UP(BP,MP(e))?jP:t},HP=r(WP);function GP(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function KP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zP(Object(n),!0).forEach(function(t){GP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function YP(e,t){return YP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},YP(e,t)}function qP(){qP=function(e,t){return new n(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function n(e,r,i){var o=RegExp(e,r);return t.set(o,i||t.get(e)),YP(o,n.prototype)}function r(e,n){var r,i=t.get(n);return ii(r=Object.keys(i)).call(r,function(t,n){var r=i[n];if("number"==typeof r)t[n]=e[r];else{for(var o=0;void 0===e[r[o]]&&o+1<r.length;)o++;t[n]=e[r[o]]}return t},Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YP(e,t)}(n,RegExp),n.prototype.exec=function(t){var n=e.exec.call(this,t);if(n){n.groups=r(n,this);var i=n.indices;i&&(i.groups=r(i,this))}return n},n.prototype[Symbol.replace]=function(n,i){if("string"==typeof i){var o=t.get(this);return e[Symbol.replace].call(this,n,i.replace(/\$<([^>]+)(>|$)/g,function(e,t,n){if(""===n)return e;var r=o[t];return Array.isArray(r)?"$"+r.join("$"):"number"==typeof r?"$"+r:""}))}if("function"==typeof i){var a=this;return e[Symbol.replace].call(this,n,function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(r(e,a)),i.apply(this,e)})}return e[Symbol.replace].call(this,n,i)},qP.apply(this,arguments)}const XP=new class extends ON{constructor(){super(...arguments),GP(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class JP{constructor(e){GP(this,"logger",void 0),GP(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(...this.prefixLists,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.info(...this.prefixLists,...t)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.warning(...this.prefixLists,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(...this.prefixLists,...t)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}}function ZP(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function QP(){const e=new Date,t=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return t?(null==t?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const $P={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},ek=Date.now(),tk=e=>{for(const t in $P)if(Object.prototype.hasOwnProperty.call($P,t)&&$P[t]===e)return t;return"DEFAULT"},nk=new class{constructor(){GP(this,"proxyServerURL",void 0),GP(this,"logLevel",$P.DEBUG),GP(this,"uploadState","collecting"),GP(this,"uploadLogWaitingList",[]),GP(this,"uploadLogUploadingList",[]),GP(this,"uploadErrorCount",0),GP(this,"currentLogID",0),GP(this,"url",void 0),GP(this,"extLog",(e,t)=>{this.appendLogToWaitingList(e,...t)})}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[$P.DEBUG].concat(t);this.log.apply(this,r)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[$P.INFO].concat(t);this.log.apply(this,r)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[$P.WARNING].concat(t);this.log.apply(this,r)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[$P.ERROR].concat(t);this.log.apply(this,r)}upload(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[$P.DEBUG].concat(t);this.uploadLog.apply(this,r)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){yP("UPLOAD_LOG",!0)}disableLogUpload(){yP("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new JP(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-ek<100)return void setTimeout(()=>{this.log(...t)},Date.now()-ek);const r=Math.max(0,Math.min(4,t[0]));if(t[0]=ZP()+" Agora-SDK [".concat(tk(r),"]:"),this.appendLogToWaitingList(r,...t),r<this.logLevel)return;const i=ZP()+" %cAgora-SDK [".concat(tk(r),"]:");let o=[];if(!SP("USE_NEW_LOG"))switch(r){case $P.DEBUG:o=[i,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,o);break;case $P.INFO:o=[i,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,o);break;case $P.WARNING:o=[i,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,o);break;case $P.ERROR:o=[i,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,o)}}uploadLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-ek<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-ek);const r=Math.max(0,Math.min(4,t[0]));t[0]=ZP()+" Agora-SDK [".concat(tk(r),"]:"),this.appendLogToWaitingList(r,...t)}appendLogToWaitingList(e){if(!SP("UPLOAD_LOG"))return;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Array.isArray(n[0])?n[0][0]=QP()+" Agora-SDK [".concat(tk(e),"]:"):n[0]=QP()+" Agora-SDK [".concat(tk(e),"]:");let i="";n.forEach(e=>{"object"==typeof e&&(e=JSON.stringify(e)),i+="".concat(e," ")}),this.uploadLogWaitingList.push({payload_str:i,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:hP,process_id:SP("PROCESS_ID"),payload:JSON.stringify(e)};return MO(async()=>{const e=await EI.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(SP("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(SP("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if("OK"!==e.data){const t=new Error("unexpected upload log response");throw t.response=e,t}},()=>(this.uploadLogUploadingList=[],!1),t=>{const n={status:-1,message:t.message,errorRange:e.map(e=>e.log_item_id)};return t.response?(n.status=t.response.status,n.data=t.response.data,n.headers=t.response.headers):t.request&&(n.status=t.request.status),XP.reportLogUploadError(n),!0},{timeout:SP("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:SP("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,SP("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),SP("UPLOAD_LOG_INTERVAL"))}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),SP("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),SP("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var rk;function ik(e){return vN(e.reportId,"params.reportId",0,100,!1),vN(e.category,"params.category",0,100,!1),vN(e.event,"params.event",0,100,!1),vN(e.label,"params.label",0,100,!1),gN(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(rk={}).FREE="free",rk.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const ok={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let ak=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.RTE_DETAIL="rte_detail_stats",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.XLA_PEER_FIRST_VIDEO_FRAME="xla_peer_first_video_frame",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e.AB_TEST="ab_test",e}({}),sk=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.RTE_DETAIL="io.agora.pb.Wrtc.RteDetailStats",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.XLA_PEER_FIRST_VIDEO_FRAME="io.agora.pb.Wrtc.XLAPeerFirstVideoFrame",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e.AB_TEST="io.agora.pb.Wrtc.ABTest",e}({});!function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}({});let ck=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});function lk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,r){const i=r.value;if("function"==typeof i){const o=e.className||t.__className__||("AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name);r.value=function(){for(var t,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];let c=a;if(e.argsMap)try{c=e.argsMap(this,...a)}catch(e){nk.warning(e),c=[]}try{JSON.stringify(c)}catch(e){nk.warning("arguments for method ".concat(o,".").concat(String(n)," not serializable for apiInvoke.")),c=[]}const l=(e.report||dk).reportApiInvoke(this._sessionId||null,{id:this._clientId||(null===(t=this.store)||void 0===t?void 0:t.clientId)||this._ID,name:"".concat(o,".").concat(String(n)),options:c,tag:xN.TRACER,reportResult:e.reportResult},e.throttleTime);try{const t=i.apply(this,a);return t instanceof ip?t.then(t=>(l.onSuccess(e.reportResult&&t),t)).catch(e=>{throw l.onError(e),e}):(l.onSuccess(e.reportResult&&t),t)}catch(e){throw l.onError(e),e}}}return r}}const dk=new class{constructor(){GP(this,"baseInfoMap",new Map),GP(this,"proxyServer",void 0),GP(this,"eventUploadTimer",void 0),GP(this,"setSessionIdTimer",void 0),GP(this,"url",void 0),GP(this,"sids",new Set),GP(this,"backupUrl",void 0),GP(this,"_appId",void 0),GP(this,"_aid",0),GP(this,"keyEventUploadPendingItems",[]),GP(this,"normalEventUploadPendingItems",[]),GP(this,"apiInvokeUploadPendingItems",[]),GP(this,"apiInvokeCount",0),GP(this,"apiInvokeLoggedCount",0),GP(this,"ltsList",[]),GP(this,"lastSendNormalEventTime",Date.now()),GP(this,"customReportCounterTimer",void 0),GP(this,"customReportCount",0),GP(this,"extApiInvoke",async e=>{for(const t of e){const e=KP(KP({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:xN.TRACER});this.sendApiInvoke(e)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),SP("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),SP("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}setAppId(e){this._appId=e,this._aid=parseInt(e.replace(/[a-fA-F0-9]{8}/g,e=>{let[t,n]=e;return t+n}),16)||0}reportApiInvoke(e,t,n){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const r=Date.now();this.apiInvokeCount+=1;const i=this.apiInvokeCount,o=!!SP("SHOW_REPORT_INVOKER_LOG"),a=!!SP("SHOW_REPORT_USER_INVOKER_LOG"),s=o||a&&t.id;s&&(this.apiInvokeLoggedCount+=1);const c=this.apiInvokeLoggedCount;function l(e,n){if(s){let r="[apiInvoke-".concat(c,"]");if(t.id&&(r+="[".concat(t.id,"]")),t.name&&(r+="[".concat(t.name,"]"),t.name===DN.JOIN))return nk.info("".concat(r," ").concat(e));nk.info("".concat(r," ").concat(e),"start"===e?t.options:n||"")}}const d=()=>({tag:t.tag,invokeId:i,sid:e,name:t.name,apiInvokeTime:r,options:t.options,states:t.states||null});l("start");let u=!1;_O(t.timeout).then(()=>{u||(this.sendApiInvoke(KP(KP({},d()),{},{error:hN.API_INVOKE_TIMEOUT,success:!1})),l("timeout"))});const h=new pN(hN.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const r=()=>{if(u)throw h;return u=!0,this.sendApiInvoke(KP(KP({},d()),{},{success:!0},t.reportResult&&{result:e})),l("onSuccess"),e};return n?SO(r,t.name+"Success",n,()=>u=!0):r()},onError:e=>{const r=()=>{if(u)throw e;u=!0,this.sendApiInvoke(KP(KP({},d()),{},{success:!1,error:e})),l("onFailure",e.toString())};return n?SO(r,t.name+"Error",n,()=>u=!0):r()}}}_send(e,t,n){this.send({type:e,data:t},n)}_sendApiInvoke(e){return this.sendApiInvoke(e)}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const n=Date.now(),r=this.createBaseInfo(e,n);r.cname=t.cname,r.rteUrl=t.rteUrl;const i=Object.assign({},{willUploadConsoleLog:SP("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:pP?"global":"oversea",areas:SP("AREAS")&&SP("AREAS").join(",")},t.extend),{stringUid:o,channelProfile:a,channelMode:s,isABTestSuccess:c,lsid:l,clientRole:d}=t,u=Date.now(),h=KP(KP({},r),{},{eventType:ak.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,buildFormat:t.buildFormat,build:vP,lts:u,elapse:u-n,extend:JSON.stringify(i),mode:t.mode,process:SP("PROCESS_ID"),appType:SP("APP_TYPE"),success:!0,version:hP,stringUid:o,channelProfile:a,channelMode:s,isABTestSuccess:c,lsid:l,clientType:xr(p=window.navigator.userAgent).call(p,"AgoraWebView")?42:20,clientRole:d,serviceId:SP("PROCESS_ID"),extensionID:SP("PLUGIN_INFO").join(",")||"",rteUrl:t.rteUrl,rteSid:t.rteSid});var p;this.send({type:sk.SESSION,data:h},!0)}reportRteDetail(e){const t=this.baseInfoMap.get(e);if(!t)return;const n=t.info,r=Date.now(),i=KP(KP({},n),{},{eventType:ak.RTE_DETAIL,lts:r,success:!0,elapse:r-t.startTime,vid:void 0===n.vid?0:Number(n.vid),ua:navigator.userAgent});this.send({type:sk.RTE_DETAIL,data:i},!0)}joinChooseServer(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info;t.vid&&(r.vid=t.vid);const i=Date.now(),o=KP(KP({},r),{},{role:t.role,eventType:ak.JOIN_CHOOSE_SERVER,lts:i,eventElapse:t.elapse||i-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:i-n.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3,corssRegionTagReq:t.corssRegionTagReq||void 0,corssRegionTagRes:t.corssRegionTagRes||void 0,ua:navigator.userAgent,resourceTimingInfo:t.resourceTimingInfo||void 0});this.send({type:sk.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP({},r),{},{eventType:ak.REQ_USER_ACCOUNT,lts:i,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:t.elapse||i-n.startTime,eventElapse:i-t.lts,extend:JSON.stringify(t.extend)});this.send({type:sk.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info;t.vid&&(r.vid=t.vid),r.uid=t.uid,r.cid=t.cid;const i=Date.now(),{firstSuccess:o,addr:a,isProxy:s}=t,c=i-n.startTime,l=KP(KP({},r),{},{eventType:ak.JOIN_GATEWAY,lts:i,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,errorMsg:t.errorMsg||"",elapse:c,eventElapse:i-t.lts,firstSuccess:o,signalChannel:t.signalChannel,preload:t.preload?1:0,installId:uP(),isABTestSuccess:t.isABTestSuccess?1:0,gatewayIp:null,gatewayPort:null,isProxy:s?1:0}),d=l.success?1:0;if(t.succ&&(n.lastJoinSuccessTime=i),a)if("1"===l.signalChannel){const e=qP(/(\d+\.\d+\.\d+\.\d+):(\d+)/,{ip:1,port:2}),t=a.match(e);l.gatewayIp=t&&t.groups?t.groups.ip:"",l.gatewayPort=t&&t.groups?t.groups.port:""}else if(s){const e=a.match(/h=(\d{1,3}-){3}\d{1,3}/g),t=a.match(/p=[0-9]{1,6}/g);l.gatewayIp=e&&e.length?e[0].split("=")[1].replace(/-/g,"."):"",l.gatewayPort=t&&t.length?t[0].split("=")[1]:""}else{const e=a.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),t=a.match(/(:|p=)[0-9]{1,6}/g);l.gatewayIp=e&&e.length?e[0].split("//")[1].replace(/-/g,"."):"",l.gatewayPort=t&&t.length?t[0].split(/:|p=/g)[1]:""}if(o)this.send({type:sk.JOIN_GATEWAY,data:l},!0);else{let e={isSuccess:d,port:l.gatewayPort};delete l.success,delete l.eventType,delete l.firstSuccess,delete l.gatewayPort,l.vid=Number(l.vid);const t=Object.assign({},l,e,{eventType:ak.REJOIN_GATEWAY});this.send({type:sk.RE_JOIN_GATEWAY,data:t},!0)}}joinChannelTimeout(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=Date.now(),i=KP(KP({},n.info),{},{lts:r,timeout:t,elapse:r-n.startTime});this.send({type:sk.JOIN_CHANNEL_TIMEOUT,data:i},!0)}publish(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP({},r),{},{eventType:ak.PUBLISH,lts:i,eventElapse:t.eventElapse,elapse:i-n.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:sk.PUBLISH,data:o},!0)}subscribe(e,t,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,o=Date.now(),a=KP(KP({},i),{},{eventType:ak.SUBSCRIBE,lts:o,eventElapse:t.eventElapse,elapse:o-r.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid,preSsrc:t.preSsrc?1:0},n&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof t.peerid?a.peerSuid=t.peerid:a.peer=t.peerid,this.send({type:sk.SUBSCRIBE,data:a},!0)}wsCompressorInit(e){var t;const n=[...HP(t=this.baseInfoMap).call(t)],r=n.length?n[0]:"UnableToGetSid",i=this.baseInfoMap.get(r);if(!i)return;const o=i.info,a=Date.now(),s=KP(KP({},o),{},{eventType:ak.WS_COMPRESSOR_INIT,lts:a,eventElapse:e.eventElapse,elapse:a-i.startTime,status:e.status?1:2});this.send({type:sk.WS_COMPRESSOR_INIT,data:s},!0)}firstXLAPeerFirstVideoFrame(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=t.peerPubStatusMs-(n.lastJoinSuccessTime||i),a=KP(KP({},r),{},{elapse:i-n.startTime,eventType:ak.XLA_PEER_FIRST_VIDEO_FRAME,lts:i,peer:t.peer,width:t.width,height:t.height,ssrc:t.ssrc,p2pid:t.p2pid,peerPublishDuration:t.peerPublishDuration,joinChannelSuccessElapse:o,peerPubStatusMs:t.peerPubStatusMs-t.joinChannelStart,availablePublish:t.peerPublishDuration>o?1:0,preloadStart:Math.max(t.preloadStart-t.joinChannelStart,0),preloadEnd:Math.max(t.preloadEnd-t.joinChannelStart,0),encrypt:Math.max(t.apStart-t.joinChannelStart,0),ap:Math.max(t.apEnd-t.joinChannelStart,0),sua:Math.max(t.suaEnd-t.joinChannelStart,0),beforeConnect:Math.max(t.beforeConnect-t.joinChannelStart,0),peerRecevier:Math.max(t.peerReceiver-t.joinChannelStart,0),ice:Math.max(t.ice-t.joinChannelStart,0),pc:Math.max(t.pc-t.joinChannelStart,0),signalConnected:Math.max(t.signalConnected-t.joinChannelStart,0),joinReq:Math.max(t.joinReq-t.joinChannelStart,0),joinRes:Math.max(t.joinRes-t.joinChannelStart,0),userJoinNotify:Math.max(t.userJoinNotify-t.joinChannelStart,0),videoSsrcNotify:Math.max(t.videoAddNotify-t.joinChannelStart,0),subscribeDelayMs:Math.max(t.subscribeStart-t.videoAddNotify,0),subscribeStart:Math.max(t.subscribeStart-t.joinChannelStart,0),subscribeEnd:Math.max(t.subscribeEnd-t.joinChannelStart,0),firstReceived:Math.max(t.firstReceived-t.joinChannelStart,0),firstDecoded:Math.max(t.firstDecoded-t.joinChannelStart,0),firstPreRender:Math.max(t.firstPreRender-t.joinChannelStart,0),firstRender:Math.max(t.firstRender-t.joinChannelStart,0),playDelayMs:Math.max(t.playStart-t.subscribeEnd,0),playStart:Math.max(t.playStart-t.joinChannelStart,0),playEnd:Math.max(t.playEnd-t.joinChannelStart,0),isPreSub:t.isPreSub?1:0,isPrePc:t.isPrePc?1:0,isPreInstantVideo:t.isPreInstantVideo?1:0,firstReceivedEncodedFrame:t.firstReceivedEncodedFrame?Math.max(t.firstReceivedEncodedFrame-t.joinChannelStart,0):void 0,frameType:t.frameType||"",rtpTimestamp:t.rtpTimestamp||0,framePayloadType:t.framePayloadType||0,frameDataLength:t.frameDataLength||0,mimeType:t.mimeType||""});this.send({type:sk.XLA_PEER_FIRST_VIDEO_FRAME,data:a},!0)}firstRemoteVideoDecode(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,a=Date.now(),s=KP(KP(KP({},o),r),{},{elapse:a-i.startTime,eventType:t,lts:a,firstDecodeFrame:Math.max((r.firstFrame||a)-i.startTime,0),apEnd:Math.max(r.apEnd-i.startTime,0),apStart:Math.max(r.apStart-i.startTime,0),joinGwEnd:Math.max(r.joinGwEnd-i.startTime,0),joinGwStart:Math.max(r.joinGwStart-i.startTime,0),pcEnd:Math.max(r.pcEnd-i.startTime,0),pcStart:Math.max(r.pcStart-i.startTime,0),subscriberEnd:Math.max(r.subscriberEnd-i.startTime,0),subscriberStart:Math.max(r.subscriberStart-i.startTime,0),videoAddNotify:Math.max(r.videoAddNotify-i.startTime,0)});this.send({type:n,data:s},!0)}firstRemoteFrame(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,a=Date.now(),s=KP(KP(KP({},o),r),{},{elapse:a-i.startTime,eventType:t,lts:a});this.send({type:n,data:s},!0)}abTest(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP(KP({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),elapse:i-n.startTime,eventType:ak.AB_TEST,lts:i});this.send({type:sk.AB_TEST,data:o},!0)}pcStats(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP(KP({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),elapse:i-n.startTime,eventType:ak.PC_STATS,lts:i,preallocation:t.preallocation?1:0});this.send({type:sk.PC_STATS,data:o},!0)}updateRemoteRTPCapabilities(e,t){if(e){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP(KP({},r),t),{},{vid:void 0===r.vid?0:Number(r.vid),eventType:ak.UPDATE_REMOTE_RTPCAPABILITIES,lts:i});this.send({type:sk.UPDATE_REMOTE_RTPCAPABILITIES,data:o},!0)}}onGatewayStream(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,a=Date.now(),s=KP(KP(KP({},o),r),{},{eventType:t,lts:a});this.send({type:n,data:s},!0)}streamSwitch(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP({},r),{},{eventType:ak.STREAM_SWITCH,lts:i,isDual:t.isdual,elapse:i-n.startTime,success:t.succ});this.send({type:sk.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP({},r),{},{eventType:ak.REQUEST_PROXY_APPCENTER,lts:i,eventElapse:i-t.lts,elapse:i-n.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:sk.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP({},r),{},{eventType:ak.REQUEST_PROXY_WORKER_MANAGER,lts:i,eventElapse:i-t.lts,elapse:i-n.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:sk.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,e?nk.debug("reportProxyServerurl: ".concat(e)):nk.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP({},r),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:i,elapse:i-n.startTime,joinChannelSuccessElapse:i-(n.lastJoinSuccessTime||i),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:sk.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now();(function(e,t,n){const r=e[t];if(!r||"string"!=typeof r)return[e];e[t]="";const i=mO(JSON.stringify(e));let o=0;const a=[];let s=0;for(let c=0;c<r.length;c++)s+=r.charCodeAt(c)<=127?1:3,s<=n-i||(a[a.length]=uN(uN({},e),{},{[t]:r.substring(o,c)}),o=c,s=r.charCodeAt(c)<=127?1:3);return o!==r.length-1&&(a[a.length]=uN(uN({},e),{},{[t]:r.substring(o)})),a})(KP(KP(KP({},r),t),{},{elapse:i-n.startTime,lts:i,productType:"WebRTC"}),"payload",1300).forEach(e=>this.send({type:sk.WORKER_EVENT,data:e},!0))}apworkerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP(KP({},r),t),{},{elapse:i-n.startTime,lts:i});this.send({type:sk.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP(KP({},r),t),{},{elapse:i-n.startTime,lts:i,extend:t.extend||void 0});this.send({type:sk.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=KP(KP(KP({},r),t),{},{elapse:i-n.startTime,lts:i});this.send({type:sk.WEBSOCKET_QUIT,data:o},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>SP("CUSTOM_REPORT_LIMIT"))throw new pN(hN.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const n=Date.now(),r=t.map(t=>({type:sk.USER_ANALYTICS,data:KP(KP({sid:e},t),{},{lts:n})}));try{SP("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(r):await this.postDataToStatsCollector(r)}catch(e){throw nk.error("send custom report message failed",e.toString()),new pN(hN.CUSTOM_REPORT_SEND_FAILED,e.message)}}sendApiInvoke(e){const t=SP("NOT_REPORT_EVENT");if(e.tag&&xr(t)&&xr(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const n=this.baseInfoMap.get(e.sid);if(!n)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:r,uid:i,cid:o}=n.info;let a;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof pN){const{code:t,message:n}=e.error;a=t||n||e.error.toString()}else a=e.error.toString();const s={invokeId:e.invokeId,sid:e.sid,cname:r,cid:o,uid:i,lts:e.lts,success:e.success,elapse:e.lts-n.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?a:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:sk.API_INVOKE,data:s},!1),!0}addSid(e){this.sids.add(e)}removeSid(e){this.sids.delete(e)}appendSessionId(){const e=this.apiInvokeUploadPendingItems;if(0===e.length)return;const t=Array.from(this.sids).find(e=>null!==e);t&&e.forEach(e=>{e&&(e.sid=t,this.sendApiInvoke(Object.assign({},e)))}),e.length=0}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>SP("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const n=[],r=[];for(;e.length;){const t=e.shift();n.length<20?n.push(t):r.push(t)}e.push(...r);for(const o of[...n]){var i;-1!==this.ltsList.indexOf(o.data.lts)?(o.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(o.data.lts)):(this.ltsList.push(o.data.lts),Zp(i=this.ltsList).call(i,(e,t)=>e-t))}return t||(this.lastSendNormalEventTime=Date.now()),SP("ENABLE_EVENT_REPORT")?(n.length&&(SP("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((e=>n=>{SP("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(e):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(e),this.normalEventUploadPendingItems.length>SP("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-SP("NORMAL_EVENT_QUEUE_CAPACITY")),nk.warning("report: drop normal events"))))})(n)),e):e}async postDataToStatsCollector2(e){ZN.networkState===zN.OFFLINE&&await ip.race([ZN.onlineWaiter,_O(2*xO.maxRetryTimeout)]);const t=e=>{let t=new Uint8Array;return e.forEach(e=>{const n=AN(JSON.stringify(e.data)),r=new ArrayBuffer(5),i=(e=>{let t=0;return Object.entries(sk).forEach(n=>{let[r,i]=n;i===e.type&&(t=ck[r])}),t})(e),o=new DataView(r);o.setUint16(0,n.byteLength,!0),o.setUint8(2,255&i),o.setUint8(3,i>>>8&255),o.setUint8(4,i>>>16&255),t=IN(t,new Uint8Array(r)),t=IN(t,n)}),t},n="event";let r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(SP("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(n):"https://".concat(SP("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(n);for(let i=0;i<2;i+=1){1===i&&(r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(SP("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(n):"https://".concat(SP("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(n));try{await BO(r,{timeout:1e4,data:t(e),headers:KP(KP({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(e){if(1===i)throw e;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(e[0]),r=n?void 0:this._aid,i={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map(e=>JSON.stringify(e)),vid:n,aid:r};ZN.networkState===zN.OFFLINE&&await ip.race([ZN.onlineWaiter,_O(2*xO.maxRetryTimeout)]);const o=t?"/events/proto-raws":"/events/messages";let a=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(SP("EVENT_REPORT_DOMAIN"),"&p=").concat(SP("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(SP("EVENT_REPORT_DOMAIN"),":").concat(SP("STATS_COLLECTOR_PORT")).concat(o));for(let s=0;s<2;s+=1){1===s&&(a=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(SP("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(SP("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(SP("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(SP("STATS_COLLECTOR_PORT")).concat(o)));try{t?await WO(a,{timeout:1e4,data:i}):await BO(a,{timeout:1e4,data:i})}catch(t){if(1===s)throw t;continue}return}}createBaseInfo(e,t){const n=Object.assign({},ok);return n.sid=e,this.baseInfoMap.set(e,{info:n,startTime:t}),n}reportResourceTiming(e,t){const n=performance.getEntriesByName(e),r=n[n.length-1];r&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:r,tag:xN.TRACER}).onSuccess()}};XP.on("REPORT_LOG_UPLOAD",e=>{e.networkState=ZN.networkState,dk.reportApiInvoke(null,{name:"logUploadError",options:e,tag:xN.TRACER}).onSuccess("logUploadError")});let uk=class extends pN{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2?arguments[2]:void 0),GP(this,"name","AgoraRTCException")}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return super.print(e,nk)}throw(){super.throw(nk)}};const hk={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1,supportSuppressLocalAudioPlayback:!1,supportRestrictOwnAudio:!1};function pk(){return hk}function mk(){return"setSinkId"in HTMLAudioElement.prototype&&(!SP("RESTRICTION_SET_PLAYBACK_DEVICE")||(MI()||jI())&&!oN())}function fk(){return!hk.supportUnifiedPlan||SP("CHROME_FORCE_PLAN_B")&&aN()}function gk(e){return!(VI()||HI(87)||fk()||!SP("ENABLE_PRE_SUB")&&(null==e||!e.autoSubscribe||SP("FORCE_DISABLE_AUTO_SUB")))}function _k(e){return SP("ENABLE_INSTANT_VIDEO")?SP("ENABLE_INSTANT_VIDEO"):!(null==e||!e.autoSubscribe||SP("FORCE_DISABLE_AUTO_SUB"))}function vk(){return navigator.mediaDevices&&"getSupportedConstraints"in navigator.mediaDevices}function bk(){if(vk()){const e=navigator.mediaDevices.getSupportedConstraints();return!(!("suppressLocalAudioPlayback"in e)||!e.suppressLocalAudioPlayback)}return WI(141)||zI(141)||ZI(141)}function Ek(){if(vk()){const e=navigator.mediaDevices.getSupportedConstraints();return!(!("restrictOwnAudio"in e)||!e.restrictOwnAudio)}return WI(141)||zI(141)||ZI(125)}let yk=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function Sk(e,t,n){return{sampleRate:e,stereo:t,bitrate:n}}function Tk(e,t,n,r,i){return{width:e,height:t,frameRate:n,bitrateMin:r,bitrateMax:i}}function Ck(e,t,n,r,i){return{width:{max:e},height:{max:t},frameRate:n,bitrateMin:r,bitrateMax:i}}function wk(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}const Rk={"90p":Tk(160,90),"90p_1":Tk(160,90),"120p":Tk(160,120,15,30,65),"120p_1":Tk(160,120,15,30,65),"120p_3":Tk(120,120,15,30,50),"120p_4":Tk(212,120),"180p":Tk(320,180,15,30,140),"180p_1":Tk(320,180,15,30,140),"180p_3":Tk(180,180,15,30,100),"180p_4":Tk(240,180,15,30,120),"240p":Tk(320,240,15,40,200),"240p_1":Tk(320,240,15,40,200),"240p_3":Tk(240,240,15,40,140),"240p_4":Tk(424,240,15,40,220),"360p":Tk(640,360,15,80,400),"360p_1":Tk(640,360,15,80,400),"360p_3":Tk(360,360,15,80,260),"360p_4":Tk(640,360,30,80,600),"360p_6":Tk(360,360,30,80,400),"360p_7":Tk(480,360,15,80,320),"360p_8":Tk(480,360,30,80,490),"360p_9":Tk(640,360,15,80,800),"360p_10":Tk(640,360,24,80,800),"360p_11":Tk(640,360,24,80,1e3),"480p":Tk(640,480,15,100,500),"480p_1":Tk(640,480,15,100,500),"480p_2":Tk(640,480,30,100,1e3),"480p_3":Tk(480,480,15,100,400),"480p_4":Tk(640,480,30,100,750),"480p_6":Tk(480,480,30,100,600),"480p_8":Tk(848,480,15,100,610),"480p_9":Tk(848,480,30,100,930),"480p_10":Tk(640,480,10,100,400),"720p":Tk(1280,720,15,120,1130),"720p_auto":Tk(1280,720,30,900,3e3),"720p_1":Tk(1280,720,15,120,1130),"720p_2":Tk(1280,720,30,120,2e3),"720p_3":Tk(1280,720,30,120,1710),"720p_5":Tk(960,720,15,120,910),"720p_6":Tk(960,720,30,120,1380),"1080p":Tk(1920,1080,15,120,2080),"1080p_1":Tk(1920,1080,15,120,2080),"1080p_2":Tk(1920,1080,30,120,3e3),"1080p_3":Tk(1920,1080,30,120,3150),"1080p_5":Tk(1920,1080,60,120,4780),"1440p":Tk(2560,1440,30,120,4850),"1440p_1":Tk(2560,1440,30,120,4850),"1440p_2":Tk(2560,1440,60,120,7350),"4k":Tk(3840,2160,30,120,8910),"4k_1":Tk(3840,2160,30,120,8910),"4k_3":Tk(3840,2160,60,120,13500)},Ak={"480p":Ck(640,480,5),"480p_1":Ck(640,480,5),"480p_2":Ck(640,480,30),"480p_3":Ck(640,480,15),"720p":Ck(1280,720,5),"720p_auto":Tk(1280,720,30,900,3e3),"720p_1":Ck(1280,720,5),"720p_2":Ck(1280,720,30),"720p_3":Ck(1280,720,15),"1080p":Ck(1920,1080,5),"1080p_1":Ck(1920,1080,5),"1080p_2":Ck(1920,1080,30),"1080p_3":Ck(1920,1080,15)},Ik={"1SL1TL":wk(1,1),"3SL3TL":wk(3,3),"2SL3TL":wk(2,3)};function Nk(e){return e||(e="480p_1"),"string"==typeof e?Object.assign({},Rk[e]):e}function Ok(e){return"string"==typeof e?Object.assign({},Ak[e]):e}function Pk(e){return"string"==typeof e?Object.assign({},Ik[e]):e}const kk={speech_low_quality:Sk(16e3,!1),speech_standard:Sk(32e3,!1,18),music_standard:Sk(48e3,!1),standard_stereo:Sk(48e3,!0,56),high_quality:Sk(48e3,!1,128),high_quality_stereo:Sk(48e3,!0,192)};function Dk(e){return"string"==typeof e?Object.assign({},kk[e]):e}const xk=[];function Lk(e){return fN(e,"mediaSource",["screen","window","application"]),!0}let Mk=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),Uk=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e.SCREEN_LOW_TRACK="screen_low_track",e}({}),Fk=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),jk=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",e}({}),Vk=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e[e.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",e}({}),Bk=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),Wk=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),Hk=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e.PLAY_START="play-start",e.PLAY_END="play-end",e.FIRST_FRAME_RENDER="first-frame-render",e}({}),Gk=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),zk=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});const Kk={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},Yk={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},qk={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Xk={uplinkNetworkQuality:0,downlinkNetworkQuality:0},Jk={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let Zk=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),Qk=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),$k=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),eD=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),tD=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),nD=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const rD={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let iD=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function oD(e,t,n,r,i){var o,a,s={};return Object.keys(r).forEach(function(e){s[e]=r[e]}),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=ii(o=_i(a=n.slice()).call(a)).call(o,function(n,r){return r(e,t,n)||n},s),i&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(i):void 0,s.initializer=void 0),void 0===s.initializer?(Object.defineProperty(e,t,s),null):s}function aD(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function cD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sD(Object(n),!0).forEach(function(t){aD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class lD extends ON{set _mediaStreamTrack(e){e!==this.mediaStreamTrack&&(this.safeEmit(Bk.TRACK_UPDATED,e),this.mediaStreamTrack=e)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(e,t){super(),aD(this,"trackMediaType",void 0),aD(this,"_ID",void 0),aD(this,"_rtpTransceiver",void 0),aD(this,"_lowRtpTransceiver",void 0),aD(this,"_hints",[]),aD(this,"_isClosed",!1),aD(this,"_originMediaStreamTrack",void 0),aD(this,"mediaStreamTrack",void 0),aD(this,"_external",{}),this._ID=t||vO(8,"track-"),this._originMediaStreamTrack=e,this.mediaStreamTrack=e,function(e){xr(xk).call(xk,e)||xk.push(e)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){return e||lO(()=>{var e;dk.reportApiInvoke(null,{name:DN.GET_MEDIA_STREAM_TRACK,options:[],tag:xN.TRACER}).onSuccess((null===(e=this._mediaStreamTrack)||void 0===e?void 0:e.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(e){return e===Fk.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(e){const t=xk.indexOf(e);-1!==t&&xk.splice(t,1)}(this),this.emit(Wk.CLOSED),this.removeAllListeners(Bk.SEI_RECEIVED)}_updateRtpTransceiver(e,t){if(t===Fk.LOW_STREAM){if(this._lowRtpTransceiver===e)return;this._lowRtpTransceiver=e}else{if(this._rtpTransceiver===e)return;this._rtpTransceiver=e}this.emit(Bk.TRANSCEIVER_UPDATED,e,t)}}class dD extends lD{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(e,t){super(e,t),aD(this,"_enabled",!0),aD(this,"_muted",!1),aD(this,"_isExternalTrack",!1),aD(this,"_isClosed",!1),aD(this,"_enabledMutex",void 0),aD(this,"processor",void 0),aD(this,"_processorContext",void 0),aD(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new kO("".concat(this.getTrackId())),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var e,t;return null!==(e=null===(t=this._originMediaStreamTrack)||void 0===t?void 0:t.label)&&void 0!==e?e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,nk.debug("[".concat(this.getTrackId(),"] close")),this.emit(Mk.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isExternalTrack=n,e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qN(this,Mk.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){nk.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Wk.TRACK_ENDED)}stateCheck(e,t){if(nk.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(t,"]")),mN(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new pN(hN.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",nk);if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new pN(hN.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",nk)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():ip.resolve([])}}const uD=window.AudioContext||window.webkitAudioContext;let hD,pD=null;const mD=new class extends ON{constructor(){super(...arguments),aD(this,"prevState",void 0),aD(this,"curState",void 0),aD(this,"currentTime",void 0),aD(this,"currentTimeStuckAt",void 0),aD(this,"interruptDetectorTrack",void 0),aD(this,"onLocalAudioTrackMute",()=>{nk.info("ios15-interruption-start"),this.emit(yk.IOS_15_16_INTERRUPTION_START)}),aD(this,"onLocalAudioTrackUnmute",async()=>{nk.info("ios15-interruption-end"),"running"!==this.curState||this.duringInterruption?nk.info("ios15-interruption-end-canceled"):(pD&&await pD.suspend(),this.emit(yk.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){nk.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){nk.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function fD(){if(!pD){if(function(){if(!uD)return void nk.error("your browser is not support web audio");nk.info("create audio context");const e=cD({},SP("WEBAUDIO_INIT_OPTIONS"));nk.debug("audio context init option:",JSON.stringify(e)),pD=new uD(e),mD.curState=pD.state,pD.onstatechange=()=>{mD.prevState=mD.curState,mD.curState=pD?pD.state:void 0;const{prevState:e,curState:t}=mD,n="running"===t,r="interrupted"===t,i="running"===e,o="suspended"===e,a="interrupted"===e,s=PI().osVersion;(BI()||nN())&&i&&r&&(nk.info("ios".concat(s,"-interruption-start")),mD.emit(yk.IOS_INTERRUPTION_START)),(BI()||nN())&&(o||a)&&n&&(nk.info("ios".concat(s,"-interruption-end")),mD.emit(yk.IOS_INTERRUPTION_END)),e!==t&&mD.emit(yk.STATE_CHANGE,t,e)},setInterval(()=>{var e;const t=null===(e=pD)||void 0===e?void 0:e.currentTime;mD.currentTime!==t?(mD.currentTimeStuckAt&&(nk.debug("AudioContext current time resume at ".concat(t)),mD.currentTimeStuckAt=void 0),mD.currentTime=t):(t!==mD.currentTimeStuckAt&&(dk.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:t},tag:xN.TRACER}).onSuccess(),nk.warning("AudioContext current time stuck at ".concat(t))),mD.currentTimeStuckAt=t)},5e3),async function(e){const t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let n,r,i=!1,o=!1,a=!1;function s(t){"running"===e.state?c(!1):BI()||nN()?"suspended"===e.state&&(c(!0),t&&e.resume().then(l,l)):"closed"!==e.state&&(c(!0),t&&e.resume().then(l,l))}function c(e){if(i!==e){i=e;for(let n=0,r=t;n<r.length;n+=1){const t=r[n];e?window.addEventListener(t,d,{capture:!0,passive:!0}):window.removeEventListener(t,d,{capture:!0,passive:!0})}}}function l(){s(!1)}function d(){s(!0)}function u(){let e;try{e=n.play(),e?e.then(m,m):(n.addEventListener("playing",m),n.addEventListener("abort",m),n.addEventListener("error",m))}catch(e){m()}}function h(e){a||(n.paused?e?(p(!1),a=!0,u()):p(!0):p(!1))}function p(e){if(o!==e){o=e;for(let n=0,r=t;n<r.length;n++){const t=r[n];e?window.addEventListener(t,f,{capture:!0,passive:!0}):window.removeEventListener(t,f,{capture:!0,passive:!0})}}}function m(){n.removeEventListener("playing",m),n.removeEventListener("abort",m),n.removeEventListener("error",m),a=!1,h(!1)}function f(){h(!0)}if(BI()&&SP("IOS_BG_TAG")){const t=e.createMediaStreamDestination(),i=document.createElement("div");i.innerHTML="<audio x-webkit-airplay='deny'></audio>",n=i.children.item(0),n.controls=!1,n.disableRemotePlayback=!0,n.preload="auto",n.srcObject=t.stream,r=()=>{if(SP("IOS_AUTO_RESTART_BG_TAG")&&n&&n.srcObject&&!a&&(!n.paused||!0!==o)){n.paused||n.pause();try{a=!0,u()}catch(e){a=!1}return!0}},h(!0)}return mD.on(yk.STATE_CHANGE,function(){s(!0)}),s(!1),r}(pD).then(e=>{hD=e})}(),!pD)throw new pN(hN.NOT_SUPPORTED,"can not create audio context");return pD}return pD}function gD(e){if(function(){if(null!==_D)return _D;const e=fD(),t=e.createBufferSource(),n=e.createGain(),r=e.createGain();t.connect(n),t.connect(r),t.disconnect(n);let i=!1;try{t.disconnect(n)}catch(e){i=!0}return t.disconnect(),_D=i,i}())return;const t=e.connect,n=e.disconnect;e.connect=(n,r,i)=>{var o;return e._inputNodes||(e._inputNodes=[]),xr(o=e._inputNodes).call(o,n)||(n instanceof AudioNode?(e._inputNodes.push(n),t.call(e,n,r,i)):t.call(e,n,r)),e},e.disconnect=(r,i,o)=>{n.call(e),r?rO(e._inputNodes,r):e._inputNodes=[];for(const n of e._inputNodes)t.call(e,n)}}let _D=null;function vD(e,t){let n=!1;const r=1/t;if(SP("DISABLE_WEBAUDIO")){const t=window.setInterval(()=>{n?window.clearInterval(t):e(performance.now()/1e3)},1e3*r)}else{const t=fD();let i=t.createGain();i.gain.value=0,i.connect(t.destination);const o=()=>{if(n)return void(i=null);const a=t.createOscillator();a.onended=o,a.connect(i),a.start(0),a.stop(t.currentTime+r),e(t.currentTime)};o()}return()=>{n=!0}}class bD{constructor(){aD(this,"context",void 0),aD(this,"analyserNode",void 0),aD(this,"sourceNode",void 0),this.context=fD(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch(e){}this.sourceNode=e,null==e||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode)return 0;if(!this.context||BI()||nN()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{const t=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(t);for(let n=0;n<e.length;++n)e[n]=t[n]/128-1}const t=ii(e).call(e,(e,t)=>e+t*t,0)/e.length;return Math.max(10*Math.log10(t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,t;null===(e=this.sourceNode)||void 0===e||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(t=this.sourceNode)||void 0===t||t.connect(this.analyserNode)}catch(e){nk.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class ED extends ON{get processSourceNode(){return this.sourceNode}set processedNode(e){var t;if(!this.isDestroyed&&this._processedNode!==e){try{var n;null===(n=this.sourceNode)||void 0===n||n.disconnect(this.outputNode)}catch(e){}null===(t=this._processedNode)||void 0===t||t.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),aD(this,"outputNode",void 0),aD(this,"outputTrack",void 0),aD(this,"isPlayed",!1),aD(this,"sourceNode",void 0),aD(this,"context",void 0),aD(this,"audioBufferNode",void 0),aD(this,"destNode",void 0),aD(this,"audioOutputLevel",0),aD(this,"volumeLevelAnalyser",void 0),aD(this,"_processedNode",void 0),aD(this,"playNode",void 0),aD(this,"isDestroyed",!1),aD(this,"onNoAudioInput",void 0),aD(this,"isNoAudioInput",!1),aD(this,"_noAudioInputCount",0),this.context=fD(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),gD(this.outputNode),this.volumeLevelAnalyser=new bD}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{this.emit(zk.ON_AUDIO_BUFFER,function(e){for(let t=0;t<e.outputBuffer.numberOfChannels;t+=1){const n=e.outputBuffer.getChannelData(t);for(let e=0;e<n.length;e+=1)n[e]=0}return e.inputBuffer}(e))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!pk().webAudioMediaStreamDest)throw new pN(hN.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){"running"!==this.context.state&&oO(()=>{mD.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;BI()||nN()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume();const t=this.volumeLevelAnalyser.getAnalyserNode();let n;t.getFloatTimeDomainData?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n)):(n=new Uint8Array(t.fftSize),t.getByteTimeDomainData(n));let r=!1;for(let i=0;i<n.length;i++)0!==n[i]&&(r=!0);return r?(this.isNoAudioInput=!1,!0):(await _O(200),await this.checkHasAudioInput(e?e+1:1)&&r)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var e,t;null===(e=this.processedNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?null===(e=this.processedNode)||void 0===e||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class yD extends ED{get isFreeze(){return!1}constructor(e,t,n){var r;if(super(),aD(this,"sourceNode",void 0),aD(this,"track",void 0),aD(this,"clonedTrack",void 0),aD(this,"audioElement",void 0),aD(this,"isCurrentTrackCloned",!1),aD(this,"isRemoteTrack",!1),aD(this,"originVolumeLevelAnalyser",void 0),aD(this,"rebuildWebAudio",async()=>{if(nk.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void nk.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>nk.info("resume success")),nk.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const e=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?e.stop():this.isCurrentTrackCloned=!0;const t=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(t),gD(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const n=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(n,this.context.currentTime),gD(this.outputNode),this.emit(zk.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=t,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),"audio"!==e.kind)throw new pN(hN.UNEXPECTED_ERROR);this.track=e;const i=new MediaStream([this.track]);if(this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(i),gD(this.sourceNode),n){const e=n.clone();e.enabled=!0,this.clonedTrack=e,nk.debug("create an unmuted track ".concat(e.id," from the original track ").concat(n.id," to get the volume"));const t=this.context.createMediaStreamSource(new MediaStream([e]));gD(t),this.originVolumeLevelAnalyser=new bD,this.originVolumeLevelAnalyser.updateSource(t)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=i;const o=PI();t&&o.os===RI.IOS&&Number(null===(r=o.osVersion)||void 0===r?void 0:r.split(".")[0])<15&&(mD.on(yk.STATE_CHANGE,()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(e=>{e||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),gD(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(zk.UPDATE_SOURCE),this.audioElement.srcObject=t}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),mD.off("state-change",this.rebuildWebAudio),null===(e=this.originVolumeLevelAnalyser)||void 0===e||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){const t=e.clone();t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=t),nk.debug("create an unmuted track ".concat(t.id," from the original track ").concat(e.id," to get the volume"));const n=this.context.createMediaStreamSource(new MediaStream([t]));gD(n),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(n)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function SD(e,t,n){const r=(e,t)=>e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t,i={audio:!!n&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:r(t.height,1080),maxWidth:r(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(i.video.mandatory.maxFrameRate=t.frameRate.max,i.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(i.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(i)}async function TD(e,t){const n=await CD(e.mediaSource),{sourceId:r,audio:i}=await function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new ip((n,r)=>{const i=document.createElement("div");i.innerText="share screen",i.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const o=document.createElement("div");o.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const a=document.createElement("div");a.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",a.setAttribute("style","height: 12%;");const s=document.createElement("div");s.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const c=document.createElement("div");c.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const l=document.createElement("button");l.innerHTML="cancel",l.setAttribute("style","width: 85px;"),l.onclick=()=>{document.body.removeChild(h);const e=new Error("NotAllowedError");e.name="NotAllowedError",r(e)};let d=t;const u=document.createElement("div");if(t){const e=document.createElement("input");e.setAttribute("type","checkbox");const t=document.createElement("span");e.setAttribute("style","margin-right: 6px;"),t.innerText="Share audio",e.checked=d,e.onchange=()=>{d=e.checked},u.appendChild(e),u.appendChild(t)}c.appendChild(u),c.appendChild(l),o.appendChild(a),o.appendChild(s),o.appendChild(c);const h=document.createElement("div");h.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),h.appendChild(i),h.appendChild(o),document.body.appendChild(h),e.map(e=>{if(e.id){const t=document.createElement("div");t.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let r=e.thumbnail;try{const{width:e}=r.getSize();e>1920&&(r=r.resize({width:1920}))}catch(e){throw e&&e.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),e}t.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+r.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,function(e){return"&#"+e.charCodeAt(0)+";"})+"</span>",t.onclick=()=>{document.body.removeChild(h),n({sourceId:e.id,audio:d})},s.appendChild(t)}})})}(n,t);return await SD(r,e,i)}async function CD(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const n=kN();if(!n)throw console.error("failed to fetch electron, please mount it to window"),new pN(hN.ELECTRON_IS_NULL);let r=null;try{var i;r=(null===(i=n.desktopCapturer)||void 0===i?void 0:i.getSources({types:t}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch(e){r=null}r&&r.then||(r=new ip((e,r)=>{n.desktopCapturer.getSources({types:t},(t,n)=>{t?r(t):e(n)})}));try{return await r}catch(e){throw new pN(hN.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.toString())}}const wD=new kO("safari");let RD=!1,AD=!1;async function ID(e,t){let n=0,r=null;for(;n<2;)try{r=await ND(e,t,n>0);break}catch(e){if(e instanceof pN)throw nk.error("[".concat(t,"] ").concat(e.toString())),e;const r=OD(e.name||e.code||e,e.message);if(r.code===hN.MEDIA_OPTION_INVALID){nk.debug("[".concat(t,"] detect media option invalid, retry")),n+=1,await _O(500);continue}throw nk.error("[".concat(t,"] ").concat(r.toString())),r}if(!r)throw new pN(hN.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return r}async function ND(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new pN(hN.NOT_SUPPORTED,"can not find getUserMedia");n&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const r=pk(),i=new MediaStream;if(e.audioSource&&i.addTrack(e.audioSource),e.videoSource&&i.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return nk.debug("Using Video Source/ Audio Source"),i;if(e.screen)if(kN())e.screen.sourceId?PD(i,await SD(e.screen.sourceId,e.screen,!!e.screenAudio)):PD(i,await TD(e.screen,!!e.screenAudio));else if(MI()&&e.screen.extensionId&&e.screen.mandatory){if(!r.getStreamFromExtension)throw new pN(hN.NOT_SUPPORTED,"This browser does not support screen sharing");nk.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const n=await(a=e.screen.extensionId,s=t,new ip((e,t)=>{try{chrome.runtime.sendMessage(a,{getStream:!0},n=>{if(!n||!n.streamId)return nk.error("[".concat(s,"] No response from Chrome Plugin. Plugin not installed properly"),n),void t(new pN(hN.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(n.streamId)})}catch(e){nk.error("[".concat(s,"] AgoraRTC screensharing plugin is not accessible(").concat(a,")"),e.toString()),t(new pN(hN.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=n,PD(i,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(r.getDisplayMedia){var o;e.screen.mediaSource&&Lk(e.screen.mediaSource);const n={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:null!==(o=e.screen.displaySurface)&&void 0!==o?o:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource},{selfBrowserSurface:r,surfaceSwitching:a,systemAudio:s,preferCurrentTab:c,windowAudio:l,monitorTypeSurfaces:d}=e.screen,u={selfBrowserSurface:r,surfaceSwitching:a,systemAudio:s,preferCurrentTab:c,windowAudio:l,monitorTypeSurfaces:d};!r&&delete u.selfBrowserSurface,!a&&delete u.surfaceSwitching,!s&&delete u.systemAudio,!c&&delete u.preferCurrentTab,!l&&delete u.windowAudio,!d&&delete u.monitorTypeSurfaces,nk.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:n,audio:e.screenAudio,controls:u})),PD(i,await navigator.mediaDevices.getDisplayMedia(cD({video:n,audio:e.screenAudio},u)))}else{if(!VI())throw nk.error("[".concat(t,"] This browser does not support screenSharing")),new pN(hN.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&Lk(e.screen.mediaSource);const n={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};nk.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(n))),PD(i,await navigator.mediaDevices.getUserMedia(n))}}var a,s;if(!e.video&&!e.audio)return i;let c={video:e.video,audio:e.audio},l=SP("MEDIA_DEVICE_CONSTRAINTS");if(l)try{"string"==typeof l&&(l=JSON.parse(l)),c=CO(c,l)}catch(e){}nk.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(c)),PI();let d,u=null;(UI()||BI()||LI())&&(u=await wD.lock());try{d=await navigator.mediaDevices.getUserMedia(c)}catch(e){throw u&&u(),e}return c.audio&&(RD=!0),c.video&&(AD=!0),PD(i,d),u&&u(),i}function OD(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new pN(hN.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new pN(hN.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new pN(hN.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new pN(hN.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new pN(hN.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new pN(hN.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return nk.error("getUserMedia unexpected error",e),new pN(hN.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function PD(e,t){const n=e.getVideoTracks()[0],r=e.getAudioTracks()[0],i=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(r&&e.removeTrack(r),e.addTrack(o)),i&&(n&&e.removeTrack(n),e.addTrack(i))}const kD=new class extends ON{get state(){return this._state}set state(e){e!==this._state&&(this.emit(eD.STATE_CHANGE,e),this._state=e)}constructor(){super(),aD(this,"_state",$k.IDLE),aD(this,"isAccessMicrophonePermission",!1),aD(this,"isAccessCameraPermission",!1),aD(this,"lastAccessMicrophonePermission",!1),aD(this,"lastAccessCameraPermission",!1),aD(this,"checkdeviceMatched",!1),aD(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(SP("ENUMERATE_DEVICES_INTERVAL")||(sN()||DI()===RI.HARMONY_OS)&&aN())&&this.updateDevicesInfo()},SP("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>nk.error(e.toString()))}async enumerateDevices(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw new pN(hN.NOT_SUPPORTED,"enumerateDevices() not supported.");const r=await navigator.mediaDevices.enumerateDevices(),i=this.checkMediaDeviceInfoIsOk(r);let o=!this.isAccessMicrophonePermission&&e,a=!this.isAccessCameraPermission&&t;i.audio&&(o=!1),i.video&&(a=!1);let s=null,c=null,l=null;if(!n&&(o||a)){if(wD.isLocked&&(nk.debug("[device manager] wait GUM lock"),(await wD.lock())(),nk.debug("[device manager] GUM unlock")),RD&&(o=!1,this.isAccessMicrophonePermission=!0),AD&&(a=!1,this.isAccessCameraPermission=!0),nk.debug("[device manager] check media device permissions",e,t,o,a),o&&a){try{l=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(e){const t=OD(e.name||e.code||e,e.message);if(t.code===hN.PERMISSION_DENIED)throw t;nk.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(o){try{s=await navigator.mediaDevices.getUserMedia({audio:e})}catch(e){const t=OD(e.name||e.code||e,e.message);if(t.code===hN.PERMISSION_DENIED)throw t;nk.warning("getUserMedia failed in getDevices",t)}this.isAccessMicrophonePermission=!0}else if(a){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(e){const t=OD(e.name||e.code||e,e.message);if(t.code===hN.PERMISSION_DENIED)throw t;nk.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0}nk.debug("[device manager] mic permission",e,"cam permission",t)}try{const e=await navigator.mediaDevices.enumerateDevices();return s&&s.getTracks().forEach(e=>e.stop()),c&&c.getTracks().forEach(e=>e.stop()),l&&l.getTracks().forEach(e=>e.stop()),s=null,c=null,l=null,e}catch(e){return s&&s.getTracks().forEach(e=>e.stop()),c&&c.getTracks().forEach(e=>e.stop()),l&&l.getTracks().forEach(e=>e.stop()),s=null,c=null,l=null,new pN(hN.ENUMERATE_DEVICES_FAILED,e.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(e=>"audioinput"===e.kind)}async getCamerasDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(e=>"videoinput"===e.kind)}async getSpeakers(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(e=>"audiooutput"===e.kind)}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach(n=>{n.device.label===e&&(t=n.device.deviceId)}),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find(t=>t.deviceId===e);if(!t)throw new pN(hN.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=$k.INITING;try{await this.updateDevicesInfo(),this.state=$k.INITEND}catch(e){if(this.state=$k.IDLE,!("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname))throw new pN(hN.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.");throw nk.warning("Device Detection functionality cannot start properly.",e.toString()),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),n=[];if(e[0]&&e[0].label&&!1===this.checkdeviceMatched){this.checkdeviceMatched=!0;const t=e.find(e=>"audioinput"===e.kind&&"default"===e.deviceId),n=e.find(e=>"audiooutput"===e.kind&&"default"===e.deviceId);t&&n?n.groupId===t.groupId?nk.debug("[device-check] default input ".concat(t.label," and output ").concat(n.label," is the same group")):nk.debug("[device-check] default input ".concat(t.label," and output ").concat(n.label," is not the same group")):nk.debug("[device-check] default input or output not found")}const r=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(e=>{if(!e.deviceId)return;const r=this.deviceInfoMap.get("".concat(e.kind,"_").concat(e.deviceId));if("ACTIVE"!==(r?r.state:"INACTIVE")){const r={initAt:t,updateAt:t,device:e,state:"ACTIVE"};this.deviceInfoMap.set("".concat(e.kind,"_").concat(e.deviceId),r),n.push(r)}r&&(r.updateAt=t)}),this.deviceInfoMap.forEach((e,r)=>{"ACTIVE"===e.state&&e.updateAt!==t&&(e.state="INACTIVE",n.push(e))}),this.state!==$k.INITEND)return r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));n.forEach(e=>{switch(e.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(eD.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(eD.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(eD.PLAYOUT_DEVICE_CHANGED,e)}}),r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter(e=>"audioinput"===e.kind),n=e.filter(e=>"videoinput"===e.kind),r={audio:!1,video:!1};for(const i of t)if(i.label&&i.deviceId){r.audio=!0;break}for(const i of n)if(i.label&&i.deviceId){r.video=!0;break}return r}};let DD=!1;const xD=new class extends ON{constructor(){super(...arguments),aD(this,"onAutoplayFailed",void 0),aD(this,"onAudioAutoplayFailed",void 0)}};function LD(){if(DD)return SP("FLS_AUTOPLAY_EMITS")?(xD.onAutoplayFailed&&xD.onAutoplayFailed(),xD.emit("autoplay-failed")):void 0;{const e=t=>{t.preventDefault(),DD=!1,cN()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};DD=!0,cN()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),nk.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),xD.onAutoplayFailed?xD.onAutoplayFailed():xD.onAudioAutoplayFailed?nk.warning("AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."):nk.warning("We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),xD.emit("autoplay-failed")}}function MD(e,t,n,r){if(!e)return;const i=dk.getBaseInfoBySessionId(e);if(!i)return;const o=i.info,a=Date.now(),s=cD(cD({},o),{},{vid:void 0===o.vid?0:Number(o.vid),lts:a,elapse:a-i.startTime,cbRegistered:xD.onAutoplayFailed||xD.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:t,trackId:r,extend:void 0});dk.send({type:sk.AUTOPLAY_FAILED,data:s},!0)}const UD=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],FD=new class{constructor(){aD(this,"onAutoplayFailed",void 0),aD(this,"elementMap",new Map),aD(this,"elementStateMap",new Map),aD(this,"elementsNeedToResume",[]),aD(this,"sinkIdMap",new Map),aD(this,"autoResumeAfterInterruption",e=>ip.all(Array.from(this.elementMap.entries()).map(async t=>{let[n,r]=t;const i=this.elementStateMap.get(n),o=r.srcObject.getAudioTracks()[0],a=o&&o.readyState;if(nk.debug("resume after interrupted, ele: ".concat(i," audio: ").concat(a," ").concat(e)),"live"===a){if(e)return r.pause(),r.play();if("running"===mD.curState)return $I()?(r.pause(),r.play()):i&&"paused"===i?r.play():void 0}}))),aD(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[t,n]=e;const r=n.srcObject.getAudioTracks()[0];r&&"live"===r.readyState&&(nk.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())})}),this.autoResumeAudioElement(),mD.on(yk.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),mD.on(yk.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),mD.on(yk.STATE_CHANGE,()=>{BI()&&"suspended"===mD.prevState&&"running"===mD.curState&&this.autoResumeAfterInterruption()})}async setSinkID(e,t){const n=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),n)try{await n.setSinkId(t)}catch(e){throw new pN(hN.PERMISSION_DENIED,"can not set sink id: "+e.toString())}}play(e,t,n,r){if(this.elementMap.has(t))return;const i=document.createElement("audio");i.autoplay=!0,i.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,i),this.elementMap.set(t,i),this.elementStateMap.set(t,tD.INIT),this.setVolume(t,n);const o=this.sinkIdMap.get(t);if(o)try{i.setSinkId(o).catch(e=>{nk.warning("[".concat(t,"] set sink id failed"),e.toString())})}catch(e){nk.warning("[".concat(t,"] set sink id failed"),e.toString())}const a=i.play();a&&a.then&&a.catch(e=>{r&&MD(r,"audio",e.message,t),nk.warning("audio element play warning",e.toString()),this.elementMap.has(t)&&"NotAllowedError"===e.name&&(nk.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(i),oO(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),LD()}))})}updateTrack(e,t){const n=this.elementMap.get(e);n&&(n.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&"playing"===this.elementStateMap.get(e)}setVolume(e,t){const n=this.elementMap.get(e);n&&(t=Math.max(0,Math.min(100,t)),n.volume=t/100)}getVolume(e){const t=this.elementMap.get(e);return t?t.volume:0}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const n=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(n,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){UD.forEach(n=>{t.addEventListener(n,n=>{const r=this.elementStateMap.get(e),i="pause"===n.type?"paused":n.type;if(nk.debug("[".concat(e,"] audio-element-status change ").concat(r," => ").concat(i)),"error"===n.type){const n=null==t?void 0:t.error;n&&nk.error("[".concat(e,"] media error, code: ").concat(n.code,", message: ").concat(n.message))}this.elementStateMap.set(e,i)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(e=>{e.play().then(e=>{nk.debug("Auto resume audio element success")}).catch(e=>{nk.warning("Auto resume audio element failed!",e)})}),this.elementsNeedToResume=[]};new ip(e=>{document.body?e():window.addEventListener("load",()=>e())}).then(()=>{cN()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))})}};function jD(){return function(e,t,n){const r=n.value;return"function"==typeof r&&(n.value=function(){this._isClosed&&new pN(hN.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",nk);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=r.apply(this,t);return i instanceof ip?new ip((e,t)=>{i.then(e).catch(t)}):i}),n}}class VD extends ON{constructor(e){super(),aD(this,"name","VideoProcessorDestination"),aD(this,"ID","0"),aD(this,"_source",void 0),aD(this,"videoContext",void 0),aD(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new pN(hN.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new pN(hN.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");e.track&&e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=e.track,this.emit(Zk.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(Zk.ON_TRACK,void 0)}}class BD extends ON{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t){super(),aD(this,"constraintsMap",new Map),aD(this,"statsRegistry",[]),aD(this,"usageRegistry",[]),aD(this,"trackId",void 0),aD(this,"direction",void 0),aD(this,"_chained",!1),this.trackId=e,this.direction=t}async getConstraints(){return await YN(this,Qk.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,t){var n;return nk.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),qN(this,Qk.REQUEST_UPDATE_CONSTRAINTS,Array.from(pp(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return nk.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),qN(this,Qk.REQUEST_UPDATE_CONSTRAINTS,Array.from(pp(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t)||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t);-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:i}of this.statsRegistry)try{const o=i();e.push({processorID:t,processorName:n,type:r,stats:o})}catch(e){nk.error(new pN(hN.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find(t=>t.processorID===e.ID&&t.processorName===e.name)||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex(t=>t.processorID===e.ID&&t.processorName===e.name);-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let n=t();n instanceof ip&&(n=await n),e.push(cD(cD({},n),{},{direction:this.direction}))}catch(e){nk.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class WD extends ON{constructor(e){super(),aD(this,"name","AudioProcessorDestination"),aD(this,"ID","0"),aD(this,"inputTrack",void 0),aD(this,"inputNode",void 0),aD(this,"audioProcessorContext",void 0),aD(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new pN(hN.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new pN(hN.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(Zk.ON_TRACK,void 0),this.emit(Zk.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");e.track&&this.inputTrack!==e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=e.track,this.emit(Zk.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=e.node,this.emit(Zk.ON_NODE,this.inputNode))}}class HD extends ON{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t,n){super(),aD(this,"constraintsMap",new Map),aD(this,"statsRegistry",[]),aD(this,"audioContext",void 0),aD(this,"trackId",void 0),aD(this,"direction",void 0),aD(this,"usageRegistry",[]),aD(this,"_chained",!1),this.audioContext=e,this.trackId=t,this.direction=n}async getConstraints(){return YN(this,Qk.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,t){var n;return nk.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),qN(this,Qk.REQUEST_UPDATE_CONSTRAINTS,Array.from(pp(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),qN(this,Qk.REQUEST_UPDATE_CONSTRAINTS,Array.from(pp(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t)||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex(n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t);-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:i}of this.statsRegistry)try{const o=i();e.push({processorID:t,processorName:n,type:r,stats:o})}catch(e){nk.error(new pN(hN.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find(t=>t.processorID===e.ID&&t.processorName===e.name)||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex(t=>t.processorID===e.ID&&t.processorName===e.name);-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let n=t();n instanceof ip&&(n=await n),e.push(cD(cD({},n),{},{direction:this.direction}))}catch(e){nk.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class GD extends ON{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),aD(this,"context",void 0),aD(this,"processSourceNode",void 0),aD(this,"outputTrack",void 0),aD(this,"processedNode",void 0),aD(this,"clonedTrack",void 0),aD(this,"outputNode",void 0),this.outputNode=new zD}setVolume(){}createOutputTrack(){throw new pN(hN.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class zD{disconnect(){}connect(){}}function KD(e){return new ip((t,n)=>{let r=!1;const i=document.createElement("video");i.setAttribute("autoplay",""),i.setAttribute("muted",""),i.muted=!0,i.autoplay=!0,i.setAttribute("playsinline",""),i.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(i);const o=BI()?"canplay":"playing";i.addEventListener(o,()=>{const e=i.videoWidth,n=i.videoHeight;!e&&VI()||(r=!0,i.srcObject=null,i.remove(),t([e,n]))}),i.srcObject=new MediaStream([e]),i.play().catch(EO),setTimeout(()=>{r||(i.srcObject=null,i.remove(),t([i.videoWidth,i.videoHeight]))},4e3)})}function YD(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const n=Nk(e.encoderConfig);return null!=n.width&&(t.width=n.width),null!=n.height&&(t.height=n.height),!iN()&&n.frameRate&&(t.frameRate=n.frameRate),jI()&&"object"==typeof t.frameRate&&(t.frameRate.max=60),VI()&&(t.frameRate={ideal:30,max:30}),t}function qD(e){const t={};return iN()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,MI()&&e.ANS&&(t.googHighpassFilter=e.ANS))),t}function XD(e){const t=qD(e);if(e.encoderConfig){const n=Dk(e.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),sN()&&(t.sampleRate=void 0),t}const JD=e=>{const t=e._encoderConfig;if(!t)return;const{frameRate:n,width:r,height:i}=e.getMediaStreamTrackSettings();let{frameRate:o=n,width:a=r,height:s=i}=t;if(!o||!a||!s)return;a=RO(a),s=RO(s),o=RO(o);const{max:c,min:l}=function(e,t,n){const r=200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75);return{min:Math.floor(r),max:Math.floor(4*r)}}(a,s,o),{bitrateMax:d,bitrateMin:u}=t||{};d||nk.debug("calculate bitrate: [w: ".concat(a,", h: ").concat(s,", fps: ").concat(o,"] => [brMax: ").concat(d,", brMin: ").concat(u,"]"));const{maxFramerate:h}=SP("ENCODER_CONFIG_LIMIT");return h&&"number"==typeof h&&(o=Math.min(o,h)),{frameRate:o,bitrateMax:d||c,bitrateMin:u||l,scaleResolutionDownBy:1,scale:0}},ZD=async(e,t,n)=>await(async(e,t,n)=>{const r=function(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(parseInt(e.slice(n,n+2),16));return Uint8Array.from(t)}(NO(""+t+n)).slice(0,16),i=r.slice(0,12),o=await window.crypto.subtle.importKey("raw",r,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},o,e))})(e.buffer,t,n),QD=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new ip((n,r)=>{t.toBlob(async e=>{if(t.remove(),e){const r=await $D(e);n({buffer:r,width:t.width,height:t.height})}else r(new pN(hN.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,1)})},$D=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)};var ex,tx,nx,rx,ix,ox,ax,sx,cx,lx,dx,ux,hx,px,mx,fx,gx,_x,vx,bx,Ex,yx,Sx,Tx,Cx,wx,Rx,Ax,Ix,Nx,Ox,Px,kx,Dx,xx,Lx,Mx,Ux,Fx,jx;let Vx=(ex=lk({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),tx=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),nx=jD(),rx=DO("LocalAudioTrack","_enabledMutex"),ix=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),ox=jD(),ax=DO("LocalAudioTrack","_enabledMutex"),sx=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),cx=jD(),lx=jD(),dx=jD(),ux=lk({argsMap:e=>[e.getTrackId()]}),hx=jD(),px=lk({argsMap:e=>[e.getTrackId()]}),mx=jD(),fx=lk({argsMap:e=>[e.getTrackId()]}),gx=lk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),_x=lk({argsMap:e=>[e.getTrackId()]}),oD((vx=class extends dD{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?FD.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,n,r){super(e,n),aD(this,"trackMediaType",Gk.AUDIO),aD(this,"_encoderConfig",void 0),aD(this,"_trackSource",void 0),aD(this,"metadata",[]),aD(this,"_enabled",!0),aD(this,"_volume",100),aD(this,"_useAudioElement",!0),aD(this,"_bypassWebAudio",!1),aD(this,"processor",void 0),aD(this,"_processorContext",void 0),aD(this,"_processorDestination",void 0),aD(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!r,this._trackSource=new GD,SP("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),SP("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),UI()&&!pD?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){gN(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&FD.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void nk.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,qN(this,Mk.NEED_REPLACE_TRACK,this).then(()=>{nk.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(e=>{nk.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e)}))}catch(e){}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!mk())throw new pN(hN.NOT_SUPPORTED,"your browser does not support setting the audio output device");await FD.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,n){return this._setEnabled(e,t,n)}async _setEnabled(e,t,n){if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(nk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{n||(this._enabled=!0),await qN(this,Mk.NEED_ENABLE_TRACK,this),nk.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(e){throw n||(this._enabled=!1),nk.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}}else{this._originMediaStreamTrack.enabled=!1,n||(this._enabled=!1);try{await qN(this,Mk.NEED_DISABLE_TRACK,this)}catch(e){throw n||(this._enabled=!0),nk.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,nk.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await qN(this,Mk.NEED_MUTE_TRACK,this):await qN(this,Mk.NEED_UNMUTE_TRACK,this))}getStats(){return lO(()=>{nk.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),XN(this,Mk.GET_STATS)||cD({},Kk)}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(zk.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(zk.ON_AUDIO_BUFFER),this._source.on(zk.ON_AUDIO_BUFFER,t=>e(t))}play(){nk.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(nk.debug("[".concat(this.getTrackId(),"] start audio playback in element")),FD.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){nk.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?FD.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];nk.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&FD.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qN(this,Mk.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return ip.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new pN(hN.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new pN(hN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){e.on(Zk.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e),await qN(this,Mk.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qN(this,Mk.NEED_REPLACE_TRACK,this))}),e.on(Zk.ON_NODE,e=>{this._source.processedNode=e})}unbindProcessorDestinationEvents(e){e.removeAllListeners(Zk.ON_TRACK),e.removeAllListeners(Zk.ON_NODE)}bindProcessorContextEvents(e){e.on(Qk.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(e){e.removeAllListeners(Qk.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof GD&&(this._trackSource=new yD(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new HD(this._source.context,this.getTrackId(),"local"),t=new WD(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(zk.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(FD.stop(this.getTrackId()),this._source.play()),qN(this,Mk.NEED_REPLACE_MIXING_TRACK,this).then(()=>{nk.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(e=>{nk.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),e)})),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[ex],Object.getOwnPropertyDescriptor(vx.prototype,"setVolume"),vx.prototype),oD(vx.prototype,"setPlaybackDevice",[tx,nx],Object.getOwnPropertyDescriptor(vx.prototype,"setPlaybackDevice"),vx.prototype),oD(vx.prototype,"setEnabled",[rx,ix,ox],Object.getOwnPropertyDescriptor(vx.prototype,"setEnabled"),vx.prototype),oD(vx.prototype,"setMuted",[ax,sx,cx],Object.getOwnPropertyDescriptor(vx.prototype,"setMuted"),vx.prototype),oD(vx.prototype,"getStats",[lx],Object.getOwnPropertyDescriptor(vx.prototype,"getStats"),vx.prototype),oD(vx.prototype,"setAudioFrameCallback",[dx],Object.getOwnPropertyDescriptor(vx.prototype,"setAudioFrameCallback"),vx.prototype),oD(vx.prototype,"play",[ux,hx],Object.getOwnPropertyDescriptor(vx.prototype,"play"),vx.prototype),oD(vx.prototype,"stop",[px,mx],Object.getOwnPropertyDescriptor(vx.prototype,"stop"),vx.prototype),oD(vx.prototype,"close",[fx],Object.getOwnPropertyDescriptor(vx.prototype,"close"),vx.prototype),oD(vx.prototype,"pipe",[gx],Object.getOwnPropertyDescriptor(vx.prototype,"pipe"),vx.prototype),oD(vx.prototype,"unpipe",[_x],Object.getOwnPropertyDescriptor(vx.prototype,"unpipe"),vx.prototype),vx),Bx=(bx=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),Ex=jD(),yx=DO("MicrophoneAudioTrack","_enabledMutex"),Sx=lk({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),Tx=jD(),Cx=lk({argsMap:e=>[e.getTrackId()]}),oD((wx=class extends Vx{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,n,r){super(e,t.encoderConfig?Dk(t.encoderConfig):{},r,SP("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),aD(this,"_config",void 0),aD(this,"_deviceName","default"),aD(this,"_constraints",void 0),aD(this,"_originalConstraints",void 0),aD(this,"_enabled",!0),this._config=t,this._constraints=n,this._originalConstraints=n,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),($I()||eN())&&mD.bindInterruptDetectorTrack(this)}async setDevice(e){if(nk.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const t=await kD.getDeviceById(e),n={};n.audio=cD({},this._constraints),n.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let r=null;try{r=await ID(n,this.getTrackId())}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),r=await ID({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await kD.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}nk.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,n){if(t)return nk.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(nk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),SP("AUTO_RESET_AUDIO_ROUTE")&&(BI()||nN())){const t=navigator.audioSession;t&&(e||(t.type="playback"),t.type="auto")}if(!e){var r;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),null===(r=this._source.clonedTrack)||void 0===r||r.stop(),n||(this._enabled=!1);try{await qN(this,Mk.NEED_DISABLE_TRACK,this)}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.toString()),e}return}const i=cD({},this._constraints),o=kD.searchDeviceIdByName(this._deviceName);o&&!i.deviceId&&(i.deviceId=o);try{n||(this._enabled=!0);const e=await ID({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await qN(this,Mk.NEED_ENABLE_TRACK,this)}catch(e){throw n||(this._enabled=!1),nk.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.toString()),e}nk.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),($I()||eN())&&mD.unbindInterruptDetectorTrack(this),xk.some(e=>function(e){return"__className__"in e&&"MicrophoneAudioTrack"===e.__className__}(e))||hD&&hD()&&(dk.reportApiInvoke(null,{name:"BG_AUDIO_TAG_RESTART",options:{},tag:xN.TRACER}).onSuccess(),nk.debug("restart background audio tag success"))}onTrackEnded(){if((BI()||nN())&&this._enabled&&!this._isClosed&&mD.duringInterruption){const e=async()=>{mD.off(yk.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(nk.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};mD.on(yk.IOS_INTERRUPTION_END,e)}else nk.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Wk.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=kD.searchDeviceIdByName(this._deviceName);if(n&&!t.deviceId&&(t.deviceId=n),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();const e=await ID({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(Qk.REQUEST_UPDATE_CONSTRAINTS,async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}})}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(Qk.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[bx,Ex],Object.getOwnPropertyDescriptor(wx.prototype,"setDevice"),wx.prototype),oD(wx.prototype,"setEnabled",[yx,Sx,Tx],Object.getOwnPropertyDescriptor(wx.prototype,"setEnabled"),wx.prototype),oD(wx.prototype,"close",[Cx],Object.getOwnPropertyDescriptor(wx.prototype,"close"),wx.prototype),wx),Wx=(Rx=lk({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),Ax=jD(),Ix=lk({argsMap:e=>[e.getTrackId()]}),Nx=jD(),Ox=lk({argsMap:e=>[e.getTrackId()]}),Px=jD(),kx=lk({argsMap:e=>[e.getTrackId()]}),Dx=jD(),xx=lk({argsMap:e=>[e.getTrackId()]}),Lx=jD(),Mx=lk({argsMap:e=>[e.getTrackId()]}),Ux=lk({argsMap:e=>[e.getTrackId()]}),Fx=jD(),oD((jx=class extends Vx{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,n,r){super(t.createOutputTrack(),n,r),aD(this,"source",void 0),aD(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(zk.AUDIO_SOURCE_STATE_CHANGE,e=>{this.safeEmit(Wk.SOURCE_STATE_CHANGE,e)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){gN(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[Rx,Ax],Object.getOwnPropertyDescriptor(jx.prototype,"startProcessAudioBuffer"),jx.prototype),oD(jx.prototype,"pauseProcessAudioBuffer",[Ix,Nx],Object.getOwnPropertyDescriptor(jx.prototype,"pauseProcessAudioBuffer"),jx.prototype),oD(jx.prototype,"seekAudioBuffer",[Ox,Px],Object.getOwnPropertyDescriptor(jx.prototype,"seekAudioBuffer"),jx.prototype),oD(jx.prototype,"resumeProcessAudioBuffer",[kx,Dx],Object.getOwnPropertyDescriptor(jx.prototype,"resumeProcessAudioBuffer"),jx.prototype),oD(jx.prototype,"stopProcessAudioBuffer",[xx,Lx],Object.getOwnPropertyDescriptor(jx.prototype,"stopProcessAudioBuffer"),jx.prototype),oD(jx.prototype,"close",[Mx],Object.getOwnPropertyDescriptor(jx.prototype,"close"),jx.prototype),oD(jx.prototype,"setAudioBufferPlaybackSpeed",[Ux,Fx],Object.getOwnPropertyDescriptor(jx.prototype,"setAudioBufferPlaybackSpeed"),jx.prototype),jx);class Hx extends Vx{get __className__(){return"MixingAudioTrack"}get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=fD().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,vO(8,"track-mix-")),aD(this,"trackList",void 0),aD(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return-1!==this.trackList.indexOf(e)}addAudioTrack(e){-1===this.trackList.indexOf(e)?(nk.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):nk.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){if(-1!==this.trackList.indexOf(e)){nk.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(e){}rO(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach(t=>{t._encoderConfig&&((t._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=t._encoderConfig.bitrate),(t._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=t._encoderConfig.sampleRate),(t._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=t._encoderConfig.sampleSize),t._encoderConfig.stereo&&(e.stereo=!0))}),this._encoderConfig=e}_updateRtpTransceiver(e){this._rtpTransceiver!==e&&(this._rtpTransceiver=e,this.trackList.forEach(t=>{t instanceof Hx?t.emit(Bk.TRANSCEIVER_UPDATED,e):t._updateRtpTransceiver(e)}))}}class Gx extends ED{set currentState(e){e!==this._currentState&&(this._currentState=e,this.safeEmit(zk.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),aD(this,"audioBuffer",void 0),aD(this,"sourceNode",void 0),aD(this,"startPlayTime",0),aD(this,"startPlayOffset",0),aD(this,"pausePlayTime",0),aD(this,"options",void 0),aD(this,"currentLoopCount",0),aD(this,"currentPlaybackSpeed",100),aD(this,"_currentState","stopped"),this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):nk.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(e){this.sourceNode&&("playing"===this.currentState&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=e/100),this.currentPlaybackSpeed=e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e.playbackRate.value=this.currentPlaybackSpeed/100,e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const zx=new Map;function Kx(e,t){if(0===e.length||0===t.length)return 1/0;const n=IO(e),r=IO(t);return Math.floor(r/n)}class Yx{get rendFrameRate(){const e=Math.max(1,Kx(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/e)}get videoElementStatus(){return this._isInPage?this._videoElementStatus:tD.DESTROYED}set videoElementStatus(e){e!==this._videoElementStatus&&(nk.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}get videoState(){return this._videoState}set videoState(e){var t;e!==this._videoState&&(this._videoState=e,null===(t=this.onVideoStateChanged)||void 0===t||t.call(this,this.videoState))}constructor(e){aD(this,"trackId",void 0),aD(this,"config",void 0),aD(this,"onFirstVideoFrameDecoded",void 0),aD(this,"onFirstVideoFrameRender",void 0),aD(this,"onVideoBufferReady",void 0),aD(this,"onVideoStateChanged",void 0),aD(this,"freezeTimeCounterList",[]),aD(this,"renderFreezeAccTime",0),aD(this,"renderFreezeAccTime2",0),aD(this,"isKeepLastFrame",!1),aD(this,"isDestroyed",!1),aD(this,"timeUpdatedCount",0),aD(this,"freezeTime",0),aD(this,"playbackTime",0),aD(this,"lastTimeUpdatedTime",0),aD(this,"autoplayFailed",!1),aD(this,"videoTrack",void 0),aD(this,"videoElement",void 0),aD(this,"cacheVideoElement",void 0),aD(this,"cancelRVFId",void 0),aD(this,"internal",!1),aD(this,"_render_interframe_delays",[]),aD(this,"_render_interframe_delays_sizes",[]),aD(this,"_videoState",nD.VideoStateStopped),aD(this,"videoElementCheckInterval",void 0),aD(this,"videoElementFreezeTimeout",void 0),aD(this,"_videoElementStatus",tD.NONE),aD(this,"_isInPage",!0),aD(this,"isGettingVideoDimensions",!1),aD(this,"startGetVideoDimensions",()=>{const e=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return nk.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(e,500)};!this.isGettingVideoDimensions&&e()}),aD(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===mD.curState&&(nk.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(xI())),tN()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),aD(this,"handleVideoEvents",e=>{switch(e.type){case"play":case"playing":"play"===e.type&&nk.debug("[".concat(this.trackId,"] video element status: play")),this.startGetVideoDimensions(),this.videoElementStatus=tD.PLAYING;break;case"loadeddata":if(this.videoState=nD.VideoStateStarting,this.onFirstVideoFrameRender&&this.onFirstVideoFrameRender(),this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch(e){}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=tD.CANPLAY;break;case"stalled":this.videoElementStatus=tD.STALLED;break;case"suspend":this.videoElementStatus=tD.SUSPEND;break;case"pause":this.videoElementStatus=tD.PAUSED,BI()||nN()||UI()&&this.autoplayFailed||!this.videoTrack||"live"!==this.videoTrack.readyState||(nk.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=tD.WAITING;break;case"abort":this.videoElementStatus=tD.ABORT;break;case"ended":this.videoElementStatus=tD.ENDED;break;case"emptied":this.videoElementStatus=tD.EMPTIED;break;case"error":{const e=this.videoElement.error;e&&(this.videoElementStatus=tD.ERROR,nk.error("[".concat(this.trackId,"] media error: ").concat(e.message," (").concat(e.code,")")));break}case"timeupdate":{const e=performance.now();if(this.timeUpdatedCount+=1,this.onVideoBufferReady&&this.timeUpdatedCount>SP("BUFFER_READY_FRAMES")&&this.onVideoBufferReady(),this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=e);const t=e-this.lastTimeUpdatedTime,n=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=e,eM.lastVisibleTime<eM.lastHiddenTime||n<eM.lastHiddenTime||n<eM.lastVisibleTime)return;if(this.isSkipCalcRenderFreezeTime())return;for(t>SP("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=t),this.playbackTime+=t;this.playbackTime>=6e3;){this.playbackTime-=6e3;const e=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(e),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),aD(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&(nk.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(xI())),tN()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=e.trackId,this.config=e,e.element instanceof HTMLVideoElement?this.videoElement=e.element:this.videoElement=document.createElement("video"),mD.on(yk.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),mD.on(yk.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var e;return null!==(e=this.videoElement.parentElement)&&void 0!==e?e:void 0}updateConfig(e){this.config=e,this.trackId=e.trackId,e.element!==this.videoElement&&(this.destroy(),this.videoElement=e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.initVideoElement())}play(e){const t=this.videoElement.play();t&&t.catch&&t.catch(t=>{e&&MD(e,"video",t.message,this.trackId),"NotAllowedError"===t.name?(nk.warning("detected video element autoplay failed",t),this.autoplayFailed=!0,this.handleAutoPlayFailed()):nk.warning("[".concat(this.trackId,"] play warning: "),t)});const n=PI();if(("Safari"===n.name&&15===Number(n.version)||$I())&&t&&t.then){const e=()=>{this.config.mirror&&!this.config.noStyle&&(this.videoElement.style.transform="rotateY(180deg)")};t.then(e).catch(e)}}getCurrentFrame(){const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");if(!t)return nk.error("create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);const n=t.getImageData(0,0,e.width,e.height);return e.remove(),n}async getCurrentFrameToUint8Array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.createElement("canvas");n.width=this.videoElement.videoWidth,n.height=this.videoElement.videoHeight;const r=n.getContext("2d");return r?(r.drawImage(this.videoElement,0,0,n.width,n.height),new ip((r,i)=>{n.toBlob(async e=>{if(n.remove(),e){const t=await $D(e);r({buffer:t,width:n.width,height:n.height})}else i(new pN(hN.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,t<0?.1:t>1?1:t)})):await QD(e)}destroy(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isDestroyed=!0,mD.off(yk.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),mD.off(yk.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),e?this.videoElement.pause():this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=nD.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=tD.INIT,!this.videoElementCheckInterval&&(qx.forEach(e=>{this.videoElement.addEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{this._isInPage=function(e){return e!==document.body&&document.body.contains(e)}(this.videoElement)},1e3),SP("ENABLE_VIDEO_FRAME_CALLBACK"))){var e,t;let n;const r=()=>{"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",r),this.videoElementFreezeTimeout=window.setTimeout(i,SP("VIDEO_FREEZE_DURATION")))},i=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===nD.VideoStateDecoding&&("visible"===document.visibilityState?this.videoState=nD.VideoStateFrozen:document.addEventListener("visibilitychange",r))},o=(e,t)=>{if(this.videoElementStatus===tD.PLAYING){if(n){const e=t.presentationTime-n.presentationTime,r=t.presentedFrames-n.presentedFrames;this._render_interframe_delays_sizes.push(r),this._render_interframe_delays.push(e);const o=IO(this._render_interframe_delays_sizes),a=o-this._render_interframe_delays_sizes[0];if(o>30&&a>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===nD.VideoStateStarting&&(this.videoState=nD.VideoStateDecoding),this.videoState===nD.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(i,SP("VIDEO_FREEZE_DURATION"))),e<SP("VIDEO_FREEZE_DURATION")&&this.videoState===nD.VideoStateFrozen&&(this.videoState=nD.VideoStateDecoding),e>SP("VIDEO_FREEZE_DURATION")&&eM.lastVisibleTime>=eM.lastHiddenTime&&n.timestamp>eM.lastVisibleTime&&n.timestamp>eM.lastHiddenTime){const t=Math.min(66,Kx(this._render_interframe_delays_sizes,this._render_interframe_delays)),n=Math.max(0,e-(r-1)*t);this.renderFreezeAccTime2+=n>t?n:0,this.renderFreezeAccTime+=e}}n=cD(cD({},t),{},{timestamp:e})}else this.isSkipCalcRenderFreezeTime()&&(n=cD(cD({},t),{},{timestamp:e}));var r,a;SP("ENABLE_VIDEO_FRAME_CALLBACK")&&(this.cancelRVFId=null===(r=(a=this.videoElement).requestVideoFrameCallback)||void 0===r?void 0:r.call(a,o))};this.cancelRVFId=null===(e=(t=this.videoElement).requestVideoFrameCallback)||void 0===e?void 0:e.call(t,o)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),sN()&&!SP("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const n=PI();this.config.noStyle||("Safari"===n.name&&15===Number(n.version)||$I()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover"),this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,VI()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,VI()&&this.videoElement.load());const r=this.videoElement.play();void 0!==r&&r.catch(e=>{nk.debug("[".concat(this.trackId,"] playback interrupted"),e.toString())})}resetVideoElement(){var e,t;qx.forEach(e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.cancelRVFId&&this.videoElement&&(null===(e=(t=this.videoElement).cancelVideoFrameCallback)||void 0===e||e.call(t,this.cancelRVFId),this.cancelRVFId=void 0),this.videoElementStatus=tD.NONE}isSkipCalcRenderFreezeTime(){return this.videoElementStatus===tD.DESTROYED||this.internal}handleAutoPlayFailed(){const e=t=>{t.preventDefault(),this.videoElement.play().then(()=>{nk.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(e=>{nk.error(e)}),this.autoplayFailed=!1,cN()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};cN()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),LD()}}const qx=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class Xx extends Yx{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),aD(this,"container",void 0),aD(this,"slot",void 0),this.slot=e.element,this.internal=t,this.updateConfig(e)}updateConfig(e){this.config=e,this.trackId=e.trackId;const t=e.element;var n;!this.internal||this.slot?(t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()):(this.slot=t,t&&this.container?(this.internal=!1,this.container.id="agora-video-player-".concat(this.trackId),this.videoElement.id="video_".concat(this.trackId),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",null===(n=this.slot)||void 0===n||n.appendChild(this.container)):this.createElements())}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){var t;null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)&&super.play(e)}getCurrentFrame(){var e;return null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(e,n):await QD(e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{var e;this.container.remove(),null===(e=this.slot)||void 0===e||e.removeChild(this.container)}catch(e){}this.container=void 0}}createElements(){var e;this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",SP("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),null===(e=this.slot)||void 0===e||e.appendChild(this.container)}mountedVideoElement(){var e;!this.container||null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var e;if(null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch(e){}this.videoElement=document.createElement("video")}}resetVideoElement(){var e;null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var Jx,Zx,Qx,$x,eL,tL,nL,rL,iL,oL,aL,sL,cL,lL,dL,uL,hL,pL,mL,fL,gL,_L,vL,bL,EL,yL,SL,TL,CL,wL,RL,AL,IL,NL,OL,PL,kL,DL;let xL=(Jx=lk({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),Zx=jD(),Qx=lk({argsMap:e=>[e.getTrackId()]}),$x=DO("LocalVideoTrack","_enabledMutex"),eL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),tL=jD(),nL=DO("LocalVideoTrack","_enabledMutex"),rL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),iL=jD(),oL=lk({argsMap:(e,t)=>[e.getTrackId(),t,e._saveEncodeBitrateRatio]}),aL=jD(),sL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),cL=jD(),lL=jD(),dL=lk({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),uL=jD(),hL=jD(),pL=jD(),mL=lk({argsMap:e=>[e.getTrackId()]}),fL=jD(),gL=jD(),_L=jD(),vL=jD(),bL=jD(),EL=lk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),yL=lk({argsMap:e=>[e.getTrackId()]}),SL=lk({argsMap:e=>[e.getTrackId()]}),TL=lk({argsMap:(e,t,n)=>[e.getTrackId(),t.label,n]}),CL=class e extends dD{get videoHeight(){if(UI()){const{height:e}=this._mediaStreamTrack.getSettings();return this._videoHeight=e,this._videoHeight}return this._videoHeight}get videoWidth(){if(UI()){const{width:e}=this._mediaStreamTrack.getSettings();return this._videoWidth=e,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==tD.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}get __className__(){return"LocalVideoTrack"}constructor(e,t,n,r,i,o){if(super(e,i),aD(this,"trackMediaType",Gk.VIDEO),aD(this,"_player",void 0),aD(this,"isUseScaleResolutionDownBy",!1),aD(this,"_videoVisibleTimer",null),aD(this,"_previousVideoVisibleStatus",void 0),aD(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),aD(this,"_encoderConfig",void 0),aD(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),aD(this,"_optimizationMode",void 0),aD(this,"_saveEncodeBitrateRatio",1),aD(this,"_videoHeight",void 0),aD(this,"_videoWidth",void 0),aD(this,"_forceBitrateLimit",void 0),aD(this,"_enabled",!0),aD(this,"_processorDestination",void 0),aD(this,"_processorContext",void 0),UI()){const{width:t,height:n}=e.getSettings();this._videoWidth=t,this._videoHeight=n}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=n,this._optimizationMode=r,this._hints=o||[],t&&-1!==this._hints.indexOf(Uk.CUSTOM_TRACK)?this._encoderConfig=aO(t):this._encoderConfig=t,-1===this._hints.indexOf(Uk.SCREEN_TRACK))this.updateBitrateFromProfile();else if(GI(AI.CHROME,115)&&-1!==DI().indexOf("Windows")){const t=function(e,t){if("VideoFrame"in window&&"TransformStream"in window&&pk().supportWebRTCInsertableStream){const n=new MediaStreamTrackProcessor(e),r=new MediaStreamTrackGenerator({kind:"video"});let i,o,a=Date.now();const s=()=>{c&&(clearInterval(c),c=void 0),i&&(i.close(),i=void 0),e.stop(),o=void 0,r.removeEventListener("ended",s)};let c=window.setInterval(()=>{if(o&&i&&Date.now()-a>(null!=t?t:1e3))try{"live"===r.readyState?o.enqueue(i.clone()):s()}catch(e){s()}},null!=t?t:1e3);const l=new TransformStream({transform:(e,t)=>{"live"===r.readyState?(o=t,a=Date.now(),void 0===i?(i=e,t.enqueue(e.clone())):(t.enqueue(i),i=e)):e.close()}});return r.addEventListener("ended",s),n.readable.pipeThrough(l).pipeTo(r.writable),r}}(e);t&&(nk.info("local screen video track begin to inject frame"),this._mediaStreamTrack=t)}t&&-1!==this._hints.indexOf(Uk.CUSTOM_TRACK)&&this.setEncoderConfiguration(t),this._processorContext=new BD(this.getTrackId(),"local"),this._processorDestination=new VD(this.processorContext),this.bindProcessorDestinationEvents()}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(nk.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}nk.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=cD(cD(cD({},this._getDefaultPlayerConfig()),t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(e instanceof HTMLVideoElement?this._player=new Yx(n):this._player=new Xx(n),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(Wk.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}},SP("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,nk.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(nk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.enabled=!1;try{await qN(this,Mk.NEED_DISABLE_TRACK,this)}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}return t||(this._enabled=!1),void nk.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await qN(this,Mk.NEED_ENABLE_TRACK,this)}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}nk.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,nk.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await qN(this,Mk.NEED_MUTE_TRACK,this):await qN(this,Mk.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._saveEncodeBitrateRatio;if(1!==this._saveEncodeBitrateRatio&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*e),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*e),nk.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(e)),this._saveEncodeBitrateRatio=1;try{await qN(this,Mk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(nk)}}}async setEncoderConfiguration(e,t){if(!this._enabled)throw new pN(hN.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(e=Nk(e),SP("USE_STANDARD_BITRATE_DEFAULT")&&(delete e.bitrateMax,delete e.bitrateMin),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),e.width||e.height||e.frameRate){const t=YD({encoderConfig:e});(UI()||BI()||nN())&&(t.deviceId=void 0),nk.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(t));try{await this._originMediaStreamTrack.applyConstraints(t),this.updateMediaStreamTrackResolution()}catch(e){const t=new pN(hN.UNEXPECTED_ERROR,e.toString());throw nk.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}}this._encoderConfig=e,-1===this._hints.indexOf(Uk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await qN(this,Mk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(nk)}}getStats(){return lO(()=>{nk.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),XN(this,Mk.GET_STATS)||cD({},Yk)}async setBeautyEffect(e){nk.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(e,t):await QD(e)}async findClosestProfile(){const{width:e,height:t,frameRate:n}=this.getMediaStreamTrackSettings(),{width:r,height:i,frameRate:o}=this._encoderConfig||{},a=RO(this._videoWidth||e||r||0),s=RO(this._videoHeight||t||i||0),c=function(e,t,n){if(!Array.isArray(SP("VIDEO_ENCODER_CONFIG_LIST")))return!1;if(0===SP("VIDEO_ENCODER_CONFIG_LIST").length)return!1;const r=Math.min(e,t);return!(r>=480)&&cD(cD({},SP("VIDEO_ENCODER_CONFIG_LIST").find(e=>e.height>r)),{},{frameRate:n})}(a,s,RO(n||o||15));if(c)return nk.debug("[".concat(this.getTrackId(),"] find closest profile, ").concat(a,"x").concat(s," => ").concat(JSON.stringify(c))),this.setEncoderConfiguration(c)}async setBitrateLimit(e){nk.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(e))),e&&(this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate))}async setOptimizationMode(e){if("motion"!==e&&"detail"!==e&&"balanced"!==e)return void nk.error(hN.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const t=this._optimizationMode;try{this._optimizationMode=e,await qN(this,Mk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(e){throw this._optimizationMode=t,nk.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.toString()),e}nk.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(e,")"))}setScalabiltyMode(e){if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return nk.error(hN.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=e,nk.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(e,")"))}updateMediaStreamTrackResolution(){KD(this._originMediaStreamTrack).then(e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t}).catch(EO)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(e){if(!this._enabled)throw new pN(hN.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");nk.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(e)),e=Nk(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),this._encoderConfig=e,-1===this._hints.indexOf(Uk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await qN(this,Mk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(nk)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:e,height:t,frameRate:n}=this.getMediaStreamTrackSettings();if(!e||!t||!n)return;const{bitrateMax:r,bitrateMin:i}=this._encoderConfig;if(null==i||null==r){const{max:o,min:a}=function(e,t,n,r,i){const o=SP("BITRATE_ADAPTER_TYPE");if("DEFAULT_BITRATE"===o)return{min:r,max:i};if(void 0===i){const a=Math.floor(200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75));i="STANDARD_BITRATE"===o?4*a:2*a,r=null!=r?r:a}else r=null!=r?r:Math.floor(i/10);return{min:r,max:i}}(e,t,n,i,r);if(this._encoderConfig.bitrateMin=a,this._encoderConfig.bitrateMax=o,SP("VIDEO_STANDARD_BITRATE_VERSION")&&null==i&&null==r){const[r,i]=function(e,t,n){const r=4*Math.floor(2e5*Math.pow(n/15,.6)*Math.pow(e*t/230400,.75)),i=e*t,o=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),a=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let s=pp(o).call(o).next().value,c=1;if(o.has(i))s=o.get(i);else{var l;const e=Zp(l=Array.from(o.entries())).call(l,(e,t)=>{let[n]=e,[r]=t;return n-r}),t=e.find(e=>{let[t]=e;return t>i});if(t){const n=e.indexOf(t);if(n>0){const r=e[n-1],o=(i-r[0])/(t[0]-r[0]);s=r[1]+o*(t[1]-r[1])}else s=t[1]}else s=e[e.length-1][1]}if(a.has(i))c=a.get(i);else{var d;const e=Zp(d=Array.from(a.entries())).call(d,(e,t)=>{let[n]=e,[r]=t;return n-r}),t=e.find(e=>{let[t]=e;return t>i});if(t){const n=e.indexOf(t);if(n>0){const r=e[n-1],o=(i-r[0])/(t[0]-r[0]);c=r[1]+o*(t[1]-r[1])}else c=t[1]}else c=e[e.length-1][1]}const u=SP("VIDEO_NEW_BITRATE_RATIO");u&&u>0&&(s=u/100);const h=Math.floor(r*s),p=Math.floor(65e4*Math.pow(e*t/230400,.5)*Math.pow(n/15,.69));let m=h;const f=SP("VIDEO_STANDARD_BITRATE_VERSION");return f&&f>0&&(1===f?m=r:2===f?m=h:3===f&&(m=p)),[Math.floor(m/1e3),c]}(e,t,n);this._encoderConfig.bitrateMax=r,this._encoderConfig.bitrateMin=a?Math.min(a,r):r,this._saveEncodeBitrateRatio=i,nk.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(e,", h: ").concat(t,", fps: ").concat(n,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else nk.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(e,", h: ").concat(t,", fps: ").concat(n,"] => [brMax: ").concat(o,", brMin: ").concat(a,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:i,slot:o}=r;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=RN.checkOneElementVisible(i),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=dk.reportApiInvoke(null,{tag:xN.TRACER,name:DN.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new pN(hN.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}async renewMediaStreamTrack(e){}pipe(e){if(this.processor===e)return e;if(e._source)throw new pN(hN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._encoderConfig;t&&(r=cD(cD({},r),Nk(t))),r=sO(r);const i=vO(8,"track-video-cloned-"),o=new e(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,r,sO(this._scalabilityMode),this._optimizationMode,i,sO(this._hints));return t&&r&&o.setEncoderConfiguration(r),nk.debug("clone video track from ".concat(this.getTrackId()," to ").concat(i,", clone ").concat(n)),o}async replaceTrack(e,t){if(!(e instanceof MediaStreamTrack))throw new pN(hN.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if("video"!==e.kind)throw new pN(hN.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(e,t,!0),this.updateMediaStreamTrackResolution()}sendSeiData(e){if(lO(()=>{dk.reportApiInvoke(null,{name:DN.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:xN.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!SP("ENABLE_VIDEO_SEI")||!SP("ENABLE_ENCODED_TRANSFORM"))return void nk.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(e instanceof Uint8Array==0)return new pN(hN.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const t=this.getRTCRtpTransceiver();if(!t)return void nk.warning("Video track is not published, SEI can not be send");const n=t.sender.getParameters();if(0===n.codecs.length)return;const r=n.codecs[0].mimeType.toLocaleLowerCase();"video/h264"===r||"video/h265"===r?this.safeEmit("sei-to-send",e):nk.warning("SEI is not supported by ".concat(r))}bindProcessorDestinationEvents(){this.processorDestination.on(Zk.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await qN(this,Mk.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qN(this,Mk.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Zk.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Qk.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Qk.REQUEST_CONSTRAINTS)}},oD(CL.prototype,"play",[Jx,Zx],Object.getOwnPropertyDescriptor(CL.prototype,"play"),CL.prototype),oD(CL.prototype,"stop",[Qx],Object.getOwnPropertyDescriptor(CL.prototype,"stop"),CL.prototype),oD(CL.prototype,"setEnabled",[$x,eL,tL],Object.getOwnPropertyDescriptor(CL.prototype,"setEnabled"),CL.prototype),oD(CL.prototype,"setMuted",[nL,rL,iL],Object.getOwnPropertyDescriptor(CL.prototype,"setMuted"),CL.prototype),oD(CL.prototype,"setSaveEncodeBitrateRatio",[oL,aL],Object.getOwnPropertyDescriptor(CL.prototype,"setSaveEncodeBitrateRatio"),CL.prototype),oD(CL.prototype,"setEncoderConfiguration",[sL,cL],Object.getOwnPropertyDescriptor(CL.prototype,"setEncoderConfiguration"),CL.prototype),oD(CL.prototype,"getStats",[lL],Object.getOwnPropertyDescriptor(CL.prototype,"getStats"),CL.prototype),oD(CL.prototype,"setBeautyEffect",[dL,uL],Object.getOwnPropertyDescriptor(CL.prototype,"setBeautyEffect"),CL.prototype),oD(CL.prototype,"getCurrentFrameData",[hL],Object.getOwnPropertyDescriptor(CL.prototype,"getCurrentFrameData"),CL.prototype),oD(CL.prototype,"getCurrentFrameImage",[pL],Object.getOwnPropertyDescriptor(CL.prototype,"getCurrentFrameImage"),CL.prototype),oD(CL.prototype,"findClosestProfile",[mL,fL],Object.getOwnPropertyDescriptor(CL.prototype,"findClosestProfile"),CL.prototype),oD(CL.prototype,"setBitrateLimit",[gL],Object.getOwnPropertyDescriptor(CL.prototype,"setBitrateLimit"),CL.prototype),oD(CL.prototype,"setOptimizationMode",[_L],Object.getOwnPropertyDescriptor(CL.prototype,"setOptimizationMode"),CL.prototype),oD(CL.prototype,"setScalabiltyMode",[vL],Object.getOwnPropertyDescriptor(CL.prototype,"setScalabiltyMode"),CL.prototype),oD(CL.prototype,"updateMediaStreamTrackResolution",[bL],Object.getOwnPropertyDescriptor(CL.prototype,"updateMediaStreamTrackResolution"),CL.prototype),oD(CL.prototype,"pipe",[EL],Object.getOwnPropertyDescriptor(CL.prototype,"pipe"),CL.prototype),oD(CL.prototype,"unpipe",[yL],Object.getOwnPropertyDescriptor(CL.prototype,"unpipe"),CL.prototype),oD(CL.prototype,"close",[SL],Object.getOwnPropertyDescriptor(CL.prototype,"close"),CL.prototype),oD(CL.prototype,"replaceTrack",[TL],Object.getOwnPropertyDescriptor(CL.prototype,"replaceTrack"),CL.prototype),CL),LL=(wL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),RL=jD(),AL=DO("CameraVideoTrack","_enabledMutex"),IL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),NL=jD(),OL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),PL=jD(),kL=lk({argsMap:e=>[e.getTrackId()]}),DL=class e extends xL{get __className__(){return"CameraVideoTrack"}constructor(e,t,n,r,i,o){super(e,Nk(t.encoderConfig),r,i,o),aD(this,"_config",void 0),aD(this,"_originalConstraints",void 0),aD(this,"_constraints",void 0),aD(this,"_enabled",!0),aD(this,"_deviceName","default"),aD(this,"tryResumeVideoForIOS15_16WeChat",async()=>{($I()||eN())&&!function(){const e=PI();if(e.os!==RI.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=2}()&&rN()&&this._enabled&&!this._isClosed&&(nk.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=t,this._originalConstraints=n,this._constraints=n,this._deviceName=e.label,this._encoderConfig=Nk(this._config.encoderConfig),mD.on(yk.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),mD.on(yk.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(e){return"string"==typeof e?this._setDeviceById(e):e.deviceId?this._setDeviceById(e.deviceId):e.facingMode?this._setDeviceByFacingModel(e.facingMode):void 0}async _setDeviceById(e){if(nk.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),this._enabled)try{const t=await kD.getDeviceById(e),n={};n.video=cD({},this._constraints),n.video.deviceId={exact:e},n.video.facingMode=void 0,this._originMediaStreamTrack.stop();let r=null;try{r=await ID(n,this.getTrackId())}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),r=await ID({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await kD.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}nk.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(e){nk.info("[".concat(this.getTrackId(),"] set facingMode ").concat(e));const t={video:cD(cD({},this._constraints),{},{deviceId:void 0,facingMode:{exact:e}})};if(this._enabled){this._originMediaStreamTrack.stop();let e=null;try{e=await ID(t,this.getTrackId())}catch(t){throw nk.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),t.toString()),e=await ID({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),t}await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=e,this._config.cameraId=void 0,this._constraints=cD({},t.video),nk.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(nk.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const e=await ID({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1)}await qN(this,Mk.NEED_ENABLE_TRACK,this)}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.toString()),e}this.updateMediaStreamTrackResolution(),nk.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),t||(this._enabled=!1);try{await qN(this,Mk.NEED_DISABLE_TRACK,this)}catch(e){throw nk.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}nk.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(e,t){if(!this._enabled)throw new pN(hN.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");e=Nk(e),SP("USE_STANDARD_BITRATE_DEFAULT")&&(delete e.bitrateMax,delete e.bitrateMin),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate||e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate||e.bitrateMin);const n=aO(this._config);n.encoderConfig=e;const r=YD(n);(UI()||BI()||nN())&&(r.deviceId=void 0),nk.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(r));try{await this._originMediaStreamTrack.applyConstraints(r),this.updateMediaStreamTrackResolution()}catch(e){const t=new pN(hN.UNEXPECTED_ERROR,e.toString());throw nk.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}this._config=n,this._constraints=r,this._originalConstraints=r,this._encoderConfig=e,-1===this._hints.indexOf(Uk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await qN(this,Mk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(nk)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((BI()||nN())&&this._enabled&&!this._isClosed&&mD.duringInterruption){const e=async()=>{mD.off(yk.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(nk.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};mD.on(yk.IOS_INTERRUPTION_END,e)}else nk.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Wk.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=kD.searchDeviceIdByName(this._deviceName);if(n&&!t.deviceId&&(t.deviceId={exact:n}),this._enabled){const e=await ID({video:t},this.getTrackId());this._constraints=t,await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),mD.off(yk.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),mD.off(yk.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._encoderConfig;t&&(r=cD(cD({},r),Nk(t))),r=sO(r);const i=vO(8,"track-cam-cloned-"),o=new e(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,sO(cD(cD({},this._config),{},{encoderConfig:r})),sO(this._constraints),sO(this._scalabilityMode),this._optimizationMode,i);return t&&r&&o.setEncoderConfiguration(r),nk.debug("clone track from ".concat(this.getTrackId()," to ").concat(i,", clone ").concat(n)),o}bindProcessorContextEvents(){this.processorContext.on(Qk.REQUEST_UPDATE_CONSTRAINTS,async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}}),this.processorContext.on(Qk.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}},oD(DL.prototype,"setDevice",[wL,RL],Object.getOwnPropertyDescriptor(DL.prototype,"setDevice"),DL.prototype),oD(DL.prototype,"setEnabled",[AL,IL,NL],Object.getOwnPropertyDescriptor(DL.prototype,"setEnabled"),DL.prototype),oD(DL.prototype,"setEncoderConfiguration",[OL,PL],Object.getOwnPropertyDescriptor(DL.prototype,"setEncoderConfiguration"),DL.prototype),oD(DL.prototype,"close",[kL],Object.getOwnPropertyDescriptor(DL.prototype,"close"),DL.prototype),DL);function ML(e){const t=vO(8,"track-cus-"),n=dk.reportApiInvoke(null,{id:t,tag:xN.TRACER,name:DN.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),r=new Vx(e.mediaStreamTrack,e.encoderConfig?Dk(e.encoderConfig):{},t,!1);return nk.info("create custom audio track success with config",e,"trackId",r.getTrackId()),n.onSuccess(r.getTrackId()),r}function UL(e,t,n,r){n.optimizationMode&&(r&&r.width&&r.height?(n.encoderConfig=cD(cD({},r),{},{bitrateMin:r.bitrateMin,bitrateMax:r.bitrateMax}),"motion"!==n.optimizationMode&&"detail"!==n.optimizationMode||(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?nk.debug("[".concat(e,"] set content hint to"),n.optimizationMode):nk.debug("[".concat(e,"] set content hint failed")))):nk.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var FL,jL,VL,BL,WL,HL,GL,zL,KL,YL,qL,XL,JL;class ZL extends lD{getUserId(){return this._userId}constructor(e,t,n,r){super(e,"track-".concat(e.kind,"-").concat(t,"-").concat(r.clientId,"_").concat(vO(5,""))),aD(this,"_userId",void 0),aD(this,"_uintId",void 0),aD(this,"_isDestroyed",!1),aD(this,"store",void 0),aD(this,"processor",void 0),aD(this,"processorContext",void 0),this._userId=t,this._uintId=n,this.store=r}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,nk.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let QL=(FL=lk({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),jL=lk({argsMap:e=>[e.getTrackId()]}),VL=lk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),BL=lk({argsMap:e=>[e.getTrackId()]}),oD((WL=class extends ZL{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==tD.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,n,r,i){super(e,t,n,r),aD(this,"_videoVisibleTimer",null),aD(this,"_previousVideoVisibleStatus",void 0),aD(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),aD(this,"trackMediaType",Gk.VIDEO),aD(this,"_videoWidth",void 0),aD(this,"_videoHeight",void 0),aD(this,"_player",void 0),aD(this,"_prePlayer",void 0),aD(this,"processorDestination",void 0),aD(this,"processorContext",void 0),this._prePlayer=i,this.updateMediaStreamTrackResolution(),this.processorContext=new BD(this.getTrackId(),"remote"),this.processorDestination=new VD(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return lO(()=>{nk.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),XN(this,Mk.GET_STATS)||cD({},Jk)}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.safeEmit(Hk.PLAY_START),"string"==typeof e){const t=document.getElementById(e);t?e=t:(nk.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}nk.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=cD(cD({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});if(this._player)this._player.updateConfig(n);else{let t=!1,r=!1;e instanceof HTMLVideoElement?(this._player=new Yx(n),this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0,r=!0)):this._prePlayer&&!this._prePlayer.isDestroyed?(this._player=this._prePlayer,this._prePlayer=void 0,t=this._player.videoState>0,this._player.updateConfig(n)):this._player=new Xx(n),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Hk.FIRST_FRAME_DECODED),r&&this.safeEmit(Hk.FIRST_FRAME_RENDER)},this._player.onVideoStateChanged=e=>{this.safeEmit(Hk.VIDEO_STATE_CHANGED,e)},t&&(this._player.onFirstVideoFrameDecoded(),this._player.onVideoStateChanged(this._player.videoState))}this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(Hk.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}},SP("CHECK_VIDEO_VISIBLE_INTERVAL")),this.safeEmit(Hk.PLAY_END)}stop(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(e),this._player=void 0,nk.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){KD(this._originMediaStreamTrack).then(e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t}).catch(EO)}_updatePlayerSource(){nk.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:i,slot:o}=r;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=RN.checkOneElementVisible(i),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=dk.reportApiInvoke(null,{tag:xN.TRACER,name:DN.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new pN(hN.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new pN(hN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Zk.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Zk.ON_TRACK)}_destroy(){this._prePlayer&&(this._prePlayer.destroy(),this._prePlayer=void 0),super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(Bk.SEI_RECEIVED,e)}}).prototype,"play",[FL],Object.getOwnPropertyDescriptor(WL.prototype,"play"),WL.prototype),oD(WL.prototype,"stop",[jL],Object.getOwnPropertyDescriptor(WL.prototype,"stop"),WL.prototype),oD(WL.prototype,"pipe",[VL],Object.getOwnPropertyDescriptor(WL.prototype,"pipe"),WL.prototype),oD(WL.prototype,"unpipe",[BL],Object.getOwnPropertyDescriptor(WL.prototype,"unpipe"),WL.prototype),WL),$L=(HL=lk({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),GL=lk({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),zL=lk({argsMap:(e,t)=>[e.getTrackId(),t]}),KL=lk({argsMap:e=>[e.getTrackId()]}),YL=lk({argsMap:e=>[e.getTrackId()]}),qL=lk({argsMap:(e,t)=>[e.getTrackId(),t.name]}),XL=lk({argsMap:e=>[e.getTrackId()]}),oD((JL=class extends ZL{get isPlaying(){return this._useAudioElement?FD.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,n,r){super(e,t,n,r),aD(this,"trackMediaType",Gk.AUDIO),aD(this,"_source",void 0),aD(this,"_useAudioElement",!0),aD(this,"_volume",100),aD(this,"processorContext",void 0),aD(this,"processorDestination",void 0),aD(this,"_played",!1),aD(this,"_bypassWebAudio",!1),SP("DISABLE_WEBAUDIO")?(this._source=new GD,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new yD(e,!0),SP("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(zk.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Hk.FIRST_FRAME_DECODED)}),this.processorContext=new HD(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new WD(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(zk.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(zk.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(zk.ON_AUDIO_BUFFER),this._source.on(zk.ON_AUDIO_BUFFER,t=>e(t))}setVolume(e){this._volume=e,this._useAudioElement?FD.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}setAmplifiedVolume(e){this._useAudioElement&&this._played&&(FD.stop(this.getTrackId()),this._source.play()),this._useAudioElement=!1,e=Math.min(e,SP("MAX_WEBAUDIO_VOLUME")),this._volume=e,this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!mk())throw new pN(hN.NOT_SUPPORTED,"your browser does not support setting the audio output device");await FD.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getVolume(){return this._useAudioElement?FD.getVolume(this.getTrackId()):this._source instanceof yD?this._source.getAudioVolume():0}getStats(){return lO(()=>{nk.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),XN(this,Mk.GET_STATS)||cD({},qk)}play(){nk.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(nk.debug("[".concat(this.getTrackId(),"] use audio element to play")),FD.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):(nk.debug("[".concat(this.getTrackId(),"] use audio context to play")),this._source.play())}stop(){nk.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?FD.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];nk.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&FD.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new pN(hN.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new pN(hN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new pN(hN.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Zk.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(Zk.ON_NODE,e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Zk.ON_TRACK),this.processorDestination.removeAllListeners(Zk.ON_NODE)}}).prototype,"setVolume",[HL],Object.getOwnPropertyDescriptor(JL.prototype,"setVolume"),JL.prototype),oD(JL.prototype,"setAmplifiedVolume",[GL],Object.getOwnPropertyDescriptor(JL.prototype,"setAmplifiedVolume"),JL.prototype),oD(JL.prototype,"setPlaybackDevice",[zL],Object.getOwnPropertyDescriptor(JL.prototype,"setPlaybackDevice"),JL.prototype),oD(JL.prototype,"play",[KL],Object.getOwnPropertyDescriptor(JL.prototype,"play"),JL.prototype),oD(JL.prototype,"stop",[YL],Object.getOwnPropertyDescriptor(JL.prototype,"stop"),JL.prototype),oD(JL.prototype,"pipe",[qL],Object.getOwnPropertyDescriptor(JL.prototype,"pipe"),JL.prototype),oD(JL.prototype,"unpipe",[XL],Object.getOwnPropertyDescriptor(JL.prototype,"unpipe"),JL.prototype),JL);const eM=new class extends ON{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),aD(this,"_lastHiddenTime",0),aD(this,"_lastVisibleTime",0),aD(this,"needUploadStats",[]),aD(this,"isCollectingStats",!1),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),this.isCollectingStats&&this.needUploadStats.push("visible"===document.visibilityState?1:0),nk.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}startCollectStats(){this.isCollectingStats=!0,this.needUploadStats.push("visible"===this.visibility?1:0)}stopCollectStats(){this.isCollectingStats=!1,this.needUploadStats.length=0}};class tM extends ON{constructor(e,t){super(),aD(this,"trackMediaType",Gk.DATA),aD(this,"_version",1),aD(this,"_type",3),aD(this,"_config",void 0),aD(this,"_originDataChannel",void 0),aD(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),aD(this,"_dataStreamPacketHandler",{serialize:e=>e,deserialize:e=>e}),aD(this,"_datachannelEventMap",new Map),this._config=e,t&&(this._originDataChannel=t,this._bandDataChannelEvents(t)),this._initPacketHeader()}useDataStream(e){this._dataStreamPacketHandler=e}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return SP("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.readyState)&&void 0!==e?e:"connecting"}get _originDataChannelId(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.id)&&void 0!==e?e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new ip((e,t)=>{if(this._originDataChannel){"open"===this._originDataChannel.readyState&&e();const n=setTimeout(()=>{var e;t(new pN(hN.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat(null===(e=this._originDataChannel)||void 0===e?void 0:e.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(n),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),e()},this._originDataChannel.onerror=()=>{throw clearTimeout(n),new pN(hN.DATACHANNEL_CONNECTION_TIMEOUT)}}else t(new pN(hN.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(e){this._originDataChannel=e,this._bandDataChannelEvents(e)}_initPacketHeader(){const e=new DataView(this._dataStreamPacketHeader);e.setUint16(0,this._version),e.setUint8(2,this._type),e.setUint8(3,this._config.id)}_bandDataChannelEvents(e){this._unbindDataChannelEvents(e),[iD.OPEN,iD.CLOSE,iD.ERROR].forEach(t=>{const n=()=>{this.emit(t)};this._datachannelEventMap.set(t,n),e.addEventListener(t,n)})}_unbindDataChannelEvents(e){Array.from(this._datachannelEventMap.entries()).forEach(t=>{let[n,r]=t;e.removeEventListener(n,r)}),this._datachannelEventMap.clear()}}class nM extends tM{constructor(e){super(e),aD(this,"_messageListener",void 0),this._messageListener=e=>{if(e.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const t=e.data.slice(0,this._dataStreamPacketHeader.byteLength),n=new DataView(t).getUint8(3);if(n!==this.id)return void(SP("SHOW_DATASTREAM2_LOG")&&nk.debug("invalid datachannel id: ".concat(n," !== ").concat(this.id)));let r=e.data.slice(this._dataStreamPacketHeader.byteLength);r=this._dataStreamPacketHandler.deserialize(r),this.emit(iD.MESSAGE,r)}}_updateOriginDataChannel(e){super._updateOriginDataChannel(e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class rM extends tM{send(e){if(this._originDataChannel){let t=e;t=this._dataStreamPacketHandler.serialize(e);const n=new Uint8Array(this._dataStreamPacketHeader.byteLength+t.byteLength);n.set(new Uint8Array(this._dataStreamPacketHeader),0),n.set(new Uint8Array(t),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(n.buffer)}}}function iM(){const e=new Blob([atob("Y29uc3QgdD0idmlkZW8vaDI2NCIsZT0idmlkZW8vaDI2NSI7ZnVuY3Rpb24gbih0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLHI9W10sbz0wO2Zvcig7ci5sZW5ndGg8bjspbyszPG4mJjA9PT1hW29dJiYwPT09YVtvKzFdJiYzPT09YVtvKzJdJiYoMD09PWFbbyszXXx8MT09PWFbbyszXXx8Mj09PWFbbyszXXx8Mz09PWFbbyszXSk/KHIucHVzaChhW29dLGFbbysxXSxhW28rM10pLG8rPTQpOihyLnB1c2goYVtvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkocil9ZnVuY3Rpb24gYShhLHIpe3N3aXRjaChyKXtjYXNlIHQ6cmV0dXJuIGZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IERhdGFWaWV3KHQuZGF0YSk7bGV0IGE9MDtmb3IoO2ErNDx0LmRhdGEuYnl0ZUxlbmd0aDspe2lmKDA9PT1lLmdldFVpbnQ4KGErMCkmJjA9PT1lLmdldFVpbnQ4KGErMSkmJjA9PT1lLmdldFVpbnQ4KGErMikmJjE9PT1lLmdldFVpbnQ4KGErMykmJjY9PT1lLmdldFVpbnQ4KGErNCkpe2xldCByPWErNixvPTAsaT0wO2Zvcig7MjU1PT09KGk9ZS5nZXRVaW50OChyKyspKTspbys9MjU1O28rPWk7Y29uc3Qgcz1uKHQuZGF0YSxyLG8pO3JldHVybiBuZXcgVWludDhBcnJheShzKX1hKyt9cmV0dXJuIG51bGx9KGEpO2Nhc2UgZTpyZXR1cm4gZnVuY3Rpb24odCl7Y29uc3QgZT1uZXcgRGF0YVZpZXcodC5kYXRhKTtsZXQgYT0wO2Zvcig7YSs1PHQuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PWUuZ2V0VWludDgoYSswKSYmMD09PWUuZ2V0VWludDgoYSsxKSYmMD09PWUuZ2V0VWludDgoYSsyKSYmMT09PWUuZ2V0VWludDgoYSszKSYmNzg9PT1lLmdldFVpbnQ4KGErNCkmJjE9PT1lLmdldFVpbnQ4KGErNSkmJjEwMT09PWUuZ2V0VWludDgoYSs2KSl7bGV0IHI9YSs3LG89MCxpPTA7Zm9yKDsyNTU9PT0oaT1lLmdldFVpbnQ4KHIrKykpOylvKz0yNTU7bys9aTtjb25zdCBzPW4odC5kYXRhLHIsbyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KHMpfWErK31yZXR1cm4gbnVsbH0oYSk7ZGVmYXVsdDpyZXR1cm4gbnVsbH19ZnVuY3Rpb24gcih0KXtjb25zdCBlPXQubGVuZ3RoO2xldCBuPVtdLGE9MDtmb3IoO2E8ZTspYSsyPGUmJjA9PT10W2FdJiYwPT09dFthKzFdJiYoMD09PXRbYSsyXXx8MT09PXRbYSsyXXx8Mj09PXRbYSsyXXx8Mz09PXRbYSsyXSk/KG4ucHVzaCh0W2FdLHRbYSsxXSwzLHRbYSsyXSksYSs9Myk6KG4ucHVzaCh0W2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShuKX1mdW5jdGlvbiBvKG4sYSxvKXtzd2l0Y2gobyl7Y2FzZSB0OnJldHVybiBmdW5jdGlvbih0LGUpe2NvbnN0IG49cihlKSxhPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihhLzI1NSksaT1hJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK2ErdC5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNitmXT0yNTUsZisrO3JldHVybiBzWzYrZl09aSxmKysscy5zZXQobiw2K2YpLHMuc2V0KG5ldyBVaW50OEFycmF5KHQpLDYrZithKSxzLmJ1ZmZlcn0obixhKTtjYXNlIGU6cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3Qgbj1yKGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxpPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNytvKzErYSsxK3QuYnl0ZUxlbmd0aCk7c1swXT0wLHNbMV09MCxzWzJdPTAsc1szXT0xLHNbNF09Nzgsc1s1XT0xLHNbNl09MTAxO2xldCBmPTA7Zm9yKDtmPG87KXNbNytmXT0yNTUsZisrO3JldHVybiBzWzcrZl09aSxmKysscy5zZXQobiw3K2YpLGYrPWEsc1s3K2ZdPTEyOCxmKysscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNytmKSxzLmJ1ZmZlcn0obixhKTtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBpKG4pe2lmKG4ubGVuZ3RoPDUpcmV0dXJuIiI7bGV0IGE9LTE7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aC0zO3QrKyl7aWYoMD09PW5bdF0mJjA9PT1uW3QrMV0mJjE9PT1uW3QrMl0pe2E9dDticmVha31pZih0PG4ubGVuZ3RoLTQmJjA9PT1uW3RdJiYwPT09blt0KzFdJiYwPT09blt0KzJdJiYxPT09blt0KzNdKXthPXQ7YnJlYWt9fWlmKC0xPT09YSlyZXR1cm4iIjtjb25zdCByPWErKDA9PT1uW2ErMl0/NDozKTtpZihyPj1uLmxlbmd0aClyZXR1cm4iIjtjb25zdCBvPW5bcl07aWYoMTI4Jm8pcmV0dXJuIiI7aWYoKG8+PjEmNjMpPj0zMilyZXR1cm4gZTtpZihyKzE8bi5sZW5ndGgpe2lmKDA9PSgyNDgmbltyKzFdKSlyZXR1cm4gZX1yZXR1cm4oMzEmbyk8PTMxP3Q6IiJ9Y29uc3Qgcz03MSxmPTEsbD0yLHU9MSxnPTI7dmFyIGM7ZnVuY3Rpb24gZCh0LGU9ITEpe2NvbnN0IG49dC5nZXRVaW50OCgwKTtpZihuIT09cylyZXR1cm47Y29uc3QgYT10LmdldFVpbnQxNigxKSxyPWYrbCthLG89bmV3IFVpbnQ4QXJyYXkodC5ieXRlTGVuZ3RoLXIpO28uc2V0KG5ldyBVaW50OEFycmF5KHQuYnVmZmVyLHIsdC5ieXRlTGVuZ3RoLXIpKTtjb25zdCBpPXttOm4sdGx2TGVuOmEsdGx2OltdLGZyYW1lOm99O2xldCBkPWYrbDtmb3IoO2Q8cjspe2NvbnN0IG49dC5nZXRVaW50OChkKSxhPXQuZ2V0VWludDE2KGQrdSkscj11K2c7aWYobj09PWMuQVVESU9fTEVWRUwpe2xldCBvPXQuZ2V0VWludDgoZCtyKTtmb3IobGV0IGU9MTtlPGE7ZSsrKW89bzw8OHx0LmdldFVpbnQ4KGQrcitlKTtpLnRsdi5wdXNoKHt0YWc6bixsZW5ndGg6YSx2YWx1ZTplPzEyN15vPj4xOjEyNyZvfSl9ZWxzZSBpZihuPT09Yy5NRVRBREFUQXx8bj09PWMuQVVESU9fNjRfQklUX1BUUyl7Y29uc3QgZT1uZXcgVWludDhBcnJheShhKTtmb3IobGV0IG49MDtuPGE7bisrKWVbbl09dC5nZXRVaW50OChkK3Irbik7aS50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZX0pfWQrPXIrYX1yZXR1cm4gaX0hZnVuY3Rpb24odCl7dFt0LkFVRElPX0xFVkVMPTFdPSJBVURJT19MRVZFTCIsdFt0Lk1FVEFEQVRBPTJdPSJNRVRBREFUQSIsdFt0LkFVRElPXzY0X0JJVF9QVFM9M109IkFVRElPXzY0X0JJVF9QVFMifShjfHwoYz17fSkpLHNlbGYub25ydGN0cmFuc2Zvcm09dD0+e2NvbnN0IGU9dC50cmFuc2Zvcm1lcixuPVtdLHI9W107bGV0IGg9bnVsbDtlLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9dD0+e3QuZGF0YS5zZWkmJm4ucHVzaCh0LmRhdGEuc2VpKSx0LmRhdGEubWV0YWRhdGEmJnIucHVzaCh0LmRhdGEubWV0YWRhdGEpfSxzZWxmLnBvc3RNZXNzYWdlKCJzdGFydGVkIik7Y29uc3QgcD1lLnJlYWRhYmxlLmdldFJlYWRlcigpLFU9ZS53cml0YWJsZS5nZXRXcml0ZXIoKTsic2VpLXJ4Ij09PWUub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQoZSl7cC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1pKG5ldyBVaW50OEFycmF5KG4udmFsdWUuZGF0YSkpLHI9YShuLnZhbHVlLHQpO2lmKHImJmUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHtzZWk6cn0pLCFoKXtjb25zdCB0PW4udmFsdWUuZ2V0TWV0YWRhdGEoKXx8e307aD17dHlwZTpuLnZhbHVlLnR5cGUscnRwVGltZXN0YW1wOm4udmFsdWUudGltZXN0YW1wLHBheWxvYWRUeXBlOnQucGF5bG9hZFR5cGV8fDAsc3NyYzp0LnN5bmNocm9uaXphdGlvblNvdXJjZXx8MCxsZW5ndGg6bi52YWx1ZS5kYXRhLmJ5dGVMZW5ndGgsLi4uIm1pbWVUeXBlImluIHQ/e21pbWVUeXBlOnQubWltZVR5cGV9Ont9fSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7Zmlyc3RGcmFtZUluZm86aH0pfX1VLndyaXRlKG4udmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToic2VpLXR4Ij09PWUub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQoZSl7cC5yZWFkKCkudGhlbigoYT0+e2lmKCFhLmRvbmUpe2lmKGEudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1pKG5ldyBVaW50OEFycmF5KGEudmFsdWUuZGF0YSkpLGU9bi5zaGlmdCgpO2lmKGUpe2NvbnN0IG49byhhLnZhbHVlLmRhdGEsZSx0KTtuJiYoYS52YWx1ZS5kYXRhPW4pfX1VLndyaXRlKGEudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToiYXVkaW8tbWV0YWRhdGEtcngiPT09ZS5vcHRpb25zLm5hbWU/ZnVuY3Rpb24gdChlKXtwLnJlYWQoKS50aGVuKChuPT57aWYoIW4uZG9uZSl7aWYobi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PW5ldyBEYXRhVmlldyhuLnZhbHVlLmRhdGEpLGE9dC5nZXRVaW50OCgwKTtsZXQgcjtpZigwIT0oMTI4JmEpJiY3MSE9PWEpe2NvbnN0IGU9ZnVuY3Rpb24odCl7aWYodC5ieXRlTGVuZ3RoPD0wKXJldHVybltdO2NvbnN0IGU9W107bGV0IG49MDtmb3IoO248dC5ieXRlTGVuZ3RoOyl7Y29uc3QgYT0oMTI4JnQuZ2V0VWludDgobikpPj43LHI9MTI3JnQuZ2V0VWludDgobik7aWYoIShhJiZuKzQ8PXQuYnl0ZUxlbmd0aCkpe24rKzticmVha317Y29uc3QgYT10LmdldFVpbnQzMihuLCExKSxvPSgxNjc3NjE5MiZhKT4+MTAsaT0xMDIzJmE7ZS5wdXNoKHtwdDpyLHRzX29mZnNldDpvLGxlbmd0aDppLGRhdGE6bmV3IFVpbnQ4QXJyYXl9KSxuKz00fX1sZXQgYT10LmJ5dGVMZW5ndGgtbjtmb3IoY29uc3QgciBvZiBlKXtpZihyLmxlbmd0aD5hKXJldHVybiBjb25zb2xlLndhcm4oIkJyb2tlbiByZWQgcGF5bG9hZCIpLFtdO3IubGVuZ3RoPjAmJihyLmRhdGE9bmV3IFVpbnQ4QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sci5sZW5ndGgpLG4rPXIubGVuZ3RoLGEtPXIubGVuZ3RoKX1pZihhPjApe2NvbnN0IHI9e3B0OmUubGVuZ3RoPjA/ZVtlLmxlbmd0aC0xXS5wdDowLHRzX29mZnNldDowLGxlbmd0aDphLGRhdGE6bmV3IFVpbnQ4QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sYSl9O2UucHVzaChyKX1yZXR1cm4gZX0odCk7aWYoZS5sZW5ndGg+MCl7Y29uc3QgdD1mdW5jdGlvbih0KXtsZXQgZT0wO2ZvcihsZXQgbj0wO248dC5sZW5ndGg7bisrKWUrPW48dC5sZW5ndGgtMT80OjEsZSs9dFtuXS5sZW5ndGg7Y29uc3Qgbj1uZXcgVWludDhBcnJheShlKTtsZXQgYT0wO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKWlmKGU8dC5sZW5ndGgtMSl7Y29uc3Qgcj0oMjE0NzQ4MzY0OHwoMTI3JnRbZV0ucHQpPDwyNHwoMjYyMTQzJnRbZV0udHNfb2Zmc2V0KTw8MTB8MTAyMyZ0W2VdLmxlbmd0aCk+Pj4wO25bYSsrXT1yPj4yNCYyNTUsblthKytdPXI+PjE2JjI1NSxuW2ErK109cj4+OCYyNTUsblthKytdPTI1NSZyfWVsc2UgblthKytdPTEyNyZ0W2VdLnB0O2Zvcihjb25zdCBlIG9mIHQpbi5zZXQoZS5kYXRhLGEpLGErPWUubGVuZ3RoO3JldHVybiBufShlLm1hcCgodD0+e2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpO2Uuc2V0KHQuZGF0YSk7Y29uc3Qgbj1kKG5ldyBEYXRhVmlldyhlLmJ1ZmZlcikpO3JldHVybiBuPy5mcmFtZSYmKHQuZGF0YT1uPy5mcmFtZSkscj1uLHR9KSkpO24udmFsdWUuZGF0YT10LmJ1ZmZlcn19ZWxzZSByPWQodCksciYmKG4udmFsdWUuZGF0YT1yLmZyYW1lLmJ1ZmZlcik7aWYocil7bGV0IHQ9ci50bHYuZmluZCgodD0+dC50YWc9PT1jLk1FVEFEQVRBKSk7aWYodCYmdC52YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJmUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHttZXRhZGF0YTp0LnZhbHVlfSksdD1yLnRsdi5maW5kKCh0PT50LnRhZz09PWMuQVVESU9fNjRfQklUX1BUUykpLHQmJnQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5JiY4PT10LnZhbHVlLmxlbmd0aCl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcodC52YWx1ZS5idWZmZXIpLmdldEJpZ1VpbnQ2NCgwLCEwKTt0JiZ0LnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3B0czpufSl9fX1VLndyaXRlKG4udmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfShlKToiYXVkaW8tbWV0YWRhdGEtdHgiPT09ZS5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIHQoZSl7cC5yZWFkKCkudGhlbigobj0+e2lmKCFuLmRvbmUpe2lmKGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHtnZXRNZXRhZGF0YTohMH0pLG4udmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkQXVkaW9GcmFtZSl7Y29uc3QgdD1yLnNoaWZ0KCk7dCYmKG4udmFsdWUuZGF0YT1mdW5jdGlvbih0LGUsbil7Y29uc3QgYT1uLmJ5dGVMZW5ndGgscj1hK3UrZyxvPWYrbCtyLGk9bmV3IEFycmF5QnVmZmVyKHQuYnl0ZUxlbmd0aCtvKSxjPW5ldyBEYXRhVmlldyhpKTtjLnNldFVpbnQ4KDAscyksYy5zZXRVaW50MTYoMSxyKSxjLnNldFVpbnQ4KDMsZSksYy5zZXRVaW50MTYoNCxhKTtmb3IobGV0IHQ9MDt0PGE7dCsrKWMuc2V0VWludDgoNit0LG5bdF0pO2NvbnN0IGQ9bmV3IFVpbnQ4QXJyYXkoYy5idWZmZXIpO3JldHVybiBkLnNldChuZXcgVWludDhBcnJheSh0KSxvKSxkLmJ1ZmZlcn0obi52YWx1ZS5kYXRhLGMuQVVESU9fNjRfQklUX1BUUyx0KSl9VS53cml0ZShuLnZhbHVlKSxlLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSx0KGUpfX0pKX0oZSl9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKTsK")],{type:"text/javascript"});return setTimeout(()=>Tv.revokeObjectURL(e),0),new Worker(Tv.createObjectURL(e))}const oM=71,aM=1,sM=2,cM=1,lM=2;var dM=function(e){return e[e.AUDIO_LEVEL=1]="AUDIO_LEVEL",e[e.METADATA=2]="METADATA",e[e.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",e}(dM||{});function uM(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.getUint8(0);if(n!==oM)return;const r=e.getUint16(1),i=aM+sM+r,o=new Uint8Array(e.byteLength-i);o.set(new Uint8Array(e.buffer,i,e.byteLength-i));const a={m:n,tlvLen:r,tlv:[],frame:o};let s=aM+sM;for(;s<i;){const n=e.getUint8(s),r=e.getUint16(s+cM),i=cM+lM;if(n===dM.AUDIO_LEVEL){let o=e.getUint8(s+i);for(let t=1;t<r;t++)o=o<<8|e.getUint8(s+i+t);a.tlv.push({tag:n,length:r,value:t?127^o>>1:127&o})}else if(n===dM.METADATA||n===dM.AUDIO_64_BIT_PTS){const t=new Uint8Array(r);for(let n=0;n<r;n++)t[n]=e.getUint8(s+i+n);a.tlv.push({tag:n,length:r,value:t})}s+=i+r}return a}const hM=new Map,pM=127,mM=1e-10,fM=139/13,gM=new Map;function _M(e,t,n){const r="".concat(e,"-").concat(t,"-").concat(n);let i=0;if(gM.has(r))i=gM.get(r);else{const o=.5;i=Math.log(function(e,t){const n=e-t;t<n&&(t=n);let r=1;for(let i=e,o=1;i>t;i--,o++)r=r*i/o;return r}(t,e))+e*Math.log(o)+(t-e)*Math.log(1-o)-Math.log(n)+n*e,gM.set(r,i)}return i<mM&&(i=mM),i}function vM(e,t,n){const r=t.length,i=e.length/r;let o=!1;for(let a=0,s=0;a<r;a++){let r=0;for(let t=s+i;s<t;s++)e[s]>n&&r++;t[a]!==r&&(t[a]=r,o=!0)}return o}window.cache=gM;let bM=0;class EM{constructor(e){aD(this,"id",void 0),aD(this,"immediates",[]),aD(this,"lastNonSilence",-1),aD(this,"immediateSpeechActivityScore",mM),aD(this,"lastLevelChangedTime",Date.now()),aD(this,"levels",[]),aD(this,"longs",[]),aD(this,"longSpeechActivityScore",mM),aD(this,"mediums",[]),aD(this,"mediumSpeechActivityScore",mM),aD(this,"minLevel",0),aD(this,"nextMinLevel",0),aD(this,"nextMinLevelWindowLength",0),aD(this,"energyScore",0),this.id=e||"".concat(bM++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const e=this.immediates,t=this.levels,n=this.minLevel+fM;let r=!1;for(let i=0;i<e.length;++i){let o=t[i];o<n&&(o=0);const a=Math.floor(o/fM);e[i]!==a&&(e[i]=a,r=!0)}return r}computeLongs(){return vM(this.mediums,this.longs,4)}computeMediums(){return vM(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=_M(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(e){this.longSpeechActivityScore=_M(this.longs[0],10,47),this.longSpeechActivityScore>mM&&(this.lastNonSilence=e)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=_M(this.mediums[0],5,24)}evaluateSpeechActivityScores(e){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(e)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var e;return"[".concat(_i(e=[...this.levels]).call(e).join(),"]")}getSpeechActivityScore(e){switch(e){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+e)}}levelChanged(e,t){if(this.lastLevelChangedTime<=t){this.lastLevelChangedTime=t;let n=e;return e<0&&(n=0),e>pM&&(n=pM),this.levels.unshift(n),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(n),n>=this.minLevel+fM?n:n/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(e){if(0!==e){if(0===this.minLevel||this.minLevel>e)return this.minLevel=e,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(0===this.nextMinLevel)return this.nextMinLevel=e,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>e&&(this.nextMinLevel=e),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let e=Math.sqrt(this.minLevel*this.nextMinLevel);e<0?e=0:e>pM&&(e=pM),this.minLevel=e,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class yM{constructor(e){aD(this,"algorithm",void 0),this.algorithm=e}execute(){let e=!this.algorithm;if(!e)try{const t=this.algorithm.runInDecisionMaker(this);t<=0?e=!0:setTimeout(this.execute.bind(this),t)}catch(t){e=!0}e&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class SM{constructor(e,t,n){aD(this,"isDominant",void 0),aD(this,"energyRanking",void 0),aD(this,"energyScore",void 0),this.isDominant=e,this.energyRanking=t,this.energyScore=n}}class TM extends ON{constructor(e){super(),aD(this,"dominantId",null),aD(this,"lastDecisionTime",0),aD(this,"lastLevelChangedTime",0),aD(this,"lastLevelIdleTime",0),aD(this,"relativeSpeechActivities",[]),aD(this,"speakers",new Map),aD(this,"enableSilence",!1),aD(this,"timeoutToSilenceInterval",0),aD(this,"decisionMaker",null),aD(this,"loudest",[]),aD(this,"numLoudestToTrack",3),aD(this,"energyExpireTimeMs",250),aD(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=e,this.enableSilence=e>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=e,null!=t&&(this.energyExpireTimeMs=t),null!=n&&(this.energyAlphaPct=n),this.loudest.length>e&&this.loudest.splice(e)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(e){return this.loudest.some(t=>t.id===e)}levelChanged(e,t){const n=Date.now(),r=this.getOrCreateSpeaker(e);this.lastLevelChangedTime<n&&(this.lastLevelChangedTime=n,this.maybeStartDecisionMaker());const i=r.levelChanged(t,n);return this.updateLoudestList(r,i,n)}runInDecisionMaker(e){return this.decisionMaker!==e||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(e){this.decisionMaker===e&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(e){e.forEach(e=>{this.speakers.has(e.id)||this.speakers.set(e.id,e)})}removeSpeakers(e){e.forEach(e=>{this.speakers.delete(e.id)})}getOrCreateSpeaker(e){let t=this.speakers.get(e);return t||(t=new EM(e),this.speakers.set(e,t),this.maybeStartDecisionMaker()),t}updateLoudestList(e,t,n){const r=e.id===this.dominantId;if(t<0){let t=0;for(;t<this.loudest.length&&this.loudest[t]!==e;)++t;return new SM(r,t,e.energyScore)}if(e.energyScore=Math.floor((this.energyAlphaPct*t+(100-this.energyAlphaPct)*e.energyScore+50)/100),0===this.numLoudestToTrack)return new SM(r,0,e.energyScore);const i=n-this.energyExpireTimeMs;let o=0;for(;o<this.loudest.length;){const t=this.loudest[o];if(t.getLastLevelChangedTime()<i&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(o,1);else if(t.id!==e.id)++o;else if(this.loudest.splice(o,1),this.loudest.length<this.numLoudestToTrack)break}let a=0;for(;a<this.loudest.length&&!(this.loudest[a].energyScore<e.energyScore);)++a;return a<this.numLoudestToTrack&&(this.loudest.splice(a,0,e),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new SM(r,a,e.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new yM(this),this.decisionMaker.execute())}makeDecision(e){let t=null,n=null;const r=this.speakers.size;let i=null;if(0===r)i=null;else if(1===r){var o;const t=pp(o=this.speakers).call(o).next().value;this.enableSilence&&t&&(i=t.id,t.evaluateSpeechActivityScores(e),e-t.lastNonSilence>this.timeoutToSilenceInterval&&(i=null))}else{let t=null==this.dominantId?null:this.speakers.get(this.dominantId);if(null==t){const e=this.speakers.entries().next();e.value&&(i=e.value[0],t=e.value[1])}else i=t.id;null!=t&&t.evaluateSpeechActivityScores(e);const n=this.relativeSpeechActivities;let r=2;for(const o of this.speakers.entries()){const[a,s]=o;if(s===t)continue;s.evaluateSpeechActivityScores(e);for(let e=0;e<n.length;++e){const r=null==t?mM:t.getSpeechActivityScore(e);n[e]=Math.log(s.getSpeechActivityScore(e)/r)}const c=n[0],l=n[1],d=n[2];c>3&&l>2&&d>0&&l>r&&(r=l,i=a)}this.enableSilence&&null!=t&&i===t.id&&e-t.lastNonSilence>this.timeoutToSilenceInterval&&(i=null)}null==i&&!this.enableSilence||i===this.dominantId||(t=this.dominantId,this.dominantId=i,n=this.dominantId),null==n&&!this.enableSilence||n===t||this.emit("ActiveSpeakerChanged",n)}_runInDecisionMaker(){const e=Date.now(),t=300-(e-this.lastLevelIdleTime);let n=0;t<=0?(0!==this.lastLevelIdleTime&&this.timeoutIdleLevels(e),this.lastLevelIdleTime=e):n=t;let r=300-(e-this.lastDecisionTime);return r<=0&&(this.lastDecisionTime=e,this.makeDecision(e),r=300-(Date.now()-e)),r>0&&n>r&&(n=r),n}timeoutIdleLevels(e){const t=[];for(const r of pp(n=this.speakers).call(n)){var n;const i=e-r.getLastLevelChangedTime();36e5<i&&(null==this.dominantId||r.id!==this.dominantId)?t.push(r.id):300<i&&r.levelTimedOut()}t.forEach(e=>this.speakers.delete(e))}}const CM=new Map;let wM=null,RM=null;const AM=3;let IM=[];const NM=new Map,OM=new Map;class PM{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(e,t){aD(this,"id",void 0),aD(this,"track",void 0),aD(this,"score",0),aD(this,"active",!0),aD(this,"muted",!1),aD(this,"timer",0),aD(this,"actives",0),aD(this,"inactives",0),this.id=e,this.track=t,this.setActive(NM.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const e=this.active;this.active=this.activeRate>=.8;const{actives:t,inactives:n}=function(){const e=[],t=[];return Array.from(pp(NM).call(NM)).forEach(n=>{n.active?e.push(n):t.push(n)}),{actives:e,inactives:t}}();if(t.length>3){let e;t.forEach(t=>{(!e||e.score>t.score)&&(e=t)}),e&&e.setActive(!1)}if(t.length<3&&n.length>0){let t;n.forEach(e=>{(!t||t.score<e.score)&&e.id!==this.id&&(t=e)}),t&&e&&!this.active&&(t.samples>40&&t.activeRate-this.activeRate>.4?t.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(e){this.active=e,this.resetTimer(),this.setMuted(!e)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const e=function(e){let t;return Array.from(pp(NM).call(NM)).forEach(n=>{!n.active||n.id===e||n.samples<40||(!t||n.score<t.score)&&(t=n)}),t}(this.id);e&&this.activeRate-e.activeRate>.4&&(e.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const e=function(e){let t;return Array.from(pp(NM).call(NM)).forEach(n=>{n.active||n.id===e||n.samples<40||(!t||n.score>t.score)&&(t=n)}),t}(this.id);e&&e.activeRate-this.activeRate>.4&&(e.setActive(!0),this.setActive(!1))}addSample(e){e?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(e){this.track&&(this.track.enabled=!e,this.muted=e)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(0!==this.samples)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let kM;function DM(e){const t=NM.get(e);t&&(NM.delete(e),t.clearTimer())}const xM=new Map,LM=new Map,MM="video/h264",UM="video/h265";function FM(e,t,n){let r=new Uint8Array(e,t,n),i=[],o=0;for(;i.length<n;)o+3<n&&0===r[o]&&0===r[o+1]&&3===r[o+2]&&(0===r[o+3]||1===r[o+3]||2===r[o+3]||3===r[o+3])?(i.push(r[o],r[o+1],r[o+3]),o+=4):(i.push(r[o]),o++);return new Uint8Array(i)}function jM(e){const t=e.length;let n=[],r=0;for(;r<t;)r+2<t&&0===e[r]&&0===e[r+1]&&(0===e[r+2]||1===e[r+2]||2===e[r+2]||3===e[r+2])?(n.push(e[r],e[r+1],3,e[r+2]),r+=3):(n.push(e[r]),r++);return new Uint8Array(n)}function VM(e){if(e.length<5)return"";let t=-1;for(let i=0;i<e.length-3;i++){if(0===e[i]&&0===e[i+1]&&1===e[i+2]){t=i;break}if(i<e.length-4&&0===e[i]&&0===e[i+1]&&0===e[i+2]&&1===e[i+3]){t=i;break}}if(-1===t)return"";const n=t+(0===e[t+2]?4:3);if(n>=e.length)return"";const r=e[n];return 128&r?"":(r>>1&63)>=32||n+1<e.length&&0==(248&e[n+1])?UM:(31&r)<=31?MM:""}const BM=new Map,WM=new Map;!function(){const e=PI();hk.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),hk.getStreamFromExtension=e.name===AI.CHROME&&Number(e.version)>34,hk.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),hk.supportMinBitrate=e.name===AI.CHROME||e.name===AI.EDGE,hk.supportSetRtpSenderParameters=function(){const e=PI();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!aN()||!(!UI()&&!LI())||e.name===AI.FIREFOX&&Number(e.version)>=64)}(),e.name===AI.SAFARI&&(Number(e.version)>=14?hk.supportDualStream=!0:hk.supportDualStream=!1),hk.webAudioMediaStreamDest=function(){const e=PI();return!(e.name===AI.SAFARI&&Number(e.version)<12)}(),hk.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,hk.supportWebGL="undefined"!=typeof WebGLRenderingContext,hk.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,aN()||(hk.webAudioWithAEC=!0),hk.supportShareAudio=function(){const e=PI();return(e.os===RI.WIN_10||e.os===RI.WIN_81||e.os===RI.WIN_7||e.os===RI.LINUX||e.os===RI.MAC_OS||e.os===RI.CHROMIUM_OS)&&e.name===AI.CHROME&&Number(e.version)>=74}(),hk.supportDataChannel=!!(WI(76)||KI(68)||YI(14)),hk.supportPCSetConfiguration=function(){const e=window.RTCPeerConnection;return!VI()&&!!e&&e.prototype.setConfiguration instanceof Function}(),hk.supportWebRTCEncodedTransform=WI(87)||FI()||KI(117),hk.supportWebRTCInsertableStream=function(){const e=PI();return(e.name===AI.CHROME||e.name===AI.EDGE)&&Number(e.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),hk.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,hk.supportWebCrypto="undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle,hk.supportSuppressLocalAudioPlayback=bk(),hk.supportRestrictOwnAudio=Ek(),oO(()=>{hk.supportDualStreamEncoding=function(){const e=PI();return!!SP("DISABLE_WEBAUDIO")||"Safari"===e.name&&Number(e.version)>=14||!!("Chrome"===e.name&&/Windows/i.test(e.os||"")&&Number(e.version)>=100&&SP("CHROME_DUAL_STREAM_USE_ENCODING"))}(),nk.debug("browser ua: ",navigator.userAgent),nk.info("browser info: ",e),nk.info("browser compatibility: ",hk)})}();const HM=["CHINA","GLOBAL"],GM=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],zM=[],KM=[];function YM(e,t){return!!t&&zM.some(n=>n.uid===e&&n.channelName===t)}function qM(){return KM.length>0}var XM=vT.forEach,JM=Gr("forEach")?[].forEach:function(e){return XM(this,e,arguments.length>1?arguments[1]:void 0)};Pn({target:"Array",proto:!0,forced:[].forEach!==JM},{forEach:JM});var ZM=er("Array","forEach"),QM=gr,$M=et,eU=u,tU=ZM,nU=Array.prototype,rU={DOMTokenList:!0,NodeList:!0},iU=function(e){var t=e.forEach;return e===nU||eU(nU,e)&&t===nU.forEach||$M(rU,QM(e))?tU:t},oU=r(iU),aU=Ze,sU=po;Pn({target:"Object",stat:!0,forced:i(function(){sU(1)})},{keys:function(e){return sU(aU(e))}});var cU=r(ee.Object.keys),lU=r(ri),dU=r(gi),uU=Pn,hU=ai,pU=Zc,mU=$,fU=Vn,gU=zn,_U=Z,vU=Xf,bU=mt,EU=al,yU=kS("slice"),SU=bU("species"),TU=Array,CU=Math.max;uU({target:"Array",proto:!0,forced:!yU},{slice:function(e,t){var n,r,i,o=_U(this),a=gU(o),s=fU(e,a),c=fU(void 0===t?a:t,a);if(hU(o)&&(n=o.constructor,(pU(n)&&(n===TU||hU(n.prototype))||mU(n)&&null===(n=n[SU]))&&(n=void 0),n===TU||void 0===n))return EU(o,s,c);for(r=new(void 0===n?TU:n)(CU(c-s,0)),i=0;s<c;s++,i++)s in o&&vU(r,i,o[s]);return r.length=i,r}});var wU=er("Array","slice"),RU=u,AU=wU,IU=Array.prototype,NU=function(e){var t=e.slice;return e===IU||RU(IU,e)&&t===IU.slice?AU:t},OU=r(NU);function PU(e,t,n,r,i){var o,a,s,c={};return oU(o=cU(r)).call(o,function(e){c[e]=r[e]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=lU(a=dU(s=OU(n).call(n)).call(s)).call(a,function(n,r){return r(e,t,n)||n},c),i&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(i):void 0,c.initializer=void 0),void 0===c.initializer?(ES(e,t,c),null):c}let kU=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),DU=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),xU=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e[e.REQ_DOWNGRADE_FALLBACK=27]="REQ_DOWNGRADE_FALLBACK",e}({}),LU=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),MU=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.K_VOS_FALLBACK=30]="K_VOS_FALLBACK",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),UU=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),FU=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.DATACHANNEL_PRECONNECT="datachannel_preconnect",e.DATACHANNEL_CONNECTING="datachannel_connecting",e.DATACHANNEL_FAILBACK="datachannel_failback",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e.RECOVER_NOTIFICATION="recover_notification",e.VOS_FALLBACK="vos_fallback",e.VOS_FALLBACK_PROMISE="vos_fallback_promise",e}({}),jU=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SET_DUAL_STREAM_MODE="set_dual_stream_mode",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.CONFIGURE="configure",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e.DOWNGRADE_CODEC="downgrade_codec",e}({}),VU=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),BU=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e.ENABLE_MULTI_STREAM="enable_multi_stream",e}({}),WU=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),HU=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e.ON_FALLBACK="websocket:on_fallback",e}({});function GU(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw nk.error("Invalid Channel Name ".concat(e)),new uk(hN.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function zU(e){if(!("number"==typeof(t=e)&&Math.floor(t)===t&&0<=t&&t<=4294967295||yN(e,1,255)))throw new uk(hN.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;"string"==typeof e&&nk.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let KU=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const YU={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},qU={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function XU(e,t){vN(e.url,"".concat(t,".url"),1,1e3,!1),EN(e.x)||gN(e.x,"".concat(t,".x"),0,1e4),EN(e.y)||gN(e.y,"".concat(t,".y"),0,1e4),EN(e.width)||gN(e.width,"".concat(t,".width"),0,1e4),EN(e.height)||gN(e.height,"".concat(t,".height"),0,1e4),EN(e.zOrder)||gN(e.zOrder,"".concat(t,".zOrder"),0,255),EN(e.alpha)||gN(e.alpha,"".concat(t,".alpha"),0,1,!1)}const JU={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let ZU=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),QU=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),$U=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function eF(e){if(!e.channelName)throw new uk(hN.INVALID_PARAMS,"invalid channelName in info");if("number"!=typeof e.uid)throw new uk(hN.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&vN(e.token,"info.token",1,2047),zU(e.uid),GU(e.channelName),!0}let tF=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),nF=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),rF=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),iF=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),oF=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),aF=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e.UPDATE_GATEWAY_CONFIG="update-gateway-config",e.VOS_FALLBACK="vos-fallback",e.VOS_FALLBACK_PROMISE="vos-fallback-promise",e.RESET_SIGNAL="reset-signal",e.DATACHANNEL_FAILBACK="datachannel-failback",e}({}),sF=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),cF=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),lF=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const dF=[lF.AFRICA,lF.ASIA,lF.CHINA,lF.EUROPE,lF.GLOBAL,lF.INDIA,lF.JAPAN,lF.NORTH_AMERICA,lF.OCEANIA,lF.OVERSEA,lF.SOUTH_AMERICA];let uF=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const hF={CHINA:{},ASIA:{CODE:uF.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:uF.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:uF.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:uF.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:uF.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:uF.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:uF.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:uF.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:uF.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:uF.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:uF.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:uF.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:uF.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};pP&&(hF.CHINA={CODE:uF.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let pF=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",e.UPDATE_REMOTE_VIDEO_STREAM_TYPE="update_remote_video_stream_type",e.FALLBACK_TO_HLS="fallback_to_hls",e.UPDATE_VOS_CONFIGURE="update_vos_configure",e}({});function mF(e){return!!e&&!(!e.uplink||!e.id)&&void 0!==e.uplink.max_bitrate&&void 0!==e.uplink.min_bitrate}class fF extends ON{constructor(e,t){super(),nR(this,"onICEConnectionStateChange",void 0),nR(this,"onConnectionStateChange",void 0),nR(this,"onDTLSTransportStateChange",void 0),nR(this,"onDTLSTransportError",void 0),nR(this,"onICETransportStateChange",void 0),nR(this,"onFirstAudioReceived",void 0),nR(this,"onFirstVideoReceived",void 0),nR(this,"onFirstAudioDecoded",void 0),nR(this,"onFirstVideoDecoded",void 0),nR(this,"onFirstVideoRender",void 0),nR(this,"onFirstVideoBufferReady",void 0),nR(this,"onFirstVideoDecodedTimeout",void 0),nR(this,"onSelectedLocalCandidateChanged",void 0),nR(this,"onSelectedRemoteCandidateChanged",void 0),nR(this,"onICECandidateError",void 0),nR(this,"getLocalVideoStats",void 0)}}class gF extends fF{constructor(e,t){super(e,t),nR(this,"establishPromise",void 0)}}let _F=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),vF=function(e){return e.UDP_RELAY="udp_relay",e.UDP_TCP_RELAY="udp_tcp_relay",e.TCP_RELAY="tcp_relay",e.RELAY="relay",e}({}),bF=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.TCP_RESTART=3]="TCP_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({});const EF=["disconnected","failed"];let yF=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),SF=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),TF=function(e){return e.AudioMetadata="audioMetadata",e.AudioPts="audioPts",e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e.FirstVideoPreRender="FirstVideoPreRender",e.FirstVideoBufferReady="FirstVideoBufferReady",e}({}),CF=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),wF=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),RF=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),AF=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e}({}),IF=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),NF=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),OF=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),PF=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),kF=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),DF=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),xF=function(e){return e.ABORT="abort",e}({}),LF=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),MF=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const UF={[kU.ACCESS_POINT]:{[LU.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[LU.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[LU.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[LU.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[LU.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[LU.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[LU.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[kU.UNILBS]:{[xU.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[xU.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[xU.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[xU.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[xU.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[xU.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[xU.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[xU.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[xU.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[xU.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[xU.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[xU.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1},[xU.REQ_DOWNGRADE_FALLBACK]:{desc:"request downgrade fallback",retry:!1}},[kU.STRING_UID_ALLOCATOR]:{[DU.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[DU.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[DU.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function FF(e){const t=UF[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};const n=t[e%1e4];if(!n){if(Math.floor(e/1e4)===kU.ACCESS_POINT){const t=e%1e4;if("1"===t.toString()[0])return{desc:e.toString(),retry:!1};if("2"===t.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return n}const jF={[MU.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[MU.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[MU.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[MU.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[MU.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[MU.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[MU.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[MU.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[MU.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[MU.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[MU.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[MU.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[MU.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[MU.K_VOS_FALLBACK]:{desc:"K_VOS_FALLBACK",action:"tryNext"},[MU.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[MU.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[MU.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[MU.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[MU.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[MU.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[MU.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[MU.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[MU.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[MU.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[MU.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[MU.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[MU.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[MU.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[MU.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[MU.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[MU.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[MU.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[MU.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[MU.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[MU.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[MU.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[MU.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[MU.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[MU.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[MU.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[MU.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[MU.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[MU.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[MU.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[MU.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[MU.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[MU.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[MU.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[MU.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[MU.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[MU.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[MU.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[MU.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[MU.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[MU.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[MU.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[MU.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[MU.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[MU.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[MU.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[MU.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[MU.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[MU.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[MU.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[MU.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function VF(e){return jF[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function BF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function WF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BF(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BF(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function HF(e,t){if("string"==typeof e)return e;const{proxy:n,host:r,port:i}=e;if(t){const e=SP("JOIN_GATEWAY_FALLBACK_PORT")||443;return 443===e?"wss://".concat(r,"/ws/?p=").concat(Number(i)+150):"wss://".concat(r,":").concat(e,"/ws/?p=").concat(Number(i)+150)}return n?"wss://".concat(n,"/ws/?h=").concat(r,"&p=").concat(i):"wss://".concat(r,":").concat(i)}const GF=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,zF=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,KF=/wss:\/\/(.+):([0-9]+)\/?/,YF=/wss:\/\/(.[^\/]+)\/?/;let qF=0;class XF{constructor(e,t){nR(this,"id",0),nR(this,"store",void 0),nR(this,"recordIndex",void 0),nR(this,"websockets",[]),nR(this,"try443PortDuration",2e3),nR(this,"forceCloseWSDuration",5e3),nR(this,"try443PortTimeout",null),nR(this,"forceCloseTimeout",null),nR(this,"isTry443PortFailed",!1),nR(this,"isNormalPortFailed",!1),nR(this,"useDoubleDomain",!1),nR(this,"useProxy",!1),nR(this,"startTime",Date.now()),this.id=++qF,this.try443PortDuration=SP("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=e||5e3,this.store=t}closeAllWebsockets(){this.websockets.forEach(e=>{e.onopen=null,e.onclose=null,e.onmessage=null,e.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var e;const t=Date.now()-this.startTime;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];nk.debug("[choose-best-ws ".concat(null===(e=this.store)||void 0===e?void 0:e.clientId," ").concat(this.id,"] ").concat(t,"ms:"),...r)}createWebSocket(e,t,n){this.logger("createWebSocket:",e,{isTry443Port:t,hasTimeoutDetection:n});const r=SP("GATEWAY_DOMAINS"),i=Date.now(),o=[],a=r.find(t=>{var n;return xr(n=e.host).call(n,t)});a||(this.useDoubleDomain=!1);const s=[];if(this.useDoubleDomain)r.forEach(n=>{s.push(HF(WF(WF({},e),{},{host:e.host.replace(a,n)}),t))});else{const n=WF({},e);if(t&&a){const e=r.find(e=>e!==a);e&&(n.host=n.host.replace(a,e))}s.push(HF(n,t))}try{s.forEach(e=>{const t=new WebSocket(e);t.binaryType="arraybuffer",o.push(t),this.logger("ws is connecting:",t.url)})}catch(r){if(this.logger("ws create failed"),o.forEach(e=>e.close()),o.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(e,t,n);if(!t&&443!==Number(e.port))return this.createWebSocket(e,!0,n);throw new uk(hN.WS_ERR,"init websocket failed! Error: ".concat(r.toString()))}const c=SI();this.store&&this.store.recordJoinChannelService({urls:o.map(e=>e.url),service:"gateway"},this.recordIndex),o.forEach(e=>{e.onopen=()=>{this.logger("onopen: ws ".concat(e.url," open cost ").concat(Date.now()-i,"ms")),this.websockets.forEach(t=>{t!==e&&(t.onopen=null,t.onclose=null,t.onmessage=null,t.close(),this.logger("close backup websocket: ".concat(t.url)))}),this.websockets.length=0,c.resolve(e)},e.onclose=n=>{this.logger("onclose: ws ".concat(e.url," closed cost ").concat(Date.now()-i,"ms state: ").concat(e.readyState));const r=o.every(e=>e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING);this.logger("".concat(t?"443":"47xx"," websocket closed, all failed: ").concat(r)),r&&(t||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(n.reason)),c.reject({code:n.code,reason:sF.A_ROUND_WS_FAILED})):!t&&r&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),d()),t?this.isTry443PortFailed=r:this.isNormalPortFailed=r},e.onmessage=t=>this.logger("".concat(e.url," onmessage: ").concat(t.data))}),this.websockets.push(...o);const l=()=>{this.websockets.forEach(e=>e.readyState!==WebSocket.OPEN&&e.close())},d=()=>{if(c.isResolved)return l();PI().os===RI.MAC_OS&&VI()&&l(),this.createWebSocket(e,!0,!0).then(e=>{c.resolve(e)}).catch(e=>{this.isNormalPortFailed&&c.reject(e),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",c.isResolved),this.forceCloseTimeout=null,l()},this.forceCloseWSDuration)};return n||(()=>{if(t||this.useProxy)return this.logger("add 5s timeout at ".concat(t?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,l()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",c.isResolved),this.try443PortTimeout=null,d()},this.try443PortDuration)})(),c.promise}chooseBestWebsocket(e,t,n,r){return this.useDoubleDomain=!!t,"string"==typeof e&&(e=function(e){let t,n,r;return[,t,n,r]=e.match(GF)||[],t||([,n,r]=e.match(zF)||[]),n&&r||([,n,r]=e.match(KF)||[]),n&&r||([,n]=e.match(YF)||[]),n||nk.warning("un-destructible url: ",e),{proxy:t,host:n,port:r||"443"}}(e)),this.recordIndex=r,this.useProxy=!!e.proxy,n&&this.useProxy&&(nk.warn("cannot use 443 only when use proxy"),n=!1),this.createWebSocket(e,!!n,!1).finally(()=>this.clearTimeout())}}function JF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}class ZF extends ON{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;xr(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(HU.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(HU.CONNECTED):"closed"===this._state?this.emit(HU.CLOSED):"failed"===this._state&&this.emit(HU.FAILED))}resetReconnectCount(e){nk.debug("websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;super(),nR(this,"_websocketUrl",null),nR(this,"connectionID",0),nR(this,"currentURLIndex",0),nR(this,"urls",[]),nR(this,"_reconnectMode","tryNext"),nR(this,"reconnectReason",void 0),nR(this,"_initMutex",void 0),nR(this,"name",void 0),nR(this,"_state","closed"),nR(this,"reconnectInterrupter",void 0),nR(this,"websocket",void 0),nR(this,"retryConfig",void 0),nR(this,"reconnectCount",0),nR(this,"forceCloseTimeout",5e3),nR(this,"onlineReconnectListener",void 0),nR(this,"useCompress",void 0),nR(this,"tryDoubleDomain",!1),nR(this,"use443PortOnly",!1),nR(this,"wsInflateLength",0),nR(this,"wsDeflateLength",0),nR(this,"closeEstablishingWs",()=>{}),nR(this,"store",void 0),nR(this,"joinGatewayRecordIndex",void 0),this.store=o,this.name=e,this.retryConfig=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JF(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JF(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t),this.useCompress=n,this.tryDoubleDomain=r,this.use443PortOnly=i,this._initMutex=new kO("websocket",o?o.clientId:void 0);const{timeout:a,timeoutFactor:s}=t,c=Math.max(300,Math.floor(3*a/5)),l=Math.max(1.2,Math.floor(8*s)/10);zN.ONLINE&&(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l),ZN.on(KN.NETWORK_STATE_CHANGE,(e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===zN.ONLINE?(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=l):(this.retryConfig.timeout=a,this.retryConfig.timeoutFactor=s))})}getConnection(){return this.websocket||void 0}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=t,this.urls=e,this.state="connecting";try{var r;const e=SI(),t=this.urls[this.currentURLIndex];null===(r=this.store)||void 0===r||r.beforeConnect(),function(e){return!(fk()||SP("USE_NEW_TOKEN")||!SP("ENABLE_PREALLOC_PC")&&(null==e||!e.autoSubscribe||SP("FORCE_DISABLE_AUTO_SUB")))}(this.store)&&this.emit(IF.PRE_CONNECT_PC),this.createWebSocketConnection(t).then(e.resolve).catch(e.reject),this.once(HU.CLOSED,()=>{e.reject(new pN(hN.WS_DISCONNECT))}),this.once(HU.CONNECTED,e.resolve),await e.promise}catch(e){}finally{n()}}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const e=this.websocket;t?setTimeout(()=>e.close(),500):e.close(),this.websocket=void 0,this._websocketUrl=null}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return void nk.warning("[".concat(this.name,"] can not reconnect, no websocket"));void 0!==e&&(this.reconnectMode=e),nk.debug("[".concat(this.name,"] reconnect is triggered initiative")),"number"==typeof this.joinGatewayRecordIndex&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(t)]},this.joinGatewayRecordIndex);const n=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),n&&n.bind(this.websocket)({code:9999,reason:t})}sendMessage(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new pN(hN.WS_ABORT,"websocket is not ready");try{t||(e=JSON.stringify(e)),this.websocket.send(e)}catch(e){throw new pN(hN.WS_ERR,"send websocket message error"+e.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e){var t;const n=SI();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const r=e=>{var t;null===(t=this.store)||void 0===t||t.signalChannelOpen(),nk.debug("[".concat(this.name,"] websocket opened:"),e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),n.resolve()},i=async e=>{var t;if(nk.debug("[".concat(this.name,"] websocket close ").concat(null===(t=this.websocket)||void 0===t?void 0:t.url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)n.reject(new pN(hN.WS_DISCONNECT,"websocket close: ".concat(e.code))),this.close();else{"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const t=XN(this,HU.WILL_RECONNECT,this.reconnectMode,e.reason)||this.reconnectMode,r=await this.reconnectWithAction(t);if("closed"===this.state)return void nk.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!r)return n.reject(new pN(hN.WS_DISCONNECT,"websocket reconnect failed: ".concat(e.code))),this.close(!0);n.resolve()}},o=e=>{this.emit(HU.ON_MESSAGE,e)},a=e=>{nk.warn("[".concat(this.connectionID,"] ws open error ").concat(e))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),SP("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=SP("GATEWAY_WSS_ADDRESS")),nk.debug("[".concat(this.name,"] start connect, url:"),e);const s=null===(t=this.store)||void 0===t?void 0:t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var c;this._websocketUrl=HF(e);const t=await this.chooseBestWebsocketConnection(e);this.websocket=t,r&&r(this.websocket.url),this.websocket.onclose=i,this.websocket.onmessage=o,this.websocket.onerror=a,null===(c=this.store)||void 0===c||c.recordJoinChannelService({endTs:Date.now(),status:"success"},s),this.joinGatewayRecordIndex=s}catch(e){const t="closed"===this.state,r=e instanceof pN,o=r&&e.code===hN.WS_ABORT,a=r&&e.code===hN.WS_ERR,c=r?e.message:e&&(e.reason||e.toString());nk.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(c)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:o?"aborted":"error",errors:[e]},s),t||a?(n.reject(t?new pN(hN.WS_DISCONNECT,"websocket is closed: ".concat(c)):new pN(hN.WS_ERR,"init websocket failed: ".concat(c))),a&&nk.error("[".concat(this.name,"] init websocket failed: ").concat(c))):i&&i(e)}return n.promise}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount)return!1;if(0===this.urls.length)return!1;if("closed"===this.state)return!1;nk.warning("[choose-best-ws] action: =>",e),this.onlineReconnectListener||ZN.isOnline||!ZN.onlineWaiter||(this.onlineReconnectListener=ZN.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let n=!0;if(this.reconnectInterrupter=()=>n=!1,t){const t=LO(this.reconnectCount,this.retryConfig);nk.debug("[".concat(this.name,"] wait ").concat(t,"ms to reconnect websocket, mode: ").concat(e)),await ip.race([_O(t),this.onlineReconnectListener||new ip(()=>{})])}if("closed"===this._state||!n)return!1;this.reconnectCount+=1;const r=async(e,t)=>{this.emit(HU.RECONNECT_CREATE_CONNECTION,t),await this.createWebSocketConnection(e)};try{if("retry"===e)await r(this.urls[this.currentURLIndex],e);else if("tryNext"===e){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);nk.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await r(this.urls[this.currentURLIndex],e)}else"recover"===e&&(nk.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await YN(this,HU.REQUEST_NEW_URLS),this.currentURLIndex=0,await r(this.urls[this.currentURLIndex],e))}catch(n){var i;nk.error("[".concat(this.name,"] reconnect failed ").concat(n&&n.toString()));const r=null==n||null===(i=n.data)||void 0===i?void 0:i.desc;if(Array.isArray(r)){if(xr(r).call(r,"dynamic key expired"))return this.emit(HU.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1;if(xr(r).call(r,"request downgrade fallback"))return this.emit(HU.ON_FALLBACK),!1}return this.reconnectWithAction(e,t)}return!0}}class QF extends ZF{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){const n=SI(),r=function(e,t){return new XF(e,t)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{nk.debug("[choose-best-ws] close establishing websockets"),r.closeAllWebsockets(),n.reject(new pN(hN.WS_ABORT,"choose best websocket aborted"))};const i=SP("GATEWAY_DOMAINS");return nk.debug("[choose-best-ws] currentDomain: ",e,", domains: ",i,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),r.chooseBestWebsocket(e,this.tryDoubleDomain,this.use443PortOnly,t).then(n.resolve).catch(n.reject),n.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class $F extends ZF{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){return new ip((n,r)=>{let i=!1;const o=[];this.closeEstablishingWs=()=>{nk.debug("[choose-best-ws] close establishing websockets"),o.forEach(e=>{e.onclose=null,e.onopen=null,e.onmessage=null,e.close()}),r(new pN(hN.WS_ABORT,"choose best websocket aborted"))};const a=SP("GATEWAY_DOMAINS");let s;const c=e.indexOf("?h="),l=a.find(t=>-1!==c?xr(e).call(e,t,c):xr(e).call(e,t));nk.debug("[choose-best-ws] currentDomain: ",l,", domains: ",a);let d=!this.tryDoubleDomain||!l;if(!d&&l){var u;const h=Date.now();try{a.forEach(t=>{const n=-1===c?e.replace(l,t):e.substr(0,c)+e.substr(c).replace(l,t),r=new WebSocket(n);r.binaryType="arraybuffer",o.push(r),nk.debug("[choose-best-ws] ws is connecting:",r.url)})}catch(e){for(nk.debug("[choose-best-ws] ws create failed, fallback to single url"),o.forEach(e=>e.close());o.length;)o.pop();d=!0}null===(u=this.store)||void 0===u||u.recordJoinChannelService({urls:o.map(e=>e.url),service:"gateway"},t),o.forEach(e=>{e.onopen=()=>{if(i)return;const t=Date.now()-h;nk.debug("[choose-best-ws] ws open cost ".concat(t,"ms")),o.filter(t=>t!==e).forEach(e=>{nk.debug("[choose-best-ws]close backup websocket: ".concat(e.url)),e.close()}),i=!0,n(e)},e.onclose=e=>{s=e,i||o.find(e=>!(e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING))||(nk.debug("[choose-best-ws] all websocket is closed"),i=!0,r(s))},e.onmessage=t=>{nk.debug("[choose-best-ws]".concat(e.url," onmessage: ").concat(t.data))}}),_O(this.forceCloseTimeout).then(()=>{o.forEach(e=>{e.readyState!==WebSocket.OPEN&&e.close()})})}if(d){var h;let i;nk.debug("[choose-best-ws] use single url: ",e),null===(h=this.store)||void 0===h||h.recordJoinChannelService({urls:[e],service:"gateway"},t);try{i=new WebSocket(e),o.push(i),i.binaryType="arraybuffer"}catch(e){const n=new pN(hN.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return nk.error("[".concat(this.name,"]").concat(n)),void r(n)}i.onopen=()=>{n(i)},i.onclose=e=>{r(e)},i.onmessage=e=>{nk.debug("[choose-best-ws]".concat(i.url," onmessage: ").concat(e.data))},_O(this.forceCloseTimeout).then(()=>{i&&i.readyState!==WebSocket.OPEN&&i.close()})}}).then(e=>(this.closeEstablishingWs=void 0,e)).catch(e=>{throw this.closeEstablishingWs=void 0,e})}}class ej extends ON{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===UU.CONNECTED?this.emit(FU.WS_CONNECTED):e===UU.RECONNECTING?this.emit(FU.WS_RECONNECTING,this._websocketReconnectReason):e===UU.CLOSED&&this.emit(FU.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),nR(this,"__name__","AgoraRTCSignal"),nR(this,"_disconnectedReason",void 0),nR(this,"_websocketReconnectReason",void 0),nR(this,"_connectionState",UU.CLOSED),nR(this,"reconnectToken",void 0),nR(this,"websocket",void 0),nR(this,"openConnectionTime",void 0),nR(this,"clientId",void 0),nR(this,"lastMsgTime",Date.now()),nR(this,"uploadCache",[]),nR(this,"uploadCacheInterval",void 0),nR(this,"rttRolling",new FO(5)),nR(this,"pingpongTimer",void 0),nR(this,"wsInflateDataTimer",void 0),nR(this,"pingpongTimeoutCount",0),nR(this,"ortc",void 0),nR(this,"joinResponse",void 0),nR(this,"multiIpOption",void 0),nR(this,"initError",void 0),nR(this,"spec",void 0),nR(this,"store",void 0),nR(this,"onWebsocketMessage",e=>{if(e.data instanceof ArrayBuffer)return void this.emit(FU.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){if(this.emit(t._type,t._message),t._type===BU.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===BU.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(UN.UID_BANNED);break;case 15:this.close(UN.IP_BANNED);break;case 16:this.close(UN.CHANNEL_BANNED)}if(t._type===BU.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case MU.ERR_LICENSE_MISSING:this.close(UN.LICENSE_MISSING);break;case MU.ERR_LICENSE_EXPIRED:this.close(UN.LICENSE_EXPIRED);break;case MU.ERR_LICENSE_MINUTES_EXCEEDED:this.close(UN.LICENSE_MINUTES_EXCEEDED);break;case MU.ERR_LICENSE_PERIOD_INVALID:this.close(UN.LICENSE_PERIOD_INVALID);break;case MU.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(UN.LICENSE_MULTIPLE_SDK_SERVICE);break;case MU.ERR_LICENSE_ILLEGAL:this.close(UN.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new QF("gateway-".concat(this.clientId),this.spec.retryConfig,!0,SP("JOIN_GATEWAY_USE_DUAL_DOMAIN"),SP("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===UU.CONNECTED&&this.reconnect("retry",GN.OFFLINE)})}async request(e,t,n,r){const i=vO(6,""),o={_id:i,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new ip((t,n)=>{if(this.connectionState===UU.CONNECTED)return t();const r=()=>{this.off(FU.WS_CLOSED,i),t()},i=()=>{this.off(FU.WS_CONNECTED,r),n(new uk(hN.WS_ABORT))};this.once(FU.WS_CONNECTED,r),this.once(FU.WS_CLOSED,i),e!==jU.PUBLISH&&e!==jU.PUBLISH_DATASTREAM&&e!==jU.SUBSCRIBE&&e!==jU.SUBSCRIBE_DATASTREAM&&e!==jU.UNSUBSCRIBE&&e!==jU.UNSUBSCRIBE_DATASTREAM&&e!==jU.UNPUBLISH&&e!==jU.UNPUBLISH_DATASTREAM&&e!==jU.CONTROL&&e!==jU.RESTART_ICE||this.once(FU.DISCONNECT_P2P,()=>{n(new uk(hN.DISCONNECT_P2P))}),e!==jU.PUBLISH&&e!==jU.RESTART_ICE||this.once(FU.ABORT_P2P_EXECUTION,()=>{n(new uk(hN.DISCONNECT_P2P))})});if(this.connectionState!==UU.CONNECTING&&this.connectionState!==UU.RECONNECTING||e===jU.JOIN||e===jU.REJOIN||await s(),this.websocket.sendMessage(o,!0),r)return;const c=new ip((n,r)=>{let o=!1;const s=(r,i)=>{o=!0,n({isSuccess:"success"===r,message:i||{}}),this.off(FU.WS_CLOSED,c),this.off(FU.WS_RECONNECTING,c),this.emit(FU.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),s);const c=()=>{r(new uk(hN.WS_ABORT,"type: ".concat(e))),this.off(FU.WS_CLOSED,c),this.off(FU.WS_RECONNECTING,c),this.off("res-@".concat(i),s)};this.once(FU.WS_CLOSED,c),this.once(FU.WS_RECONNECTING,c),_O(SP("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==a||o||(nk.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(FU.REQUEST_TIMEOUT,e,t))})});let l=null;try{l=await c}catch(r){if(this.connectionState===UU.CLOSED||e===jU.LEAVE)throw new uk(hN.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===jU.JOIN||e===jU.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const d=Number(l.message.error_code||l.message.code),u=VF(d),h=new uk(hN.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message,desc:u.desc});return"success"===u.action?l.message:(nk.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===MU.ERR_TOO_MANY_BROADCASTERS?e===jU.JOIN||e===jU.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===u.action?h.throw():"quit"===u.action?(this.initError=h,this.close(),h.throw()):(d===MU.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,nk.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",GN.MULTI_IP)):this.reconnect(u.action,GN.SERVER_ERROR),e===jU.JOIN||e===jU.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new ip(n=>{const r=i=>{(!t||t(i))&&(this.off(e,r),n(i))};this.on(e,r)})}uploadWRTCStats(e){if(!this.store.sessionId)return void nk.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(VU.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=SP("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==UU.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)},SP("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ip((t,n)=>{this.once(FU.WS_CONNECTED,()=>t(this.joinResponse)),this.once(FU.WS_CLOSED,e=>n(this.initError||new uk(hN.WS_ABORT,e))),this.connectionState=UU.CONNECTING,this.websocket.init(e).catch(n),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||UN.LEAVE,this.connectionState=UU.CLOSED,nk.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(FU.ABORT_P2P_EXECUTION),this.store.signalConnected();const e=await YN(this,FU.REQUEST_JOIN_INFO);this.store.joinReq();const t=await this.request(jU.JOIN,e);if(this.ortc=null==e?void 0:e.ortc,this.store.joinRep(),!t)return this.emit(FU.REPORT_JOIN_GATEWAY,sF.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(FU.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=UU.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new uk(hN.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=JN(this,FU.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(jU.REJOIN,e);return!!t&&(this.connectionState=UU.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach(e=>{this.emit(BU.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(BU.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(BU.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(BU.MUTE_AUDIO,{uid:e.uid}):this.emit(BU.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(BU.MUTE_VIDEO,{uid:e.uid}):this.emit(BU.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(BU.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(BU.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(BU.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(BU.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(BU.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})}),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}async downgradeCodec(e){if(!this.ortc)return!1;const t={downgrade_codec:e,ortc:this.ortc};return!!await this.request(jU.DOWNGRADE_CODEC,t)}handleNotification(e){nk.debug("[".concat(this.clientId,"] receive notification: "),e);const t=VF(e.code);if(28===e.code&&"detail"in e&&(nk.info("[".concat(this.clientId,"] receive recover notification: "),e.detail),this.emit(FU.RECOVER_NOTIFICATION,e.detail)),"success"!==t.action){if("failed"!==t.action)return"quit"===t.action?e.code===MU.ERR_REPEAT_JOIN_CHANNEL&&SP("IGNORE_UID_CHECK")?void this.close(UN.UID_CONFLICT):("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(UN.UID_BANNED),void this.close()):e.code===MU.K_VOS_FALLBACK&&"detail"in e?(nk.info("[".concat(this.clientId,"] receive vos fallback notification: "),e.detail),"FALLBACKCN"===e.detail&&SP("ENABLE_QUALITY_FALLBACK")?void YN(this,FU.VOS_FALLBACK_PROMISE,e.detail).then(()=>{this.reconnect("recover",t.desc)}).catch(e=>{nk.debug("[".concat(this.clientId,"] cancel vos fallback cn, error: "),e)}):"fallback_hls"===e.detail&&SP("ENABLE_FALLBACK_TO_HLS")?(this.emit(FU.VOS_FALLBACK,e.detail),void this.close(UN.FALLBACK_TO_HLS)):this.reconnect(t.action,t.desc)):void this.reconnect(t.action,GN.SERVER_ERROR);nk.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=SP("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(nk.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>SP("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",GN.TIMEOUT):this.request(jU.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),SP("REPORT_STATS")&&this.send(jU.PING_BACK,{pingpongElapse:e})}).catch(e=>{})}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(VU.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(HU.RECONNECT_CREATE_CONNECTION,e=>{this.emit(FU.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(HU.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(HU.CLOSED,()=>{this.connectionState=UU.CLOSED}),this.websocket.on(HU.FAILED,()=>{this._disconnectedReason=UN.NETWORK_ERROR,this.connectionState=UU.CLOSED}),this.websocket.on(HU.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===UU.CONNECTED?this.connectionState=UU.RECONNECTING:this.connectionState=UU.CONNECTING}),this.websocket.on(HU.WILL_RECONNECT,(e,t,n)=>{const r=JN(this,FU.IS_P2P_DISCONNECTED),i=r||"retry"!==e;r&&"retry"===e&&(nk.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),e="tryNext",t=sF.P2P_DISCONNECTED),i&&(nk.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(e)),this.emit(FU.REPORT_JOIN_GATEWAY,t||sF.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(FU.DISCONNECT_P2P)),n(e)}),this.websocket.on(HU.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{nk.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",GN.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(FU.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof uk){if(e.code===hN.UNEXPECTED_RESPONSE&&e.data.code===MU.ERR_NO_AUTHORIZED)return this.initError=new uk(hN.TOKEN_EXPIRE,"dynamic key expired"),void this.close(UN.TOKEN_EXPIRE);nk.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",GN.SERVER_ERROR):(this.initError=e,this.close())}})}),this.websocket.on(HU.REQUEST_NEW_URLS,(e,t)=>{YN(this,FU.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)}),this.websocket.on(HU.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(BU.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(IF.PRE_CONNECT_PC,()=>{this.emit(FU.PRE_CONNECT_PC)}),this.websocket.on(HU.ON_FALLBACK,()=>{SP("ENABLE_FALLBACK_TO_HLS")&&this.emit(FU.VOS_FALLBACK,"fallback_hls")})}}let tj=function(e){return e.NATIVE_RTC="native_rtc",e.NATIVE_RTM="native_rtm",e.WEB_RTC="web_rtc",e.WEB_RTM="web_rtm",e}({}),nj=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function rj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ij(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rj(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rj(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let oj=0;function aj(e){const t=SP("TURN_DOMAINS");oj=(oj+1)%t.length;const n=t[oj]||"edge.agora.io";return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(n):(nk.debug("Cannot recognized as ip address: ".concat(e,", use as host2")),e)}function sj(e){try{const t=SP("TURN_DOMAINS"),n=SP("GATEWAY_DOMAINS").concat(t).find(t=>xr(e).call(e,t));return n?e.split(".".concat(n))[0].replace(/-/g,"."):e}catch(t){return nk.debug("serverUrlToIp error, fallback to url",e),e}}function cj(e,t){e.addresses||(e.addresses=[]);const n=function(e,t){if(SP("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return e.map(e=>{let{ip:t,port:n}=e;return{address:"".concat(t,":").concat(n)}});const n=SP("GATEWAY_DOMAINS");let r=n[1]&&xr(t).call(t,n[1])?1:0;return e.map(e=>{let{domain_prefix:t,port:i,ip:o}=e;if(t)return{address:"".concat(t,".").concat(n[r++%n.length],":").concat(i)};const a=/^[\.\:\d]+$/.test(o),s=a?"".concat(o.replace(/[^\d]/g,"-"),".").concat(n[r++%n.length],":").concat(i):"".concat(o,":").concat(i);return a||nk.debug("Cannot recognized as ip address: ".concat(o,", use as host3")),{ip:o,port:i,address:s}})}(e.addresses,t),r=Array.isArray(e.detail)&&e.detail[18];if(r&&"string"==typeof r){const e=r.split(";");for(let t=0;t<e.length;t++){var i;const r=xb(i=e[t]).call(i);n[t]&&r&&(n[t].ip6=r)}}const o=e.detail&&e.detail.candidate;let a;if(o){const[e,t]=o.split(":");e&&t&&(a={port:Number(t),ip:e,address:"".concat(e,":").concat(t)})}return{gatewayAddrs:n,apGatewayAddress:a,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function lj(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function dj(e){const t=e._encoderConfig;if(!t)return{};const n={resolution:t.width&&t.height?"".concat(lj(t.width),"x").concat(lj(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return"number"==typeof t.frameRate?(n.maxFrameRate=t.frameRate,n.minFrameRate=t.frameRate):t.frameRate&&(n.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,n.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),n}function uj(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function hj(e,t){let n,r,i;switch(t){case nj.CHOOSE_SERVER:r=4096,i="choose server";break;case nj.CLOUD_PROXY:r=1048576,i="proxy";break;case nj.CLOUD_PROXY_5:r=4194304,i="proxy5";break;case nj.CLOUD_PROXY_FALLBACK:r=4194310,i="proxy fallback";break;default:throw new uk(hN.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(t=>{t.buffer&&t.buffer.flag===r&&(n={code:t.buffer.code,addresses:(t.buffer.edges_services||[]).map(e=>ij(ij({},e),{},{ticket:t.buffer.cert})),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:ij(ij({},t.buffer.detail),e.detail),flag:t.buffer.flag,opid:e.opid,cert:t.buffer.cert})}),!n)throw new uk(hN.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(i," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return n}async function pj(e,t){return await ip.all(e.addresses.map(async e=>({address:aj(e.ip),tcpport:e.port,udpport:e.port,username:t&&SP("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():fP.username,password:t&&SP("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await NN(t.toString()):fP.password})))}function mj(e,t){const n=t.getMediaStreamTrack(!0).getSettings(),r=t.videoHeight||n.height,i=t.videoWidth||n.width;return r&&i?Math.max(Math.min(r,i)/Math.min(lj(e.height),lj(e.width)),1):(nk.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function fj(e){let{candidateType:t,relayProtocol:n,type:r,address:i,port:o,protocol:a}=e;const s={candidateType:t,relayProtocol:n,protocol:a};if("local-candidate"!==r){const e=i.split(".");e.length>=4&&(e[1]="*",e[2]="*"),s.address=e.join("."),s.port=o}return s}function gj(e){const t=e.split(":"),n=e.split(/[-.]/),r=xr(e).call(e,"-")?"-":".";let i=e;return t.length>1?n.length>1?(n[1]="**",i=n[0]+r+"**:"+t[t.length-1]):i=t.length>2?t[0]+r+"**:"+t[t.length-1]:"**:"+t[t.length-1]:n.length>1&&(i=n[0]+r+"**"),i}function _j(e,t){return e.getTransceivers().find(e=>e.sender.track===t||e.receiver.track===t)}function vj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SP("SVC_MODE");if(SP("ENABLE_SVC"))return function(e){return e in nP}(e)?e:nP.L1T3}const bj={[_F.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[_F.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function Ej(e){e.send&&(Tj(_F.VIDEO,e.send.videoExtensions),Tj(_F.AUDIO,e.send.audioExtensions)),e.recv&&(Tj(_F.VIDEO,e.recv.videoExtensions),Tj(_F.AUDIO,e.recv.audioExtensions)),e.sendrecv&&(Tj(_F.VIDEO,e.sendrecv.videoExtensions),Tj(_F.AUDIO,e.sendrecv.audioExtensions))}function yj(e,t){e.send&&(Sj(_F.VIDEO,e.send.videoExtensions,t.send.videoExtensions),Sj(_F.AUDIO,e.send.audioExtensions,t.send.audioExtensions)),e.recv&&(Sj(_F.VIDEO,e.recv.videoExtensions,t.recv.videoExtensions),Sj(_F.AUDIO,e.recv.audioExtensions,t.recv.audioExtensions))}function Sj(e,t,n){t.forEach(t=>{var r;const i=bj[e].find(e=>{var n;let{key:r}=e;return xr(n=t.extensionName).call(n,r)});if(!i)return;const o=n.find(e=>{let{extensionName:t}=e;return xr(t).call(t,i.key)});o&&xr(r=o.extensionName).call(r,"gdpr_forbidden")&&(t.extensionName=o.extensionName)})}function Tj(e,t){t.forEach(t=>{var n;const r=bj[e].find(e=>{var n;let{key:r}=e;return xr(n=t.extensionName).call(n,r)});xr(n=t.extensionName).call(n,"gdpr_forbidden")&&r&&(t.extensionName=r.extensionName)})}function Cj(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e||xr(e).call(e,"abs-send-time")}function wj(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e||xr(e).call(e,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function Rj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Aj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rj(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rj(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ij(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const{filterRTX:i,filterVideoFec:o,filterAudioFec:a,filterAudioCodec:s,filterVideoCodec:c,unsupportedVideoUplinkCodec:l,unsupportedVideoDownlinkCodec:d}=t,{useXR:u}=n;let h=[],p=[],m=[],f=[],g=!1,_=!1;if(DP(e).mediaDescriptions.forEach(e=>{r&&r!==e.attributes.direction||("video"!==e.media.mediaType||g||(p=e.attributes.payloads,f=e.attributes.extmaps,g=!0),"audio"!==e.media.mediaType||_||(h=e.attributes.payloads,m=e.attributes.extmaps,_=!0))}),!f||0===p.length)throw new Error("Cannot get video capabilities from SDP.");if(!m||0===h.length)throw new Error("Cannot get audio capabilities from SDP.");if(p.forEach(e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),u&&e.rtcpFeedbacks.push({type:"rrtr"})}),h.forEach(e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),u&&e.rtcpFeedbacks.push({type:"rrtr"})}),i&&(h=h.filter(e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}),p=p.filter(e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})),o){const e=p.filter(e=>{var t;return/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}),t=Yj(e,p).map(e=>e.payloadType),n=[...e.map(e=>e.payloadType),...t];p=p.filter(e=>!xr(n).call(n,e.payloadType))}if(a&&(h=h.filter(e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")})),s&&(null==s?void 0:s.length)>0&&(h=h.filter(e=>{var t;return xr(s).call(s,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")})),c&&(null==c?void 0:c.length)>0){const e=p.filter(e=>{var t;return xr(c).call(c,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")});p=e.concat(i?[]:Yj(e,p))}const v=SP("UNSUPPORTED_VIDEO_CODEC");if(v&&v.length>0){const e=p.filter(e=>e.rtpMap&&xr(v).call(v,e.rtpMap.encodingName.toLowerCase())),t=Yj(e,p),n=e.concat(t).map(e=>e.payloadType);p=p.filter(e=>!xr(n).call(n,e.payloadType)),nk.debug("unsupportedVideoCodec: ".concat(v,", toBeRemoved: ").concat(n))}if(l&&l.length>0&&"sendonly"===r){const e=p.filter(e=>e.rtpMap&&xr(l).call(l,e.rtpMap.encodingName.toLowerCase())),t=Yj(e,p),n=e.concat(t).map(e=>e.payloadType);p=p.filter(e=>!xr(n).call(n,e.payloadType)),nk.debug("unsupportedVideoUplinkCodec: ".concat(l,", toBeRemoved: ").concat(n))}if(d&&d.length>0&&"recvonly"===r){const e=p.filter(e=>e.rtpMap&&xr(d).call(d,e.rtpMap.encodingName.toLowerCase())),t=Yj(e,p),n=e.concat(t).map(e=>e.payloadType);p=p.filter(e=>!xr(n).call(n,e.payloadType)),nk.debug("unsupportedVideoDownlinkCodec: ".concat(d,", toBeRemoved: ").concat(n))}return{audioCodecs:h,videoCodecs:p,audioExtensions:m,videoExtensions:f}}function Nj(e){const t=DP(e);let n,r;for(const i of t.mediaDescriptions){if(!n){const e=i.attributes.iceUfrag,t=i.attributes.icePwd;if(!e||!t)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:e,icePwd:t}}if(!r){const e=i.attributes.fingerprints;e.length>0&&(r={fingerprints:e})}}if(!r&&t.attributes.fingerprints.length>0&&(r={fingerprints:t.attributes.fingerprints}),!r||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:r}}function Oj(e,t){const n=[],r=e.attributes.ssrcGroups.filter(e=>"FID"===e.semantic),i=e.attributes.ssrcGroups.find(e=>"SIM"===e.semantic),o=e.attributes.ssrcs;if(i)i.ssrcIds.forEach(e=>{var i;const o=null===(i=r.find(t=>t.ssrcIds[0]===e))||void 0===i?void 0:i.ssrcIds[1];n.push({ssrcId:e,rtx:t?o:void 0})});else if(r.length>0){const e=r[0].ssrcIds[0],i=r[0].ssrcIds[1];n.push({ssrcId:e,rtx:t?i:void 0})}else{if(0===o.length)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:o[0].ssrcId})}return n}function Pj(e,t,n){const{cname:r}=e;let i=[];t&&(i=kj(t)),0===i.length&&(i=e.iceParameters.candidates.map(e=>({foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}})),nk.debug("Using candidates from gateway."));const o={fingerprints:e.dtlsParameters.fingerprints.map(e=>({hashFunction:e.algorithm,fingerprint:e.fingerprint}))},a={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let s;switch(e.dtlsParameters.role){case"server":s="passive";break;case"client":s="active";break;case"auto":s="actpass"}const c=Gj(e.rtpCapabilities),l=[];return Array.isArray(n)&&n.length>0&&n.forEach(e=>{l.push({kind:_F.VIDEO,ssrcMsg:[{ssrcId:e.v,rtx:e.v_rtx}],mslabel:"".concat(e.v,"_").concat(e.a)},{kind:_F.AUDIO,ssrcMsg:[{ssrcId:e.a}],mslabel:"".concat(e.v,"_").concat(e.a)})}),{dtlsParameters:o,iceParameters:a,candidates:i,rtpCapabilities:c,setup:s,cname:r,preSSRCs:l}}function kj(e){let t=[];return e.ip&&"number"==typeof e.port&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],nk.debug("Using remote candidate from AP ".concat(gj(e.ip),":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),nk.debug("Using IPV6 remote candidate from AP ".concat(gj(e.ip6),":").concat(e.port)))),t}function Dj(e,t,n){const r=[],i=[];return e.forEach(e=>{let{ssrcId:o,rtx:a}=e;const s=vO(8,"track-"),c={ssrcId:o,attributes:Aj({label:s,mslabel:n=n||vO(10,""),msid:"".concat(n," ").concat(s)},t&&{cname:t})};if(r.push(c),void 0!==a){const e={ssrcId:a,attributes:Aj({label:s,mslabel:n,msid:"".concat(n," ").concat(s)},t&&{cname:t})};r.push(e),i.push({semantic:"FID",ssrcIds:[o,a]})}}),e.length>1&&i.push({semantic:"SIM",ssrcIds:e.map(e=>{let{ssrcId:t}=e;return t})}),{ssrcs:r,ssrcGroups:i}}function xj(e,t){t instanceof Vx&&e.attributes.payloads.forEach(e=>{var n;const r=null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase();if(!r||-1===["opus","pcmu","pcma","g722"].indexOf(r))return;e.fmtp||(e.fmtp={parameters:{}}),"opus"===r&&"number"==typeof SP("OPUS_PTIME")?e.fmtp.parameters.ptime=SP("OPUS_PTIME"):e.fmtp.parameters.minptime="10",e.fmtp.parameters.useinbandfec="1";const i=t._encoderConfig;i&&("pcmu"!==r&&"pcma"!==r&&"g722"!==r&&(i.bitrate&&!VI()&&(e.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*i.bitrate))),i.sampleRate&&(e.fmtp.parameters.maxplaybackrate="".concat(i.sampleRate),e.fmtp.parameters["sprop-maxcapturerate"]="".concat(i.sampleRate)),i.stereo&&(e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1")),t instanceof Bx&&"opus"===r&&t._config.DTX&&(e.fmtp.parameters.usedtx="1"))})}function Lj(e){const t=e.attributes.unrecognized.findIndex(e=>"x-google-flag"===e.attField&&"conference"===e.attValue);-1!==t&&e.attributes.unrecognized.splice(t,1)}function Mj(e,t){var n;if(e.attributes.payloads.forEach(e=>{var t;"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())&&e.fmtp&&e.fmtp.parameters&&SP("ENABLE_UP_SPS_PPS")&&(e.fmtp.parameters["sps-pps-idr-in-keyframe"]="1")}),!(t instanceof xL&&t._encoderConfig&&-1===t._hints.indexOf(Uk.SCREEN_TRACK)))return;const r=t._encoderConfig;pk().supportMinBitrate&&r.bitrateMin&&e.attributes.payloads.forEach(e=>{var t,n;xr(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-min-bitrate"]="".concat(r.bitrateMin))}),pk().supportMinBitrate&&!xr(n=t._hints).call(n,Uk.LOW_STREAM)&&r.bitrateMax&&e.attributes.payloads.forEach(e=>{var t,n;xr(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-start-bitrate"]="".concat(SP("X_GOOGLE_START_BITRATE")||Math.floor(r.bitrateMax)))})}function Uj(e){if("video"!==e.media.mediaType)return;const t=PI();if(t.name!==AI.SAFARI&&t.os!==RI.IOS)return;const n=e.attributes.extmaps.findIndex(e=>/video-orientation/g.test(e.extensionName));-1!==n&&e.attributes.extmaps.splice(n,1)}function Fj(e,t,n){if(!t)return;let r,i;if("video"===e.media.mediaType?(r=n.videoExtensions,i=n.videoCodecs):(r=n.audioExtensions,i=n.audioCodecs),!0===t.twcc){const t=r.find(e=>wj(e.extensionName));if(t){const n=t.extensionName;e.attributes.extmaps.find(e=>wj(e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:n});const r=function(e,t){return t.filter(t=>!!e.find(e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find(e=>"transport-cc"===e.type)))}(i,e.attributes.payloads);r.forEach(e=>{e.rtcpFeedbacks.find(e=>"transport-cc"===e.type)||e.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(!1===t.twcc){const t=e.attributes.extmaps.findIndex(e=>wj(e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach(e=>{const t=e.rtcpFeedbacks.findIndex(e=>"transport-cc"===e.type);-1!==t&&e.rtcpFeedbacks.splice(t,1)})}if(!0===t.remb){const t=r.find(e=>Cj(e.extensionName));if(t){const n=t.extensionName;e.attributes.extmaps.find(e=>e.extensionName===n)||e.attributes.extmaps.push({entry:t.entry,extensionName:n});const r=function(e,t){return t.filter(t=>!!e.find(e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find(e=>"goog-remb"===e.type)))}(i,e.attributes.payloads);r.forEach(e=>{e.rtcpFeedbacks.find(e=>"goog-remb"===e.type)||e.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(!1===t.remb){const t=e.attributes.extmaps.findIndex(e=>Cj(e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach(e=>{const t=e.rtcpFeedbacks.findIndex(e=>"goog-remb"===e.type);-1!==t&&e.rtcpFeedbacks.splice(t,1)})}}function jj(e,t,n){if(VI())return;if("video"!==e.media.mediaType)return;if(!(t instanceof xL))return;if("vp9"!==n&&"vp8"!==n)return;if("vp8"===n&&!SP("SIMULCAST"))return;if("vp9"===n&&SP("ENABLE_SVC"))return;if(void 0===t._scalabilityMode||t._scalabilityMode.numSpatialLayers<=1)return;const r="vp8"===n?2:t._scalabilityMode.numSpatialLayers,i=e.attributes.ssrcs[0],o=e.attributes.ssrcGroups.find(e=>"FID"===e.semantic&&e.ssrcIds[0]===i.ssrcId),a={semantic:"SIM",ssrcIds:[i.ssrcId]};for(let s=1;s<r;s++)e.attributes.ssrcs.push({ssrcId:i.ssrcId+s,attributes:aO(i.attributes)}),a.ssrcIds.push(i.ssrcId+s),o&&(e.attributes.ssrcs.push({ssrcId:o.ssrcIds[1]+s,attributes:aO(i.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[i.ssrcId+s,o.ssrcIds[1]+s]}));e.attributes.ssrcGroups.unshift(a)}async function Vj(){try{const e=new RTCPeerConnection;e.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:nP.L1T3}]});const t=await e.createOffer();if(!t.sdp)return void e.close();const n=DP(t.sdp).mediaDescriptions[0];if(!n)return;const r=n.attributes.extmaps.find(e=>"https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension"===e.extensionName);return e.close(),r}catch(e){return}}async function Bj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendonly"}),n.addTransceiver("audio",{direction:"sendonly"}),n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const r=(await n.createOffer()).sdp,{send:i,recv:o,sendrecv:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=Ij(n,e,t,"sendonly"),i=Ij(n,e,t,"recvonly"),o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Hj(r,i,"videoExtensions",o,a,s),Hj(r,i,"videoCodecs",o,a,s),Hj(r,i,"audioExtensions",o,a,s),Hj(r,i,"audioCodecs",o,a,s),SP("RAISE_H264_BASELINE_PRIORITY")){const e=[],t=[];if(s.videoCodecs.forEach((n,r)=>{var i;if("h264"===(null===(i=n.rtpMap)||void 0===i?void 0:i.encodingName.toLocaleLowerCase())){var o,a;const i=s.videoCodecs[r+1],c=i&&$j(n,i),l=null===(o=n.fmtp)||void 0===o?void 0:o.parameters["profile-level-id"],d=null===(a=n.fmtp)||void 0===a?void 0:a.parameters["packetization-mode"];!l||l!==SP("FIRST_H264_PROFILE_LEVEL_ID")||SP("FIRST_PACKETIZATION_MODE")&&d!==SP("FIRST_PACKETIZATION_MODE")?c?t.push([n,i]):t.push([n]):c?e.push([n,i]):e.push([n])}}),e.length>0&&t.length>0){nk.debug("raising H264 baseline profile priority"),s.videoCodecs.forEach((n,r)=>{var i;if("h264"===(null===(i=n.rtpMap)||void 0===i?void 0:i.encodingName.toLocaleLowerCase())){const i=$j(n,s.videoCodecs[r+1]),o=e.shift()||t.shift()||[];o.length>0&&(i?s.videoCodecs.splice(r,2,...o):s.videoCodecs.splice(r,1,...o))}});const n=a.videoCodecs.filter(e=>{var t,n;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])!==SP("FIRST_H264_PROFILE_LEVEL_ID")});if(n.length>0){const e=Yj(n,a.videoCodecs).map(e=>e.payloadType),t=[...n.map(e=>e.payloadType),...e];a.videoCodecs=a.videoCodecs.filter(e=>!xr(t).call(t,e.payloadType))}SP("FILTER_SEND_H264_BASELINE")&&(o.videoCodecs=o.videoCodecs.filter(e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])!==SP("FIRST_H264_PROFILE_LEVEL_ID"))}))}return{send:o,recv:a,sendrecv:s}}return{send:o,recv:a,sendrecv:s}}(e,t,r);try{n.close()}catch(e){}return{send:i,recv:o,sendrecv:a}}function Wj(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=Ij(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"recvonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Hj(e,t,"videoExtensions",n,r,i),Hj(e,t,"videoCodecs",n,r,i),Hj(e,t,"audioExtensions",n,r,i),Hj(e,t,"audioCodecs",n,r,i),SP("RAISE_H264_BASELINE_PRIORITY")){const e=i.videoCodecs.findIndex(e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]);if(-1!==e){const t=i.videoCodecs.findIndex(e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase());if(t<e){nk.debug("raising H264 baseline profile priority");const n=i.videoCodecs[e];i.videoCodecs.splice(e,1),i.videoCodecs.splice(t,0,n)}-1!==t&&(r.videoCodecs=r.videoCodecs.filter(e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"])))}}return{send:n,recv:r,sendrecv:i}}function Hj(e,t,n,r,i,o){if("videoExtensions"===n||"audioExtensions"===n){const a=[];return e[n].forEach(e=>{t[n].some((t,n)=>{if(e.entry===t.entry&&e.extensionName===t.extensionName)return a.push(n),!0})?o[n].push(e):r[n].push(e)}),void t[n].forEach((e,t)=>{-1===a.indexOf(t)&&i[n].push(e)})}if("videoCodecs"===n||"audioCodecs"===n){const a=[];return e[n].forEach(e=>{t[n].some((t,n)=>{if(e.payloadType===t.payloadType&&JSON.stringify(e)===JSON.stringify(t))return a.push(n),!0})?o[n].push(e):r[n].push(e)}),void t[n].forEach((e,t)=>{-1===a.indexOf(t)&&i[n].push(e)})}}function Gj(e){const{send:t,recv:n,sendrecv:r}=e;if(!r){if(!t||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:n}}let i,o;return t?(i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i.audioCodecs=[...t.audioCodecs,...r.audioCodecs],i.videoCodecs=[...t.videoCodecs,...r.videoCodecs],i.audioExtensions=[...t.audioExtensions,...r.audioExtensions],i.videoExtensions=[...t.videoExtensions,...r.videoExtensions]):i=aO(r),n?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...n.audioCodecs,...r.audioCodecs],o.videoCodecs=[...n.videoCodecs,...r.videoCodecs],o.audioExtensions=[...n.audioExtensions,...r.audioExtensions],o.videoExtensions=[...n.videoExtensions,...r.videoExtensions]):o=aO(r),{send:i,recv:o}}function zj(e){"audio"===e.media.mediaType&&e.attributes.payloads.filter(e=>{var t;return"opus"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}).forEach(e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"})}function Kj(e,t,n,r){let i=[];if(e===_F.VIDEO){if(SP("H264_PROFILE_LEVEL_ID")&&"h264"===r&&(i=t.videoCodecs.filter(e=>{var t;return xr(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,r)&&e&&e.fmtp&&e.fmtp.parameters["profile-level-id"]===SP("H264_PROFILE_LEVEL_ID")})),!Array.isArray(i)||0===i.length){let e=[];const o=[],a=[],s=[];if(n.videoCodecs.forEach(t=>{const n=t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"";xr(n).call(n,r)?e.push(t):xr(n).call(n,"vp9")?o.push(t):xr(n).call(n,"vp8")?a.push(t):xr(n).call(n,"h264")&&s.push(t)}),0===e.length){let t="";0!==o.length?(e=o,t="vp9"):0!==a.length?(e=a,t="vp8"):0!==s.length&&(e=s,t="h264"),nk.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(t))}0!==e.length&&(i=t.videoCodecs.filter(t=>e.some(e=>e.payloadType===t.payloadType)))}if(0===i.length&&(nk.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),i=t.videoCodecs),SP("USE_PUB_RTX")||SP("USE_SUB_RTX")){const e=Yj(i,t.videoCodecs);i=[...i,...e]}}else{i=t.audioCodecs.filter(e=>{var t;return xr(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,r)});const e=t.audioCodecs.filter(e=>{var t;return xr(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,"red")});0===i.length&&(nk.warning("codec ".concat(r," not included in rtpCapabilities, fallback to opus")),i=t.audioCodecs.filter(e=>{var t;return xr(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,"opus")})),SP("ENABLE_AUDIO_RED")&&0!==e.length&&(i=[...e,...i])}return i}function Yj(e,t){const n=e.map(e=>e.payloadType.toString());return t.filter(e=>e.rtpMap&&"rtx"===e.rtpMap.encodingName&&e.fmtp&&e.fmtp.parameters.apt&&xr(n).call(n,e.fmtp&&e.fmtp.parameters.apt))}async function qj(e,t,n){const r=t.toString(),i=Jj(r,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:r});const o=await e.createAnswer();if(!o.sdp)throw new Error("cannot get answer sdp");let a=o.sdp;a=Xj(a,n||{}),null==i||i(a||""),await e.setLocalDescription({type:"answer",sdp:a})}function Xj(e,t,n){if(SP("FORBID_MODIFY_LOCAL_OFFER_SDP"))return e;const r=DP(e),{useXR:i}=t;return r.mediaDescriptions.forEach(e=>{var t;e.attributes.mid&&(Array.isArray(n)&&!xr(n).call(n,e.attributes.mid)||("audio"===e.media.mediaType&&zj(e),"video"===e.media.mediaType&&function(e){"video"===e.media.mediaType&&SP("ENABLE_DOWN_SPS_PPS")&&e.attributes.payloads.filter(e=>{var t;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}).forEach(e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["sps-pps-idr-in-keyframe"]="1"})}(e),i&&xr(t=["audio","video"]).call(t,e.media.mediaType)&&e.attributes.payloads.forEach(e=>{-1===e.rtcpFeedbacks.findIndex(e=>"rrtr"===e.type)&&e.rtcpFeedbacks.push({type:"rrtr"})})))}),xP(r)}function Jj(e,t,n,r){if(SP("SDP_LOGGING"))return nk.upload("exchanging ".concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{Jj(e,"answer","local"===n?"remote":"local",r)}:void 0}async function Zj(e,t,n){try{var r;if(!pk().supportSetRtpSenderParameters)return;if(!function(e){return"vp9"===e||"av1"===e}(e)||!SP("ENABLE_SVC"))return;const i={},o={},a=t.getParameters(),s=null===(r=a.encodings)||void 0===r?void 0:r[0];o.scalabilityMode=vj(n),s&&Object.assign(s,o),Object.assign(a,i),await t.setParameters(a),nk.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(a.encodings)))}catch(e){nk.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",e)}}function Qj(e){const t=SP("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(t)&&t.length>0)&&t.some(t=>xr(e).call(e,t))}function $j(e,t){try{var n;return(null===(n=e.fmtp)||void 0===n?void 0:n.parameters.apt)===t.payloadType.toString()}catch(e){return!1}}function eV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tV(e,t){return typeof SP(e)===t?SP(e):void 0}function nV(){try{const e=SP("EXPERIMENTS")||{};return"string"==typeof e||Array.isArray(e)?{}:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eV(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e)}catch(e){return nk.debug("handle gateway attributes failed: ",e),{}}}const rV={};function iV(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&nk.debug("install service ".concat(e.name)),rV[e.name]=e}function oV(e){const t=rV[e];if(!t)throw new pN(hN.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function aV(e,t){return oV("DataStream").create(e,t)}function sV(){return oV("InterceptFrame").create()}function cV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cV(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const dV=new Map;class uV extends ON{get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(aF.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(aF.CONNECTION_STATE_CHANGE,e,t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){nk.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,t){var n,r,i;super(),nR(this,"store",void 0),nR(this,"joinInfo",void 0),nR(this,"key",void 0),nR(this,"ntpOffset",0),nR(this,"usingProxy",!1),nR(this,"signal",void 0),nR(this,"role",void 0),nR(this,"isPreallocation",void 0),nR(this,"isPreSub",void 0),nR(this,"inChannelInfo",{joinAt:null,duration:0}),nR(this,"spec",void 0),nR(this,"_state","DISCONNECTED"),nR(this,"_statsCollector",void 0),nR(this,"_disconnectedReason",void 0),nR(this,"isSignalRecover",!1),nR(this,"hasChangeBGPAddress",!1),nR(this,"trafficStatsInterval",void 0),nR(this,"networkQualityInterval",void 0),nR(this,"_joinGatewayStartTime",0),nR(this,"_signalTimeout",!1),nR(this,"_clientRoleOptions",void 0),nR(this,"_isProactiveJoin",!1),this.store=e,this.spec=t,this.signal=this.store.useP2P?(n={spec:lV(lV({},t),{},{retryConfig:t.websocketRetryConfig}),store:e},null===(r=(i=oV("P2PChannel")).createSubmodule)||void 0===r?void 0:r.call(i,n)):this.store.useDcSignal?function(e){return oV("DataChannelSignal").create(e)}({spec:lV(lV({},t),{},{retryConfig:t.websocketRetryConfig}),store:e}):new ej(lV(lV({},t),{},{retryConfig:t.websocketRetryConfig}),e),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}setUsingProxy(e){this.usingProxy=e}async join(e,t,n){if(this.store.useDcSignal){let t=!1;"disabled"!==e.cloudProxyServer?(nk.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(e.cloudProxyServer,")")),t=!0):"".concat(e.apResponse.cid,"_").concat(e.apResponse.cert).length>255||"".concat(e.apResponse.cid,"_").concat(e.apResponse.cert).length<22?(nk.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),t=!0):e.apResponse.addresses.some(e=>e.fingerprint)||SP("FINGERPRINT")||(nk.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),t=!0),t&&this.resetSignal()}this.store.joinGatewayStart(),"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const r=Date.now();let i=dV.get(e.cname);if(i||(i=new Map,dV.set(e.cname,i)),this._isProactiveJoin=!0,i.has(e.uid)){const t=new uk(hN.UID_CONFLICT);throw dk.joinGateway(e.sid,{lts:r,succ:!1,ec:t.code,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,isProxy:!!e.proxyServer||this.usingProxy,signalChannel:this.store.useDcSignal?"1":"0",preload:e.preload}),t}i.set(e.uid,!0),this.joinInfo=e,this.key=t;let o=0;this.joinGatewayStartTime=r;const a=e.proxyServer,s=this.store.useDcSignal?"datachannel":"websocket";try{nk.debug("[".concat(this.store.clientId,"] use ").concat(s," join uid ").concat(o));const t=e.gatewayAddrs.map(t=>{let{address:n}=t;const[r,i]=n.split(":"),o={host:r,port:i};return e.proxyServer&&(o.proxy=e.proxyServer),o});let n;n=this.store.useDcSignal?await this.signal.init(e.apResponse.addresses):await this.signal.init(t),o=n.uid,nk.debug("[".concat(this.store.clientId,"] ").concat(s," join uid ").concat(o," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(t){var c;if(t.code===hN.INIT_DATACHANNEL_TIMEOUT&&"AgoraRTCSignal"===this.signal.__name__||dk.joinGateway(e.sid,{lts:r,succ:!1,ec:(null===(c=t.data)||void 0===c?void 0:c.desc)||t.code,errorMsg:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,isProxy:!!a||this.usingProxy,signalChannel:"DataChannelSignal"===this.signal.__name__?"1":"0",preload:e.preload}),t&&t.code===hN.INIT_DATACHANNEL_TIMEOUT)throw nk.warning("[".concat(this.store.clientId,"] User join datachannel failed"),t.toString()),this.resetSignal(),t;throw nk.error("[".concat(this.store.clientId,"] User join failed"),t.toString()),i.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),nk.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(e=>{nk.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(aF.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(aF.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(aF.NETWORK_QUALITY,{uplinkNetworkQuality:uj(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:uj(this._statsCollector.trafficStats.B_dnq)}):this.emit(aF.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),o}async leave(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if("DISCONNECTED"!==this.state){t!==UN.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==UU.CONNECTED||await function(e,t){return t===1/0?e:ip.race([e,gO(t)])}(this.signal.request(jU.LEAVE,void 0,!0),3e3)}catch(e){nk.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),e)}this.signal.close(t),t!==UN.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const r={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:SP("PUB_EXTEND"),twcc:!!SP("PUBLISH_TWCC"),rtx:!!SP("USE_PUB_RTX")};try{return(await this.signal.request(jU.PUBLISH,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===MU.ERR_PUBLISH_REQUEST_INVALID)return nk.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),r.toString()),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw r}}async publishDataChannel(e,t,n){var r;if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const i={stream_id:t.streamId,ordered:t.ordered?1:0,max_retrans_times:null!==(r=t.maxRetransmits)&&void 0!==r?r:10,channel_id:t.channelId,metadata:t.metadata};try{await this.signal.request(jU.PUBLISH_DATASTREAM,i,!0)}catch(r){if(n&&r.data&&r.data.code===MU.ERR_PUBLISH_REQUEST_INVALID)return nk.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),r.toString()),await this.tryUnpubDataChannelBeforeRepub(e,t),this.publishDataChannel(e,t,!1);throw r}}async unpublish(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(jU.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(e){nk.warning("[".concat(this.store.clientId,"] unpublish warning: "),e)}}async unpublishDataChannel(e){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await ip.all(e.map(e=>this.signal.request(jU.UNPUBLISH_DATASTREAM,{channel_id:e},!0)))}catch(e){nk.warning("unpublish datachannels warning: ",e)}}async presubscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!SP("SUBSCRIBE_TWCC"),rtx:!!SP("USE_SUB_RTX")||void 0,extend:SP("SUB_EXTEND"),svc:Array.isArray(SP("SVC"))&&0!==SP("SVC").length?SP("SVC"):void 0};try{return await this.signal.request(jU.PRE_SUBSCRIBE,r,!0)}catch(r){if(n&&r.data&&r.data.code===MU.ERR_SUBSCRIBE_REQUEST_INVALID)return nk.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),r.toString()),this.presubscribe(e,t,!1);throw r}}async subscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!SP("SUBSCRIBE_TWCC"),rtx:!!SP("USE_SUB_RTX"),extend:SP("SUB_EXTEND"),ssrcId:t.ssrcId,svc:Array.isArray(SP("SVC"))&&0!==SP("SVC").length?SP("SVC"):void 0};try{return(await this.signal.request(jU.SUBSCRIBE,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===MU.ERR_SUBSCRIBE_REQUEST_INVALID)return nk.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),r.toString()),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw r}}async subscribeDataChannel(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const r={uid:e,stream_id:t.id,channel_id:t.datachannelId};try{return void await this.signal.request(jU.SUBSCRIBE_DATASTREAM,r,!0)}catch(r){if(n&&r.data&&r.data.code===MU.ERR_SUBSCRIBE_REQUEST_INVALID)return nk.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),r.toString()),await this.tryUnsubDataChannelBeforeResub(e,t),await this.subscribeDataChannel(e,t,!1);throw r}}async subscribeAll(e,t){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const n={p2p_id:this.store.p2pId,users:e,dtx:!1,rtx:!!SP("USE_SUB_RTX"),twcc:!!SP("SUBSCRIBE_TWCC"),svc:Array.isArray(SP("SVC"))&&0!==SP("SVC").length?SP("SVC"):void 0};try{return await this.signal.request(jU.SUBSCRIBE_STREAMS,n,!0)}catch(n){if(t&&n.data&&n.data.code===MU.ERR_SUBSCRIBE_REQUEST_INVALID)return nk.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),n.toString()),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw n}}async setVideoProfile(e){const t=function(e){if(!(e.bitrateMax&&e.bitrateMin&&e.frameRate&&e.height&&e.width))return;let t=e.frameRate,n=e.width,r=e.height,i=!0;return"number"!=typeof t&&(t=t.exact||t.ideal||t.max||t.min||0,t||(i=!1)),"number"!=typeof n&&(n=n.exact||n.ideal||n.max||n.min||0,n||(i=!1)),"number"!=typeof r&&(r=r.exact||r.ideal||r.max||r.min||0,t||(i=!1)),i?{stream_type:0,width:n,height:r,fps:t,start_bps:1e3*e.bitrateMax,min_bps:1e3*e.bitrateMin,target_bps:1e3*e.bitrateMax}:void 0}(e);if(t)return this.signal.request(jU.SET_VIDEO_PROFILE,t);nk.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(e,t){try{await this.signal.request(jU.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(e){nk.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),e)}}async unsubscribeDataChannel(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new uk(hN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await ip.all(e.map(e=>this.signal.request(jU.UNSUBSCRIBE_DATASTREAM,{stream_id:e,uid:t},!0)))}catch(e){nk.warning("unsubscribeDataChannel warning: ",e)}}async massUnsubscribe(e){try{await this.signal.request(jU.UNSUBSCRIBE_STREAMS,e,!0)}catch(e){nk.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),e)}}async reconnectPC(e){const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=e;return{gatewayEstablishParams:await this.signal.request(jU.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(jU.GATEWAY_INFO)}async renewToken(e){await this.signal.request(jU.RENEW_TOKEN,e),this.key=e.token}updateClientRole(e,t){t&&(this._clientRoleOptions=Object.assign({},t)),SP("CLIENT_ROLE_OPTIONS")&&(nk.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(SP("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},SP("CLIENT_ROLE_OPTIONS"))),this.role=e}async setClientRole(e,t){if(t&&(this._clientRoleOptions=Object.assign({},t)),SP("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},SP("CLIENT_ROLE_OPTIONS")),nk.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(SP("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),"CONNECTED"!==this.state)return void(this.role=e);let n,r=0;"audience"===e?this._clientRoleOptions&&this._clientRoleOptions.delay?(n=this._clientRoleOptions.delay,r=1):r=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:r=0;const i=Object.assign({},t);delete i.delay,delete i.level,await this.signal.request(jU.SET_CLIENT_ROLE,lV(lV({role:e,level:r,delay:n},i),{},{client_ts:Date.now()})),this.role=e}async setDualStreamMode(e,t,n){await this.signal.request(jU.SET_DUAL_STREAM_MODE,{mode:e},n,t)}async setRemoteVideoStreamType(e,t){await this.signal.request(jU.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(jU.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,t){await this.signal.request(jU.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(jU.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}async setRTM2Flag(e){await this.signal.request(jU.SET_RTM2_FLAG,{rtm2_flag:e})}async sendExtensionMessage(e,t,n){if(this.store.useP2P)return this.signal.sendExtensionMessage(e,t,n)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),lV({},this.inChannelInfo)}async setConfigure(e){if(e&&Array.isArray(e)&&0!==e.length)return this.signal.request(jU.CONFIGURE,e)}async getGatewayVersion(){return(await this.signal.request(jU.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=dV.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0),this.usingProxy=!1}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){let t;return t=e.startsWith("dc")?e.match(/(dc\:\/\/)?([^:]+):(\d+)/):e.match(/(wss\:\/\/)?([^:]+):(\d+)/),t?{username:fP.username,password:fP.password,turnServerURL:t[2],tcpport:parseInt(t[3])+30,udpport:parseInt(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(lV(lV({},fP),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if("CONNECTED"!==this.state)return;const e=await this.signal.request(jU.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),null!=e.ntp_offset&&(this.ntpOffset=e.ntp_offset),e.peer_delay.forEach(e=>{const t=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(t=>t.peer_uid===e.peer_uid);t&&t.B_st!==e.B_st&&oO(()=>{this.emit(aF.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)})}),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){var t,n,r,i;if(!this.joinInfo||!this.key)throw new uk(hN.UNEXPECTED_ERROR,"can not generate join message, no join info");const o=Object.assign({},this.joinInfo.apResponse);let a=SP("REPORT_APP_SCENARIO");if("string"!=typeof a)try{a=JSON.stringify(a)}catch(e){a=void 0}var s;a&&a.length>128&&(a=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(aF.UPDATE_GATEWAY_CONFIG),s=this.store.clientId,xr(KM).call(KM,s)||KM.push(s);const c=gk(this.store),l=!(null===(t=this.isPreallocation)||void 0===t||!t.call(this)),d=_k(this.store),u=nV(),h=WI(87)||FI()||KI(117),p=(function(){const e=PI();if(e.name!==AI.SAFARI||!e.browserVersion)return!1;const t=e.browserVersion.split(".");return Number(t[0])>18||18===Number(t[0])&&Number(t[1])>=4}()||qI(18,4,!1))&&JI(18,6,!0)&&"h264"===this.spec.codec&&SP("ENABLE_ABSSENDTIME_AS_SENTTS"),m=!("CN"!==(null===(n=o.detail)||void 0===n?void 0:n[3])||!SP("ENABLE_QUALITY_FALLBACK"))&&SP("ENABLE_QUALITY_FALLBACK"),f=!!SP("ENABLE_AP_MULTI_IP")&&"multi-ip"===(null===(r=o.detail)||void 0===r?void 0:r[5]),g=lV({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:hP,browser:navigator.userAgent,process_id:SP("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:f||this.hasChangeBGPAddress,ap_response:o,extend:SP("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:a,attributes:{userAttributes:lV(lV({enableEncodedTransform:(!!SP("ENABLE_AUDIO_METADATA")||!!SP("ENABLE_AUDIO_PTS"))&&h||!!SP("ENABLE_AUDIO_TOPN")&&GI(AI.CHROME,87,116)||void 0,enableAudioMetadata:!!SP("ENABLE_AUDIO_METADATA")&&h,enableAudioPts:!!SP("ENABLE_AUDIO_PTS")&&h,topnSmoothLevel:SP("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:SP("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:SP("TOPN_SWITCH_HOLD_MS"),topnAudioGain:SP("TOPN_AUDIO_GAIN"),enableNetworkQualityProbe:this.store.networkQualityProbe,enablePublishedUserList:SP("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:SP("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:tV("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:tV("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:tV("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:!0===SP("USE_PUB_RTX")||!0===SP("USE_SUB_RTX")||void 0,disableFEC:SP("DISABLE_FEC"),enableNTPReport:!!SP("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:d,enableFulllinkAvSync:!!SP("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:tV("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!SP("FORCE_ENABLE_AUT_CC")||!fk()&&(!!SP("ENABLE_AUT_FEEDBACK")||void 0),rtm2Flag:"number"==typeof this.joinInfo.rtmFlag?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!SP("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:tV("USE_XR","boolean"),enableLossbasedBwe:tV("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!SP("FORCE_ENABLE_AUT_CC")||!fk()&&(!!SP("ENABLE_AUT_CC")||void 0),enableCCFallback:tV("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:l,preSubNum:c?tV("PRE_SUB_NUM","number"):void 0,enablePubTWCC:tV("PUBLISH_TWCC","boolean"),enableSubTWCC:tV("SUBSCRIBE_TWCC","boolean"),enablePubRTX:tV("USE_PUB_RTX","boolean"),enableSubRTX:tV("USE_SUB_RTX","boolean"),enableSubSVC:SP("ENABLE_SVC")?SP("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(SP("SVC"))&&0!==SP("SVC").length?SP("SVC"):void 0,enableSvcExtended:SP("ENABLE_SVC")&&Array.isArray(SP("SVC_EXTENDED"))&&0!==SP("SVC_EXTENDED").length?SP("SVC_EXTENDED"):void 0,enableVosFallback:SP("ENABLE_VOS_FALLBACK"),enableQualityFallback:m},u),{},{audioDuplicate:tV("ENABLE_AUDIO_RED","boolean")?null!==(i=tV("AUDIO_DUPLICATE_NUM","number"))&&void 0!==i?i:2:void 0,senttsUsesAbsSendTime:!!p||void 0,enableDualStreamFlag:tV("ENABLE_DUAL_STREAM_FLAG","boolean")})},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(g.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(g.aes_mode=this.joinInfo.aesmode,SP("ENCRYPT_AES")?(g.aes_secret=this.joinInfo.aespassword,g.aes_encrypt=!0):g.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(g.aes_salt=this.joinInfo.aessalt)),o.addresses[this.signal.websocket.currentURLIndex]&&(g.ap_response.ticket=o.addresses[this.signal.websocket.currentURLIndex].ticket,delete o.addresses),void 0!==this.joinInfo.defaultVideoStream&&(g.default_video_stream=this.joinInfo.defaultVideoStream),g}getRejoinMessage(){if(!this.joinInfo)throw new uk(hN.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(FU.WS_RECONNECT_CREATE_CONNECTION,e=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(FU.WS_RECONNECTING,e=>{this.joinInfo&&dk.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||GN.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",dk.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:"live"===this.spec.mode?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:"audience"===this.role?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(FU.WS_CLOSED,e=>{let t;switch(e){case UN.LEAVE:t=GN.LEAVE;break;case UN.UID_BANNED:case UN.IP_BANNED:case UN.CHANNEL_BANNED:case UN.SERVER_ERROR:t=GN.SERVER_ERROR;break;case UN.FALLBACK:t=GN.FALLBACK;break;case UN.LICENSE_MISSING:case UN.LICENSE_EXPIRED:case UN.LICENSE_MINUTES_EXCEEDED:case UN.LICENSE_PERIOD_INVALID:case UN.LICENSE_MULTIPLE_SDK_SERVICE:case UN.LICENSE_ILLEGAL:case UN.TOKEN_EXPIRE:t=e;break;default:t=GN.NETWORK_ERROR}nk.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(t||"undefined -> "+GN.NETWORK_ERROR)),this.joinInfo&&dk.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===UN.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this._disconnectedReason=e,e!==UN.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(FU.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if("audience"===this.role){const e=SP("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;e&&(e.level||e.delay)&&(nk.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(e.level,", delay: ").concat(e.delay)),this.setClientRole(this.role,e))}if(dk.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer||this.usingProxy,signalChannel:"DataChannelSignal"===this.signal.__name__?"1":"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&1===this.joinInfo.setLocalAPVersion){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return void nk.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e));yP("EVENT_REPORT_DOMAIN",e[1]),yP("EVENT_REPORT_BACKUP_DOMAIN",e[1]),yP("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}}),this.signal.on(BU.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on(FU.REQUEST_RECOVER,(e,t,n)=>{if(!this.joinInfo)return n(new uk(hN.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,YN(this,aF.REQUEST_NEW_GATEWAY_LIST).then(t).catch(n)}),this.signal.on(FU.REQUEST_JOIN_INFO,async(e,t,n)=>{var r,i,o;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void e(this.getJoinMessage({ortc:{}}));const a=aO(null===(r=this.joinInfo)||void 0===r?void 0:r.turnServer);if(SP("NEW_TURN_MODE")&&a&&"disabled"===(null===(i=this.joinInfo)||void 0===i?void 0:i.cloudProxyServer)){var s;let e=a.servers.map(e=>"turnServerURL"in e&&SP("USE_TURN_IP")?lV(lV({},e),{},{turnServerURL:sj(e.turnServerURL)}):e),t=null===(s=a.serversFromGateway)||void 0===s?void 0:s.map(e=>SP("USE_TURN_IP")?lV(lV({},e),{},{turnServerURL:sj(e.turnServerURL)}):e);const n=this.signal.currentURLIndex;e.length>0&&(e=[e[n%e.length]],a.servers=e),Array.isArray(t)&&t.length>0&&(t=[t[0]],a.serversFromGateway=t),nk.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(n))}const{iceParameters:c,dtlsParameters:l,rtpCapabilities:d}=await YN(this,aF.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:a,cloudProxyServer:null===(o=this.joinInfo)||void 0===o?void 0:o.cloudProxyServer});try{e(this.getJoinMessage({ortc:{iceParameters:c,dtlsParameters:l,rtpCapabilities:d,version:"2"}}))}catch(e){t(e)}}),this.signal.on(FU.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on(FU.REPORT_JOIN_GATEWAY,(e,t)=>{if(!this.joinInfo)return;let n,r="";var i;e instanceof uk?(n=(null===(i=e.data)||void 0===i?void 0:i.desc)||e.code,r=e.message):n=e,dk.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:n,errorMsg:r,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer||this.usingProxy,signalChannel:"DataChannelSignal"===this.signal.__name__?"1":"0",preload:this.joinInfo.preload})}),this.signal.on(FU.IS_P2P_DISCONNECTED,e=>{e(JN(this,aF.IS_P2P_DISCONNECTED))}),this.signal.on(FU.DISCONNECT_P2P,()=>{this.emit(aF.DISCONNECT_P2P)}),this.signal.on(FU.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(FU.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(FU.JOIN_RESPONSE,e=>{const t=this.getCurrentGatewayAddress();this.emit(aF.JOIN_RESPONSE,e,t)}),this.signal.on(FU.PRE_CONNECT_PC,async(e,t)=>{if(this.joinInfo){var n,r;this.updateTurnConfigFromSignal();const o=this.getCurrentGatewayAddress(),a=aO(null===(n=this.joinInfo)||void 0===n?void 0:n.turnServer);if(SP("NEW_TURN_MODE")&&a&&"disabled"===(null===(r=this.joinInfo)||void 0===r?void 0:r.cloudProxyServer)){var i;let e=a.servers.map(e=>"turnServerURL"in e&&SP("USE_TURN_IP")?lV(lV({},e),{},{turnServerURL:sj(e.turnServerURL)}):e),t=null===(i=a.serversFromGateway)||void 0===i?void 0:i.map(e=>SP("USE_TURN_IP")?lV(lV({},e),{},{turnServerURL:sj(e.turnServerURL)}):e);const n=this.signal.currentURLIndex;e.length>0&&(e=[e[n%e.length]],a.servers=e),Array.isArray(t)&&t.length>0&&(t=[t[0]],a.serversFromGateway=t),nk.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(n,",in pre pc"))}const s=SP("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(o&&s){const n=kj(o);YN(this,aF.PRE_CONNECT_PC,{candidates:n,fingerprint:s,turnServer:a}).then(t=>{null==e||e(t)}).catch(t||(()=>{}))}}}),this.signal.on(FU.RECOVER_NOTIFICATION,e=>{this.joinInfo&&"string"==typeof SP("AP_REQUEST_DETAIL")&&(this.joinInfo.apRequestDetail="".concat(SP("AP_REQUEST_DETAIL"),";").concat(e))}),this.signal.on(FU.VOS_FALLBACK,e=>{this.emit(aF.VOS_FALLBACK,e)}),this.signal.on(FU.DATACHANNEL_FAILBACK,e=>{nk.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(aF.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(e,t){try{await this.signal.request(jU.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),e),e}}async tryUnsubDataChannelBeforeResub(e,t){try{await this.signal.request(jU.UNSUBSCRIBE,{stream_id:t.id},!0)}catch(e){throw nk.warning("unsubscribe datachannel warning",e),e}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(jU.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),e),e}}async tryUnpubDataChannelBeforeRepub(e,t){try{await this.signal.request(jU.UNPUBLISH_DATASTREAM,{channnel_id:t.channelId},!0)}catch(e){throw nk.warning("unpublish datastream warning: ",e),e}}async tryMassUnsubBeforeResub(e){const t={users:e.map(e=>({stream_id:e.stream_id,stream_type:e.stream_type}))};try{await this.signal.request(jU.UNSUBSCRIBE_STREAMS,t,!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),e),e}}async muteLocal(e,t){const n={action:e.find(e=>e.stream_type===oF.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(jU.CONTROL,n,!0,!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),e),e}}async unmuteLocal(e,t){const n={action:e.find(e=>e.stream_type===oF.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(jU.CONTROL,n,!0,!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),e),e}}async muteRemote(e,t){const n={action:e===_F.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(jU.CONTROL,n,!0,!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),e),e}}async unmuteRemote(e,t){const n={action:e===_F.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(jU.CONTROL,n,!0,!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),e),e}}uploadWRTCStats(e){this.signal.uploadWRTCStats(e)}upload(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return await this.signal.request(jU.RESTART_ICE,t,!0)}catch(e){throw nk.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),e),e}}reconnect(e,t){"CONNECTED"===this.state&&this.signal.reconnect(e||void 0,t||GN.P2P_FAILED)}getCurrentGatewayAddress(){var e,t;if(!SP("GATEWAY_WSS_ADDRESS"))return SP("USE_CANDIDATE_FROM_AP_DETAIL")&&null!==(e=this.joinInfo)&&void 0!==e&&e.apGatewayAddress?(nk.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):null!==(t=this.joinInfo)&&void 0!==t&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(jU.SET_PARAMETER,{enablePublishAudioFilter:e})}downgradeCodec(e){this.signal.downgradeCodec(e)}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(UN.FALLBACK)),this.store.useDcSignal=!1,this.signal=new ej(lV(lV({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(aF.RESET_SIGNAL)}}let hV=0,pV=0;function mV(e,t,n,r){return new ip((i,o)=>{t.timeout=t.timeout||SP("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),hV+=mO(t.data)):n&&(t.data.size?hV+=t.data.size:t.data instanceof FormData?hV+=fO(t.data):hV+=mO(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,EI.request(t).then(e=>{"string"==typeof e.data?pV+=mO(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?pV+=e.data.byteLength:pV+=mO(JSON.stringify(e.data)),r&&i({data:e.data,headers:e.headers}),i(e.data)}).catch(e=>{EI.isCancel(e)?o(new uk(hN.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new uk(hN.NETWORK_TIMEOUT,e.message)):e.response?o(new uk(hN.NETWORK_RESPONSE_ERROR,e.response.status)):o(new uk(hN.NETWORK_ERROR,e.message))})})}!function(){var e;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r,i="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var n=0;n<e.length;++n){var r=e[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function a(e,t){if(t)e:{var n=o;e=e.split(".");for(var r=0;r<e.length-1;r++){var a=e[r];if(!(a in n))break e;n=n[a]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&i(n,e,{configurable:!0,writable:!0,value:t})}}function s(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}if(a("Symbol",function(e){function t(e,t){this.A=e,i(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}}),a("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<t.length;r++){var a=o[t[r]];"function"==typeof a&&"function"!=typeof a.prototype[e]&&i(a.prototype,e,{configurable:!0,writable:!0,value:function(){return s(n(this))}})}return e}),"function"==typeof Object.setPrototypeOf)r=Object.setPrototypeOf;else{var l;e:{var d={};try{d.__proto__={a:!0},l=d.a;break e}catch(e){}l=!1}r=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var u=r;function h(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function p(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function m(e,t){return e.h=3,{value:t}}function f(e){this.g=new h,this.G=e}function g(e,t,n,r){try{var i=t.call(e.g.j,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.m=!1,i;var o=i.value}catch(t){return e.g.j=null,e.g.s(t),_(e)}return e.g.j=null,r.call(e.g,o),_(e)}function _(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function v(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){p(e.g);var n=e.g.j;return n?g(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),_(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function b(e,t){return t=new v(new f(t)),u&&e.prototype&&u(t,e.prototype),t}if(h.prototype.o=function(e){this.v=e},h.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},h.prototype.return=function(e){this.l={return:e},this.h=this.u},f.prototype.o=function(e){return p(this.g),this.g.j?g(this,this.g.j.next,e,this.g.o):(this.g.o(e),_(this))},f.prototype.s=function(e){return p(this.g),this.g.j?g(this,this.g.j.throw,e,this.g.o):(this.g.s(e),_(this))},a("Array.prototype.entries",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return[e,t]})}}),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var E=function(e,t){for(var n=0;n<e.length;n++)t(e[n])},y=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},S=function(e,t,n){return t instanceof Blob?(n=void 0!==n?String(n+""):"string"==typeof t.name?t.name:"blob",t.name===n&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],n)),[String(e),t]):[String(e),String(t)]},T=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},C="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,w=C.FormData,R=C.XMLHttpRequest&&C.XMLHttpRequest.prototype.send,A=C.Request&&C.fetch,I=C.navigator&&C.navigator.sendBeacon,N=C.Element&&C.Element.prototype,O=C.Symbol&&Symbol.toStringTag;O&&(Blob.prototype[O]||(Blob.prototype[O]="Blob"),"File"in C&&!File.prototype[O]&&(File.prototype[O]="File"));try{new File([],"")}catch(e){C.File=function(e,t,n){return e=new Blob(e,n||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(n&&void 0!==n.lastModified?new Date(n.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),O&&Object.defineProperty(e,O,{value:"File"}),e}}var P=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},k=function(e){this.i=[];var t=this;e&&E(e.elements,function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var n=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];E(n,function(n){t.append(e.name,n)})}else"select-multiple"===e.type||"select-one"===e.type?E(e.options,function(n){!n.disabled&&n.selected&&t.append(e.name,n.value)}):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(n="textarea"===e.type?y(e.value):e.value,t.append(e.name,n))})};if((e=k.prototype).append=function(e,t,n){T(arguments,2),this.i.push(S(e,t,n))},e.delete=function(e){T(arguments,1);var t=[];e=String(e),E(this.i,function(n){n[0]!==e&&t.push(n)}),this.i=t},e.entries=function e(){var t,n=this;return b(e,function(e){if(1==e.h&&(t=0),3!=e.h)return t<n.i.length?e=m(e,n.i[t]):(e.h=0,e=void 0),e;t++,e.h=2})},e.forEach=function(e,t){T(arguments,1);for(var n=c(this),r=n.next();!r.done;r=n.next()){var i=c(r.value);r=i.next().value,i=i.next().value,e.call(t,i,r,this)}},e.get=function(e){T(arguments,1);var t=this.i;e=String(e);for(var n=0;n<t.length;n++)if(t[n][0]===e)return t[n][1];return null},e.getAll=function(e){T(arguments,1);var t=[];return e=String(e),E(this.i,function(n){n[0]===e&&t.push(n[1])}),t},e.has=function(e){T(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},e.keys=function e(){var t,n,r,i=this;return b(e,function(e){if(1==e.h&&(t=c(i),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,m(e,c(r).next().value));n=t.next(),e.h=2})},e.set=function(e,t,n){T(arguments,2),e=String(e);var r=[],i=S(e,t,n),o=!0;E(this.i,function(t){t[0]===e?o&&(o=!r.push(i)):r.push(t)}),o&&r.push(i),this.i=r},e.values=function e(){var t,n,r,i,o=this;return b(e,function(e){if(1==e.h&&(t=c(o),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,(i=c(r)).next(),m(e,i.next().value));n=t.next(),e.h=2})},k.prototype._asNative=function(){for(var e=new w,t=c(this),n=t.next();!n.done;n=t.next()){var r=c(n.value);n=r.next().value,r=r.next().value,e.append(n,r)}return e},k.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],n="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach(function(e,r){return"string"==typeof e?t.push(n+P(y(r))+'"\r\n\r\n'+y(e)+"\r\n"):t.push(n+P(y(r))+'"; filename="'+P(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")}),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},k.prototype[Symbol.iterator]=function(){return this.entries()},k.prototype.toString=function(){return"[object FormData]"},N&&!N.matches&&(N.matches=N.matchesSelector||N.mozMatchesSelector||N.msMatchesSelector||N.oMatchesSelector||N.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),O&&(k.prototype[O]="FormData"),R){var D=C.XMLHttpRequest.prototype.setRequestHeader;C.XMLHttpRequest.prototype.setRequestHeader=function(e,t){D.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},C.XMLHttpRequest.prototype.send=function(e){e instanceof k?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),R.call(this,e)):R.call(this,e)}}A&&(C.fetch=function(e,t){return t&&t.body&&t.body instanceof k&&(t.body=t.body._blob()),A.call(this,e,t)}),I&&(C.navigator.sendBeacon=function(e,t){return t instanceof k&&(t=t._asNative()),I.call(this,e,t)}),C.FormData=k}}();const fV=()=>{const e=SP("AREAS");return 0===e.length&&e.push(lF.GLOBAL),ii(e).call(e,(e,t,n)=>{const r=gV(t);return r?0===n?r:"".concat(e,",").concat(r):e},"")},gV=e=>e===lF.OVERSEA?"".concat(uF.ASIA,",").concat(uF.EUROPE,",").concat(uF.AFRICA,",").concat(uF.NORTH_AMERICA,",").concat(uF.SOUTH_AMERICA,",").concat(uF.OCEANIA):uF[e],_V=e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map(e=>{const n=hF[e],r=Object.keys(n);r&&r.map(e=>{"CODE"!==e&&(t[e]=t[e].concat(n[e]))})}),t},vV={GLOBAL:{ASIA:[lF.CHINA,lF.JAPAN,lF.INDIA,lF.KOREA,lF.HKMC],EUROPE:[],NORTH_AMERICA:[lF.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},bV=Object.keys(vV[lF.GLOBAL]),EV=[lF.CHINA,lF.NORTH_AMERICA,lF.EUROPE,lF.ASIA,lF.JAPAN,lF.INDIA,lF.OCEANIA,lF.SOUTH_AMERICA,lF.AFRICA,lF.KOREA,lF.HKMC,lF.US],yV=function(e,t){let n=[];if(xr(e).call(e,lF.GLOBAL)){const o=[lF.GLOBAL,lF.OVERSEA],a=Object.keys(hF);if(t===lF.GLOBAL)throw new uk(hN.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===lF.CHINA)n=[lF.OVERSEA];else if(i=t,xr(bV).call(bV,i)){const e=(r=t,vV[lF.GLOBAL][r]||[]),i=[...o,t,...e];n=a.filter(e=>!xr(i).call(i,e))}else if(function(e){let t=!1;return bV.forEach(n=>{var r;xr(r=vV[lF.GLOBAL][n]).call(r,e)&&(t=!0)}),t}(t)){const e=function(e){let t;return bV.forEach(n=>{var r;xr(r=vV[lF.GLOBAL][n]).call(r,e)&&(t=n)}),t}(t),r=[...o,e,t];n=a.filter(e=>!xr(r).call(r,e))}else n=e;n=function(e){const t=[];return EV.forEach(n=>{xr(e).call(e,n)&&t.push(n)}),t.concat(e.filter(e=>!xr(EV).call(EV,e)))}(n)}else n=e;var r,i;return n};function SV(e){var t,n;if(!e&&xr(t=SP("AREAS")).call(t,lF.EXTENSIONS))return nk.debug("update area from ap : reset"),void TV(HM,!0);if(!xr(n=SP("AREAS")).call(n,lF.GLOBAL)||!e)return;let r=hF.EXTENSIONS;r&&(r={CODE:gV(lF.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},nk.debug("update area from ap success: ".concat(e,",config is "),r),yP("AREAS",[lF.EXTENSIONS],!0),Object.keys(r).map(e=>{yP(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?r[e][0]:r[e])}))}function TV(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=dk.reportApiInvoke(null,{name:DN.SET_AREA,options:e,tag:xN.TRACER});try{let r=[];if("string"==typeof e&&(r=[e]),Array.isArray(e)&&(e.forEach(e=>{if(!xr(dF).call(dF,e))throw new uk(hN.INVALID_PARAMS,"invalid area code")}),r=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:t,excludedArea:n}=e;if(!t)throw new uk(hN.INVALID_PARAMS,"area code is needed");let i=t;"string"==typeof t&&(i=[t]),r=n?yV(i,n):i}if(!t){if(CP.AREAS){const e=new uk(hN.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return n.onError(e),void nk.warning("setArea is prohibited because of config-distribute")}if(xr(r).call(r,lF.GLOBAL)&&SP("AREAS")===lF.EXTENSIONS){const e=new uk(hN.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return n.onError(e),void nk.warning("setArea is prohibited because of ap extensions")}}yP("AREAS",r,t);const i=_V(r);Object.keys(i).map(e=>{yP(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?i[e][0]:i[e])}),nk.debug("set area success:",r.join(","))}catch(e){throw n.onError(e),e}n.onSuccess()}function CV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?CV(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let RV=1;function AV(e,t,n,r,i){RV+=1;const o={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:RV,requestId:RV,version:hP,cname:n.cname},a={service_name:t,json_body:JSON.stringify(o)};let s,c,l=e[0];return MO(async()=>{s=Date.now();const e=await mV(l,{data:a,cancelToken:r,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-s,0!==e.code){const t=new uk(hN.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw nk.error(t.toString()),t}const n=JSON.parse(e.json_body);if(200!==n.code){const e=new uk(hN.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(n.code,", reason: ").concat(n.reason),{code:n.code,responseTime:c});throw nk.error(e.toString()),e}if(!n.servers||0===n.servers.length){const e=new uk(hN.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:n.code,responseTime:c});throw nk.error(e.toString()),e}const i=function(e,t){return{addressList:e.servers.map(e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(SP("WORKER_DOMAIN"),":").concat(e.wss,"?serviceName=").concat(encodeURIComponent(t))),workerToken:e.workerToken,vid:e.vid}}(n,t);return SP("LIVE_STREAMING_ADDRESS")&&(i.addressList=SP("LIVE_STREAMING_ADDRESS")instanceof Array?SP("LIVE_STREAMING_ADDRESS"):[SP("LIVE_STREAMING_ADDRESS")]),wV(wV({},i),{},{responseTime:c})},(r,i)=>(dk.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(r.addressList),firstSuccess:0===i,responseTime:c,serverIp:e[i%e.length]}),!1),(r,i)=>(dk.apworkerEvent(n.sid,{success:!1,sc:r.data&&r.data.code||200,serviceName:t,responseTime:c,serverIp:e[i%e.length]}),!!(r.code!==hN.OPERATION_ABORTED&&r.code!==hN.UNEXPECTED_RESPONSE||r.data&&r.data.retry)&&(l=e[(i+1)%e.length],!0)),i)}let IV=1;function NV(e,t,n,r){let{url:i,areaCode:o}=e;const{clientId:a,sid:s}=t,c=Date.now();let l;const d=t.role,[u,h]=xV(t,o,[nj.CHOOSE_SERVER]);let p=ZN.networkState;return MO(async()=>{p&&ZN.networkState===zN.OFFLINE&&ZN.onlineWaiter&&await ip.race([ZN.onlineWaiter,_O(r&&r.maxRetryTimeout||xO.maxRetryTimeout)]),p=ZN.networkState;const{data:e,headers:o}=await mV(i,{data:u,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l="1"===o.http3?1:-1,dk.reportResourceTiming(i,s),PV(e,i,t,c,[nj.CHOOSE_SERVER],l);const a=hj(e,nj.CHOOSE_SERVER);return kV(a),cj(a,i)},e=>(e&&dk.joinChooseServer(s,{role:d,lts:c,succ:!0,csAddr:i,opid:h,serverList:e.gatewayAddrs.map(e=>e.address),ec:null,cid:e.cid.toString(),uid:e.uid.toString(),csIp:e.csIp,unilbsServerIds:[nj.CHOOSE_SERVER].toString(),isHttp3:l,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:e.res.detail&&e.res.detail[38],vid:e.vid}),!1),e=>e.code!==hN.OPERATION_ABORTED&&(e.code===hN.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(dk.joinChooseServer(s,{role:d,lts:c,succ:!1,csAddr:i,serverList:null,opid:h,ec:e.code,csIp:e.data&&e.data.csIp,unilbsServerIds:[nj.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:p}),isHttp3:l,corssRegionTagReq:t.apRequestDetail}),nk.warning("[".concat(a||"sid-".concat(s.slice(0,6)),"] Choose server network error, retry"),e),!0)),r)}function OV(e,t,n,r){let i,{url:o,areaCode:a,serviceIds:s}=e;const c=Date.now(),l=t.role,[d,u]=xV(t,a,s);let h;return MO(async()=>{h&&ZN.networkState===zN.OFFLINE&&ZN.onlineWaiter&&await ip.race([ZN.onlineWaiter,_O(r&&r.maxRetryTimeout||xO.maxRetryTimeout)]),h=ZN.networkState;const{data:e,headers:a}=await mV(o,{data:d,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);i="1"===a.http3?1:-1,dk.reportResourceTiming(o,t.sid),PV(e,o,t,c,s,i);const l=hj(e,nj.CHOOSE_SERVER),u=hj(e,"proxy5"===t.cloudProxyServer?nj.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?nj.CLOUD_PROXY:nj.CLOUD_PROXY_FALLBACK),p=performance.getEntriesByName(o),m=p[p.length-1];let f;return m&&(f={name:m.name,protocol:"nextHopProtocol"in m?m.nextHopProtocol:"",dnscost:"domainLookupEnd"in m&&"domainLookupStart"in m&&"number"==typeof m.domainLookupEnd&&"number"==typeof m.domainLookupStart?m.domainLookupEnd-m.domainLookupStart:-1,tcpTlsCost:"connectEnd"in m&&"connectStart"in m&&"number"==typeof m.connectEnd&&"number"==typeof m.connectStart?m.connectEnd-m.connectStart:-1,reqCost:"requestStart"in m&&"number"==typeof m.requestStart&&"responseEnd"in m&&"number"==typeof m.responseEnd?m.responseEnd-m.requestStart:-1,handleCost:"leave_ts"in e&&"enter_ts"in e&&"number"==typeof e.leave_ts&&"number"==typeof e.enter_ts?e.leave_ts-e.enter_ts:-1}),kV(l),{gatewayInfo:cj(l,o),proxyInfo:u,url:o,resourceTimingInfo:f}},e=>{var n;return e.gatewayInfo&&dk.joinChooseServer(t.sid,{role:l,lts:c,succ:!0,csAddr:o,serverList:e.gatewayInfo.gatewayAddrs.map(e=>e.address),ec:null,opid:u,cid:e.gatewayInfo.cid.toString(),uid:e.gatewayInfo.uid.toString(),csIp:e.gatewayInfo.csIp,unilbsServerIds:s.toString(),isHttp3:i,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:e.gatewayInfo.res.detail&&e.gatewayInfo.res.detail[38],vid:null===(n=e.gatewayInfo)||void 0===n?void 0:n.vid,resourceTimingInfo:e.resourceTimingInfo?JSON.stringify(e.resourceTimingInfo):void 0}),e.proxyInfo&&dk.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:o,turnServerAddrList:e.proxyInfo.addresses.map(e=>e.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:s.toString()}),!1},e=>e.code!==hN.OPERATION_ABORTED&&(e.code===hN.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(dk.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer,unilbsServerIds:s.toString(),extend:JSON.stringify({networkState:h})}),nk.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),e),!0)),r)}const PV=(e,t,n,r,i,o)=>{const{sid:a,clientId:s,cloudProxyServer:c}=n,l=[],d=s=>{4096===s.flag?dk.joinChooseServer(a,{role:n.role,lts:r,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:s.error.message,csIp:s.error.data&&s.error.data.csIp,unilbsServerIds:i.toString(),isHttp3:o,corssRegionTagReq:n.apRequestDetail}):1048576!==s.flag&&4194304!==s.flag&&4194310!==s.flag||dk.joinWebProxyAP(a,{lts:r,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:s.error.code,eventType:c,unilbsServerIds:i.toString()})};if(e.response_body.forEach(t=>{const n=t.buffer.code;if(23===t.uri&&0===n&&!t.buffer.edges_services)if(4194310===t.buffer.flag)nk.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),t.buffer.edges_services=[];else{const n={error:new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:SP("NO_EDGES_RETRY"),csIp:e.detail[502]}),flag:t.buffer.flag};l.push(n),d(n)}if(0!==n){const r=FF(n),i={error:new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,r.desc,{desc:r.desc,retry:r.retry,csIp:e.detail[502]}),flag:t.buffer.flag};4194310===t.buffer.flag?nk.warning(i.error.toString()):l.push(i),d(i)}}),l.length)throw nk.warning("[".concat(s||"sid-".concat(a.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(l.map(e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message,", retry: ").concat(e.error.data.retry)).join(" | "))),new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,l.map(e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message)).join(" | "),{retry:!!l.find(e=>e.error.data.retry),csIp:e.detail[502],desc:[...new Set(l.map(e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc}).filter(e=>!!e))]})},kV=e=>{var t,n,r,i;if(e.addresses&&0===e.addresses.length&&0===e.code)throw new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(SP("AP_AREA")&&(null!==(r=e.detail)&&void 0!==r&&r[23]&&"string"==typeof(null===(i=e.detail)||void 0===i?void 0:i[23])?SV(e.detail[23].toLowerCase()):SV()),null!==(t=e.detail)&&void 0!==t&&t[19]&&"string"==typeof(null===(n=e.detail)||void 0===n?void 0:n[19])){const t=e.detail[19],n=null==t?void 0:t.split(";");for(let r=0;r<n.length;r++){var o;const t=xb(o=n[r]).call(o);e.addresses[r]&&n&&(e.addresses[r].fingerprint=t)}}if(SP("GATEWAY_ADDRESS")&&SP("GATEWAY_ADDRESS").length>0){nk.debug("assign gateway address to",SP("GATEWAY_ADDRESS"));const t=SP("GATEWAY_ADDRESS").map(t=>{var n,r;const i=null!==(n=null===(r=e.addresses.find(e=>e.ip===t.ip&&e.port===t.port))||void 0===r?void 0:r.fingerprint)&&void 0!==n?n:"";return{ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:t.fingerprint||i}});e.addresses=t}},DV=(e,t)=>{if(e.response_body&&e.response_body.length){const t=e.response_body[0];if(0!==t.buffer.code){const e=FF(t.buffer.code);throw new uk(hN.UPDATE_TICKET_FAILED,"[".concat(t.buffer.code,"]: ").concat(e.desc),{retry:e.retry})}return t.buffer.ticket}throw nk.debug("update ticket request received ap response without response body:",t),new uk(hN.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},xV=(e,t,n)=>{const r=Math.floor(Math.random()*10**12),i="host"===e.role?"1":"audience"===e.role?"2":void 0,o={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:wV(wV(wV({6:e.stringUid,11:t,12:SP("USE_NEW_TOKEN")?"1":void 0},i?{17:i}:{}),{},{22:t},e.apRequestDetail?{33:e.apRequestDetail}:{}),e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:n,uid:e.uid||0}}]};o.request_bodies.forEach(t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const a=new FormData;return a.append("request",JSON.stringify(o)),[a,r]},LV=(e,t)=>{const n=Math.floor(Math.random()*10**12),r={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map(e=>({ip:e.ip,port:e.port}))}}]},i=new FormData;return i.append("request",JSON.stringify(r)),[i,n]};let MV=0;function UV(e){return ip.all(e.map(e=>e.then(e=>{throw e},e=>e))).then(e=>{throw e},e=>e)}const FV=async e=>{let{fragementLength:t,referenceList:n,asyncMapHandler:r,allFailedhandler:i,promisesCollector:o}=e,a=0;const s=t;let c,l=0;const d=async()=>{const e=(()=>{const e=a*s,t=e+s;return n.slice(e,t).map(r)})();o&&o.push(...e);try{c=await UV(e)}catch(e){if(l+=s,a++,!(l>=n.length))return void await d();i(e)}e.forEach(e=>e.cancel())};return await d(),c},jV=async e=>{let{referenceList:t,asyncMapHandler:n,closeFn:r}=e;const i=t.length;let o=0;const a=async()=>{const e=n(t.shift());try{return await e}catch(e){if(o++,o>=i||null!=r&&r(e))throw e;return a()}};return a()};async function VV(){if("undefined"==typeof VideoDecoder)return!0;let e;const t=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,85,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,149,160,133,4,144,43,122,168,159,120,159,205,39,82,131,57,52,87,187,68,23,248,134,204,226,97,17,49,183,55,236,219,249,221,98,208,215,190,59,179,167,213,47,1,246,150,14,194,245,159,83,35,64,103,218,38,21,82,3,135,21,185,84,248,134],n=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,148,62,134,140,92,172,141,77,35,94,181,164,65,169,65,156,154,43,221,162,11,252,67,102,113,48,136,137,219,62,43,113,239,23,126,250,186,252,10,138,218,25,193,244,74,68,194,209,107,23,52,206,199,78,72,98,103,151,71,96,62,51,210,158,72,231,158],r=[18,0,10,13,0,0,0,3,180,253,144,6,136,8,8,8,32,50,87,16,66,128,2,8,32,132,0,8,0,180,90,204,169,166,242,109,241,190,143,143,233,163,51,196,98,95,151,224,22,134,33,240,150,248,67,18,34,196,142,81,238,173,140,80,205,232,132,144,67,12,131,157,4,171,243,86,122,35,6,166,184,243,85,126,13,206,103,152,62,168,160,187,2,241,138,52,211,72,121,128,151,63,147,128,19,42],i=[18,0,50,138,1,48,192,64,253,248,65,17,67,192,32,0,16,0,0,0,0,0,0,0,195,12,48,144,64,32,0,209,75,61,9,204,25,115,79,226,115,63,63,208,70,210,220,153,126,241,237,37,107,195,153,1,99,112,230,189,209,169,130,10,11,22,167,215,159,205,197,7,183,162,26,48,254,141,134,103,32,16,235,45,1,15,18,119,169,110,206,251,51,115,202,60,148,1,46,39,109,25,28,86,168,15,77,211,239,2,58,43,146,26,230,184,81,48,140,226,226,250,222,146,171,133,164,13,188,180,64,122,142,146,32,208,238,170,193,35,53,44,225],o=[18,0,50,107,48,0,133,125,248,65,26,195,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,204,24,122,65,56,165,18,52,206,218,4,187,51,97,9,29,191,90,253,106,185,31,197,155,52,205,245,185,203,131,20,226,25,124,95,113,220,113,141,15,15,104,211,144,152,237,150,157,127,51,143,24,231,218,171,255,176,241,128,229,149,150,148,66,245,228,91,27,182,228,136,61,182,237,133,45,220,24,103,214,152],a=[18,0,50,122,48,1,9,253,248,65,26,67,64,62,32,31,16,0,0,0,0,0,1,4,16,64,144,64,32,0,198,182,231,242,220,235,163,140,12,36,36,166,46,132,210,4,71,23,218,132,27,30,17,45,244,79,31,243,195,136,100,169,76,88,142,85,204,217,121,168,29,163,198,17,251,223,73,12,212,244,139,123,151,179,75,216,96,208,136,40,229,42,59,149,10,116,228,85,99,93,221,108,255,140,248,20,30,167,122,109,206,164,108,197,110,251,23,243,133,160,63,13,207,177,12,128],s=await new ip((s,c)=>{let l;!async function(){e&&"closed"!==e.state||await async function(){e=new VideoDecoder({output:e=>{e.close(),clearTimeout(l),s(!0)},error:e=>{clearTimeout(l),s(!1)}}),await e.configure({codec:"av01.0.05M.08",width:160,height:90})}();const c=[t,n,r,i,o,a];for(let t=0;t<c.length;t++){const n=new EncodedVideoChunk({type:0==t?"key":"delta",timestamp:33333*t,duration:33333,data:new Uint8Array(c[t])});try{await e.decode(n)}catch(e){return void s(!1)}}}(),l=setTimeout(()=>{s(!1)},5e3)});return s}async function BV(e,t,n,r){const i=async function(e,t,n,r){let i=null;const o=[],a=async()=>{const i=SP("WEBCS_DOMAIN").slice(0,SP("AJAX_REQUEST_CONCURRENT")).map(t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:fV()})),a=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map(e=>e.url)}),s=await FV({fragementLength:SP("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(nk.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),NV(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:o});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),s},s=async()=>{if(await _O(1e3),null!==i)return i;const a=SP("WEBCS_DOMAIN_BACKUP_LIST").map(t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:fV()})),s=r.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:a.map(e=>e.url)}),c=await FV({fragementLength:SP("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:r=>(nk.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),NV(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:o});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},s),c};try{return i=await UV([a(),s()]),o.length&&o.forEach(e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),i}catch(e){throw e[0]}}(e,t,n,r);return{gatewayInfo:await i}}async function WV(e,t,n,r,i){const o=e.cloudProxyServer;if("disabled"===o){if(!r)return;if(e.useLocalAccessPoint)return await BV(e,t,n,i);if(SP("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:r,proxyInfo:o}=await YV(e,t,n,i);if(e.turnServer&&"auto"!==e.turnServer.mode)return{gatewayInfo:r};const s=o.map(e=>({turnServerURL:e.address,tcpport:e.tcpport||fP.tcpport,udpport:e.udpport||fP.udpport,username:e.username||fP.username,password:e.password||fP.password,forceturn:!1,security:!0}));if(i.useP2P){var a;const t=null!==(a=e.uid)&&void 0!==a?a:r.uid,n="glb:".concat(t.toString()),i=await NN(n),c=o.map(e=>({turnServerURL:e.address,tcpport:e.tcpport||fP.tcpport,udpport:e.udpport||fP.udpport,username:n,password:i,forceturn:!1,security:!0}));s.push(...c)}return e.turnServer={mode:"manual",servers:s},{gatewayInfo:r}}return await BV(e,t,n,i)}const{proxyInfo:s,gatewayInfo:c}=await YV(e,t,n,i),l={gatewayInfo:c},d=s.map(e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport?e.tcpport:fP.tcpport,udpport:"proxy4"===o?void 0:e.udpport?e.udpport:fP.udpport,username:e.username||fP.username,password:e.password||fP.password,forceturn:"proxy4"!==o,security:"proxy5"===o}));if(i.useP2P){var u;const t=null!==(u=e.uid)&&void 0!==u?u:c.uid,n="glb:".concat(t.toString()),r=await NN(n),i=s.map(e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport||fP.tcpport,udpport:"proxy4"===o?void 0:e.udpport||fP.udpport,username:n,password:r,forceturn:"proxy4"!==o,security:"proxy5"===o}));d.push(...i)}return e.turnServer={mode:"manual",servers:d},nk.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(o)),l}async function HV(e,t,n,r,i){const o=SP("ACCOUNT_REGISTER").slice(0,SP("AJAX_REQUEST_CONCURRENT"));let a=[];a=t.proxyServer?o.map(e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1")):o.map(e=>"https://".concat(e,"/api/v1"));const s=null==i?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:a});try{const o=await async function(e,t,n,r,i){const o=Date.now(),a={sid:n.sid,opid:10,appid:n.appId,string_uid:t};let s=e[0];const c=await MO(()=>mV(s+"".concat(-1===s.indexOf("?")?"?":"&","action=stringuid"),{data:a,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(n,r)=>{if(0===n.code){if(n.uid<=0||n.uid>=Math.pow(2,32))throw nk.error("Invalid Uint Uid ".concat(t," => ").concat(n.uid),n),dk.reqUserAccount(a.sid,{lts:o,success:!1,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:hN.INVALID_UINT_UID_FROM_STRING_UID,extend:a}),new uk(hN.INVALID_UINT_UID_FROM_STRING_UID);return dk.reqUserAccount(a.sid,{lts:o,success:!0,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:null,extend:a}),!1}const i=FF(n.code);return i.retry&&(s=e[(r+1)%e.length]),dk.reqUserAccount(a.sid,{lts:o,success:!1,serverAddr:s,stringUid:a.string_uid,uid:n.uid,errorCode:i.desc,extend:a}),i.retry},(t,n)=>t.code!==hN.OPERATION_ABORTED&&(dk.reqUserAccount(a.sid,{lts:o,success:!1,serverAddr:s,stringUid:a.string_uid,uid:null,errorCode:t.code,extend:a}),s=e[(n+1)%e.length],!0),i);if(0!==c.code){const e=FF(c.code);throw new uk(hN.UNEXPECTED_RESPONSE,e.desc)}return c}(a,e,t,n,r);return null==i||i.recordJoinChannelService({status:"success",endTs:Date.now()},s),o.uid}catch(e){throw null==i||i.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[e]},s),e}}async function GV(e,t,n){const r=SP("ACCOUNT_REGISTER");let i=[];i=t.proxyServer?r.map(e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1")):r.map(e=>"https://".concat(e,"/api/v1"));try{const r=await jV({referenceList:i,asyncMapHandler:r=>async function(e,t,n,r){const i=Date.now(),o={sid:n.sid,opid:10,appid:n.appId,string_uid:t};try{const t=await mV(e+"".concat(-1===e.indexOf("?")?"?":"&","action=stringuid"),{data:o,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(0!==t.code){const e=FF(t.code);throw new uk(hN.UNEXPECTED_RESPONSE,"preload sua error:".concat(e.desc),e)}if(t.uid<=0||t.uid>=Math.pow(2,32))throw new uk(hN.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:i,url:e,req:o,uid:t.uid,elapse:Date.now()-i}}catch(e){throw e}}(r,e,t,n),closeFn:e=>e.code===hN.OPERATION_ABORTED||e.code===hN.UNEXPECTED_RESPONSE&&!e.data.retry});return r}catch(e){throw e}}async function zV(e,t,n){const r=SP("CDS_AP").slice(0,SP("AJAX_REQUEST_CONCURRENT")).map(t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1"):"https://".concat(t,"/api/v1?action=config")),i=r.map(r=>function(e,t,n,r){const i=PI(),o={flag:64,cipher_method:0,features:wV(wV(wV(wV(wV({install_id:uP(),device:i.name,system:i.os,system_general:navigator.userAgent,vendor:t.appId,version:hP,cname:t.cname,session_id:t.sid,proxyServer:t.proxyServer,sdk_type:tj.WEB_RTC,browser_name:i.name,browser_version:i.version,user_agent:navigator.userAgent,channel_name:t.cname},t.stringUid&&{string_uid:t.stringUid}),t.uid&&{uid:t.uid+""}),i.os&&{os_name:i.os}),i.osVersion&&{os_version:i.osVersion}),{},{detail:""})};return MO(()=>mV(e,{data:o,timeout:1e3,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,e=>e.code!==hN.OPERATION_ABORTED,r)}(r,e,t,n));let o=null,a=null,s={};try{o=await UV(i)}catch(e){if(e.code===hN.OPERATION_ABORTED)throw e;a=e}if(i.forEach(e=>e.cancel()),dk.reportApiInvoke(e.sid,{name:DN.REQUEST_CONFIG_DISTRIBUTE,options:{error:a,res:o}}).onSuccess(),o&&o.test_tags)try{s=function(e){if(!e.test_tags)return{};const t=e.test_tags,n=Object.keys(t),r={};return n.forEach(e=>{var n;const i=xb(n=e.slice(4)).call(n),o=JSON.parse(t[e]),a=o[1];r[i]={tag:o[0]||"",value:a}}),r}(o)}catch(e){}return s}async function KV(e,t){const n=SP("WEBCS_DOMAIN").concat(SP("WEBCS_DOMAIN_BACKUP_LIST")).map(e=>({url:"https://".concat(e,"/api/v2/transpond/webrtc?v=2"),areaCode:fV(),serviceIds:[nj.CHOOSE_SERVER,nj.CLOUD_PROXY_FALLBACK]}));try{const r=await jV({referenceList:n,asyncMapHandler:n=>async function(e,t,n){let r,{url:i,areaCode:o,serviceIds:a}=e;const s=Date.now(),[c,l]=xV(t,o,a);let d=ZN.networkState;try{d&&ZN.networkState===zN.OFFLINE&&ZN.onlineWaiter&&await ip.race([ZN.onlineWaiter,_O(xO.maxRetryTimeout)]),d=ZN.networkState;const{data:e,headers:t}=await mV(i,{data:c,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);r="1"===t.http3?1:-1;const o=e=>{const t=[];if(e.response_body.forEach(n=>{const r=n.buffer.code;if(23===n.uri&&0===r&&!n.buffer.edges_services)if(4194310===n.buffer.flag)n.buffer.edges_services=[];else{const r={error:new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:SP("NO_EDGES_RETRY"),csIp:e.detail[502]}),flag:n.buffer.flag};t.push(r)}if(0!==r){const i=FF(r),o={error:new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,i.desc,{desc:i.desc,retry:i.retry,csIp:e.detail[502]}),flag:n.buffer.flag};4194310===n.buffer.flag?nk.warning(o.error.toString()):t.push(o)}}),t.length)throw new uk(hN.CAN_NOT_GET_GATEWAY_SERVER,t.map(e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message)).join(" | "),{retry:!!t.find(e=>e.error.data.retry),csIp:e.detail[502],desc:[...new Set(t.map(e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc}).filter(e=>!!e))]})};o(e);const a=hj(e,nj.CHOOSE_SERVER),u=hj(e,nj.CLOUD_PROXY_FALLBACK);return kV(a),{gatewayInfo:cj(a,i),proxyInfo:u,opid:l,requestTime:s,url:i,isHttp3:r,elapse:Date.now()-s}}catch(e){throw e}}(n,e,t),closeFn:e=>e.code===hN.OPERATION_ABORTED||e.code===hN.CAN_NOT_GET_GATEWAY_SERVER&&!e.data.retry});return r}catch(e){throw e}}async function YV(e,t,n,r){const i=SP("PROXY_SERVER_TYPE3"),o=(e,t,n)=>{let r=n||i;return Array.isArray(r)&&(r=t%2==0&&i[1]||i[0]),"https://".concat(r,"/ap/?url=").concat(e)};let a=null;const s=[],c=async()=>{const i=SP("WEBCS_DOMAIN").slice(0,SP("AJAX_REQUEST_CONCURRENT")).map((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:fV(),serviceIds:[nj.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?nj.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?nj.CLOUD_PROXY:nj.CLOUD_PROXY_FALLBACK]}}),a=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map(e=>e.url)}),c=await FV({fragementLength:SP("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(nk.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),OV(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:s});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),c},l=async()=>{if(await _O(1e3),null!==a)return a;const i=SP("WEBCS_DOMAIN_BACKUP_LIST").map((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:fV(),serviceIds:[nj.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?nj.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?nj.CLOUD_PROXY:nj.CLOUD_PROXY_FALLBACK]}}),c=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map(e=>e.url)}),l=await FV({fragementLength:SP("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(nk.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),OV(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},c),e[0]},promisesCollector:s});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},c),l};let d,u,h;try{({gatewayInfo:d,proxyInfo:u,url:h}=await UV([c(),l()]))}catch(e){throw e[0]}if(s.length&&s.forEach(e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),!d||!u)throw new uk(hN.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=h,"disabled"!==e.cloudProxyServer&&Array.isArray(i)&&h){const t=/^https?:\/\/(.+?)(\/.*)?$/.exec(h)[1];xr(i).call(i,t)&&(e.proxyServer=t,nk.setProxyServer(t),dk.setProxyServer(t))}return a={gatewayInfo:d,proxyInfo:await pj(u,d.uid)},a}async function qV(e,t,n){const r=SP("UAP_AP").slice(0,SP("AJAX_REQUEST_CONCURRENT")).map(t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1?action=uap"):"https://".concat(t,"/api/v1?action=uap")),i=r.map(r=>function(e,t,n,r){const i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:Date.now(),version:hP,cname:t.cname,uid:t.uid.toString(),requestId:IV,seq:IV};IV+=1;const o={service_name:"tele_channel",json_body:JSON.stringify(i)};return MO(async()=>{const t=await mV(e,{data:o,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==t.code){const e=new uk(hN.UNEXPECTED_RESPONSE,"cross channel ap error, code"+t.code,{retry:!0});throw nk.error(e.toString()),e}const r=JSON.parse(t.json_body);if(200!==r.code){const e=new uk(hN.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(r.code,", reason: ").concat(r.reason));throw nk.error(e.toString()),e}if(!r.servers||0===r.servers.length){const e=new uk(hN.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw nk.error(e.toString()),e}return{vid:r.vid,workerToken:r.workerToken,addressList:(SP("CHANNEL_MEDIA_RELAY_SERVERS")||r.servers).map(e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(SP("WORKER_DOMAIN"),":").concat(e.wss))}},void 0,e=>!!(e.code!==hN.OPERATION_ABORTED&&e.code!==hN.UNEXPECTED_RESPONSE||e.data&&e.data.retry),r)}(r,e,t,n));try{const e=await UV(i);return i.forEach(e=>e.cancel()),e}catch(e){throw e[0]}}async function XV(e,t,n){let r=null;const i=[],o=async o=>{const a=SP(o?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"));return o&&(await _O(1e3),null!==r)?r:await FV({fragementLength:SP("FRAGEMENT_LENGTH"),referenceList:a,asyncMapHandler:r=>(nk.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(o?"backup":""," choose_server:"),r),function(e,t,n,r){const[i]=LV(t,[nj.CHOOSE_SERVER]);let o=ZN.networkState;return MO(async()=>{o&&ZN.networkState===zN.OFFLINE&&ZN.onlineWaiter&&await ip.race([ZN.onlineWaiter,_O(r&&r.maxRetryTimeout||xO.maxRetryTimeout)]),o=ZN.networkState;const t=await mV(e,{data:i,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0);return DV(t,e)},()=>!1,e=>e.code!==hN.OPERATION_ABORTED&&(e.code===hN.UPDATE_TICKET_FAILED?e.data.retry:(nk.warning("[".concat(t.clientId,"] update ticket network error, retry"),e),!0)),r)}(r,e,t,n)),allFailedhandler:e=>{throw e[0]},promisesCollector:i})};try{return r=await UV([o(!1),o(!0)]),i.length&&i.forEach(e=>e.cancel&&"function"==typeof e.cancel&&e.cancel()),r}catch(e){throw e[0]}}function JV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ZV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JV(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class QV extends ON{get isSuccess(){return!!this.configs}constructor(e,t){super(),nR(this,"configs",void 0),nR(this,"store",void 0),nR(this,"joinInfo",void 0),nR(this,"cancelToken",void 0),nR(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),nR(this,"interval",void 0),nR(this,"mutex",void 0),nR(this,"mutableParamsRead",!1),nR(this,"configCache",{}),nR(this,"limit_bitrate",void 0),this.mutex=new kO("config-distribute",e),this.store=t}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),SP("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},SP("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,dk.reportApiInvoke(null,{options:void 0,name:DN.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:xN.TRACER}).onSuccess(JSON.stringify(CP))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void nk.debug("[config-distribute] get config distribute interrupted have no joininfo");let e;const t=await this.mutex.lock();try{e=await zV(this.joinInfo,this.cancelToken,this.retryConfig),nk.debug("[config-distribute] get config distribute",JSON.stringify(e));const t=function(e){var t;const n=Zp(t=Object.keys(e).filter(e=>/^webrtc_ng_global_parameter/.test(e))).call(t);for(let o=0;o<n.length;o++)for(let t=n.length-1;t>o;t--){const r=n[t],i=e[r].value;if("number"==typeof i.__priority){const o=i.__priority,a=n[t-1],s=e[a].value;if("number"==typeof s.__priority){if(!(o>s.__priority))continue;{const e=r;n[t]=n[t-1],n[t-1]=e}}else{const e=r;n[t]=n[t-1],n[t-1]=e}}}const r=Date.now(),i={};return n.forEach(t=>{const n=e[t].value.__expires;n&&n<=r||(i[t]=e[t])}),i}(e);this.cacheGlobalParameterConfig(t),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=t}catch(e){const t=new uk(hN.NETWORK_RESPONSE_ERROR,e);nk.warning("[config-distribute] ".concat(t.toString()))}finally{t()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(e){mF(e)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==e.id&&this.emit(pF.UPDATE_BITRATE_LIMIT,e):this.emit(pF.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.limit_bitrate&&ZV({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(e){try{const t={},n=Object.keys(e),r=[];n.forEach(n=>{const i=e[n].value;t[n]=i;const o=i.__id;if(o&&this.configCache[n]&&this.configCache[n].__id===o)return;const a=i.__type,s=e[n].value,c=e[n].tag;let l=0;a?a===TP.REALTIME&&(l=1):Object.keys(s).some(e=>Object.prototype.hasOwnProperty.call(bP,e)||!qM()&&Object.prototype.hasOwnProperty.call(gP,e)?(l=1,!0):void 0),r.push({tag:c,isApplied:l,feature:n,params:JSON.stringify(i)})}),r.forEach(e=>{let{tag:t,feature:n,params:r,isApplied:i}=e;this.store.sessionId&&dk.abTest(this.store.sessionId,{intSucc:1,isApplied:i,tag:t,feature:n,params:r,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=t}catch(e){nk.debug("handleABTestConfigDistribute error",e)}}cacheGlobalParameterConfig(e){const t=function(e){const t={};return Object.keys(e).forEach(n=>{const r=e[n].value,i=r.__expires,o=r.__type;Object.keys(r).forEach(e=>{"__id"===e||"__type"===e||"__priority"===e||"__expires"===e||Object.prototype.hasOwnProperty.call(t,e)||(t[e]=ZV(ZV({value:r[e]},i&&{expires:i}),o&&{type:o}))})}),t}(e);try{var n;const r=null===(n=t.LIMIT_BITRATE)||void 0===n?void 0:n.value;delete t.LIMIT_BITRATE,r&&mF(r)&&this.handleBitrateLimit(r),this.limit_bitrate=r,this.handleGlobalParameterConfig(t),this.handleABTestConfigDistribute(e),function(e){try{const t=Date.now();Object.keys(e).forEach(n=>{const{value:r,type:i,expires:o}=e[n];o&&o<=t||((i===TP.REALTIME||Object.prototype.hasOwnProperty.call(bP,n))&&(CP[n]=r,EP[n]=r,nk.debug("Update realtime parameters from config distribute",n,r)),i||qM()||!Object.prototype.hasOwnProperty.call(gP,n)||(CP[n]=r,EP[n]=r,nk.debug("Update gateway parameters from config distribute",n,r)))})}catch(t){nk.error("Error update config immediately: ".concat(e),t.message)}}(t);const i=JSON.stringify(t),o=window.btoa(i);window.localStorage.setItem("websdk_ng_global_parameter",o),nk.debug("Caching global parameters ".concat(i))}catch(e){nk.error("Error caching global parameters:",e.message)}}handleGlobalParameterConfig(e){try{const t=Date.now();Object.keys(e).forEach(n=>{switch(n){case"CLIENT_ROLE_OPTIONS":if(Object.prototype.hasOwnProperty.call(EP,n)){const{value:r,expires:i}=e[n];if(i&&i<=t)return;AO(EP[n],r)||(CP[n]=r,EP[n]=r,this.emit(pF.UPDATE_CLIENT_ROLE_OPTIONS,r),nk.debug("Updating client role options: ".concat(JSON.stringify(r))))}break;case"REMOTE_VIDEO_STREAM_TYPE":if(Object.prototype.hasOwnProperty.call(EP,n)){var r;const{value:i,expires:o}=e[n];if(o&&o<=t)return;"number"==typeof i&&xr(r=[0,1,4,5,6,7,8,9]).call(r,i)&&(CP[n]={value:i},EP[n]=i,this.emit(pF.UPDATE_REMOTE_VIDEO_STREAM_TYPE,i),nk.debug("Updating client remote stream type: ".concat(JSON.stringify(i))))}break;case"ENABLE_FORCE_HLS":if(Object.prototype.hasOwnProperty.call(EP,n)){const{value:r,expires:i}=e[n];if(i&&i<=t)return;AO(EP[n],r)||(CP[n]=r,EP[n]=r,this.emit(pF.FALLBACK_TO_HLS,r),nk.debug("Updating enable force hls: ".concat(JSON.stringify(r))))}break;case"VOS_CONFIGURE":if(Object.prototype.hasOwnProperty.call(EP,n)){const{value:r,expires:i}=e[n];if(i&&i<=t)return;AO(EP[n],r)||(CP[n]=r,EP[n]=r,this.emit(pF.UPDATE_VOS_CONFIGURE,r),nk.debug("Updating vos configure: ".concat(JSON.stringify(r))))}}})}catch(e){nk.error("Error handling global parameter config:",e.message)}}}class $V extends ON{constructor(){super(...arguments),nR(this,"resultStorage",new Map)}setLocalAudioStats(e,t,n){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(n,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(n,t))}setLocalVideoStats(e,t,n){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(n,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(n,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(n)),!t.muted&&this.record("VIDEO_ENCODE_FAILED",e,this.checResolutionSent(n))}setRemoteAudioStats(e,t){const n=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",n,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const n=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",n,this.checkVideoDecode(t))}record(e,t,n){if(SP("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const r=this.resultStorage.get(e);if(!r)return;r.result.push(n);const i="VIDEO_ENCODE_FAILED"===e?SP("ENCODE_EXCEPTION_TIMES"):5;if(r.result.length>=i){var o;const n=xr(o=r.result).call(o,!0);r.isPrevNormal&&!n&&this.emit("exception",eB[e],e,t),!r.isPrevNormal&&n&&this.emit("exception",eB[e]+2e3,e+"_RECOVER",t),r.isPrevNormal=n,r.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof Hx&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let n=null;t._encoderConfig&&t._encoderConfig.frameRate&&(n=lj(t._encoderConfig.frameRate));const r=e.captureFrameRate;return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checResolutionSent(e){var t;return!(!e.codecType||xr(t=SP("ENCODE_EXCEPTION_VALIDATE_CODEC")).call(t,e.codecType.toLocaleLowerCase()))||!e.captureFrameRate||0!==e.sendFrameRate||0!==e.sendResolutionWidth||0!==e.sendResolutionHeight}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof Hx&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const eB={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003,VIDEO_ENCODE_FAILED:2004},tB=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}measureFromPublishStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}};function nB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nB(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class iB{constructor(e){nR(this,"store",void 0),nR(this,"onStatsException",void 0),nR(this,"onUploadPublishDuration",void 0),nR(this,"onStatsChanged",void 0),nR(this,"onVideoCodecChanged",void 0),nR(this,"localStats",new Map),nR(this,"remoteStats",new Map),nR(this,"updateStatsInterval",void 0),nR(this,"trafficStats",void 0),nR(this,"trafficStatsPeerList",[]),nR(this,"uplinkStats",void 0),nR(this,"exceptionMonitor",void 0),nR(this,"p2pChannel",void 0),nR(this,"scalabilityMode",nP.L1T1),nR(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=e,this.exceptionMonitor=new $V,this.exceptionMonitor.on("exception",(e,t,n)=>{this.onStatsException&&this.onStatsException(e,t,n)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(yF.LocalAudioTrack)||rB({},Kk)}getLocalVideoTrackStats(){return this.localStats.get(yF.LocalVideoTrack)||rB({},Yk)}getRemoteAudioTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find(t=>t.peer_uid===e);return n&&(t.publishDuration=n.B_ppad+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.audioStats;i&&(n[e]=t(e,i))}else Array.from(this.remoteStats.entries()).forEach(e=>{let[r,{audioStats:i}]=e;i&&(n[r]=t(r,i))});return n}getRemoteNetworkQualityStats(e){const t={};if(e){var n;const r=null===(n=this.remoteStats.get(e))||void 0===n?void 0:n.networkStats;r&&(t[e]=r)}else Array.from(this.remoteStats.entries()).forEach(e=>{let[n,{networkStats:r}]=e;r&&(t[n]=r)});return t}getNetworkQuality(){let e=0,t=0;return this.trafficStats&&(e=uj(this.trafficStats.B_unq),t=uj(this.trafficStats.B_dnq)),{uplinkNetworkQuality:e,downlinkNetworkQuality:t}}getRemoteVideoTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find(t=>t.peer_uid===e);return n&&(t.publishDuration=n.B_ppvd+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.videoStats;i&&(n[e]=t(e,i))}else Array.from(this.remoteStats.entries()).forEach(e=>{let[r,{videoStats:i}]=e;i&&(n[r]=t(r,i))});return n}getRTCStats(){let e=0,t=0,n=0,r=0;const i=this.localStats.get(yF.LocalAudioTrack);i&&(e+=i.sendBytes,t+=i.sendBitrate);const o=this.localStats.get(yF.LocalVideoTrack);o&&(e+=o.sendBytes,t+=o.sendBitrate);const a=this.localStats.get(yF.LocalVideoLowTrack);a&&(e+=a.sendBytes,t+=a.sendBitrate),this.remoteStats.forEach(e=>{let{audioStats:t,videoStats:i}=e;t&&(n+=t.receiveBytes,r+=t.receiveBitrate),i&&(n+=i.receiveBytes,r+=i.receiveBitrate)});let s=1;return this.trafficStats&&(s+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:s,SendBitrate:t,SendBytes:e,RecvBytes:n,RecvBitrate:r,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){e.peer_delay=e.peer_delay.filter(e=>void 0!==e.B_ppad||void 0!==e.B_ppvd),e.peer_delay.filter(e=>-1===this.trafficStatsPeerList.indexOf(e.peer_uid)).forEach(e=>{var t;const n=null===(t=this.p2pChannel)||void 0===t?void 0:t.getRemoteMedia(e.peer_uid),r=null!=n&&n.videoSSRC?tB.measureFromSubscribeStart(this.store.clientId,n.videoSSRC):0,i=null!=n&&n.audioSSRC?tB.measureFromSubscribeStart(this.store.clientId,n.audioSSRC):0;void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,r>i?r:i),this.trafficStatsPeerList.push(e.peer_uid))}),this.trafficStats=e}updateUplinkStats(e){this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&nk.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,n){if(!e)return!1;const r=!!n&&t.framesDecodeFreezeTime>n.framesDecodeFreezeTime,i=!n||t.framesDecodeCount>n.framesDecodeCount;return r||!i}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){Array.from(this.localStats.entries()).forEach(t=>{let[n,r]=t;switch(n){case yF.LocalVideoTrack:case yF.LocalVideoLowTrack:{const t=r,a=rB({},Yk),s=e.getStats(),c=e.getLocalMedia(n);if(s){const n=s.videoSend.find(e=>e.ssrc===(null==c?void 0:c.ssrcs[0].ssrcId));if(n){const r=e.getLocalVideoSize(),o=e.getEncoderConfig(yF.LocalVideoTrack);var i;"H264"!==n.codec&&"H265"!==n.codec&&"VP8"!==n.codec&&"VP9"!==n.codec&&"AV1X"!==n.codec&&"AV1"!==n.codec||(a.codecType=n.codec,(null==t?void 0:t.codecType)!==n.codec&&(null===(i=this.onVideoCodecChanged)||void 0===i||i.call(this,n.codec.toLocaleLowerCase()))),a.sendBytes=n.bytes,a.sendBitrate=t?8*Math.max(0,a.sendBytes-t.sendBytes):0,n.inputFrame?(a.captureFrameRate=n.inputFrame.frameRate,a.captureResolutionHeight=n.inputFrame.height,a.captureResolutionWidth=n.inputFrame.width):r&&(a.captureResolutionWidth=r.width,a.captureResolutionHeight=r.height),n.sentFrame?(a.sendFrameRate=n.sentFrame.frameRate,a.sendResolutionHeight=n.sentFrame.height,a.sendResolutionWidth=n.sentFrame.width):r&&(a.sendResolutionWidth=r.width,a.sendResolutionHeight=r.height),n.avgEncodeMs&&(a.encodeDelay=n.avgEncodeMs),o&&o.bitrateMax?a.targetSendBitrate=1e3*o.bitrateMax:n.targetBitrate&&(a.targetSendBitrate=n.targetBitrate),a.sendPackets=n.packets,a.sendPacketsLost=n.packetsLost,a.sendJitterMs=n.jitterMs,a.sendRttMs=n.rttMs,a.totalDuration=t?t.totalDuration+1:1,a.totalFreezeTime=t?t.totalFreezeTime:0,this.isLocalVideoFreeze(n)&&(a.totalFreezeTime+=1),n.scalabilityMode&&this.scalabilityMode!==n.scalabilityMode&&(nk.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(n.scalabilityMode)),this.scalabilityMode=n.scalabilityMode)}this.trafficStats&&(a.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var o;this.localStats.set(n,a),((null==t?void 0:t.sendResolutionWidth)!==a.sendResolutionWidth||(null==t?void 0:t.sendResolutionHeight)!==a.sendResolutionHeight)&&(null===(o=this.onStatsChanged)||void 0===o||o.call(this,"resolution",{width:a.sendResolutionWidth,height:a.sendResolutionHeight})),a&&c&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,c.track,a);break}case yF.LocalAudioTrack:{const t=r,i=rB({},Kk),o=e.getStats(),a=e.getLocalMedia(n);if(o){const n=o.audioSend.find(e=>e.ssrc===(null==a?void 0:a.ssrcs[0].ssrcId));if(n){if("opus"!==n.codec&&"aac"!==n.codec&&"PCMU"!==n.codec&&"PCMA"!==n.codec&&"G722"!==n.codec||(i.codecType=n.codec),n.inputLevel)i.sendVolumeLevel=Math.round(32767*n.inputLevel);else{const t=e.getLocalAudioVolume();t&&(i.sendVolumeLevel=Math.round(32767*t))}i.sendBytes=n.bytes,i.sendPackets=n.packets,i.sendPacketsLost=n.packetsLost,i.sendJitterMs=n.jitterMs,i.sendRttMs=n.rttMs,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0}}this.trafficStats&&(i.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(yF.LocalAudioTrack,i),i&&a&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,a.track,i);break}}})}updateRemoteStats(e){Array.from(this.remoteStats.entries()).forEach(t=>{var n,r;let[i,{videoStats:o,audioStats:a,videoPcStats:s}]=t;const c=a,l=o,d=s,u=rB({},qk),h=rB({},Jk),p=rB({},Xk),{audioTrack:m,videoTrack:f,audioSSRC:g,videoSSRC:_}=e.getRemoteMedia(i);let v;v=this.store.useP2P?e.getStats(!0):e.getStats();const b=null===(n=v)||void 0===n?void 0:n.audioRecv.find(e=>e.ssrc===g),E=null===(r=v)||void 0===r?void 0:r.videoRecv.find(e=>e.ssrc===_),y=this.trafficStats&&this.trafficStats.peer_delay.find(e=>e.peer_uid===i);if(b&&("opus"!==b.codec&&"aac"!==b.codec&&"PCMU"!==b.codec&&"PCMA"!==b.codec&&"G722"!==b.codec||(u.codecType=b.codec),b.outputLevel?u.receiveLevel=Math.round(32767*b.outputLevel):m&&(u.receiveLevel=Math.round(32767*m.getVolumeLevel())),u.receiveBytes=b.bytes,u.receivePackets=b.packets,u.receivePacketsLost=b.packetsLost,u.receivePacketsDiscarded=b.packetsDiscarded,u.packetLossRate=u.receivePacketsLost/(u.receivePackets+u.receivePacketsLost),u.receiveBitrate=c?8*Math.max(0,u.receiveBytes-c.receiveBytes):0,u.totalDuration=c?c.totalDuration+1:1,u.totalFreezeTime=c?c.totalFreezeTime:0,u.freezeRate=u.totalFreezeTime/u.totalDuration,u.receiveDelay=b.jitterBufferMs,u.totalDuration>10&&iB.isRemoteAudioFreeze(m)&&(u.totalFreezeTime+=1)),E){var S;"H264"!==E.codec&&"H265"!==E.codec&&"VP8"!==E.codec&&"VP9"!==E.codec&&"AV1X"!==E.codec&&"AV1"!==E.codec||(h.codecType=E.codec),h.receiveBytes=E.bytes,h.receiveBitrate=l?8*Math.max(0,h.receiveBytes-l.receiveBytes):0,h.decodeFrameRate=E.decodeFrameRate<0?0:E.decodeFrameRate,h.renderFrameRate=E.decodeFrameRate<0?0:E.decodeFrameRate,E.outputFrame&&(h.renderFrameRate=E.outputFrame.frameRate),E.receivedFrame?(h.receiveFrameRate=E.receivedFrame.frameRate,h.receiveResolutionHeight=E.receivedFrame.height,h.receiveResolutionWidth=E.receivedFrame.width):f&&(h.receiveResolutionHeight=f._videoHeight||0,h.receiveResolutionWidth=f._videoWidth||0),void 0!==E.framesRateFirefox&&(h.receiveFrameRate=Math.round(E.framesRateFirefox)),h.receivePackets=E.packets,h.receivePacketsLost=E.packetsLost,h.packetLossRate=h.receivePacketsLost/(h.receivePackets+h.receivePacketsLost);const t=l?l.totalFreezeTime:0,n=l?l.totalDuration:0;h.totalDuration=l?l.totalDuration+1:1,h.totalFreezeTime=null!==(S=E.totalFreezesDuration)&&void 0!==S?S:t||0,h.receiveDelay=E.jitterBufferMs||0;const r=!!_&&e.getRemoteVideoIsReady(_);void 0===E.totalFreezesDuration&&f&&r&&iB.isRemoteVideoFreeze(f,E,d)&&(h.totalFreezeTime+=1),h.freezeRate=Math.max(0,Math.min((h.totalFreezeTime-t)/(h.totalDuration-n),1))}y&&(u.end2EndDelay=y.B_ad,h.end2EndDelay=y.B_vd,u.transportDelay=y.B_ed,h.transportDelay=y.B_ed,u.currentPacketLossRate=y.B_ealr4/100,h.currentPacketLossRate=y.B_evlr4/100,p.uplinkNetworkQuality=y.B_punq?y.B_punq:0,p.downlinkNetworkQuality=y.B_pdnq?y.B_pdnq:0),this.remoteStats.set(i,{audioStats:u,videoStats:h,videoPcStats:E,networkStats:p}),m&&this.exceptionMonitor.setRemoteAudioStats(m,u),f&&this.exceptionMonitor.setRemoteVideoStats(f,h)})}}class oB{constructor(){nR(this,"destChannelMediaInfos",new Map),nR(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){eF(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){eF(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){GU(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function aB(e){if(!(e instanceof oB))return new uk(hN.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),n=e.getDestChannelMediaInfo();return t?0===n.size?new uk(hN.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new uk(hN.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class sB{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(e,t){nR(this,"uid",void 0),nR(this,"_uintid",void 0),nR(this,"_trust_in_room_",!0),nR(this,"_trust_audio_enabled_state_",!0),nR(this,"_trust_video_enabled_state_",!0),nR(this,"_trust_audio_mute_state_",!0),nR(this,"_trust_video_mute_state_",!0),nR(this,"_audio_muted_",!1),nR(this,"_video_muted_",!1),nR(this,"_audio_enabled_",!0),nR(this,"_video_enabled_",!0),nR(this,"_audio_added_",!1),nR(this,"_video_added_",!1),nR(this,"_is_pre_created",!1),nR(this,"_video_pre_subscribed",!1),nR(this,"_audio_pre_subscribed",!1),nR(this,"_trust_video_stream_added_state_",!0),nR(this,"_trust_audio_stream_added_state_",!0),nR(this,"_audioTrack",void 0),nR(this,"_videoTrack",void 0),nR(this,"_dataChannels",[]),nR(this,"_audioSSRC",void 0),nR(this,"_videoSSRC",void 0),nR(this,"_audioOrtc",void 0),nR(this,"_videoOrtc",void 0),nR(this,"_cname",void 0),nR(this,"_rtxSsrcId",void 0),nR(this,"_videoMid",void 0),nR(this,"_audioMid",void 0),this.uid=e,this._uintid=t}}function cB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cB(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const dB=e=>"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1 2\na=msid-semantic: WMS\na=ice-lite".concat(e?"\na=extmap-allow-mixed":"","\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\nm=application 9 UDP/DTLS/SCTP webrtc-datachannel\nc=IN IP4 127.0.0.1\na=mid:2\n"),uB="9",hB=2e4,pB=4e4;let mB=class{get localCapabilities(){return aO(this._localCapabilities)}get rtpCapabilities(){return aO(this._rtpCapabilities)}get candidates(){return aO(this._candidates)}get iceParameters(){return aO(this._iceParameters)}get dtlsParameters(){return aO(this._dtlsParameters)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];nR(this,"sessionDesc",void 0),nR(this,"_localCapabilities",void 0),nR(this,"_rtpCapabilities",void 0),nR(this,"_candidates",void 0),nR(this,"_originCandidates",void 0),nR(this,"_iceParameters",void 0),nR(this,"_isUseExtmapAllowMixed",void 0),nR(this,"_isUseLocalCodecs",void 0),nR(this,"_isUseDataChannel",void 0),nR(this,"_dtlsParameters",void 0),nR(this,"setup",void 0),nR(this,"currentMidIndex",void 0),nR(this,"cname",void 0),nR(this,"useLocalCodecsMids",[]),nR(this,"preloadSsrcs",[]),nR(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=t,this._isUseLocalCodecs=n,this._isUseDataChannel=r,e=aO(e);const{iceParameters:i,dtlsParameters:o,candidates:a,rtpCapabilities:s,setup:c,localCapabilities:l,cname:d}=e;this._rtpCapabilities=s,this._candidates=a,this._originCandidates=aO(a),this._iceParameters=i,this._dtlsParameters=o,this._localCapabilities=l,this.setup=c,this.cname=d,[this.sessionDesc]=this.updateRemoteRTPCapabilities(s),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}checkPreloadSsrcs(e){return e.length===this.preloadSsrcs.length&&e.every(e=>{var t;return xr(t=this.preloadSsrcs).call(t,e)})}preloadRemoteMedia(e){let t=0;const n=[],r=[];for(;e>0;){const i=[lB({ssrcId:pB+t},SP("USE_SUB_RTX")?{rtx:pB+t+1}:{})],o="".concat(pB+t,"_").concat(hB+t),{ssrcs:a,ssrcGroups:s}=Dj(i,this.cname,SP("SYNC_GROUP")?o:void 0),c=this.preCreateOrRecycleSendMedia("video",a,s,void 0),l=[{ssrcId:hB+t}],d="".concat(pB+t,"_").concat(hB+t),{ssrcs:u,ssrcGroups:h}=Dj(l,this.cname,SP("SYNC_GROUP")?d:void 0),p=this.preCreateOrRecycleSendMedia("audio",u,h,void 0);e--,t+=2,n.push(c,p),r.push(a[0].ssrcId,u[0].ssrcId)}return this.useLocalCodecsMids.push(...n),this.preloadSsrcs=r,{mids:n,preSSRCs:r,isAvailable:!0}}preCreateOrRecycleSendMedia(e,t,n,r){const i=this.rtpCapabilities.send.videoCodecs,o=this._isUseLocalCodecs||0===i.length?this.localCapabilities.recv:this.rtpCapabilities.send;nk.debug("create or recycle send media without remote rtp capabilities, ssrcs ",t[0].ssrcId);const a=e===_F.VIDEO?o.videoCodecs:o.audioCodecs,s=e===_F.VIDEO?o.videoExtensions:o.audioExtensions;this.currentMidIndex+=1;const c="".concat(this.currentMidIndex);let l={media:{mediaType:e,port:uB,protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map(e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:s,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};return l=this.mungSendMediaDesc(l,r),this.sessionDesc.mediaDescriptions.push(l),this.updateBundleMids(),c}toString(){return xP(this.sessionDesc)}send(e,t,n,r){const{ssrcs:i,ssrcGroups:o}=Dj(t,this.cname,SP("SYNC_GROUP")?n:void 0),a=this.findPreloadMediaDesc(i);if(a){if(VI()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,a.attributes.mid),r&&(r.twcc||r.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(a,r),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,i);let n;return-1===t||1===t&&(UI()||function(){const e=PI();return!(e.name!==AI.CHROME||!e.osVersion)&&Number(e.version)<=90}()||WI(143)||zI(143)||SP("RESERVE_MID_1_MLINE")||SP("ENABLE_ENCODED_TRANSFORM")&&MI())||0===t&&!function(e){const t=PI();return!(t.name!==AI.FIREFOX||!t.osVersion)&&Number(t.version)===e}(138)&&SP("USE_SUB_RTX")||QI()?(n=this.createOrRecycleSendMedia(e,i,o,"sendonly",r),this.updateBundleMids()):(n=aO(this.sessionDesc.mediaDescriptions[t]),n.attributes.direction="sendonly",n.attributes.ssrcs=i,n.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(n,r)),VI()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,n.attributes.mid),{mid:n.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:e,needExchangeSDP:t}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:e.attributes.mid,needExchangeSDP:t}}batchSend(e){const t=e.map(e=>{let{kind:t,ssrcMsg:n,mslabel:r}=e;return this.send(t,n,r)}),n=[];let r=!1;return t.forEach(e=>{let{mid:t,needExchangeSDP:i}=e;i&&(r=!0),n.push(t)}),{mids:n,needExchangeSDP:r}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(e=>{"0"===e.attributes.mid||VI()||QI()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")}),this.updateBundleMids()}mute(e){const t=this.sessionDesc.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>xr(e).call(e,t.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(e=>{e.attributes.direction="inactive"})}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>xr(e).call(e,t.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(e=>{e.attributes.direction="recvonly"})}receive(e,t,n,r){e.forEach((e,i)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,n,r[i])}),this.updateBundleMids()}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>-1!==e.indexOf(t.attributes.mid));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(e=>{e.media.port="0",e.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(e){const t=this.sessionDesc||DP((n=this._isUseExtmapAllowMixed,this._isUseDataChannel?dB(n):"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite".concat(n?"\na=extmap-allow-mixed":"","\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n")));var n;this._rtpCapabilities=e;let r=!1;const i=this.rtpCapabilities.send,o=this.localCapabilities.send,a=this.localCapabilities.recv,s=a.videoCodecs,c=a.audioCodecs,l=a.videoExtensions,d=a.audioExtensions;for(const m of t.mediaDescriptions){var u;if("sendonly"!==m.attributes.direction||"string"!=typeof m.attributes.mid||!xr(u=this.useLocalCodecsMids).call(u,m.attributes.mid)){if(r=!0,m.attributes.iceUfrag=this._iceParameters.iceUfrag,m.attributes.icePwd=this._iceParameters.icePwd,m.attributes.fingerprints=this._dtlsParameters.fingerprints,m.attributes.candidates=this._candidates,m.attributes.setup=this.setup,"application"===m.media.mediaType&&(m.attributes.sctpPort="5000"),"video"===m.media.mediaType)if(this._isUseLocalCodecs&&"sendonly"===m.attributes.direction){var h;m.media.fmts=s.map(e=>e.payloadType.toString(10)),m.attributes.payloads=s,m.attributes.extmaps=l;const e=m.attributes.mid;"string"!=typeof e||xr(h=this.useLocalCodecsMids).call(h,e)||this.useLocalCodecsMids.push(e)}else if(0===i.videoCodecs.length){const e=o.videoCodecs.filter(e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:xr(n=t.encodingName.toLowerCase()).call(n,"vp8")});0===e.length&&e.push(o.videoCodecs[0]),m.media.fmts=e.map(e=>e.payloadType.toString(10)),m.attributes.payloads=e,m.attributes.extmaps=[]}else m.media.fmts=i.videoCodecs.map(e=>e.payloadType.toString(10)),m.attributes.payloads=i.videoCodecs,m.attributes.extmaps=i.videoExtensions;if("audio"===m.media.mediaType)if(this._isUseLocalCodecs&&"sendonly"===m.attributes.direction){var p;m.media.fmts=c.map(e=>e.payloadType.toString(10)),m.attributes.payloads=c,m.attributes.extmaps=d;const e=m.attributes.mid;"string"!=typeof e||xr(p=this.useLocalCodecsMids).call(p,e)||this.useLocalCodecsMids.push(e)}else if(0===i.audioCodecs.length){const e=o.audioCodecs.filter(e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:xr(n=t.encodingName.toLowerCase()).call(n,"opus")})||[o.audioCodecs[0]];m.media.fmts=e.map(e=>e.payloadType.toString(10)),m.attributes.payloads=e,m.attributes.extmaps=[]}else m.media.fmts=i.audioCodecs.map(e=>e.payloadType.toString(10)),m.attributes.payloads=i.audioCodecs,m.attributes.extmaps=i.audioExtensions,zj(m)}}return this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1,[this.sessionDesc,r]}updateCandidates(e){const t=this._originCandidates.filter(e=>"udp"===e.transport),n=[];if(t.forEach(e=>{n.push(lB(lB({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))}),0!==t.length){switch(e){case vF.TCP_RELAY:this._candidates=n;break;case vF.UDP_TCP_RELAY:case vF.RELAY:this._candidates=[...t,...n];break;default:this._candidates=t}for(const e of this.sessionDesc.mediaDescriptions)e.attributes.candidates=this.candidates}}restartICE(e){e=aO(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex(n=>{const r=n.media.mediaType===e&&"0"!==n.media.port&&("sendonly"===n.attributes.direction||"sendrecv"===n.attributes.direction)&&0===n.attributes.ssrcs.length;if(VI()){if(r){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==n.attributes.mid&&"1"!==n.attributes.mid)||!(!e||e!==n.attributes.mid)}return!1}return r})}createOrRecycleDataChannel(){for(const n of this.sessionDesc.mediaDescriptions)if("application"===n.media.mediaType)return{mediaDesc:n,needExchangeSDP:!1};this.currentMidIndex+=1;const e="".concat(this.currentMidIndex),t={media:{mediaType:"application",port:uB,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(e),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(t),{mediaDesc:t,needExchangeSDP:!0}}createOrRecycleRecvMedia(e,t,n,r,i,o){const a=e._mediaStreamTrack.kind,s=this.rtpCapabilities.recv,c=Kj(a,s,this.localCapabilities.send,a===_F.VIDEO?r:i),l=a===_F.VIDEO?s.videoExtensions:s.audioExtensions;this.currentMidIndex+=1;const d="".concat(this.currentMidIndex);let u={media:{mediaType:a,port:uB,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.map(e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:l,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(d)}};u=this.mungRecvMediaDsec(u,e,o);const h=this.findFirstClosedMedia(a);if(h){const e=this.sessionDesc.mediaDescriptions.indexOf(h);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}updateRemoteDtlsParameters(e){const t=new Set(this._dtlsParameters.fingerprints.map(e=>e.fingerprint)),n=new Set(e.map(e=>e.fingerprint));let r=!1;t.size!==n.size&&(r=!0);for(const i of t)n.has(i)||(r=!0);return r}updateRemoteCodec(e,t,n){const r=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").filter(e=>{var t;return xr(t=Object.keys(RP)).call(t,e)}))],i=new Set(t);if(r.every(e=>i.has(e)))return nk.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;const o=this._rtpCapabilities.recv.videoCodecs.filter(e=>t.some(t=>{var n;return xr(n=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(n,t)}));if(0===o.length)return nk.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(r," codecs: ").concat(t)),!1;const a=[...new Set(o.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||""))];let s;if(nk.debug("updateRemoteCodec, from ".concat(r," to ").concat(a)),0===e.length)s=this.sessionDesc.mediaDescriptions.filter(e=>"video"===e.media.mediaType&&"recvonly"===e.attributes.direction);else if(s=this.sessionDesc.mediaDescriptions.filter(t=>t.attributes.mid&&"video"===t.media.mediaType&&xr(e).call(e,t.attributes.mid)&&"recvonly"===t.attributes.direction),s.length!==e.length)return nk.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;if(SP("USE_PUB_RTX")||SP("USE_SUB_RTX")){const e=Yj(o,this.rtpCapabilities.recv.videoCodecs);o.push(...e)}this._rtpCapabilities.recv.videoCodecs=o;const c=this.localCapabilities.send,l=this.rtpCapabilities.recv,d=Kj(_F.VIDEO,l,c,n);return s.forEach(e=>{const t=d.map(e=>e.payloadType.toString(10));nk.debug("updateRemoteCodec mid: ".concat(e.attributes.mid,", from"),e.attributes.payloads,"to",d),e.attributes.payloads=d,e.media.fmts=t}),nk.debug("updateRemoteCodec success, mids: ".concat(e,", codecs: ").concat(t,", remote recv: ").concat(this._rtpCapabilities.recv.videoCodecs.length,", remote send: ").concat(this._rtpCapabilities.send.videoCodecs.length)),!0}createOrRecycleSendMedia(e,t,n,r,i){const o=this.rtpCapabilities.send.videoCodecs,a=this._isUseLocalCodecs||0===o.length?this.localCapabilities.recv:this.rtpCapabilities.send,s=e===_F.VIDEO?a.videoCodecs:a.audioCodecs,c=e===_F.VIDEO?a.videoExtensions:a.audioExtensions;this.currentMidIndex+=1;const l="".concat(this.currentMidIndex);let d={media:{mediaType:e,port:uB,protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map(e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};d=this.mungSendMediaDesc(d,i);const u=this.findFirstClosedMedia(e);if(u){const e=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[e]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>"0"!==e.media.port).map(e=>e.attributes.mid)}mungRecvMediaDsec(e,t,n){const r=aO(e);return Lj(r),xj(r,t),Mj(r,t),Uj(r),Fj(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=aO(e);return n.attributes&&n.attributes.payloads&&Array.isArray(n.attributes.payloads)&&n.attributes.payloads.length>0&&n.attributes.payloads.forEach(e=>{e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&SP("ENABLE_DOWN_SPS_PPS")&&(e.fmtp&&e.fmtp.parameters||(e.fmtp={parameters:{}}),e.fmtp.parameters["sps-pps-idr-in-keyframe"]="1")}),Fj(n,t,this.localCapabilities.recv),zj(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex(t=>t.attributes.mid===e);if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>VI()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId})}getSSRC(e){var t;return null===(t=this.sessionDesc.mediaDescriptions.find(t=>t.attributes.mid===e))||void 0===t?void 0:t.attributes.ssrcs}};function fB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fB(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _B=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(_B||{});const vB=new Map;function bB(e,t,n,r){let{scale:i}=e;if(0===i&&r===_B.UP||i>=t.length-1&&r===_B.DOWN)return e;let o=gB(gB({},e),{},{scale:r===_B.DOWN?++i:--i});switch(n){case"maintain-framerate":o=gB(gB({},o),t[i].motion);break;case"maintain-resolution":o=gB(gB({},o),t[i].detail);break;case"balanced":o=gB(gB({},o),t[i].balanced)}return o}function EB(e,t){if(t){const n={overUse:0,underUse:0,adaptationList:yB(t)};vB.set(e,n)}else vB.delete(e)}function yB(e){const t=gB({},e),{bitrateMax:n,frameRate:r,scaleResolutionDownBy:i,bitrateMin:o}=t,{MIN_FRAME_RATE:a,MAX_THRESHOLD_FRAMERATE:s,MAX_SCALE:c,BITRATE_MIN_THRESHOLD:l,BITRATE_MAX_THRESHOLD:d,BWE_SCALE_UP_THRESHOLD:u,BWE_SCALE_DOWN_THRESHOLD:h,PERF_SCALE_DOWN_THRESHOLD:p,PERF_SCALE_UP_THRESHOLD:m,BALANCE_BITRATE_FACTOR:f,BALANCE_FRAMERATE_FACTOR:g,BALANCE_RESOLUTION_FACTOR:_,MOTION_RESOLUTION_FACTOR:v,MOTION_BITRATE_FACTOR:b,DETAIL_FRAMERATE_FACTOR:E,DETAIL_BITRATE_FACTOR:y}=_P,S=Math.min(t.frameRate,s),T=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(h,1)*n),bwe_up:n,fps_down:Math.round(Math.pow(p,1)*S),fps_up:r},balanced:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:o},motion:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:o},detail:{scaleResolutionDownBy:1,frameRate:r,bitrateMax:n,bitrateMin:o}}];for(let C=1;C<=c;C++){const e={bwe_up:Math.round(Math.pow(u,C)*n),bwe_down:Math.round(Math.pow(h,C+1)*n),fps_up:Math.round(Math.pow(m,C)*S),fps_down:Math.round(Math.pow(p,C+1)*S)},t={scaleResolutionDownBy:i/Math.pow(_,C),frameRate:Math.max(Math.round(Math.pow(g,C)*r),a),bitrateMax:Math.max(Math.round(Math.pow(f,C)*n),d),bitrateMin:Math.max(Math.round(Math.pow(f,C)*o),l)},s={scaleResolutionDownBy:i/Math.pow(v,C),frameRate:r,bitrateMax:Math.max(Math.round(Math.pow(b,C)*n),d),bitrateMin:Math.max(Math.round(Math.pow(b,C)*o),l)},c={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(E,C)*r),a),bitrateMax:Math.max(Math.round(Math.pow(y,C)*n),d),bitrateMin:Math.max(Math.round(Math.pow(y,C)*o),l)};T.push({scale:C,threshold:e,balanced:t,motion:s,detail:c})}return T}function SB(e,t,n,r,i,o){const a=vB.get(e)||{overUse:0,underUse:0,adaptationList:yB(i)},{adaptationList:s}=a;vB.set(e,a);const{OVERUSE_TIMES_THRESHOLD:c,UNDERUSE_TIMES_THRESHOLD:l}=_P,{scale:d}=r;let u,h;return"number"==typeof t&&t>0&&function(e,t,n,r){if(t>=n.length)return!1;let{threshold:{fps_down:i}}=n[t];return SP("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===r&&(i=n[0].threshold.fps_down),e<i}(t,d,s,o)&&(a.overUse++,h=tP.CPU,a.overUse>c)||"number"==typeof n&&n>0&&function(e,t,n){if(t>=n.length)return!1;const{threshold:{bwe_down:r}}=n[t];return e<r}(n,d,s)&&(a.overUse++,h=tP.BANDWIDTH,a.overUse>c)?(a.overUse=0,a.underUse=0,u=bB(r,s,o,_B.DOWN),[u,h]):("number"==typeof t&&t>0&&"number"==typeof n&&n>0&&function(e,t,n,r){if(0===t)return;let{threshold:{fps_up:i}}=n[t];return SP("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===r&&(i=n[1].threshold.fps_up),e>i}(t,d,s,o)&&function(e,t,n){if(0===t)return;const{threshold:{bwe_up:r}}=n[t];return e>r}(n,d,s)&&(a.underUse++,a.underUse>l&&(a.overUse=0,a.underUse=0,u=bB(r,s,o,_B.UP),0===u.scale&&(h=tP.NONE))),[u,h])}function TB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function CB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TB(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wB(e){var t;return!!SP("ENABLE_AG_ADAPTATION")&&!!(e instanceof LL||xr(t=e._hints).call(t,Uk.CUSTOM_TRACK))&&(!!SP("FORCE_SUPPORT_AG_ADAPTATION")||!!(qI(14,0,!1)&&XI(17,4,!0)||YI(14)&&JI(17,4,!0)))}const RB=new Map;function AB(e,t,n,r,i,o){if(IB(e,n),i(t),"balanced"!==r&&"maintain-framerate"!==r&&"maintain-resolution"!==r)return;let a=-1;EB(e,t);const s=window.setInterval(()=>{const s=RB.get(e);if(!SP("ENABLE_AG_ADAPTATION")||!s)return IB(e,n),void i(t);const c=o();if(c.sendPackets>0&&c.OutgoingAvailableBandwidth>0){if(-1===a)return void(a=Date.now());if(Date.now()-a<1e3)return;const o=c.sendFrameRate,l=c.OutgoingAvailableBandwidth,[d,u]=SB(e,o,l,s.adaptationConfig,t,r);u&&(n.qualityLimitationReason=u),d&&s.adaptationConfig.scale!==d.scale&&(nk.debug("[".concat(e,"] applyAdaptation: ").concat(n.qualityLimitationReason,"\n           sendFps ").concat(o,", bwe ").concat(l,", switch from ").concat(s.adaptationConfig.scale," to ").concat(d.scale," ")),s.adaptationConfig=CB(CB({},s.adaptationConfig),d),i(d))}},SP("CHECK_LOCAL_STATS_INTERVAL")),c=CB({},t);RB.set(e,{timer:s,adaptationConfig:c,originConfig:t,adaptationFunc:i}),nk.debug("[".concat(e,"] start adaptation, originConfig: ").concat(JSON.stringify(t),", degradationPreference: ").concat(r))}function IB(e,t){const n=RB.get(e);if(n){const{timer:t}=n;window.clearTimeout(t),RB.delete(e)}t.qualityLimitationReason=tP.NONE,EB(e)}function NB(e,t){var n;let r;switch(t){case yF.LocalAudioTrack:r=oF.Audio;break;case yF.LocalVideoTrack:r=xr(n=e._hints).call(n,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalVideoLowTrack:r=oF.Low}return r}function OB(e){const t=pk();if(e.some(e=>e._bypassWebAudio))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function PB(e,t){OB(e);const n=t||new Hx;return e.forEach(e=>n.addAudioTrack(e)),n}const kB=!pk().supportUnifiedPlan||SP("CHROME_FORCE_PLAN_B")&&aN();function DB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.useDcSignal?(n={spec:t,store:e},oV("DataChannelConnection").create(n)):kB?function(e){return oV("PlanBConnection").create(e)}({spec:t,store:e}):new jB(t,e);var n}function xB(e){return e&&("disconnected"===e.iceConnectionState||"checking"===e.iceConnectionState||"failed"===e.iceConnectionState)}function LB(e){try{if(e.iceServers)return!1;if(e.turnServer&&"off"!==e.turnServer.mode){if(FN(e.turnServer.servers))return!1;if(SP("FORCE_TURN_TCP")||e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).some(e=>e.forceturn))return!0}return!1}catch(e){return!1}}var MB;function UB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function FB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UB(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let jB=(MB=class e extends gF{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").filter(e=>{var t;return xr(t=Object.keys(RP)).call(t,e)}))]}constructor(t,n){super(t,n),nR(this,"id",vO(5,"connection-")),nR(this,"store",void 0),nR(this,"peerConnection",void 0),nR(this,"forceTurn",!1),nR(this,"remoteSDP",void 0),nR(this,"initialOffer",void 0),nR(this,"transportEventReceiver",void 0),nR(this,"statsFilter",void 0),nR(this,"extension",{useXR:SP("USE_XR")}),nR(this,"localCapabilities",void 0),nR(this,"remoteCodecs",void 0),nR(this,"localCandidateCount",0),nR(this,"allCandidatesReceived",!1),nR(this,"isPreallocation",!1),nR(this,"isPreRender",!1),nR(this,"preMediaMap",new Map),nR(this,"dataStreamChannelMap",new Map),nR(this,"establishPromise",void 0),nR(this,"recoveredDataChannelIds",[]),nR(this,"currentDataChannelId",1),nR(this,"supportAV1RtpSpec",!1),nR(this,"mutex",void 0),nR(this,"qualityLimitationReason",tP.NONE),nR(this,"isFirstConnected",!1),this.store=n,this.forceTurn=LB(t),this.mutex=new kO("P2PConnection-mutex",n.clientId),this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=lP(this.peerConnection,SP("STATS_UPDATE_INTERVAL"),void 0,VI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,t.isPreallocation&&(this.isPreallocation=!0),this.establishPromise=this.establish()}getPreMedia(e){return this.preMediaMap.get(e)}isPreSub(){return this.preMediaMap.size>0}async updateRemoteRTPCapabilities(e,t){if(this.remoteCodecs=t,this.remoteSDP)if(this.remoteSDP.updateRemoteCodec(e,t,this.store.codec)){const e=await this.peerConnection.createOffer(),t=this.logSDPExchange(e.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(e);const n=this.remoteSDP.toString();null==t||t(n),await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}else nk.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.");else nk.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(t))}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const t=await this.peerConnection.createOffer();if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const n=Nj(t.sdp),r=await Bj({filterRTX:!SP("USE_PUB_RTX")&&!SP("USE_SUB_RTX"),filterVideoFec:SP("FILTER_VIDEO_FEC"),filterAudioFec:SP("FILTER_AUDIO_FEC"),filterVideoCodec:SP("FILTER_VIDEO_CODEC"),unsupportedVideoUplinkCodec:SP("UNSUPPORTED_VIDEO_UPLINK_CODEC"),unsupportedVideoDownlinkCodec:SP("UNSUPPORTED_VIDEO_DOWNLINK_CODEC")},this.extension);if(this.localCapabilities=Gj(r),this.initialOffer=t,SP("ENABLE_SVC")&&"av1"==this.store.codec){const t=await Vj();var e;t&&(this.supportAV1RtpSpec=!0,null===(e=r.send)||void 0===e||e.videoExtensions.push(t))}let i;return t.sdp&&Qj(t.sdp)&&(i=aO(r),Ej(i)),FB(FB({},n),{},{rtpCapabilities:i||r,offerSDP:t.sdp})}catch(e){throw new pN(hN.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&Qj(this.initialOffer.sdp)&&yj(e.rtpCapabilities,this.localCapabilities),this.remoteSDP=new mB(FB(FB({},e),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec,!(!SP("ENABLE_PRE_SUB_WITH_PRE_PC")||!SP("PRE_USE_LOCAL_CODECS"))&&gk(this.store)),e.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const t=this.remoteSDP.toString(),n=Xj(this.initialOffer.sdp,this.extension),r=this.logSDPExchange(n||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),null==r||r(t),await this.peerConnection.setRemoteDescription({type:"answer",sdp:t});const i=this.peerConnection.getTransceivers()[0];if(null!=i&&i.receiver&&this.tryBindTransportEvents(i.receiver),gk(this.store))if(e.preallocation&&SP("ENABLE_PRE_SUB_WITH_PRE_PC")){const e=SP("PRE_SUB_NUM"),{mids:t,preSSRCs:n}=this.remoteSDP.preloadRemoteMedia(e);await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[".concat(this.store.clientId,"] [P2PConnection] preload media, in pre pc,add preload ssrcs ").concat(n)),this.presetMedia(t,n)}else{const{preSSRCs:t=[]}=e,n=t.map(e=>e.ssrcMsg[0].ssrcId);if(0===t.length)return;const{mids:r}=this.remoteSDP.batchSend(t.map(e=>Object.assign({},e)));await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[P2PConnection.connect] preload media, after join, add preload ssrcs ".concat(n)),this.presetMedia(r,n)}}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}presetMedia(e,t){e.forEach((e,n)=>{this.peerConnection.getTransceivers().forEach(r=>{if(null!=r.mid&&e===r.mid&&r.receiver.track){const i=r.receiver.track;let o;"video"===i.kind&&SP("ENABLE_PRE_RENDER")&&(o=new Xx({trackId:"track-".concat(i.kind,"-unknown-").concat(this.store.clientId,"_").concat(vO(5,""))},!0),o.updateVideoTrack(i),o.onFirstVideoFrameRender=()=>{var e;const r=this.preMediaMap.get(t[n]);r&&(r.firstVideoRender=Date.now()),null===(e=this.onFirstVideoRender)||void 0===e||e.call(this,t[n])},o.onVideoBufferReady=()=>{var e;null===(e=this.onFirstVideoBufferReady)||void 0===e||e.call(this,t[n])},o.play(this.store.sessionId||void 0),this.isPreRender=!0),this.preMediaMap.set(t[n],{mid:e,track:i,player:o,transceiver:r})}}),this.store.peerReceiver()})}checkDtlsParameters(e){return!!this.remoteSDP&&e.length>0&&this.remoteSDP.updateRemoteDtlsParameters(e)}async updateRemoteConnect(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");let t=!1;const{rtpCapabilities:n}=e;if([,t]=this.remoteSDP.updateRemoteRTPCapabilities(n),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0){const e=this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);t=t||e}const{preSSRCs:r=[]}=e,i=r.map(e=>e.ssrcMsg[0].ssrcId);if(!this.remoteSDP.checkPreloadSsrcs(i)){const e=[],t=[];if(Array.from(this.preMediaMap.entries()).every(n=>{let[r,{mid:i,player:o,track:a}]=n;return e.push(i),t.push(r),this.preMediaMap.delete(r),o&&o.destroy(),!0}),e.length>0&&(this.remoteSDP.stopSending(e),await qj(this.peerConnection,this.remoteSDP,this.extension),nk.warn("[P2PConnection.updateRemoteConnect] preload media, failed, del preload ssrcs ".concat(t)),dk.reportApiInvoke(this.store.sessionId,{name:DN.PRELOAD_MEDIA_FAILED,options:[r,t],tag:xN.TRACER}).onSuccess()),r.length>0){const{mids:e}=this.remoteSDP.batchSend(r.map(e=>Object.assign({},e)));await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[P2PConnection.updateRemoteConnect] preload media, after join, add preload ssrcs ".concat(i)),this.presetMedia(e,i)}}t?(await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[P2PConnection] updateRemoteConnect by exchanging SDP.")):nk.debug("[P2PConnection] updateRemoteConnect no need to exchange SDP, because no need to update remote codecs (use local codecs)")}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return LA(function*(){const i=yield UA(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const o=[],a=vj();e.forEach(e=>{const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,FB({direction:"sendonly"},"video"===e.trackMediaType&&r.supportAV1RtpSpec&&a?{sendEncodings:[{scalabilityMode:a}]}:{}));o.push(t),e._updateRtpTransceiver(t)}),VI()&&!0===SP("SIMULCAST")&&(yield UA(r.applySimulcastForFirefox(o,e)));const s=yield UA(r.peerConnection.createOffer()),c=r.remoteSDP.predictReceivingMids(e.length),l=r.mungSendOfferSDP(s.sdp,e,c),d=DP(l),u=c.map(e=>{const t=d.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return Oj(t,SP("USE_PUB_RTX"))});let h;try{h=yield u}catch(i){h=[],r.remoteSDP.receive(e,t,n,h);const o=r.remoteSDP.toString();throw yield UA(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield UA(r.peerConnection.setRemoteDescription({type:"answer",sdp:o})),yield UA(r.stopSending(c,!0)),i}r.remoteSDP.receive(e,t,n,h);const p=r.remoteSDP.toString(),m=r.logSDPExchange(l,"offer","local","send");return yield UA(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield UA(r.applySimulcastEncodings(o,e)),yield UA(r.applySendEncodings(o,e)),null==m||m(p),yield UA(r.peerConnection.setRemoteDescription({type:"answer",sdp:p})),o.map((e,t)=>{const n=c[t];return{localSSRC:u[t],id:n,transceiver:e}})}catch(e){throw e instanceof pN?e:new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}})()}async createDataChannels(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let n=this.dataStreamChannelMap.get(e);if(n&&"open"===n.readyState)nk.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const t=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if("number"!=typeof t)throw new Error("create DataChannel error, because cannot get dc id");n=this.peerConnection.createDataChannel("datastream-channel",{id:t,negotiated:!0,ordered:!1,maxRetransmits:SP("DATASTREAM_MAX_RETRANSMITS")}),n.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,n)}t.forEach(e=>{e._updateOriginDataChannel(n)});const{needExchangeSDP:r}=this.remoteSDP.sendDataChannel();if(r){const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),nk.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else nk.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(e){throw e instanceof pN?e:new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(e.toString()))}}async stopDataChannels(e){try{const t=this.dataStreamChannelMap.get(e);return t&&(t.id&&this.recoveredDataChannelIds.push(t.id),t.close()),void this.dataStreamChannelMap.delete(e)}catch(e){throw e instanceof pN?e:new pN(hN.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(e.toString()))}}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter(t=>-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map(e=>{var t;IB(this.id+e.mid,this),e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);o&&(await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP.")));const a=this.peerConnection.getTransceivers().find(e=>e.mid===i);if(!a)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,id:i,transceiver:a}}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:n}=this.remoteSDP.batchSend(e);return n&&(await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),t.map(e=>{const t=this.peerConnection.getTransceivers().find(t=>t.mid===e);if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e,transceiver:t}})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");e.forEach(e=>{Array.from(this.preMediaMap.entries()).some(t=>{let[n,{mid:r,player:i}]=t;if(r===e)return this.preMediaMap.delete(n),i&&i.destroy(),!0})}),this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter(t=>t.mid&&-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map(e=>{e.direction="inactive"});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter(t=>t.mid&&-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map(async(e,t)=>{e.direction="sendonly"});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(e,this.remoteCodecs,this.store.codec);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return LA(function*(){const n=yield UA(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const n=pk().supportPCSetConfiguration,r=SP("FORCE_TURN_TCP")||t.forceTurn;if(e===vF.RELAY&&!n)return;if(n&&!r){const n=e===vF.RELAY?"relay":"all",r=t.peerConnection.getConfiguration();r.iceTransportPolicy!==n&&(nk.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(r.iceTransportPolicy,"] to [").concat(n,"]")),r.iceTransportPolicy=n,t.peerConnection.setConfiguration(r))}t.remoteSDP.updateCandidates(e);const i=yield UA(t.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const o=Nj(i.sdp),{remoteIceParameters:a}=yield o.iceParameters;t.remoteSDP.restartICE(a);const s=t.remoteSDP.toString(),c=t.logSDPExchange(i.sdp||"","offer","local","restartICE");t.store.descriptionStart(),yield UA(t.peerConnection.setLocalDescription(i)),null==c||c(s),yield UA(t.peerConnection.setRemoteDescription({type:"answer",sdp:s}))}catch(e){nk.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const e=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(vF.TCP_RELAY),await qj(this.peerConnection,this.remoteSDP,this.extension)}catch(e){nk.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),e)}finally{e()}}close(){var e;this.peerConnection.getTransceivers().forEach(e=>{IB(this.id+e.mid,this)}),this.preMediaMap.forEach(e=>{let{player:t}=e;t&&t.destroy()}),this.preMediaMap.clear(),this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return FB(FB({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const i=this.remoteSDP.toString(),o=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==o||o(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter(t=>t.mid===e);1===n.length&&(this.isVP8Simulcast(t)?VI()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find(e=>e.mid===t);n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:FB(FB({},YO),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:FB(FB({},YO),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;"connected"===this.peerConnection.connectionState&&(this.isFirstConnected=!0),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=e=>{if(e&&(e.errorCode||e.errorText)){var t;const n="code: ".concat(e.errorCode,", message: ").concat(e.errorText),r=e.port?"local: ".concat(e.port):"",i=gj(e.url||"");nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(n,"), url: ").concat(i||"",", host_candidate:").concat(r)),null===(t=this.onICECandidateError)||void 0===t||t.call(this,n)}},this.peerConnection.onicegatheringstatechange=e=>{e&&e.target&&"iceGatheringState"in e.target&&nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(e.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},SP("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]},r=t.cloudProxyServer||"disabled";return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&(FN(t.turnServer.servers)?n.iceServers=t.turnServer.servers:SP("NEW_TURN_MODE")&&n.iceServers&&"disabled"===r?(SP("USE_TURN_SERVER_OF_GATEWAY")?t.turnServer.serversFromGateway&&n.iceServers.push(...e.newTurnServerConfigToIceServers(t.turnServer.serversFromGateway)):n.iceServers.push(...e.newTurnServerConfigToIceServers(t.turnServer.servers)),SP("NEW_FORCE_TURN")&&(n.iceTransportPolicy="relay")):"off"!==t.turnServer.mode&&(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),SP("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),SP("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(e=>{e.forceturn&&(n.iceTransportPolicy="relay")}))),SP("ENABLE_ENCODED_TRANSFORM")&&pk().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach(e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!SP("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))}),t}static newTurnServerConfigToIceServers(e){const t=[];return e.forEach(e=>{const n=SP("NEW_TURN_MODE");1===n?t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=udp")}):2===n?t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=tcp")}):3===n?t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":443?transport=tcp")}):4===n&&(t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=udp")}),t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=tcp")}),t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":443?transport=tcp")}))}),t}tryBindTransportEvents(e){const t=e.transport;if(t){this.transportEventReceiver=e,t.onstatechange=()=>{var e;null!=t&&t.state&&(null===(e=this.onDTLSTransportStateChange)||void 0===e||e.call(this,t.state))},t.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const n=t.iceTransport;n&&(n.onstatechange=()=>{const e=null==t?void 0:t.iceTransport.state;var n;e&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,e))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:e,remote:t}=n.getSelectedCandidatePair()||{};if(e&&t){const n=e.address+":"+e.port,r=t.address+":"+t.port;nk.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(gj(n)),", remote ").concat(JSON.stringify(gj(r))))}}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n,r;if(!t){const n=this.peerConnection.getSenders();t=n.find(t=>t.track===e._mediaStreamTrack)}if(!t)return nk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return nk.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!pk().supportSetRtpSenderParameters)return nk.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const i={},o={};switch(e._optimizationMode){case"motion":i.degradationPreference="maintain-framerate";break;case"detail":i.degradationPreference="maintain-resolution";break;case"balanced":i.degradationPreference="balanced"}const a=_j(this.peerConnection,e._mediaStreamTrack),s=JD(e);if(wB(e)&&a&&t&&s&&this.getLocalVideoStats&&xr(n=["vp8","vp9"]).call(n,this.store.codec)){var c;const n=i.degradationPreference||(xr(c=e._hints).call(c,Uk.CUSTOM_TRACK)?SP("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");AB(this.id+a.mid,s,this,n,e=>{t&&this.updateAdaptation(t,e)},this.getLocalVideoStats.bind(this))}if(e._encoderConfig){var l;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(o.maxBitrate=1e3*t),(xr(l=e._hints).call(l,Uk.LOW_STREAM)||e.isUseScaleResolutionDownBy)&&(n&&(o.maxFramerate=lj(n)),r&&r>=1&&(o.scaleResolutionDownBy=r))}const{maxFramerate:d}=SP("ENCODER_CONFIG_LIMIT");if(d&&"number"==typeof d&&(o.maxFramerate=o.maxFramerate?Math.min(o.maxFramerate,d):d),SP("DSCP_TYPE")&&aN()){var u;const e=SP("DSCP_TYPE");xr(u=["very-low","low","medium","high"]).call(u,e)&&(o.networkPriority=e)}const h=t.getParameters(),p=null===(r=h.encodings)||void 0===r?void 0:r[0];VI()&&!p&&(i.encodings=[o]),p&&Object.assign(p,o),Object.assign(h,i),nk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(h.encodings))),await t.setParameters(h),await Zj(this.store.codec,t,SP("SVC_MODE"))}async updateAdaptation(e,t){var n,r;if(!e)return nk.debug("[updateAdaptation] no rtpSender found");if(!pk().supportSetRtpSenderParameters)return nk.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const i={},{bitrateMax:o,frameRate:a,scaleResolutionDownBy:s}=t;o&&(i.maxBitrate=1e3*o),a&&(i.maxFramerate=lj(a)),s&&s>=1&&xr(n=["vp8","vp9"]).call(n,this.store.codec)&&(i.scaleResolutionDownBy=s);const c=e.getParameters(),l=null===(r=c.encodings)||void 0===r?void 0:r[0];l&&Object.assign(l,i),Object.assign(c,{});try{await e.setParameters(c),nk.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(c.encodings)))}catch(t){!("transport"in e)||e.transport&&"connected"===e.transport.state?"connected"!==this.peerConnectionState?nk.debug("[updateAdaptation] peerConnection not connected}"):nk.debug("[updateAdaptation] updateRtpSenderEncodings failed",t):nk.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(e,t){try{if(!pk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];i instanceof xL&&!this.isVP8Simulcast(i)&&await this.updateRtpSenderEncodings(i,r.sender)}}catch(e){nk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){if(SP("FORBID_MODIFY_LOCAL_OFFER_SDP"))return e;const r=DP(e);return t.forEach((e,t)=>{const i=n[t],o=r.mediaDescriptions.find(e=>e.attributes.mid===i);o&&(xj(o,e),jj(o,e,this.store.codec))}),xP(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,i,o,a;const c=e[s],l=t[s];if(l instanceof xL&&!xr(n=l._hints).call(n,Uk.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(i=l._encoderConfig)||void 0===i?void 0:i.bitrateMax)>200&&null!==(o=l._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!VI()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof xL&&this.isVP8Simulcast(r)){const t=e[n],i={},o={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};i.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,i))}}}isVP8Simulcast(e){var t,n,r,i,o;return!!(e instanceof xL&&SP("SIMULCAST")&&"vp8"===this.store.codec&&!xr(t=e._hints).call(t,Uk.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(i=e._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(SP("SDP_LOGGING"))return nk.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return t&&0!==t.length?t[0].ssrcId:void 0}setConfiguration(t){if(pk().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}t.isPreallocation&&(this.isPreallocation=!0)}},PU(MB.prototype,"updateRemoteRTPCapabilities",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"updateRemoteRTPCapabilities"),MB.prototype),PU(MB.prototype,"connect",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"connect"),MB.prototype),PU(MB.prototype,"updateRemoteConnect",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"updateRemoteConnect"),MB.prototype),PU(MB.prototype,"createDataChannels",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"createDataChannels"),MB.prototype),PU(MB.prototype,"receive",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"receive"),MB.prototype),PU(MB.prototype,"batchReceive",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"batchReceive"),MB.prototype),PU(MB.prototype,"stopReceiving",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"stopReceiving"),MB.prototype),PU(MB.prototype,"muteRemote",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"muteRemote"),MB.prototype),PU(MB.prototype,"unmuteRemote",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"unmuteRemote"),MB.prototype),PU(MB.prototype,"muteLocal",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"muteLocal"),MB.prototype),PU(MB.prototype,"unmuteLocal",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"unmuteLocal"),MB.prototype),PU(MB.prototype,"close",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"close"),MB.prototype),PU(MB.prototype,"updateEncoderConfig",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"updateEncoderConfig"),MB.prototype),PU(MB.prototype,"updateSendParameters",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"updateSendParameters"),MB.prototype),PU(MB.prototype,"replaceTrack",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"replaceTrack"),MB.prototype),PU(MB.prototype,"updateAdaptation",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"updateAdaptation"),MB.prototype),PU(MB.prototype,"getRemoteSSRC",[VB],Object.getOwnPropertyDescriptor(MB.prototype,"getRemoteSSRC"),MB.prototype),MB);function VB(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}function BB(e,t){let n=document.createElement("video"),r=document.createElement("canvas");n.setAttribute("style","display:none"),r.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),r.width=lj(t.width),r.height=lj(t.height);const i=lj(t.framerate||15);document.body.append(n),document.body.append(r);let o=e._mediaStreamTrack;n.srcObject=new MediaStream([o]),n.play().catch(EO);const a=r.getContext("2d");if(!a)throw new uk(hN.UNEXPECTED_ERROR,"can not get canvas context");const s=pk(),c=r.captureStream(s.supportRequestFrame?0:i).getVideoTracks()[0];c.canvas||(c.canvas=r),r.startCapture=()=>{if(!n)return r.stopCapture&&r.stopCapture();if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const e=n.videoWidth,t=n.videoHeight/e,i=r.width*t;Math.abs(i-r.height)>=2&&(nk.debug("adjust low stream resolution","".concat(r.width,"x").concat(r.height," -> ").concat(r.width,"x").concat(i)),r.height=i)}a.drawImage(n,0,0,r.width,r.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,n.srcObject=new MediaStream([o]))},r.stopCapture=vD(()=>r.startCapture&&r.startCapture(),i);const l=c.stop;return c.stop=()=>{l.call(c),n&&(n.remove(),n.srcObject=null,n=null),r&&(r.width=0,r.remove(),r.stopCapture&&r.stopCapture(),r.startCapture=void 0,r.stopCapture=void 0,r=null),nk.debug("clean low stream renderer")},c}var WB=function(e){return e[e.Video_Send_Type=190]="Video_Send_Type",e}(WB||{}),HB=function(e){return e[e.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",e[e.Video_Send_Freeze=2082]="Video_Send_Freeze",e[e.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",e[e.Video_Recv_Freeze=2084]="Video_Recv_Freeze",e[e.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",e[e.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",e[e.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",e[e.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",e}(HB||{}),GB=function(e){return e[e.Video_Send_Retransmit=2062]="Video_Send_Retransmit",e[e.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",e[e.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",e[e.Video_Send_Transmit=2066]="Video_Send_Transmit",e[e.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",e[e.Video_Capture_Height=2033]="Video_Capture_Height",e[e.Video_Capture_Width=2035]="Video_Capture_Width",e[e.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",e[e.Video_Send_Low_Height=2073]="Video_Send_Low_Height",e[e.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",e[e.Video_Send_Low_Width=2077]="Video_Send_Low_Width",e[e.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",e[e.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",e[e.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",e[e.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",e[e.Video_Send_Width=2003]="Video_Send_Width",e[e.Video_Send_Height=2004]="Video_Send_Height",e[e.Video_Send_Disabled=2095]="Video_Send_Disabled",e[e.Video_Send_Adaptation=2032]="Video_Send_Adaptation",e[e.Video_Send_Player_Status=2128]="Video_Send_Player_Status",e[e.Video_Send_Nacks=2009]="Video_Send_Nacks",e[e.Video_Send_Plis=2010]="Video_Send_Plis",e[e.Video_Send_Firs=2011]="Video_Send_Firs",e[e.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",e[e.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",e[e.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",e[e.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",e[e.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",e[e.Video_Send_Bitrate=2012]="Video_Send_Bitrate",e[e.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",e[e.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",e[e.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",e[e.Audio_Send_Level=2038]="Audio_Send_Level",e[e.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",e[e.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",e[e.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",e[e.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",e[e.Audio_Send_Freeze=2081]="Audio_Send_Freeze",e[e.Audio_Send_Disabled=2096]="Audio_Send_Disabled",e[e.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",e[e.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",e[e.Video_Recv_Height=2019]="Video_Recv_Height",e[e.Video_Recv_Width=2018]="Video_Recv_Width",e[e.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",e[e.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",e[e.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",e[e.Video_Recv_Nacks=2026]="Video_Recv_Nacks",e[e.Video_Recv_Plis=2027]="Video_Recv_Plis",e[e.Video_Recv_Firs=2028]="Video_Recv_Firs",e[e.Video_Recv_Disabled=2101]="Video_Recv_Disabled",e[e.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",e[e.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",e[e.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",e[e.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",e[e.Audio_Render_Level=2043]="Audio_Render_Level",e[e.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",e[e.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",e[e.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",e[e.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",e[e.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",e[e.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",e[e.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",e[e.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",e[e.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",e[e.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",e[e.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",e[e.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",e}(GB||{}),zB=function(e){return e[e.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",e[e.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",e[e.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",e[e.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",e[e.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",e[e.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",e[e.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",e[e.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",e[e.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",e[e.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",e[e.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",e[e.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",e[e.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",e[e.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",e[e.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",e[e.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",e[e.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",e[e.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",e[e.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",e[e.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",e[e.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",e[e.Audio_Recv_AV_Sync_TIME=2237]="Audio_Recv_AV_Sync_TIME",e}(zB||{}),KB=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e[e.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",e}(KB||{}),YB=function(e){return e[e.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",e[e.PAGE_VISIBILITY=2233]="PAGE_VISIBILITY",e}(YB||{}),qB=function(e){return e[e.Transport_Send_Bitrate=2234]="Transport_Send_Bitrate",e[e.Transport_Recv_Bitrate=2235]="Transport_Recv_Bitrate",e}(qB||{});const XB=1e3,JB=6,ZB=3,QB=Math.max(JB,ZB,60);function $B(e,t,n){null!=n&&Number.isFinite(n)&&(e[t]=Math.round(Math.max(0,n)))}function eW(e){const t={[KB.CONN_TYPE]:0,[KB.RTT]:e.rtt,[KB.STATS_UPDATE_INTERVAL]:e.updateInterval?Math.round(Math.max(0,e.updateInterval)):void 0};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const n=e.selectedCandidatePair.localCandidate.relayProtocol;"udp"===n&&(t[KB.CONN_TYPE]=1),"tcp"===n&&(t[KB.CONN_TYPE]=3),"tls"===n&&(t[KB.CONN_TYPE]=4);break}case"srflx":t[KB.CONN_TYPE]=2;break;case"unknown":t[KB.CONN_TYPE]=5;break;default:t[KB.CONN_TYPE]=0}return t}function tW(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}class nW extends ON{constructor(e){super(),nR(this,"store",void 0),nR(this,"uploadWRTCStatsTimer",void 0),nR(this,"uploadOutboundDenoiserStatsTimer",void 0),nR(this,"uploadExtStatsTimer",void 0),nR(this,"uploadExtUsageStatsTimer",void 0),nR(this,"uploadInboundExtStatsTimer",void 0),nR(this,"requestStats",void 0),nR(this,"requestTransportStats",void 0),nR(this,"requestLocalMedia",void 0),nR(this,"requestRemoteMedia",void 0),nR(this,"requestAllTracks",void 0),nR(this,"requestVideoIsReady",void 0),nR(this,"requestUploadStats",void 0),nR(this,"requestUpload",void 0),nR(this,"uploadOutboundStarted",!1),nR(this,"uploadInboundStarted",!1),nR(this,"uploadTransportStarted",!1),nR(this,"uploadBaseStatsStarted",!1),nR(this,"uploadExtensionUsageStarted",!1),nR(this,"lastRecvStats",void 0),nR(this,"lastSendStats",void 0),nR(this,"lastRefRecvStats",void 0),nR(this,"lastRefSendStats",void 0),nR(this,"lastNormalRecvStats",void 0),nR(this,"lastNormalSendStats",void 0),nR(this,"lastExtendStats",{}),nR(this,"needUploadStats",{}),nR(this,"needUploadRenderFreezeTime",!0),nR(this,"lastUploadCompensateTime",-1),nR(this,"uploadCompensateDeltaTime",0),this.store=e}uploadWRTCStats(e){if(!this.requestStats||!this.requestUploadStats)return;const t=e%ZB==0,n=e%JB==0,r=e%60==0;let i,o;if(this.uploadTransportStarted&&(i=this.requestStats(),this.store.useP2P&&(o=this.requestStats(!0))),!i&&this.uploadOutboundStarted&&(i=this.requestStats()),!o&&this.uploadInboundStarted&&(o=this.requestStats(!0)),i||o){var a;const s={};if(this.uploadTransportStarted&&i){const e=this.getTransportStats(i,t?this.lastRefSendStats:void 0,o,t);e&&(s.misc=[e])}if(this.uploadOutboundStarted&&i){const e=this.getOutboundStats(i,n?this.lastNormalSendStats:void 0,t?this.lastRefSendStats:void 0,this.lastSendStats,r);e&&(s.outbound=[e])}if(this.uploadInboundStarted&&o){this.uploadCompensateStats(e);const r=this.getInboundStats(o,n?this.lastNormalRecvStats:void 0,t?this.lastRefRecvStats:void 0,this.lastRecvStats);r&&(s.inbound=r)}const c=null===(a=this.requestTransportStats)||void 0===a?void 0:a.call(this).connectState;if(c&&(Array.isArray(s.misc)?s.misc[0]&&s.misc[0].addition&&(s.misc[0].addition[YB.RTC_PEER_CONNECTION_STATE]=rP[c]):s.misc=[{addition:{[YB.RTC_PEER_CONNECTION_STATE]:rP[c]}}]),eM.needUploadStats.length>0||n){const e=eM.needUploadStats.shift()||("visible"===eM.visibility?1:0);Array.isArray(s.misc)?s.misc[0]&&s.misc[0].addition&&(s.misc[0].addition[YB.PAGE_VISIBILITY]=e):s.misc=[{addition:{[YB.PAGE_VISIBILITY]:e}}]}this.needUploadStats.sendType&&(Array.isArray(s.outbound)&&s.outbound[0]&&s.outbound[0].high&&(s.outbound[0].high[WB.Video_Send_Type]=this.needUploadStats.sendType),this.needUploadStats.sendType=void 0),this.requestUploadStats(s)}this.lastRecvStats=o,this.lastSendStats=i,n&&(this.lastNormalRecvStats=o,this.lastNormalSendStats=i),t&&(this.lastRefRecvStats=o,this.lastRefSendStats=i)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0,eM.startCollectStats();let e=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var t,n;const e=null===(t=this.requestTransportStats)||void 0===t?void 0:t.call(this);return void(e&&(null===(n=this.requestUploadStats)||void 0===n||n.call(this,{misc:[{addition:{[YB.RTC_PEER_CONNECTION_STATE]:rP[e.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(e),++e===QB+1&&(e=1)},XB)}uploadCompensateStats(e){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const t=e%ZB==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!t)return;if(-1===this.lastUploadCompensateTime)return void(this.lastUploadCompensateTime=Date.now());const n=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=n,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const r=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*r;const i=this.requestStats(!0);new Array(r).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const e={};if(this.uploadInboundStarted&&i){const t=this.requestRemoteMedia()||[],n=[];t.forEach(e=>{let[t,r]=e;const o={peer:t.uid};if(t._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(t._videoSSRC)&&r.has(_F.VIDEO)&&t.videoTrack){const e=function(e,t,n){if(!t.videoRecv.find(t=>t.ssrc===e))return;const r={};if(n&&n._player){const e=n._player,{renderFreezeAccTime2:t,videoElementStatus:i}=e;if("visible"===eM.visibility&&i===tD.PLAYING&&pk().supportRequestVideoFrameCallback){const n=Math.min(6e3,t);e.renderFreezeAccTime2=Math.max(0,t-n),$B(r,HB.Video_Render_Freeze_Time_Render2,n),SP("USE_NEW_RENDER_FREEZE_TIME")&&$B(r,HB.Video_Render_Freeze_Time_Render,n)}}return r}(t._videoSSRC,i,t.videoTrack);e&&(o.video=e)}o.video&&n.push(o)}),n.length>0&&(e.inbound=n,this.requestUploadStats(e))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(e,t,n,r){if(!this.requestStats)return;if(!r)return null==e.rtt?void 0:{addition:{[KB.RTT]:e.rtt,[KB.CONN_TYPE]:void 0,[KB.STATS_UPDATE_INTERVAL]:e.updateInterval||void 0}};const i=eW(e);if(this.store.useP2P){if(n){const e=eW(n);i[KB.CONN_TYPE]&&e[KB.CONN_TYPE]&&(i[KB.CONN_TYPE]+=e[KB.CONN_TYPE]<<3)}i[KB.CONN_TYPE]?i[KB.CONN_TYPE]+=110:i[KB.CONN_TYPE]=110}else{i[KB.CONN_TYPE]?i[KB.CONN_TYPE]+=100:i[KB.CONN_TYPE]=100;const n=function(e,t){return t?[Math.ceil(8*(e.transport.bytesSent-t.transport.bytesSent)/(e.timestamp-t.timestamp)),Math.ceil(8*(e.transport.bytesReceived-t.transport.bytesReceived)/(e.timestamp-t.timestamp))]:[0,0]}(e,t);i[qB.Transport_Send_Bitrate]=n[0],i[qB.Transport_Recv_Bitrate]=n[1]}return{addition:i}}getOutboundStats(e,t,n,r,i){if(!this.requestUploadStats||!this.requestLocalMedia)return;const o=this.requestLocalMedia();if(!o||0===o.length)return;let a,s,c;return o.forEach(r=>{let[o,{track:l,ssrcs:d}]=r;switch(o){case yF.LocalVideoLowTrack:case yF.LocalVideoTrack:if(o===yF.LocalVideoTrack){var u;const r=function(e,t,n,r,i){const o=t.videoSend.find(t=>t.ssrc===e);if(!o)return;const a={},{sentFrame:s,inputFrame:c}=o;if(r&&($B(a,HB.Video_Send_Qp_Sum,o.qpSumPerFrame),c&&s)){const e=c.frameRate,t=s.frameRate;a[HB.Video_Send_Freeze]=function(e,t){let n=!0;return n=!(e<=5)&&(e<=10?t<3:e<=20?t<4:t<5),n}(e,t)?1:0}if(i){switch(s&&($B(a,GB.Video_Send_Height,s.height),$B(a,GB.Video_Send_Width,s.width),$B(a,GB.Video_Send_Frame_Rate,s.frameRate)),a[GB.Video_Send_Disabled]=n._originMediaStreamTrack&&!n._originMediaStreamTrack.enabled||n._mediaStreamTrack&&!n._mediaStreamTrack.enabled?1:0,o.adaptionChangeReason){case"none":a[GB.Video_Send_Adaptation]=0;break;case"cpu":a[GB.Video_Send_Adaptation]=1;break;case"bandwidth":a[GB.Video_Send_Adaptation]=2;break;case"other":a[GB.Video_Send_Adaptation]=3}let r=0;o.adaptionChangeReason&&(r+=tW(o.adaptionChangeReason)),t.qualityLimitationReason&&(r+=tW(t.qualityLimitationReason)<<3),a[GB.Video_Send_Adaptation]=r,a[GB.Video_Send_Player_Status]=rD[n._player?n._player.videoElementStatus:"uninit"],$B(a,GB.Video_Send_Nacks,o.nacksCount),$B(a,GB.Video_Send_Plis,o.plisCount),$B(a,GB.Video_Send_Firs,o.firsCount),$B(a,GB.Video_Send_Avg_Encode,o.avgEncodeMs),$B(a,GB.Video_Send_Huge_Frame_Sent,o.hugeFramesSent),$B(a,GB.Video_Send_Bytes_Retransmit,o.retransmittedBytesSent),$B(a,GB.Video_Send_Packages_Retransmit,o.retransmittedPacketsSent),$B(a,GB.Video_Send_Key_Frames_Encoded,o.keyFramesEncoded);const c=i.videoSend.find(t=>t.ssrc===e);if(c){let e=XB*ZB;c.timestamp&&o.timestamp&&(e=o.timestamp-c.timestamp),null!=c.packets&&null!=o.packets&&$B(a,GB.Video_Send_Package_Rate,1e3*(o.packets-c.packets)/e),null!=o.packetsLost&&null!=c.packetsLost&&$B(a,GB.Video_Send_Package_Lost,o.packetsLost-c.packetsLost),null!=c.bytes&&null!=o.bytes&&$B(a,GB.Video_Send_Bitrate,8*(o.bytes-c.bytes)/e)}}return a}(d[0].ssrcId,e,l,t,n),o="CameraVideoTrack"===l.__className__?3:xr(u=l._hints).call(u,Uk.SCREEN_TRACK)?7:10;(this.lastExtendStats.sendType!==o||i)&&(this.needUploadStats={sendType:o},this.lastExtendStats.sendType=o);const a=l&&function(e,t,n,r){const i=t.videoSend.find(t=>t.ssrc===e);if(!i)return null;const o={};if(r){const e=i.inputFrame,t=e&&e.height||n.videoHeight||0,r=e&&e.width||n.videoWidth||0,a=e&&e.frameRate||0;$B(o,GB.Video_Capture_Height,t),$B(o,GB.Video_Capture_Width,r),$B(o,GB.Video_Capture_Frame_Rate,a)}return o}(d[0].ssrcId,e,l,!!n),c=function(e,t){const n={};return t&&($B(n,GB.Video_Send_Retransmit,e.bitrate.retransmit),$B(n,GB.Video_Send_Target_Encoded,e.bitrate.targetEncoded),$B(n,GB.Video_Send_Actual_Encoded,e.bitrate.actualEncoded),$B(n,GB.Video_Send_Transmit,e.bitrate.transmit),$B(n,GB.Video_Send_Bandwidth,e.sendBandwidth)),n}(e,!!n);s=Object.assign({},r,a,c)}else c=function(e,t,n,r){const i=t.videoSend.find(t=>t.ssrc===e);if(!i)return;const o={};if(r){const t=i.sentFrame;t&&($B(o,GB.Video_Send_Low_Height,t.height),$B(o,GB.Video_Send_Low_Width,t.width),$B(o,GB.Video_Send_Low_Frame_Rate,t.frameRate));const n=r.videoSend.find(t=>t.ssrc===e);if(n){let e=XB*JB;n.timestamp&&i.timestamp&&(e=i.timestamp-n.timestamp),null!=n.packets&&null!=i.packets&&$B(o,GB.Video_Send_Low_Package_Rate,1e3*(i.packets-n.packets)/e),null!=i.packetsLost&&null!=n.packetsLost&&$B(o,GB.Video_Send_Low_Package_Lost,i.packetsLost-n.packetsLost),null!=n.bytes&&null!=i.bytes&&$B(o,GB.Video_Send_Low_Bitrate,8*(i.bytes-n.bytes)/e)}}return o}(d[0].ssrcId,e,0,n);break;case yF.LocalAudioTrack:a=l&&function(e,t,n,r,i){const o=t.audioSend.find(t=>t.ssrc===e);if(!o)return;const a={};if(i){a[GB.Audio_Send_Disabled]=n._originMediaStreamTrack&&!n._originMediaStreamTrack.enabled||n._mediaStreamTrack&&!n._mediaStreamTrack.enabled?1:0;const t=100*n._source.getAccurateVolumeLevel(),r=o.inputLevel;if(null!=r){const e=Math.ceil(50*Math.log10(100*r+1));$B(a,GB.Audio_Send_Level,e)}$B(a,GB.Audio_Capture_PCM_Level,t),$B(a,GB.Audio_Send_AEC_Return_Loss,o.aecReturnLoss),$B(a,GB.Audio_Send_AEC_Return_Loss_Enhancement,o.aecReturnLossEnhancement),$B(a,GB.Audio_Send_Bytes_Retransmit,o.retransmittedBytesSent),$B(a,GB.Audio_Send_Packages_Retransmit,o.retransmittedPacketsSent),a[GB.Audio_Send_Freeze]=0;const s=i.audioSend.find(t=>t.ssrc===e);if(s){let e=XB*JB;s.timestamp&&o.timestamp&&(e=o.timestamp-s.timestamp),null!=s.bytes&&null!=o.bytes&&$B(a,GB.Audio_Send_Bitrate,8*(o.bytes-s.bytes)/e),null!=s.packets&&null!=o.packets&&$B(a,GB.Audio_Send_Package_Rate,1e3*(o.packets-s.packets)/e)}}return a}(d[0].ssrcId,e,l,0,n)}}),{high:s,low:c,audio:a}}getInboundStats(e,t,n,r){if(!this.requestRemoteMedia)return;const i=this.requestRemoteMedia()||[],o=[];return i.forEach(i=>{let[a,s]=i;const c={peer:a.uid};let l;if(s.has(_F.VIDEO)&&a.videoTrack){const i=a._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(a._videoSSRC)||!1,o=a.videoTrack?function(e,t,n,r,i,o,a,s){const c=t.videoRecv.find(t=>t.ssrc===e);if(!c)return;const l={},{receivedFrame:d,outputFrame:u,decodeFrameRate:h}=c;$B(l,zB.Video_Render_Frame_Rate_Decode,h),c.framesRateFirefox&&$B(l,zB.Video_Recv_Frame_Rate,c.framesRateFirefox),d&&$B(l,zB.Video_Recv_Frame_Rate,d.frameRate),$B(l,zB.Video_Recv_Frame_Dropped,c.framesDroppedCount),$B(l,zB.Video_Recv_Bytes_Retransmit,c.retransmittedBytesReceived),$B(l,zB.Video_Recv_Packages_Retransmit,c.retransmittedPacketsReceived),$B(l,zB.Video_Recv_Packages_Discarded,c.packetsDiscarded),$B(l,zB.Video_Recv_Avg_Decode,c.avgDecodeMs),$B(l,zB.Video_Recv_Avg_Processing_Delay,c.avgProcessingDelayMs),$B(l,zB.Video_Recv_Avg_Assembly_Time,c.avgFramesAssembledFromMultiplePacketsMs),$B(l,zB.Video_Recv_Avg_Inter_Frame_Delay,c.avgInterFrameDelayMs),$B(l,zB.Video_Recv_Key_Frames_Decoded,c.keyFramesDecoded);const p=s&&s.videoRecv.find(t=>t.ssrc===e);if(p){const e=t.timestamp-s.timestamp||XB;null!=c.packetsLost&&null!=p.packetsLost&&$B(l,zB.Video_Recv_Package_Lost,c.packetsLost-p.packetsLost),null!=p.bytes&&null!=c.bytes&&$B(l,zB.Video_Recv_Bitrate,8*(c.bytes-p.bytes)/e),null!=p.packets&&null!=c.packets&&$B(l,zB.Video_Recv_Package_Rate,1e3*(c.packets-p.packets)/e)}const m=o&&o.videoRecv.find(t=>t.ssrc===e);if(m&&($B(l,HB.Video_Recv_Qp_Sum,c.qpSumPerFrame),l[HB.Video_Recv_Freeze]=r&&iB.isRemoteVideoFreeze(n,c,m)?1:0),a){var f;const t=a.videoRecv.find(t=>t.ssrc===e);d?($B(l,GB.Video_Recv_Height,d.height),$B(l,GB.Video_Recv_Width,d.width)):n&&($B(l,GB.Video_Recv_Height,n._videoHeight||0),$B(l,GB.Video_Recv_Width,n._videoWidth||0)),u&&$B(l,GB.Video_Recv_Frame_Rate_Output,u.frameRate);const r=null===(f=n._player)||void 0===f?void 0:f.rendFrameRate.toFixed(0);if(r&&$B(l,GB.Video_Render_Frame_Rate_Render,+r),$B(l,GB.Video_Recv_Jitter_Buffer,c.jitterBufferMs),$B(l,GB.Video_Recv_Current_Delay,c.currentDelayMs),$B(l,GB.Video_Recv_Firs,c.firsCount),$B(l,GB.Video_Recv_Nacks,c.nacksCount),$B(l,GB.Video_Recv_Plis,c.plisCount),n){l[GB.Video_Recv_Disabled]=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?0:1;const e=n._player;if(e){const{freezeTimeCounterList:n,renderFreezeAccTime:r,renderFreezeAccTime2:o,videoElementStatus:a}=e;if(n&&n.length>0&&$B(l,HB.Video_Render_Freeze_Time,n.splice(0,1)[0]),i&&"visible"===eM.visibility&&a===tD.PLAYING&&pk().supportRequestVideoFrameCallback){const t=Math.min(6e3,o);e.renderFreezeAccTime2=Math.max(0,o-t),$B(l,HB.Video_Render_Freeze_Time_Render2,t);const n=Math.min(6e3,r);e.renderFreezeAccTime=Math.max(0,r-n),$B(l,HB.Video_Render_Freeze_Time_Render,SP("USE_NEW_RENDER_FREEZE_TIME")?t:n)}if("number"==typeof c.totalFreezesDuration){const e=t&&t.totalFreezesDuration?c.totalFreezesDuration-t.totalFreezesDuration:c.totalFreezesDuration;$B(l,GB.Video_Render_Freeze_Duration,1e3*e)}}}if(l[GB.Video_Recv_Player_Status]=rD[n._player?n._player.videoElementStatus:"uninit"],t&&void 0!==c.totalInterFrameDelay&&void 0!==c.totalSquaredInterFrameDelay&&void 0!==t.totalInterFrameDelay&&void 0!==t.totalSquaredInterFrameDelay){const e=c.totalInterFrameDelay-t.totalInterFrameDelay,n=c.totalSquaredInterFrameDelay-t.totalSquaredInterFrameDelay,r=c.framesDecodeCount-t.framesDecodeCount,i=e/r*1e3,o=Math.round(1e3*Math.sqrt((n-Math.pow(e,2)/r)/r));!isNaN(o)&&i+o>Math.max(3*i,i+150)&&(l[GB.Video_Recv_I_Frame_Delay]=o)}}return l}(a._videoSSRC,e,a.videoTrack,!0===i,this.needUploadRenderFreezeTime,t,n,r):void 0;if(o&&(c.video=o),a.videoTrack){const t=e.videoRecv.find(e=>e.ssrc===a._videoSSRC);t&&t.estimatedPlayoutTimestamp&&(l=t.estimatedPlayoutTimestamp)}}if(s.has(_F.AUDIO)&&a.audioTrack){const i=a.audioTrack?function(e,t,n,r,i,o){const a=t.audioRecv.find(t=>t.ssrc===e);if(!a)return;const s={};$B(s,zB.Audio_Recv_Jitter,a.jitterMs),$B(s,zB.Audio_Recv_Bytes_Retransmit,a.retransmittedBytesReceived),$B(s,zB.Audio_Recv_Packages_Retransmit,a.retransmittedPacketsReceived),$B(s,zB.Audio_Recv_Packages_Discarded,a.packetsDiscarded),$B(s,zB.Audio_Recv_Avg_Processing_Delay,a.avgProcessingDelayMs);const c=o&&o.audioRecv.find(t=>t.ssrc===e);if(c){const e=XB;null!=a.packets&&null!=c.packets&&$B(s,zB.Audio_Recv_Package_Rate,1e3*(a.packets-c.packets)/e),null!=a.packetsLost&&null!=c.packetsLost&&$B(s,zB.Audio_Recv_Package_Lost,a.packetsLost-c.packetsLost)}if(r){const{receivedFrames:e,droppedFrames:t}=a;null!=e&&null!=t&&(s[HB.Audio_Recv_Freeze]=0===(l=e)||100*t/l>20?1:0)}var l;if(i){const t=100*n._source.getAccurateVolumeLevel(),r=a.outputLevel;if(null!=r){const e=Math.ceil(50*Math.log10(100*r+1));$B(s,GB.Audio_Render_Level,e)}$B(s,GB.Audio_Recv_PCM_Level,t),n&&(s[GB.Audio_Recv_Disabled]=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?0:1),$B(s,GB.Audio_Recv_Jitter_Buffer,a.jitterBufferMs),$B(s,GB.Audio_Recv_Current_Delay,a.jitterBufferMs),s[GB.Audio_Recv_Player_Status]=rD[FD.getPlayerState(n.getTrackId())];const o=i.audioRecv.find(t=>t.ssrc===e);if(o){null!=o.bytes&&null!=a.bytes&&$B(s,GB.Audio_Recv_Bitrate,8*(a.bytes-o.bytes)/(XB*ZB));const e=a.concealedSamples-o.concealedSamples;e>0&&$B(s,GB.Audio_Recv_Concealed_Samples,e);const t=a.totalSamplesReceived-o.totalSamplesReceived;t>0&&$B(s,GB.Audio_Recv_Total_Samples_Received,t);const n=a.freezeSamples80-o.freezeSamples80;n>0&&$B(s,GB.Audio_Render_Freeze_Samples_80ms,n);const r=a.freezeSamples200-o.freezeSamples200;r>0&&$B(s,GB.Audio_Render_Freeze_Samples_200ms,r);const i=a.freezeMs80-o.freezeMs80;$B(s,GB.Audio_Render_Freeze_Time_80ms,i<0?0:i);const c=a.freezeMs200-o.freezeMs200;$B(s,GB.Audio_Render_Freeze_Time_200ms,c<0?0:c)}}return s}(a._audioSSRC,e,a.audioTrack,t,n,r):void 0;if(i&&(c.audio=i),a.audioTrack&&l){const t=e.audioRecv.find(e=>e.ssrc===a._audioSSRC);if(t&&t.estimatedPlayoutTimestamp){const e=t.estimatedPlayoutTimestamp-l;c.audio?c.audio[zB.Audio_Recv_AV_Sync_TIME]=e:c.audio={[zB.Audio_Recv_AV_Sync_TIME]:e}}}}(c.video||c.audio)&&o.push(c)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,o}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const e=(this.requestAllTracks()||[]).find(e=>e instanceof Bx);if(e&&e._external.getDenoiserStats){const t=e._external.getDenoiserStats();t&&this.requestUpload(VU.DENOISER_STATS,t)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{this.requestAllTracks&&this.requestUpload&&this.requestAllTracks().forEach(e=>{e.getProcessorStats().forEach(e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastExtendStats={},this.needUploadStats={},this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{this.requestUpload&&this.requestRemoteMedia&&(this.requestRemoteMedia()||[]).forEach(e=>{let[t,n]=e;n.has(_F.VIDEO)&&t.videoTrack&&t.videoTrack.getProcessorStats().forEach(e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}),n.has(_F.AUDIO)&&t.audioTrack&&t.audioTrack.getProcessorStats().forEach(e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const e=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const t=Date.now(),n={connectionInterval:SP("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:t};let r=[];const i=this.requestAllTracks&&this.requestAllTracks()||[];for(const e of i)!e.muted&&e.enabled&&(r=r.concat(await e.getProcessorUsage()));const o=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[e,c]of o)c.has(_F.VIDEO)&&e.videoTrack&&(r=r.concat(await e.videoTrack.getProcessorUsage())),c.has(_F.AUDIO)&&e.audioTrack&&(r=r.concat(await e.audioTrack.getProcessorUsage()));if(0===r.length)return;n.details=function(e,t){const n={};for(const{id:a,value:s,level:c,direction:l}of e){var r;const e=null!==(r=t.get(a))&&void 0!==r?r:0,d=2===s?e+SP("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:e;var i,o;t.set(a,d),n[a]?(2===s&&(n[a].value=s),c>n[a].level&&(n[a].level=c),"remote"===l&&(n[a].remoteUidCount+=1),n[a].totalTs=null!==(i=t.get(a))&&void 0!==i?i:0):n[a]={value:s,level:c,remoteUidCount:"local"===l?0:1,totalTs:null!==(o=t.get(a))&&void 0!==o?o:0}}return Object.keys(n).map(e=>{const{level:t,value:r,totalTs:i}=n[e];return{id:e,level:t,value:r,totalTs:i}})}(r,e);const a=Date.now(),s=a>t?a:t+1;this.requestUpload&&this.requestUpload(VU.EXTENSION_USAGE_STATS,{usageStats:n,sendTs:s})},SP("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1,eM.stopCollectStats()}}const rW=SP("ICE_RESTART_INTERVAL");let iW=new Map,oW=new Map,aW=[vF.UDP_TCP_RELAY,vF.TCP_RELAY,vF.RELAY],sW=SP("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&pk().supportPCSetConfiguration;function cW(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=iW.get(e.id);n&&(window.clearTimeout(n),iW.delete(e.id));const r=oW.get(e.id);t&&r&&r.index===aW.length-1&&(nk.debug("[".concat(e.id,"] reset ICE restart policy")),oW.delete(e.id))}function lW(e,t,n){if(0===iW.size&&0===oW.size&&(Array.isArray(SP("RESTART_SEQUENCE"))&&SP("RESTART_SEQUENCE").length>0&&!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1){const r=e[n];if(e.filter(e=>e===r).length!==t.filter(e=>e===r).length)return!1}return!0}(aW,SP("RESTART_SEQUENCE"))&&(aW=SP("RESTART_SEQUENCE").filter(e=>{var t;if(xr(t=Object.values(vF)).call(t,e))return!0}),nk.debug("use reconnection policy from config distribution, queues: ".concat(aW.join(" => ")))),sW=SP("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&pk().supportPCSetConfiguration),0===aW.length)return void n();let r,{index:i=0,type:o}=oW.get(e.id)||{};if(sW&&o===vF.RELAY)return void n();let a=o&&i>=aW.length-1;if(sW)o=vF.RELAY;else{if(a)return void n();o?(i++,o=aW[i]):(o=aW[0],i=0)}nk.debug("[".concat(e.id,"] choose ICE restart policy: ").concat(o,", index: ").concat(i)),t(o),oW.set(e.id,{index:i,type:o}),r=window.setTimeout(()=>lW(e,t,n),rW),iW.set(e.id,r)}var dW;function uW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hW(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uW(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uW(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pW(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=jA,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new mW(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function mW(e){function t(e){if(Object(e)!==e)return ip.reject(new TypeError(e+" is not an object."));var t=e.done;return ip.resolve(e.value).then(function(e){return{value:e,done:t}})}return mW=function(e){this.s=e,this.n=e.next},mW.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?ip.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?ip.reject(e):t(n.apply(this.s,arguments))}},new mW(e)}let fW=(dW=class extends ON{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(TF.StateChange,t,this._state)}constructor(e,t){super(),nR(this,"isPlanB",void 0),nR(this,"store",void 0),nR(this,"statsUploader",void 0),nR(this,"connection",void 0),nR(this,"localTrackMap",new Map),nR(this,"remoteUserMap",new Map),nR(this,"localDataChannels",[]),nR(this,"remoteDataChannelMap",new Map),nR(this,"pendingLocalTracks",[]),nR(this,"pendingRemoteTracks",[]),nR(this,"pendingLocalDataChannels",[]),nR(this,"pendingRemoteDataChannels",[]),nR(this,"statsCollector",void 0),nR(this,"shouldForwardP2PCreation",void 0),nR(this,"iceFailedCount",0),nR(this,"dtlsFailedCount",0),nR(this,"mutex",void 0),nR(this,"_state",SF.Disconnected),nR(this,"_pcStatsUploadType",SP("NEW_ICE_RESTART")?bF.FIRST_CONNECTION:bF.OLD_FIRST_CONNECTION),nR(this,"_isStartRestartIce",!1),nR(this,"_restartTimer",void 0),nR(this,"_isTryConnecting",!1),nR(this,"_iceError",null),nR(this,"_forceTurn",!1),nR(this,"_isWaitPcToRePub",!1),nR(this,"handleMuteLocalTrack",async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==SF.Connected)return void n(new pN(hN.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const r=this.filterTobeMutedTracks(e);if(0===r.length)return void t();const i=r.find(e=>"videoLowTrack"===e[0]);if(i){const e=i[1];this.store.enableInstantMuteRestore?(e.track._originMediaStreamTrack.enabled=!1,nk.info("[".concat(this.store.clientId,"] P2PChannel muteLocalLowTrack without close sender because enableInstantMuteRestore is true"))):e.track._originMediaStreamTrack.stop()}this.store.enableInstantMuteRestore?nk.info("[".concat(this.store.clientId,"] P2PChannel muteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.muteLocal(r.map(e=>{let[,{id:t}]=e;return t}));const o=this.createMuteMessage(r);await qN(this,TF.RequestMuteLocal,o),t()}catch(e){n(e)}finally{r()}}),nR(this,"handleUnmuteLocalTrack",async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==SF.Connected)return void n(new pN(hN.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const r=this.filterTobeUnmutedTracks(e);if(0===r.length)return void t();const i=r.find(e=>"videoLowTrack"===e[0]);if(i){const t=i[1];if(this.store.enableInstantMuteRestore)t.track._originMediaStreamTrack.enabled=!0,nk.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalLowTrack without close sender because enableInstantMuteRestore is true"));else{if(t.track._originMediaStreamTrack.stop(),!SP("DISABLE_DUAL_STREAM_USE_ENCODING")&&pk().supportDualStreamEncoding){const n=e._mediaStreamTrack.clone();t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}else{const n=BB(e,JN(this,TF.RequestLowStreamParameter));t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}await new ip((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)})}}this.store.enableInstantMuteRestore?nk.info("[".concat(this.store.clientId,"] P2PChannel unmuteLocalTrack without close sender because enableInstantMuteRestore is true")):await this.connection.unmuteLocal(r.map(e=>{let[,{id:t}]=e;return t}));const o=this.createUnmuteMessage(r);await qN(this,TF.RequestUnmuteLocal,o),t()}catch(e){n(e)}finally{r()}}),nR(this,"handleUpdateVideoEncoder",async(e,t,n,r)=>{let i;r||(i=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const n=this.localTrackMap.get(yF.LocalVideoTrack);if(!this.connection||!n||n.track!==e||this.state!==SF.Connected)return void t();const{id:r,track:i}=n;await this.connection.updateSendParameters(r,i),await this.connection.updateEncoderConfig(r,i),this.emit(TF.UpdateVideoEncoder,i),t()}catch(e){n(e)}finally{var o;null===(o=i)||void 0===o||o()}}),nR(this,"handleUpdateVideoSendParameters",async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const n=this.localTrackMap.get(yF.LocalVideoTrack);if(!this.connection||!n||n.track!==e||this.state!==SF.Connected)return void t();const{id:r,track:i}=n;await this.connection.updateSendParameters(r,i),t()}catch(e){n(e)}finally{r()}}),nR(this,"handleReplaceMixingTrack",async(e,t,n,r)=>{if(!this.connection||this.state!==SF.Connected)return void t();const i=PB([e]);let o;nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(i.getTrackId(),"]")),"boolean"==typeof r&&r||(o=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(e,i),t()}catch(e){n(e)}finally{var a;null===(a=o)||void 0===a||a()}}),nR(this,"handleReplaceTrack",async(e,t,n,r)=>{let i;nk.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(i=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var o;const n=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(!this.connection||!n||this.state!==SF.Connected)return void t();if(await(null===(o=this.connection)||void 0===o?void 0:o.replaceTrack(e,n[1].id)),this.isPlanB){const t=n[1];t.id=e._mediaStreamTrack.id,this.localTrackMap.set(n[0],t)}if(n[0]===yF.LocalVideoTrack&&!SP("DISABLE_DUAL_STREAM_USE_ENCODING")&&pk().supportDualStreamEncoding){const t=this.localTrackMap.get(yF.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new ip((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)})}}t()}catch(e){n(e)}finally{var a;null===(a=i)||void 0===a||a()}}),nR(this,"handleGetRTCStats",e=>{e(this.statsCollector.getRTCStats())}),nR(this,"handleGetLocalVideoStats",e=>{e(this.statsCollector.getLocalVideoTrackStats())}),nR(this,"handleGetLocalAudioStats",e=>{e(this.statsCollector.getLocalAudioTrackStats())}),nR(this,"handleGetRemoteVideoStats",e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid]),nR(this,"handleGetRemoteAudioStats",e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new nW(this.store),this.bindStatsUploaderEvents(),this.mutex=new kO("P2PChannel-mutex",this.store.clientId),this.isPlanB=!pk().supportUnifiedPlan||SP("CHROME_FORCE_PLAN_B")&&aN(),this.shouldForwardP2PCreation=SP("FORWARD_P2P_CREATION")&&pk().supportPCSetConfiguration&&oN(),this.shouldForwardP2PCreation&&(this.connection=DB(this.store),this.emit(TF.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(e,t){var n;this.state=SF.New,this._forceTurn=LB(e),nk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const r=this.shouldForwardP2PCreation&&"closed"===(null===(n=this.connection)||void 0===n?void 0:n.peerConnectionState);if((!this.shouldForwardP2PCreation||r||t)&&((r||t)&&this.connection&&(nk.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=DB(this.store,e),this.emit(TF.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new pN(hN.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=SP("NEW_ICE_RESTART")?bF.FIRST_CONNECTION:bF.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new pN(hN.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");if(!this.isPreallocation()||this.state!==SF.Connected){this.store.peerConnectionStart();const t=await this.connection.connect(e);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=SF.Connected,t}if(this.connection instanceof jB&&this.connection.checkDtlsParameters(e.dtlsParameters.fingerprints))return nk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] dtls parameters mismatch, try next.")),dk.reportApiInvoke(this.store.sessionId,{name:DN.MISMATCH_DTLS_PARAMETERS,options:[e.dtlsParameters.fingerprints],tag:xN.TRACER}).onSuccess(),void setTimeout(()=>{this.emit(TF.RequestReconnect)});await this.connection.updateRemoteConnect(e)}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter(e=>{var t;let[n]=e;return xr(t=[yF.LocalVideoLowTrack,yF.LocalVideoTrack]).call(t,n)}),n=t.map(e=>{let[,{id:t}]=e;return t}),r=t.map(e=>{let[t]=e;return t});if(this.connection instanceof jB||this.connection&&"name"in this.connection&&"DataChannelConnection"===this.connection.name){if(dk.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(r),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!xr(e).call(e,this.store.codec)){const t=["vp9","vp8","h264"].find(t=>xr(e).call(e,t));t&&(this.store.codec=t,nk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(t,".")))}this.connection.updateRemoteRTPCapabilities(n,e)}}async getEstablishParams(){var e;return this.connection&&"name"in this.connection&&"DataChannelConnection"===this.connection.name&&"closed"!==this.connection.peerConnectionState||this.connection instanceof jB&&"closed"!==this.connection.peerConnectionState&&xr(e=[SF.New,SF.Connected]).call(e,this.state)?this.connection.establishPromise:void 0}async publishDataChannel(e){if(!this.connection||this.state!==SF.Connected){if(this.state===SF.Disconnected)throw new pN(hN.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach(e=>{var t;xr(t=this.pendingLocalDataChannels).call(t,e)||this.pendingLocalDataChannels.push(e)}),[]}const t=this.filterTobePublishedDataChannels(e);return 0===t.length?[]:(t.forEach(e=>{const t=Date.now();this.store.publish(e.id.toString(),"datachannel",t)}),await this.connection.createDataChannels(this.store.uid,t),t.forEach(e=>{this.localDataChannels.push(e);const t=Date.now();this.store.publish(e.id+"","datachannel",void 0,t)}),e.map(e=>({streamId:e.id,ordered:e.ordered,maxRetransmits:e.maxRetransmits,metadata:e.metadata,channelId:e._originDataChannelId})))}publish(e,t,n){var r=this;return LA(function*(){const i=yield UA(r.mutex.lock("From P2PChannel.publish"));try{var o;const i=r.connection&&xr(o=["disconnected","failed"]).call(o,r.connection.peerConnectionState);if(!r.connection||r.state!==SF.Connected||i){if(r.state===SF.Disconnected)throw new pN(hN.UNEXPECTED_ERROR,"PeerConnection already disconnected.");r.throwIfTrackTypeNotMatch(e);const t=e.filter(e=>-1===r.pendingLocalTracks.indexOf(e));return r.pendingLocalTracks=r.pendingLocalTracks.concat(t),void(i&&(r._isWaitPcToRePub=!0))}r.store.pubId=r.store.pubId+1,tB.markPublishStart(r.store.clientId,r.store.pubId);const a=r.filterTobePublishedTracks(e,t,n);if(0===a.length)return void(yield UA(r.tryToUnmuteAudio(e)));yield*FA(pW(r.doPublish(r.connection,a)))}finally{i()}})()}doPublish(e,t){var n=this;return LA(function*(){t.forEach(e=>{let{track:t,type:r}=e;const i=Date.now();n.store.publish(t.getTrackId(),r===yF.LocalAudioTrack?"audio":"video",i)}),n.bindLocalTrackEvents(t);const r=t.map(e=>{let{track:t}=e;return t}),i=yield UA(e.send(r,n.store.codec,n.store.audioCodec)),o=(yield UA(i.next())).value,a=n.createGatewayPublishMessage(t,o);let s;try{s=yield a}catch(e){throw i.throw(e),(null==e?void 0:e.code)===hN.WS_ABORT&&t.forEach(e=>{let{track:t}=e;-1===n.pendingLocalTracks.indexOf(t)&&n.pendingLocalTracks.push(t)}),n.unbindLocalTrackEvents(t),e}const c=n.mapPubResToRemoteConfig(a,s,r),l=(yield UA(i.next(c))).value;if(n.state===SF.Disconnected)throw new pN(hN.UNEXPECTED_ERROR,"PeerConnection already disconnected.");SP("ENABLE_VIDEO_SEI");const d=SP("ENABLE_ENCODED_TRANSFORM"),u=SP("ENABLE_AUDIO_METADATA");r.forEach(async e=>{const t=e.getRTCRtpTransceiver();if(!t||!d)return;const{interceptLocalVideoFrame:n,interceptLocalAudioFrame:r}=sV();e.trackMediaType===_F.VIDEO?await n(t.sender,e):e.trackMediaType===_F.AUDIO&&await r(t.sender,{metadata:u?()=>{const t=e.metadata.shift();return t&&t.value}:void 0})}),t.forEach(e=>{let{type:t}=e;n.statsCollector.addLocalStats(t)}),n.assignLocalTracks(t,l),n.statsUploader.startUploadOutboundStats(),t.forEach(e=>{let{track:t,type:r}=e;const i=Date.now();n.store.publish(t.getTrackId(),r===yF.LocalAudioTrack?"audio":"video",void 0,i)})})()}async updateVideoStreamParameter(e,t){const n=this.localTrackMap.get(t);if(!n||!this.connection)return;if(!(n.track instanceof xL))return nk.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:r}=n,i=function(e,t){const n={};return e.height&&e.width&&(n.scaleResolutionDownBy=mj(e,t)),n.maxFramerate=e.framerate?lj(e.framerate):void 0,n.maxBitrate=e.bitrate?1e3*e.bitrate:void 0,n}(e,r);if(r._encoderConfig||(r._encoderConfig={}),t!==yF.LocalVideoLowTrack||!SP("DISABLE_DUAL_STREAM_USE_ENCODING")&&pk().supportDualStreamEncoding)null!=i.scaleResolutionDownBy&&(r._encoderConfig.scaleResolutionDownBy=i.scaleResolutionDownBy);else{const t=r._originMediaStreamTrack;if(!t.canvas)return nk.warn("[".concat(r.getTrackId(),"] no canvas on track"));!function(e,t){const n=e.canvas;t.width&&(n.width=lj(t.width)),t.height&&(n.height=lj(t.height)),t.framerate&&(n.stopCapture&&n.stopCapture(),n.stopCapture=vD(()=>{!n.startCapture&&n.stopCapture&&n.stopCapture(),n.startCapture&&n.startCapture()},lj(t.framerate)))}(t,e)}null!=i.maxBitrate&&(r._encoderConfig.bitrateMax=i.maxBitrate/1e3),null!=i.maxFramerate&&(r._encoderConfig.frameRate&&"object"==typeof r._encoderConfig.frameRate?r._encoderConfig.frameRate.max=i.maxFramerate:r._encoderConfig.frameRate={max:i.maxFramerate}),nk.debug("[".concat(r.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(r._encoderConfig))),await this.connection.updateRtpSenderEncodings(r)}publishLowStream(e){var t=this;return LA(function*(){if(!t.connection||t.state!==SF.Connected)return;const n=yield UA(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const n=t.localTrackMap.get(yF.LocalVideoTrack);if(!n)throw new pN(hN.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(yF.LocalVideoLowTrack))throw new pN(hN.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const i=[{track:t.getLowVideoTrack(n.track,e),type:yF.LocalVideoLowTrack}];if(yield*FA(pW(t.doPublish(t.connection,i))),n.track.muted||!n.track.enabled){var r;const e=null===(r=t.localTrackMap.get(yF.LocalVideoLowTrack))||void 0===r?void 0:r.id;void 0!==e&&(yield UA(t.connection.muteLocal([e])))}}finally{n()}})()}async republish(){this.pendingLocalTracks.length>0&&(nk.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await YN(this,TF.RequestRePublish,this.pendingLocalTracks),this.emit(TF.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(nk.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await YN(this,TF.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(e){for(let t=this.pendingRemoteTracks.length-1;t>=0;t--){const{user:e,kind:n}=this.pendingRemoteTracks[t];(n!==_F.AUDIO||e._audio_added_&&e._audioSSRC)&&(n!==_F.VIDEO||e._video_added_&&e._videoSSRC)||this.pendingRemoteTracks.splice(t,1)}if(e)await YN(this,TF.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:t,kind:n}of this.pendingRemoteTracks)await this.subscribe(t,n,n===_F.VIDEO?t._videoSSRC:t._audioSSRC);this.pendingRemoteTracks.forEach(e=>{let{user:t}=e;this.emit(TF.MediaReconnectEnd,t.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==SF.Connected)return void e.forEach(e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)});const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find(e=>"videoLowTrack"===e[0]);return n&&n[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==SF.Connected)return void e.forEach(e=>{const t=this.pendingLocalDataChannels.indexOf(e);-1!==t&&this.pendingLocalDataChannels.splice(t,1)});const t=this.filterTobeUnpublishedDataChannels(e);return 0!==t.length?(t.forEach(e=>{const t=this.localDataChannels.indexOf(e);-1!==t&&this.localDataChannels.splice(t,1)}),0===this.localDataChannels.length&&await this.connection.stopDataChannels(this.store.uid),t.map(e=>e.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==SF.Connected)return;const e=this.localTrackMap.get(yF.LocalVideoLowTrack);if(!e)return;e.track.close();const t=[[yF.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const n=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map(e=>{let[,{id:t}]=e;return t})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(e=>{let[t,{track:n}]=e;return{type:t,track:n}})),t.forEach(e=>{let[t]=e;this.statsCollector.removeLocalStats(t)}),0===this.localTrackMap.size&&this.statsUploader.stopUploadOutboundStats(),n}async subscribeDataChannel(e,t){if(!this.connection||this.state!==SF.Connected)throw new pN(hN.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const n=t.filter(t=>{var n;return!(null!==(n=this.remoteDataChannelMap.get(e))&&void 0!==n&&n.get(t.id))});if(0!==n.length)return await this.connection.createDataChannels(e.uid,n),n.forEach(t=>{var n;this.remoteDataChannelMap.has(e)?null===(n=this.remoteDataChannelMap.get(e))||void 0===n||n.set(t.id,t):this.remoteDataChannelMap.set(e,new Map([[t.id,t]]));const r=this.pendingRemoteDataChannels.findIndex(n=>{let{user:r,id:i}=n;return r.uid===e.uid&&i===t.id});-1!==r&&this.pendingRemoteDataChannels.splice(r,1)}),n.map(e=>e.id)}async subscribe(e,t,n,r,i){var o;if(!this.connection||this.state!==SF.Connected)throw new pN(hN.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(null!==(o=this.remoteUserMap.get(e))&&void 0!==o&&o.has(t))return;let a,s,c,l;const d=this.connection.getPreMedia(n);if(d)nk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(n,", no need to send sub to gateway.")),c=d.transceiver,a=d.track,s=d.mid,l=d.player,d.firstVideoRender&&this.store.firstVideoFrameDecoded(e.uid,{firstPreRender:d.firstVideoRender});else if(i){const n=i.find(e=>{let{stream_type:n}=e;return n===t});if(!n)throw new pN(hN.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const r=await this.connection.receive(t,n.ssrcs,String(e._uintid),n.attributes);(this.connection instanceof jB||"name"in this.connection&&"DataChannelConnection"===this.connection.name)&&(c=r.transceiver),a=r.track,s=r.id}else{const i=await this.connection.receive(t,[{ssrcId:n,rtx:r}],String(e._uintid),void 0);(this.connection instanceof jB||"name"in this.connection&&"DataChannelConnection"===this.connection.name)&&(c=i.transceiver),a=i.track,s=i.id}if(t===_F.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(a):(e._audioTrack=new $L(a,e.uid,e._uintid,this.store),nk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),c&&e._audioTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(a):(e._videoTrack=new QL(a,e.uid,e._uintid,this.store,l),nk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId())),e._videoTrack.once(Hk.PLAY_START,()=>{this.store.firstVideoFrameDecoded(e.uid,{playStart:Date.now()})}),e._videoTrack.once(Hk.PLAY_END,()=>{this.store.firstVideoFrameDecoded(e.uid,{playEnd:Date.now()}),this.reportVideoFirstFrameRender(e)}),l?e._videoTrack.once(Hk.FIRST_FRAME_RENDER,()=>{this.store.firstVideoFrameDecoded(e.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(e)}):e._videoTrack.once(Hk.FIRST_FRAME_DECODED,()=>{this.store.firstVideoFrameDecoded(e.uid,{firstRender:Date.now()}),this.reportVideoFirstFrameRender(e)})),c&&e._videoTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._videoTrack)),c&&SP("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:n,interceptRemoteAudioFrame:r}=sV();t==_F.VIDEO?await n(c.receiver,{onSei:SP("ENABLE_VIDEO_SEI")&&(t=>{var n;return null===(n=e._videoTrack)||void 0===n?void 0:n._onSei(t)}),onFirstFrame:e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e.ssrc);n&&this.store.firstVideoFrameDecoded(n.uid,{firstReceivedEncodedFrame:Date.now(),frameType:e.type,rtpTimestamp:e.rtpTimestamp,framePayloadType:e.payloadType,frameDataLength:e.length,mimeType:e.mimeType})}}):t==_F.AUDIO&&await r(c.receiver,{enableTopn:!!SP("ENABLE_AUDIO_TOPN"),enableMetadata:!!SP("ENABLE_AUDIO_METADATA"),enablePts:!!SP("ENABLE_AUDIO_PTS"),onMetadata:e=>{this.safeEmit(TF.AudioMetadata,e)},onPts:e=>{this.safeEmit(TF.AudioPts,e)}})}const u=this.remoteUserMap.get(e);u?u.set(t,s):this.remoteUserMap.set(e,new Map([[t,s]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const h=this.pendingRemoteTracks.findIndex(n=>{let{user:r,kind:i}=n;return r.uid===e.uid&&t===i});-1!==h&&(this.pendingRemoteTracks.splice(h,1),this.emit(TF.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==SF.Connected)throw new pN(hN.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(e=>{var t;let{user:n,mediaType:r}=e;return!(null!==(t=this.remoteUserMap.get(n))&&void 0!==t&&t.has(r))});const t=[],n=new Map;e.forEach(e=>{if(!this.connection)return;const r=this.connection.getPreMedia(e.ssrcId);if(r){const{track:t,mid:i,transceiver:o,player:a}=r;n.set(e.ssrcId,{track:t,id:i,transceiver:o,player:a})}else t.push(e)});const r=await this.connection.batchReceive(t.map(e=>{let{user:t,mediaType:n,ssrcId:r,rtxSsrcId:i}=e;return{kind:n,ssrcMsg:[{ssrcId:r,rtx:i}],mslabel:String(t._uintid)}}));t.forEach((e,t)=>{n.set(e.ssrcId,r[t])});for(const{user:i,mediaType:o,ssrcId:a}of e){const e=n.get(a);if(!e)return void nk.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(i.uid," subscribe data,").concat(o,", ").concat(a));const{track:t,id:r,transceiver:s,player:c}=e;if(s&&SP("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:e,interceptRemoteAudioFrame:t}=sV();o==_F.VIDEO?await e(s.receiver,{onSei:SP("ENABLE_VIDEO_SEI")&&(e=>{var t;return null===(t=i._videoTrack)||void 0===t?void 0:t._onSei(e)}),onFirstFrame:e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e.ssrc);n&&this.store.firstVideoFrameDecoded(n.uid,{firstReceivedEncodedFrame:Date.now(),frameType:e.type,rtpTimestamp:e.rtpTimestamp,framePayloadType:e.payloadType,frameDataLength:e.length,mimeType:e.mimeType})}}):o==_F.AUDIO&&await t(s.receiver,{enableTopn:!!SP("ENABLE_AUDIO_TOPN"),enableMetadata:!!SP("ENABLE_AUDIO_METADATA"),enablePts:!!SP("ENABLE_AUDIO_PTS"),onMetadata:e=>{this.safeEmit(TF.AudioMetadata,e)},onPts:e=>{this.safeEmit(TF.AudioPts,e)}})}if(o===_F.AUDIO?(i._audioTrack?i._audioTrack._updateOriginMediaStreamTrack(t):(i._audioTrack=new $L(t,i.uid,i._uintid,this.store),nk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(i._audioTrack.getTrackId()))),s&&i._audioTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(i,i._audioTrack)):(i._videoTrack?i._videoTrack._updateOriginMediaStreamTrack(t):(i._videoTrack=new QL(t,i.uid,i._uintid,this.store,c),nk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(i._videoTrack.getTrackId()))),s&&i._videoTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(i,i._videoTrack)),SP("ENABLE_VIDEO_SEI")&&s){const{interceptRemoteVideoFrame:e,interceptRemoteAudioFrame:t}=sV();o==_F.VIDEO?await e(s.receiver,{onSei:e=>{var t;null===(t=i._videoTrack)||void 0===t||t._onSei(e)},onFirstFrame:e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e.ssrc);n&&this.store.firstVideoFrameDecoded(n.uid,{firstReceivedEncodedFrame:Date.now(),frameType:e.type,rtpTimestamp:e.rtpTimestamp,framePayloadType:e.payloadType,frameDataLength:e.length,mimeType:e.mimeType})}}):o==_F.AUDIO&&await t(s.receiver)}const l=this.remoteUserMap.get(i);l?l.set(o,r):this.remoteUserMap.set(i,new Map([[o,r]])),this.statsCollector.addRemoteStats(i.uid),this.statsUploader.startUploadInboundStats();const d=this.pendingRemoteTracks.findIndex(e=>{let{user:t,kind:n}=e;return t.uid===i.uid&&o===n});-1!==d&&(this.pendingRemoteTracks.splice(d,1),this.emit(TF.MediaReconnectEnd,i.uid))}}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter(n=>{let{user:r,kind:i}=n;return void 0!==t?r.uid===e.uid&&t===i:r.uid===e.uid});if(r.forEach(e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)}),this.connection&&this.state===SF.Connected||n||r.forEach(t=>{let{kind:n}=t;var r;if(n===_F.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===_F.VIDEO){var i;null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0}}),!this.connection||this.state!==SF.Connected)return;const i=this.filterTobeUnSubscribedTracks(e,t);if(0===i.length)return;await this.connection.stopReceiving(i.map(e=>{let[,{id:t}]=e;return t}));const o=this.createUnsubscribeMessage(i);return this.withdrawRemoteTracks(i),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),i.forEach(e=>{let[t,{kind:r}]=e;var i,o;if(r===_F.VIDEO&&t._videoSSRC&&(null===(i=this.connection)||void 0===i||i.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===_F.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(r===_F.AUDIO){var a;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(a=t._audioTrack)||void 0===a||a._destroy(),t._audioTrack=void 0)}}),o}async unsubscribeDataChannel(e,t){if(t.forEach(e=>{const t=this.pendingRemoteDataChannels.findIndex(t=>t.id===e.id);-1!==t&&this.pendingRemoteDataChannels.splice(t,1)}),!this.connection)return;const n=this.filterTobeUnSubscribedDataChannels(e,t);if(0===n.length)return;t.forEach(e=>{e._close()});const r=this.remoteDataChannelMap.get(e);return n.forEach(e=>{r&&r.delete(e.id)}),r&&0===r.size&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),n.map(e=>e.id)}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:i,mediaType:o}of e){const e=this.pendingRemoteTracks.filter(e=>{let{user:t,kind:n}=e;return void 0!==o?t.uid===i.uid&&o===n:t.uid===i.uid});e.forEach(e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)}),t=t.concat(e)}if(!this.connection||this.state!==SF.Connected)return void t.forEach(e=>{let{user:t,kind:n}=e;var r;if(n===_F.AUDIO)null===(r=t._audioTrack)||void 0===r||r._destroy(),t._audioTrack=void 0;else if(n===_F.VIDEO){var i;null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0}});const n=ii(e).call(e,(e,t)=>{let{user:n,mediaType:r}=t;const i=this.filterTobeUnSubscribedTracks(n,r);return e.concat(i)},[]);if(0===n.length)return;await this.connection.stopReceiving(n.map(e=>{let[,{id:t}]=e;return t}));const r=this.createUnsubscribeAllMessage(n);return this.withdrawRemoteTracks(n),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),n.forEach(e=>{let[t,{kind:n}]=e;var r,i;if(n===_F.VIDEO&&t._videoSSRC&&(null===(r=this.connection)||void 0===r||r.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),n===_F.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0;else if(n===_F.AUDIO){var o;this.unbindRemoteTrackEvents(t._audioTrack),null===(o=t._audioTrack)||void 0===o||o._destroy(),t._audioTrack=void 0}}),r}isPreSubScribe(e){return!(!this.connection||this.state!==SF.Connected)&&!!this.connection.getPreMedia(e)}async muteRemote(e,t){if(!this.connection)return;const n=this.remoteUserMap.get(e);if(!n)return void nk.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!n.get(t))return void nk.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===_F.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.connection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;const n=this.remoteUserMap.get(e);n?n.get(t)||nk.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):nk.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."))}addAudioMetadata(e){const t=this.localTrackMap.get(yF.LocalAudioTrack),n=t&&t.track;n&&n.metadata.push(e)}getAllTracks(e){const t=this.localTrackMap.get(yF.LocalAudioTrack);if((null==t?void 0:t.track)instanceof Hx){const n=t.track;return Array.from(this.localTrackMap.entries()).filter(e=>{let[t]=e;return t!==yF.LocalAudioTrack}).filter(t=>{let[n]=t;return!(e&&n===yF.LocalVideoLowTrack)}).map(e=>{let[,{track:t}]=e;return t}).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter(t=>{let[n]=t;return!(e&&n===yF.LocalVideoLowTrack)}).map(e=>{let[,{track:t}]=e;return t})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,n,r,i){if(e){const n=this.localTrackMap.get(yF.LocalAudioTrack),o=r?this.localTrackMap.get(yF.LocalVideoLowTrack):this.localTrackMap.get(yF.LocalVideoTrack);dk.publish(this.store.sessionId,{eventElapse:tB.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(Uk.SCREEN_TRACK)),audio:!!n,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;n||(n=[]);const a=n.find(e=>e instanceof Vx),s=r?null===(o=this.localTrackMap.get(yF.LocalVideoTrack))||void 0===o?void 0:o.track:n.find(e=>e instanceof xL);dk.publish(this.store.sessionId,{eventElapse:tB.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==a?void 0:a.getTrackLabel(),videoName:null==s?void 0:s.getTrackLabel(),screenshare:-1!==(null==s?void 0:s._hints.indexOf(Uk.SCREEN_TRACK)),audio:!!a,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,n,r){const i=r===_F.VIDEO?n._videoSSRC:n._audioSSRC;i&&dk.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===_F.VIDEO,audio:r===_F.AUDIO,peerid:n.uid,subscribeRequestid:i,p2pid:this.store.p2pId,eventElapse:tB.measureFromSubscribeStart(this.store.clientId,i),preSsrc:this.isPreSubScribe(i)})}reset(){nk.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new kO("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=DB(this.store),this.emit(TF.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(yF.LocalAudioTrack);if((null==e?void 0:e.track)instanceof Hx){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(e=>{t.removeAudioTrack(e)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=SF.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(yF.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(yF.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof xL||t&&t.track instanceof Vx?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t.uid===e);return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(yF.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Zp(e).call(e,(e,t)=>e.level-t.level),e}async disconnectForReconnect(){this.connection&&(nk.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=SF.Reconnecting,SP("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var n;t._videoTrack&&t._videoTrack._player&&(null===(n=t._videoTrack._player.getVideoElement())||void 0===n||n.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=DB(this.store),this.emit(TF.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[n,{track:r}]=e;switch(n){case yF.LocalVideoTrack:xr(t=r._hints).call(t,Uk.LOW_STREAM)?r.close():this.pendingLocalTracks.push(r);break;case yF.LocalAudioTrack:r instanceof Hx?this.pendingLocalTracks=this.pendingLocalTracks.concat(r.trackList):this.pendingLocalTracks.push(r);case yF.LocalVideoLowTrack:}}),this.emit(TF.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,n]=e;Array.from(HP(n).call(n)).forEach(e=>{this.setPendingRemoteMedia(t,e)}),this.emit(TF.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),0!==this.localDataChannels.length&&(this.localDataChannels.forEach(e=>{this.pendingLocalDataChannels.push(e)}),this.localDataChannels.length=0),0!==this.remoteDataChannelMap.size&&(Array.from(this.remoteDataChannelMap.entries()).forEach(e=>{let[t,n]=e;Array.from(HP(n).call(n)).forEach(e=>{this.setPendingRemoteDataChannel(t,e)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),nk.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(const n of this.pendingRemoteDataChannels){const{user:r,id:i}=n;if((e instanceof sB?e.uid:e)===r.uid&&i===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:i}=n;if((e instanceof sB?e.uid:e)===r.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return LA(function*(){if(!t.connection||t.state!==SF.Connected)return;const n=yield UA(t.mutex.lock("From P2PChannel.restartICE"));let r;try{r=yield UA(t.connection.restartICE(e));const n=yield UA(r.next());if(n.done)return;const i=n.value,o=yield i;switch(xB(t.connection)&&t.reportPCStats(Date.now(),!1,t._pcStatsUploadType),e){case vF.UDP_TCP_RELAY:t._pcStatsUploadType=bF.UDP_TCP_RESTART;break;case vF.TCP_RELAY:t._pcStatsUploadType=bF.TCP_RESTART;break;case vF.RELAY:t._pcStatsUploadType=bF.RELAY_RESTART;break;default:t._pcStatsUploadType=bF.OLD_RESTART}t._isTryConnecting=!0,r.next(o)}catch(e){var i;null===(i=r)||void 0===i||i.throw(e)}finally{n()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(yF.LocalVideoTrack),n=this.localTrackMap.get(yF.LocalAudioTrack),r=e.videoSend.find(e=>e.ssrc===(null==t?void 0:t.ssrcs[0].ssrcId)),i=e.audioSend.find(e=>e.ssrc===(null==n?void 0:n.ssrcs[0].ssrcId));if(!r||!i)return 1;const o=XN(this,TF.NeedSignalRTT),a=r?r.rttMs:void 0,s=i?i.rttMs:void 0,c=a&&s?(a+s)/2:a||s,l=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*l/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,h=null==t?void 0:t.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(Uk.SCREEN_TRACK)){const t=h._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return GM[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r]=n;const i=r._audioSSRC,o=r._videoSSRC,a=e.audioRecv.find(e=>e.ssrc===i),s=e.videoRecv.find(e=>e.ssrc===o);if(!a&&!s)return void(t+=1);const c=XN(this,TF.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=a?a.jitterMs:void 0,h=e.recvPacketLossRate;let p=.7*h*100/50+.3*d/1500;u&&(p=.6*h*100/50+.2*d/1500+.2*u/400),t+=p<.1?1:p<.17?2:p<.36?3:p<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new ip((t,n)=>{this.handleMuteLocalTrack(e,t,n)})}async replaceTrack(e,t){var n;if(nk.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!this.connection||this.state!==SF.Connected)return;const r=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(!r)return;const i=r[0];if(e!==t&&(this.unbindLocalTrackEvents([{track:e,type:i}]),this.bindLocalTrackEvents([{track:t,type:i}]),r[1].track=t),await(null===(n=this.connection)||void 0===n?void 0:n.replaceTrack(t,r[1].id)),this.isPlanB){const e=r[1];e.id=t._mediaStreamTrack.id,this.localTrackMap.set(i,e)}if(i===yF.LocalVideoTrack&&!SP("DISABLE_DUAL_STREAM_USE_ENCODING")&&pk().supportDualStreamEncoding){const t=this.localTrackMap.get(yF.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new ip((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)})}}}filterTobePublishedTracks(e,t,n){const r=[],i=this.getAllTracks();e=iO(e=e.filter(e=>-1===i.indexOf(e)));let o,a=!1;const s=this.localTrackMap.get(yF.LocalAudioTrack);for(const c of e){if(c instanceof xL&&(this.localTrackMap.has(yF.LocalVideoTrack)||a?new pN(hN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:c,type:yF.LocalVideoTrack}),a=!0),t)){const e=this.getLowVideoTrack(c,n);r.push({track:e,type:yF.LocalVideoLowTrack})}if(c instanceof Vx)if(s){const e=s.track;if(e instanceof Hx)OB([c]),e.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0);else{const t=PB([e,c]);nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(t.getTrackId(),"]")),this.replaceTrack(e,t)}}else o instanceof Hx?(OB([c]),o.addAudioTrack(c)):o=o||!c._useAudioElement&&pk().webAudioMediaStreamDest&&!c._bypassWebAudio?PB(o?[c,o]:[c]):c}return o&&(nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(o.getTrackId(),"]")),r.push({track:o,type:yF.LocalAudioTrack})),r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=iO(e=e.filter(e=>-1!==n.indexOf(e)));for(const r of e){if(r instanceof Vx){const e=this.localTrackMap.get(yF.LocalAudioTrack);if(!e)continue;e.track instanceof Hx?(e.track.removeAudioTrack(r),this.unbindLocalAudioTrackEvents(r),0===e.track.trackList.length&&(t.push([yF.LocalAudioTrack,e]),e.track.close())):t.push([yF.LocalAudioTrack,e])}if(r instanceof xL){const e=this.localTrackMap.get(yF.LocalVideoTrack);if(!e)continue;t.push([yF.LocalVideoTrack,e]);const n=this.localTrackMap.get(yF.LocalVideoLowTrack);n&&t.push([yF.LocalVideoLowTrack,n])}}return t}filterTobePublishedDataChannels(e){return(e=iO(e)).filter(e=>-1===this.localDataChannels.findIndex(t=>t.id===e.id))}filterTobeUnpublishedDataChannels(e){return(e=(e=iO(e)).filter(e=>-1!==this.localDataChannels.indexOf(e))).filter(e=>e._originDataChannel)}bindLocalTrackEvents(e){e.forEach(e=>{let{track:t,type:n}=e;switch(n){case yF.LocalVideoTrack:t.addListener(Mk.GET_STATS,this.handleGetLocalVideoStats),t.addListener(Mk.GET_RTC_STATS,this.handleGetRTCStats),t.addListener(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Mk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(Mk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.addListener(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case yF.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case yF.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof Hx?e.trackList.forEach(e=>{e.addListener(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Mk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Mk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(Mk.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(e=>{let[t,{track:n}]=e;return{track:n,type:t}})),e.forEach(e=>{let{track:t,type:n}=e;switch(n){case yF.LocalVideoTrack:t.off(Mk.GET_STATS,this.handleGetLocalVideoStats),t.off(Mk.GET_RTC_STATS,this.handleGetRTCStats),t.off(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Mk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(Mk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.off(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case yF.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case yF.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Hx?e.trackList.forEach(e=>{e.off(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Mk.GET_STATS,this.handleGetLocalAudioStats),e.off(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Mk.GET_STATS,this.handleGetLocalAudioStats),e.off(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Mk.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof QL&&t.addListener(Mk.GET_STATS,t=>{t(this.handleGetRemoteVideoStats(e))}),t instanceof $L&&t.addListener(Mk.GET_STATS,t=>{t(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Mk.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,n]=e;n.has(_F.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(_F.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((e,n)=>{var r;let i,o,{track:a,type:s}=e;switch(s){case yF.LocalAudioTrack:i=oF.Audio,o={dtx:a instanceof Bx&&a._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case yF.LocalVideoTrack:i=xr(r=a._hints).call(r,Uk.SCREEN_TRACK)?oF.Screen:oF.High,o=hW(hW({},dj(a)),{},{codec:this.store.codec,svc_mode:vj()});break;case yF.LocalVideoLowTrack:i=oF.Low,o=hW(hW({},dj(a)),{},{codec:this.store.codec,svc_mode:vj()})}return{stream_type:i,attributes:o,ssrcs:t[n]}})}createGatewayUnpublishMessage(e){return e.map(e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case yF.LocalVideoTrack:n=xr(t=i._hints).call(t,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalAudioTrack:n=oF.Audio;break;case yF.LocalVideoLowTrack:n=oF.Low}return{stream_type:n,ssrcs:o,mid:a}})}assignLocalTracks(e,t){e.forEach((e,n)=>{let{track:r,type:i}=e;this.localTrackMap.set(i,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})})}withdrawLocalTracks(e){e.forEach(e=>{let[t]=e;this.localTrackMap.delete(t)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(TF.PeerConnectionStateChange,t),"connecting"===t&&e instanceof jB&&!VI()&&SP("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{"connecting"===t&&e.extendCandidate()},SP("FIRST_TCP_CANDIDATE_INTERVAL")),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),e instanceof jB&&cW(e,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=bF.DISCONNECTED_OR_FAILED,"CONNECTED"===XN(this,TF.QueryClientConnectionState)&&this._isWaitPcToRePub)){const e=this.pendingLocalTracks.map(e=>e.getTrackId()),t=this.pendingLocalDataChannels.map(e=>"dc_".concat(e.id));dk.reportApiInvoke(this.store.sessionId,{name:DN.REPUB_AFTER_PC_CONNECTED,options:e.concat(t),tag:xN.TRACER}).onSuccess(),this.republish()}if(SP("NEW_ICE_RESTART")&&e instanceof jB&&!VI()&&!this._forceTurn&&!this.store.useDcSignal){if(xr(EF).call(EF,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const t=t=>{xB(e)&&(nk.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(t)),"CONNECTED"===XN(this,TF.QueryClientConnectionState)&&this.emit(TF.RequestRestartICE,t))},n=()=>{xB(e)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),nk.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(TF.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{lW(e,t,n)},800))}}else{if("disconnected"===t&&"disconnected"===e.iceConnectionState)return setTimeout(()=>{"disconnected"===e.iceConnectionState&&SP("ICE_RESTART")&&"CONNECTED"===XN(this,TF.QueryClientConnectionState)&&this.emit(TF.RequestRestartICE)},800),void setTimeout(()=>{"disconnected"===e.peerConnectionState&&(nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(TF.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);"failed"===t&&(nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(TF.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),dk.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:xN.TRACER}).onSuccess(),this.emit(TF.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._audioSSRC===e);var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(Hk.FIRST_FRAME_DECODED),dk.firstRemoteFrame(this.store.sessionId,ak.FIRST_AUDIO_DECODE,sk.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._audioSSRC===e);n&&dk.firstRemoteFrame(this.store.sessionId,ak.FIRST_AUDIO_RECEIVED,sk.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{var r;const i=Array.from(HP(r=this.remoteUserMap).call(r)).find(t=>t._videoSSRC===e);i&&this.store.firstVideoFrameDecoded(i.uid,{firstDecoded:Date.now()}),this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoRender=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e);n&&(this.store.firstVideoFrameDecoded(n.uid,{firstPreRender:Date.now()}),this.reportVideoFirstFrameRender(n),this.emit(TF.FirstVideoPreRender,n.uid,e))},e.onFirstVideoReceived=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e);n&&(this.store.firstVideoFrameDecoded(n.uid,{firstReceived:Date.now()}),dk.firstRemoteFrame(this.store.sessionId,ak.FIRST_VIDEO_RECEIVED,sk.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstVideoBufferReady=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e);n&&this.emit(TF.FirstVideoBufferReady,n.uid,e)},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(TF.ConnectionTypeChange,n),nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(fj(t))," -> ").concat(JSON.stringify(fj(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(fj(t))," -> ").concat(JSON.stringify(fj(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const e=this.statsCollector.getLocalVideoTrackStats(),t=this.statsCollector.getRTCStats();return hW(hW({},e),t)},e.onICECandidateError=e=>{this._iceError=e}}fallbackConnection(){nk.debug("[".concat(this.store.clientId,"] [P2PChannel] try to fallback connection")),this.state===SF.Connected?(nk.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&this.resetConnection(this.connection),this.shouldForwardP2PCreation&&(this.connection=DB(this.store),this.emit(TF.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)))}resetConnection(e){e instanceof jB&&function(e){oW.delete(e.id),cW(e)}(e),e.close(),this.emit(TF.PeerConnectionStateChange,"closed"),function(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.getLocalVideoStats=void 0}(e),this._isWaitPcToRePub=!1}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(yF.LocalAudioTrack);if(e instanceof Vx&&(null==n?void 0:n.track)instanceof Hx)return n.track.isActive||t.push([yF.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(r&&(t.push(r),r[0]===yF.LocalVideoTrack)){const e=this.localTrackMap.get(yF.LocalVideoLowTrack);e&&t.push([yF.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(yF.LocalAudioTrack);if(e instanceof Vx&&(null==n?void 0:n.track)instanceof Hx)return n.track.isActive&&t.push([yF.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(r)if(r[0]===yF.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(yF.LocalVideoLowTrack);e&&t.push([yF.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map(e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case yF.LocalAudioTrack:n=oF.Audio;break;case yF.LocalVideoTrack:n=xr(t=i._hints).call(t,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalVideoLowTrack:n=oF.Low}return{stream_type:n,ssrcs:o,mid:a}})}createUnmuteMessage(e){return e.map(e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case yF.LocalAudioTrack:n=oF.Audio;break;case yF.LocalVideoTrack:n=xr(t=i._hints).call(t,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalVideoLowTrack:n=oF.Low}return{stream_type:n,ssrcs:o,mid:a}})}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const i=r.get(t);if(!i)return n;n.push([e,{kind:t,id:i}])}else Array.from(r.entries()).forEach(t=>{let[r,i]=t;n.push([e,{kind:r,id:i}])});return n}filterTobeUnSubscribedDataChannels(e,t){const n=[];return t.forEach(t=>{var r;null!==(r=this.remoteDataChannelMap.get(e))&&void 0!==r&&r.has(t.id)&&n.push(t)}),n}createUnsubscribeMessage(e){const t=[];return e.forEach(e=>{let[n,{kind:r,id:i}]=e;switch(r){case _F.VIDEO:return void(n._videoSSRC&&t.push({stream_type:_F.VIDEO,ssrcId:n._videoSSRC}));case _F.AUDIO:return void(n._audioSSRC&&t.push({stream_type:_F.AUDIO,ssrcId:n._audioSSRC}))}}),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach(e=>{let[n,{kind:r}]=e;if(t.has(n)){let e=t.get(n);r===_F.VIDEO?e|=cF.Video:e|=cF.Audio,t.set(n,e)}else r===_F.VIDEO?t.set(n,cF.Video):t.set(n,cF.Audio)}),{users:Array.from(t.entries()).map(e=>{let[t,n]=e;return{stream_id:t.uid,stream_type:n}})}}withdrawRemoteTracks(e){e.forEach(e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(yF.LocalVideoTrack),n=this.localTrackMap.get(yF.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new ip((e,n)=>{this.handleUpdateVideoEncoder(t.track,e,n,!0)})),n&&e.low_stream_uplink&&(await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new ip((e,t)=>{this.handleUpdateVideoEncoder(n.track,e,t,!0)}))}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}isPreallocation(){return!(!this.connection||!("name"in this.connection)||"DataChannelConnection"!==this.connection.name||"closed"===this.connection.peerConnectionState)||this.connection instanceof jB&&this.connection.isPreallocation}isPreSub(){return(this.connection&&"name"in this.connection&&"DataChannelConnection"===this.connection.name&&"closed"!==this.connection.peerConnectionState||this.connection instanceof jB)&&this.connection.isPreSub()}isPreRender(){return this.connection instanceof jB&&this.connection.isPreRender}mapPubResToRemoteConfig(e,t,n){return e.map((e,r)=>{var i;let{stream_type:o}=e;const a=null===(i=t.find(e=>{let{stream_type:t}=e;return o===t}))||void 0===i?void 0:i.attributes;if(a&&SP("DISABLE_SCREEN_SHARE_REMB")){const e=n[r]._hints;(xr(e).call(e,Uk.SCREEN_TRACK)||xr(e).call(e,Uk.SCREEN_LOW_TRACK))&&(a.remb=!1,nk.debug("disable remb for screen share, hints:",e))}return a})}async tryToUnmuteAudio(e){for(let n=0;n<e.length;n++)if(e[n]instanceof Vx){var t;const r=this.filterTobeUnmutedTracks(e[n]);if(0===r.length)continue;await(null===(t=this.connection)||void 0===t?void 0:t.unmuteLocal(r.map(e=>{let[,{id:t}]=e;return t})));const i=this.createUnmuteMessage(r);return void await qN(this,TF.RequestUnmuteLocal,i)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(TF.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(TF.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var e;return{connectState:(null===(e=this.connection)||void 0===e?void 0:e.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await _O(LO(this.dtlsFailedCount,xO)),this.emit(TF.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await YN(this,TF.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(TF.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(yF.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof xL)}throwIfTrackTypeNotMatch(e){if(e.filter(e=>e instanceof xL).length>1)throw new pN(hN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(e=>e instanceof Vx).length>1&&(e.some(e=>e instanceof Vx&&e._bypassWebAudio)||!pk().webAudioMediaStreamDest))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof xL&&this.pendingLocalTracks.some(e=>e instanceof xL))throw new pN(hN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof Vx&&this.pendingLocalTracks.some(e=>e instanceof Vx)&&(!pk().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(e=>e instanceof Vx&&e._bypassWebAudio)))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){var n;const r=!SP("DISABLE_DUAL_STREAM_USE_ENCODING")&&pk().supportDualStreamEncoding,i=hW(hW({},{width:160,height:120,framerate:15,bitrate:50}),t);let o;o=r?e._mediaStreamTrack.clone():BB(e,i);const a=vO(8,"track-low-"),s=new xL(o,hW(hW({},r&&{scaleResolutionDownBy:mj(i,e)}),{},{frameRate:i.framerate,bitrateMax:i.bitrate,bitrateMin:i.bitrate}),void 0,void 0,a);return s.on(Bk.TRANSCEIVER_UPDATED,t=>{e._updateRtpTransceiver(t,Fk.LOW_STREAM)}),s._hints.push(Uk.LOW_STREAM),xr(n=e._hints).call(n,Uk.SCREEN_TRACK)&&s._hints.push(Uk.SCREEN_LOW_TRACK),e.on("sei-to-send",e=>{s.emit("sei-to-send",e)}),e.addListener(Mk.NEED_CLOSE,()=>{s.close()}),s}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.connection&&this.connection instanceof jB){var i,o,a,s;const c=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:l,dtlsTransportState:d,peerConnectionState:u}=this.connection,{local:h,remote:p}=await this.connection.getSelectedCandidatePair();dk.pcStats(this.store.sessionId,{startTime:c,eventElapse:e-c||0,iceconnectionsate:l,dtlsstate:d,connectionstate:u,intSucc:t?1:2,error:this._iceError||r||"",selectedLocalCandidateProtocol:null!==(i=null==h?void 0:h.protocol)&&void 0!==i?i:"",selectedLocalCandidateType:null!==(o=h.candidateType)&&void 0!==o?o:"",selectedLocalCandidateAddress:"".concat(h.address,":").concat(h.port),selectedRemoteCandidateProtocol:null!==(a=p.protocol)&&void 0!==a?a:"",selectedRemoteCandidateType:null!==(s=p.candidateType)&&void 0!==s?s:"",selectedRemoteCandidateAddress:"".concat(p.address,":").concat(p.port),restartCnt:n,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameRender(e){const t=this.store.keyMetrics,n=t.firstVideoFrameDecoded.find(t=>t.userId===e.uid);if(!n)return;const{isInternalUpload:r,isExternalUpload:i}=n;if(r&&i)return;const{subscribeEnd:o,firstPreRender:a,peerPublishDuration:s,peerPubStatusMs:c}=n;let{firstRender:l=0}=n;if(o&&(l||a)&&s&&c){n.isInternalUpload=!0;const{playEnd:r}=n;r&&(n.isExternalUpload=!0);const{firstPreRender:i=0}=n;l=i||l;const a=e.videoTrack,d={peer:e._uintid,width:(null==a?void 0:a._videoWidth)||0,height:(null==a?void 0:a._videoHeight)||0,ssrc:e._videoSSRC||0,p2pid:this.store.p2pId,peerPublishDuration:s,peerPubStatusMs:c,joinChannelStart:t.joinStart||0,preloadStart:t.preloadStart||0,preloadEnd:t.preloadEnd||0,apStart:t.requestAPStart||0,apEnd:t.requestAPEnd||0,suaEnd:t.requestSUAEnd||0,beforeConnect:t.beforeConnect||0,peerReceiver:t.peerReceiver||0,ice:t.iceConnectionEnd||0,pc:t.peerConnectionEnd||0,signalConnected:t.signalConnected||0,joinReq:t.joinReq||0,joinRes:t.joinRep||0,userJoinNotify:n.userJoinNotify||0,videoAddNotify:n.videoAddNotify||0,subscribeStart:n.subscribeStart||0,subscribeEnd:n.subscribeEnd||0,firstReceived:n.firstReceived||0,firstDecoded:n.firstDecoded||0,firstPreRender:i||0,firstRender:r?Math.max(l,r):Math.max(l,o),playStart:n.playStart||0,playEnd:n.playEnd||0,isPreSub:!(!e._videoSSRC||!this.isPreSubScribe(e._videoSSRC)),isPrePc:this.isPreallocation(),isPreInstantVideo:_k(this.store),firstReceivedEncodedFrame:n.firstReceivedEncodedFrame||0,frameType:n.frameType||"",rtpTimestamp:n.rtpTimestamp||0,framePayloadType:n.framePayloadType||0,frameDataLength:n.frameDataLength||0,mimeType:n.mimeType||""};dk.firstXLAPeerFirstVideoFrame(this.store.sessionId,d)}}reportVideoFirstFrameDecoded(e,t,n,r){var i;const o=Array.from(HP(i=this.remoteUserMap).call(i)).find(t=>t._videoSSRC===e);if(o){r||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const i=this.store.keyMetrics,a=i.subscribe.find(e=>e.userId===o.uid&&"video"===e.type);dk.firstRemoteVideoDecode(this.store.sessionId,ak.FIRST_VIDEO_DECODE,sk.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:i.requestAPEnd||0,apStart:i.requestAPStart||0,joinGwEnd:i.joinGatewayEnd||0,joinGwStart:i.joinGatewayStart||0,pcEnd:i.peerConnectionEnd||0,pcStart:i.peerConnectionStart||0,subscriberEnd:(null==a?void 0:a.subscribeEnd)||0,subscriberStart:(null==a?void 0:a.subscribeStart)||0,videoAddNotify:(null==a?void 0:a.streamAdded)||0,state:r?1:0,firstFrame:(null==a?void 0:a.firstFrame)||0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.connection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const i=r.get(t);if(!i)return!1;const o=await this.connection.getRemoteSSRC(i);return void 0!==o&&o!==n}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:n}]=e;t===yF.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,Fk.LOW_STREAM):n._updateRtpTransceiver(void 0)})}},PU(dW.prototype,"startP2PConnection",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"startP2PConnection"),dW.prototype),PU(dW.prototype,"connect",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"connect"),dW.prototype),PU(dW.prototype,"updateRemoteRTPCapabilities",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"updateRemoteRTPCapabilities"),dW.prototype),PU(dW.prototype,"publishDataChannel",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"publishDataChannel"),dW.prototype),PU(dW.prototype,"unpublish",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"unpublish"),dW.prototype),PU(dW.prototype,"unpublishDataChannel",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"unpublishDataChannel"),dW.prototype),PU(dW.prototype,"unpublishLowStream",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"unpublishLowStream"),dW.prototype),PU(dW.prototype,"subscribeDataChannel",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"subscribeDataChannel"),dW.prototype),PU(dW.prototype,"subscribe",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"subscribe"),dW.prototype),PU(dW.prototype,"massSubscribe",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"massSubscribe"),dW.prototype),PU(dW.prototype,"unsubscribe",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"unsubscribe"),dW.prototype),PU(dW.prototype,"unsubscribeDataChannel",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"unsubscribeDataChannel"),dW.prototype),PU(dW.prototype,"massUnsubscribe",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"massUnsubscribe"),dW.prototype),PU(dW.prototype,"muteRemote",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"muteRemote"),dW.prototype),PU(dW.prototype,"unmuteRemote",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"unmuteRemote"),dW.prototype),PU(dW.prototype,"hasRemoteMediaWithLock",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"hasRemoteMediaWithLock"),dW.prototype),PU(dW.prototype,"disconnectForReconnect",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"disconnectForReconnect"),dW.prototype),PU(dW.prototype,"updateBitrateLimit",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"updateBitrateLimit"),dW.prototype),PU(dW.prototype,"remoteMediaSsrcChanged",[gW],Object.getOwnPropertyDescriptor(dW.prototype,"remoteMediaSsrcChanged"),dW.prototype),dW);function gW(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PChannel.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}function _W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vW(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_W(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const bW=Date.now(),EW=20,yW=new Map,SW=new Map;async function TW(e){const t=yW.get(e),n=Array.isArray(t)&&t[t.length-1],r=SW.get(e);if(!n)return void(r.isSyncing=!1);const i={uid:n.uid,payload:n.payload};0===r.firstRecvTs&&(r.firstRecvTs=n.recvTs,r.firstSendTs=n.sendTs);const o=n.sendTs-r.firstSendTs,a=o-(Date.now()-r.firstRecvTs);a>0&&(r.firstRecvTs=Date.now()-o);let s=n.mediaDelay+a;s<=0?(t.pop(),CW(n.context,i),s=0):s=Math.min(s,EW),setTimeout(()=>t.length&&TW(e),s)}function CW(e,t){e.safeEmit(WN.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function wW(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return CW(n,{uid:e.uid,payload:e.payload});const r="".concat(n.id,"-").concat(e.uid),i=yW.get(r)||[],o=i.findIndex(t=>e.sendTs>=t.sendTs),a=vW(vW({},e),{},{context:n,mediaDelay:t,recvTs:Date.now()});-1===o?i.push(a):i.splice(o,0,a),yW.set(r,i);let s=!1;var c;SW.has(r)?s=!(null===(c=SW.get(r))||void 0===c||!c.isSyncing):SW.set(r,{isSyncing:s,firstRecvTs:0,firstSendTs:0}),s||TW(r)}const RW=PI().name;function AW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function IW(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AW(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AW(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const NW="websdk_ng_cache_parameter",OW=SP("MAX_PRELOAD_ASYNC_LENGTH"),PW=1e4,kW=new Map,DW=[];let xW=null,LW=0,MW=0;const UW=new Map,FW=new Uint8Array([241,141,127,212,103,139,200,225,251,157,127,139,143,2,22,163]),jW=function(e,t){const n=[];let r=0;const i=async()=>{const e=n.shift();e&&await e(),n.length>0&&r<t?i():r--};return async function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return new ip(async(o,s)=>{n.push(async()=>{try{const t=await e(...a);o(t)}catch(e){s(e)}}),r<t&&(r++,i())})}}(WW,OW),VW=EI.CancelToken.source();class BW{constructor(){nR(this,"_audioContext",null)}createMuteAudioTrack(){this._audioContext=new AudioContext;const e=this._audioContext.sampleRate,t=10*e,n=this._audioContext.createBuffer(2,t,e),r=this._audioContext.createBufferSource();r.buffer=n;const i=this._audioContext.createMediaStreamDestination();return r.connect(i),r.start(),i.stream.getAudioTracks()[0]}close(){this._audioContext&&(this._audioContext.close(),this._audioContext=null)}}async function WW(e,t,n,r,i,o,a){try{if(!SP("ENABLE_PRELOAD"))return;if(!pk().supportWebCrypto)return void lO(()=>{nk.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!n&&null!==n)throw new pN(hN.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&vN(n,"token",1,2047),vN(e,"appid",1,2047),GU(t),r&&zU(r);const s=bO();nk.debug("preload channel ".concat(t,", uid is ").concat(r));const c={appId:e,cname:t,token:n||e,uid:"string"!=typeof r?r:null,sid:s,proxyServer:i,role:a};let l,d;"string"==typeof r?(c.stringUid=r,[d,l]=await ip.all([GV(r,{sid:s,appId:e},VW.token),KV(IW(IW({},c),{},{token:n||e,uid:0}),VW.token)]),c.uid=d.uid,l.gatewayInfo.uid=c.uid,l.gatewayInfo.res.uid=c.uid):(o&&(c.stringUid=o),l=await KV(c,VW.token));const u={sid:s,appId:e,cname:t,token:n||e,uid:c.stringUid||r,intUid:c.uid||l.gatewayInfo.uid,stringUid:c.stringUid,ts:Date.now(),sua:d,ap:l};await zW(u),LW++}catch(e){throw MW++,function(e){xW||(xW=window.setTimeout(()=>{let t="";UW.forEach((e,n)=>{t+="".concat(n,": ").concat(e," ;")}),dk.reportApiInvoke(null,{name:DN.PRELOAD,options:{success:LW,failed:MW,err:t}}).onError(e),LW=0,MW=0,UW.clear(),xW=null},PW));const t=UW.get(e.code)||0;UW.set(e.code,t+1)}(e),e}}async function HW(e){try{if(SP("AP_REQUEST_DETAIL")||SP("ENABLE_ROLE_SELECT_EDGE"))return;const t=GW(e);if(!t||"disabled"!==e.cloudProxyServer)return;const n=await async function(e,t){try{const n=await window.crypto.subtle.importKey("raw",hO(t),"AES-GCM",!1,["decrypt"]),r=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:FW},n,dO(e));return JSON.parse(window.atob(uO(new Uint8Array(r))))}catch(e){return}}(t,e.token||e.appId);if(!n)return;if(!function(e,t){return!(e.cname!==t.cname||e.appId!==t.appId||e.token!==t.token)&&(t.stringUid?e.stringUid===t.stringUid:"number"==typeof t.uid?e.uid===t.uid:e.uid==t.uid)}(n,e))return;if(n&&Date.now()-n.ts<SP("AP_CACHE_LIFETIME"))return n}catch(e){nk.warn("Error get preloadInfo",e.message)}}function GW(e){let t;try{if(t=XW(NW),!t)return;const n=JSON.parse(t),r=ZW(e),i=function(e,t){for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n;return-1}(n,e=>r in e);if(-1===i)return;const o=n.splice(i,1)[0];return JW(NW,JSON.stringify(n)),o[r]}catch(e){nk.warn("Error delete preload info: ".concat(t),e.message),JW(NW,"")}}async function zW(e){let t;try{e.uid&&GW({appId:e.appId,cname:e.cname,token:e.token,uid:e.uid,stringUid:e.stringUid});const n=ZW(e),r=await async function(e,t){try{const n=await window.crypto.subtle.importKey("raw",hO(t),"AES-GCM",!1,["encrypt"]),r=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:FW},n,dO(window.btoa(JSON.stringify(e))));return uO(new Uint8Array(r))}catch(e){return}}(e,e.token||e.appId);if(!r)return;t=XW(NW);const i=t?JSON.parse(t):[];i.push({[n]:r}),i.length>SP("AP_CACHE_NUM")&&i.shift(),JW(NW,JSON.stringify(i))}catch(e){nk.warn("Error caching server parameters:",e.message),JW(NW,"")}}function KW(e){if(e){let t=kW.get(e);t&&(window.clearTimeout(t),t=null,kW.delete(e)),xr(DW).call(DW,e)||"disabled"!==e.cloudProxyServer||DW.push(e)}if(kW.size<SP("AP_CACHE_NUM")&&DW.length>0){const e=DW.shift();kW.set(e,window.setTimeout(async()=>{const{appId:t,cname:n,token:r,stringUid:i,uid:o,proxyServer:a,role:s}=e;try{await jW(t,n,r,o,a,i,s),kW.has(e)&&KW(e)}catch(t){nk.warn("update preload failed",t.message),YW(e)}},SP("AP_UPDATE_INTERVAL")))}}function YW(e){const t=DW.indexOf(e);-1!==t&&DW.splice(t,1);let n=kW.get(e);n&&(window.clearTimeout(n),n=null,kW.delete(e),KW())}function qW(e,t){const n=e.sua,r=e.ap;t&&n&&dk.reqUserAccount(e.sid,{lts:n.requestTime,elapse:n.elapse,success:!0,serverAddr:n.url,stringUid:t,uid:e.intUid,errorCode:null,extend:n.req}),dk.reportResourceTiming(e.ap.url,e.sid),dk.joinWebProxyAP(e.sid,{lts:r.requestTime,elapse:r.elapse,sucess:1,apServerAddr:r.url,turnServerAddrList:r.proxyInfo.addresses.map(e=>e.ip).join(","),eventType:"disabled",unilbsServerIds:[nj.CHOOSE_SERVER,nj.CLOUD_PROXY_FALLBACK].toString()}),dk.joinChooseServer(e.sid,{lts:r.requestTime,elapse:r.elapse,succ:!0,csAddr:r.url,opid:r.opid,serverList:r.gatewayInfo.gatewayAddrs.map(e=>e.address),ec:null,cid:r.gatewayInfo.cid.toString(),uid:r.gatewayInfo.uid.toString(),csIp:r.gatewayInfo.csIp,unilbsServerIds:[nj.CHOOSE_SERVER].toString(),isHttp3:r.isHttp3})}function XW(e){return window.atob(window.localStorage.getItem(e)||"")}function JW(e,t){window.localStorage.setItem(e,window.btoa(t))}function ZW(e){let t="".concat(e.appId,"_").concat(e.cname);return"string"==typeof e.uid&&(t+="_s_".concat(e.uid)),"number"==typeof e.uid&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),NO(t)}function QW(e){let t=function(){const e=nH.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(e,t){let n=e.appId;void 0!==n&&(pH(t,10),lH(t,n));let r=e.cid;void 0!==r&&(pH(t,16),pH(t,r));let i=e.cname;void 0!==i&&(pH(t,26),lH(t,i));let o=e.deviceId;void 0!==o&&(pH(t,34),lH(t,o));let a=e.elapse;void 0!==a&&(pH(t,40),fH(t,a));let s=e.fileSize;void 0!==s&&(pH(t,48),fH(t,tH(s)));let c=e.height;void 0!==c&&(pH(t,56),fH(t,tH(c)));let l=e.jpg;void 0!==l&&(pH(t,66),pH(t,l.length),sH(t,l));let d=e.networkType;void 0!==d&&(pH(t,72),fH(t,tH(d)));let u=e.osType;void 0!==u&&(pH(t,80),fH(t,tH(u)));let h=e.requestId;void 0!==h&&(pH(t,90),lH(t,h));let p=e.sdkVersion;void 0!==p&&(pH(t,98),lH(t,p));let m=e.sequence;void 0!==m&&(pH(t,104),fH(t,tH(m)));let f=e.sid;void 0!==f&&(pH(t,114),lH(t,f));let g=e.timestamp;void 0!==g&&(pH(t,120),fH(t,g));let _=e.uid;void 0!==_&&(pH(t,128),pH(t,_));let v=e.vid;void 0!==v&&(pH(t,136),pH(t,v));let b=e.width;void 0!==b&&(pH(t,144),fH(t,tH(b)));let E=e.service;void 0!==E&&(pH(t,152),pH(t,E));let y=e.callbackData;void 0!==y&&(pH(t,162),pH(t,y.length),sH(t,y));let S=e.ticket;void 0!==S&&(pH(t,170),lH(t,S));let T=e.vendorConfigs;void 0!==T&&(pH(t,178),lH(t,T))}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}function $W(e){return function(e){let t={};e:for(;!iH(e);){let n=hH(e);switch(n>>>3){case 0:break e;case 1:t.code=hH(e);break;case 2:t.msg=cH(e,hH(e));break;case 3:t.requestId=cH(e,hH(e));break;case 4:t.timestamp=mH(e,!1);break;default:eH(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}function eH(e,t){switch(t){case 0:for(;128&dH(e););break;case 2:rH(e,hH(e));break;case 5:rH(e,4);break;case 1:rH(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function tH(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let nH=[];function rH(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function iH(e){return e.offset>=e.limit}function oH(e,t){let n=e.bytes,r=e.offset,i=e.limit,o=r+t;if(o>n.length){let t=new Uint8Array(2*o);t.set(n),e.bytes=t}return e.offset=o,o>i&&(e.limit=o),r}function aH(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function sH(e,t){let n=oH(e,t.length);e.bytes.set(t,n)}function cH(e,t){let n=aH(e,t),r=String.fromCharCode,i=e.bytes,o="\ufffd",a="";for(let s=0;s<t;s++){let e,c,l,d,u=i[s+n];0==(128&u)?a+=r(u):192==(224&u)?s+1>=t?a+=o:(e=i[s+n+1],128!=(192&e)?a+=o:(d=(31&u)<<6|63&e,d<128?a+=o:(a+=r(d),s++))):224==(240&u)?s+2>=t?a+=o:(e=i[s+n+1],c=i[s+n+2],32896!=(49344&(e|c<<8))?a+=o:(d=(15&u)<<12|(63&e)<<6|63&c,d<2048||d>=55296&&d<=57343?a+=o:(a+=r(d),s+=2))):240==(248&u)?s+3>=t?a+=o:(e=i[s+n+1],c=i[s+n+2],l=i[s+n+3],8421504!=(12632256&(e|c<<8|l<<16))?a+=o:(d=(7&u)<<18|(63&e)<<12|(63&c)<<6|63&l,d<65536||d>1114111?a+=o:(d-=65536,a+=r(55296+(d>>10),56320+(1023&d)),s+=3))):a+=o}return a}function lH(e,t){let n=t.length,r=0;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),r+=e<128?1:e<2048?2:e<65536?3:4}pH(e,r);let i=oH(e,r),o=e.bytes;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),e<128?o[i++]=e:(e<2048?o[i++]=e>>6&31|192:(e<65536?o[i++]=e>>12&15|224:(o[i++]=e>>18&7|240,o[i++]=e>>12&63|128),o[i++]=e>>6&63|128),o[i++]=63&e|128)}}function dH(e){return e.bytes[aH(e,1)]}function uH(e,t){let n=oH(e,1);e.bytes[n]=t}function hH(e){let t,n=0,r=0;do{t=dH(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function pH(e,t){for(t>>>=0;t>=128;)uH(e,127&t|128),t>>>=7;uH(e,t)}function mH(e,t){let n,r=0,i=0,o=0;return n=dH(e),r=127&n,128&n&&(n=dH(e),r|=(127&n)<<7,128&n&&(n=dH(e),r|=(127&n)<<14,128&n&&(n=dH(e),r|=(127&n)<<21,128&n&&(n=dH(e),i=127&n,128&n&&(n=dH(e),i|=(127&n)<<7,128&n&&(n=dH(e),i|=(127&n)<<14,128&n&&(n=dH(e),i|=(127&n)<<21,128&n&&(n=dH(e),o=127&n,128&n&&(n=dH(e),o|=(127&n)<<7))))))))),{low:r|i<<28,high:i>>>4|o<<24,unsigned:t}}function fH(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=0===i?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10,a=oH(e,o),s=e.bytes;switch(o){case 10:s[a+9]=i>>>7&1;case 9:s[a+8]=9!==o?128|i:127&i;case 8:s[a+7]=8!==o?r>>>21|128:r>>>21&127;case 7:s[a+6]=7!==o?r>>>14|128:r>>>14&127;case 6:s[a+5]=6!==o?r>>>7|128:r>>>7&127;case 5:s[a+4]=5!==o?128|r:127&r;case 4:s[a+3]=4!==o?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==o?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==o?n>>>7|128:n>>>7&127;case 1:s[a]=1!==o?128|n:127&n}}const gH={},_H={},vH=4294967296,bH=vH*vH,EH=bH/2,yH=RH(0,!0),SH=RH(0),TH=AH(0,-2147483648,!1),CH=AH(-1,2147483647,!1),wH=AH(-1,-1,!0);function RH(e,t){let n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=_H[e],r)?r:(n=AH(e,0,!0),i&&(_H[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=gH[e],r)?r:(n=AH(e,e<0?-1:0,!1),i&&(gH[e]=n),n)}function AH(e,t,n){return{low:0|e,high:0|t,unsigned:!!n}}function IH(e,t){if(isNaN(e))return t?yH:SH;if(t){if(e<0)return yH;if(e>=bH)return wH}else{if(e<=-EH)return TH;if(e+1>=EH)return CH}return e<0?t?yH:SH:AH(e%vH|0,e/vH|0,t)}function NH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}class OH extends ON{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(PF.CONNECTION_STATE_CHANGE,e,t)}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(e){var t;super(),nR(this,"name","AgoraRTCImageModeration"),nR(this,"_connectionState",OF.CONNECTING),nR(this,"_sequence",0),nR(this,"_moderationStartTime",void 0),nR(this,"_workerConnection",void 0),nR(this,"_workerMessageLengthLimit",void 0),nR(this,"_qualityRatio",void 0),nR(this,"_connectInfo",void 0),nR(this,"_cancelTokenSource",EI.CancelToken.source()),nR(this,"_retryConfig",void 0),nR(this,"_moderationInterval",void 0),nR(this,"_moderationTimer",null),nR(this,"_moderationMode",1),nR(this,"_quality",1),nR(this,"_qualityTimer",null),nR(this,"_ticket",void 0),nR(this,"_moderationIntervalMinimum",void 0),nR(this,"_uploadFailedNum",0),nR(this,"_uploadNum",0),nR(this,"_uploadTimer",null),nR(this,"_extraInfo",void 0),nR(this,"_vendor",""),nR(this,"_encoder",new TextEncoder),nR(this,"_moderationId",void 0),nR(this,"inspectImage",()=>{if(this.connectionState!==OF.CONNECTED)throw new uk(hN.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===OF.CONNECTED?this.requestToInspectImage():nk.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=vO(5,"image-moderation-"),this._workerMessageLengthLimit=SP("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=SP("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),this._qualityRatio=SP("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new $F("worker-"+this._moderationId,xO),this.on(PF.STATE_CHANGE,(e,t)=>{nk.debug("[".concat(this._moderationId,"] Moderation operation :").concat(kF[e]," ").concat(t||""))}),this.handleWorkerEvents()}async init(e,t){this.emit(PF.STATE_CHANGE,kF.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new ip((r,i)=>{this.on(PF.CONNECTION_STATE_CHANGE,(e,t)=>{e===OF.CONNECTED&&r()}),this.requestAP(e,n,t).then(e=>{this.connectWorker(e)}).catch(e=>{i(e)})})}updateConfig(e){var t;this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),nk.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(e))),this.connectionState===OF.CONNECTED&&this.inspectImage()}async requestAP(e,t,n){const r=SP("WEBCS_DOMAIN").map(e=>"https://".concat(e,"/api/v1")),i=await function(e,t,n,r){let{appId:i,areaCode:o,cname:a,sid:s,token:c,uid:l}=t;MV++;const d="moderation_plugin",u={service_name:d,json_body:JSON.stringify({appId:i,areaCode:o,cname:a,command:"allocateEdge",requestId:MV,seq:MV,sid:s,appToken:c,ts:Date.now(),uid:l+""})};let h,p,m=e[0];return MO(async()=>{h=Date.now();const e=await mV(m,{data:u,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(p=Date.now()-h,0!==e.code){const t=new uk(hN.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+e.code,{retry:!0,responseTime:p});throw nk.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new uk(hN.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:p});throw nk.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new uk(hN.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:t.code,responseTime:p});throw nk.error(e.toString()),e}if(!t.servers.some(e=>!!e.wss)){const e=new uk(hN.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:t.code,responseTime:p});throw nk.error(e.toString()),e}const r=SP("IMAGE_MODERATION_WORKER_WSS");if(r)return{addressList:[r],workerToken:t.workerToken,vid:t.vid,responseTime:p};const i=SP("IMAGE_MODERATION_WORKER_HOST"),o=t.servers.map(e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(i,":").concat(n,"/moderation")}).filter(e=>!!e);return{addressList:o,workerToken:t.workerToken,vid:t.vid,ticket:t.appTicket,responseTime:p}},(t,n)=>(dk.apworkerEvent(s,{success:!0,sc:200,serviceName:d,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:p,serverIp:e[n%e.length]}),!1),(t,n)=>(dk.apworkerEvent(s,{success:!1,sc:t.data&&t.data.code||200,serviceName:d,responseTime:p,serverIp:e[n%e.length]}),!!(t.code!==hN.OPERATION_ABORTED&&t.code!==hN.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(m=e[(n+1)%e.length],!0)),r)}(r,e,t,n);this.emit(PF.STATE_CHANGE,kF.AP_CONNECTED);const{addressList:o,ticket:a}=i;return this._ticket=a,o}async connectWorker(e){this.emit(PF.STATE_CHANGE,kF.CONNECT_WORKER),await this._workerConnection.init(e,1e4)}handleWorkerEvents(){this._workerConnection.on(HU.CONNECTED,async()=>{this.emit(PF.STATE_CHANGE,kF.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=OF.CONNECTED}),this._workerConnection.on(HU.CLOSED,()=>{this.connectionState=OF.CLOSED}),this._workerConnection.on(HU.FAILED,()=>{this.connectionState=OF.CLOSED}),this._workerConnection.on(HU.RECONNECTING,()=>{this.connectionState=this.connectionState===OF.CONNECTED?OF.RECONNECTING:OF.CONNECTING}),this._workerConnection.on(HU.ON_MESSAGE,async e=>{if(e.data instanceof ArrayBuffer){const t=$W(new Uint8Array(e.data));SP("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&nk.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(t)),this._uploadNum++,void 0===t.code||0===t.code||(this._uploadFailedNum++,nk.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(t.code,", msg is ").concat(t.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{dk.reportApiInvoke(this._connectInfo.sid||null,{name:DN.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,t.code],tag:xN.TRACER}).onError(new uk(hN.IMAGE_MODERATION_UPLOAD_FAILED,t.msg)),this._uploadTimer=null},SP("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else nk.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(HU.WILL_RECONNECT,(e,t,n)=>{"recover"===e&&n(e),n("tryNext")}),this._workerConnection.on(HU.REQUEST_NEW_URLS,(e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)})}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){const e=XN(this,PF.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void(SP("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&nk.debug("Only the track being played can be inspected"));this._sequence++;const n=await this.generateRequestData(e,t);this._workerConnection.sendMessage(n,!0,!0)}else SP("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&nk.debug("Only the track being published can be inspected")}async generateRequestData(e,t){let{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s}=t;const c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await ZD(l,n,r),u=this._sequence+"-"+i+"-"+s+"-"+c+"-"+vO(12,""),h={appId:n,cid:i,cname:r,deviceId:"",elapse:OH.intToLong(Number(c-this._moderationStartTime)),fileSize:l.buffer.byteLength,height:l.height,width:l.width,jpg:d,networkType:6,osType:7,requestId:u,sdkVersion:"4.24.2",sequence:this._sequence,sid:a,timestamp:IH(c),uid:s,vid:o,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};void 0===this._extraInfo&&delete h.callbackData;const p=QW(h);if(p.byteLength<this._workerMessageLengthLimit){if(SP("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NH(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NH(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},h);delete e.jpg,nk.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(e))}return p}{const t=this.quality*this._qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=EI.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=OF.CLOSED,this.emit(PF.STATE_CHANGE,kF.CLOSED)}}function PH(e){if(gN(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new uk(hN.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new uk(hN.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const kH={name:"ImageModeration",create:function(e){let{config:t}=e;return PH(t),new OH(t)}};var DH,xH,LH,MH,UH,FH,jH,VH,BH,WH,HH,GH,zH,KH,YH,qH,XH,JH,ZH,QH,$H,eG,tG,nG,rG,iG,oG,aG,sG,cG,lG,dG,uG,hG,pG,mG,fG,gG,_G,vG,bG,EG,yG;function SG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function TG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SG(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SG(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}kO.setLogger(nk);let CG=(DH=lk(),xH=lk({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof dD))return[t];t=[t]}return t.map(e=>e?Object(e).toString():"null")}}),LH=lk({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==Gk.DATA?(Array.isArray(t)||(t=[t]),t.map(e=>e.getTrackId())):[t.getChannelId()])}),MH=lk({argsMap:(e,t,n,r)=>["object"==typeof t?t.uid:t,n,r]}),UH=lk({argsMap:(e,t,n)=>[t,n]}),FH=lk({argsMap:(e,t)=>t.map(e=>{let{user:t,mediaType:n}=e;return[null==t?void 0:t.uid,n]})}),jH=lk({argsMap:(e,t,n,r)=>["object"==typeof t?t.uid:t,n,r]}),VH=lk({argsMap:(e,t)=>t.map(e=>{let{user:t,mediaType:n}=e;return{uid:null==t?void 0:t.uid,mediaType:n}})}),BH=lk(),WH=lk(),HH=lk(),GH=lk(),zH=lk(),KH=lk(),YH=lk(),qH=lk(),XH=lk(),JH=lk(),ZH=lk(),QH=lk(),$H=lk(),eG=lk(),tG=lk(),nG=lk(),rG=lk({argsMap:(e,t)=>[t]}),iG=lk(),oG=lk(),aG=lk(),sG=lk(),cG=lk(),lG=lk(),dG=lk(),uG=lk(),hG=lk({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),pG=lk(),mG=lk(),fG=lk(),gG=lk(),_G=lk(),vG=lk(),bG=lk({reportResult:!0}),EG=lk(),yG=class extends ON{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return(null===(e=this._config)||void 0===e?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e,t){let n;if(super(),nR(this,"store",void 0),nR(this,"_uid",void 0),nR(this,"_channelName",void 0),nR(this,"_uintUid",void 0),nR(this,"_users",[]),nR(this,"_config",void 0),nR(this,"_clientId",void 0),nR(this,"_appId",void 0),nR(this,"_sessionId",null),nR(this,"_key",void 0),nR(this,"_rtmConfig",{}),nR(this,"_joinInfo",void 0),nR(this,"_gateway",void 0),nR(this,"_statsCollector",void 0),nR(this,"_configDistribute",void 0),nR(this,"_leaveMutex",void 0),nR(this,"_publishMutex",void 0),nR(this,"_renewTokenMutex",void 0),nR(this,"_subscribeMutex",void 0),nR(this,"_encryptionMode","none"),nR(this,"_encryptionSecret",null),nR(this,"_encryptionSalt",null),nR(this,"_encryptDataStream",!1),nR(this,"_encryptDataStreamKey",null),nR(this,"_encryptDataStreamIv",null),nR(this,"_proxyServer",void 0),nR(this,"_turnServer",{servers:[],mode:"auto"}),nR(this,"_cloudProxyServerMode","disabled"),nR(this,"_isDualStreamEnabled",!1),nR(this,"_defaultStreamFallbackType",void 0),nR(this,"_lowStreamParameter",void 0),nR(this,"_streamFallbackTypeCacheMap",new Map),nR(this,"_remoteStreamTypeCacheMap",new Map),nR(this,"_axiosCancelSource",EI.CancelToken.source()),nR(this,"_audioVolumeIndicationInterval",void 0),nR(this,"_networkQualityInterval",void 0),nR(this,"_userOfflineTimeout",void 0),nR(this,"_streamRemovedTimeout",void 0),nR(this,"_rteDetailInterval",void 0),nR(this,"_liveTranscodeStreamingClient",void 0),nR(this,"_liveRawStreamingClient",void 0),nR(this,"_channelMediaRelayClient",void 0),nR(this,"_networkQualitySensitivity","normal"),nR(this,"_p2pChannel",void 0),nR(this,"_useLocalAccessPoint",!1),nR(this,"_setLocalAPVersion",void 0),nR(this,"_joinAndNotLeaveYet",!1),nR(this,"_numberOfJoinCount",0),nR(this,"_joinResponse",null),nR(this,"_remoteDefaultVideoStreamType",void 0),nR(this,"_inspect",void 0),nR(this,"_moderation",void 0),nR(this,"_license",void 0),nR(this,"_pendingPublishedUsers",[]),nR(this,"ntpAlignErrorCount",0),nR(this,"remoteInboundOffset",0),nR(this,"_peerConnectionState",void 0),nR(this,"_pendingRtpCapabilityChange",void 0),nR(this,"_fallbackServerInfo",void 0),nR(this,"_dualStreamMode",void 0),nR(this,"_handleLocalTrackEnable",(e,t,n)=>{this.publish(e,!1).then(t).catch(n)}),nR(this,"_handleLocalTrackDisable",(e,t,n)=>{this.unpublish(e).then(t).catch(n)}),nR(this,"_handleUserOnline",e=>{if(SP("BLOCK_LOCAL_CLIENT")&&YM(e.uid,this.channelName))return void nk.debug("[".concat(e.uid,"] will be ignored in local"));this.isStringUID&&"string"!=typeof e.uid&&nk.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const t=this._users.find(t=>t.uid===e.uid);if(t)t._trust_in_room_=!0,t._is_pre_created&&(t._is_pre_created=!1,this.safeEmit(WN.USER_JOINED,t));else{const t=new sB(e.uid,e.uint_id||e.uid);this._users.push(t),nk.debug("[".concat(this._clientId,"] user online"),e.uid),this.store.firstVideoFrameDecoded(t.uid,{userJoinNotify:Date.now()}),this.safeEmit(WN.USER_JOINED,t)}}),nR(this,"_handleUserOffline",e=>{if(SP("BLOCK_LOCAL_CLIENT")&&YM(e.uid,this.channelName))return;const t=this._users.find(t=>t.uid===e.uid);t&&(this._handleRemoveStream(e),this._handleRemoveDataChannels(e),t._audio_pre_subscribed||t._video_pre_subscribed?t._is_pre_created=!0:rO(this._users,t),this._remoteStreamTypeCacheMap.delete(t.uid),this._streamFallbackTypeCacheMap.delete(t.uid),nk.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),this.safeEmit(WN.USER_LEAVED,t,e.reason))}),nR(this,"_handleAddAudioOrVideoStream",(e,t,n,r,i,o,a,s)=>{if(SP("BLOCK_LOCAL_CLIENT")&&YM(t,this.channelName))return;const c=this._users.find(e=>e.uid===t);if(!c)return void nk.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));nk.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(c.uid,e,void 0,void 0,void 0,Date.now()),"video"===e&&this.store.firstVideoFrameDecoded(c.uid,{videoAddNotify:Date.now()});const l="audio"===e?c.hasAudio:c.hasVideo;c._uintid||(c._uintid=o||t),"audio"===e?c._trust_audio_stream_added_state_=!0:c._trust_video_stream_added_state_=!0,"audio"===e?(c._audio_added_=!0,void 0!==n&&(c._audioSSRC=n),void 0!==r&&(c._cname=r),a&&(c._audioOrtc=a)):(c._video_added_=!0,void 0!==n&&(c._videoSSRC=n),void 0!==r&&(c._cname=r),void 0!==s&&(c._rtxSsrcId=s),a&&(c._videoOrtc=a)),("audio"===e?c.hasAudio:c.hasVideo)&&!l&&(nk.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published ").concat(e)),this.safeEmit(WN.USER_PUBLISHED,c,e)),"video"===e?dk.onGatewayStream(this._sessionId,ak.ON_ADD_VIDEO_STREAM,sk.ON_ADD_VIDEO_STREAM,{peer:o||t,ssrc:c._videoSSRC}):dk.onGatewayStream(this._sessionId,ak.ON_ADD_AUDIO_STREAM,sk.ON_ADD_AUDIO_STREAM,{peer:o||t,ssrc:c._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(c,e,n).then(t=>{if(t&&(nk.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(c.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof fW))return this._p2pChannel.unsubscribe(c,e,!0).then(()=>this._subscribe(c,e,!0).catch(e=>{nk.error("[".concat(this._clientId,"] resubscribe error"),e.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(c,e)&&(nk.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(c.uid," after reconnect.")),this._subscribe(c,e,!0).catch(e=>{nk.error("[".concat(this._clientId,"] resubscribe error"),e.toString())}));const d=this._getEncodingName(i);"video"===e&&("unknown"===d?this.safeEmit(WN.AV1_DECODABLE_RESULT,!1):UI()||BI()||(null==d?void 0:d.toLocaleLowerCase())!==RP.av1||VV().then(e=>{SP("FLS_ENABLE_AV1_DECODE_DETECT")&&this.safeEmit(WN.AV1_DECODABLE_RESULT,e),e||this._gateway.downgradeCodec(d)}))}),nR(this,"_handleRemoveStream",e=>{if(SP("BLOCK_LOCAL_CLIENT")&&YM(e.uid,this.channelName))return;const t=this._users.find(t=>t.uid===e.uid);if(!t)return void nk.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));nk.debug("[".concat(this._clientId,"] stream removed with uid ").concat(e.uid));let n=()=>{};t.hasAudio&&t.hasVideo?n=()=>{nk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(WN.USER_UNPUBLISHED,t,"audio"),nk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(WN.USER_UNPUBLISHED,t,"video")}:t.hasVideo?n=()=>{nk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(WN.USER_UNPUBLISHED,t,"video")}:t.hasAudio&&(n=()=>{nk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(WN.USER_UNPUBLISHED,t,"audio")}),t._video_pre_subscribed||t._audio_pre_subscribed||(t._trust_audio_stream_added_state_=!0,t._trust_video_stream_added_state_=!0,t._audio_added_=!1,t._video_added_=!1,this._p2pChannel instanceof fW&&this._p2pChannel.unsubscribe(t).then(e=>{if(e)return this._gateway.unsubscribe(e,t.uid)}),t._audioSSRC=void 0,t._videoSSRC=void 0,t._audioOrtc=void 0,t._videoOrtc=void 0,t._rtxSsrcId=void 0),dk.onGatewayStream(this._sessionId,ak.ON_REMOVE_STREAM,sk.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),n()}),nR(this,"_handleSetStreamLocalEnable",(e,t,n)=>{if(SP("BLOCK_LOCAL_CLIENT")&&YM(t,this.channelName))return;const r=this._users.find(e=>e.uid===t);if(!r)return void nk.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));nk.debug("[".concat(this._clientId,"] local ").concat(e," ").concat(n?"enabled":"disabled"," with uid ").concat(t));const i="audio"===e?r.hasAudio:r.hasVideo;if("audio"===e){r._trust_audio_enabled_state_=!0;const e=r._audio_enabled_;if(r._audio_enabled_=n,r._audio_enabled_===e)return;{const e=r._audio_enabled_?"enable-local-audio":"disable-local-audio";nk.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(WN.USER_INFO_UPDATED,t,e)}}else{r._trust_video_enabled_state_=!0;const e=r._video_enabled_;if(r._video_enabled_=n,r._video_enabled_===e)return;{const e=r._video_enabled_?"enable-local-video":"disable-local-video";nk.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(WN.USER_INFO_UPDATED,t,e)}}const o="audio"===e?r.hasAudio:r.hasVideo;return i!==o?!i&&o?(nk.info("[".concat(this._clientId,"] remote user ").concat(t," published ").concat(e)),void this.safeEmit(WN.USER_PUBLISHED,r,e)):("video"===e&&r._videoTrack&&r._videoTrack._destroy(),"audio"===e&&r._audioTrack,this._p2pChannel.muteRemote(r,e),nk.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished ").concat(e)),void this.safeEmit(WN.USER_UNPUBLISHED,r,e)):void 0}),nR(this,"_handleMuteStream",(e,t,n)=>{if(SP("BLOCK_LOCAL_CLIENT")&&YM(e,this.channelName))return;nk.debug("[".concat(this._clientId,"] receive mute message"),e,t,n);const r=this._users.find(t=>t.uid===e);if(!r)return void nk.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(e));const i="audio"===t?r.hasAudio:r.hasVideo;if("audio"===t){r._trust_audio_mute_state_=!0;const t=r._audio_muted_;if(r._audio_muted_=n,r._audio_muted_===t)return;{const t=r._audio_muted_?"mute-audio":"unmute-audio";nk.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(WN.USER_INFO_UPDATED,e,t)}}else{r._trust_video_mute_state_=!0;const t=r._video_muted_;if(r._video_muted_=n,r._video_muted_===t)return;{const t=r._video_muted_?"mute-video":"unmute-video";nk.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(WN.USER_INFO_UPDATED,e,t)}}const o="audio"===t?r.hasAudio:r.hasVideo;if(i!==o){if(!i&&o)return("audio"===t?r._audioSSRC:r._videoSSRC)?(nk.info("[".concat(this._clientId,"] remote user ").concat(e," published ").concat(t)),void this.safeEmit(WN.USER_PUBLISHED,r,t)):void nk.warning("[".concat(this._clientId,"] remote user ").concat(e," receive ").concat(t," unmute message  before add stream message, ").concat(t," SSRC doesn't exist yet."));"video"===t&&r._videoTrack&&!r._video_pre_subscribed&&r._videoTrack._destroy(),"audio"===t&&r._audioTrack,this._p2pChannel.muteRemote(r,t),nk.info("[".concat(this._clientId,"] remote user ").concat(e," unpublished ").concat(t)),this.safeEmit(WN.USER_UNPUBLISHED,r,t)}}),nR(this,"_handleP2PLost",async e=>{nk.debug("[".concat(this._clientId,"] receive p2p lost"),e),parseInt(e.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():nk.warning("[".concat(this._clientId,"] P2PLost stream not found"),e)}),nR(this,"_handleTokenWillExpire",()=>{nk.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(WN.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),nR(this,"_handleBeforeUnload",e=>{"beforeunload"===e.type&&void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),nk.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),nR(this,"_handleUpdateNetworkQuality",()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.safeEmit(WN.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const e={downlinkNetworkQuality:0,uplinkNetworkQuality:0};e.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),e.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(WN.NETWORK_QUALITY,e)}),nR(this,"_handleP2PAddAudioOrVideoStream",(e,t,n,r)=>{const i=this._users.find(e=>e.uid===t);if(!i)return void nk.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));nk.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(i.uid,e,void 0,void 0,void 0,Date.now());const o="audio"===e?i.hasAudio:i.hasVideo;"audio"===e?i._trust_audio_stream_added_state_=!0:i._trust_video_stream_added_state_=!0,"audio"===e?(i._audio_added_=!0,void 0!==n&&(i._audioSSRC=n),void 0!==r&&(i._audioMid=r)):(i._video_added_=!0,void 0!==n&&(i._videoSSRC=n),void 0!==r&&(i._videoMid=r)),("audio"===e?i.hasAudio:i.hasVideo)&&!o&&(nk.info("[".concat(this._clientId,"] remote user ").concat(i.uid," published ").concat(e)),this.safeEmit(WN.USER_PUBLISHED,i,e)),this._p2pChannel.hasPendingRemoteMedia(i,e)&&(nk.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(i.uid," after reconnect.")),this._subscribe(i,e,!0).catch(e=>{nk.error("[".concat(this._clientId,"] resubscribe error"),e.toString())}))}),this._config=e,this._clientId=t||vO(5,"client-"),this.store=new class{constructor(e,t,n,r,i){lN(this,"state",void 0),this.state={codec:e,audioCodec:t,mode:n,clientId:r,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[],firstVideoFrameDecoded:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:mP.Default,hasStartJoinChannel:!1,isABTestSuccess:!1,rteUrl:void 0,rteSid:void 0,autoSubscribe:!1,enableInstantMuteRestore:!1,networkQualityProbe:!1,useDcSignal:!!i}}dispatch(e){this.state=function(e,t){switch(t.type){case wP.SET_SESSION_ID:return uN(uN({},e),{},{sessionId:t.sessionId});case wP.SET_P2P_ID:return uN(uN({},e),{},{p2pId:t.p2pId});case wP.SET_UID:return uN(uN({},e),{},{uid:t.uid});case wP.SET_INT_UID:return uN(uN({},e),{},{intUid:t.intUid});case wP.SET_PUB_ID:return uN(uN({},e),{},{pubId:t.pubId});case wP.KEY_METRIC_CLIENT_CREATED:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{clientCreated:t.metric})});case wP.KEY_METRIC_JOIN_START:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{joinStart:t.metric})});case wP.KEY_METRIC_PRELOAD_START:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{preloadStart:t.metric})});case wP.KEY_METRIC_PRELOAD_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{preloadEnd:t.metric})});case wP.KEY_METRIC_JOIN_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{joinEnd:t.metric})});case wP.KEY_METRIC_REQUEST_AP_START:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{requestAPStart:t.metric})});case wP.KEY_METRIC_REQUEST_AP_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{requestAPEnd:t.metric})});case wP.KEY_METRIC_REQUEST_SUA_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{requestSUAEnd:t.metric})});case wP.KEY_METRIC_BEFORE_CONNECT:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{beforeConnect:t.metric})});case wP.KEY_METRIC_PEER_RECEIVER:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{peerReceiver:t.metric})});case wP.KEY_METRIC_SIGNAL_CONNECTED:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{signalConnected:t.metric})});case wP.KEY_METRIC_JOIN_REQ:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{joinReq:t.metric})});case wP.KEY_METRIC_JOIN_REP:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{joinRep:t.metric})});case wP.KEY_METRIC_JOIN_GATEWAY_START:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{joinGatewayStart:t.metric})});case wP.KEY_METRIC_JOIN_GATEWAY_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{joinGatewayEnd:t.metric})});case wP.KEY_METRIC_PEER_CONNECTION_START:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{peerConnectionStart:t.metric})});case wP.KEY_METRIC_PEER_CONNECTION_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{peerConnectionEnd:t.metric})});case wP.KEY_METRIC_DESCRIPTION_START:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{descriptionStart:t.metric})});case wP.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{signalChannelOpen:t.metric})});case wP.KEY_METRIC_ICE_CONNECTION_END:return uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{iceConnectionEnd:t.metric})});case wP.KEY_METRIC_PUBLISH:{const n=e.keyMetrics.publish,r=n.findIndex(e=>e.trackId===t.metric.trackId);return-1!==r?(n[r]=uN(uN({},n[r]),t.metric),uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{publish:[...n]})})):uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{publish:[...e.keyMetrics.publish,t.metric]})})}case wP.KEY_METRIC_SUBSCRIBE:{const n=e.keyMetrics.subscribe,r=n.findIndex(e=>e.userId===t.metric.userId&&e.type===t.metric.type);return-1!==r?(n[r]=uN(uN({},n[r]),t.metric),uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{subscribe:[...n]})})):uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{subscribe:[...e.keyMetrics.subscribe,t.metric]})})}case wP.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED:{const n=e.keyMetrics.firstVideoFrameDecoded,r=n.findIndex(e=>e.userId===t.metric.userId);return-1!==r?(n[r]=uN(uN({},n[r]),t.metric),uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{firstVideoFrameDecoded:[...n]})})):uN(uN({},e),{},{keyMetrics:uN(uN({},e.keyMetrics),{},{firstVideoFrameDecoded:[...e.keyMetrics.firstVideoFrameDecoded,t.metric]})})}case wP.RESET_FIRST_VIDEO_FRAME_DECODED:return e.keyMetrics.firstVideoFrameDecoded=[],e;case wP.SET_CLOUD_PROXY_SERVER_MODE:return e.cloudProxyServerMode=t.mode,e;case wP.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof t.index?e.joinChannelServiceRecords=[...e.joinChannelServiceRecords,t.record]:(e.joinChannelServiceRecords[t.index]=uN(uN({},e.joinChannelServiceRecords[t.index]),t.record),e.joinChannelServiceRecords=[...e.joinChannelServiceRecords]),e;case wP.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return e.joinChannelServiceRecords=[],e;case wP.RESET_KEY_METRICS:return e.keyMetrics={publish:[],subscribe:[],firstVideoFrameDecoded:[]},e;case wP.SET_USE_P2P:return uN(uN({},e),{},{useP2P:t.val});case wP.SET_TRANSPORT_TYPE:return uN(uN({},e),{},{p2pTransport:t.val});case wP.SET_RTE_URL:return uN(uN({},e),{},{rteUrl:t.rteUrl});case wP.SET_RTE_SID:return uN(uN({},e),{},{rteSid:t.rteSid});default:return e}}(this.state,e)}get useDcSignal(){return this.state.useDcSignal}set useDcSignal(e){this.state.useDcSignal=e}set autoSubscribe(e){this.state.autoSubscribe=e}get autoSubscribe(){return this.state.autoSubscribe}set enableInstantMuteRestore(e){this.state.enableInstantMuteRestore=e}get enableInstantMuteRestore(){return this.state.enableInstantMuteRestore}set networkQualityProbe(e){this.state.networkQualityProbe=e}get networkQualityProbe(){return this.state.networkQualityProbe}set sessionId(e){this.dispatch({type:wP.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.state.sessionId}set rteUrl(e){this.dispatch({type:wP.SET_RTE_URL,rteUrl:e})}get rteUrl(){return this.state.rteUrl}set rteSid(e){this.dispatch({type:wP.SET_RTE_SID,rteSid:e})}get rteSid(){return this.state.rteSid}set cid(e){this.state.cid=e}get cid(){return this.state.cid}set codec(e){this.state.codec=e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(e){this.dispatch({type:wP.SET_P2P_ID,p2pId:e})}get p2pId(){return this.state.p2pId}set dcId(e){this.dispatch({type:wP.SET_DC_ID,dcId:e})}get dcId(){return this.state.dcId}set uid(e){this.dispatch({type:wP.SET_UID,uid:e})}get uid(){return this.state.uid}set intUid(e){this.dispatch({type:wP.SET_INT_UID,intUid:e})}get intUid(){return this.state.intUid}set pubId(e){this.dispatch({type:wP.SET_PUB_ID,pubId:e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(e){this.dispatch({type:wP.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(e){this.dispatch({type:wP.SET_USE_P2P,val:e})}get useP2P(){return this.state.useP2P}set p2pTransport(e){this.dispatch({type:wP.SET_TRANSPORT_TYPE,val:e})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(e){this.state.hasStartJoinChannel=e}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(e){this.state.isABTestSuccess=e}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:wP.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:wP.KEY_METRIC_JOIN_START,metric:Date.now()})}preloadStart(){this.dispatch({type:wP.KEY_METRIC_PRELOAD_START,metric:Date.now()})}preloadEnd(){this.dispatch({type:wP.KEY_METRIC_PRELOAD_END,metric:Date.now()})}joinEnd(){this.dispatch({type:wP.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:wP.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:wP.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}requestSUAEnd(){this.dispatch({type:wP.KEY_METRIC_REQUEST_SUA_END,metric:Date.now()})}beforeConnect(){this.dispatch({type:wP.KEY_METRIC_BEFORE_CONNECT,metric:Date.now()})}peerReceiver(){this.dispatch({type:wP.KEY_METRIC_PEER_RECEIVER,metric:Date.now()})}signalConnected(){this.dispatch({type:wP.KEY_METRIC_SIGNAL_CONNECTED,metric:Date.now()})}joinReq(){this.dispatch({type:wP.KEY_METRIC_JOIN_REQ,metric:Date.now()})}joinRep(){this.dispatch({type:wP.KEY_METRIC_JOIN_REP,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:wP.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:wP.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:wP.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:wP.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}firstVideoFrameDecoded(e,t){this.dispatch({type:wP.KEY_METRIC_FIRST_VIDEO_FRAME_DECODED,metric:uN({userId:e},t)})}descriptionStart(){this.dispatch({type:wP.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:wP.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:wP.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(e,t,n,r){this.dispatch({type:wP.KEY_METRIC_PUBLISH,metric:uN(uN({trackId:e,type:t},n&&{publishStart:n}),r&&{publishEnd:r})})}subscribe(e,t,n,r,i,o,a){this.dispatch({type:wP.KEY_METRIC_SUBSCRIBE,metric:uN(uN(uN(uN(uN({userId:e,type:t},n&&{subscribeStart:n}),r&&{subscribeEnd:r}),i&&{firstFrame:i}),o&&{streamAdded:o}),a&&{firstDecoded:a})})}massSubscribe(e,t,n,r){e.forEach(e=>{this.dispatch({type:wP.KEY_METRIC_SUBSCRIBE,metric:uN(uN(uN({userId:e.userId,type:e.type},t&&{subscribeStart:t}),n&&{subscribeEnd:n}),r&&{firstFrame:r})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(e,t){"gateway"===e.service&&Array.isArray(e.urls)&&(e.urls=e.urls.map(e=>e.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return"number"!=typeof t?(this.dispatch({type:wP.RECORD_JOIN_CHANNEL_SERVICE,record:uN(uN({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(t<0||t>=this.state.joinChannelServiceRecords.length||this.dispatch({type:wP.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:t}),t)}catch(e){return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:wP.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:wP.RESET_KEY_METRICS})}resetFirstVideoFrameDecoded(){this.dispatch({type:wP.RESET_FIRST_VIDEO_FRAME_DECODED})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch(e){return[]}}}(e.codec,e.audioCodec,e.mode,this._clientId,1===SP("SIGNAL_CHANNEL")),this._leaveMutex=new kO("client-leave",this._clientId),this._publishMutex=new kO("client-publish",this._clientId),this._renewTokenMutex=new kO("client-renewtoken",this._clientId),this._subscribeMutex=new kO("client-subscribe",this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),nk.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(hP," build: ").concat(vP,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{BN(e.clientRoleOptions),n=Object.assign({},e.clientRoleOptions)}catch(e){nk.warning("[".concat(this._clientId,"] ").concat(e.toString()))}var r;this._statsCollector=new iB(this.store),this._statsCollector.onStatsException=(e,t,n)=>{nk.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(e,", msg: ").concat(t,", uid: ").concat(n)),e===eB.VIDEO_ENCODE_FAILED&&this.localTracks.forEach(e=>{e instanceof LL&&SP("ENABLE_ENCODE_EXCEPTION")&&e.findClosestProfile()}),this.safeEmit(WN.EXCEPTION,{code:e,msg:t,uid:n})},this._statsCollector.onUploadPublishDuration=(e,t,n,r)=>{const i=this._users.find(t=>t.uid===e);i&&(this.store.keyMetrics&&(this.store.firstVideoFrameDecoded(i.uid,{peerPublishDuration:n,peerPubStatusMs:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(i)),dk.peerPublishStatus(this._sessionId,{subscribeElapse:r,audioPublishDuration:t,videoPublishDuration:n,peer:i._uintid}))},this._statsCollector.onVideoCodecChanged=e=>{if(SP("VIDEO_STANDARD_BITRATE_VERSION")&&("av1"===e||"h265"===e||"h264"===e)){const t=this.localTracks.find(e=>e instanceof xL);t&&1!==t._saveEncodeBitrateRatio&&t.setSaveEncodeBitrateRatio("h264"===e?SP("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P="p2p"===e.mode,this._gateway=new uV(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||xO,httpRetryConfig:e.httpRetryConfig||xO,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:n}),this._configDistribute=new QV(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(r={store:this.store,statsCollector:this._statsCollector},oV("P2PChannel").create(r)),this._handleP2PEvents()):this._p2pChannel=new fW(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];yP("JOIN_GATEWAY_USE_443PORT_ONLY",o),yP("JOIN_GATEWAY_USE_DUAL_DOMAIN",a);const s=this._gateway.signal.websocket;return s instanceof QF&&(s.use443PortOnly=o,s.tryDoubleDomain=a),async function(e,t,n){TI.get(e)||TI.set(e,[]),CI.get(e)||CI.set(e,t),wI.get(e)||wI.set(e,0);const r=TI.get(e),i=CI.get(e);if(!r||!i)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(wI.get(e)===i){const e=SI();r.push(e),await e.promise}wI.set(e,wI.get(e)+1);for(var o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];const c=await n(...a);return wI.set(e,wI.get(e)-1),wI.get(e)===i-1&&r.length>0&&(r[0].resolve(),r.shift()),0===wI.get(e)&&(TI.set(e,[]),CI.set(e,0),wI.set(e,0)),c}("client.join",SP("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,n,r,i)}async join(e,t,n,r,i){const o=++this._numberOfJoinCount;this.store.joinStart(),r&&(this.store.uid=r);const a="HTTPS"===(UO||UO||(UO=(window.location.protocol.split(":")[0]||"").toUpperCase(),UO)),s=HO()?window.isSecureContext:"Browser Not Support";if(!HO()&&!a||!window.isSecureContext){const e="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";nk.warning(e)}let c;dk.setAppId(e);try{if(!n&&null!==n)throw new uk(hN.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));if(n&&vN(n,"token",1,2047),vN(e,"appid",1,2047),GU(t),r&&zU(r),i)if("string"==typeof i)vN(i,"optionalInfo",1,256),c=i;else{if("object"!=typeof i)throw new uk(hN.INVALID_PARAMS,"Invalid options: options is not a string or object");{const{autoSubscribe:e,enableInstantMuteRestore:t,networkQualityProbe:n}=i;e&&(mN(e,"autoSubscribe"),nk.info("[".concat(this._clientId,"] join: autoSubscribe: ").concat(e)),this.store.autoSubscribe=e),t&&(mN(t,"enableInstantMuteRestore"),nk.info("[".concat(this._clientId,"] join: enableInstantMuteRestore: ").concat(t)),this.store.enableInstantMuteRestore=t),n&&(mN(n,"networkQualityProbe"),nk.info("[".concat(this._clientId,"] join: networkQualityProbe: ").concat(n)),this.store.networkQualityProbe=n)}}}catch(i){throw dk.reportApiInvoke(bO(),{name:DN.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:xN.TRACER}).onError(i),i}if(this._leaveMutex.isLocked&&(nk.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),nk.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,"DISCONNECTED"!==this.connectionState){const i=new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw dk.reportApiInvoke(bO(),{name:DN.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:xN.TRACER}).onError(i),i}this._gateway.state="CONNECTING",this.store.preloadStart();const l=await HW({appId:e,cname:t,uid:r,stringUid:"string"==typeof r?r:void 0,token:n||e,cloudProxyServer:this._cloudProxyServerMode});if(this.store.preloadEnd(),!this._joinAndNotLeaveYet)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const d=(null==l?void 0:l.sid)||bO();nk.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(o)),this._sessionId||(this._sessionId=d,this.store.sessionId=this._sessionId);const u=dk.reportApiInvoke(this._sessionId,{id:this._clientId,name:DN.JOIN,options:[e,t,n,r],states:{isHttps:a,isSecureContext:s},tag:xN.TRACER}),h=TG(TG(TG({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof r?r:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:n||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:c,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!l},void 0!==this._remoteDefaultVideoStreamType&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:SP("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(h.setLocalAPVersion=this._setLocalAPVersion),"string"==typeof r&&(h.stringUid=r,this._uintUid?(h.uid=this._uintUid,this._uintUid=void 0):h.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret){if(h.aesmode=this._encryptionMode,h.aespassword=await(async e=>{const t=function(){const e=window.atob("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),t=new Uint8Array(new ArrayBuffer(e.length));for(let n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t}(),n=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),r=AN(e),i=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,r);return function(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}(new Uint8Array(i))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(h.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&("aes-128-gcm2"===this._encryptionMode||"aes-256-gcm2"===this._encryptionMode))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const e=new TextEncoder,t=SP("USE_PURE_ENCRYPTION_MASTER_KEY")?e.encode(h.appId+this._encryptionSecret+this._encryptionSecret):e.encode(h.appId+h.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(e,t,n){const r=await window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"]),i="aes-128-gcm2"===e?128:256,o=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:NP,hash:"SHA-256",salt:n},r,i+IP);return new Uint8Array(o).subarray(i/8)}(this._encryptionMode,t,dO(this._encryptionSalt)),this._encryptDataStreamKey=await async function(e,t,n){const r=await window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"]),i="aes-128-gcm2"===e?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:NP,hash:"SHA-256",salt:n},r,{name:"AES-GCM",length:i},!0,["encrypt","decrypt"])}(this._encryptionMode,t,dO(this._encryptionSalt))}else s?nk.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):nk.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,nk.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:t,appId:e,stringUid:h.stringUid});const p=this._sessionId;setTimeout(()=>{"CONNECTING"===this.connectionState&&p===this._sessionId&&dk.joinChannelTimeout(this._sessionId,5)},5e3);try{var m;let r;const i=h.cloudProxyServer;if(xr(m=["proxy3","proxy4","proxy5"]).call(m,i)){const e=SP("PROXY_SERVER_TYPE3");Array.isArray(e)?h.proxyServer=e[0]:h.proxyServer=e}if(dk.setProxyServer(h.proxyServer),nk.setProxyServer(h.proxyServer),this.store.requestAPStart(),l){if(nk.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(h.stringUid?", ".concat(h.stringUid," => ").concat(l.intUid):""," ")),h.stringUid&&!h.uid&&(h.uid=l.intUid),r={gatewayInfo:l.ap.gatewayInfo},SP("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&"auto"===h.turnServer.mode)if(0===l.ap.proxyInfo.addresses.length)nk.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const e=(await pj(l.ap.proxyInfo,l.ap.gatewayInfo.uid)).map(e=>({turnServerURL:e.address,tcpport:e.tcpport||fP.tcpport,udpport:e.udpport||fP.udpport,username:e.username||fP.username,password:e.password||fP.password,forceturn:!1,security:!0}));h.turnServer={mode:"manual",servers:e}}qW(l,h.stringUid)}else{if(h.stringUid&&!h.uid){let e;[e,r]=await ip.all([HV(h.stringUid,h,this._axiosCancelSource.token,this._config.httpRetryConfig||xO,this.store).finally(()=>{this.store.requestSUAEnd()}),WV(h,this._axiosCancelSource.token,this._config.httpRetryConfig||xO,!0,this.store).finally(()=>{this.store.requestAPEnd()})]),nk.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(h.stringUid," => ").concat(e)),h.uid=e,r.gatewayInfo.uid=e,r.gatewayInfo.res.uid=e}else r=await WV(h,this._axiosCancelSource.token,this._config.httpRetryConfig||xO,!0,this.store);if(!this._joinAndNotLeaveYet)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(h,this._axiosCancelSource.token),this._configDistribute.on(pF.UPDATE_BITRATE_LIMIT,e=>{this._p2pChannel.updateBitrateLimit(e)}),this._configDistribute.on(pF.UPDATE_CLIENT_ROLE_OPTIONS,e=>{this._setClientRoleOptions(e)}),this._configDistribute.on(pF.UPDATE_REMOTE_VIDEO_STREAM_TYPE,e=>{var t;xr(t=[0,1,4,5,6,7,8,9]).call(t,e)&&(this.remoteUsers.forEach(t=>{this._remoteStreamTypeCacheMap.get(t.uid)!==e&&this.setRemoteVideoStreamType(t.uid,e)}),this.setRemoteDefaultVideoStreamType(e))}),this._configDistribute.on(pF.FALLBACK_TO_HLS,e=>{e&&this.safeEmit(WN.FALLBACK_TO_HLS,HN.CONFIG)}),this._configDistribute.on(pF.UPDATE_VOS_CONFIGURE,e=>{this._gateway.setConfigure(e).catch(e=>{nk.debug("[".concat(this._clientId,"] auto set vos config failed"),e)})})},0),this._key=n||e;const o=r.gatewayInfo,a=h.uid?h.uid:o.uid;this._joinInfo=TG(TG({},h),{},{cid:o.cid,uid:a,vid:o.vid,apResponse:o.res,apGatewayAddress:o.apGatewayAddress,uni_lbs_ip:o.uni_lbs_ip,gatewayAddrs:o.gatewayAddrs}),this.store.intUid=a,this.store.cid=o.cid;const s=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));u.onSuccess(s),this._appId=e,this._channelName=h.cname,this._uid=s,this.store.uid=s,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),!UI()&&this.store.useDcSignal?(window.addEventListener("beforeunload",this._handleBeforeUnload),window.addEventListener("pagehide",this._handleBeforeUnload)):window.addEventListener(UI()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const c=h.stringUid?"string uid: ".concat(h.stringUid,",uid: ").concat(h.uid):"uid: ".concat(this._uid);return nk.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(c)),setTimeout(()=>{nk.startUpload()},5e3),this.store.joinEnd(),f=this,xr(zM).call(zM,f)||zM.push(f),"disabled"===this._cloudProxyServerMode&&pk().supportWebCrypto&&SP("ENABLE_PRELOAD")&&KW(this._joinInfo),this._rteDetailInterval&&(window.clearInterval(this._rteDetailInterval),this._rteDetailInterval=void 0),this._sessionId&&dk.reportRteDetail(this._sessionId),this._rteDetailInterval=window.setInterval(()=>{this._sessionId&&dk.reportRteDetail(this._sessionId)},SP("RTE_DETAIL_REPORT_INTERVAL")||6e4),s}catch(e){const t=Array.isArray(e)?e[0]:e;throw t&&t.code===hN.OPERATION_ABORTED?nk.warning("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),t):nk.error("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),t),t.code!==hN.OPERATION_ABORTED&&this._numberOfJoinCount===o&&(this._gateway.state="DISCONNECTED",this._reset()),u.onError(t),t}var f}async _joinGateway(){if(!this._joinInfo||!this._key)throw new uk(hN.INVALID_OPERATION);try{return await this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!SP("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}catch(e){if(e.code===hN.INIT_DATACHANNEL_TIMEOUT){if(this._gateway.leave(!0,UN.FALLBACK),nk.debug("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new uk(hN.INVALID_OPERATION);return dk.reportApiInvoke(this._sessionId,{name:DN.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:xN.TRACER}).onSuccess(),await this._joinGateway()}throw e}}async leave(){nk.info("[".concat(this._clientId,"] Leaving channel"));const e=()=>{!UI()&&this.store.useDcSignal?(window.addEventListener("beforeunload",this._handleBeforeUnload),window.addEventListener("pagehide",this._handleBeforeUnload)):window.addEventListener(UI()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(e){const t=zM.indexOf(e);-1!==t&&zM.splice(t,1)}(this),this._statsCollector.stopUpdateStats()};this.store.useDcSignal||e();const t=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return nk.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void t();await this._gateway.leave("CONNECTED"!==this.connectionState,UN.LEAVE),nk.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),t(),this.store.useDcSignal&&e()}async publish(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Array.isArray(e)){if(!(e instanceof dD))return this._publishDataChannel(e);e=[e]}if(0===e.length)throw new uk(hN.INVALID_PARAMS,"param list is empty");const n=e;if("audience"===this._gateway.role)throw new uk(hN.INVALID_OPERATION,"audience can not publish stream");for(const i of n){if(!(i instanceof dD))throw new uk(hN.INVALID_PARAMS,"parameter is not local track");if(!i._enabled&&t)throw new uk(hN.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(i.getTrackId()))}nk.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(n.map(e=>"".concat(e.getTrackId()," "))));const r=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&n.forEach(e=>{const t=this._configDistribute.getBitrateLimit();e instanceof xL&&t&&e.setBitrateLimit(t.uplink)});try{await this._publishHighStream(n),nk.info("[".concat(this._clientId,"] Publish success, id ").concat(n.map(e=>"".concat(e.getTrackId()," "))))}catch(e){throw nk.error("[".concat(this._clientId,"] publish error"),e.toString()),e}finally{r()}}async _publishDataChannel(e){if(null==e)throw new uk(hN.INVALID_PARAMS,"parameter is not local track or datachannel config, config is ".concat(JSON.stringify(e)));gN(e.id,"id",0,65535,!0),mN(e.ordered,"ordered"),vN(e.metadata,"metadata",0,512),nk.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const t=await this._publishMutex.lock();try{if(-1!==this._p2pChannel.getAllDataChannels().findIndex(t=>t.id===e.id))throw new uk(hN.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||void 0===this._uid)throw new uk(hN.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&SP("FORCE_TURN")&&!SP("TURN_ENABLE_TCP")&&!SP("TURN_ENABLE_UDP"))throw new uk(hN.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const t=function(e){return aV(e,!1)}(e),n=await this._p2pChannel.publishDataChannel([t]);if(n.length>0){if("number"!=typeof t._originDataChannelId)throw nk.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new uk(hN.CREATE_DATACHANNEL_ERROR);try{await ip.all(n.map(e=>this._uid&&this._gateway.publishDataChannel(this._uid,e,!0))),await t._waitTillOpen()}catch(e){if(e.code!==hN.DISCONNECT_P2P)throw e}}return nk.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(t.id)),t}catch(e){throw nk.error("[".concat(this._clientId,"] publish datachannels error"),e.toString()),e}finally{t()}}async unpublish(e){if(!this._joinInfo||void 0===this._uid)throw new uk(hN.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof dD))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);nk.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map(e=>"".concat(e.getTrackId()," "))," "));const n=await this._publishMutex.lock();try{if(this.store.useP2P){const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.sendExtensionMessage(DF.UNPUBLISH,{unpubMsg:e},!0)}else{const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.unpublish(e,this._uid),nk.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map(e=>"".concat(e.getTrackId()))))}}catch(e){throw nk.error("[".concat(this._clientId,"] unpublish error"),e.toString()),e}finally{n&&n()}}async _unpublishDataChannel(e){void 0!==e&&0!==e.length||(e=this._p2pChannel.getAllDataChannels()),nk.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(e=>"".concat(e.id," "))," "));const t=await this._publishMutex.lock();try{const t=await this._p2pChannel.unpublishDataChannel(e);t&&await this._gateway.unpublishDataChannel(t),nk.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(e=>"".concat(e.id))))}catch(e){throw nk.error("[".concat(this._clientId,"] unpublish dataChannel error"),e.toString()),e}finally{t&&t()}}async subscribe(e,t,n){if(!(e instanceof sB)){const t=this.remoteUsers.find(t=>t.uid===e);if(!t)throw new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");e=t}return"datachannel"===t?this._subscribeDataChannel(e,n):this._subscribe(e,t)}async presubscribe(e,t){if(fN(t,"mediaType",["audio","video"]),this.store.useP2P)throw new uk(hN.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"can't presub when not join");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const n=t===_F.AUDIO,r=t===_F.VIDEO,i=await this._subscribeMutex.lock();try{const{ssrcId:i,ortc:o,rtxSsrcId:a,cname:s,uint_id:c}=await this._gateway.presubscribe(e,t,!0);if(null==i)throw new uk(hN.UNEXPECTED_RESPONSE,"no ssrc id");let l=this._users.find(t=>t.uid===e);l||(l=new sB(e,c||e),l._is_pre_created=!0,this._users.push(l)),s&&(l._cname=s),l._uintid||(l._uintid=c||e),n&&(l._audioSSRC=i,l._audio_pre_subscribed=!0,o&&(l._audioOrtc=o)),r&&(l._videoSSRC=i,l._video_pre_subscribed=!0,o&&(l._videoOrtc=o),null!=a&&(l._rtxSsrcId=a)),nk.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(i)),await this._p2pChannel.subscribe(l,t,i,a,o);const d=n?l._audioTrack:l._videoTrack;if(!d)throw new uk(hN.UNEXPECTED_ERROR,"can not find remote track in user");return n&&(l._trust_audio_stream_added_state_=!0,l._audio_added_=!0),r&&(l._trust_video_stream_added_state_=!0,l._video_added_=!0),d}catch(t){throw nk.error("[".concat(this._clientId,"] presub user ").concat(e," error"),t),t}finally{i()}}async _subscribeDataChannel(e,t){var n;if(gN(t,"channelId",0,65535,!0),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));const r=this._users.find(t=>t===e);if(!r)throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&0===e._dataChannels.length)throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new uk(hN.INVALID_REMOTE_USER,"user is not published");const i=null===(n=e._dataChannels)||void 0===n?void 0:n.find(e=>e.id===t);if(!i)throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new uk(hN.REMOTE_USER_IS_NOT_PUBLISHED);const o=await this._subscribeMutex.lock();nk.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const n=await this._p2pChannel.subscribeDataChannel(e,[i]);if(n&&xr(n).call(n,i.id))try{var a;if("number"!=typeof i._originDataChannelId)throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new uk(hN.CREATE_DATACHANNEL_ERROR);const t={id:i.id,datachannelId:i._originDataChannelId,ordered:i.ordered,maxRetransmits:i.maxRetransmits,metadata:null!==(a=i.metadata)&&void 0!==a?a:""};await this._gateway.subscribeDataChannel(e.uid,t,!0),await i._waitTillOpen()}catch(t){if((null==t?void 0:t.code)!==hN.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[i]),t;await this._p2pChannel.unsubscribeDataChannel(e,[i]),this._p2pChannel.setPendingRemoteDataChannel(e,i.id)}return nk.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),i}finally{o()}}async _p2pSubscribe(e,t,n){if(fN(t,"mediaType",["audio","video"]),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=this._users.find(t=>t===e);if(!r){const t=new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new uk(hN.INVALID_REMOTE_USER,"user is not published");throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!n&&("audio"===t&&!e.hasAudio||"video"===t&&!e.hasVideo)){const n=new uk(hN.REMOTE_USER_IS_NOT_PUBLISHED);throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),n}const i=await this._subscribeMutex.lock();nk.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const n="audio"===t?e._audioSSRC:e._videoSSRC,r="audio"===t?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(e,t,n,r)}catch(e){throw e}nk.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),void 0!==this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(e=>{nk.warning("[".concat(this._clientId,"] auto set fallback failed"),e)});const n="audio"===t?e._audioTrack:e._videoTrack;if(!n)throw new uk(hN.UNEXPECTED_ERROR,"can not find remote track in user object");return n}catch(t){throw nk.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{i()}}async _subscribe(e,t,n){if(this.store.useP2P)return this._p2pSubscribe(e,t);if(fN(t,"mediaType",["audio","video"]),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=this._users.find(t=>t===e);if(!r){const t=new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new uk(hN.INVALID_REMOTE_USER,"user is not published");throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!(n||("audio"!==t||e.hasAudio&&void 0!==e._audioSSRC)&&("video"!==t||e.hasVideo&&void 0!==e._videoSSRC))){const n=new uk(hN.REMOTE_USER_IS_NOT_PUBLISHED);throw nk.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),n}let i="audio"===t?e._audioSSRC:e._videoSSRC,o="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?_F.AUDIO:_F.VIDEO,ssrcId:i};"video"===t&&this.store.firstVideoFrameDecoded(e.uid,{subscribeStart:Date.now()});const c=await this._subscribeMutex.lock();nk.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const r="audio"===t?e._audioSSRC:e._videoSSRC;void 0!==r&&r!==i&&(i=r,o="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?_F.AUDIO:_F.VIDEO,ssrcId:i}),tB.markSubscribeStart(this.store.clientId,i),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,i,a,o);try{this._p2pChannel.isPreSubScribe(i)||await this._gateway.subscribe(e.uid,s,!0)}catch(n){if((null==n?void 0:n.code)!==hN.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),n;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(n){throw this._p2pChannel.reportSubscribeEvent(!1,null==n?void 0:n.code,e,t),n}nk.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),void 0!==this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(e=>{nk.warning("[".concat(this._clientId,"] auto set fallback failed"),e)});const r="audio"===t?e._audioTrack:e._videoTrack;if(!r)throw new uk(hN.UNEXPECTED_ERROR,"can not find remote track in user object");return"video"===t&&(this.store.firstVideoFrameDecoded(e.uid,{subscribeEnd:Date.now()}),this._p2pChannel.reportVideoFirstFrameRender(e)),r}catch(t){throw nk.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{c()}}async massSubscribe(e){if(bN(e,"subscribeList"),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const t=Date.now(),n=new Map,r=await this._subscribeMutex.lock();nk.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)}).join("; ")));const i=(e=[...e]).map(e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n}}),o=await this._p2pChannel.globalLock();try{var a;for(let t=e.length-1;t>=0;t--){const r=e[t],{user:o,mediaType:a}=r;if(fN(a,"mediaType",["audio","video"]),!o){const e=new uk(hN.INVALID_PARAMS,"user property does not exist in subscribeList item");throw nk.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),e}const s=this._users.find(e=>e===o);if(!s){const n=new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");nk.error("[".concat(this._clientId,"] can not massSubscribe ").concat(o.uid,", this user is not in the channel")),i[t].error=n,e.splice(t,1);continue}if("audio"===a&&(!o.hasAudio||void 0===o._audioSSRC)||"video"===a&&(!o.hasVideo||void 0===o._videoSSRC)){const n=new uk(hN.REMOTE_USER_IS_NOT_PUBLISHED);nk.error("[".concat(this._clientId,"] can not subscribe ").concat(o.uid," with mediaType ").concat(a,", remote user is not published")),i[t].error=n,e.splice(t,1);continue}const c=cF.Video|cF.LwoVideo,l=n.get(o);if(l){if("video"===a?l&c:l&cF.Audio){e.splice(t,1),nk.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(o.uid,", mediaType:").concat(a," twice"));continue}n.set(o,l|("video"===a?c:cF.Audio))}else n.set(o,"video"===a?c:cF.Audio)}for(let t=e.length-1;t>=0;t--){const r=e[t],{user:i,mediaType:o}=r,a=cF.Video|cF.LwoVideo;if(this._p2pChannel.hasRemoteMedia(i,o)){await this._p2pChannel.unmuteRemoteNoLock(i,o);const r=n.get(i);n.set(i,"video"===o?r^a:r^cF.Audio),e.splice(t,1)}}this.store.massSubscribe(e.map(e=>({userId:e.user.uid,type:e.mediaType})),t);let r=ii(a=Array.from(n.entries())).call(a,(e,t)=>{let[n,r]=t;if(0===r)return e;const i={stream_id:n.uid,stream_type:r};return r&cF.Audio&&(i.audio_ssrc=n._audioSSRC),r&cF.Video&&(i.video_ssrc=n._videoSSRC),e.push(i),e},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n,ssrcId:n===_F.VIDEO?t._videoSSRC:t._audioSSRC,rtxSsrcId:n===_F.VIDEO?t._rtxSsrcId:void 0}}));const n=new Map;if(r=r.filter(e=>e.video_ssrc&&!this._p2pChannel.isPreSubScribe(e.video_ssrc)||e.audio_ssrc&&!this._p2pChannel.isPreSubScribe(e.audio_ssrc)||!e.video_ssrc&&!e.audio_ssrc),r.length>0){const e=await this._gateway.subscribeAll(r,!0);((null==e?void 0:e.users)||[]).forEach(e=>{let{stream_id:t,video_error_code:r,audio_error_code:i,error_code:o}=e;(r||i||o)&&n.set(t,{video_error_code:r,audio_error_code:i,error_code:o})})}if(Array.from(n.entries()).length>0){const e=[];Array.from(n.entries()).forEach(t=>{let[n,r]=t;const i=this.remoteUsers.find(e=>e.uid===n);if(i){let t;r.error_code||r.video_error_code&&r.audio_error_code?t=void 0:r.video_error_code?t=_F.VIDEO:r.audio_error_code&&(t=_F.AUDIO),e.push({user:i,mediaType:t})}}),e.length>0&&await this._p2pChannel.massUnsubscribeNoLock(e)}for(const e of i){const t=n.get(e.user.uid);if(t){const n=t.error_code||"audio"===e.mediaType&&t.audio_error_code||"video"===e.mediaType&&t.video_error_code;if(n){const t=VF(n);nk.error("user:".concat(e.user.uid," mediaType:").concat(e.mediaType," has massSubscribe error ").concat(t.desc)),e.error=new uk(hN.SUBSCRIBE_FAILED,"code ".concat(n,": ").concat(t.desc))}}e.error||("video"===e.mediaType?e.track=e.user.videoTrack:e.track=e.user.audioTrack)}return this.store.massSubscribe(i.filter(e=>!e.error).map(e=>({userId:e.user.uid,type:e.mediaType})),void 0,Date.now()),i.forEach(e=>{var n;dk.subscribe(this.store.sessionId,{succ:!!e.error,ec:(null===(n=e.error)||void 0===n?void 0:n.code)||null,video:e.mediaType===_F.VIDEO,audio:e.mediaType===_F.AUDIO,peerid:e.user.uid,subscribeRequestid:e.mediaType===_F.VIDEO?e.user._videoSSRC:e.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t),preSsrc:this._p2pChannel.isPreSubScribe(e.user._videoSSRC)},!0)}),nk.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)}).join("; "))),i}catch(t){throw await this._p2pChannel.massUnsubscribeNoLock(e),t}}finally{o(),r()}}async unsubscribe(e,t,n){if(!(e instanceof sB)){const t=this.remoteUsers.find(t=>t.uid===e);if(!t)throw new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");e=t}if(t||this.store.useP2P){if("datachannel"===t)return this._unsubscribeDataChannel(e,n)}else await this._unsubscribeDataChannel(e,n);if(t&&fN(t,"mediaType",["audio","video"]),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const r=this._users.find(t=>t===e);if(!r){const t=new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");throw nk.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}nk.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const i=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(e,t);else{const n=await this._p2pChannel.unsubscribe(e,t);n&&await this._gateway.unsubscribe(n,e.uid),t&&"audio"!==t||(e._audio_pre_subscribed=!1),t&&"video"!==t||(e._video_pre_subscribed=!1),e._is_pre_created&&rO(this._users,e),nk.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(t){if(t.code===hN.DISCONNECT_P2P)return void nk.warning("disconnecting p2p, abort unsubscribe request.");throw nk.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}finally{i()}}async _unsubscribeDataChannel(e,t){if(t&&gN(t,"id",0,65535,!0),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");const n=this._users.find(t=>t===e);if(!n){const t=new uk(hN.INVALID_REMOTE_USER,"user is not in the channel");throw nk.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}let r;if("number"==typeof t){const n=e._dataChannels.find(e=>e.id===t);n&&(r=[n])}else r=e._dataChannels;if(void 0===r){const n=new uk(hN.REMOTE_USER_IS_NOT_PUBLISHED);throw nk.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),n}nk.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(r.map(e=>e.id)));try{const t=await this._p2pChannel.unsubscribeDataChannel(e,r);t&&await this._gateway.unsubscribeDataChannel(t,e.uid),nk.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(t))}catch(t){if(t.code===hN.DISCONNECT_P2P)return void nk.warning("disconnecting p2p, abort unsubscribe request.");throw nk.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}}async massUnsubscribe(e){if(bN(e,"unsubscribeList"),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");nk.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")}).join())),e=[...e];const t=new Map;for(let n=e.length-1;n>=0;n--){const{user:r,mediaType:i}=e[n];if(!r){const e=new uk(hN.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw nk.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),e}fN(i,"mediaType",["video","audio",void 0]);const o=this._users.find(e=>e===r);if(!o){nk.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),e.splice(n,1);continue}const a=cF.Video|cF.LwoVideo;if(t.has(r)){const o=t.get(r);let s;switch(i){case"video":s=o&a;break;case"audio":s=o&cF.Audio;break;default:s=o&(cF.Audio|a)}if(s){nk.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(r.uid,",mediaType:").concat(i," twice.")),e.splice(n,1);continue}i?"audio"===i?t.set(r,o|cF.Audio):"video"===i&&t.set(r,o|a):t.set(r,o|cF.Audio|a)}else i?"audio"===i?t.set(r,cF.Audio):"video"===i&&t.set(r,a):t.set(r,cF.Audio|a)}try{const t=await this._p2pChannel.massUnsubscribe(e);t&&await this._gateway.massUnsubscribe(t),nk.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")}).join()))}catch(e){if(e.code===hN.DISCONNECT_P2P)return void nk.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw nk.error("[".concat(this._clientId,"] massUnsubscribe error"),e.toString()),e}}async setLowStreamParameter(e){!function(e){if(!e)throw new pN(hN.INVALID_PARAMS);EN(e.width)||_N(e.width,"streamParameter.width"),EN(e.height)||_N(e.height,"streamParameter.height"),EN(e.framerate)||_N(e.framerate,"streamParameter.framerate"),EN(e.bitrate)||gN(e.bitrate,"streamParameter.bitrate")}(e),(!e.width&&e.height||e.width&&!e.height)&&nk.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),nk.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,yF.LocalVideoLowTrack)}async setDualStreamMode(e,t){fN(e,"mode",[0,1,-1]);try{switch(t&&await this.setLowStreamParameter(t),this._dualStreamMode=e,this._joinInfo?this._gateway.setDualStreamMode(e).catch(e=>{nk.warning("[".concat(this._clientId,"] set dual stream mode failed"),e.toString())}):nk.debug("[".concat(this._clientId,"] haven't joined yet, cache dual stream mode ").concat(e)),e){case VN.AUTO_SIMULCAST_STREAM:nk.info("[".concat(this._clientId,"] set dual stream mode to ").concat(e));break;case VN.DISABLE_SIMULCAST_STREM:return this.disableDualStream();case VN.ENABLE_SIMULCAST_STREAM:return this.enableDualStream()}}catch(e){throw nk.error("[".concat(this._clientId,"] set dual stream mode error"),e.toString()),e}}async enableDualStream(){if(!pk().supportDualStream)throw dk.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new uk(hN.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new uk(hN.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw dk.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,this._dualStreamMode=VN.ENABLE_SIMULCAST_STREAM,this._joinInfo&&this._gateway.setDualStreamMode(this._dualStreamMode,!0,!0).catch(e=>{nk.debug("[".concat(this._clientId,"] try to inform gateway to set dual stream mode to ").concat(this._dualStreamMode," ,but failed"),e.toString())}),dk.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),nk.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)return this._isDualStreamEnabled=!1,void nk.info("[".concat(this._clientId,"] disable dual stream before join"));if(this._p2pChannel.getLocalMedia(yF.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw dk.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,this._dualStreamMode=VN.DISABLE_SIMULCAST_STREM,this._joinInfo&&this._gateway.setDualStreamMode(this._dualStreamMode,!0,!0).catch(e=>{nk.debug("[".concat(this._clientId,"] try to inform gateway to set dual stream mode to ").concat(this._dualStreamMode," ,but failed"),e.toString())}),dk.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),nk.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(e){fN(e,"role",["audience","host"])}(e),t&&BN(t),"rtc"===this.mode||"p2p"===this.mode)throw nk.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new uk(hN.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&"host"===e)throw new uk(hN.INVALID_OPERATION,"host mode can not set audience latency level");if("audience"===e&&this._p2pChannel.hasLocalMedia())throw new uk(hN.INVALID_OPERATION,"can not set client role to audience when publishing stream");const n=this._config.role;if(this._joinInfo&&(this._joinInfo.role=e),e!==n&&SP("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(e,t),this._config.role=e,this._gateway.reconnect("recover",GN.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(e,t),this._config.role=e),nk.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level)),"audience"===n&&"audience"!==e&&this._pendingRtpCapabilityChange&&this._p2pChannel instanceof fW){const{video_codec:e}=this._pendingRtpCapabilityChange;this._p2pChannel.updateRemoteRTPCapabilities(e.map(e=>e.toLowerCase()).filter(e=>{var t;return xr(t=Object.keys(RP)).call(t,e)}))}}async _setClientRoleOptions(e){if("rtc"===this.mode||"p2p"===this.mode)return;if("audience"!==this._config.role||this._p2pChannel.hasLocalMedia())return;let t=!1;try{e&&BN(e),await this._gateway.setClientRole(this._config.role,e),t=!0}catch(e){}finally{nk.info("[".concat(this._clientId,"] set client role options ").concat(t?"succeed":"failed",", options is ").concat(e))}}getRemoteInboundOffset(){var e;const t=null===(e=this._p2pChannel.getStats())||void 0===e?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const n=t.timestamp-Date.now();return Math.abs(n)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?n:0}getNtpWallTimeInMs(){return"visible"===document.visibilityState&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(vN(e,"proxyServer"),!t){if("DISCONNECTED"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new uk(hN.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,dk.setProxyServer(this._proxyServer),nk.setProxyServer(this._proxyServer),nk.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if("DISCONNECTED"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new uk(hN.INVALID_OPERATION,"You have already set the proxy")}if(FN(e))return this._turnServer={servers:e,mode:"original-manual"},void nk.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map(e=>e.urls).join(","),"."));e.forEach(e=>jN(e)),this._turnServer={servers:e,mode:"manual"},nk.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if("DISCONNECTED"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"you should set license before join channel");if(vN(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new uk(hN.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,nk.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if("DISCONNECTED"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint)throw new uk(hN.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let n;switch(void 0===e&&(e=3),e){case 1:case 2:throw new uk(hN.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:n="proxy3";break;case 4:n="proxy4";break;case 5:n="proxy5";break;default:throw new uk(hN.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=n,this.store.cloudProxyServerMode=n,nk.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if("DISCONNECTED"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"Stop proxy server after leave channel");dk.setProxyServer(),nk.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",nk.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new uk(hN.INVALID_PARAMS,"accessPoints is required.");bN(e.accessPoints.serverList,"accessPoints.serverList"),vN(e.accessPoints.domain,"accessPoints.domain");const t=(e,t)=>{gN(e,t,0,65535,!0)};let n=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),n=e.accessPoints.port),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new uk(hN.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");SP("CLOSE_AFB_FOR_LOCAL_AP")&&(yP("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),yP("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const r=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,i=e.accessPoints.domain,o=e.accessPoints.serverList.map(e=>r.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(i):e),a=o.map(e=>"".concat(e,":").concat(n));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,yP("WEBCS_DOMAIN",a),yP("WEBCS_DOMAIN_BACKUP_LIST",a),yP("GATEWAY_DOMAINS",[i]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(bN(e.report.hostname,"report.hostname"),yP("EVENT_REPORT_DOMAIN",e.report.hostname[0]),yP("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(yP("EVENT_REPORT_DOMAIN",o[0]),yP("EVENT_REPORT_BACKUP_DOMAIN",o[1]||o[0]));let s=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),s=e.report.port),yP("STATS_COLLECTOR_PORT",s),e.report?yP("ENABLE_EVENT_REPORT",!0):yP("ENABLE_EVENT_REPORT",!1);let c="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(bN(e.log.hostname,"log.hostname"),c=e.log.hostname[0]):c=o[0];let l=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),l=e.log.port),yP("LOG_UPLOAD_SERVER","".concat(c,":").concat(l));let d=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(bN(e.cds.hostname,"cds.hostname"),d=e.cds.hostname):d=o;let u=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),u=e.cds.port),yP("CDS_AP",d.map(e=>"".concat(e,":").concat(u))),e.cds?yP("ENABLE_CONFIG_DISTRIBUTE",!0):yP("ENABLE_CONFIG_DISTRIBUTE",!1),nk.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(bN(e,"serverList"),vN(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new uk(hN.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(e=>n.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(t):e),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,yP("WEBCS_DOMAIN",e),yP("WEBCS_DOMAIN_BACKUP_LIST",e),yP("GATEWAY_DOMAINS",[t]),yP("EVENT_REPORT_DOMAIN",e[0]),yP("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),yP("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),nk.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(fN(e,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(e){throw nk.error("[".concat(this._clientId,"] set default remote video stream type error"),e.toString()),e}else nk.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){fN(t,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout(()=>{const t=this._users.find(t=>t.uid===e);t&&t.videoTrack&&t.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(e){throw nk.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),e}nk.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){fN(t,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw nk.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),e}nk.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,n,r){!function(e){fN(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),vN(t,"secret");const i=["aes-128-gcm2","aes-256-gcm2"];if(xr(i).call(i,e)){if(!n||!(n instanceof Uint8Array&&32===n.length))throw new uk(hN.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(n)throw new uk(hN.INVALID_PARAMS,"current encrypt mode does not need salt");if(r){if(mN(r,"encryptDataStream"),!xr(i).call(i,e))throw new uk(hN.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||nk.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,n&&(this._encryptionSalt=uO(n))}async renewToken(e){if(vN(e,"token",1,2047),!this._key||!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"renewToken should not be called before user join");const t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const n=await this._renewTokenMutex.lock();try{if(SP("USE_NEW_TOKEN")){nk.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const t=await XV(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||xO);nk.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:t})}else nk.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});nk.debug("[".concat(this._clientId,"] renewToken success"))}catch(e){throw this._key=t,this._joinInfo.token=t,nk.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),e}finally{n()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?nk.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(WN.VOLUME_INDICATOR,e)},SP("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if("h264"!==this.codec)throw new uk(hN.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new uk(hN.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new uk(hN.LIVE_STREAMING_TASK_CONFLICT);const n=t?KU.TRANSCODE:KU.RAW;return this._createLiveStreamingClient(n).startLiveStreamingTask(e,n)}setLiveTranscoding(e){return this._createLiveStreamingClient(KU.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(t=>t&&t.hasUrl(e));if(!t.length)throw new uk(hN.INVALID_PARAMS,"can not find live streaming url to stop");await ip.all(t.map(t=>t&&t.stopLiveStreamingTask(e)))}async startChannelMediaRelay(e){aB(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}async updateChannelMediaRelay(e){aB(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}async stopChannelMediaRelay(){const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(e){this._p2pChannel instanceof fW&&this._p2pChannel.addAudioMetadata(e)}async sendStreamMessage(e){var t;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"can not send data stream, not joined");if(("string"==typeof e||e instanceof Uint8Array)&&(e={payload:e}),"string"==typeof e.payload){const t=new TextEncoder;e.payload=t.encode(e.payload)}let r=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&xr(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)&&(r=!0,e.payload=await async function(e,t,n){var r;const i=ii(r=Array.from(n)).call(r,(e,t)=>e+t,0),o={serverTs:0,seq:PP++,length:n.length,checkSum:i},a=new Uint8Array(wO(i,2)),s=new ArrayBuffer(OP),c=new DataView(s);c.setUint32(0,o.serverTs),c.setUint16(4,o.seq),c.setUint16(6,o.length),c.setUint16(8,o.checkSum);const l=16-n.length%16;n=pO(n,new Uint8Array(l));const d=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:e,tagLength:AP,additionalData:a},t,n);return pO(new Uint8Array(s),new Uint8Array(d))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new uk(hN.INVALID_PARAMS,r?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(jU.DATA_STREAM,{payload:uO(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-bW},!n)}sendMetadata(e){if(!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new uk(hN.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(jU.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:uO(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(ik),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"can not send custom report, not joined");await dk.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){const e=this._statsCollector.getRemoteNetworkQualityStats();if(SP("DELETE_NEQ_AFTER_USER_LEAVE")){const t=this._users.map(e=>e.uid+"");Object.keys(e).forEach(n=>{xr(t).call(t,n)||delete e[n]})}return e}getNetworkQuality(){return this._statsCollector.getNetworkQuality()}async pickSVCLayer(e,t){fN(t.spatialLayer,"spatialLayer",[0,1,2,3]),fN(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw nk.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),e}}async setRTMConfig(e){const{apRTM:t=!1,rtmFlag:n}=e;if(mN(t,"apRTM"),gN(n,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=n,nk.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState)&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=n,this._gateway.setRTM2Flag(n)}_reset(){if(nk.debug("[".concat(this._clientId,"] reset client")),function(e){const t=KM.indexOf(e);-1!==t&&KM.splice(t,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this.store.autoSubscribe=!1,this._pendingRtpCapabilityChange=void 0,this._axiosCancelSource.cancel(),this._axiosCancelSource=EI.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&YW(this._joinInfo),this._rteDetailInterval&&(window.clearInterval(this._rteDetailInterval),this._rteDetailInterval=void 0,this._sessionId&&dk.reportRteDetail(this._sessionId)),this._fallbackServerInfo=void 0,this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&dk.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this.store.resetFirstVideoFrameDecoded(),this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(e=>e._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new kO("client-publish",this._clientId),this._subscribeMutex=new kO("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch(e){}if(this._moderation)try{this.setImageModeration(!1)}catch(e){}}_startSession(e,t){var n;const r=e||bO();e?nk.debug("[".concat(this._clientId,"] new Session ").concat(r)):nk.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(r));const i=e?"":this._sessionId||"";this._sessionId=r,this.store.sessionId=r,dk.addSid(r);const o={lts:(new Date).getTime(),mode:this.mode,buildFormat:1,stringUid:(null==t?void 0:t.stringUid)||(null===(n=this._joinInfo)||void 0===n?void 0:n.stringUid),channelProfile:"live"===this.mode?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:i,clientRole:"audience"===this.role?2:1,rteUrl:this.store.rteUrl,rteSid:this.store.rteSid};dk.sessionInit(this._sessionId,TG({cname:t.channel,appid:t.appId},o)),this._joinInfo&&(this._joinInfo.sid=r),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=r)}async _publishHighStream(e){if(!this._joinInfo||void 0===this._uid)throw new uk(hN.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&SP("FORCE_TURN")&&!SP("TURN_ENABLE_TCP")&&!SP("TURN_ENABLE_UDP"))throw new uk(hN.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");nk.debug("[".concat(this._clientId,"] publish high stream"));try{const n=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const t=(await n.next()).value;if(t){try{await this._gateway.sendExtensionMessage(DF.PUBLISH,t,!0)}catch(e){throw n.throw(e),e}await n.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const r=(await n.next()).value;if(r){var t;let i;try{i=await this._gateway.publish(this._uid,r,!0)}catch(e){if(e.code!==hN.DISCONNECT_P2P)throw n.throw(e),e}await n.next((null===(t=i)||void 0===t?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const t of e)t instanceof xL&&t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig).catch(e=>{nk.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!t.muted&&t.enabled||await this._p2pChannel.muteLocalTrack(t)}}catch(t){if(this._p2pChannel.reportPublishEvent(!1,null==t?void 0:t.code,e),(null==t?void 0:t.code)===hN.WS_ABORT)return;throw t}}async _publishLowStream(){if(!this._joinInfo||void 0===this._uid)throw new uk(hN.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));nk.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const e=await this._p2pChannel.publishLowStream(this._lowStreamParameter),n=(await e.next()).value;if(n){var t;let r;try{r=await this._gateway.publish(this._uid,n,!0)}catch(t){if(t.code!==hN.DISCONNECT_P2P)throw e.throw(t),t}e.next((null===(t=r)||void 0===t?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(e){if(this._p2pChannel.reportPublishEvent(!1,null==e?void 0:e.code,void 0,!0),(null==e?void 0:e.code)===hN.WS_ABORT)return;throw e}}_createLiveStreamingClient(e){const t=()=>{if(!this._joinInfo||!this._appId)return new uk(hN.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const e=(t={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},oV("LiveStreaming").create(t));var t;return e.onLiveStreamError=(e,t)=>{dk.reportApiInvoke(this._sessionId,{name:DN.ON_LIVE_STREAM_ERROR,options:[e,t],tag:xN.TRACER}).onSuccess(),this.safeEmit(WN.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{dk.reportApiInvoke(this._sessionId,{name:DN.ON_LIVE_STREAM_WARNING,options:[e,t],tag:xN.TRACER}).onSuccess(),this.safeEmit(WN.LIVE_STREAMING_WARNING,e,t)},e.on(QU.REQUEST_WORKER_MANAGER_LIST,(e,t,n)=>{if(!this._joinInfo)return n(new uk(hN.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(e,t,n,r){const i=SP("UAP_AP").slice(0,SP("AJAX_REQUEST_CONCURRENT")).map(e=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap"));return await AV(i,e,t,n,r)})(e,this._joinInfo,this._axiosCancelSource.token,xO).then(t).catch(n)}),e};return e===KU.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new uk(hN.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:n}=this.getLocalVideoStats(),r=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:n}},oV("ChannelMediaRelay").create(e));r.on("state",e=>{e===rF.RELAY_STATE_FAILURE&&r&&r.dispose(),this.safeEmit(WN.CHANNEL_MEDIA_RELAY_STATE,e)}),r.on("event",e=>{this.safeEmit(WN.CHANNEL_MEDIA_RELAY_EVENT,e)}),this._channelMediaRelayClient=r,this._statsCollector.onStatsChanged=(e,t)=>{var n;"resolution"===e&&(null===(n=this._channelMediaRelayClient)||void 0===n||n.setVideoProfile(t))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:n,deleted:r}=e,i=[];if(t){const e=[];this._users.forEach(t=>{t._dataChannels.forEach(r=>{n.every(e=>e.uid!==t._uintid||e.stream_id!==r.id)&&e.push({uid:t._uintid,stream_id:r.id,ordered:r.ordered,max_retrans_times:r.maxRetransmits,metadata:r.metadata})})}),e.length>0&&this._handleUpdateDataChannel({added:[],deleted:e})}Array.isArray(n)&&n.length>0&&n.forEach(e=>{const{uid:n,stream_id:r,ordered:o,max_retrans_times:a,metadata:s}=e,c=this._users.find(e=>e._uintid===n);if(c){if(nk.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(n)),xr(i).call(i,c)||i.push(c),c._uintid||(c._uintid=n),-1===c._dataChannels.findIndex(t=>t.id===e.stream_id)){const e={id:r,ordered:!!o,maxRetransmits:a,metadata:s},n=function(e){return aV(e,!0)}(e);c._dataChannels.push(n),nk.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published datachannel")),t||this.safeEmit(WN.USER_PUBLISHED,c,"datachannel",e)}this._p2pChannel.hasPendingRemoteDataChannel(c,e.stream_id)&&(nk.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(c.uid," after reconnect.")),this._subscribeDataChannel(c,e.stream_id).catch(e=>{nk.error("[".concat(this._clientId,"] resubscribe datachannel error"),e.toString())}))}else nk.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"))}),t&&(this.safeEmit(WN.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(r)&&r.length>0&&r.forEach(e=>{const{uid:t,stream_id:n}=e,r=this._users.find(e=>e._uintid===t);if(!r)return void nk.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const i=r._dataChannels.find(t=>t.id===e.stream_id);i&&(nk.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(t)),this._p2pChannel.unsubscribeDataChannel(r,[i]).then(e=>{if(r._dataChannels=r._dataChannels.filter(e=>e!==i),e)return this._gateway.unsubscribeDataChannel(e,r.uid)}),nk.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished datachannel ,id:").concat(i.id)),this.safeEmit(WN.USER_UNPUBLISHED,r,"datachannel",i._config))})}_getEncodingName(e){var t,n;if(!this._joinResponse)return;const r=null===(t=this._joinResponse.ortc.rtpCapabilities.sendrecv)||void 0===t?void 0:t.videoCodecs;if(!r)return;for(const s of r){var i;if(s.payloadType===e)return null==s||null===(i=s.rtpMap)||void 0===i?void 0:i.encodingName}const o=null===(n=this._joinResponse.ortc.rtpCapabilities.recv)||void 0===n?void 0:n.videoCodecs;if(o)for(const s of o){var a;if(s.payloadType===e)return null==s||null===(a=s.rtpMap)||void 0===a?void 0:a.encodingName}return 0===e?"unknown":void 0}_handleRemoveDataChannels(e){const t=this._users.find(t=>t.uid===e.uid);if(t){if(void 0!==t._dataChannels&&t._dataChannels.length>0){nk.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const n=()=>{nk.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach(e=>{this.safeEmit(WN.USER_UNPUBLISHED,t,"datachannel",e._config)})};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then(e=>{if(e)return this._gateway.unsubscribeDataChannel(e,t.uid)}),n()}}else nk.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(aF.UPDATE_GATEWAY_CONFIG,()=>{!function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void nk.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();Object.keys(t).forEach(e=>{const{value:r,type:i,expires:o}=t[e];o&&o<=n||i||qM()||!Object.prototype.hasOwnProperty.call(gP,e)||(CP[e]=r,EP[e]=r,nk.debug("Update gateway parameters from config distribute",e,r))})}catch(e){nk.error("Error update config from local cache",e.message)}}()}),this._gateway.on(aF.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(aF.CONNECTION_STATE_CHANGE,(e,t,n)=>{var r;if(n===UN.FALLBACK)return;const i=()=>{this.safeEmit(WN.CONNECTION_STATE_CHANGE,e,t,n)};if(dk.reportApiInvoke(this._sessionId||(null===(r=this._gateway.joinInfo)||void 0===r?void 0:r.sid)||null,{name:DN.CONNECTION_STATE_CHANGE,options:[e,t,n],tag:xN.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:n})),nk.info("[".concat(this._clientId,"] signal connection state change: ").concat(t," -> ").concat(e)),"DISCONNECTED"===e)return this._reset(),void i();if("RECONNECTING"===e)this._users.forEach(e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_audio_stream_added_state_=!1,e._trust_video_stream_added_state_=!1,e._is_pre_created||(e._audio_pre_subscribed||(e._audioSSRC=void 0,e._audioOrtc=void 0),e._video_pre_subscribed||(e._videoSSRC=void 0,e._videoOrtc=void 0,e._rtxSsrcId=void 0),e._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var o;this._streamFallbackTypeCacheMap.forEach((e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch(e=>{nk.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e)})}),this._remoteStreamTypeCacheMap.forEach((e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch(e=>{nk.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e)})}),SP("VOS_CONFIGURE")&&Array.isArray(SP("VOS_CONFIGURE"))&&SP("VOS_CONFIGURE").length>0&&(this._gateway.setConfigure(SP("VOS_CONFIGURE")).catch(e=>{nk.debug("[".concat(this._clientId,"] auto set vos config failed"),e)}),nk.debug("[".concat(this._clientId,"] ws connected auto set vos config"))),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(o=this._joinInfo)||void 0===o?void 0:o.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{nk.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(e=>{nk.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(e))}),this._dualStreamMode&&this._gateway.setDualStreamMode(this._dualStreamMode).catch(e=>{nk.warning("[".concat(this._clientId,"] auto set dual stream mode failed"),e)}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter(e=>!e._trust_in_room_).forEach(e=>{nk.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(e.uid)),this._handleUserOffline({uid:e.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach(e=>{e._trust_audio_mute_state_||(nk.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,_F.AUDIO,!1)),e._trust_video_mute_state_||(nk.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,_F.VIDEO,!1)),e._trust_audio_enabled_state_||(nk.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),e._trust_video_enabled_state_||(nk.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_video_stream_added_state_||(nk.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(e.uid)),this._handleResetAddStream(e,"video")),e._trust_audio_stream_added_state_||(nk.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(e.uid)),this._handleResetAddStream(e,"audio")),e._video_added_||e._audio_added_||(nk.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))}))},1e3))}i()}),this._gateway.on(aF.REQUEST_NEW_GATEWAY_LIST,async(e,t)=>{if(!this._joinInfo)return t(new uk(hN.UNEXPECTED_ERROR,"can not recover, no join info"));try{let t;if(this._fallbackServerInfo)t=this._fallbackServerInfo,this._fallbackServerInfo=void 0,this._joinInfo.preload=!1,dk.reportApiInvoke(this._sessionId,{name:DN.VOS_FALLBACK_CN,options:{cur:t.gatewayInfo.gatewayAddrs,prev:this._joinInfo.gatewayAddrs,is_done:!0},tag:xN.TRACER}).onSuccess(),nk.info("[".concat(this._clientId,"] use fallback cn server info"));else{const e=await HW(TG(TG({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));e?(t=e.ap,qW(e),this._joinInfo.preload=!0):(t=await BV(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||xO,this.store),this._joinInfo.preload=!1)}this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res,this._joinInfo.gatewayAddrs=t.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=t.gatewayInfo.uni_lbs_ip);const n=[];t.gatewayInfo.gatewayAddrs.forEach(e=>{let{address:t}=e;const[r,i]=t.split(":");this._joinInfo&&this._joinInfo.proxyServer?n.push({proxy:this._joinInfo.proxyServer,host:r,port:i}):n.push({host:r,port:i})}),e(n)}catch(e){t(e)}}),this._gateway.on(aF.NETWORK_QUALITY,e=>{"normal"===this._networkQualitySensitivity&&this.safeEmit(WN.NETWORK_QUALITY,e)}),this._gateway.on(aF.STREAM_TYPE_CHANGE,(e,t)=>{this.safeEmit(WN.STREAM_TYPE_CHANGED,e,t),dk.reportApiInvoke(this._sessionId,{name:DN.STREAM_TYPE_CHANGE,options:[e,t],tag:xN.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))}),this._gateway.isPreSub=()=>"isPreSub"in this._p2pChannel&&this._p2pChannel.isPreSub(),this._gateway.isPreallocation=()=>"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation(),this._gateway.on(aF.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(aF.REQUEST_P2P_CONNECTION_PARAMS,async(e,t,n)=>{try{let n=await this._p2pChannel.getEstablishParams();n&&"isPreallocation"in this._p2pChannel&&this._p2pChannel.isPreallocation()||(n=await this._p2pChannel.startP2PConnection(e)),t(n)}catch(e){n(e)}}),this._gateway.on(aF.JOIN_RESPONSE,(e,t)=>{if(this.store.useP2P)return;let n;this._joinResponse=e,e.attributes?n=e.attributes.userAttributes.preSubSsrcs:nk.debug("no attributes in joinResponse");const r=Pj(e.ortc,t,n);this._p2pChannel.connect(r)}),this._gateway.on(aF.PRE_CONNECT_PC,async(e,t,n)=>{const{candidates:r,fingerprint:i,turnServer:o}=e;if(this._joinInfo&&r.length>0&&!this._p2pChannel.isPlanB){const{cert:s,cid:c}=this._joinInfo.apResponse,l="".concat(c,"_").concat(s);if(l.length<4||l.length>256)return void nk.debug("[".concat(this._clientId,"] ufrag length is not valid, length: ").concat(l.length));await this._p2pChannel.startP2PConnection({turnServer:o,cloudProxyServer:this._joinInfo.cloudProxyServer,isPreallocation:!0});try{var a;t(await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(c,"_").concat(s),icePwd:"".concat(c,"_").concat(s)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:null!==(a=SP("FINGERPRINT"))&&void 0!==a?a:i}]},candidates:r,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0}))}catch(e){e.code&&e.code===hN.EXCHANGE_SDP_FAILED&&await this._p2pChannel.startP2PConnection({turnServer:o,cloudProxyServer:this._joinInfo.cloudProxyServer},!0),n(e)}}}),this._gateway.on(aF.VOS_FALLBACK,e=>{"fallback_hls"===e&&this.safeEmit(WN.FALLBACK_TO_HLS,HN.VOSERROR)}),this._gateway.on(aF.RESET_SIGNAL,()=>{this._p2pChannel instanceof fW&&this._p2pChannel.fallbackConnection(),this._handleGatewaySignalEvents()}),this._gateway.on(aF.DATACHANNEL_FAILBACK,()=>{dk.reportApiInvoke(this._sessionId,{name:DN.DATACHANNEL_FAILBACK,options:{},tag:xN.TRACER}).onSuccess(),this._joinGateway()})}_handleGatewaySignalEvents(){this._gateway.signal.on(BU.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(BU.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(BU.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.pt,e.uint_id,e.ortc)),this._gateway.signal.on(BU.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.pt,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(BU.ON_REMOTE_DATASTREAM_UPDATE,e=>{this._handleUpdateDataChannel(e)}),this._gateway.signal.on(BU.ON_REMOTE_FULL_DATASTREAM_INFO,e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(BU.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(BU.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(BU.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,_F.AUDIO,!0)),this._gateway.signal.on(BU.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,_F.AUDIO,!1)),this._gateway.signal.on(BU.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,_F.VIDEO,!0)),this._gateway.signal.on(BU.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,_F.VIDEO,!1)),this._gateway.signal.on(BU.RECEIVE_METADATA,e=>{const t=dO(e.metadata);this.safeEmit(WN.RECEIVE_METADATA,e.uid,t)}),this._gateway.signal.on(BU.ON_DATA_STREAM,async e=>{var t;if(!e)return;let n=dO(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&xr(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)){if(e.payload.length<OP)throw new uk(hN.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(OP));const t=await async function(e,t,n){const r=n.subarray(0,OP),i=r.slice(8,OP),o=(i[0]<<8)+i[1],a=(r[6]<<8)+r[7],s=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:e,tagLength:AP,additionalData:new Uint8Array(wO(o,2))},t,n.subarray(OP));return new Uint8Array(s).subarray(0,a)}(this._encryptDataStreamIv,this._encryptDataStreamKey,n);n=t}let r=0;if(e.ordered||e.syncWithAudio){const t=this._p2pChannel.getStats(),n=this.remoteUsers.find(t=>t.uid===e.uid),i=null==t?void 0:t.audioRecv.find(e=>e.ssrc===(null==n?void 0:n._audioSSRC));r=null==i?void 0:i.jitterBufferMs}(null==r||Number.isNaN(r))&&(r=0),wW(TG(TG({},e),{},{payload:n}),r,{id:this._clientId,onStreamMessage:"function"==typeof this.onStreamMessage?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(BU.ON_CRYPT_ERROR,()=>{lO(()=>{nk.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(WN.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(BU.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(BU.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{nk.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,UN.TOKEN_EXPIRE),this.safeEmit(WN.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(BU.ON_STREAM_FALLBACK_UPDATE,e=>{nk.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(WN.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")}),this._gateway.signal.on(BU.ENABLE_MULTI_STREAM,e=>{this._dualStreamMode===VN.AUTO_SIMULCAST_STREAM&&this.enableDualStream().catch(e=>{nk.debug("[".concat(this._clientId,"] set dual stream mode error"),e.toString())})}),this._gateway.signal.on(BU.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),nk.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))}),this._gateway.signal.on(BU.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(BU.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(FU.REQUEST_TIMEOUT,(e,t)=>{if(this._joinInfo)switch(e){case jU.PUBLISH:{if(!t)return;const e=t.ortc;if(e){var n,r;const i=e.some(e=>{let{stream_type:t}=e;return t===oF.Audio}),o=e.some(e=>{let{stream_type:t}=e;return t!==oF.Audio}),a=e.some(e=>{let{stream_type:t}=e;return t===oF.Screen||t===oF.ScreenLow});"offer"===t.state&&dk.publish(this._joinInfo.sid,{eventElapse:tB.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:hN.TIMEOUT,audio:i,video:o,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:a,audioName:i?null===(n=e.find(e=>{let{stream_type:t}=e;return t===oF.Audio}))||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId.toString():void 0,videoName:o?null===(r=e.find(e=>{let{stream_type:t}=e;return t!==oF.Audio}))||void 0===r||null===(r=r.ssrcs[0])||void 0===r?void 0:r.ssrcId.toString():void 0})}break}case jU.SUBSCRIBE:t&&dk.subscribe(this._joinInfo.sid,{succ:!1,ec:hN.TIMEOUT,audio:t.stream_type===_F.AUDIO,video:t.stream_type===_F.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:tB.measureFromSubscribeStart(this.store.clientId,t.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(t.ssrcId)})}}),this._gateway.signal.on(BU.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(BU.ON_PUBLISHED_USER_LIST,e=>{if(null==e||!e.users)return;SP("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter(e=>!YM(e.string_id||e.stream_id,this.channelName)));const t=[],n=[];for(const r of e.users){let e=this._users.find(e=>e._uintid===r.stream_id);e?e._trust_in_room_=!0:(e=new sB(r.string_id||r.stream_id,r.stream_id),this._users.push(e),this.store.firstVideoFrameDecoded(e.uid,{userJoinNotify:Date.now()}),0===this.getListeners(WN.PUBLISHED_USER_LIST).length&&(nk.debug("[".concat(this._clientId,"] user online"),r.stream_id),this.safeEmit(WN.USER_JOINED,e)));const i=cF.Audio&r.stream_type,o=(cF.Video|cF.LwoVideo)&r.stream_type,a=0!=(65280&r.stream_type),s=i&&e.hasAudio,c=o&&e.hasVideo;o&&(e._trust_video_stream_added_state_=!0,e._video_added_=!0,e._videoSSRC=r.video_ssrc,e._rtxSsrcId=r.video_rtx),i&&(e._trust_audio_stream_added_state_=!0,e._audio_added_=!0,e._audioSSRC=r.audio_ssrc),i&&!s&&0===this.getListeners(WN.PUBLISHED_USER_LIST).length&&(nk.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published audio")),this.safeEmit(WN.USER_PUBLISHED,e,"audio")),o&&!c&&0===this.getListeners(WN.PUBLISHED_USER_LIST).length&&(nk.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published video")),this.safeEmit(WN.USER_PUBLISHED,e,"video")),(i&&!s||o&&!c||a)&&t.push(e),o&&this._p2pChannel.hasPendingRemoteMedia(e,"video")&&n.push({user:e,mediaType:"video"}),i&&this._p2pChannel.hasPendingRemoteMedia(e,"audio")&&n.push({user:e,mediaType:"audio"})}n.length>0&&(nk.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(n.map(e=>"user: ".concat(e.user.uid,", mediaType: ").concat(e.mediaType)).join("; ")," ")),this.massSubscribe(n).catch(e=>{nk.error("[".concat(this._clientId,"] mass resubscribe error"),e.toString())})),this.getListeners(WN.PUBLISHED_USER_LIST).length>0?SP("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(nk.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map(e=>e.uid).join(", "))),this.safeEmit(WN.PUBLISHED_USER_LIST,t)):nk.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map(e=>e.uid).join(", ")))}),this._gateway.signal.on(BU.ON_RTP_CAPABILITY_CHANGE,e=>{const{video_codec:t}=e;if(this._p2pChannel instanceof fW){if("audience"===this.role&&SP("UPDATE_RTP_CAP_IN_HOST"))return this._pendingRtpCapabilityChange=e,void nk.debug("[".concat(this._clientId,"] no need to change rtp capability because of audience, params: ").concat(JSON.stringify(e)));this._p2pChannel.updateRemoteRTPCapabilities(t.map(e=>e.toLowerCase()).filter(e=>{var t;return xr(t=Object.keys(RP)).call(t,e)}))}}),this._gateway.signal.on(FU.VOS_FALLBACK_PROMISE,async(e,t,n)=>{if("FALLBACKCN"===e&&SP("ENABLE_QUALITY_FALLBACK")){if(!this._joinInfo)return n(new uk(hN.UNEXPECTED_ERROR,"can not recover, no join info"));nk.info("[".concat(this._clientId,"] try fallback to cn, start request new server info"));const i=this._joinInfo.apRequestDetail;try{this._joinInfo.apRequestDetail=e;const r=await BV(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||xO,this.store);if(SP("QUALITY_FALLBACK_REHEARSAL"))return dk.reportApiInvoke(this._sessionId,{name:DN.VOS_FALLBACK_CN,options:{cur:r.gatewayInfo.gatewayAddrs,prev:this._joinInfo.gatewayAddrs,is_done:!1},tag:xN.TRACER}).onSuccess(),this._joinInfo.apRequestDetail=i,void n();this._fallbackServerInfo=r,t()}catch(e){var r;const t=null==e||null===(r=e.data)||void 0===r?void 0:r.desc;SP("QUALITY_FALLBACK_REHEARSAL")?(dk.reportApiInvoke(this._sessionId,{name:DN.VOS_FALLBACK_CN,options:{cur:"failed, errorReason: "+t||0,prev:this._joinInfo.gatewayAddrs,is_done:!1},tag:xN.TRACER}).onSuccess(),this._joinInfo.apRequestDetail=i):Array.isArray(t)&&xr(t).call(t,"request downgrade fallback")&&this.safeEmit(WN.FALLBACK_TO_HLS,HN.AP_ERROR),n(e)}}else n()})}_handleP2PEvents(){this._gateway.signal.on(BU.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(DF.PUBLISH,(e,t,n)=>{const{uid:r}=e;e.forEach(e=>{const{kind:i,ssrcs:o,mid:a,isMuted:s}=e;this._handleP2PAddAudioOrVideoStream(i,r,o[0].ssrcId,a);const c=this._users.find(e=>e.uid===r);return c&&this.store.useP2P?this._p2pChannel.mockSubscribe(c,i,o[0].ssrcId,a).then(()=>{t()}).catch(n):t(),this._handleMuteStream(r,i,!!s)})}),this._gateway.signal.on(DF.CALL,async(e,t,n)=>{if(this.store.useP2P)try{var r;t(await this._p2pChannel.startP2P({turnServer:null===(r=this._joinInfo)||void 0===r?void 0:r.turnServer},e))}catch(e){n(e)}}),this._gateway.signal.on(FU.P2P_CONNECTION,async e=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(e)}),this._gateway.signal.on(DF.UNPUBLISH,async(e,t,n)=>{if(this.store.useP2P){const{unpubMsg:r,uid:i}=e,o=this._users.find(e=>e.uid===i);if(!o)return nk.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(i)),void t();try{r.forEach(async e=>{let{stream_type:t}=e;const n=t===oF.Audio?_F.AUDIO:_F.VIDEO;await this._p2pChannel.unsubscribe(o,n),this._handleMuteStream(i,n,!0)}),t()}catch(e){n(e)}}}),this._gateway.signal.on(DF.CONTROL,async(e,t)=>{const{action:n}=e;switch(n){case LF.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,_F.VIDEO,!0);break;case LF.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,_F.AUDIO,!0);break;case LF.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,_F.VIDEO,!1);break;case LF.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,_F.AUDIO,!1)}}),this._gateway.signal.on(DF.RESTART_ICE,async(e,t,n)=>{if(this.store.useP2P)try{const{direction:n,iceParameter:r}=e;n!==WU.SEND_ONLY||r?t(await this._p2pChannel.restartICE(n,r)):(this._p2pChannel.handleDisconnect(n),t())}catch(e){n(e)}}),this._gateway.signal.on(DF.CANDIDATE,e=>{if(this.store.useP2P){const{candidate:t,direction:n}=e;this._p2pChannel.addRemoteCandidate(t,n)}}),this._p2pChannel.on(TF.RequestP2PRestartICE,async(e,t,n)=>{try{const{direction:n}=e;t(await this._gateway.sendExtensionMessage(DF.RESTART_ICE,e,n===WU.SEND_ONLY))}catch(e){n(e)}}),this._p2pChannel.on(TF.LocalCandidate,e=>{this._gateway.sendExtensionMessage(DF.CANDIDATE,JSON.stringify(e),!0)}),this._p2pChannel.on(TF.RequestP2PMuteLocal,async(e,t,n)=>{try{await this._gateway.sendExtensionMessage(DF.CONTROL,e,!0),t()}catch(e){n(e)}}),this._p2pChannel.on(TF.RequestP2PUnmuteRemote,async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===hN.DISCONNECT_P2P?t():n(e)}else t()}),this._p2pChannel.on(TF.RequestP2PMuteRemote,async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===hN.DISCONNECT_P2P?t():n(e)}else t()}),this._p2pChannel.on(TF.StateChange,(e,t)=>{t===SF.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(TF.PeerConnectionStateChange,e=>{const t=this._peerConnectionState;e!==t&&(this.safeEmit(WN.PEERCONNECTION_STATE_CHANGE,e,t),this._peerConnectionState=e)}),this._p2pChannel.on(TF.RequestMuteLocal,async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===hN.DISCONNECT_P2P?t():n(e)}else t()}),this._p2pChannel.on(TF.RequestUnmuteLocal,async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===hN.DISCONNECT_P2P?t():n(e)}else t()}),this._p2pChannel.on(TF.RequestRePublish,(e,t,n)=>{this.publish(e,!1).then(t).catch(n)}),this._p2pChannel.on(TF.RequestRePublishDataChannel,(e,t,n)=>{ip.all(e.map(async e=>{const t=await this._p2pChannel.publishDataChannel([e]);try{t.forEach(e=>{this._uid&&this._gateway.publishDataChannel(this._uid,e,!0)})}catch(e){if(e.code!==hN.DISCONNECT_P2P)throw e}})).then(t).catch(n)}),this._p2pChannel.on(TF.RequestReSubscribe,async(e,t,n)=>{try{for(const{user:t,kind:n}of e)n===_F.VIDEO?await this.subscribe(t,"video"):await this.subscribe(t,"audio");t()}catch(e){n(e)}}),this._p2pChannel.on(TF.RequestUpload,(e,t)=>{this._gateway.upload(e,t)}),this._p2pChannel.on(TF.RequestUploadStats,e=>{this._gateway.uploadWRTCStats(e)}),this._p2pChannel.on(TF.MediaReconnectStart,e=>{this.safeEmit(WN.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(TF.MediaReconnectEnd,e=>{this.safeEmit(WN.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(TF.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(TF.RequestRestartICE,async e=>{if(this.store.useP2P)return;const t=await this._p2pChannel.restartICE(e),n=await t.next();if(n.done)return;const r=n.value;let i;try{i=await this._gateway.restartICE({iceParameters:r})}catch(e){return void t.throw(e)}const{iceParameters:o}=function(e){const t=e.iceParameters;return{iceParameters:{iceUfrag:t.iceUfrag,icePwd:t.icePwd}}}(i);await t.next({remoteIceParameters:o})}),this._p2pChannel.on(TF.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(TF.RequestReconnectPC,async()=>{var e;const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=await this._p2pChannel.startP2PConnection({turnServer:null===(e=this._joinInfo)||void 0===e?void 0:e.turnServer}),{gatewayEstablishParams:i,gatewayAddress:o}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:n,rtpCapabilities:r}),a=Pj(i,o);await this._p2pChannel.connect(a),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(TF.RequestUnpublishForReconnectPC,async(e,t,n)=>{this._joinInfo&&void 0!==this._uid?(await this._gateway.unpublish(e,this._uid),t()):n()}),this._p2pChannel.on(TF.P2PLost,()=>{this.safeEmit(WN.P2P_LOST,this.store.uid)}),this._p2pChannel.on(TF.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(TF.ConnectionTypeChange,e=>{this.safeEmit(WN.IS_USING_CLOUD_PROXY,e),this._gateway.setUsingProxy(e)}),this._p2pChannel.on(TF.FirstVideoBufferReady,(e,t)=>{this.safeEmit(WN.FIRST_VIDEO_BUFFER_READY,e,t)}),this._p2pChannel.on(TF.FirstVideoPreRender,(e,t)=>{this.safeEmit(WN.FIRST_VIDEO_PRE_RENDER,e,t)}),this._p2pChannel.on(TF.RequestLowStreamParameter,e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(TF.QueryClientConnectionState,e=>{e(this.connectionState)}),this._p2pChannel.on(TF.AudioMetadata,e=>{this.safeEmit(WN.AUDIO_METADATA,e)}),this._p2pChannel.on(TF.AudioPts,e=>{this.safeEmit(WN.AUDIO_PTS,Number(e))})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||"CONNECTED"!==this.connectionState)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const n=(t={config:e},oV("ContentInspect").create(t));this._inspect=n,this.handleVideoInspectEvents(n);const{appId:r,cname:i,sid:o,token:a,uid:s,cid:c,vid:l}=this._joinInfo;await n.init({appId:r,areaCode:"",cname:i,sid:o,token:a,uid:s,cid:c,vid:l?Number(l):0},xO)}catch(e){throw Array.isArray(e)?e[0]:e}var t}handleVideoInspectEvents(e){e.on(RF.CONNECTION_STATE_CHANGE,(t,n)=>{if(this.safeEmit(WN.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,n),n===CF.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.safeEmit(WN.CONTENT_INSPECT_ERROR,new uk(hN.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(RF.INSPECT_RESULT,(e,t)=>{var n;if((null==t?void 0:t.code)===hN.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return nk.debug("Stop inspect content because that has left channel"),null==this||null===(n=this._inspect)||void 0===n||n.close(),void(this._inspect=void 0);this.safeEmit(WN.CONTENT_INSPECT_RESULT,e,t)}),e.on(RF.CLIENT_LOCAL_VIDEO_TRACK,e=>{e(this.localTracks.filter(e=>"video"===e.trackMediaType)[0])})}async disableContentInspect(){if(!this._inspect)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(mN(e,"enabled"),e){if(!t)throw new uk(hN.INVALID_PARAMS,"config is required");if(PH(t),!this._joinInfo)throw new uk(hN.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(t);else{const e=(n={config:t},oV("ImageModeration").create(n));this._moderation=e,this.handleImageModerationEvents(e);const{appId:r,cname:i,sid:o,token:a,uid:s,cid:c,vid:l}=this._joinInfo;await e.init({appId:r,areaCode:"",cname:i,sid:o,token:a,uid:s,cid:c,vid:l?Number(l):0},xO)}}catch(e){throw Array.isArray(e)?e[0]:e}}else{var n;if(!this._moderation)throw new uk(hN.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}}handleImageModerationEvents(e){e.on(PF.CONNECTION_STATE_CHANGE,(t,n)=>{if(this.safeEmit(WN.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,n),t===OF.CONNECTED){if("CONNECTED"!==this.connectionState)throw this.setImageModeration(!1),new uk(hN.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(PF.CLIENT_LOCAL_VIDEO_TRACK,e=>{e(this.localTracks.filter(e=>"video"===e.trackMediaType)[0])})}setP2PTransport(e){if(function(e){fN(e,"transport",["default","auto","relay","sd-rtn"])}(e),"p2p"!==this.mode)throw new uk(hN.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,nk.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return nk.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){mN(e,"enabled"),yP("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_setRteInfo(e,t){this.store.rteUrl=e,this.store.rteSid=t}_isPreRender(){return"isPreRender"in this._p2pChannel&&this._p2pChannel.isPreRender()}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},PU(yG.prototype,"leave",[DH],Object.getOwnPropertyDescriptor(yG.prototype,"leave"),yG.prototype),PU(yG.prototype,"publish",[xH],Object.getOwnPropertyDescriptor(yG.prototype,"publish"),yG.prototype),PU(yG.prototype,"unpublish",[LH],Object.getOwnPropertyDescriptor(yG.prototype,"unpublish"),yG.prototype),PU(yG.prototype,"subscribe",[MH],Object.getOwnPropertyDescriptor(yG.prototype,"subscribe"),yG.prototype),PU(yG.prototype,"presubscribe",[UH],Object.getOwnPropertyDescriptor(yG.prototype,"presubscribe"),yG.prototype),PU(yG.prototype,"massSubscribe",[FH],Object.getOwnPropertyDescriptor(yG.prototype,"massSubscribe"),yG.prototype),PU(yG.prototype,"unsubscribe",[jH],Object.getOwnPropertyDescriptor(yG.prototype,"unsubscribe"),yG.prototype),PU(yG.prototype,"massUnsubscribe",[VH],Object.getOwnPropertyDescriptor(yG.prototype,"massUnsubscribe"),yG.prototype),PU(yG.prototype,"setLowStreamParameter",[BH],Object.getOwnPropertyDescriptor(yG.prototype,"setLowStreamParameter"),yG.prototype),PU(yG.prototype,"setDualStreamMode",[WH],Object.getOwnPropertyDescriptor(yG.prototype,"setDualStreamMode"),yG.prototype),PU(yG.prototype,"enableDualStream",[HH],Object.getOwnPropertyDescriptor(yG.prototype,"enableDualStream"),yG.prototype),PU(yG.prototype,"disableDualStream",[GH],Object.getOwnPropertyDescriptor(yG.prototype,"disableDualStream"),yG.prototype),PU(yG.prototype,"setClientRole",[zH],Object.getOwnPropertyDescriptor(yG.prototype,"setClientRole"),yG.prototype),PU(yG.prototype,"_setClientRoleOptions",[KH],Object.getOwnPropertyDescriptor(yG.prototype,"_setClientRoleOptions"),yG.prototype),PU(yG.prototype,"setProxyServer",[YH],Object.getOwnPropertyDescriptor(yG.prototype,"setProxyServer"),yG.prototype),PU(yG.prototype,"setTurnServer",[qH],Object.getOwnPropertyDescriptor(yG.prototype,"setTurnServer"),yG.prototype),PU(yG.prototype,"setLicense",[XH],Object.getOwnPropertyDescriptor(yG.prototype,"setLicense"),yG.prototype),PU(yG.prototype,"startProxyServer",[JH],Object.getOwnPropertyDescriptor(yG.prototype,"startProxyServer"),yG.prototype),PU(yG.prototype,"stopProxyServer",[ZH],Object.getOwnPropertyDescriptor(yG.prototype,"stopProxyServer"),yG.prototype),PU(yG.prototype,"setLocalAccessPointsV2",[QH],Object.getOwnPropertyDescriptor(yG.prototype,"setLocalAccessPointsV2"),yG.prototype),PU(yG.prototype,"setLocalAccessPoints",[$H],Object.getOwnPropertyDescriptor(yG.prototype,"setLocalAccessPoints"),yG.prototype),PU(yG.prototype,"setRemoteDefaultVideoStreamType",[eG],Object.getOwnPropertyDescriptor(yG.prototype,"setRemoteDefaultVideoStreamType"),yG.prototype),PU(yG.prototype,"setRemoteVideoStreamType",[tG],Object.getOwnPropertyDescriptor(yG.prototype,"setRemoteVideoStreamType"),yG.prototype),PU(yG.prototype,"setStreamFallbackOption",[nG],Object.getOwnPropertyDescriptor(yG.prototype,"setStreamFallbackOption"),yG.prototype),PU(yG.prototype,"setEncryptionConfig",[rG],Object.getOwnPropertyDescriptor(yG.prototype,"setEncryptionConfig"),yG.prototype),PU(yG.prototype,"renewToken",[iG],Object.getOwnPropertyDescriptor(yG.prototype,"renewToken"),yG.prototype),PU(yG.prototype,"enableAudioVolumeIndicator",[oG],Object.getOwnPropertyDescriptor(yG.prototype,"enableAudioVolumeIndicator"),yG.prototype),PU(yG.prototype,"startLiveStreaming",[aG],Object.getOwnPropertyDescriptor(yG.prototype,"startLiveStreaming"),yG.prototype),PU(yG.prototype,"setLiveTranscoding",[sG],Object.getOwnPropertyDescriptor(yG.prototype,"setLiveTranscoding"),yG.prototype),PU(yG.prototype,"stopLiveStreaming",[cG],Object.getOwnPropertyDescriptor(yG.prototype,"stopLiveStreaming"),yG.prototype),PU(yG.prototype,"startChannelMediaRelay",[lG],Object.getOwnPropertyDescriptor(yG.prototype,"startChannelMediaRelay"),yG.prototype),PU(yG.prototype,"updateChannelMediaRelay",[dG],Object.getOwnPropertyDescriptor(yG.prototype,"updateChannelMediaRelay"),yG.prototype),PU(yG.prototype,"stopChannelMediaRelay",[uG],Object.getOwnPropertyDescriptor(yG.prototype,"stopChannelMediaRelay"),yG.prototype),PU(yG.prototype,"sendCustomReportMessage",[hG],Object.getOwnPropertyDescriptor(yG.prototype,"sendCustomReportMessage"),yG.prototype),PU(yG.prototype,"pickSVCLayer",[pG],Object.getOwnPropertyDescriptor(yG.prototype,"pickSVCLayer"),yG.prototype),PU(yG.prototype,"setRTMConfig",[mG],Object.getOwnPropertyDescriptor(yG.prototype,"setRTMConfig"),yG.prototype),PU(yG.prototype,"enableContentInspect",[fG],Object.getOwnPropertyDescriptor(yG.prototype,"enableContentInspect"),yG.prototype),PU(yG.prototype,"disableContentInspect",[gG],Object.getOwnPropertyDescriptor(yG.prototype,"disableContentInspect"),yG.prototype),PU(yG.prototype,"setImageModeration",[_G],Object.getOwnPropertyDescriptor(yG.prototype,"setImageModeration"),yG.prototype),PU(yG.prototype,"setP2PTransport",[vG],Object.getOwnPropertyDescriptor(yG.prototype,"setP2PTransport"),yG.prototype),PU(yG.prototype,"getJoinChannelServiceRecords",[bG],Object.getOwnPropertyDescriptor(yG.prototype,"getJoinChannelServiceRecords"),yG.prototype),PU(yG.prototype,"setPublishAudioFilterEnabled",[EG],Object.getOwnPropertyDescriptor(yG.prototype,"setPublishAudioFilterEnabled"),yG.prototype),yG);function wG(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const n=vO(5,"client-"),r=dk.reportApiInvoke(null,{id:n,name:DN.CREATE_CLIENT,options:[t],tag:xN.TRACER});try{!function(e){fN(e.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),fN(e.mode,"config.mode",["rtc","live","p2p"]),void 0!==e.audioCodec&&fN(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==e.proxyServer&&vN(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&jN(e.turnServer),void 0!==e.httpRetryConfig&&LN(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&LN(e.websocketRetryConfig)}(t)}catch(e){throw r.onError(e),e}return(XI(16,0,!0)||JI(16,0,!0))&&("vp9"===t.codec&&(t.codec="vp8",nk.debug("browser not support vp9, force use vp8")),yP("UNSUPPORTED_VIDEO_CODEC",["vp9"])),void 0===t.audioCodec&&(t.audioCodec="opus"),r.onSuccess(),new CG(TG(TG({forceWaitGatewayResponse:!0},t),{},{role:xr(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}),n)}function RG(){let e=!1;const t=PI();return(t.name===AI.CHROME&&Number(t.version)>=58&&("WebKit"!==NI.engine.name||function(){const e=PI();if(LI()){if(e.os===RI.MAC_OS)return!0;if(e.os===RI.IOS){const e=NI.os.version&&NI.os.version.split(".");if(e&&14===Number(e[0])&&e[1]&&Number(e[1])>=3)return!0;if(e&&Number(e[0])>14)return!0}}return!1}())||t.name===AI.FIREFOX&&Number(t.version)>=56||t.name===AI.OPERA&&Number(t.version)>=45||t.name===AI.SAFARI&&Number(t.version)>=11||"WebKit"===t.name&&(BI()||nN())&&t.osVersion&&Number(t.osVersion.split(".")[0])>=11||rN()||PI().name===AI.QQ)&&(e=!0),e}class AG{constructor(e,t){nR(this,"id",0),nR(this,"element",void 0),nR(this,"peerPair",void 0),nR(this,"context",void 0),nR(this,"audioPlayerElement",void 0),nR(this,"audioTrack",void 0),AG.count+=1,this.id=AG.count,this.element=e,this.context=t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const t=document.createElement("audio");t.srcObject=new MediaStream([e.track]),t.play(),this.audioPlayerElement=t}}async switchSdp(){if(!this.peerPair)return;const e=async(e,t)=>{const n="offer"===t?await e.createOffer():await e.createAnswer();return await e.setLocalDescription(n),"complete"===e.iceGatheringState?e.localDescription:new ip(t=>{e.onicegatheringstatechange=()=>{"complete"===e.iceGatheringState&&t(e.localDescription)}})},t=async(e,t)=>await e.setRemoteDescription(t);try{const n=await e(this.peerPair[0],"offer");await t(this.peerPair[1],n);const r=await e(this.peerPair[1],"answer");await t(this.peerPair[0],r)}catch(e){throw new uk(hN.LOCAL_AEC_ERROR,e.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let t;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(t)}catch(e){throw new uk(hN.LOCAL_AEC_ERROR,e.toString()).print()}if(!t)throw new uk(hN.LOCAL_AEC_ERROR,"no dest node when local aec").print();const n=t.stream.getAudioTracks()[0];return this.audioTrack=n,n}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,t=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(t),await this.switchSdp()}close(){nk.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(e=>{e.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var IG,NG;nR(AG,"count",0);const OG=window.AudioContext||window.webkitAudioContext,PG=new(IG=lk({report:dk}),PU((NG=class{constructor(){nR(this,"units",[]),nR(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return nk.debug("the system does not need to process local aec"),-1;this.context||(this.context=new OG);let t=this.units.find(t=>t&&t.getElement()===e);return t||(t=new AG(e,this.context),this.units.push(t)),t.startEchoCancellation(),nk.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return PI().name!==AI.SAFARI}}).prototype,"processExternalMediaAEC",[IG],Object.getOwnPropertyDescriptor(NG.prototype,"processExternalMediaAEC"),NG.prototype),NG);function kG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function DG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kG(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kG(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const xG=window||document;function LG(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!xG)return;const n=yJ._cspEventHandlerPointer;if(n&&t)return void console.error(n,t);const r=e=>{if(!(e&&e.blockedURI&&(yJ.onSecurityPolicyViolation||yJ.getListeners(NF.SECURITY_POLICY_VIOLATION).length>0)))return;const t=e.blockedURI;SP("CSP_DETECTED_HOSTNAME_LIST").some(e=>xr(t).call(t,e))&&(yJ.onSecurityPolicyViolation&&"function"==typeof yJ.onSecurityPolicyViolation&&yJ.onSecurityPolicyViolation(e),yJ.getListeners(NF.SECURITY_POLICY_VIOLATION).length>0&&yJ.safeEmit(NF.SECURITY_POLICY_VIOLATION,e))};n&&xG.removeEventListener("securitypolicyviolation",n),(t||e&&"function"==typeof e||yJ.getListeners(NF.SECURITY_POLICY_VIOLATION).length>0)&&xG.addEventListener("securitypolicyviolation",r),yJ._cspEventHandlerPointer=r}var MG=u,UG=iE,FG=RegExp.prototype,jG=function(e){return e===FG||MG(FG,e)?UG(e):e.flags},VG=r(jG);function BG(e){let t=e.length;for(;--t>=0;)e[t]=0}const WG=256,HG=286,GG=30,zG=15,KG=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),YG=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),qG=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),XG=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),JG=new Array(576);BG(JG);const ZG=new Array(60);BG(ZG);const QG=new Array(512);BG(QG);const $G=new Array(256);BG($G);const ez=new Array(29);BG(ez);const tz=new Array(GG);function nz(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let rz,iz,oz;function az(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}BG(tz);const sz=e=>e<256?QG[e]:QG[256+(e>>>7)],cz=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},lz=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,cz(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},dz=(e,t,n)=>{lz(e,n[2*t],n[2*t+1])},uz=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},hz=(e,t,n)=>{const r=new Array(16);let i,o,a=0;for(i=1;i<=zG;i++)a=a+n[i-1]<<1,r[i]=a;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=uz(r[t]++,t))}},pz=e=>{let t;for(t=0;t<HG;t++)e.dyn_ltree[2*t]=0;for(t=0;t<GG;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},mz=e=>{e.bi_valid>8?cz(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},fz=(e,t,n,r)=>{const i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]},gz=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&fz(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!fz(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},_z=(e,t,n)=>{let r,i,o,a,s=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+s++],r+=(255&e.pending_buf[e.sym_buf+s++])<<8,i=e.pending_buf[e.sym_buf+s++],0===r?dz(e,i,t):(o=$G[i],dz(e,o+WG+1,t),a=KG[o],0!==a&&(i-=ez[o],lz(e,i,a)),r--,o=sz(r),dz(e,o,n),a=YG[o],0!==a&&(r-=tz[o],lz(e,r,a)))}while(s<e.sym_next);dz(e,256,t)},vz=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let a,s,c,l=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<o;a++)0!==n[2*a]?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=r[2*c+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)gz(e,n,a);c=o;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],gz(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[2*c]=n[2*a]+n[2*s],e.depth[c]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[2*a+1]=n[2*s+1]=c,e.heap[1]=c++,gz(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,d,u,h,p,m,f=0;for(h=0;h<=zG;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],h=n[2*n[2*d+1]+1]+1,h>c&&(h=c,f++),n[2*d+1]=h,d>r||(e.bl_count[h]++,p=0,d>=s&&(p=a[d-s]),m=n[2*d],e.opt_len+=m*(h+p),o&&(e.static_len+=m*(i[2*d+1]+p)));if(0!==f){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,f-=2}while(f>0);for(h=c;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--l],u>r||(n[2*u+1]!==h&&(e.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),d--)}})(e,t),hz(n,l,e.bl_count)},bz=(e,t,n)=>{let r,i,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<c&&i===a||(s<l?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(c=138,l=3):i===a?(c=6,l=3):(c=7,l=4))},Ez=(e,t,n)=>{let r,i,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<c&&i===a)){if(s<l)do{dz(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(dz(e,i,e.bl_tree),s--),dz(e,16,e.bl_tree),lz(e,s-3,2)):s<=10?(dz(e,17,e.bl_tree),lz(e,s-3,3)):(dz(e,18,e.bl_tree),lz(e,s-11,7));s=0,o=i,0===a?(c=138,l=3):i===a?(c=6,l=3):(c=7,l=4)}};let yz=!1;const Sz=(e,t,n,r)=>{lz(e,0+(r?1:0),3),mz(e),cz(e,n),cz(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var Tz=e=>{yz||((()=>{let e,t,n,r,i;const o=new Array(16);for(n=0,r=0;r<28;r++)for(ez[r]=n,e=0;e<1<<KG[r];e++)$G[n++]=r;for($G[n-1]=r,i=0,r=0;r<16;r++)for(tz[r]=i,e=0;e<1<<YG[r];e++)QG[i++]=r;for(i>>=7;r<GG;r++)for(tz[r]=i<<7,e=0;e<1<<YG[r]-7;e++)QG[256+i++]=r;for(t=0;t<=zG;t++)o[t]=0;for(e=0;e<=143;)JG[2*e+1]=8,e++,o[8]++;for(;e<=255;)JG[2*e+1]=9,e++,o[9]++;for(;e<=279;)JG[2*e+1]=7,e++,o[7]++;for(;e<=287;)JG[2*e+1]=8,e++,o[8]++;for(hz(JG,287,o),e=0;e<GG;e++)ZG[2*e+1]=5,ZG[2*e]=uz(e,5);rz=new nz(JG,KG,257,HG,zG),iz=new nz(ZG,YG,0,GG,zG),oz=new nz(new Array(0),qG,0,19,7)})(),yz=!0),e.l_desc=new az(e.dyn_ltree,rz),e.d_desc=new az(e.dyn_dtree,iz),e.bl_desc=new az(e.bl_tree,oz),e.bi_buf=0,e.bi_valid=0,pz(e)},Cz=(e,t,n,r)=>{let i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<WG;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),vz(e,e.l_desc),vz(e,e.d_desc),a=(e=>{let t;for(bz(e,e.dyn_ltree,e.l_desc.max_code),bz(e,e.dyn_dtree,e.d_desc.max_code),vz(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*XG[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?Sz(e,t,n,r):4===e.strategy||o===i?(lz(e,2+(r?1:0),3),_z(e,JG,ZG)):(lz(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(lz(e,t-257,5),lz(e,n-1,5),lz(e,r-4,4),i=0;i<r;i++)lz(e,e.bl_tree[2*XG[i]+1],3);Ez(e,e.dyn_ltree,t-1),Ez(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),_z(e,e.dyn_ltree,e.dyn_dtree)),pz(e),r&&mz(e)},wz=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*($G[n]+WG+1)]++,e.dyn_dtree[2*sz(t)]++),e.sym_next===e.sym_end),Rz=e=>{lz(e,2,3),dz(e,256,JG),(e=>{16===e.bi_valid?(cz(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},Az={_tr_init:Tz,_tr_stored_block:Sz,_tr_flush_block:Cz,_tr_tally:wz,_tr_align:Rz},Iz=(e,t,n,r)=>{let i=65535&e,o=e>>>16&65535,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{i=i+t[r++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16};const Nz=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Oz=(e,t,n,r)=>{const i=Nz,o=r+n;e^=-1;for(let a=r;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e},Pz={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},kz={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Dz,_tr_stored_block:xz,_tr_flush_block:Lz,_tr_tally:Mz,_tr_align:Uz}=Az,{Z_NO_FLUSH:Fz,Z_PARTIAL_FLUSH:jz,Z_FULL_FLUSH:Vz,Z_FINISH:Bz,Z_BLOCK:Wz,Z_OK:Hz,Z_STREAM_END:Gz,Z_STREAM_ERROR:zz,Z_DATA_ERROR:Kz,Z_BUF_ERROR:Yz,Z_DEFAULT_COMPRESSION:qz,Z_FILTERED:Xz,Z_HUFFMAN_ONLY:Jz,Z_RLE:Zz,Z_FIXED:Qz,Z_DEFAULT_STRATEGY:$z,Z_UNKNOWN:eK,Z_DEFLATED:tK}=kz,nK=286,rK=30,iK=19,oK=2*nK+1,aK=15,sK=258,cK=262,lK=42,dK=113,uK=666,hK=(e,t)=>(e.msg=Pz[t],t),pK=e=>2*e-(e>4?9:0),mK=e=>{let t=e.length;for(;--t>=0;)e[t]=0},fK=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let gK=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const _K=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},vK=(e,t)=>{Lz(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,_K(e.strm)},bK=(e,t)=>{e.pending_buf[e.pending++]=t},EK=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},yK=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=Iz(e.adler,t,i,n):2===e.state.wrap&&(e.adler=Oz(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},SK=(e,t)=>{let n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match;const c=e.strstart>e.w_size-cK?e.strstart-(e.w_size-cK):0,l=e.window,d=e.w_mask,u=e.prev,h=e.strstart+sK;let p=l[o+a-1],m=l[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,l[n+a]===m&&l[n+a-1]===p&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<h);if(r=sK-(h-o),o=h-sK,r>a){if(e.match_start=t,a=r,r>=s)break;p=l[o+a-1],m=l[o+a]}}}while((t=u[t&d])>c&&0!=--i);return a<=e.lookahead?a:e.lookahead},TK=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-cK)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),fK(e),r+=t),0===e.strm.avail_in)break;if(n=yK(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=gK(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=gK(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<cK&&0!==e.strm.avail_in)},CK=(e,t)=>{let n,r,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<o&&(0===n&&t!==Bz||t===Fz||n!==r+e.strm.avail_in))break;a=t===Bz&&n===r+e.strm.avail_in?1:0,xz(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,_K(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(yK(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==Fz&&t!==Bz&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(yK(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=o||(r||t===Bz)&&t!==Fz&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,a=t===Bz&&0===e.strm.avail_in&&n===r?1:0,xz(e,e.block_start,n,a),e.block_start+=n,_K(e.strm)),a?3:1)},wK=(e,t)=>{let n,r;for(;;){if(e.lookahead<cK){if(TK(e),e.lookahead<cK&&t===Fz)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=gK(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-cK&&(e.match_length=SK(e,n)),e.match_length>=3)if(r=Mz(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=gK(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=gK(e,e.ins_h,e.window[e.strstart+1]);else r=Mz(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(vK(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Bz?(vK(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vK(e,!1),0===e.strm.avail_out)?1:2},RK=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<cK){if(TK(e),e.lookahead<cK&&t===Fz)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=gK(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-cK&&(e.match_length=SK(e,n),e.match_length<=5&&(e.strategy===Xz||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=Mz(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=gK(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(vK(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=Mz(e,0,e.window[e.strstart-1]),r&&vK(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Mz(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Bz?(vK(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vK(e,!1),0===e.strm.avail_out)?1:2};function AK(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const IK=[new AK(0,0,0,0,CK),new AK(4,4,8,4,wK),new AK(4,5,16,8,wK),new AK(4,6,32,32,wK),new AK(4,4,16,16,RK),new AK(8,16,32,32,RK),new AK(8,16,128,128,RK),new AK(8,32,128,256,RK),new AK(32,128,258,1024,RK),new AK(32,258,258,4096,RK)];function NK(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=tK,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*oK),this.dyn_dtree=new Uint16Array(2*(2*rK+1)),this.bl_tree=new Uint16Array(2*(2*iK+1)),mK(this.dyn_ltree),mK(this.dyn_dtree),mK(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(aK+1),this.heap=new Uint16Array(2*nK+1),mK(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*nK+1),mK(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const OK=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==lK&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==dK&&t.status!==uK?1:0},PK=e=>{if(OK(e))return hK(e,zz);e.total_in=e.total_out=0,e.data_type=eK;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?lK:dK,e.adler=2===t.wrap?0:1,t.last_flush=-2,Dz(t),Hz},kK=e=>{const t=PK(e);return t===Hz&&(e=>{e.window_size=2*e.w_size,mK(e.head),e.max_lazy_match=IK[e.level].max_lazy,e.good_match=IK[e.level].good_length,e.nice_match=IK[e.level].nice_length,e.max_chain_length=IK[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},DK=(e,t,n,r,i,o)=>{if(!e)return zz;let a=1;if(t===qz&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>9||n!==tK||r<8||r>15||t<0||t>9||o<0||o>Qz||8===r&&1!==a)return hK(e,zz);8===r&&(r=9);const s=new NK;return e.state=s,s.strm=e,s.status=lK,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=o,s.method=n,kK(e)};var xK=(e,t)=>{if(OK(e)||t>Wz||t<0)return e?hK(e,zz):zz;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===uK&&t!==Bz)return hK(e,0===e.avail_out?Yz:zz);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(_K(e),0===e.avail_out)return n.last_flush=-1,Hz}else if(0===e.avail_in&&pK(t)<=pK(r)&&t!==Bz)return hK(e,Yz);if(n.status===uK&&0!==e.avail_in)return hK(e,Yz);if(n.status===lK&&0===n.wrap&&(n.status=dK),n.status===lK){let t=tK+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Jz||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,EK(n,t),0!==n.strstart&&(EK(n,e.adler>>>16),EK(n,65535&e.adler)),e.adler=1,n.status=dK,_K(e),0!==n.pending)return n.last_flush=-1,Hz}if(57===n.status)if(e.adler=0,bK(n,31),bK(n,139),bK(n,8),n.gzhead)bK(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),bK(n,255&n.gzhead.time),bK(n,n.gzhead.time>>8&255),bK(n,n.gzhead.time>>16&255),bK(n,n.gzhead.time>>24&255),bK(n,9===n.level?2:n.strategy>=Jz||n.level<2?4:0),bK(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(bK(n,255&n.gzhead.extra.length),bK(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Oz(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(bK(n,0),bK(n,0),bK(n,0),bK(n,0),bK(n,0),bK(n,9===n.level?2:n.strategy>=Jz||n.level<2?4:0),bK(n,3),n.status=dK,_K(e),0!==n.pending)return n.last_flush=-1,Hz;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=Oz(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,_K(e),0!==n.pending)return n.last_flush=-1,Hz;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=Oz(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Oz(e.adler,n.pending_buf,n.pending-r,r)),_K(e),0!==n.pending)return n.last_flush=-1,Hz;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,bK(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Oz(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Oz(e.adler,n.pending_buf,n.pending-r,r)),_K(e),0!==n.pending)return n.last_flush=-1,Hz;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,bK(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Oz(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(_K(e),0!==n.pending))return n.last_flush=-1,Hz;bK(n,255&e.adler),bK(n,e.adler>>8&255),e.adler=0}if(n.status=dK,_K(e),0!==n.pending)return n.last_flush=-1,Hz}if(0!==e.avail_in||0!==n.lookahead||t!==Fz&&n.status!==uK){let r=0===n.level?CK(n,t):n.strategy===Jz?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(TK(e),0===e.lookahead)){if(t===Fz)return 1;break}if(e.match_length=0,n=Mz(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(vK(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Bz?(vK(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vK(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===Zz?((e,t)=>{let n,r,i,o;const a=e.window;for(;;){if(e.lookahead<=sK){if(TK(e),e.lookahead<=sK&&t===Fz)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){o=e.strstart+sK;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o);e.match_length=sK-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Mz(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Mz(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(vK(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Bz?(vK(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vK(e,!1),0===e.strm.avail_out)?1:2})(n,t):IK[n.level].func(n,t);if(3!==r&&4!==r||(n.status=uK),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Hz;if(2===r&&(t===jz?Uz(n):t!==Wz&&(xz(n,0,0,!1),t===Vz&&(mK(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),_K(e),0===e.avail_out))return n.last_flush=-1,Hz}return t!==Bz?Hz:n.wrap<=0?Gz:(2===n.wrap?(bK(n,255&e.adler),bK(n,e.adler>>8&255),bK(n,e.adler>>16&255),bK(n,e.adler>>24&255),bK(n,255&e.total_in),bK(n,e.total_in>>8&255),bK(n,e.total_in>>16&255),bK(n,e.total_in>>24&255)):(EK(n,e.adler>>>16),EK(n,65535&e.adler)),_K(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Hz:Gz)},LK=(e,t)=>{let n=t.length;if(OK(e))return zz;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==lK||r.lookahead)return zz;if(1===i&&(e.adler=Iz(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(mK(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const o=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,TK(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=gK(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,TK(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=o,r.wrap=i,Hz},MK={deflateInit:(e,t)=>DK(e,t,tK,15,8,$z),deflateInit2:DK,deflateReset:kK,deflateResetKeep:PK,deflateSetHeader:(e,t)=>OK(e)||2!==e.state.wrap?zz:(e.state.gzhead=t,Hz),deflate:xK,deflateEnd:e=>{if(OK(e))return zz;const t=e.state.status;return e.state=null,t===dK?hK(e,Kz):Hz},deflateSetDictionary:LK,deflateInfo:"pako deflate (from Nodeca project)"};const UK=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var FK={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)UK(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,o=e.length;r<o;r++){let t=e[r];n.set(t,i),i+=t.length}return n}};let jK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){jK=!1}const VK=new Uint8Array(256);for(let n=0;n<256;n++)VK[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;VK[254]=VK[254]=1;var BK={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,o,a=e.length,s=0;for(i=0;i<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const o=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){o[i++]=t;continue}let a=VK[t];if(a>4)o[i++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&jK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+VK[e[n]]>t?n:t}},WK=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const HK=Object.prototype.toString,{Z_NO_FLUSH:GK,Z_SYNC_FLUSH:zK,Z_FULL_FLUSH:KK,Z_FINISH:YK,Z_OK:qK,Z_STREAM_END:XK,Z_DEFAULT_COMPRESSION:JK,Z_DEFAULT_STRATEGY:ZK,Z_DEFLATED:QK}=kz;function $K(e){this.options=FK.assign({level:JK,method:QK,chunkSize:16384,windowBits:15,memLevel:8,strategy:ZK},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WK,this.strm.avail_out=0;let n=MK.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==qK)throw new Error(Pz[n]);if(t.header&&MK.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?BK.string2buf(t.dictionary):"[object ArrayBuffer]"===HK.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=MK.deflateSetDictionary(this.strm,e),n!==qK)throw new Error(Pz[n]);this._dict_set=!0}}function eY(e,t){const n=new $K(t);if(n.push(e,!0),n.err)throw n.msg||Pz[n.err];return n.result}$K.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?YK:GK,"string"==typeof e?n.input=BK.string2buf(e):"[object ArrayBuffer]"===HK.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(o===zK||o===KK)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=MK.deflate(n,o),i===XK)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=MK.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===qK;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},$K.prototype.onData=function(e){this.chunks.push(e)},$K.prototype.onEnd=function(e){e===qK&&(this.result=FK.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var tY={Deflate:$K,deflate:eY,deflateRaw:function(e,t){return(t=t||{}).raw=!0,eY(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,eY(e,t)},constants:kz};const nY=16209;var rY=function(e,t){let n,r,i,o,a,s,c,l,d,u,h,p,m,f,g,_,v,b,E,y,S,T,C,w;const R=e.state;n=e.next_in,C=e.input,r=n+(e.avail_in-5),i=e.next_out,w=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),s=R.dmax,c=R.wsize,l=R.whave,d=R.wnext,u=R.window,h=R.hold,p=R.bits,m=R.lencode,f=R.distcode,g=(1<<R.lenbits)-1,_=(1<<R.distbits)-1;e:do{p<15&&(h+=C[n++]<<p,p+=8,h+=C[n++]<<p,p+=8),v=m[h&g];t:for(;;){if(b=v>>>24,h>>>=b,p-=b,b=v>>>16&255,0===b)w[i++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=m[(65535&v)+(h&(1<<b)-1)];continue t}if(32&b){R.mode=16191;break e}e.msg="invalid literal/length code",R.mode=nY;break e}E=65535&v,b&=15,b&&(p<b&&(h+=C[n++]<<p,p+=8),E+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=C[n++]<<p,p+=8,h+=C[n++]<<p,p+=8),v=f[h&_];n:for(;;){if(b=v>>>24,h>>>=b,p-=b,b=v>>>16&255,!(16&b)){if(0==(64&b)){v=f[(65535&v)+(h&(1<<b)-1)];continue n}e.msg="invalid distance code",R.mode=nY;break e}if(y=65535&v,b&=15,p<b&&(h+=C[n++]<<p,p+=8,p<b&&(h+=C[n++]<<p,p+=8)),y+=h&(1<<b)-1,y>s){e.msg="invalid distance too far back",R.mode=nY;break e}if(h>>>=b,p-=b,b=i-o,y>b){if(b=y-b,b>l&&R.sane){e.msg="invalid distance too far back",R.mode=nY;break e}if(S=0,T=u,0===d){if(S+=c-b,b<E){E-=b;do{w[i++]=u[S++]}while(--b);S=i-y,T=w}}else if(d<b){if(S+=c+d-b,b-=d,b<E){E-=b;do{w[i++]=u[S++]}while(--b);if(S=0,d<E){b=d,E-=b;do{w[i++]=u[S++]}while(--b);S=i-y,T=w}}}else if(S+=d-b,b<E){E-=b;do{w[i++]=u[S++]}while(--b);S=i-y,T=w}for(;E>2;)w[i++]=T[S++],w[i++]=T[S++],w[i++]=T[S++],E-=3;E&&(w[i++]=T[S++],E>1&&(w[i++]=T[S++]))}else{S=i-y;do{w[i++]=w[S++],w[i++]=w[S++],w[i++]=w[S++],E-=3}while(E>2);E&&(w[i++]=w[S++],E>1&&(w[i++]=w[S++]))}break}}break}}while(n<r&&i<a);E=p>>3,n-=E,p-=E<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<a?a-i+257:257-(i-a),R.hold=h,R.bits=p};const iY=15,oY=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),aY=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),sY=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cY=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var lY=(e,t,n,r,i,o,a,s)=>{const c=s.bits;let l,d,u,h,p,m,f=0,g=0,_=0,v=0,b=0,E=0,y=0,S=0,T=0,C=0,w=null;const R=new Uint16Array(16),A=new Uint16Array(16);let I,N,O,P=null;for(f=0;f<=iY;f++)R[f]=0;for(g=0;g<r;g++)R[t[n+g]]++;for(b=c,v=iY;v>=1&&0===R[v];v--);if(b>v&&(b=v),0===v)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(_=1;_<v&&0===R[_];_++);for(b<_&&(b=_),S=1,f=1;f<=iY;f++)if(S<<=1,S-=R[f],S<0)return-1;if(S>0&&(0===e||1!==v))return-1;for(A[1]=0,f=1;f<iY;f++)A[f+1]=A[f]+R[f];for(g=0;g<r;g++)0!==t[n+g]&&(a[A[t[n+g]]++]=g);if(0===e?(w=P=a,m=20):1===e?(w=oY,P=aY,m=257):(w=sY,P=cY,m=0),C=0,g=0,f=_,p=o,E=b,y=0,u=-1,T=1<<b,h=T-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){I=f-y,a[g]+1<m?(N=0,O=a[g]):a[g]>=m?(N=P[a[g]-m],O=w[a[g]-m]):(N=96,O=0),l=1<<f-y,d=1<<E,_=d;do{d-=l,i[p+(C>>y)+d]=I<<24|N<<16|O}while(0!==d);for(l=1<<f-1;C&l;)l>>=1;if(0!==l?(C&=l-1,C+=l):C=0,g++,0==--R[f]){if(f===v)break;f=t[n+a[g]]}if(f>b&&(C&h)!==u){for(0===y&&(y=b),p+=_,E=f-y,S=1<<E;E+y<v&&(S-=R[E+y],!(S<=0));)E++,S<<=1;if(T+=1<<E,1===e&&T>852||2===e&&T>592)return 1;u=C&h,i[u]=b<<24|E<<16|p-o}}return 0!==C&&(i[p+C]=f-y<<24|64<<16),s.bits=b,0};const{Z_FINISH:dY,Z_BLOCK:uY,Z_TREES:hY,Z_OK:pY,Z_STREAM_END:mY,Z_NEED_DICT:fY,Z_STREAM_ERROR:gY,Z_DATA_ERROR:_Y,Z_MEM_ERROR:vY,Z_BUF_ERROR:bY,Z_DEFLATED:EY}=kz,yY=16180,SY=16190,TY=16191,CY=16192,wY=16194,RY=16199,AY=16200,IY=16206,NY=16209,OY=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function PY(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const kY=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<yY||t.mode>16211?1:0},DY=e=>{if(kY(e))return gY;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=yY,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,pY},xY=e=>{if(kY(e))return gY;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,DY(e)},LY=(e,t)=>{let n;if(kY(e))return gY;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?gY:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,xY(e))},MY=(e,t)=>{if(!e)return gY;const n=new PY;e.state=n,n.strm=e,n.window=null,n.mode=yY;const r=LY(e,t);return r!==pY&&(e.state=null),r};let UY,FY,jY=!0;const VY=e=>{if(jY){UY=new Int32Array(512),FY=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(lY(1,e.lens,0,288,UY,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;lY(2,e.lens,0,32,FY,0,e.work,{bits:5}),jY=!1}e.lencode=UY,e.lenbits=9,e.distcode=FY,e.distbits=5},BY=(e,t,n,r)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(t.subarray(n-r,n-r+i),o.wnext),(r-=i)?(o.window.set(t.subarray(n-r,n),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var WY=(e,t)=>{let n,r,i,o,a,s,c,l,d,u,h,p,m,f,g,_,v,b,E,y,S,T,C=0;const w=new Uint8Array(4);let R,A;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(kY(e)||!e.output||!e.input&&0!==e.avail_in)return gY;n=e.state,n.mode===TY&&(n.mode=CY),a=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,l=n.hold,d=n.bits,u=s,h=c,T=pY;e:for(;;)switch(n.mode){case yY:if(0===n.wrap){n.mode=CY;break}for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,w[0]=255&l,w[1]=l>>>8&255,n.check=Oz(n.check,w,2,0),l=0,d=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=NY;break}if((15&l)!==EY){e.msg="unknown compression method",n.mode=NY;break}if(l>>>=4,d-=4,S=8+(15&l),0===n.wbits&&(n.wbits=S),S>15||S>n.wbits){e.msg="invalid window size",n.mode=NY;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:TY,l=0,d=0;break;case 16181:for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(n.flags=l,(255&VG(n))!==EY){e.msg="unknown compression method",n.mode=NY;break}if(57344&VG(n)){e.msg="unknown header flags set",n.mode=NY;break}n.head&&(n.head.text=l>>8&1),512&VG(n)&&4&n.wrap&&(w[0]=255&l,w[1]=l>>>8&255,n.check=Oz(n.check,w,2,0)),l=0,d=0,n.mode=16182;case 16182:for(;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.head&&(n.head.time=l),512&VG(n)&&4&n.wrap&&(w[0]=255&l,w[1]=l>>>8&255,w[2]=l>>>16&255,w[3]=l>>>24&255,n.check=Oz(n.check,w,4,0)),l=0,d=0,n.mode=16183;case 16183:for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&VG(n)&&4&n.wrap&&(w[0]=255&l,w[1]=l>>>8&255,n.check=Oz(n.check,w,2,0)),l=0,d=0,n.mode=16184;case 16184:if(1024&VG(n)){for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.length=l,n.head&&(n.head.extra_len=l),512&VG(n)&&4&n.wrap&&(w[0]=255&l,w[1]=l>>>8&255,n.check=Oz(n.check,w,2,0)),l=0,d=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&VG(n)&&(p=n.length,p>s&&(p=s),p&&(n.head&&(S=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(o,o+p),S)),512&VG(n)&&4&n.wrap&&(n.check=Oz(n.check,r,p,o)),s-=p,o+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&VG(n)){if(0===s)break e;p=0;do{S=r[o+p++],n.head&&S&&n.length<65536&&(n.head.name+=String.fromCharCode(S))}while(S&&p<s);if(512&VG(n)&&4&n.wrap&&(n.check=Oz(n.check,r,p,o)),s-=p,o+=p,S)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&VG(n)){if(0===s)break e;p=0;do{S=r[o+p++],n.head&&S&&n.length<65536&&(n.head.comment+=String.fromCharCode(S))}while(S&&p<s);if(512&VG(n)&&4&n.wrap&&(n.check=Oz(n.check,r,p,o)),s-=p,o+=p,S)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&VG(n)){for(;d<16;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=NY;break}l=0,d=0}n.head&&(n.head.hcrc=VG(n)>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=TY;break;case 16189:for(;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}e.adler=n.check=OY(l),l=0,d=0,n.mode=SY;case SY:if(0===n.havedict)return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=l,n.bits=d,fY;e.adler=n.check=1,n.mode=TY;case TY:if(t===uY||t===hY)break e;case CY:if(n.last){l>>>=7&d,d-=7&d,n.mode=IY;break}for(;d<3;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}switch(n.last=1&l,l>>>=1,d-=1,3&l){case 0:n.mode=16193;break;case 1:if(VY(n),n.mode=RY,t===hY){l>>>=2,d-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=NY}l>>>=2,d-=2;break;case 16193:for(l>>>=7&d,d-=7&d;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=NY;break}if(n.length=65535&l,l=0,d=0,n.mode=wY,t===hY)break e;case wY:n.mode=16195;case 16195:if(p=n.length,p){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;i.set(r.subarray(o,o+p),a),s-=p,o+=p,c-=p,a+=p,n.length-=p;break}n.mode=TY;break;case 16196:for(;d<14;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(n.nlen=257+(31&l),l>>>=5,d-=5,n.ndist=1+(31&l),l>>>=5,d-=5,n.ncode=4+(15&l),l>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=NY;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;d<3;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.lens[I[n.have++]]=7&l,l>>>=3,d-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,R={bits:n.lenbits},T=lY(0,n.lens,0,19,n.lencode,0,n.work,R),n.lenbits=R.bits,T){e.msg="invalid code lengths set",n.mode=NY;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;C=n.lencode[l&(1<<n.lenbits)-1],g=C>>>24,_=C>>>16&255,v=65535&C,!(g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(v<16)l>>>=g,d-=g,n.lens[n.have++]=v;else{if(16===v){for(A=g+2;d<A;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(l>>>=g,d-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=NY;break}S=n.lens[n.have-1],p=3+(3&l),l>>>=2,d-=2}else if(17===v){for(A=g+3;d<A;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=g,d-=g,S=0,p=3+(7&l),l>>>=3,d-=3}else{for(A=g+7;d<A;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=g,d-=g,S=0,p=11+(127&l),l>>>=7,d-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=NY;break}for(;p--;)n.lens[n.have++]=S}}if(n.mode===NY)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=NY;break}if(n.lenbits=9,R={bits:n.lenbits},T=lY(1,n.lens,0,n.nlen,n.lencode,0,n.work,R),n.lenbits=R.bits,T){e.msg="invalid literal/lengths set",n.mode=NY;break}if(n.distbits=6,n.distcode=n.distdyn,R={bits:n.distbits},T=lY(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R),n.distbits=R.bits,T){e.msg="invalid distances set",n.mode=NY;break}if(n.mode=RY,t===hY)break e;case RY:n.mode=AY;case AY:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=l,n.bits=d,rY(e,h),a=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,l=n.hold,d=n.bits,n.mode===TY&&(n.back=-1);break}for(n.back=0;C=n.lencode[l&(1<<n.lenbits)-1],g=C>>>24,_=C>>>16&255,v=65535&C,!(g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(_&&0==(240&_)){for(b=g,E=_,y=v;C=n.lencode[y+((l&(1<<b+E)-1)>>b)],g=C>>>24,_=C>>>16&255,v=65535&C,!(b+g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=b,d-=b,n.back+=b}if(l>>>=g,d-=g,n.back+=g,n.length=v,0===_){n.mode=16205;break}if(32&_){n.back=-1,n.mode=TY;break}if(64&_){e.msg="invalid literal/length code",n.mode=NY;break}n.extra=15&_,n.mode=16201;case 16201:if(n.extra){for(A=n.extra;d<A;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;C=n.distcode[l&(1<<n.distbits)-1],g=C>>>24,_=C>>>16&255,v=65535&C,!(g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(0==(240&_)){for(b=g,E=_,y=v;C=n.distcode[y+((l&(1<<b+E)-1)>>b)],g=C>>>24,_=C>>>16&255,v=65535&C,!(b+g<=d);){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}l>>>=b,d-=b,n.back+=b}if(l>>>=g,d-=g,n.back+=g,64&_){e.msg="invalid distance code",n.mode=NY;break}n.offset=v,n.extra=15&_,n.mode=16203;case 16203:if(n.extra){for(A=n.extra;d<A;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=NY;break}n.mode=16204;case 16204:if(0===c)break e;if(p=h-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=NY;break}p>n.wnext?(p-=n.wnext,m=n.wsize-p):m=n.wnext-p,p>n.length&&(p=n.length),f=n.window}else f=i,m=a-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{i[a++]=f[m++]}while(--p);0===n.length&&(n.mode=AY);break;case 16205:if(0===c)break e;i[a++]=n.length,c--,n.mode=AY;break;case IY:if(n.wrap){for(;d<32;){if(0===s)break e;s--,l|=r[o++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=VG(n)?Oz(n.check,i,h,a-h):Iz(n.check,i,h,a-h)),h=c,4&n.wrap&&(VG(n)?l:OY(l))!==n.check){e.msg="incorrect data check",n.mode=NY;break}l=0,d=0}n.mode=16207;case 16207:if(n.wrap&&VG(n)){for(;d<32;){if(0===s)break e;s--,l+=r[o++]<<d,d+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=NY;break}l=0,d=0}n.mode=16208;case 16208:T=mY;break e;case NY:T=_Y;break e;case 16210:return vY;default:return gY}return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=l,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<NY&&(n.mode<IY||t!==dY))&&BY(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=VG(n)?Oz(n.check,i,h,e.next_out-h):Iz(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===TY?128:0)+(n.mode===RY||n.mode===wY?256:0),(0===u&&0===h||t===dY)&&T===pY&&(T=bY),T},HY={inflateReset:xY,inflateReset2:LY,inflateResetKeep:DY,inflateInit:e=>MY(e,15),inflateInit2:MY,inflate:WY,inflateEnd:e=>{if(kY(e))return gY;let t=e.state;return t.window&&(t.window=null),e.state=null,pY},inflateGetHeader:(e,t)=>{if(kY(e))return gY;const n=e.state;return 0==(2&n.wrap)?gY:(n.head=t,t.done=!1,pY)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,o;return kY(e)?gY:(r=e.state,0!==r.wrap&&r.mode!==SY?gY:r.mode===SY&&(i=1,i=Iz(i,t,n,0),i!==r.check)?_Y:(o=BY(e,t,n,n),o?(r.mode=16210,vY):(r.havedict=1,pY)))},inflateInfo:"pako inflate (from Nodeca project)"},GY=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const zY=Object.prototype.toString,{Z_NO_FLUSH:KY,Z_FINISH:YY,Z_OK:qY,Z_STREAM_END:XY,Z_NEED_DICT:JY,Z_STREAM_ERROR:ZY,Z_DATA_ERROR:QY,Z_MEM_ERROR:$Y}=kz;function eq(e){this.options=FK.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WK,this.strm.avail_out=0;let n=HY.inflateInit2(this.strm,t.windowBits);if(n!==qY)throw new Error(Pz[n]);if(this.header=new GY,HY.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=BK.string2buf(t.dictionary):"[object ArrayBuffer]"===zY.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=HY.inflateSetDictionary(this.strm,t.dictionary),n!==qY)))throw new Error(Pz[n])}function tq(e,t){const n=new eq(t);if(n.push(e),n.err)throw n.msg||Pz[n.err];return n.result}eq.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?YY:KY,"[object ArrayBuffer]"===zY.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),o=HY.inflate(n,a),o===JY&&i&&(o=HY.inflateSetDictionary(n,i),o===qY?o=HY.inflate(n,a):o===QY&&(o=JY));n.avail_in>0&&o===XY&&n.state.wrap>0&&0!==e[n.next_in];)HY.inflateReset(n),o=HY.inflate(n,a);switch(o){case ZY:case QY:case JY:case $Y:return this.onEnd(o),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||o===XY))if("string"===this.options.to){let e=BK.utf8border(n.output,n.next_out),t=n.next_out-e,i=BK.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==qY||0!==s){if(o===XY)return o=HY.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},eq.prototype.onData=function(e){this.chunks.push(e)},eq.prototype.onEnd=function(e){e===qY&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=FK.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var nq={Inflate:eq,inflate:tq,inflateRaw:function(e,t){return(t=t||{}).raw=!0,tq(e,t)},ungzip:tq,constants:kz};const{Deflate:rq,deflate:iq,deflateRaw:oq,gzip:aq}=tY,{Inflate:sq,inflate:cq,inflateRaw:lq,ungzip:dq}=nq;var uq=iq,hq=oq,pq=cq,mq=lq,fq=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(fq||{});class gq{constructor(){nR(this,"_sequence",0),nR(this,"_startTime",Date.now()),nR(this,"isUseOneByte",!0)}get startTime(){const e=Date.now()-this._startTime;return e<Math.pow(2,16)?e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(e){const t={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:e};if(e.byteLength>128){const n=new Uint8Array(4);n.set([1,0,0,0]);const r={id:0,length:4,data:n.buffer},i={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[r]};t.commonPacketHeader.extension=1,t.extension=i,t.payload=this.compress(e),t.commonPacketHeader.length=8+(t.extension.length+2)+t.payload.byteLength}else t.commonPacketHeader.length=8+t.payload.byteLength;SP("SHOW_DATASTREAM2_LOG")&&nk.debug("send data header: ".concat(JSON.stringify(t.commonPacketHeader)));const n=new ArrayBuffer(t.commonPacketHeader.length),r=new Uint8Array(n),i=new DataView(n);let o=0;if(i.setUint16(o,t.commonPacketHeader.extension<<15|t.commonPacketHeader.reserved<<14|t.commonPacketHeader.length,!0),o+=2,i.setUint32(o,t.commonPacketHeader.sequence,!0),o+=4,i.setUint16(o,t.commonStreamHeader,!0),o+=2,t.extension){const e=this.serializeExtension(t.extension);r.set(new Uint8Array(e),o),o+=e.byteLength}if(r.set(new Uint8Array(t.payload),o),o+=t.payload.byteLength,o!==t.commonPacketHeader.length)throw Error("serialize error!");return n}deserialize(e){if(e.byteLength<4)return new ArrayBuffer(0);const t=new DataView(e);let n=0;const r=t.getUint16(n,!0);n+=2;const i={length:16383&r,reserved:(16384&r)>>14,extension:(32768&r)>>15,sequence:t.getUint16(n+2,!0)<<16|t.getUint16(n,!0)};let o,a;if(n+=4,SP("SHOW_DATASTREAM2_LOG")&&nk.debug("receive data header: ".concat(JSON.stringify(i))),t.getUint16(n,!0),n+=2,i.extension){a=this.deserializeExtension(e.slice(n)),n+=2+a.length,o=e.slice(n);let t=!1;if(a.datas.length>0){const e=a.datas.find(e=>0===e.id);e&&(t=1==(1&new DataView(e.data).getUint32(0,!0)))}o=t?this.decompress(o):o}else o=e.slice(8);return o}serializeExtension(e){const{profile:t,length:n,datas:r}=e,i=new ArrayBuffer(n+2),o=new Uint8Array(i),a=new DataView(i);let s=0;if(a.setUint8(s++,t),a.setUint8(s++,n),r.forEach(e=>{t?(a.setUint8(s++,e.id),a.setUint8(s++,e.length),o.set(new Uint8Array(e.data),s),s+=e.data.byteLength):(a.setUint8(s++,e.id|e.length<<4),o.set(new Uint8Array(e.data),s),s+=e.data.byteLength)}),s!==n+2)throw Error("serialize extension error, is ".concat(s,"!==").concat(n+2));return i}deserializeExtension(e){const t=new DataView(e);let n=0;const r=t.getUint8(n);n++;const i=t.getUint8(n);n++;const o=r===fq.TWO_BYTE,a=[],s=new DataView(e,2);let c=0;for(;c<i;){let e=0,t=0,n=new ArrayBuffer(0);o?(e=s.getUint8(c),c++,t=s.getUint8(c),c++):(e=15&s.getUint8(c),t=s.getUint8(c)>>4,c++),t>0&&(n=s.buffer.slice(c+2,c+2+t),c+=n.byteLength),a.push({id:e,length:t,data:n})}if(c!==i)throw Error("parse error");return{profile:r,length:i,datas:a}}decompress(e){return pq(new Uint8Array(e))}compress(e){return uq(new Uint8Array(e))}}const _q={name:"DataStream",create:(e,t)=>{const n=t?new nM(e):new rM(e);return n.useDataStream(new gq),n}};class vq extends ON{constructor(e,t,n){super(),nR(this,"ws",void 0),nR(this,"requestId",1),nR(this,"heartBeatTimer",void 0),nR(this,"joinInfo",void 0),nR(this,"clientId",void 0),nR(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),nR(this,"onClose",e=>{this.emit("close"),this.dispose()}),nR(this,"onMessage",e=>{const t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(this.emit("status",t.serverStatus),void this.emit(t.serverStatus.command,t.serverStatus)):void 0;this.emit("req_".concat(t.requestId),t)}),this.joinInfo=e,this.clientId=t,this.ws=new $F("cross-channel-".concat(this.clientId),n),this.ws.on(HU.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(HU.CONNECTED,this.onOpen),this.ws.on(HU.ON_MESSAGE,this.onMessage),this.ws.on(HU.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(e){const t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new ip((t,n)=>{const r=window.setTimeout(()=>{n(new uk(hN.TIMEOUT,"wait status timeout, status: ".concat(e)))},5e3);this.once(e,i=>{window.clearTimeout(r),i.state&&0!==i.state?n(new uk(hN.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)}),this.once("dispose",()=>{window.clearTimeout(r),n(new uk(hN.WS_ABORT))})})}async request(e){if("closed"===this.ws.state)throw new uk(hN.WS_DISCONNECT);const t=()=>new ip((e,t)=>{this.ws.once(HU.CLOSED,()=>t(new uk(hN.WS_ABORT))),this.ws.once(HU.CONNECTED,e)});"connected"!==this.ws.state&&await t();const n=this.sendMessage(e),r=new ip((e,t)=>{const r=()=>{t(new uk(hN.WS_ABORT))};this.ws.once(HU.RECONNECTING,r),this.ws.once(HU.CLOSED,r),this.once("req_".concat(n),e),_O(3e3).then(()=>{this.removeAllListeners("req_".concat(n)),this.ws.off(HU.RECONNECTING,r),this.ws.off(HU.CLOSED,r),t(new uk(hN.TIMEOUT,"cross channel ws request timeout"))})}),i=await r;if(!i||200!==i.code)throw new uk(hN.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(i)));return i}async connect(e){this.ws.removeAllListeners(HU.REQUEST_NEW_URLS),this.ws.on(HU.REQUEST_NEW_URLS,t=>{t(e)}),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class bq extends ON{set state(e){e!==this._state&&(e!==rF.RELAY_STATE_FAILURE&&(this.errorCode=iF.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,t,n,r,i){super(),nR(this,"joinInfo",void 0),nR(this,"sid",void 0),nR(this,"clientId",void 0),nR(this,"cancelToken",EI.CancelToken.source()),nR(this,"workerToken",void 0),nR(this,"requestId",0),nR(this,"signal",void 0),nR(this,"prevChannelMediaConfig",void 0),nR(this,"httpRetryConfig",void 0),nR(this,"_resolution",void 0),nR(this,"_state",rF.RELAY_STATE_IDLE),nR(this,"errorCode",iF.RELAY_OK),nR(this,"onStatus",e=>{nk.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&this.emit("event",nF.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&this.emit("event",nF.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(this.errorCode=iF.SRC_TOKEN_EXPIRED,this.state=rF.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===e.command&&(this.errorCode=iF.DEST_TOKEN_EXPIRED,this.state=rF.RELAY_STATE_FAILURE))}),nR(this,"onReconnect",async()=>{nk.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",nF.NETWORK_DISCONNECTED),this.state=rF.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(e=>{this.state!==rF.RELAY_STATE_IDLE&&(nk.error("auto restart channel media relay failed",e.toString()),this.errorCode=iF.SERVER_CONNECTION_LOST,this.state=rF.RELAY_STATE_FAILURE)})}),this.joinInfo=e,this.clientId=t,this.sid=bO(),this.signal=new vq(this.joinInfo,this.clientId,n),this.httpRetryConfig=r,this._resolution=i}async startChannelMediaRelay(e){if(this.state!==rF.RELAY_STATE_IDLE)throw new uk(hN.INVALID_OPERATION);this.state=rF.RELAY_STATE_CONNECTING,await this.connect(),nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(e){if(e.data&&e.data.serverResponse&&"SetSourceChannel"===e.data.serverResponse.command)throw new uk(hN.CROSS_CHANNEL_FAILED_JOIN_SRC);if(e.data&&e.data.serverResponse&&"SetDestChannelStatus"===e.serverResponse.command)throw new uk(hN.CROSS_CHANNEL_FAILED_JOIN_DEST);if(e.data&&e.data.serverResponse&&"StartPacketTransfer"===e.serverResponse.command)throw new uk(hN.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);throw e}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==rF.RELAY_STATE_RUNNING)throw new uk(hN.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async setVideoProfile(e){if(this._resolution=e,this.state!==rF.RELAY_STATE_RUNNING)throw new uk(hN.INVALID_OPERATION);const t=this.genMessage(tF.SetVideoProfile);await this.signal.request(t),nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),nk.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=rF.RELAY_STATE_IDLE,this.dispose()}dispose(){nk.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=EI.CancelToken.source(),this.state=rF.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await qV(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",nF.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const t=this.genMessage(tF.SetSdkProfile,e);await this.signal.request(t),nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const n=this.genMessage(tF.SetSourceChannel,e);await this.signal.request(n),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",nF.PACKET_JOINED_SRC_CHANNEL),nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const r=this.genMessage(tF.SetSourceUserId,e);await this.signal.request(r),nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const i=this.genMessage(tF.SetDestChannel,e);await this.signal.request(i),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",nF.PACKET_JOINED_DEST_CHANNEL),nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const o=this.genMessage(tF.StartPacketTransfer,e);await this.signal.request(o),this.emit("event",nF.PACKET_SENT_TO_DEST_CHANNEL),this.state=rF.RELAY_STATE_RUNNING,nk.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(e){const t=this.genMessage(tF.UpdateDestChannel,e);await this.signal.request(t),this.emit("event",nF.PACKET_UPDATE_DEST_CHANNEL),nk.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(tF.StopPacketTransfer);await this.signal.request(e),nk.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){const n=[],r=[],i=[];this.requestId+=1;const o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:hP,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.24.2"===o.sdkVersion&&(o.sdkVersion="0.0.1");let a=null,s=null;switch(e){case tF.SetSdkProfile:return o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},o;case tF.SetSourceChannel:if(s=t&&t.getSrcChannelMediaInfo(),!s)throw new uk(hN.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:s.channelName,token:s.token||this.joinInfo.appId},o;case tF.SetSourceUserId:if(s=t&&t.getSrcChannelMediaInfo(),!s)throw new uk(hN.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceUserId",uid:s.uid+""},o;case tF.SetDestChannel:if(a=t&&t.getDestChannelMediaInfo(),!a)throw new uk(hN.UNEXPECTED_ERROR,"can not find dest config");return a.forEach(e=>{n.push(e.channelName),r.push(e.uid+""),i.push(e.token||this.joinInfo.appId)}),o.clientRequest={command:"SetDestChannel",channelName:n,uid:r,token:i},o;case tF.StartPacketTransfer:return o.clientRequest={command:"StartPacketTransfer"},o;case tF.Reconnect:return o.clientRequest={command:"Reconnect"},o;case tF.StopPacketTransfer:return o.clientRequest={command:"StopPacketTransfer"},o;case tF.UpdateDestChannel:if(a=t&&t.getDestChannelMediaInfo(),!a)throw new uk(hN.UNEXPECTED_ERROR,"can not find dest config");return a.forEach(e=>{n.push(e.channelName),r.push(e.uid+""),i.push(e.token||this.joinInfo.appId)}),o.clientRequest={command:"UpdateDestChannel",channelName:n,uid:r,token:i},o;case tF.SetVideoProfile:o.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return o}}const Eq={name:"ChannelMediaRelay",create:function(e){return new bq(e.joinInfo,e.clientId,e.websocketRetryConfig||xO,e.httpRetryConfig||xO,e.resolution)}};function yq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yq(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class Tq extends ON{constructor(e,t,n,r){super(),nR(this,"spec",void 0),nR(this,"token",void 0),nR(this,"websocket",void 0),nR(this,"pingpongTimer",void 0),nR(this,"reconnectMode","retry"),nR(this,"serviceMode",void 0),nR(this,"reqId",0),nR(this,"commandReqId",0),nR(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),nR(this,"handleWebSocketMessage",e=>{if(!e.data)return;const t=JSON.parse(e.data);t.requestId?this.emit("@".concat(t.requestId,"-").concat(t.sid),t):(dk.workerEvent(this.spec.sid,{actionType:"status",serverCode:t.code,workerType:this.serviceMode===KU.TRANSCODE?1:2}),this.emit(ZU.PUBLISH_STREAM_STATUS,t))}),this.spec=t,this.token=e,this.serviceMode=r,this.websocket=new $F("live-streaming",n),this.websocket.on(HU.CONNECTED,this.handleWebSocketOpen),this.websocket.on(HU.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(HU.REQUEST_NEW_URLS,(e,t)=>{YN(this,ZU.REQUEST_NEW_ADDRESS).then(e).catch(t)}),this.websocket.on(HU.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(e){return this.websocket.init(e)}async request(e,t,n,r){this.reqId+=1,"request"===e&&(this.commandReqId+=1);const i=this.commandReqId,o=this.reqId;if(!o||!this.websocket)throw new uk(hN.UNEXPECTED_ERROR);const a=Sq({command:e,sdkVersion:"4.24.2"===hP?"0.0.1":hP,seq:o,requestId:o,allocate:n,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t);if("closed"===this.websocket.state)throw new uk(hN.WS_DISCONNECT);const s=()=>new ip((e,t)=>{this.websocket.once(HU.CLOSED,()=>t(new uk(hN.WS_ABORT))),this.websocket.once(HU.CONNECTED,e)});"connected"!==this.websocket.state&&await s(),a.clientRequest&&(a.clientRequest.workerToken=this.token);const c=new ip((e,t)=>{const n=()=>{t(new uk(hN.WS_ABORT))};this.websocket.once(HU.RECONNECTING,n),this.websocket.once(HU.CLOSED,n),this.once("@".concat(o,"-").concat(this.spec.sid),t=>{e(t)})});r&&dk.workerEvent(this.spec.sid,Sq(Sq({},r),{},{requestId:i,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0}));const l=Date.now();this.websocket.sendMessage(a);let d=null;try{d=await c}catch(r){if("closed"===this.websocket.state)throw r;return await s(),await this.request(e,t,n)}return r&&dk.workerEvent(this.spec.sid,Sq(Sq({},r),{},{requestId:i,actionType:"response",payload:JSON.stringify(d.serverResponse),serverCode:d.code,success:200===d.code,responseTime:Date.now()-l})),200!==d.code&&this.handleResponseError(d),d}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e="4.24.2"===hP?"0.0.1":hP;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case $U.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void nk.warning("live stream response already exists stream");case $U.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case $U.LIVE_STREAM_RESPONSE_BAD_STREAM:case $U.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new uk(hN.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case $U.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command)return;throw new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case $U.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new uk(hN.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case $U.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const t=new uk(hN.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(ZU.WARNING,t,e.serverResponse.url)}case $U.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const t=new uk(hN.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(ZU.WARNING,t,e.serverResponse.url)}case $U.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case $U.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new uk(hN.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case $U.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const t=new uk(hN.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(ZU.WARNING,t,e.serverResponse.url)}case $U.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case $U.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case $U.LIVE_STREAM_RESPONSE_WORKER_LOST:case $U.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command)return;throw new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case $U.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command)return;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case $U.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case $U.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case $U.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case $U.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new uk(hN.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(EO)},6e3)}}function Cq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cq(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class Rq extends ON{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xO;super(),nR(this,"onLiveStreamWarning",void 0),nR(this,"onLiveStreamError",void 0),nR(this,"spec",void 0),nR(this,"retryTimeout",1e4),nR(this,"connection",void 0),nR(this,"httpRetryConfig",void 0),nR(this,"wsRetryConfig",void 0),nR(this,"streamingTasks",new Map),nR(this,"isStartingStreamingTask",!1),nR(this,"taskMutex",new kO("live-streaming")),nR(this,"cancelToken",EI.CancelToken.source()),nR(this,"transcodingConfig",void 0),nR(this,"uapResponse",void 0),nR(this,"lastTaskId",1),nR(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=n,this.wsRetryConfig=t}async setTranscodingConfig(e){const t=wq(wq({},JU),e);66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(nk.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(t.videoCodecProfile," -> 100")),t.videoCodecProfile=100),t.transcodingUsers||(t.transcodingUsers=t.userConfigs),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map(e=>wq(wq(wq({},YU),e),{},{zOrder:e.zOrder?e.zOrder+1:1}))),function(e){EN(e.width)||gN(e.width,"config.width",0,1e4),EN(e.height)||gN(e.height,"config.height",0,1e4),EN(e.videoBitrate)||gN(e.videoBitrate,"config.videoBitrate",1,1e6),EN(e.videoFrameRate)||gN(e.videoFrameRate,"config.videoFrameRate"),EN(e.lowLatency)||mN(e.lowLatency,"config.lowLatency"),EN(e.audioSampleRate)||fN(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),EN(e.audioBitrate)||gN(e.audioBitrate,"config.audioBitrate",1,128),EN(e.audioChannels)||fN(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),EN(e.videoGop)||gN(e.videoGop,"config.videoGop"),EN(e.videoCodecProfile)||fN(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),EN(e.userCount)||gN(e.userCount,"config.userCount",0,17),EN(e.backgroundColor)||gN(e.backgroundColor,"config.backgroundColor",0,16777215),EN(e.userConfigExtraInfo)||vN(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&!EN(e.transcodingUsers)&&(bN(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach((e,t)=>{zU(e.uid),EN(e.x)||gN(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),EN(e.y)||gN(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),EN(e.width)||gN(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),EN(e.height)||gN(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),EN(e.zOrder)||gN(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),EN(e.alpha)||gN(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)})),EN(e.watermark)||XU(e.watermark,"watermark"),EN(e.backgroundImage)||XU(e.backgroundImage,"backgroundImage"),e.images&&!EN(e.images)&&(bN(e.images,"config.images"),e.images.forEach((e,t)=>{XU(e,"images[".concat(t,"]"))}))}(t);const n=[];t.images&&n.push(...t.images.map(e=>wq(wq(wq({},qU),e),{},{zOrder:255}))),t.backgroundImage&&(n.push(wq(wq(wq({},qU),t.backgroundImage),{},{zOrder:0})),delete t.backgroundImage),t.watermark&&(n.push(wq(wq(wq({},qU),t.watermark),{},{zOrder:255})),delete t.watermark),t.images=n,t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map(e=>wq({},e)),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers);const r=(t.userConfigs||[]).map(e=>"number"==typeof e.uid?ip.resolve(e.uid):HV(e.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await ip.all(r)).forEach((e,n)=>{t.userConfigs&&t.userConfigs[n]&&(t.userConfigs[n].uid=e)}),this.transcodingConfig=t,this.connection)try{var i;const e=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(pp(i=this.streamingTasks).call(i)).map(e=>e.taskId).join("#")});nk.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(e.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(e){if(!e.data||!e.data.retry)throw e;e.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(t=>{nk.warning("[".concat(this.spec.clientId,"] live streaming receive error"),e.toString(),"try to republish",t.url),this.startLiveStreamingTask(t.url,t.mode,e).then(()=>{nk.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(t.url," success"))}).catch(e=>{nk.error("[".concat(this.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),this.onLiveStreamError&&this.onLiveStreamError(t.url,e)})})}}async startLiveStreamingTask(e,t,n){if(!this.transcodingConfig&&t===KU.TRANSCODE)throw new uk(hN.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const r={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};nk.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(t));const i=await this.taskMutex.lock();if(!this.connection&&n)return void i();if(this.streamingTasks.get(e)&&!n)return i(),new uk(hN.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(e){throw i(),e}switch(t){case KU.TRANSCODE:r.transcodingConfig=wq({},this.transcodingConfig);case KU.RAW:}this.uapResponse&&this.uapResponse.vid&&(r.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const o=this.lastTaskId++;try{const a=new ip((t,r)=>{_O(this.retryTimeout).then(()=>{if(n)return r(n);const t=this.statusError.get(e);return t?(this.statusError.delete(e),r(t)):void 0})}),s=await ip.race([this.connection.request("request",{clientRequest:r},!0,{url:e,command:"PublishStream",workerType:t===KU.TRANSCODE?1:2,requestByUser:!n,tid:o.toString()}),a]);this.isStartingStreamingTask=!1,nk.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(s.code)),this.streamingTasks.set(e,{clientRequest:r,mode:t,url:e,taskId:o}),i()}catch(r){if(i(),this.isStartingStreamingTask=!1,!r.data||!r.data.retry||n)throw r;return r.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,r)):await this.startLiveStreamingTask(e,t,r)}}stopLiveStreamingTask(e){return new ip((t,n)=>{const r=this.streamingTasks.get(e);if(!r||!this.connection)return new uk(hN.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const i=r.mode;r.abortTask=()=>{nk.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:r.url}},!1,{url:e,command:"UnPublishStream",workerType:i===KU.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(n=>{nk.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(n.code)),this.streamingTasks.delete(e),0===this.streamingTasks.size&&(this.connection&&this.connection.close(),this.connection=void 0),t()}).catch(n)})}resetAllTask(){var e;const t=Array.from(pp(e=this.streamingTasks).call(e));this.terminate();for(const n of t)this.startLiveStreamingTask(n.url,n.mode).catch(e=>{this.onLiveStreamError&&this.onLiveStreamError(n.url,e)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=EI.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new uk(hN.UNEXPECTED_ERROR,"live streaming connection has already connected");const t=await YN(this,QU.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new Tq(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(ZU.WARNING,(e,t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)),this.connection.on(ZU.PUBLISH_STREAM_STATUS,e=>this.handlePublishStreamServer(e)),this.connection.on(ZU.REQUEST_NEW_ADDRESS,(t,n)=>{if(!this.connection)return n(new uk(hN.UNEXPECTED_ERROR,"can not get new live streaming address list"));YN(this,QU.REQUEST_WORKER_MANAGER_LIST,e).then(e=>{this.uapResponse=e,t(e.addressList)}).catch(n)}),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){const t=e.serverStatus&&e.serverStatus.url||"empty_url",n=this.streamingTasks.get(t),r=e.reason;switch(e.code){case $U.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case $U.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case $U.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case $U.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const r=new uk(hN.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(n)return nk.error(r.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,r);if(!this.isStartingStreamingTask)return;this.statusError.set(t,r)}case $U.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const e=new uk(hN.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,r);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)}case $U.LIVE_STREAM_RESPONSE_WORKER_LOST:case $U.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var i;if(!this.connection)return;this.connection.tryNextAddress();const t=Array.from(pp(i=this.streamingTasks).call(i));for(const n of t)n.abortTask?n.abortTask():(nk.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",n.url),this.startLiveStreamingTask(n.url,n.mode,new uk(hN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then(()=>{nk.debug("[".concat(this.spec.clientId,"] republish live stream success"),n.url)}).catch(e=>{nk.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(n.url,e)}));return}}}hasUrl(e){return this.streamingTasks.has(e)}}const Aq={name:"LiveStreaming",create:function(e){return new Rq(e.joinInfo,e.websocketRetryConfig||xO,e.httpRetryConfig||xO)}};function Iq(e){let t=jq();return function(e,t){let n=e.appId;void 0!==n&&($q(t,10),Kq(t,n));let r=e.cid;void 0!==r&&($q(t,16),$q(t,r));let i=e.cname;void 0!==i&&($q(t,26),Kq(t,i));let o=e.deviceId;void 0!==o&&($q(t,34),Kq(t,o));let a=e.elapse;void 0!==a&&($q(t,40),eX(t,a));let s=e.fileSize;void 0!==s&&($q(t,48),eX(t,Uq(s)));let c=e.height;void 0!==c&&($q(t,56),eX(t,Uq(c)));let l=e.jpg;void 0!==l&&($q(t,66),$q(t,l.length),function(e,t){let n=Hq(e,t.length);e.bytes.set(t,n)}(t,l));let d=e.networkType;void 0!==d&&($q(t,72),eX(t,Uq(d)));let u=e.osType;void 0!==u&&($q(t,80),eX(t,Uq(u)));let h=e.requestId;void 0!==h&&($q(t,90),Kq(t,h));let p=e.sdkVersion;void 0!==p&&($q(t,98),Kq(t,p));let m=e.sequence;void 0!==m&&($q(t,104),eX(t,Uq(m)));let f=e.sid;void 0!==f&&($q(t,114),Kq(t,f));let g=e.timestamp;void 0!==g&&($q(t,120),eX(t,g));let _=e.uid;void 0!==_&&($q(t,128),$q(t,_));let v=e.vid;void 0!==v&&($q(t,136),$q(t,v));let b=e.width;void 0!==b&&($q(t,144),eX(t,Uq(b)));let E=e.service;void 0!==E&&($q(t,152),$q(t,E));let y=e.callbackData;void 0!==y&&($q(t,162),Kq(t,y));let S=e.jpgEncryption;void 0!==S&&($q(t,168),$q(t,S));let T=e.requestType;void 0!==T&&($q(t,176),$q(t,T));let C=e.scorePorn;void 0!==C&&($q(t,185),Zq(t,C));let w=e.scoreSexy;void 0!==w&&($q(t,193),Zq(t,w));let R=e.scoreNeutral;void 0!==R&&($q(t,201),Zq(t,R));let A=e.scene;void 0!==A&&($q(t,208),$q(t,A));let I=e.ossFilePrefix;void 0!==I&&($q(t,218),Kq(t,I));let N=e.serviceVendor;if(void 0!==N)for(let O of N){$q(t,226);let e=jq();Pq(O,e),$q(t,e.limit),Yq(t,e),Vq(e)}}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}function Nq(e){return function(e){let t={};e:for(;!Wq(e);){let n=Qq(e);switch(n>>>3){case 0:break e;case 1:t.code=Qq(e);break;case 2:t.msg=zq(e,Qq(e));break;case 3:{let n=kq(e);t.data=Oq(e),e.limit=n;break}default:Dq(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}function Oq(e){let t={};e:for(;!Wq(e);){let n=Qq(e);switch(n>>>3){case 0:break e;case 1:t.requestId=zq(e,Qq(e));break;case 2:t.requestType=Qq(e)>>>0;break;case 3:t.scorePorn=Jq(e);break;case 4:t.scoreSexy=Jq(e);break;case 5:t.scoreNeutral=Jq(e);break;case 6:t.requestScene=Qq(e)>>>0;break;case 7:t.scene=Qq(e)>>>0;break;default:Dq(e,7&n)}}return t}function Pq(e,t){let n=e.service;void 0!==n&&($q(t,8),$q(t,n));let r=e.vendor;void 0!==r&&($q(t,16),$q(t,r));let i=e.token;void 0!==i&&($q(t,26),Kq(t,i));let o=e.callbackUrl;void 0!==o&&($q(t,34),Kq(t,o))}function kq(e){let t=Qq(e),n=e.limit;return e.limit=e.offset+t,n}function Dq(e,t){switch(t){case 0:for(;128&qq(e););break;case 2:Bq(e,Qq(e));break;case 5:Bq(e,4);break;case 1:Bq(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let xq=new Float32Array(1);new Uint8Array(xq.buffer);let Lq=new Float64Array(1),Mq=new Uint8Array(Lq.buffer);function Uq(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let Fq=[];function jq(){const e=Fq.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function Vq(e){Fq.push(e)}function Bq(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function Wq(e){return e.offset>=e.limit}function Hq(e,t){let n=e.bytes,r=e.offset,i=e.limit,o=r+t;if(o>n.length){let t=new Uint8Array(2*o);t.set(n),e.bytes=t}return e.offset=o,o>i&&(e.limit=o),r}function Gq(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function zq(e,t){let n=Gq(e,t),r=String.fromCharCode,i=e.bytes,o="\ufffd",a="";for(let s=0;s<t;s++){let e,c,l,d,u=i[s+n];0==(128&u)?a+=r(u):192==(224&u)?s+1>=t?a+=o:(e=i[s+n+1],128!=(192&e)?a+=o:(d=(31&u)<<6|63&e,d<128?a+=o:(a+=r(d),s++))):224==(240&u)?s+2>=t?a+=o:(e=i[s+n+1],c=i[s+n+2],32896!=(49344&(e|c<<8))?a+=o:(d=(15&u)<<12|(63&e)<<6|63&c,d<2048||d>=55296&&d<=57343?a+=o:(a+=r(d),s+=2))):240==(248&u)?s+3>=t?a+=o:(e=i[s+n+1],c=i[s+n+2],l=i[s+n+3],8421504!=(12632256&(e|c<<8|l<<16))?a+=o:(d=(7&u)<<18|(63&e)<<12|(63&c)<<6|63&l,d<65536||d>1114111?a+=o:(d-=65536,a+=r(55296+(d>>10),56320+(1023&d)),s+=3))):a+=o}return a}function Kq(e,t){let n=t.length,r=0;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),r+=e<128?1:e<2048?2:e<65536?3:4}$q(e,r);let i=Hq(e,r),o=e.bytes;for(let a=0;a<n;a++){let e=t.charCodeAt(a);e>=55296&&e<=56319&&a+1<n&&(e=(e<<10)+t.charCodeAt(++a)-56613888),e<128?o[i++]=e:(e<2048?o[i++]=e>>6&31|192:(e<65536?o[i++]=e>>12&15|224:(o[i++]=e>>18&7|240,o[i++]=e>>12&63|128),o[i++]=e>>6&63|128),o[i++]=63&e|128)}}function Yq(e,t){let n=Hq(e,t.limit),r=e.bytes,i=t.bytes;for(let o=0,a=t.limit;o<a;o++)r[o+n]=i[o]}function qq(e){return e.bytes[Gq(e,1)]}function Xq(e,t){let n=Hq(e,1);e.bytes[n]=t}function Jq(e){let t=Gq(e,8),n=e.bytes;return Mq[0]=n[t++],Mq[1]=n[t++],Mq[2]=n[t++],Mq[3]=n[t++],Mq[4]=n[t++],Mq[5]=n[t++],Mq[6]=n[t++],Mq[7]=n[t++],Lq[0]}function Zq(e,t){let n=Hq(e,8),r=e.bytes;Lq[0]=t,r[n++]=Mq[0],r[n++]=Mq[1],r[n++]=Mq[2],r[n++]=Mq[3],r[n++]=Mq[4],r[n++]=Mq[5],r[n++]=Mq[6],r[n++]=Mq[7]}function Qq(e){let t,n=0,r=0;do{t=qq(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function $q(e,t){for(t>>>=0;t>=128;)Xq(e,127&t|128),t>>>=7;Xq(e,t)}function eX(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=0===i?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10,a=Hq(e,o),s=e.bytes;switch(o){case 10:s[a+9]=i>>>7&1;case 9:s[a+8]=9!==o?128|i:127&i;case 8:s[a+7]=8!==o?r>>>21|128:r>>>21&127;case 7:s[a+6]=7!==o?r>>>14|128:r>>>14&127;case 6:s[a+5]=6!==o?r>>>7|128:r>>>7&127;case 5:s[a+4]=5!==o?128|r:127&r;case 4:s[a+3]=4!==o?n>>>21|128:n>>>21&127;case 3:s[a+2]=3!==o?n>>>14|128:n>>>14&127;case 2:s[a+1]=2!==o?n>>>7|128:n>>>7&127;case 1:s[a]=1!==o?128|n:127&n}}function tX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}const nX=new Map([["moderation",1],["supervise",2]]);class rX extends ON{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(RF.CONNECTION_STATE_CHANGE,t,e)}get inspectType(){return this._inspectType}set inspectType(e){var t;this._inspectMode=ii(t=e.map(e=>nX.get(e)||0)).call(t,(e,t)=>e+t),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(e){super(),nR(this,"name","AgoraRTCVideoContentInspect"),nR(this,"_connectionState",CF.CONNECTING),nR(this,"_innerConnectionState",void 0),nR(this,"sequence",0),nR(this,"inspectStartTime",void 0),nR(this,"workerManagerConnection",void 0),nR(this,"workerConnection",void 0),nR(this,"workerMessageLengthLimit",void 0),nR(this,"inspectIntervalMinimum",void 0),nR(this,"qualityRatio",void 0),nR(this,"_connectInfo",void 0),nR(this,"_cancelTokenSource",EI.CancelToken.source()),nR(this,"_retryConfig",void 0),nR(this,"wmSequence",0),nR(this,"inspectInterval",void 0),nR(this,"inspectTimer",null),nR(this,"ossFilePrefix",void 0),nR(this,"extraInfo",void 0),nR(this,"_inspectType",void 0),nR(this,"_inspectMode",void 0),nR(this,"_quality",1),nR(this,"qualityTimer",null),nR(this,"_inspectId",void 0),nR(this,"_needWorkUrlOnly",!1),nR(this,"inspectImage",()=>{if(this.connectionState!==CF.CONNECTED)throw new uk(hN.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===CF.CONNECTED?this.requestToInspectImage():nk.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=vO(5,"inspect-"),this.workerMessageLengthLimit=SP("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=SP("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=SP("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new $F("worker-manager-"+this._inspectId,xO),this.on(RF.STATE_CHANGE,(e,t)=>{this._innerConnectionState=e,nk.debug("[".concat(this._inspectId,"] Inspect operation :").concat(wF[e]," ").concat(t||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new $F("worker-"+this._inspectId,xO),this.handleWorkerEvents()}async init(e,t){this.emit(RF.STATE_CHANGE,wF.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new ip((r,i)=>{this.on(RF.CONNECTION_STATE_CHANGE,(e,t)=>{t===CF.CONNECTED&&r()}),this.requestAP(e,n,t).then(e=>{this.connectWorkerManager(e)}).catch(e=>{i(e)})})}async requestAP(e,t,n){const r=SP("WEBCS_DOMAIN").map(e=>"https://".concat(e,"/api/v1")),i=await function(e,t,n,r){let{appId:i,areaCode:o,cname:a,sid:s,token:c,uid:l}=t;MV++;const d="image_moderation_api",u={service_name:d,json_body:JSON.stringify({appId:i,areaCode:o,cname:a,command:"allocateEdge",requestId:MV,seq:MV,sid:s,token:c,ts:Date.now(),uid:l+""})};let h,p,m=e[0];return MO(async()=>{h=Date.now();const e=await mV(m,{data:u,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(p=Date.now()-h,0!==e.code){const t=new uk(hN.UNEXPECTED_RESPONSE,"image inspect ap error, code"+e.code,{retry:!0,responseTime:p});throw nk.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new uk(hN.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:p});throw nk.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new uk(hN.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:t.code,responseTime:p});throw nk.error(e.toString()),e}const r=SP("VIDEO_INSPECT_WORKER_MANAGER_WSS");if(r)return{addressList:[r],workerToken:t.workerToken,vid:t.vid,responseTime:p};const i=SP("VIDEO_INSPECT_WORKER_MANAGER_HOST"),o=SP("VIDEO_INSPECT_WORKER_MANAGER_PORT"),a=t.servers.map(e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(i,":").concat(o||n)}).filter(e=>!!e);return{addressList:a,workerToken:t.workerToken,vid:t.vid,responseTime:p}},(t,n)=>(dk.apworkerEvent(s,{success:!0,sc:200,serviceName:d,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:p,serverIp:e[n%e.length]}),!1),(t,n)=>(dk.apworkerEvent(s,{success:!1,sc:t.data&&t.data.code||200,serviceName:d,responseTime:p,serverIp:e[n%e.length]}),!!(t.code!==hN.OPERATION_ABORTED&&t.code!==hN.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(m=e[(n+1)%e.length],!0)),r)}(r,e,t,n);this.emit(RF.STATE_CHANGE,wF.AP_CONNECTED);const{addressList:o}=i;return this.wmSequence++,o}async connectWorkerManager(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._needWorkUrlOnly=t,this.emit(RF.STATE_CHANGE,wF.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(HU.CONNECTED,async()=>{this.emit(RF.STATE_CHANGE,wF.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.24.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(HU.CLOSED,()=>{this._innerConnectionState<wF.GET_WORKER_MANAGER_RESPONSE&&nk.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(HU.FAILED,()=>{this._innerConnectionState<wF.GET_WORKER_MANAGER_RESPONSE&&nk.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(HU.RECONNECTING,()=>{this._innerConnectionState<wF.GET_WORKER_MANAGER_RESPONSE&&nk.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(HU.ON_MESSAGE,async e=>{this.emit(RF.STATE_CHANGE,wF.GET_WORKER_MANAGER_RESPONSE);const t=this.workerManagerConnection.url;this.workerManagerConnection.close();const n=JSON.parse(e.data);if(200!==n.code)throw nk.error("[".concat(this._inspectId,"] Unexpected code ").concat(n.code," from worker manager")),new uk(hN.UNEXPECTED_RESPONSE,"response code of worker is unexpected",n);if(!(n.serverResponse&&n.serverResponse.portWss&&t))throw nk.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(n))),new uk(hN.UNEXPECTED_RESPONSE,"response content of worker is unexpected",n);{const e=SP("VIDEO_INSPECT_WORKER_PORT")||n.serverResponse.portWss,r=t.replace(/:\d+\/?$/,":".concat(e));this.emit(RF.STATE_CHANGE,wF.CONNECT_WORKER,r),this._needWorkUrlOnly?this.emit(RF.REQUEST_NEW_WORKER_URL,r):await this.connectWorker(r)}}),this.workerManagerConnection.on(HU.WILL_RECONNECT,(e,t,n)=>{n(e)}),this.workerManagerConnection.on(HU.REQUEST_NEW_URLS,(e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)})}handleWorkerEvents(){this.workerConnection.on(HU.CONNECTED,async()=>{this.emit(RF.STATE_CHANGE,wF.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=CF.CONNECTED}),this.workerConnection.on(HU.ON_MESSAGE,async e=>{if(e.data instanceof ArrayBuffer){const n=Nq(new Uint8Array(e.data));if(SP("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&nk.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(n)),200===n.code){if(Array.isArray(this.inspectType)&&1===this.inspectType.length&&"supervise"===this.inspectType[0])return void this.emit(RF.INSPECT_RESULT,void 0,void 0);if(n.data&&n.data.scorePorn&&n.data.scoreSexy&&n.data.scoreNeutral){var t;const e={porn:n.data.scorePorn,sexy:n.data.scoreSexy,neutral:n.data.scoreNeutral},r=ii(t=Object.keys(e)).call(t,(t,n)=>e[t]>e[n]?t:n,"porn"),i=Object.keys(e).find(e=>e===r);this.emit(RF.INSPECT_RESULT,i)}else this.emit(RF.INSPECT_RESULT,void 0,new uk(hN.UNEXPECTED_RESPONSE,n.code+"","There is an unexpected data on message"))}else this.emit(RF.INSPECT_RESULT,void 0,new uk(hN.UNEXPECTED_RESPONSE,n.code+"",n.msg))}else nk.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(RF.INSPECT_RESULT,void 0,new uk(hN.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(HU.CLOSED,()=>{this.connectionState=CF.CLOSED}),this.workerConnection.on(HU.FAILED,()=>{this.connectionState=CF.CLOSED}),this.workerConnection.on(HU.RECONNECTING,()=>{this.connectionState=this.connectionState===CF.CONNECTED?CF.RECONNECTING:CF.CONNECTING}),this.workerConnection.on(HU.WILL_RECONNECT,(e,t,n)=>{"recover"===e&&n(e),n("tryNext")}),this.workerConnection.on(HU.REQUEST_NEW_URLS,(e,t)=>{this.workerManagerConnection.close(),this.once(RF.REQUEST_NEW_WORKER_URL,t=>{e([t])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e=>{this.connectWorkerManager(e,!0)}).catch(e=>{t(e)})})}async requestToInspectImage(){this.sequence++;const e=XN(this,RF.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(RF.INSPECT_RESULT,void 0,new uk(hN.INVALID_OPERATION,"Only the track being played can be inspected"));const n=await this.generateRequestData(e,t);this.workerConnection.sendMessage(n,!0,!0)}else this.emit(RF.INSPECT_RESULT,void 0,new uk(hN.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,t){let{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s}=t;const c=Date.now(),l=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await ZD(l,n,r),u=this.sequence+"-"+i+"-"+s+"-"+c+"-"+vO(12,""),h={appId:n,cid:i,cname:r,deviceId:"",elapse:(p=Number(c-this.inspectStartTime),{low:p|=0,high:p>>31,unsigned:p>=0}),fileSize:d.byteLength,jpgEncryption:2,height:l.height,width:l.width,jpg:d,networkType:6,osType:7,requestId:u,sdkVersion:"4.24.2",sequence:this.sequence,sid:a,timestamp:IH(c),uid:s,vid:o,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var p;void 0===this.extraInfo&&delete h.callbackData,void 0===this.ossFilePrefix&&delete h.ossFilePrefix;const m=Iq(h);if(m.byteLength<this.workerMessageLengthLimit){if(SP("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tX(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},h);delete e.jpg,nk.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(e))}return m}{const t=this.quality*this.qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:i,vid:o,sid:a,uid:s})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=EI.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=CF.CLOSED,this.emit(RF.STATE_CHANGE,wF.CLOSED)}}const iX={name:"ContentInspect",create:function(e){let{config:t}=e;return function(e){if(!e)throw new uk(hN.INVALID_PARAMS,"inspectConfig is necessary.");if(!e.inspectType||!Array.isArray(e.inspectType))throw new uk(hN.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const t=[...new Set(e.inspectType)];t.forEach(e=>{var t;if(!xr(t=["supervise","moderation"]).call(t,e))throw new uk(hN.INVALID_PARAMS,"".concat(e," is not a valid inspect type."))}),e.inspectType=t}if(e&&e.extraInfo&&e.extraInfo.length>1024)throw new uk(hN.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new rX(t)}};var oX=r(ee.Object.getOwnPropertySymbols),aX=Pn,sX=Jn.indexOf,cX=Gr,lX=w([].indexOf),dX=!!lX&&1/lX([1],1,-0)<0;aX({target:"Array",proto:!0,forced:dX||!cX("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return dX?lX(this,e,t)||0:sX(this,e,t)}});var uX=er("Array","indexOf"),hX=u,pX=uX,mX=Array.prototype,fX=function(e){var t=e.indexOf;return e===mX||hX(mX,e)&&t===mX.indexOf?pX:t},gX=r(fX);function _X(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==gX(t).call(t,r))continue;n[r]=e[r]}return n}(e,t);if(oX){var o=oX(e);for(r=0;r<o.length;r++)n=o[r],-1===gX(t).call(t,n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}let vX=class{get localCapabilities(){return aO(this._localCapabilities)}get rtpCapabilities(){return aO(this._rtpCapabilities)}get candidates(){return aO(this._candidates)}get iceParameters(){return aO(this._iceParameters)}get dtlsParameters(){return aO(this._dtlsParameters)}constructor(e){nR(this,"sessionDesc",void 0),nR(this,"_localCapabilities",void 0),nR(this,"_rtpCapabilities",void 0),nR(this,"_candidates",void 0),nR(this,"_iceParameters",void 0),nR(this,"_dtlsParameters",void 0),nR(this,"setup",void 0),nR(this,"currentMidIndex",void 0),nR(this,"cname","o/i14u9pJrxRKAsu"),nR(this,"firefoxSsrcMidMap",new Map),e=aO(e);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:r,remoteRTPCapabilities:i,localCapabilities:o,direction:a,setup:s,videoCodec:c,audioCodec:l}=e;let d;this.setup=s,d=a===WU.RECEIVE_ONLY?DP("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"):DP("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"),this._rtpCapabilities=i,this._candidates=r,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=o;const u=a===WU.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,h=a===WU.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,p=a===WU.RECEIVE_ONLY?i.send.videoCodecs:Kj(_F.VIDEO,u,h,c),m=a===WU.RECEIVE_ONLY?i.send.audioCodecs:Kj(_F.AUDIO,u,h,l);for(const f of d.mediaDescriptions)f.attributes.iceUfrag=t.iceUfrag,f.attributes.icePwd=t.icePwd,f.attributes.fingerprints=n.fingerprints,f.attributes.candidates=r,f.attributes.setup=this.setup,"application"===f.media.mediaType&&(f.attributes.sctpPort="5000"),"video"===f.media.mediaType&&(f.media.fmts=p.map(e=>e.payloadType.toString(10)),f.attributes.payloads=p,f.attributes.extmaps=u.videoExtensions),"audio"===f.media.mediaType&&(f.media.fmts=m.map(e=>e.payloadType.toString(10)),f.attributes.payloads=m,f.attributes.extmaps=u.audioExtensions,zj(f));this.sessionDesc=d,this.currentMidIndex=d.mediaDescriptions.length-1}toString(){return xP(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every(e=>this.hasMid(e)):this.sessionDesc.mediaDescriptions.some(t=>t.attributes.mid===e)}send(e,t,n,r,i){n=n.replace(/ /g,"-");const{ssrcs:o,ssrcGroups:a}=Dj(t,this.cname,SP("SYNC_GROUP")?n:void 0),s=this.findPreloadMediaDesc(o);if(s){if(VI()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,s.attributes.mid),i&&(i.twcc||i.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,i),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,o,r);let n;return-1===t?(n=this.createOrRecycleSendMedia(e,o,a,"sendonly",r,i),this.updateBundleMids()):(n=aO(this.sessionDesc.mediaDescriptions[t]),n.attributes.direction="sendonly",n.attributes.ssrcs=o,n.attributes.ssrcGroups=a,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(n,i)),VI()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,n.attributes.mid),{needExchangeSDP:!0,mid:n.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(e=>{e.attributes.ssrcs=[]}),this.updateBundleMids()}receive(e,t,n){const r=[];return e.forEach(e=>{const i=e._mediaStreamTrack.kind,o=this.findAvailableRecvMediaIndex(i);let a,s=!1;-1===o?(s=!0,a=this.createOrRecycleRecvMedia(e,[],"recvonly",t,n),this.updateBundleMids()):(a=aO(this.sessionDesc.mediaDescriptions[o]),a.attributes.direction="recvonly"),r.push({mid:a.attributes.mid,needCreateTransceiver:s})}),r}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>-1!==e.indexOf(t.attributes.mid));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(e=>{e.media.port="0",e.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:n,address:r,port:i,type:o,relatedAddress:a,relatedPort:s,priority:c}=new RTCIceCandidate(e),l={foundation:null!=t?t:"",componentId:"1",transport:null!=n?n:"",priority:c?c+"":"",connectionAddress:null!=r?r:"",port:i?i+"":"",type:o?o+"":"",relAddr:null!=a?a:"",relPort:s?s+"":"",extension:{}};this.candidates.some(e=>e.priority===l.priority&&e.connectionAddress===l.connectionAddress&&e.port===l.port)||(this._candidates.push(l),this.sessionDesc.mediaDescriptions.forEach(e=>{e.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,n,r,i){const o=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,s=Kj(o,a,this.localCapabilities.send,o===_F.AUDIO?i:r),c=o===_F.VIDEO?a.videoExtensions:a.audioExtensions,l="".concat(++this.currentMidIndex);let d={media:{mediaType:o,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map(e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};d=this.mungRecvMediaDsec(d,e);const u=this.findFirstClosedMedia(o);if(u){const e=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[e]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>xr(e).call(e,t.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(e=>{e.attributes.direction="inactive"})}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(t=>xr(e).call(e,t.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(e=>{e.attributes.direction="recvonly"})}findAvailableMediaIndex(e,t,n){return this.sessionDesc.mediaDescriptions.findIndex(r=>{const i=r.media.mediaType===e&&"0"!==r.media.port&&("sendonly"===r.attributes.direction||"sendrecv"===r.attributes.direction)&&0===r.attributes.ssrcs.length;if(VI()){if(i){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==r.attributes.mid&&"1"!==r.attributes.mid)||!(!e||e!==r.attributes.mid)}return!1}return i&&r.attributes.mid===n})}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(t=>{const n=t.media.mediaType===e&&"0"!==t.media.port&&("recvonly"===t.attributes.direction||"sendrecv"===t.attributes.direction);return"0"!==t.attributes.mid&&"1"!==t.attributes.mid&&n})}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}restartICE(e){e=aO(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}createOrRecycleSendMedia(e,t,n,r,i,o){const a=this.rtpCapabilities.send,s=e===_F.VIDEO?a.videoCodecs:a.audioCodecs,c=e===_F.VIDEO?a.videoExtensions:a.audioExtensions;VI()&&(i="".concat(++this.currentMidIndex));let l={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map(e=>e.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:i}};l=this.mungSendMediaDesc(l,o);const d=this.findFirstClosedMedia(e);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}mungRecvMediaDsec(e,t,n){const r=aO(e);return Lj(r),xj(r,t),Mj(r,t),Uj(r),Fj(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=aO(e);return Fj(n,t,this.localCapabilities.recv),zj(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex(t=>t.attributes.mid===e);if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>"0"!==e.media.port).map(e=>e.attributes.mid)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId})}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>VI()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port)}};const bX=["sdp"];var EX;function yX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function SX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yX(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let TX=(EX=class e extends fF{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[]}set isInRestartIce(e){this._isInRestartIce=e}get isInRestartIce(){return this._isInRestartIce}constructor(t,n,r){super(t,n),nR(this,"direction",void 0),nR(this,"name",void 0),nR(this,"store",void 0),nR(this,"spec",void 0),nR(this,"peerConnection",void 0),nR(this,"initialOffer",void 0),nR(this,"transport",void 0),nR(this,"statsFilter",void 0),nR(this,"localCandidateCount",0),nR(this,"_isInRestartIce",!1),nR(this,"mutex",void 0),nR(this,"onLocalCandidate",void 0),nR(this,"remoteSDP",void 0),nR(this,"pendingCandidates",[]),nR(this,"localCapabilities",void 0),nR(this,"isReady",!1),nR(this,"restartCnt",0),nR(this,"curTurnServerIndex",0),this.store=n,this.spec=t,this.mutex=new kO("P2PConnection-mutex",n.clientId),this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t,n.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=null!=r?r:WU.SEND_ONLY,this.name=this.direction===WU.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=lP(this.peerConnection,SP("STATS_UPDATE_INTERVAL"),void 0,VI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(e){try{const t=await Bj();if(this.localCapabilities=Gj(t),e){const{sdp:t}=e,n=_X(e,bX),r=function(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=Ij(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"sendonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Hj(t,e,"videoExtensions",n,r,i),Hj(t,e,"videoCodecs",n,r,i),Hj(t,e,"audioExtensions",n,r,i),Hj(t,e,"audioCodecs",n,r,i),SP("RAISE_H264_BASELINE_PRIORITY")){const e=i.videoCodecs.findIndex(e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]);if(-1!==e){const t=i.videoCodecs.findIndex(e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase());if(t<e){nk.debug("raising H264 baseline profile priority");const n=i.videoCodecs[e];i.videoCodecs.splice(e,1),i.videoCodecs.splice(t,0,n)}-1!==t&&SP("FILTER_SEND_H264_BASELINE")&&(n.videoCodecs=n.videoCodecs.filter(e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"])))}}return{send:n,recv:r,sendrecv:i}}({},{},t);this.remoteSDP=new vX({remoteIceParameters:n.iceParameters,remoteDtlsParameters:n.dtlsParameters,candidates:[],remoteRTPCapabilities:r,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const i=await this.peerConnection.createAnswer();if(!i.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const o=Nj(i.sdp);await this.peerConnection.setLocalDescription(i);const a=await Wj({},{},i.sdp);this.localCapabilities=Gj(a);const s=this.peerConnection.getTransceivers()[0];return null!=s&&s.receiver&&s.receiver.transport&&this.tryBindTransportEvents(s.receiver.transport),SX(SX({},o),{},{sdp:i.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=Nj(e.sdp);return this.initialOffer=e,SX(SX({},t),{},{sdp:e.sdp})}}catch(e){throw new pN(hN.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:t,iceParameters:n,dtlsParameters:r}=e,i=await Wj({},{},t);this.remoteSDP=new vX({remoteIceParameters:n,remoteDtlsParameters:r,candidates:[],remoteRTPCapabilities:i,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const o=this.peerConnection.getTransceivers()[0];null!=o&&o.sender&&o.sender.transport&&this.tryBindTransportEvents(o.sender.transport)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async addRemoteCandidate(e){try{e&&this.pendingCandidates.push(e),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(e=>{this.peerConnection.addIceCandidate(e)}),this.pendingCandidates=[])}catch(e){throw new pN(hN.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return LA(function*(){const i=yield UA(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const i=[],o=r.remoteSDP.receive(e,t,n);e.forEach((e,t)=>{if(o[t].needCreateTransceiver){const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});i.push(t),e._updateRtpTransceiver(t)}else{const n=r.peerConnection.getTransceivers().find(e=>e.mid===o[t].mid);if(!n)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(o[t].mid));i.push(n),e._updateRtpTransceiver(n)}}),VI()&&!0===SP("SIMULCAST")&&(yield UA(r.applySimulcastForFirefox(i,e)));const a=o.map(e=>e.mid),s=yield UA(r.peerConnection.createOffer()),c=r.mungSendOfferSDP(s.sdp,e,a),l=DP(c),d=a.map(e=>{const t=l.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return Oj(t,SP("USE_PUB_RTX"))}),u=i.map((e,t)=>{const n=a[t];return{localSSRC:d[t],id:n}});yield UA(r.peerConnection.setLocalDescription({type:"offer",sdp:c}));try{yield u}catch(e){const n=r.remoteSDP.toString();throw yield UA(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield UA(r.peerConnection.setRemoteDescription({type:"answer",sdp:n})),yield UA(r.stopSending(a,!0)),e}yield UA(r.applySimulcastEncodings(i,e)),yield UA(r.applySendEncodings(i,e));const h=r.remoteSDP.toString(),p=r.logSDPExchange(c,"offer","local","send");return null==p||p(h),yield UA(r.setRemoteDescription({type:"answer",sdp:h})),i.map((e,t)=>{const n=a[t];return{localSSRC:d[t],id:n}})}catch(e){throw e instanceof pN?e:new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}})()}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter(t=>-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length (".concat(t.length,") doesn't match mids' length (").concat(e.length,") when trying to call P2PConnection.stopSending."));t.map(e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const i=this.remoteSDP.toString();null==r||r(i),await this.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);if(o){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(r.sdp,i,e);null==n||n(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),nk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else nk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const a=this.peerConnection.getTransceivers().find(e=>e.mid===i);if(!a||null===a.mid)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,mid:a.mid,transceiver:a}}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async mockReceive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);if(o){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(r.sdp,i,e);null==n||n(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),nk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else nk.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."))}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===mP.Auto&&(this.store.p2pTransport=mP.SdRtn,pk().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,pk().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:t}=Nj(e.sdp);return this.store.descriptionStart(),this.direction===WU.SEND_ONLY&&await this.peerConnection.setLocalDescription(e),t}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===WU.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const e=await this.peerConnection.createAnswer();if(!e.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:t}=Nj(e.sdp);return await this.peerConnection.setLocalDescription(e),t}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}close(){var e;this.peerConnection.close(),this.peerConnection.onicecandidate=null,null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const i=this.remoteSDP.toString(),o=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==o||o(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter(t=>t.mid===e);1===n.length&&(this.isVP8Simulcast(t)?VI()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find(e=>e.mid===t);n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:SX(SX({},YO),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:SX(SX({},YO),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e,t;xr(e=["connected","completed"]).call(e,this.peerConnection.iceConnectionState)&&(this.isReady=!1),null===(t=this.onICEConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;"connected"===this.peerConnection.connectionState&&(this.restartCnt=0),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=e=>{var t;e.candidate?(e.candidate.candidate&&(null===(t=this.onLocalCandidate)||void 0===t||t.call(this,e.candidate.toJSON())),this.localCandidateCount+=1):nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i={iceServers:[]};var o;return t.iceServers?i.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(FN(t.turnServer.servers)?i.iceServers=t.turnServer.servers:(i.iceServers&&i.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers,n,r)),SP("USE_TURN_SERVER_OF_GATEWAY")&&i.iceServers&&t.turnServer.serversFromGateway&&i.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway,n,r)),xr(o=[mP.Relay,mP.SdRtn]).call(o,n)&&(i.iceTransportPolicy="relay"),SP("FORCE_TURN_TCP")?i.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(e=>{e.forceturn&&(i.iceTransportPolicy="relay")}))),SP("ENABLE_ENCODED_TRANSFORM")&&pk().supportWebRTCEncodedTransform&&(i.encodedInsertableStreams=!0),nk.debug("P2PConnection p2pTransport is ".concat(n)),i}static turnServerConfigToIceServers(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=[],i=e.filter(e=>e.tcpport);nk.debug("P2PConnection turnServers is ".concat(i,", current index is ").concat(n));const o=i.length>n?i[n]:i[0];switch(t){case mP.SdRtn:const t=e.filter(e=>{var t;return xr(t=e.username).call(t,"glb:")&&e.turnServerURL==e.turnServerURL}),i=t.length>n?t[n]:t[0];i&&(r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(aj(i.turnServerURL),":").concat(i.tcpport,"?transport=udp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(aj(i.turnServerURL),":").concat(i.tcpport,"?transport=tcp")}));break;case mP.Relay:o&&(r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(o.turnServerURL,":").concat(o.tcpport,"?transport=udp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(aj(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}));break;default:o&&(r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(o.turnServerURL,":").concat(o.tcpport,"?transport=udp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(aj(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}),r.push({username:o.username,credential:o.password,credentialType:"password",urls:"stun:".concat(o.turnServerURL,":").concat(o.tcpport)}))}return r}tryBindTransportEvents(e){if(e){this.transport=e,e.onstatechange=()=>{var t;null!=e&&e.state&&(null===(t=this.onDTLSTransportStateChange)||void 0===t||t.call(this,e.state))},e.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const t=e.iceTransport;t&&(t.onstatechange=()=>{const t=null==e?void 0:e.iceTransport.state;var n;t&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,t))},t.getSelectedCandidatePair&&(t.onselectedcandidatepairchange=()=>{if(t.getSelectedCandidatePair()){const{local:e,remote:n}=t.getSelectedCandidatePair()||{};if(e&&n){const t=e.address+":"+e.port,r=n.address+":"+n.port;nk.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(gj(t)),", remote ").concat(JSON.stringify(gj(r))))}}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n;if(t||(t=this.peerConnection.getSenders().find(t=>t.track===e._mediaStreamTrack)),!t)return nk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return nk.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!pk().supportSetRtpSenderParameters)return nk.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const r={},i={};switch(e._optimizationMode){case"motion":r.degradationPreference="maintain-framerate";break;case"detail":r.degradationPreference="maintain-resolution";break;default:r.degradationPreference="balanced"}if(e._encoderConfig){var o;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(i.maxBitrate=1e3*t),xr(o=e._hints).call(o,Uk.LOW_STREAM)&&(n&&(i.maxFramerate=lj(n)),r&&r>=1&&(i.scaleResolutionDownBy=r))}if(SP("DSCP_TYPE")&&aN()){var a;const e=SP("DSCP_TYPE");xr(a=["very-low","low","medium","high"]).call(a,e)&&(i.networkPriority=e)}const s=t.getParameters(),c=null===(n=s.encodings)||void 0===n?void 0:n[0];VI()&&!c&&(r.encodings=[i]),c&&Object.assign(c,i),Object.assign(s,r),nk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(s.encodings))),await t.setParameters(s)}async applySendEncodings(e,t){try{if(!pk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];i instanceof xL&&!this.isVP8Simulcast(i)&&await this.updateRtpSenderEncodings(i,r.sender)}}catch(e){nk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){const r=DP(e);return t.forEach((e,t)=>{const i=n[t],o=r.mediaDescriptions.find(e=>e.attributes.mid===i);o&&(xj(o,e),jj(o,e,this.store.codec))}),xP(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,i,o,a;const c=e[s],l=t[s];if(l instanceof xL&&!xr(n=l._hints).call(n,Uk.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(i=l._encoderConfig)||void 0===i?void 0:i.bitrateMax)>200&&null!==(o=l._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!VI()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof xL&&this.isVP8Simulcast(r)){const t=e[n],i={},o={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};i.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,i))}}}isVP8Simulcast(e){var t,n,r,i,o;return!!(e instanceof xL&&SP("SIMULCAST")&&"vp8"===this.store.codec&&!xr(t=e._hints).call(t,Uk.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(i=e._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(SP("SDP_LOGGING"))return nk.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter(t=>t.mid&&-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map(e=>{e.direction="inactive"});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter(t=>t.mid&&-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map(async e=>{e.direction="sendonly"});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async getRemoteSSRC(e,t){var n;if(t=null!=t?t:null===(n=this.currentRemoteDescription)||void 0===n?void 0:n.sdp){var r;const n=null===(r=DP(t).mediaDescriptions.find(t=>t.attributes.mid===e))||void 0===r?void 0:r.attributes.ssrcs;return null==n?void 0:n[0].ssrcId}}async setRemoteDescription(e){var t;await this.peerConnection.setRemoteDescription(e),xr(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(e,t,n){const r=DP(e),i=r.mediaDescriptions.find(e=>e.attributes.mid===t);return i&&n===_F.AUDIO&&"audio"===i.media.mediaType&&zj(i),xP(r)}},PU(EX.prototype,"establish",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"establish"),EX.prototype),PU(EX.prototype,"connect",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"connect"),EX.prototype),PU(EX.prototype,"receive",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"receive"),EX.prototype),PU(EX.prototype,"mockReceive",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"mockReceive"),EX.prototype),PU(EX.prototype,"stopReceiving",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"stopReceiving"),EX.prototype),PU(EX.prototype,"restartICE",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"restartICE"),EX.prototype),PU(EX.prototype,"close",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"close"),EX.prototype),PU(EX.prototype,"updateEncoderConfig",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"updateEncoderConfig"),EX.prototype),PU(EX.prototype,"updateSendParameters",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"updateSendParameters"),EX.prototype),PU(EX.prototype,"replaceTrack",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"replaceTrack"),EX.prototype),PU(EX.prototype,"muteLocal",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"muteLocal"),EX.prototype),PU(EX.prototype,"unmuteLocal",[CX],Object.getOwnPropertyDescriptor(EX.prototype,"unmuteLocal"),EX.prototype),EX);function CX(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}let wX=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});var RX,AX,IX,NX,OX,PX,kX,DX,xX,LX,MX,UX;function FX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FX(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let VX=(RX=BX(wX.SEND_ONLY),AX=BX(wX.SEND_ONLY),IX=BX(),NX=BX(wX.RECEIVE_ONLY),OX=BX(wX.RECEIVE_ONLY),PX=BX(wX.RECEIVE_ONLY),kX=BX(wX.RECEIVE_ONLY),DX=BX(wX.RECEIVE_ONLY),xX=BX(wX.RECEIVE_ONLY),LX=BX(),MX=BX(wX.RECEIVE_ONLY),UX=class extends ON{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(TF.StateChange,t,this._state)}constructor(e,t){super(),nR(this,"isPlanB",!1),nR(this,"store",void 0),nR(this,"statsUploader",void 0),nR(this,"sendConnection",void 0),nR(this,"recvConnection",void 0),nR(this,"localTrackMap",new Map),nR(this,"remoteUserMap",new Map),nR(this,"localDataChannels",[]),nR(this,"pendingLocalTracks",[]),nR(this,"pendingRemoteTracks",[]),nR(this,"statsCollector",void 0),nR(this,"dtlsFailedCount",0),nR(this,"sendMutex",void 0),nR(this,"recvMutex",void 0),nR(this,"_state",SF.Disconnected),nR(this,"_restartStates",["disconnected","failed"]),nR(this,"reconnectInterval",void 0),nR(this,"uploadUnplinkStarted",!1),nR(this,"uploadDownlinkStarted",!1),nR(this,"uplinkStateUploadInterval",void 0),nR(this,"downlinkStatsUploadInterval",void 0),nR(this,"handleMuteLocalTrack",async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==SF.Connected)return void n(new pN(hN.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const r=this.filterTobeMutedTracks(e);if(0===r.length)return void t();const a=r.find(e=>"videoLowTrack"===e[0]);a&&a[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(r.map(e=>{let[,{id:t}]=e;return t}));let s=!1;var i,o;s="video"===e.trackMediaType?!(null===(i=this.localTrackMap.get(yF.LocalAudioTrack))||void 0===i||!i.track._muted):void 0===(null===(o=this.localTrackMap.get(yF.LocalVideoTrack))||void 0===o?void 0:o.id);const c=this.createMuteMessage(r);await qN(this,TF.RequestMuteLocal,c);const l="video"===e.trackMediaType?LF.MUTE_LOCAL_VIDEO:LF.MUTE_LOCAL_AUDIO;await qN(this,TF.RequestP2PMuteLocal,{action:l,message:c,isMuteAll:s}),t()}catch(e){n(e)}finally{r()}}),nR(this,"handleUnmuteLocalTrack",async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==SF.Connected)return void n(new pN(hN.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const r=this.filterTobeUnmutedTracks(e);if(0===r.length)return void t();await this.sendConnection.unmuteLocal(r.map(e=>{let[,{id:t}]=e;return t}));const i=this.createUnmuteMessage(r),o="video"===e.trackMediaType?LF.UNMUTE_LOCAL_VIDEO:LF.UNMUTE_LOCAL_AUDIO;await qN(this,TF.RequestP2PMuteLocal,{action:o,message:i}),t()}catch(e){n(e)}finally{r()}}),nR(this,"handleUpdateVideoEncoder",async(e,t,n,r)=>{let i;"boolean"==typeof r&&r||(i=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const n=this.localTrackMap.get(yF.LocalVideoTrack);if(!this.sendConnection||!n||n.track!==e||this.state!==SF.Connected)return void t();const{id:r,track:i}=n;r&&(await this.sendConnection.updateSendParameters(r,i),await this.sendConnection.updateEncoderConfig(r,i),this.emit(TF.UpdateVideoEncoder,i)),t()}catch(e){n(e)}finally{var o;null===(o=i)||void 0===o||o()}}),nR(this,"handleUpdateVideoSendParameters",async(e,t,n)=>{const r=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const n=this.localTrackMap.get(yF.LocalVideoTrack);if(!this.sendConnection||!n||n.track!==e||this.state!==SF.Connected)return void t();const{id:r,track:i}=n;r&&await this.sendConnection.updateSendParameters(r,i),t()}catch(e){n(e)}finally{r()}}),nR(this,"handleReplaceTrack",async(e,t,n,r)=>{let i;nk.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(i=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var o;const n=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(!this.sendConnection||!n||void 0===n[1].id||this.state!==SF.Connected)return void t();if(await(null===(o=this.sendConnection)||void 0===o?void 0:o.replaceTrack(e,n[1].id)),n[0]===yF.LocalVideoTrack&&pk().supportDualStreamEncoding){const t=this.localTrackMap.get(yF.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new ip((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)})}}t()}catch(e){n(e)}finally{var a;null===(a=i)||void 0===a||a()}}),nR(this,"handleGetLocalVideoStats",e=>{e(this.statsCollector.getLocalVideoTrackStats())}),nR(this,"handleGetLocalAudioStats",e=>{e(this.statsCollector.getLocalAudioTrackStats())}),nR(this,"handleGetRemoteVideoStats",e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid]),nR(this,"handleGetRemoteAudioStats",e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new nW(e),this.bindStatsUploaderEvents(),this.sendMutex=new kO("P2PChannel2-send-mutex",e.clientId),this.recvMutex=new kO("P2PChannel2-recv-mutex",e.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(e=>{e&&("disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))})},SP("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let n;try{if(t){this.recvConnection&&(nk.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),n=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new TX(e,this.store,WU.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const r=await this.recvConnection.establish(t);return{iceParameters:r.iceParameters,dtlsParameters:r.dtlsParameters,sdp:r.sdp}}{this.state=SF.New,this.sendConnection&&(nk.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),n=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new TX(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const t=await this.sendConnection.establish();return{iceParameters:t.iceParameters,dtlsParameters:t.dtlsParameters,sdp:t.sdp}}}finally{n&&n()}}async p2pConnect(e){if(!this.sendConnection)throw new pN(hN.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=SF.Connected}async addRemoteCandidate(e,t){if(t===WU.RECEIVE_ONLY){if(!this.sendConnection)throw new pN(hN.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new pN(hN.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,n){var r=this;return LA(function*(){const i=yield UA(r.sendMutex.lock("From P2PChannel.publish"));try{if(!r.sendConnection||r.state!==SF.Connected){r.throwIfTrackTypeNotMatch(e);const t=e.filter(e=>-1===r.pendingLocalTracks.indexOf(e));return void(r.pendingLocalTracks=r.pendingLocalTracks.concat(t))}r.store.pubId=r.store.pubId+1,tB.markPublishStart(r.store.clientId,r.store.pubId);const i=r.filterTobePublishedTracks(e,t,n);if(0===i.length)return void(yield UA(r.tryToUnmuteAudio(e)));i.forEach(e=>{let{track:t,type:n}=e;const i=Date.now();r.store.publish(t.getTrackId(),n===yF.LocalAudioTrack?"audio":"video",i)}),r.bindLocalTrackEvents(i);const o=yield UA(r.sendConnection.send(i.map(e=>{let{track:t}=e;return t}),r.store.codec,r.store.audioCodec)),a=(yield UA(o.next())).value,s=r.createGatewayPublishMessage(i,a);try{yield s}catch(e){throw o.throw(e),(null==e?void 0:e.code)===hN.WS_ABORT&&i.forEach(e=>{let{track:t}=e;-1===r.pendingLocalTracks.indexOf(t)&&r.pendingLocalTracks.push(t)}),r.unbindLocalTrackEvents(i),e}yield UA(o.next()),i.forEach(e=>{let{type:t}=e;r.statsCollector.addLocalStats(t)}),r.statsUploader.startUploadOutboundStats(),r.assignLocalTracks(i,a),i.forEach(e=>{let{track:t,type:n}=e;const i=Date.now();r.store.publish(t.getTrackId(),n===yF.LocalAudioTrack?"audio":"video",void 0,i)}),r.startUploadUplinkState()}finally{i()}})()}async unpublish(e){if(!this.sendConnection||this.state!==SF.Connected)return void(0===e.length?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(t=>!xr(e).call(e,t)));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find(e=>"videoLowTrack"===e[0]);n&&n[1].track.close();const r=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map(e=>{let[,{id:t}]=e;return t})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(e=>{let[t,{track:n}]=e;return{type:t,track:n}})),t.forEach(e=>{let[t]=e;this.statsCollector.removeLocalStats(t)}),0===this.localTrackMap.size&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===SF.Connected)return n&&n[1].track.close(),r;e.forEach(e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const e=[],t=[];Array.from(this.localTrackMap.entries()).forEach(n=>{let[r,{track:i,ssrcs:o}]=n;const a={stream_type:NB(i,r),ssrcs:o};i._muted||!i._enabled?e.push(a):t.push(a)}),e.length>0&&e.forEach(e=>{qN(this,TF.RequestMuteLocal,[e])}),t.length>0&&t.forEach(e=>{qN(this,TF.RequestUnmuteLocal,[e])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return LA(function*(){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(nk.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await YN(this,TF.RequestRePublish,this.pendingLocalTracks),this.emit(TF.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,n,r){var i;if(!this.recvConnection)throw new pN(hN.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if(null!==(i=this.remoteUserMap.get(e))&&void 0!==i&&i.has(t))return;const{track:o,mid:a,transceiver:s}=await this.recvConnection.receive(t,[{ssrcId:n}],String(e.uid),r);t===_F.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(o):(e._audioTrack=new $L(o,e.uid,e._uintid,this.store),nk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),s&&e._audioTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=n,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(o):(e._videoTrack=new QL(o,e.uid,e._uintid,this.store),nk.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),s&&e._videoTrack._updateRtpTransceiver(s),this.bindRemoteTrackEvents(e,e._videoTrack));const c=this.remoteUserMap.get(e);c?c.set(t,a):this.remoteUserMap.set(e,new Map([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const l=this.pendingRemoteTracks.findIndex(n=>{let{user:r,kind:i}=n;return r.uid===e.uid&&t===i});-1!==l&&(this.pendingRemoteTracks.splice(l,1),this.emit(TF.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,n,r){if(!this.recvConnection)throw new pN(hN.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:n}],String(e.uid),r)}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter(n=>{let{user:r,kind:i}=n;return void 0!==t?r.uid===e.uid&&t===i:r.uid===e.uid});if(r.forEach(e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)}),this.recvConnection||n||r.forEach(t=>{let{kind:n}=t;var r;if(n===_F.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===_F.VIDEO){var i;null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0}}),!this.recvConnection)return;const i=this.filterTobeUnSubscribedTracks(e,t);0!==i.length&&(await this.recvConnection.stopReceiving(i.map(e=>{let[,{id:t}]=e;return t})),this.withdrawRemoteTracks(i),0===this.remoteUserMap.size&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),i.forEach(e=>{let[t,{kind:r}]=e;var i,o;if(r===_F.VIDEO&&t._videoSSRC&&(null===(i=this.recvConnection)||void 0===i||i.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===_F.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(r===_F.AUDIO){var a;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(a=t._audioTrack)||void 0===a||a._destroy(),t._audioTrack=void 0)}}),i.forEach(e=>{let[,{kind:t}]=e;qN(this,TF.RequestP2PMuteRemote,t)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach(e=>{let[,t]=e;[_F.VIDEO,_F.AUDIO].forEach(e=>{t.has(e)?qN(this,TF.RequestP2PUnmuteRemote,e):qN(this,TF.RequestP2PMuteRemote,e)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new pN(hN.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;const n=this.remoteUserMap.get(e);if(!n)return void nk.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!n.get(t))return void nk.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===_F.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.recvConnection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;const n=this.remoteUserMap.get(e);n?n.get(t)||nk.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):nk.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."))}getAllTracks(e){const t=this.localTrackMap.get(yF.LocalAudioTrack);if((null==t?void 0:t.track)instanceof Hx){const n=t.track;return Array.from(this.localTrackMap.entries()).filter(e=>{let[t]=e;return t!==yF.LocalAudioTrack}).filter(t=>{let[n]=t;return!(e&&n===yF.LocalVideoLowTrack)}).map(e=>{let[,{track:t}]=e;return t}).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter(t=>{let[n]=t;return!(e&&n===yF.LocalVideoLowTrack)}).map(e=>{let[,{track:t}]=e;return t})}reportPublishEvent(e,t,n,r,i){if(e){const n=this.localTrackMap.get(yF.LocalAudioTrack),o=r?this.localTrackMap.get(yF.LocalVideoLowTrack):this.localTrackMap.get(yF.LocalVideoTrack);dk.publish(this.store.sessionId,{eventElapse:tB.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(Uk.SCREEN_TRACK)),audio:!!n,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;n||(n=[]);const a=n.find(e=>e instanceof Vx),s=r?null===(o=this.localTrackMap.get(yF.LocalVideoTrack))||void 0===o?void 0:o.track:n.find(e=>e instanceof xL);dk.publish(this.store.sessionId,{eventElapse:tB.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==a?void 0:a.getTrackLabel(),videoName:null==s?void 0:s.getTrackLabel(),screenshare:-1!==(null==s?void 0:s._hints.indexOf(Uk.SCREEN_TRACK)),audio:!!a,video:!!s,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,n,r){const i=r===_F.VIDEO?n._videoSSRC:n._audioSSRC;i&&dk.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===_F.VIDEO,audio:r===_F.AUDIO,peerid:n.uid,subscribeRequestid:r===_F.VIDEO?n._videoSSRC:n._audioSSRC,p2pid:this.store.p2pId,eventElapse:tB.measureFromSubscribeStart(this.store.clientId,i)})}reset(){nk.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new kO("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new kO("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(yF.LocalAudioTrack);if((null==e?void 0:e.track)instanceof Hx){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(e=>{t.removeAudioTrack(e)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=SF.Disconnected}getStats(e){var t,n;return e?null===(n=this.recvConnection)||void 0===n?void 0:n.getStats():null===(t=this.sendConnection)||void 0===t?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.recvConnection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(yF.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(yF.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof xL||t&&t.track instanceof Vx?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t.uid===e);return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(yF.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Zp(e).call(e,(e,t)=>e.level-t.level),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(nk.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=SF.Reconnecting,SP("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var n;t._videoTrack&&t._videoTrack._player&&(null===(n=t._videoTrack._player.getVideoElement())||void 0===n||n.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[n,{track:r}]=e;switch(n){case yF.LocalVideoTrack:xr(t=r._hints).call(t,Uk.LOW_STREAM)?r.close():this.pendingLocalTracks.push(r);break;case yF.LocalAudioTrack:r instanceof Hx?this.pendingLocalTracks=this.pendingLocalTracks.concat(r.trackList):this.pendingLocalTracks.push(r);case yF.LocalVideoLowTrack:}}),this.emit(TF.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,n]=e;Array.from(HP(n).call(n)).forEach(e=>{this.setPendingRemoteMedia(t,e)}),this.emit(TF.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),nk.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:i}=n;if((e instanceof sB?e.uid:e)===r.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let n,r;if(e===WU.SEND_ONLY){if(!this.sendConnection)throw new pN(hN.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");n=await this.sendMutex.lock("From P2PChannel.restartICE"),r=this.sendConnection}else{if(!this.recvConnection)throw new pN(hN.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");n=await this.recvMutex.lock("From P2PChannel.restartICE"),r=this.recvConnection}try{if(t){const e=await r.restartICE(t);return r.isInRestartIce=!1,e}{const e=await r.restartICE();if(e){const t=await YN(this,TF.RequestP2PRestartICE,{direction:WU.RECEIVE_ONLY,iceParameter:e});await r.restartICE(t),r.isInRestartIce=!1}}}finally{n()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(yF.LocalVideoTrack),n=this.localTrackMap.get(yF.LocalAudioTrack),r=e.videoSend.find(e=>{var n;return e.ssrc===(null==t||null===(n=t.ssrcs)||void 0===n?void 0:n[0].ssrcId)}),i=e.audioSend.find(e=>{var t;return e.ssrc===(null==n||null===(t=n.ssrcs)||void 0===t?void 0:t[0].ssrcId)});if(!r||!i)return 1;const o=XN(this,TF.NeedSignalRTT),a=r?r.rttMs:void 0,s=i?i.rttMs:void 0,c=a&&s?(a+s)/2:a||s,l=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*l/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,h=null==t?void 0:t.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(Uk.SCREEN_TRACK)){const t=h._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return GM[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r]=n;const i=r._audioSSRC,o=r._videoSSRC,a=e.audioRecv.find(e=>e.ssrc===i),s=e.videoRecv.find(e=>e.ssrc===o);if(!a&&!s)return void(t+=1);const c=XN(this,TF.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=a?a.jitterMs:void 0,h=e.recvPacketLossRate;let p=.7*h*100/50+.3*d/1500;u&&(p=.6*h*100/50+.2*d/1500+.2*u/400),t+=p<.1?1:p<.17?2:p<.36?3:p<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new ip((t,n)=>{this.handleMuteLocalTrack(e,t,n)})}filterTobePublishedTracks(e,t,n){const r=[],i=pk(),o=this.getAllTracks();e=iO(e=e.filter(e=>-1===o.indexOf(e)));let a=!1,s=!1;for(const c of e){if(c instanceof xL&&(this.localTrackMap.has(yF.LocalVideoTrack)||a?new pN(hN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:c,type:yF.LocalVideoTrack}),a=!0),t)){const e=this.getLowVideoTrack(c,n);r.push({track:e,type:yF.LocalVideoLowTrack})}if(c instanceof Vx){const e=this.localTrackMap.get(yF.LocalAudioTrack);if(e){if(!(e.track instanceof Hx))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(s){const e=r.find(e=>{let{type:t}=e;return t===yF.LocalAudioTrack});if(!(e.track instanceof Hx))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c)}else{if(!i.webAudioMediaStreamDest||c instanceof Hx||c._bypassWebAudio)r.push({track:c,type:yF.LocalAudioTrack});else{const e=new Hx;e.addAudioTrack(c),r.push({track:e,type:yF.LocalAudioTrack})}s=!0}}}return r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=iO(e=e.filter(e=>-1!==n.indexOf(e)));for(const r of e){if(r instanceof Vx){const e=this.localTrackMap.get(yF.LocalAudioTrack);if(!e)continue;e.track instanceof Hx?(e.track.removeAudioTrack(r),this.unbindLocalAudioTrackEvents(r),0===e.track.trackList.length&&(t.push([yF.LocalAudioTrack,e]),e.track.close())):t.push([yF.LocalAudioTrack,e])}if(r instanceof xL){const e=this.localTrackMap.get(yF.LocalVideoTrack);if(!e)continue;t.push([yF.LocalVideoTrack,e]);const n=this.localTrackMap.get(yF.LocalVideoLowTrack);n&&t.push([yF.LocalVideoLowTrack,n])}}return t}bindLocalTrackEvents(e){e.forEach(e=>{let{track:t,type:n}=e;switch(n){case yF.LocalVideoTrack:t.addListener(Mk.GET_STATS,this.handleGetLocalVideoStats),t.addListener(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Mk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(Mk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.addListener(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case yF.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case yF.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof Hx?e.trackList.forEach(e=>{e.addListener(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Mk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Mk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(e=>{let[t,{track:n}]=e;return{track:n,type:t}})),e.forEach(e=>{let{track:t,type:n}=e;switch(n){case yF.LocalVideoTrack:t.off(Mk.GET_STATS,this.handleGetLocalVideoStats),t.off(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Mk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(Mk.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),t.off(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case yF.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case yF.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Hx?e.trackList.forEach(e=>{e.off(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Mk.GET_STATS,this.handleGetLocalAudioStats),e.off(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Mk.GET_STATS,this.handleGetLocalAudioStats),e.off(Mk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Mk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Mk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Mk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof QL&&t.addListener(Mk.GET_STATS,t=>{t(this.handleGetRemoteVideoStats(e))}),t instanceof $L&&t.addListener(Mk.GET_STATS,t=>{t(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Mk.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,n]=e;n.has(_F.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(_F.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((e,n)=>{var r;let i,{track:o,type:a}=e;switch(a){case yF.LocalAudioTrack:i=oF.Audio;break;case yF.LocalVideoTrack:i=xr(r=o._hints).call(r,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalVideoLowTrack:i=oF.Low}return{kind:a===yF.LocalAudioTrack?_F.AUDIO:_F.VIDEO,stream_type:i,mid:t[n].id,ssrcs:t[n].localSSRC,isMuted:o.muted||!o.enabled}})}createGatewayUnpublishMessage(e){return e.map(e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case yF.LocalVideoTrack:n=xr(t=i._hints).call(t,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalAudioTrack:n=oF.Audio;break;case yF.LocalVideoLowTrack:n=oF.Low}return{stream_type:n,ssrcs:o,mid:a}})}assignLocalTracks(e,t){e.forEach((e,n)=>{let{track:r,type:i}=e;this.localTrackMap.set(i,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})})}withdrawLocalTracks(e){e.forEach(e=>{let[t]=e;this.localTrackMap.delete(t)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var n;nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(TF.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(e.isInRestartIce=!1),xr(n=this._restartStates).call(n,t)&&!e.isInRestartIce&&("disconnected"===t&&await _O(800),"disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),dk.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:xN.TRACER}).onSuccess(),this.emit(TF.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._audioSSRC===e);var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(Hk.FIRST_FRAME_DECODED),dk.firstRemoteFrame(this.store.sessionId,ak.FIRST_AUDIO_DECODE,sk.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._audioSSRC===e);n&&dk.firstRemoteFrame(this.store.sessionId,ak.FIRST_AUDIO_RECEIVED,sk.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoReceived=e=>{var t;const n=Array.from(HP(t=this.remoteUserMap).call(t)).find(t=>t._videoSSRC===e);n&&dk.firstRemoteFrame(this.store.sessionId,ak.FIRST_VIDEO_RECEIVED,sk.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(TF.ConnectionTypeChange,n),nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(fj(t))," -> ").concat(JSON.stringify(fj(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{nk.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(fj(t))," -> ").concat(JSON.stringify(fj(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(TF.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const t=e===WU.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,nk.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===WU.SEND_ONLY?this.restartICE(e):YN(this,TF.RequestP2PRestartICE,{direction:WU.SEND_ONLY}))}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(yF.LocalAudioTrack);if(e instanceof Vx&&(null==n?void 0:n.track)instanceof Hx)return n.track.isActive||t.push([yF.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(r&&(t.push(r),r[0]===yF.LocalVideoTrack)){const e=this.localTrackMap.get(yF.LocalVideoLowTrack);e&&t.push([yF.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(yF.LocalAudioTrack);if(e instanceof Vx&&(null==n?void 0:n.track)instanceof Hx)return n.track.isActive&&t.push([yF.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:n}]=t;return e===n});if(r)if(r[0]===yF.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(yF.LocalVideoLowTrack);e&&t.push([yF.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map(e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case yF.LocalAudioTrack:n=oF.Audio;break;case yF.LocalVideoTrack:n=xr(t=i._hints).call(t,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalVideoLowTrack:n=oF.Low}return{stream_type:n,ssrcs:o,mid:a}})}createUnmuteMessage(e){return e.map(e=>{var t;let n,[r,{track:i,ssrcs:o,id:a}]=e;switch(r){case yF.LocalAudioTrack:n=oF.Audio;break;case yF.LocalVideoTrack:n=xr(t=i._hints).call(t,Uk.SCREEN_TRACK)?oF.Screen:oF.High;break;case yF.LocalVideoLowTrack:n=oF.Low}return{stream_type:n,ssrcs:o,mid:a}})}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const i=r.get(t);if(!i)return n;n.push([e,{kind:t,id:i}])}else Array.from(r.entries()).forEach(t=>{let[r,i]=t;n.push([e,{kind:r,id:i}])});return n}createUnsubscribeMessage(e){const t=[];return e.forEach(e=>{let[n,{kind:r,id:i}]=e;switch(r){case _F.VIDEO:return void(n._videoSSRC&&t.push({stream_type:_F.VIDEO,ssrcId:n._videoSSRC}));case _F.AUDIO:return void(n._audioSSRC&&t.push({stream_type:_F.AUDIO,ssrcId:n._audioSSRC}))}}),t}withdrawRemoteTracks(e){e.forEach(e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(yF.LocalVideoTrack),n=this.localTrackMap.get(yF.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new ip((e,n)=>{this.handleUpdateVideoEncoder(t.track,e,n,!0)})),n&&e.low_stream_uplink&&(await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new ip((e,t)=>{this.handleUpdateVideoEncoder(n.track,e,t,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return"connected"!==e&&"connected"!==t}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof Vx){const n=this.filterTobeUnmutedTracks(e[t]);if(0===n.length)continue;const r=this.createUnmuteMessage(n);return void await qN(this,TF.RequestUnmuteLocal,r)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:t}]=e;return!!t}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.recvConnection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(TF.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(TF.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await _O(LO(this.dtlsFailedCount,xO)),this.emit(TF.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(yF.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof xL)}throwIfTrackTypeNotMatch(e){if(e.filter(e=>e instanceof xL).length>1)throw new pN(hN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(e=>e instanceof Vx).length>1&&(e.some(e=>e instanceof Vx&&e._bypassWebAudio)||!pk().webAudioMediaStreamDest))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof xL&&this.pendingLocalTracks.some(e=>e instanceof xL))throw new pN(hN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof Vx&&this.pendingLocalTracks.some(e=>e instanceof Vx)&&(!pk().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(e=>e instanceof Vx&&e._bypassWebAudio)))throw new pN(hN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const n=!SP("DISABLE_DUAL_STREAM_USE_ENCODING")&&pk().supportDualStreamEncoding,r=jX(jX({},{width:160,height:120,framerate:15,bitrate:50}),t);let i;i=n?e._mediaStreamTrack.clone():BB(e,r);const o=vO(8,"track-low-"),a=new xL(i,jX(jX({},n&&{scaleResolutionDownBy:mj(r,e)}),{},{frameRate:r.framerate,bitrateMax:r.bitrate,bitrateMin:r.bitrate}),void 0,void 0,o);return a.on(Bk.TRANSCEIVER_UPDATED,t=>{e._updateRtpTransceiver(t,Fk.LOW_STREAM)}),a._hints.push(Uk.LOW_STREAM),e.addListener(Mk.NEED_CLOSE,()=>{a.close()}),a}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,n,r){var i;const o=Array.from(HP(i=this.remoteUserMap).call(i)).find(t=>t._videoSSRC===e);if(o){r||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const i=this.store.keyMetrics,a=i.subscribe.find(e=>e.userId===o.uid&&"video"===e.type);dk.firstRemoteVideoDecode(this.store.sessionId,ak.FIRST_VIDEO_DECODE,sk.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:tB.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:i.requestAPEnd||0,apStart:i.requestAPStart||0,joinGwEnd:i.joinGatewayEnd||0,joinGwStart:i.joinGatewayStart||0,pcEnd:i.peerConnectionEnd||0,pcStart:i.peerConnectionStart||0,subscriberEnd:(null==a?void 0:a.subscribeEnd)||0,subscriberStart:(null==a?void 0:a.subscribeStart)||0,videoAddNotify:(null==a?void 0:a.streamAdded)||0,state:r?1:0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.recvConnection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const i=r.get(t);if(!i)return!1;const o=await this.recvConnection.getRemoteSSRC(i);return void 0!==o&&o!==n}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new pN(hN.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new pN(hN.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new pN(hN.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new pN(hN.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new pN(hN.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new pN(hN.NOT_SUPPORTED)}async preConnect(e){throw new pN(hN.NOT_SUPPORTED)}getEstablishParams(){throw new pN(hN.NOT_SUPPORTED)}async reSubscribe(e){throw new pN(hN.NOT_SUPPORTED)}reportVideoFirstFrameRender(e){}async updateVideoStreamParameter(e,t){throw new pN(hN.NOT_SUPPORTED)}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:n}]=e;t===yF.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,Fk.LOW_STREAM):n._updateRtpTransceiver(void 0)})}},PU(UX.prototype,"p2pConnect",[RX],Object.getOwnPropertyDescriptor(UX.prototype,"p2pConnect"),UX.prototype),PU(UX.prototype,"unpublish",[AX],Object.getOwnPropertyDescriptor(UX.prototype,"unpublish"),UX.prototype),PU(UX.prototype,"unpublishLowStream",[IX],Object.getOwnPropertyDescriptor(UX.prototype,"unpublishLowStream"),UX.prototype),PU(UX.prototype,"subscribe",[NX],Object.getOwnPropertyDescriptor(UX.prototype,"subscribe"),UX.prototype),PU(UX.prototype,"mockSubscribe",[OX],Object.getOwnPropertyDescriptor(UX.prototype,"mockSubscribe"),UX.prototype),PU(UX.prototype,"unsubscribe",[PX],Object.getOwnPropertyDescriptor(UX.prototype,"unsubscribe"),UX.prototype),PU(UX.prototype,"muteRemote",[kX],Object.getOwnPropertyDescriptor(UX.prototype,"muteRemote"),UX.prototype),PU(UX.prototype,"unmuteRemote",[DX],Object.getOwnPropertyDescriptor(UX.prototype,"unmuteRemote"),UX.prototype),PU(UX.prototype,"hasRemoteMediaWithLock",[xX],Object.getOwnPropertyDescriptor(UX.prototype,"hasRemoteMediaWithLock"),UX.prototype),PU(UX.prototype,"disconnectForReconnect",[LX],Object.getOwnPropertyDescriptor(UX.prototype,"disconnectForReconnect"),UX.prototype),PU(UX.prototype,"remoteMediaSsrcChanged",[MX],Object.getOwnPropertyDescriptor(UX.prototype,"remoteMediaSsrcChanged"),UX.prototype),UX);function BX(e){return function(t,n,r){const i=t[n];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return r.value=async function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];switch(e){case wX.SEND_ONLY:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(n));try{return await i.apply(this,r)}finally{e()}}case wX.RECEIVE_ONLY:{const e=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await i.apply(this,r)}finally{e()}}default:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(n)),t=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await i.apply(this,r)}finally{e(),t()}}}},r}}class WX extends ON{constructor(e,t){super(),nR(this,"signal",void 0),nR(this,"token",void 0),nR(this,"tokenTimeout",void 0),nR(this,"tokenInterval",void 0),nR(this,"_sequence",0),nR(this,"userMap",new Map),nR(this,"encoder",new TextEncoder),this.signal=e,this.token=t;const n=()=>{this.signal.connectionState===UU.CONNECTED&&this.check(),0===this.userMap.size?this.tokenInterval=window.setTimeout(n,1e3):this.tokenInterval=window.setTimeout(n,3*SP("P2P_TOKEN_INTERVAL"))};n()}async send(e,t,n,r,i){var o;if(0===this.userMap.size)return;const a=Array.from(pp(o=this.userMap).call(o))[0].token;"string"!=typeof t&&(t=JSON.stringify(t)),r=null!=r?r:vO(6,""),i=null!=i?i:this._sequence++;const s={_id:r,_type:e,_seq:i,_message:t,token:"".concat(this.token,"_").concat(a)};SP("SHOW_P2P_LOG")&&nk.debug("send message",s,"noNeedResponse : ".concat(n)),this.splitMessage(JSON.stringify(s)).forEach(e=>{this.signal.request(jU.DATA_STREAM,{payload:uO(this.encoder.encode(e))})});const c=new ip((t,i)=>{const o=window.setTimeout(()=>{this.off("res-@".concat(r,"_ack"),a),this.off("res-@".concat(r),l),this.off(xF.ABORT,c),nk.debug("[external-signal] request timeout, type: ".concat(e,", requestId: ").concat(r)),0===this.userMap.size?i(new pN(hN.INVALID_REMOTE_USER)):i(new pN(hN.TIMEOUT))},SP("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),a=()=>{o&&window.clearTimeout(o),this.off(xF.ABORT,c),n&&t()},c=()=>{o&&window.clearTimeout(o),this.off("res-@".concat(r,"_ack"),a),this.off("res-@".concat(r),l),i(new pN(hN.EXTERNAL_SIGNAL_ABORT,"type: ".concat(e,", requestId: ").concat(r)))};this.once(xF.ABORT,c),this.once("res-@".concat(r,"_ack"),a);const l=(n,s)=>{d=!0,o&&window.clearTimeout(o),this.off("res-@".concat(r,"_ack"),a),this.off(xF.ABORT,c),"success"===n?t(s):i(new pN(hN.P2P_MESSAGE_FAILED,"request ".concat(e," failed, requestId: ").concat(r)))};let d=!1;n||(this.once("res-@".concat(r),l),_O(SP("SIGNAL_REQUEST_TIMEOUT")).then(()=>{d||nk.warning("external_signal request timeout, type: ".concat(e,", requestId: ").concat(r,", ").concat(s))}))});try{return await c}catch(o){if(o.code===hN.TIMEOUT)return await this.send(e,t,n,r,i);throw o}}onMessage(e){var t;const{_uid:n}=e;let r,i=this.userMap.get(n);if(i)r=i.splitMessageMap;else{if(this.userMap.size>0||!("_type"in e)||e._type!==DF.CHECK)return;const{token:t}=e;r=new Map,i={uid:n,isStart:!0,token:t,splitMessageMap:r,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(n,i),this.signal.emit(BU.ON_USER_ONLINE,{uid:n}),this.handleUserOnline()}if("id"in e&&"total"in e){var o;const{id:t,total:i}=e,a=null!==(o=r.get(t))&&void 0!==o?o:[];if(a.push(e),r.has(t)||r.set(t,a),a.length!==i)return;{const i=Zp(a).call(a,(e,t)=>e.index-t.index).map(e=>e.payload).join("");r.delete(t),(e=JSON.parse(i))._uid=n}}const{_type:a,token:s}=e;if(xr(t=[DF.ACK,DF.CHECK]).call(t,a))return a===DF.CHECK&&this.handleCheckToken(i,s),void this.receiveMessage(e);s==="".concat(i.token,"_").concat(this.token)?this.handleReceivedMessage(e):nk.debug('Receive unexpected message", '.concat(s,", cur_token: ").concat(i.token,"_").concat(this.token),e)}check(){const e={_id:vO(6,""),token:this.token,_type:DF.CHECK};SP("SHOW_P2P_LOG")&&nk.debug("send message",e),this.signal.request(jU.DATA_STREAM,{payload:uO(this.encoder.encode(JSON.stringify(e)))})}ack(e){const t={_id:e,_type:DF.ACK,token:this.token};SP("SHOW_P2P_LOG")&&nk.debug("send message",t),this.signal.request(jU.DATA_STREAM,{payload:uO(this.encoder.encode(JSON.stringify(t)))})}response(e,t,n){this.send(DF.RESPONSE,JSON.stringify({success:!n,message:t}),!0,e)}handleReceivedMessage(e){const t=()=>{this.userMap.forEach(e=>{const{receivedMessagesMap:t,nextExpectedSequenceNumber:n}=e;for(;t.has(n);){const r=t.get(n);t.delete(n),this.receiveMessage(r),e.nextExpectedSequenceNumber++}})};if(!e)return void t();const{_uid:n,_seq:r}=e,i=this.userMap.get(n),{receivedMessagesMap:o,isStart:a,nextExpectedSequenceNumber:s}=i;if(r<s)return this.ack(e._id),void nk.debug("[external-signal] receive old message, seq: ".concat(r,", ").concat(e._message));o.set(r,e),a&&r===s&&(this.receiveMessage(e),o.delete(s),i.nextExpectedSequenceNumber++,t())}receiveMessage(e){const{_id:t,_type:n,_message:r,_uid:i}=e;if(SP("SHOW_P2P_LOG")&&nk.debug("receive message",e),t){let o;switch(e._type!==DF.ACK&&(r&&(o=JSON.parse(r)),this.ack(e._id)),e._type){case DF.CANDIDATE:case DF.CONTROL:this.signal.emit(n,o,i);break;case DF.PUBLISH:case DF.UNPUBLISH:case DF.RESTART_ICE:case DF.CALL:o.uid=i,YN(this.signal,n,o).then(t=>{this.response(e._id,t)}).catch(()=>{this.response(e._id,void 0,!0)});break;case DF.ACK:this.getListeners("res-@".concat(t,"_ack")).length>0&&this.emit("res-@".concat(t,"_ack"));break;case DF.RESPONSE:{const{success:e,message:n}=o;this.emit("res-@".concat(t),e?"success":"failed",n);break}}}}splitMessage(e){if(e.length<WX.MAX_MESSAGE_SIZE)return[e];const t=[],{remoteToken:n}=JSON.parse(e),r=vO(6,"");let i=0,o=800;const a=Math.ceil(e.length/o);for(;e.length>0;){i++;const s={id:r,index:i,total:a,payload:e.slice(0,o),token:"".concat(this.token,"_").concat(n)};JSON.stringify(s).length>WX.MAX_MESSAGE_SIZE?o-=50:(t.push(s),e=e.slice(o))}return t.map(e=>JSON.stringify(e))}handleCheckToken(e,t){return e.token!==t?(nk.debug("token changed, from ".concat(e.token," to ").concat(t)),this.reset(e.uid,t),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{nk.debug("token timeout, ".concat(t)),this.reset(e.uid)},SP("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const e=await YN(this.signal,DF.CALL,void 0),t=await this.send(DF.CALL,e);this.signal.emit(FU.P2P_CONNECTION,t,!0)}async reset(e,t){const n=this.userMap.get(e);n&&(this.emit(xF.ABORT),this.signal.emit(BU.ON_USER_OFFLINE,{uid:n.uid,reason:MF.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),t||(nk.debug("change local token from ".concat(t," to ").concat(t)),this.token=vO(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(xF.ABORT)}}nR(WX,"MAX_SIZE",1),nR(WX,"MAX_MESSAGE_SIZE",1024);class HX extends ON{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===UU.CONNECTED?this.emit(FU.WS_CONNECTED):e===UU.RECONNECTING?this.emit(FU.WS_RECONNECTING,this._websocketReconnectReason):e===UU.CLOSED&&this.emit(FU.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),nR(this,"__name__","P2PSignal"),nR(this,"_disconnectedReason",void 0),nR(this,"_websocketReconnectReason",void 0),nR(this,"_connectionState",UU.CLOSED),nR(this,"reconnectToken",void 0),nR(this,"p2pToken",void 0),nR(this,"websocket",void 0),nR(this,"openConnectionTime",void 0),nR(this,"clientId",void 0),nR(this,"lastMsgTime",Date.now()),nR(this,"uploadCache",[]),nR(this,"uploadCacheInterval",void 0),nR(this,"rttRolling",new FO(5)),nR(this,"pingpongTimer",void 0),nR(this,"pingpongTimeoutCount",0),nR(this,"joinResponse",void 0),nR(this,"multiIpOption",void 0),nR(this,"initError",void 0),nR(this,"spec",void 0),nR(this,"store",void 0),nR(this,"_external_signal",void 0),nR(this,"onWebsocketMessage",e=>{if(e.data instanceof ArrayBuffer)return void this.emit(FU.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){switch(t._type){case BU.ON_DATA_STREAM:return void this.handleDataStream(t._message);case BU.MUTE_AUDIO:case BU.MUTE_VIDEO:case BU.ON_P2P_LOST:case BU.ON_USER_ONLINE:return;case BU.ON_USER_OFFLINE:const{uid:e}=t._message;return nk.debug("[".concat(this.clientId,"] user-offline uid: ").concat(e)),void this._external_signal.reset(e)}if(this.emit(t._type,t._message),t._type===BU.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===BU.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(UN.UID_BANNED);break;case 15:this.close(UN.IP_BANNED);break;case 16:this.close(UN.CHANNEL_BANNED)}if(t._type===BU.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case MU.ERR_LICENSE_MISSING:this.close(UN.LICENSE_MISSING);break;case MU.ERR_LICENSE_EXPIRED:this.close(UN.LICENSE_EXPIRED);break;case MU.ERR_LICENSE_MINUTES_EXCEEDED:this.close(UN.LICENSE_MINUTES_EXCEEDED);break;case MU.ERR_LICENSE_PERIOD_INVALID:this.close(UN.LICENSE_PERIOD_INVALID);break;case MU.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(UN.LICENSE_MULTIPLE_SDK_SERVICE);break;case MU.ERR_LICENSE_ILLEGAL:this.close(UN.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new QF("gateway-".concat(this.clientId),this.spec.retryConfig,!0,SP("JOIN_GATEWAY_USE_DUAL_DOMAIN"),SP("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===UU.CONNECTED&&this.reconnect("retry",GN.OFFLINE)}),this.p2pToken=vO(6,""),this._external_signal=new WX(this,this.p2pToken)}async request(e,t,n,r){const i=vO(6,""),o={_id:i,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new ip((e,t)=>{if(this.connectionState===UU.CONNECTED)return e();const n=()=>{this.off(FU.WS_CLOSED,r),e()},r=()=>{this.off(FU.WS_CONNECTED,n),t(new pN(hN.WS_ABORT))};this.once(FU.WS_CONNECTED,n),this.once(FU.WS_CLOSED,r)});if(this.connectionState!==UU.CONNECTING&&this.connectionState!==UU.RECONNECTING||e===jU.JOIN||e===jU.REJOIN||await s(),this.websocket.sendMessage(o,!0),r)return;const c=new ip((n,r)=>{let o=!1;const s=(r,i)=>{o=!0,n({isSuccess:"success"===r,message:i||{}}),this.off(FU.WS_CLOSED,c),this.off(FU.WS_RECONNECTING,c),this.emit(FU.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),s);const c=()=>{r(new pN(hN.WS_ABORT,"type: ".concat(e))),this.off(FU.WS_CLOSED,c),this.off(FU.WS_RECONNECTING,c),this.off("res-@".concat(i),s)};this.once(FU.WS_CLOSED,c),this.once(FU.WS_RECONNECTING,c),_O(SP("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==a||o||(nk.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(FU.REQUEST_TIMEOUT,e,t))})});let l=null;try{l=await c}catch(r){if(this.connectionState===UU.CLOSED||e===jU.LEAVE)throw new pN(hN.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===jU.JOIN||e===jU.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const d=Number(l.message.error_code||l.message.code),u=VF(d),h=new pN(hN.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message,desc:u.desc});return"success"===u.action?l.message:(nk.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===MU.ERR_TOO_MANY_BROADCASTERS?e===jU.JOIN||e===jU.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===u.action?h.throw():"quit"===u.action?(this.initError=h,this.close(),h.throw()):(d===MU.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,nk.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",GN.MULTI_IP)):this.reconnect(u.action,GN.SERVER_ERROR),e===jU.JOIN||e===jU.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new ip(n=>{const r=i=>{(!t||t(i))&&(this.off(e,r),n(i))};this.on(e,r)})}uploadWRTCStats(e){if(!this.store.sessionId)return void nk.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(VU.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=SP("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==UU.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)},SP("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}async sendExtensionMessage(e,t,n){return await this._external_signal.send(e,t,n)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ip((t,n)=>{this.once(FU.WS_CONNECTED,()=>t(this.joinResponse)),this.once(FU.WS_CLOSED,()=>n(this.initError||new pN(hN.WS_ABORT))),this.connectionState=UU.CONNECTING,this.websocket.init(e).catch(n)})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=e||UN.LEAVE,this.connectionState=UU.CLOSED,nk.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=vO(6,""),this._external_signal.clear(),this._external_signal=new WX(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(FU.ABORT_P2P_EXECUTION);const e=await YN(this,FU.REQUEST_JOIN_INFO),t=await this.request(jU.JOIN,e);if(!t)return this.emit(FU.REPORT_JOIN_GATEWAY,hN.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(FU.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=UU.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}async downgradeCodec(e){return!1}handleDataStream(e){try{var t;const n=dO(e.payload),r=(new TextDecoder).decode(n),i=JSON.parse(r);"total"in i&&"id"in i||xr(t=Object.values(DF)).call(t,i._type)?(i._uid=e.uid,this._external_signal.onMessage(i)):this.emit(BU.ON_DATA_STREAM,e)}catch(t){this.emit(BU.ON_DATA_STREAM,e)}}handleNotification(e){nk.debug("[".concat(this.clientId,"] receive notification: "),e);const t=VF(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?e.code===MU.ERR_REPEAT_JOIN_CHANNEL&&SP("IGNORE_UID_CHECK")?void this.close(UN.UID_CONFLICT):("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(UN.UID_BANNED),void this.close()):void this.reconnect(t.action,GN.SERVER_ERROR);nk.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=SP("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(nk.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>SP("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",GN.TIMEOUT):this.request(jU.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),SP("REPORT_STATS")&&this.send(jU.PING_BACK,{pingpongElapse:e})}).catch(e=>{})}handleWebsocketEvents(){this.websocket.on(HU.RECONNECT_CREATE_CONNECTION,e=>{this.emit(FU.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(HU.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(HU.CLOSED,()=>{this.connectionState=UU.CLOSED}),this.websocket.on(HU.FAILED,()=>{this._disconnectedReason=UN.NETWORK_ERROR,this.connectionState=UU.CLOSED}),this.websocket.on(HU.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===UU.CONNECTED?this.connectionState=UU.RECONNECTING:this.connectionState=UU.CONNECTING}),this.websocket.on(HU.WILL_RECONNECT,(e,t,n)=>{"retry"!==e?(nk.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0):nk.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),n(e)}),this.websocket.on(HU.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(e=>{if(this.emit(FU.REPORT_JOIN_GATEWAY,e,this.url||""),e instanceof pN&&e.code===hN.UNEXPECTED_RESPONSE&&e.data.code===MU.ERR_NO_AUTHORIZED)return nk.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",GN.SERVER_ERROR);nk.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",GN.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(HU.REQUEST_NEW_URLS,(e,t)=>{YN(this,FU.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)}),this.websocket.on(HU.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(BU.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const GX={name:"P2PChannel",create:function(e){let{store:t,statsCollector:n}=e;return new VX(t,n)},createSubmodule:function(e){let{store:t,spec:n}=e;return new HX(n,t)}};function zX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function KX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zX(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class YX{constructor(e){nR(this,"sessionDesc",void 0),nR(this,"localCapabilities",void 0),nR(this,"rtpCapabilities",void 0),nR(this,"candidates",void 0),nR(this,"_originCandidates",void 0),nR(this,"iceParameters",void 0),nR(this,"dtlsParameters",void 0),nR(this,"setup",void 0),nR(this,"currentMidIndex",void 0),nR(this,"cname",void 0),e=aO(e);const{iceParameters:t,dtlsParameters:n,candidates:r,rtpCapabilities:i,setup:o,localCapabilities:a,sdkCodec:s,cname:c}=e,l=DP("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=i,this.candidates=r,this._originCandidates=aO(r),this.iceParameters=t,this.dtlsParameters=n,this.setup=o,this.localCapabilities=a,this.cname=c;for(let d=0;d<l.mediaDescriptions.length;d++){const e=l.mediaDescriptions[d];if(e.attributes.iceUfrag=t.iceUfrag,e.attributes.icePwd=t.icePwd,e.attributes.fingerprints=n.fingerprints,e.attributes.candidates=r,e.attributes.setup=o,"video"===e.media.mediaType){e.media.fmts=i.videoCodecs.map(e=>e.payloadType.toString(10));const t=i.videoCodecs.filter(e=>{var t,n;return null===(t=e.rtpMap)||void 0===t?void 0:xr(n=t.encodingName.toLowerCase()).call(n,s)}),n=i.videoCodecs.filter(e=>!xr(t).call(t,e));e.attributes.payloads=[...t,...n],e.attributes.extmaps=i.videoExtensions}"audio"===e.media.mediaType&&(e.media.fmts=i.audioCodecs.map(e=>e.payloadType.toString(10)),e.attributes.payloads=i.audioCodecs,e.attributes.extmaps=i.audioExtensions),l.mediaDescriptions[d]=this.mungMediaDesc(e)}this.sessionDesc=l,this.currentMidIndex=l.mediaDescriptions.length-1}toString(){return xP(this.sessionDesc)}send(e,t,n){const{ssrcs:r,ssrcGroups:i}=Dj(t,this.cname),o=this.sessionDesc.mediaDescriptions.find(t=>e===_F.VIDEO?"video"===t.media.mediaType:"audio"===t.media.mediaType),a=r[0].attributes.label,s=r[0].attributes.mslabel;return o.attributes.ssrcs=o.attributes.ssrcs.concat(r),o.attributes.ssrcGroups=o.attributes.ssrcGroups.concat(i),{id:a,mslabel:s}}batchSend(e){return e.map(e=>{let{kind:t,ssrcMsg:n}=e;return this.send(t,n,void 0)})}stopSending(e){this.sessionDesc.mediaDescriptions.forEach(t=>{const n=[],r=[],i=[];t.attributes.ssrcs.forEach(t=>{xr(e).call(e,t.attributes.label||"")?i.push(t):n.push(t)}),t.attributes.ssrcGroups.forEach(e=>{var t;xr(t=i.map(e=>e.ssrcId)).call(t,e.ssrcIds[0])||r.push(e)}),t.attributes.ssrcs=n,t.attributes.ssrcGroups=r})}mute(e){const t=this.sessionDesc.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}receive(e,t,n){e.forEach((e,t)=>{const n=e._mediaStreamTrack,r=this.sessionDesc.mediaDescriptions.findIndex(e=>e.attributes.mid===n.kind),i=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],e);this.sessionDesc.mediaDescriptions[r]=i})}stopReceiving(e){}updateCandidates(e){const t=this._originCandidates.filter(e=>"udp"===e.transport),n=[];if(t.forEach(e=>{n.push(KX(KX({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))}),0!==t.length){switch(e){case vF.TCP_RELAY:this.candidates=n;break;case vF.UDP_TCP_RELAY:case vF.RELAY:this.candidates=[...t,...n];break;default:this.candidates=t}for(const e of this.sessionDesc.mediaDescriptions)e.attributes.candidates=this.candidates}}restartICE(e){e=aO(e),this.iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}mungRecvMediaDsec(e,t){const n=aO(e);return xj(n,t),Mj(n,t),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex(t=>t.attributes.mid===e);if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}updateTrackLabel(e,t,n){const r=this.sessionDesc.mediaDescriptions.find(t=>e===_F.VIDEO?"video"===t.attributes.mid:"audio"===t.attributes.mid);if(r){const e=r.attributes.ssrcs.find(e=>e.attributes.label===t);var i;e&&(e.attributes.label=n,null===(i=e.attributes.msid)||void 0===i||i.replace(t,n))}}mungMediaDesc(e){const t=aO(e);return Lj(t),function(e){const t=e.attributes.extmaps.find(e=>wj(e.extensionName));t&&e.attributes.extmaps.splice(e.attributes.extmaps.indexOf(t),1),e.attributes.payloads.forEach(e=>{const t=e.rtcpFeedbacks.findIndex(e=>"transport-cc"===e.type);-1!==t&&e.rtcpFeedbacks.splice(t,1)})}(t),t}getSSRC(e){for(const t of this.sessionDesc.mediaDescriptions)for(const n of t.attributes.ssrcs)if(n.attributes.label===e)return[n]}}var qX;function XX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?XX(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XX(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let ZX=(qX=class e extends gF{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").filter(e=>{var t;return xr(t=Object.keys(RP)).call(t,e)}))]}constructor(t,n){super(t,n),nR(this,"store",void 0),nR(this,"peerConnection",void 0),nR(this,"remoteSDP",void 0),nR(this,"initialOffer",void 0),nR(this,"statsFilter",void 0),nR(this,"useRTX",!1),nR(this,"localCapabilities",void 0),nR(this,"localCandidateCount",0),nR(this,"allCandidatesReceived",!1),nR(this,"establishPromise",void 0),nR(this,"mutex",void 0),this.store=n,this.mutex=new kO("P2PConnection-mutex",n.clientId),this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=lP(this.peerConnection,SP("STATS_UPDATE_INTERVAL"),void 0,VI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=Nj(e.sdp),n=Ij(e.sdp,{filterRTX:!this.useRTX,filterVideoFec:SP("FILTER_VIDEO_FEC"),filterAudioFec:SP("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=n,this.initialOffer=e,JX(JX({},t),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:n},offerSDP:e.sdp})}catch(e){throw new pN(hN.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async updateRemoteConnect(){}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new YX(JX(JX({},e),{},{rtpCapabilities:e.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const t=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:t})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async updateRemoteRTPCapabilities(e,t){throw new pN(hN.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(e){}send(e,t){var n=this;return LA(function*(){const r=yield UA(n.mutex.lock());try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const r=e.map(e=>n.peerConnection.addTrack(e._mediaStreamTrack)),i=yield UA(n.peerConnection.createOffer()),o=DP(i.sdp),a=e.map(e=>{const t=e._mediaStreamTrack,r=o.mediaDescriptions.find(e=>e.attributes.mid===t.kind);if(!r)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t,n){const r=e.attributes.ssrcs.filter(e=>e.attributes.label===t),i=e.attributes.ssrcGroups;if(0===r.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(i&&r.length>1){const e=i.find(e=>-1!==e.ssrcIds.indexOf(r[0].ssrcId));return e?[{ssrcId:e.ssrcIds[0],rtx:n?e.ssrcIds[1]:void 0}]:[{ssrcId:r[0].ssrcId}]}return[{ssrcId:r[0].ssrcId}]}(r,t.id,n.useRTX)});let s;try{s=yield a}catch(e){throw r.forEach(e=>{UI()&&e.replaceTrack(null),n.peerConnection.removeTrack(e)}),e}const c=n.mungSendOfferSDP(i.sdp,e);n.remoteSDP.receive(e,t,s);const l=n.remoteSDP.toString();return yield UA(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield UA(n.applySendEncodings(r,e)),yield UA(n.peerConnection.setRemoteDescription({type:"answer",sdp:l})),e.map((e,t)=>{const n=e._mediaStreamTrack.id;return{localSSRC:a[t],id:n}})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{r()}})()}async stopSending(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getSenders().filter(t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")});if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map(e=>{UI()&&e.replaceTrack(null),this.peerConnection.removeTrack(e)});const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:n,mslabel:i}=this.remoteSDP.send(e,t,r),o=new ip((t,r)=>{const o=setTimeout(()=>{r(new Error("Cannot receive track, id: ".concat(n)))},1e4),a=r=>{const s=PI();if(("Safari"===s.name&&11===Number(s.version)||BI())&&r.track.id!==n&&r.streams[0].id===i){var c;const i=r.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(e,n,r.track.id),this.peerConnection.removeEventListener("track",a),clearTimeout(o),void t(i)}if(r.track.id===n)return this.peerConnection.removeEventListener("track",a),clearTimeout(o),void t(r.track)};this.peerConnection.addEventListener("track",a)}),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const s=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(s),{track:await o,id:n}}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(n)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter(t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")});if(t.length!==e.length)throw new Error("sender' length doesn't match mids' length.");t.map(e=>{if(UI()&&e.track)e.track.enabled=!1;else{const t=e.getParameters();t.encodings.forEach(e=>e.active=!1),e.setParameters(t)}})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter(t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")});if(t.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");t.map(async e=>{if(UI()&&e.track)e.track.enabled=!0;else{const t=e.getParameters();t.encodings.forEach(e=>e.active=!0),await e.setParameters(t)}});const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return LA(function*(){const n=yield UA(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const n=pk().supportPCSetConfiguration;if(e===vF.RELAY&&!n)return;if(n){const n=t.peerConnection.getConfiguration(),r=e===vF.RELAY?"relay":"all";n.iceTransportPolicy!==r&&(nk.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(n.iceTransportPolicy,"] to [").concat(r,"]")),n.iceTransportPolicy=r,t.peerConnection.setConfiguration(n))}e!==vF.RELAY&&t.remoteSDP.updateCandidates(e);const r=yield UA(t.peerConnection.createOffer({iceRestart:!0}));if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const i=Nj(r.sdp),{remoteIceParameters:o}=yield i.iceParameters;t.remoteSDP.restartICE(o);const a=t.remoteSDP.toString();yield UA(t.peerConnection.setLocalDescription(r)),yield UA(t.peerConnection.setRemoteDescription({type:"answer",sdp:a}))}catch(e){nk.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}})()}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const e=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(e.sdp,[t]);this.remoteSDP.updateRecvMedia(t._mediaStreamTrack.kind,t);const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getSenders().filter(t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e});1===n.length&&await this.applySendEncodings(n,[t])}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getSenders().find(e=>{var n;return(null===(n=e.track)||void 0===n?void 0:n.id)===t});n&&await n.replaceTrack(e._mediaStreamTrack)}createDataChannels(e,t){throw new pN(hN.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(e){throw new pN(hN.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},SP("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(FN(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),SP("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(e=>{e.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach(e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))}),t}async updateRtpSenderEncodings(e,t){var n;if(t||(t=this.peerConnection.getSenders().find(t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e._mediaStreamTrack.id})),!t)return nk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(!pk().supportSetRtpSenderParameters)return nk.warn("Browser not support set rtp-sender parameters");const r={},i={};if(e instanceof xL)switch(e._optimizationMode){case"motion":r.degradationPreference="maintain-framerate";break;case"detail":r.degradationPreference="maintain-resolution";break;default:r.degradationPreference="balanced"}if(SP("DSCP_TYPE")&&aN()){var o;const e=SP("DSCP_TYPE");xr(o=["very-low","low","medium","high"]).call(o,e)&&(i.networkPriority=e)}const a=t.getParameters(),s=null===(n=a.encodings)||void 0===n?void 0:n[0];s&&Object.assign(s,i),Object.assign(a,r),nk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(a.encodings))),await t.setParameters(a)}async applySendEncodings(e,t){try{if(!pk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];r&&i&&await this.updateRtpSenderEncodings(i,r)}}catch(e){nk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t){const n=DP(e);return t.forEach((e,t)=>{const r=e._mediaStreamTrack,i=n.mediaDescriptions.find(e=>e.attributes.mid===r.kind);i&&xj(i,e)}),xP(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const t=this.remoteSDP.batchSend(e).map((t,n)=>{let{id:r,mslabel:i}=t;const{kind:o}=e[n];return new ip((e,t)=>{const n=setTimeout(()=>{t(new Error("Cannot receive track, id: ".concat(r)))},1e4),a=t=>{const s=PI();if("Safari"===s.name&&11===Number(s.version)&&t.track.id!==r&&t.streams[0].id===i){var c;const i=t.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(o,r,t.track.id),this.peerConnection.removeEventListener("track",a),clearTimeout(n),void e({track:i,id:r})}if(t.track.id===r)return this.peerConnection.removeEventListener("track",a),clearTimeout(n),void e({track:t.track,id:r})};this.peerConnection.addEventListener("track",a)})}),n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const r=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(r),await ip.all(t)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}setConfiguration(t){if(pk().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},PU(qX.prototype,"connect",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"connect"),qX.prototype),PU(qX.prototype,"stopSending",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"stopSending"),qX.prototype),PU(qX.prototype,"receive",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"receive"),qX.prototype),PU(qX.prototype,"stopReceiving",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"stopReceiving"),qX.prototype),PU(qX.prototype,"muteRemote",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"muteRemote"),qX.prototype),PU(qX.prototype,"unmuteRemote",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"unmuteRemote"),qX.prototype),PU(qX.prototype,"muteLocal",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"muteLocal"),qX.prototype),PU(qX.prototype,"unmuteLocal",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"unmuteLocal"),qX.prototype),PU(qX.prototype,"close",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"close"),qX.prototype),PU(qX.prototype,"updateEncoderConfig",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"updateEncoderConfig"),qX.prototype),PU(qX.prototype,"updateSendParameters",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"updateSendParameters"),qX.prototype),PU(qX.prototype,"replaceTrack",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"replaceTrack"),qX.prototype),PU(qX.prototype,"getRemoteSSRC",[QX],Object.getOwnPropertyDescriptor(qX.prototype,"getRemoteSSRC"),qX.prototype),qX);function QX(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("Locking from P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}const $X={name:"PlanBConnection",create:function(e){let{store:t,spec:n}=e;return new ZX(n,t)}},eJ={interceptLocalAudioFrame:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!pk().supportWebRTCEncodedTransform)return void nk.warning("browser not support audio encoded transform");if(hM.has(e))return;if(!e.track)return;const n={track:e.track};if(MI()){if(!e.createEncodedStreams)return void nk.warning("browser not support createEncodedStreams() API");let i=null;try{i=e.createEncodedStreams()}catch(e){return void nk.error("create audio-encoded-streams error",e&&e.message)}const o=new TransformStream({transform(i,o){n.controller||(n.controller=o),e.track&&e.track.id!==n.track.id&&(nk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const a=t.metadata&&t.metadata();a?function(e,t){const{chunk:n,controller:r}=t,i=dM.METADATA;n.data=function(e,t,n){const r=n.byteLength,i=r+cM+lM,o=aM+sM+i,a=new ArrayBuffer(e.byteLength+o),s=new DataView(a);s.setUint8(0,oM),s.setUint16(1,i),s.setUint8(3,t),s.setUint16(4,r);for(let l=0;l<r;l++)s.setUint8(6+l,n[l]);const c=new Uint8Array(s.buffer);return c.set(new Uint8Array(e),o),c.buffer}(n.data,i,e),r.enqueue(n)}(a,{sender:e,chunk:i,controller:o}):o.enqueue(i)}});i.readable.pipeThrough(o).pipeTo(i.writable)}else if(UI()){if("undefined"==typeof RTCRtpScriptTransform)return void nk.warning("browser not support RTCRtpScriptTransform");const i=iM(),o=new MessageChannel;await new ip(e=>i.onmessage=t=>{"registered"===t.data&&e(void 0)});const a=new RTCRtpScriptTransform(i,{name:"audio-metadata-tx",port:o.port2},[o.port2]);e.transform=a,await new ip(e=>i.onmessage=t=>{"started"===t.data&&e(void 0)}),o.port1.onmessage=i=>{var a;if(i.data.transformed&&e.track&&(null===(a=e.track)||void 0===a?void 0:a.id)!==n.track.id)nk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r);else if(i.data.getMetadata){const e=t.metadata&&t.metadata();e&&o.port1.postMessage({metadata:e})}},n.worker=i}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}const t=hM.get(e);if(t){hM.delete(e);try{var n,i;null===(n=t.controller)||void 0===n||n.terminate(),null===(i=t.worker)||void 0===i||i.terminate()}catch(e){nk.warning(e&&e.message)}}}hM.set(e,n),e.track.addEventListener("ended",r)},interceptRemoteAudioFrame:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!pk().supportWebRTCEncodedTransform)return void nk.warning("browser not support audio encoded transform");if(xM.has(e))return;const n={track:e.track,onMetadata:t.onMetadata,onPts:t.onPts};if(MI()&&!BI()){if(!e.createEncodedStreams)return void nk.warning("browser not support createEncodedStreams() API");GI(AI.CHROME,87,116)||(t.enableTopn=!1);let i=null;try{i=e.createEncodedStreams()}catch(e){return void nk.error("create audio-encoded-streams error",e&&e.message)}const o=new TransformStream({transform(i,o){n.controller||(n.controller=o),e.track&&e.track.id!==n.track.id&&(nk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r)),t.enableTopn?function(e,t,n){var r;const i=uM(new DataView(t.data));if(!i)return n.enqueue(t);const o=e.track.id;LM.set(o,e.track);const a=null===(r=i.tlv.find(e=>e.tag===dM.AUDIO_LEVEL))||void 0===r?void 0:r.value;let s=0;"number"==typeof a&&(s=127-a);const c=Math.round(Math.pow(10,s/60)-1),{selected:l,speaker:d}=function(e,t){let n=CM.get(e);if(n||(n=function(e){const t=new EM;return CM.set(e,t),wM||(wM=new TM(SP("TOPN_SILENCE_THRESHOLD")||500),wM.on("ActiveSpeakerChanged",e=>{null!=e&&(RM=e)})),wM.addSpeakers([t]),t}(e)),CM.size<=AM)return{selected:!0,speaker:n};if(!wM)throw new Error("no active speaker detector");return wM.levelChanged(n.id,t),IM=wM.loudest.map(e=>e.id),RM&&!xr(IM).call(IM,RM)&&IM.length>=AM&&IM.pop(),{selected:xr(IM).call(IM,n.id)||n.id===RM,speaker:n}}(e,c),u=function(e,t,n){const r=NM.get(e)||new PM(e,t);return r.score=n,NM.set(e,r),function(e){if(OM.set(e,!0),!kM)return void(kM=Date.now());const t=Date.now();t-kM>1e3&&(OM.get(e)?OM.set(e,!1):(DM(e),OM.delete(e)),kM=t)}(e),r}(o,e.track,d.energyScore);u.addSample(l),u.active&&(t.data=i.frame.buffer,n.enqueue(t))}(e,i,o):t.enableMetadata||t.enablePts?function(e,t,n,r){const i=new DataView(e.data),o=i.getUint8(0);let a;if(0!=(128&o)&&71!==o){const t=function(e){if(e.byteLength<=0)return[];const t=[];let n=0;for(;n<e.byteLength;){const r=(128&e.getUint8(n))>>7,i=127&e.getUint8(n);if(!(r&&n+4<=e.byteLength)){n++;break}{const r=e.getUint32(n,!1),o=(16776192&r)>>10,a=1023&r;t.push({pt:i,ts_offset:o,length:a,data:new Uint8Array}),n+=4}}let r=e.byteLength-n;for(const i of t){if(i.length>r)return console.warn("Broken red payload"),[];i.length>0&&(i.data=new Uint8Array(e.buffer,e.byteOffset+n,i.length),n+=i.length,r-=i.length)}if(r>0){const i={pt:t.length>0?t[t.length-1].pt:0,ts_offset:0,length:r,data:new Uint8Array(e.buffer,e.byteOffset+n,r)};t.push(i)}return t}(i);if(t.length>0){const n=function(e){let t=0;for(let i=0;i<e.length;i++)t+=i<e.length-1?4:1,t+=e[i].length;const n=new Uint8Array(t);let r=0;for(let i=0;i<e.length;i++)if(i<e.length-1){const t=(2147483648|(127&e[i].pt)<<24|(262143&e[i].ts_offset)<<10|1023&e[i].length)>>>0;n[r++]=t>>24&255,n[r++]=t>>16&255,n[r++]=t>>8&255,n[r++]=255&t}else n[r++]=127&e[i].pt;for(const i of e)n.set(i.data,r),r+=i.length;return n}(t.map(e=>{const t=new Uint8Array(e.length);t.set(e.data);const n=uM(new DataView(t.buffer));return null!=n&&n.frame&&(e.data=null==n?void 0:n.frame),a=n,e}));e.data=n.buffer}}else a=uM(i),a&&(e.data=a.frame.buffer);if(t.enqueue(e),!a)return;const s=a.tlv.find(e=>e.tag===dM.METADATA);s&&n&&s.value instanceof Uint8Array&&n(s.value);const c=a.tlv.find(e=>e.tag===dM.AUDIO_64_BIT_PTS);c&&r&&c.value instanceof Uint8Array&&8==c.value.length&&r(new DataView(c.value.buffer).getBigUint64(0,!0))}(i,o,t.onMetadata,t.onPts):o.enqueue(i)}});i.readable.pipeThrough(o).pipeTo(i.writable)}else{if("undefined"==typeof RTCRtpScriptTransform)return void nk.warning("browser not support RTCRtpScriptTransform");const t=iM(),i=new MessageChannel;await new ip(e=>t.onmessage=t=>{"registered"===t.data&&e(void 0)});const o=new RTCRtpScriptTransform(t,{name:"audio-metadata-rx",port:i.port2},[i.port2]);e.transform=o,await new ip(e=>t.onmessage=t=>{"started"===t.data&&e(void 0)}),i.port1.onmessage=t=>{var i;t.data.transformed&&e.track&&(null===(i=e.track)||void 0===i?void 0:i.id)!==n.track.id?(nk.debug("audio track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r)):t.data.metadata&&n.onMetadata?n.onMetadata(t.data.metadata):t.data.pts&&n.onPts&&n.onPts(t.data.pts)},n.worker=t}function r(){e.track.removeEventListener("ended",r),function(e){const t=xM.get(e);if(t){!function(e){const t=CM.get(e);t&&(CM.delete(e),wM&&(wM.removeSpeakers([t]),0===CM.size&&(wM.destroy(),wM=null)))}(e),DM(e.track.id),xM.delete(e);try{var n,r;null===(n=t.controller)||void 0===n||n.terminate(),null===(r=t.worker)||void 0===r||r.terminate()}catch(e){nk.warning(e&&e.message)}}}(e)}xM.set(e,n),e.track.addEventListener("ended",r)},interceptLocalVideoFrame:async function(e,t){if(!pk().supportWebRTCEncodedTransform)return void nk.warning("browser not support video encoded transform");if(BM.has(e))return;if(!e.track)return;const n={track:e.track};if(MI()){if(!e.createEncodedStreams)return void nk.warning("browser not support createEncodedStreams() API");let i=null;try{i=e.createEncodedStreams()}catch(e){return void nk.error("create video-encoded-streams error",e&&e.message)}const o=[];t.on("sei-to-send",e=>{o.push(e)});const a=new TransformStream({transform(t,i){n.controller||(n.controller=i),e.track&&e.track.id!==n.track.id&&(nk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const a=VM(new Uint8Array(t.data)),s=o.shift();if(s){const e=function(e,t,n){switch(n){case MM:return function(e,t){const n=jM(t),r=n.length,i=Math.floor(r/255),o=r%255,a=new Uint8Array(6+i+1+r+e.byteLength);a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=6,a[5]=101;let s=0;for(;s<i;)a[6+s]=255,s++;return a[6+s]=o,s++,a.set(n,6+s),a.set(new Uint8Array(e),6+s+r),a.buffer}(e,t);case UM:return function(e,t){const n=jM(t),r=n.length,i=Math.floor(r/255),o=r%255,a=new Uint8Array(7+i+1+r+1+e.byteLength);a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=78,a[5]=1,a[6]=101;let s=0;for(;s<i;)a[7+s]=255,s++;return a[7+s]=o,s++,a.set(n,7+s),s+=r,a[7+s]=128,s++,a.set(new Uint8Array(e),7+s),a.buffer}(e,t);default:return null}}(t.data,s,a);e&&(t.data=e)}i.enqueue(t)}});i.readable.pipeThrough(a).pipeTo(i.writable)}else{if(!UI())return;{if("undefined"==typeof RTCRtpScriptTransform)return void nk.warning("browser not support RTCRtpScriptTransform");const i=iM(),o=new MessageChannel;await new ip(e=>i.onmessage=t=>{"registered"===t.data&&e(void 0)});const a=new RTCRtpScriptTransform(i,{name:"sei-tx",port:o.port2},[o.port2]);e.transform=a,await new ip(e=>i.onmessage=t=>{"started"===t.data&&e(void 0)}),t.on("sei-to-send",e=>{o.port1.postMessage({sei:e})}),o.port1.onmessage=t=>{var i;t.data.transformed&&e.track&&(null===(i=e.track)||void 0===i?void 0:i.id)!==n.track.id&&(nk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r))},n.worker=i}}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}const t=BM.get(e);if(t){BM.delete(e);try{var n,i;null===(n=t.controller)||void 0===n||n.terminate(),null===(i=t.worker)||void 0===i||i.terminate()}catch(e){nk.warning(e&&e.message)}}}BM.set(e,n),e.track.addEventListener("ended",r)},interceptRemoteVideoFrame:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!pk().supportWebRTCEncodedTransform)return void nk.warning("browser not support video encoded transform");if(!e.track)return;if(WM.has(e)){const n=WM.get(e);return void(n&&(n.onSei=t.onSei))}const n={track:e.track,onSei:t.onSei};if(MI()){if(!e.createEncodedStreams)return void nk.warning("browser not support createEncodedStreams() API");let i=null;try{i=e.createEncodedStreams()}catch(e){return void nk.error("create video-encoded-streams error",e&&e.message)}const o=new TransformStream({transform(i,o){if(n.controller||(n.controller=o),!n.firstFrameInfo){var a;const e=i.getMetadata()||{};n.firstFrameInfo=cD({type:i.type,rtpTimestamp:i.timestamp,payloadType:e.payloadType||0,ssrc:e.synchronizationSource||0,length:i.data.byteLength},"mimeType"in e?{mimeType:e.mimeType}:{}),null===(a=t.onFirstFrame)||void 0===a||a.call(t,n.firstFrameInfo)}e.track&&e.track.id!==n.track.id&&(nk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r));const s=function(e,t){switch(t){case MM:return function(e){const t=new DataView(e.data);let n=0;for(;n+4<e.data.byteLength;){if(0===t.getUint8(n+0)&&0===t.getUint8(n+1)&&0===t.getUint8(n+2)&&1===t.getUint8(n+3)&&6===t.getUint8(n+4)){let r=n+6,i=0,o=0;for(;255===(o=t.getUint8(r++));)i+=255;i+=o;const a=FM(e.data,r,i);return new Uint8Array(a)}n++}return null}(e);case UM:return function(e){const t=new DataView(e.data);let n=0;for(;n+5<e.data.byteLength;){if(0===t.getUint8(n+0)&&0===t.getUint8(n+1)&&0===t.getUint8(n+2)&&1===t.getUint8(n+3)&&78===t.getUint8(n+4)&&1===t.getUint8(n+5)&&101===t.getUint8(n+6)){let r=n+7,i=0,o=0;for(;255===(o=t.getUint8(r++));)i+=255;i+=o;const a=FM(e.data,r,i);return new Uint8Array(a)}n++}return null}(e);default:return null}}(i,VM(new Uint8Array(i.data)));s&&n.onSei&&n.onSei(s),o.enqueue(i)}});i.readable.pipeThrough(o).pipeTo(i.writable)}else if(UI()){if("undefined"==typeof RTCRtpScriptTransform)return void nk.warning("browser not support RTCRtpScriptTransform");const i=iM(),o=new MessageChannel;await new ip(e=>i.onmessage=t=>{"registered"===t.data&&e(void 0)});const a=new RTCRtpScriptTransform(i,{name:"sei-rx",port:o.port2},[o.port2]);e.transform=a,await new ip(e=>i.onmessage=t=>{"started"===t.data&&e(void 0)}),o.port1.onmessage=i=>{var o;if(i.data.transformed&&e.track&&(null===(o=e.track)||void 0===o?void 0:o.id)!==n.track.id)nk.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",r),n.track=e.track,n.track.addEventListener("ended",r);else if(i.data.sei&&n.onSei)n.onSei(i.data.sei);else if(i.data.firstFrameInfo&&t.onFirstFrame){var a;null===(a=t.onFirstFrame)||void 0===a||a.call(t,i.data.firstFrameInfo)}},n.worker=i}function r(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",r)}!function(e){const t=WM.get(e);if(t){WM.delete(e);try{var n,r;null===(n=t.controller)||void 0===n||n.terminate(),null===(r=t.worker)||void 0===r||r.terminate()}catch(e){nk.warning(e&&e.message)}}}(e)}WM.set(e,n),e.track.addEventListener("ended",r)}},tJ={name:"InterceptFrame",create:()=>eJ};var nJ;function rJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function iJ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rJ(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rJ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let oJ=(nJ=class e extends gF{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").filter(e=>{var t;return xr(t=Object.keys(RP)).call(t,e)}))]}constructor(e,t,n){super(e,t),nR(this,"id",vO(5,"connection-")),nR(this,"store",void 0),nR(this,"peerConnection",void 0),nR(this,"forceTurn",!1),nR(this,"remoteSDP",void 0),nR(this,"initialOffer",void 0),nR(this,"transportEventReceiver",void 0),nR(this,"statsFilter",void 0),nR(this,"extension",{useXR:SP("USE_XR")}),nR(this,"localCapabilities",void 0),nR(this,"remoteCodecs",void 0),nR(this,"localCandidateCount",0),nR(this,"allCandidatesReceived",!1),nR(this,"isPreallocation",!1),nR(this,"preMediaMap",new Map),nR(this,"dataStreamChannelMap",new Map),nR(this,"establishPromise",void 0),nR(this,"recoveredDataChannelIds",[]),nR(this,"currentDataChannelId",1),nR(this,"supportAV1RtpSpec",!1),nR(this,"mutex",void 0),nR(this,"qualityLimitationReason",tP.NONE),nR(this,"isFirstConnected",!1),this.store=t,this.forceTurn=LB(e),this.mutex=new kO("NVConnectionExtension-mutex",t.clientId),this.peerConnection=n,this.isFirstConnected=!1,this.statsFilter=lP(this.peerConnection,SP("STATS_UPDATE_INTERVAL"),void 0,VI()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,e.isPreallocation&&(this.isPreallocation=!0),this.establishPromise=this.establish()}getPreMedia(e){return this.preMediaMap.get(e)}isPreSub(){return this.preMediaMap.size>0}async updateRemoteRTPCapabilities(e,t){if(this.remoteCodecs=t,this.remoteSDP)if(this.remoteSDP.updateRemoteCodec(e,t,this.store.codec)){const e=await this.peerConnection.createOffer(),t=this.logSDPExchange(e.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(e);const n=this.remoteSDP.toString();null==t||t(n),await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}else nk.debug("[NVConnectionExtension] updateRemoteRTPCapabilities no need to exchange SDP.");else nk.debug("[NVConnectionExtension] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(t))}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const t=await this.peerConnection.createOffer();if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const n=Nj(t.sdp),r=await Bj({filterRTX:!SP("USE_PUB_RTX")&&!SP("USE_SUB_RTX"),filterVideoFec:SP("FILTER_VIDEO_FEC"),filterAudioFec:SP("FILTER_AUDIO_FEC"),filterVideoCodec:SP("FILTER_VIDEO_CODEC"),unsupportedVideoUplinkCodec:SP("UNSUPPORTED_VIDEO_UPLINK_CODEC"),unsupportedVideoDownlinkCodec:SP("UNSUPPORTED_VIDEO_DOWNLINK_CODEC")},this.extension);if(this.localCapabilities=Gj(r),this.initialOffer=t,SP("ENABLE_SVC")&&"av1"==this.store.codec){const t=await Vj();var e;t&&(this.supportAV1RtpSpec=!0,null===(e=r.send)||void 0===e||e.videoExtensions.push(t))}let i;return t.sdp&&Qj(t.sdp)&&(i=aO(r),Ej(i)),iJ(iJ({},n),{},{rtpCapabilities:i||r,offerSDP:t.sdp})}catch(e){throw new pN(hN.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnectionExtension without initial offer.");this.initialOffer.sdp&&Qj(this.initialOffer.sdp)&&yj(e.rtpCapabilities,this.localCapabilities),this.remoteSDP=new mB(iJ(iJ({},e),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec,!(!SP("ENABLE_PRE_SUB_WITH_PRE_PC")||!SP("PRE_USE_LOCAL_CODECS"))&&gk(this.store),!0),e.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const t=this.remoteSDP.toString(),n=Xj(this.initialOffer.sdp,this.extension),r=this.logSDPExchange(n||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),null==r||r(t),await this.peerConnection.setRemoteDescription({type:"answer",sdp:t});const i=this.peerConnection.getTransceivers()[0];if(null!=i&&i.receiver&&this.tryBindTransportEvents(i.receiver),gk(this.store))if(e.preallocation&&SP("ENABLE_PRE_SUB_WITH_PRE_PC")){const e=SP("PRE_SUB_NUM"),{mids:t,preSSRCs:n}=this.remoteSDP.preloadRemoteMedia(e);await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[".concat(this.store.clientId,"] [NVConnectionExtension] preload media, in pre pc,add preload ssrcs ").concat(n)),this.presetMedia(t,n)}else{const{preSSRCs:t=[]}=e,n=t.map(e=>e.ssrcMsg[0].ssrcId);if(0===t.length)return;const{mids:r}=this.remoteSDP.batchSend(t.map(e=>Object.assign({},e)));await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[NVConnectionExtension.connect] preload media, after join, add preload ssrcs ".concat(n)),this.presetMedia(r,n)}}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.connect failed; ".concat(e.toString()))}}presetMedia(e,t){e.forEach((e,n)=>{this.peerConnection.getTransceivers().forEach(r=>{if(null!=r.mid&&e===r.mid&&r.receiver.track){const i=r.receiver.track;let o;"video"===i.kind&&SP("ENABLE_PRE_RENDER")&&(o=new Xx({trackId:"track-".concat(i.kind,"-unknown-").concat(this.store.clientId,"_").concat(vO(5,""))},!0),o.updateVideoTrack(i),o.onFirstVideoFrameRender=()=>{var e;const r=this.preMediaMap.get(t[n]);r&&(r.firstVideoRender=Date.now()),null===(e=this.onFirstVideoRender)||void 0===e||e.call(this,t[n])},o.onVideoBufferReady=()=>{var e;null===(e=this.onFirstVideoBufferReady)||void 0===e||e.call(this,t[n])},o.play(this.store.sessionId||void 0)),this.preMediaMap.set(t[n],{mid:e,track:i,player:o,transceiver:r})}}),this.store.peerReceiver()})}checkDtlsParameters(e){return!!this.remoteSDP&&e.length>0&&this.remoteSDP.updateRemoteDtlsParameters(e)}async updateRemoteConnect(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.updateRemoteConnect before remote SDP created");let t=!1;const{rtpCapabilities:n}=e;if([,t]=this.remoteSDP.updateRemoteRTPCapabilities(n),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0){const e=this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);t=t||e}const{preSSRCs:r=[]}=e,i=r.map(e=>e.ssrcMsg[0].ssrcId);if(!this.remoteSDP.checkPreloadSsrcs(i)){const e=[],t=[];if(Array.from(this.preMediaMap.entries()).every(n=>{let[r,{mid:i,player:o,track:a}]=n;return e.push(i),t.push(r),this.preMediaMap.delete(r),o&&o.destroy(),!0}),e.length>0&&(this.remoteSDP.stopSending(e),await qj(this.peerConnection,this.remoteSDP,this.extension),nk.warn("[NVConnectionExtension.updateRemoteConnect] preload media, failed, del preload ssrcs ".concat(t)),dk.reportApiInvoke(this.store.sessionId,{name:DN.PRELOAD_MEDIA_FAILED,options:[r,t],tag:xN.TRACER}).onSuccess()),r.length>0){const{mids:e}=this.remoteSDP.batchSend(r.map(e=>Object.assign({},e)));await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[NVConnectionExtension.updateRemoteConnect] preload media, after join, add preload ssrcs ".concat(i)),this.presetMedia(e,i)}}t?(await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[NVConnectionExtension] updateRemoteConnect by exchanging SDP.")):nk.debug("[NVConnectionExtension] updateRemoteConnect no need to exchange SDP, because no need to update remote codecs (use local codecs)")}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.updateRemoteConnect failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return LA(function*(){const i=yield UA(r.mutex.lock("From NVConnectionExtension.send"));try{if(!r.remoteSDP)throw new Error("Cannot call NVConnectionExtension.send before remote SDP created");const o=[],a=vj();e.forEach(e=>{const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,iJ({direction:"sendonly"},"video"===e.trackMediaType&&r.supportAV1RtpSpec&&a?{sendEncodings:[{scalabilityMode:a}]}:{}));o.push(t),e._updateRtpTransceiver(t)}),VI()&&!0===SP("SIMULCAST")&&(yield UA(r.applySimulcastForFirefox(o,e)));const s=yield UA(r.peerConnection.createOffer()),c=r.remoteSDP.predictReceivingMids(e.length),l=r.mungSendOfferSDP(s.sdp,e,c),d=DP(l),u=c.map(e=>{const t=d.mediaDescriptions.find(t=>t.attributes.mid===e);if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return Oj(t,SP("USE_PUB_RTX"))});let h;try{h=yield u}catch(i){h=[],r.remoteSDP.receive(e,t,n,h);const o=r.remoteSDP.toString();throw yield UA(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield UA(r.peerConnection.setRemoteDescription({type:"answer",sdp:o})),yield UA(r.stopSending(c,!0)),i}r.remoteSDP.receive(e,t,n,h);const p=r.remoteSDP.toString(),m=r.logSDPExchange(l,"offer","local","send");return yield UA(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield UA(r.applySimulcastEncodings(o,e)),yield UA(r.applySendEncodings(o,e)),null==m||m(p),yield UA(r.peerConnection.setRemoteDescription({type:"answer",sdp:p})),o.map((e,t)=>{const n=c[t];return{localSSRC:u[t],id:n,transceiver:e}})}catch(e){throw e instanceof pN?e:new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.send failed; ".concat(e.toString()))}finally{i()}})()}async createDataChannels(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.createDataChannels before remote SDP created");let n=this.dataStreamChannelMap.get(e);if(n&&"open"===n.readyState)nk.debug("[NVConnectionExtension] Channels are already available and can be reused directly.");else{const t=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if("number"!=typeof t)throw new Error("create DataChannel error, because cannot get dc id");n=this.peerConnection.createDataChannel("datastream-channel",{id:t,negotiated:!0,ordered:!1,maxRetransmits:SP("DATASTREAM_MAX_RETRANSMITS")}),n.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,n)}t.forEach(e=>{e._updateOriginDataChannel(n)});const{needExchangeSDP:r}=this.remoteSDP.sendDataChannel();if(r){const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),nk.debug("[NVConnectionExtension] createDataChannels by exchanging SDP.")}else nk.debug("[NVConnectionExtension] createDataChannels no need to exchange SDP.");return}catch(e){throw e instanceof pN?e:new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.createDataChannels failed; ".concat(e.toString()))}}async stopDataChannels(e){try{const t=this.dataStreamChannelMap.get(e);return t&&(t.id&&this.recoveredDataChannelIds.push(t.id),t.close()),void this.dataStreamChannelMap.delete(e)}catch(e){throw e instanceof pN?e:new pN(hN.DATACHANNEL_FAILED,"NVConnectionExtension.stopDataChannels failed; ".concat(e.toString()))}}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From NVConnectionExtension.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter(t=>-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVConnectionExtension.stopSending.");t.map(e=>{var t;IB(this.id+e.mid,this),e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);o&&(await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[".concat(this.store.clientId,"] [NVConnectionExtension] receive ").concat(e," by exchanging SDP.")));const a=this.peerConnection.getTransceivers().find(e=>e.mid===i);if(!a)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:a.receiver.track,id:i,transceiver:a}}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:n}=this.remoteSDP.batchSend(e);return n&&(await qj(this.peerConnection,this.remoteSDP,this.extension),nk.debug("[".concat(this.store.clientId,"] [NVConnectionExtension] batchReceive by exchanging SDP."))),t.map(e=>{const t=this.peerConnection.getTransceivers().find(t=>t.mid===e);if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e,transceiver:t}})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.stopReceiving before remote SDP created.");e.forEach(e=>{Array.from(this.preMediaMap.entries()).some(t=>{let[n,{mid:r,player:i}]=t;if(r===e)return this.preMediaMap.delete(n),i&&i.destroy(),!0})}),this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter(t=>t.mid&&-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map(e=>{e.direction="inactive"});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter(t=>t.mid&&-1!==e.indexOf(t.mid));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map(async(e,t)=>{e.direction="sendonly"});const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(e,this.remoteCodecs,this.store.codec);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,"NVConnectionExtension.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return LA(function*(){const n=yield UA(t.mutex.lock("From NVConnectionExtension.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const n=pk().supportPCSetConfiguration,r=SP("FORCE_TURN_TCP")||t.forceTurn;if(e===vF.RELAY&&!n)return;if(n&&!r){const n=e===vF.RELAY?"relay":"all",r=t.peerConnection.getConfiguration();r.iceTransportPolicy!==n&&(nk.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(r.iceTransportPolicy,"] to [").concat(n,"]")),r.iceTransportPolicy=n,t.peerConnection.setConfiguration(r))}t.remoteSDP.updateCandidates(e);const i=yield UA(t.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const o=Nj(i.sdp),{remoteIceParameters:a}=yield o.iceParameters;t.remoteSDP.restartICE(a);const s=t.remoteSDP.toString(),c=t.logSDPExchange(i.sdp||"","offer","local","restartICE");t.store.descriptionStart(),yield UA(t.peerConnection.setLocalDescription(i)),null==c||c(s),yield UA(t.peerConnection.setRemoteDescription({type:"answer",sdp:s}))}catch(e){nk.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{n()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const e=await this.mutex.lock("From NVConnectionExtension.extendCandidate");try{this.remoteSDP.updateCandidates(vF.TCP_RELAY),await qj(this.peerConnection,this.remoteSDP,this.extension)}catch(e){nk.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),e)}finally{e()}}close(){var e;this.peerConnection.getTransceivers().forEach(e=>{IB(this.id+e.mid,this)}),this.preMediaMap.forEach(e=>{let{player:t}=e;t&&t.destroy()}),this.preMediaMap.clear(),this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return iJ(iJ({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call NVConnectionExtension.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const i=this.remoteSDP.toString(),o=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==o||o(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new pN(hN.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter(t=>t.mid===e);1===n.length&&(this.isVP8Simulcast(t)?VI()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find(e=>e.mid===t);n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:n,remote:r}=t.getSelectedCandidatePair();return{local:iJ(iJ({},YO),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port}),remote:iJ(iJ({},YO),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;"connected"===this.peerConnection.connectionState&&(this.isFirstConnected=!0),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=e=>{if(e&&(e.errorCode||e.errorText)){var t;const n="code: ".concat(e.errorCode,", message: ").concat(e.errorText),r=e.port?"local: ".concat(e.port):"",i=gj(e.url||"");nk.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: NVConnectionExtension.onICECandidateError(").concat(n,"), url: ").concat(i||"",", host_candidate:").concat(r)),null===(t=this.onICECandidateError)||void 0===t||t.call(this,n)}},this.peerConnection.onicegatheringstatechange=e=>{e&&e.target&&"iceGatheringState"in e.target&&nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(e.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,nk.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},SP("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]},r=t.cloudProxyServer||"disabled";return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&(FN(t.turnServer.servers)?n.iceServers=t.turnServer.servers:SP("NEW_TURN_MODE")&&n.iceServers&&"disabled"===r?(SP("USE_TURN_SERVER_OF_GATEWAY")?t.turnServer.serversFromGateway&&n.iceServers.push(...e.newTurnServerConfigToIceServers(t.turnServer.serversFromGateway)):n.iceServers.push(...e.newTurnServerConfigToIceServers(t.turnServer.servers)),SP("NEW_FORCE_TURN")&&(n.iceTransportPolicy="relay")):"off"!==t.turnServer.mode&&(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),SP("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),SP("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(e=>{e.forceturn&&(n.iceTransportPolicy="relay")}))),SP("ENABLE_ENCODED_TRANSFORM")&&pk().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach(e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!SP("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))}),t}static newTurnServerConfigToIceServers(e){const t=[];return e.forEach(e=>{const n=SP("NEW_TURN_MODE");1===n?t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=udp")}):2===n?t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=tcp")}):3===n?t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":443?transport=tcp")}):4===n&&(t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=udp")}),t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":3478?transport=tcp")}),t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":443?transport=tcp")}))}),t}tryBindTransportEvents(e){const t=e.transport;if(t){this.transportEventReceiver=e,t.onstatechange=()=>{var e;null!=t&&t.state&&(null===(e=this.onDTLSTransportStateChange)||void 0===e||e.call(this,t.state))},t.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const n=t.iceTransport;n&&(n.onstatechange=()=>{const e=null==t?void 0:t.iceTransport.state;var n;e&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,e))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:e,remote:t}=n.getSelectedCandidatePair()||{};if(e&&t){const n=e.address+":"+e.port,r=t.address+":"+t.port;nk.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify(gj(n)),", remote ").concat(JSON.stringify(gj(r))))}}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var n,r;if(!t){const n=this.peerConnection.getSenders();t=n.find(t=>t.track===e._mediaStreamTrack)}if(!t)return nk.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return nk.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!pk().supportSetRtpSenderParameters)return nk.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const i={},o={};switch(e._optimizationMode){case"motion":i.degradationPreference="maintain-framerate";break;case"detail":i.degradationPreference="maintain-resolution";break;case"balanced":i.degradationPreference="balanced"}const a=_j(this.peerConnection,e._mediaStreamTrack),s=JD(e);if(wB(e)&&a&&t&&s&&this.getLocalVideoStats&&xr(n=["vp8","vp9"]).call(n,this.store.codec)){var c;const n=i.degradationPreference||(xr(c=e._hints).call(c,Uk.CUSTOM_TRACK)?SP("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");AB(this.id+a.mid,s,this,n,e=>{t&&this.updateAdaptation(t,e)},this.getLocalVideoStats.bind(this))}if(e._encoderConfig){var l;const{bitrateMax:t,frameRate:n,scaleResolutionDownBy:r}=e._encoderConfig;t&&(o.maxBitrate=1e3*t),(xr(l=e._hints).call(l,Uk.LOW_STREAM)||e.isUseScaleResolutionDownBy)&&(n&&(o.maxFramerate=lj(n)),r&&r>=1&&(o.scaleResolutionDownBy=r))}const{maxFramerate:d}=SP("ENCODER_CONFIG_LIMIT");if(d&&"number"==typeof d&&(o.maxFramerate=o.maxFramerate?Math.min(o.maxFramerate,d):d),SP("DSCP_TYPE")&&aN()){var u;const e=SP("DSCP_TYPE");xr(u=["very-low","low","medium","high"]).call(u,e)&&(o.networkPriority=e)}const h=t.getParameters(),p=null===(r=h.encodings)||void 0===r?void 0:r[0];VI()&&!p&&(i.encodings=[o]),p&&Object.assign(p,o),Object.assign(h,i),nk.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(h.encodings))),await t.setParameters(h),await Zj(this.store.codec,t,SP("SVC_MODE"))}async updateAdaptation(e,t){var n,r;if(!e)return nk.debug("[updateAdaptation] no rtpSender found");if(!pk().supportSetRtpSenderParameters)return nk.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const i={},{bitrateMax:o,frameRate:a,scaleResolutionDownBy:s}=t;o&&(i.maxBitrate=1e3*o),a&&(i.maxFramerate=lj(a)),s&&s>=1&&xr(n=["vp8","vp9"]).call(n,this.store.codec)&&(i.scaleResolutionDownBy=s);const c=e.getParameters(),l=null===(r=c.encodings)||void 0===r?void 0:r[0];l&&Object.assign(l,i),Object.assign(c,{});try{await e.setParameters(c),nk.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(c.encodings)))}catch(t){!("transport"in e)||e.transport&&"connected"===e.transport.state?"connected"!==this.peerConnectionState?nk.debug("[updateAdaptation] peerConnection not connected}"):nk.debug("[updateAdaptation] updateRtpSenderEncodings failed",t):nk.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(e,t){try{if(!pk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];i instanceof xL&&!this.isVP8Simulcast(i)&&await this.updateRtpSenderEncodings(i,r.sender)}}catch(e){nk.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,n){const r=DP(e);return t.forEach((e,t)=>{const i=n[t],o=r.mediaDescriptions.find(e=>e.attributes.mid===i);o&&(xj(o,e),jj(o,e,this.store.codec))}),xP(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,i,o,a;const c=e[s],l=t[s];if(l instanceof xL&&!xr(n=l._hints).call(n,Uk.LOW_STREAM)&&null!==(r=l._encoderConfig)&&void 0!==r&&r.bitrateMax&&(null===(i=l._encoderConfig)||void 0===i?void 0:i.bitrateMax)>200&&null!==(o=l._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(a=l._scalabilityMode)||void 0===a?void 0:a.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=c.sender.getParameters();await c.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!VI()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof xL&&this.isVP8Simulcast(r)){const t=e[n],i={},o={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};i.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const a=t.sender.getParameters();await t.sender.setParameters(Object.assign(a,i))}}}isVP8Simulcast(e){var t,n,r,i,o;return!!(e instanceof xL&&SP("SIMULCAST")&&"vp8"===this.store.codec&&!xr(t=e._hints).call(t,Uk.LOW_STREAM)&&null!==(n=e._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=e._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(i=e._scalabilityMode)&&void 0!==i&&i.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if(SP("SDP_LOGGING"))return nk.upload("[".concat(this.store.clientId,"] exchanging ").concat(n," ").concat(t," SDP during NVConnectionExtension.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return t&&0!==t.length?t[0].ssrcId:void 0}setConfiguration(t){if(pk().supportPCSetConfiguration){const n=e.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}t.isPreallocation&&(this.isPreallocation=!0)}},PU(nJ.prototype,"updateRemoteRTPCapabilities",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"updateRemoteRTPCapabilities"),nJ.prototype),PU(nJ.prototype,"connect",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"connect"),nJ.prototype),PU(nJ.prototype,"updateRemoteConnect",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"updateRemoteConnect"),nJ.prototype),PU(nJ.prototype,"createDataChannels",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"createDataChannels"),nJ.prototype),PU(nJ.prototype,"receive",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"receive"),nJ.prototype),PU(nJ.prototype,"batchReceive",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"batchReceive"),nJ.prototype),PU(nJ.prototype,"stopReceiving",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"stopReceiving"),nJ.prototype),PU(nJ.prototype,"muteRemote",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"muteRemote"),nJ.prototype),PU(nJ.prototype,"unmuteRemote",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"unmuteRemote"),nJ.prototype),PU(nJ.prototype,"muteLocal",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"muteLocal"),nJ.prototype),PU(nJ.prototype,"unmuteLocal",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"unmuteLocal"),nJ.prototype),PU(nJ.prototype,"close",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"close"),nJ.prototype),PU(nJ.prototype,"updateEncoderConfig",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"updateEncoderConfig"),nJ.prototype),PU(nJ.prototype,"updateSendParameters",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"updateSendParameters"),nJ.prototype),PU(nJ.prototype,"replaceTrack",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"replaceTrack"),nJ.prototype),PU(nJ.prototype,"updateAdaptation",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"updateAdaptation"),nJ.prototype),PU(nJ.prototype,"getRemoteSSRC",[aJ],Object.getOwnPropertyDescriptor(nJ.prototype,"getRemoteSSRC"),nJ.prototype),nJ);function aJ(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From NVConnectionExtension.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}var sJ;function cJ(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=jA,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new lJ(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function lJ(e){function t(e){if(Object(e)!==e)return ip.reject(new TypeError(e+" is not an object."));var t=e.done;return ip.resolve(e.value).then(function(e){return{value:e,done:t}})}return lJ=function(e){this.s=e,this.n=e.next},lJ.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?ip.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?ip.reject(e):t(n.apply(this.s,arguments))}},new lJ(e)}let dJ=(sJ=class e extends gF{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(t,n){super(t,n),nR(this,"name","DataChannelConnection"),nR(this,"store",void 0),nR(this,"peerConnection",void 0),nR(this,"cname",void 0),nR(this,"mutex",new kO("DataChannelConnection-mutex")),nR(this,"dataChannel",void 0),nR(this,"_p2pConnection",void 0),nR(this,"establishPromise",void 0),nR(this,"_nvMedia",void 0),this.store=n,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new oJ(t,n,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}getPreMedia(e){var t;return null===(t=this._p2pConnection)||void 0===t?void 0:t.getPreMedia(e)}isPreSub(){var e,t;return null!==(e=null===(t=this._p2pConnection)||void 0===t?void 0:t.isPreSub())&&void 0!==e&&e}async establish(){return await this._p2pConnection.establish()}getP2PConnectionParams(){return this._p2pConnection.establishPromise}updateRtpSenderEncodings(e){return this._p2pConnection.updateRtpSenderEncodings(e)}async connect(e){return this.cname=e.cname,await this._p2pConnection.connect(e),await new ip((t,n)=>{const r=setTimeout(()=>{this.closeSignal(),n(new uk(hN.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(e.candidates))))},SP("DC_CONNECTION_TIMEOUT"));this.dataChannel.onopen=()=>{if("open"===this.dataChannel.readyState)return clearTimeout(r),void t()},this.dataChannel.onerror=e=>{this.closeSignal(),n(e)},this.dataChannel.addEventListener("close",()=>{n(new uk(hN.DATACHANNEL_CONNECTION_TIMEOUT))})}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(e,t){return this._p2pConnection.updateRemoteRTPCapabilities(e,t)}send(e,t,n){var r=this;return LA(function*(){const i=yield UA(r.mutex.lock("From DataChannelConnection.send"));try{return yield*FA(cJ(r._p2pConnection.send(e,t,n)))}finally{i()}})()}async stopSending(e,t){return this._p2pConnection.stopSending(e,t)}async createDataChannels(e,t){return this._p2pConnection.createDataChannels(e,t)}async stopDataChannels(e){return this._p2pConnection.stopDataChannels(e)}async receive(e,t,n,r){return this._nvMedia?(nk.debug("[DataChannelConnection] receive ".concat(e," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(e,t,this.cname)):(nk.debug("[DataChannelConnection] receive ".concat(e," by WebRTC.")),await this._p2pConnection.receive(e,t,n,r))}async batchReceive(e){return[...await this._p2pConnection.batchReceive(e)]}async stopReceiving(e){return await this._p2pConnection.stopReceiving(e)}async muteRemote(e){return await this._p2pConnection.muteRemote(e)}async unmuteRemote(e){return await this._p2pConnection.unmuteRemote(e)}async muteLocal(e){return await this._p2pConnection.muteLocal(e)}async unmuteLocal(e){return await this._p2pConnection.unmuteLocal(e)}restartICE(e){var t=this;return LA(function*(){return yield*FA(cJ(t._p2pConnection.restartICE(e)))})()}close(){var e;null===(e=this._nvMedia)||void 0===e||e.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(e){return this._p2pConnection.getRemoteVideoIsReady(e)}updateRemoteConnect(e){var t;return null===(t=this._nvMedia)||void 0===t||t.setRemoteRtpCapabilities(e),this._p2pConnection.updateRemoteConnect(e)}async updateEncoderConfig(e,t){return await this._p2pConnection.updateEncoderConfig(e,t)}async updateSendParameters(e,t){return await this._p2pConnection.updateSendParameters(e,t)}setStatsRemoteVideoIsReady(e,t){this._p2pConnection.setStatsRemoteVideoIsReady(e,t)}async replaceTrack(e,t){return await this._p2pConnection.replaceTrack(e,t)}async getRemoteSSRC(e){return this._p2pConnection.getRemoteSSRC(e)}logSDPExchange(e,t,n,r){if(SP("SDP_LOGGING"))return nk.upload("exchanging ".concat(n," ").concat(t," SDP during DataChannelConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(FN(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),SP("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),SP("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(e=>{e.forceturn&&(n.iceTransportPolicy="relay")}))),SP("ENABLE_ENCODED_TRANSFORM")&&pk().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach(e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(aj(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!SP("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))}),t}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=e=>{var t;return null===(t=this.onICEConnectionStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onConnectionStateChange=e=>{var t;return null===(t=this.onConnectionStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onDTLSTransportStateChange=e=>{var t;return null===(t=this.onDTLSTransportStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onDTLSTransportError=e=>{var t;return null===(t=this.onDTLSTransportError)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onICETransportStateChange=e=>{var t;return null===(t=this.onICETransportStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstAudioReceived=e=>{var t;return null===(t=this.onFirstAudioReceived)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstVideoReceived=e=>{var t;return null===(t=this.onFirstVideoReceived)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstAudioDecoded=e=>{var t;return null===(t=this.onFirstAudioDecoded)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstVideoRender=e=>{var t;return null===(t=this.onFirstVideoRender)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstVideoBufferReady=e=>{var t;return null===(t=this.onFirstVideoBufferReady)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstVideoDecoded=(e,t,n)=>{var r;return null===(r=this.onFirstVideoDecoded)||void 0===r?void 0:r.call(this,e,t,n)},this._p2pConnection.onFirstVideoDecodedTimeout=e=>{var t;return null===(t=this.onFirstVideoDecodedTimeout)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onSelectedLocalCandidateChanged=(e,t)=>{var n;return null===(n=this.onSelectedLocalCandidateChanged)||void 0===n?void 0:n.call(this,e,t)},this._p2pConnection.onSelectedRemoteCandidateChanged=(e,t)=>{var n;return null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n?void 0:n.call(this,e,t)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0}setConfiguration(e){this._p2pConnection.setConfiguration(e)}},PU(sJ.prototype,"connect",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"connect"),sJ.prototype),PU(sJ.prototype,"updateRemoteRTPCapabilities",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"updateRemoteRTPCapabilities"),sJ.prototype),PU(sJ.prototype,"createDataChannels",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"createDataChannels"),sJ.prototype),PU(sJ.prototype,"receive",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"receive"),sJ.prototype),PU(sJ.prototype,"stopReceiving",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"stopReceiving"),sJ.prototype),PU(sJ.prototype,"muteRemote",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"muteRemote"),sJ.prototype),PU(sJ.prototype,"unmuteRemote",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"unmuteRemote"),sJ.prototype),PU(sJ.prototype,"muteLocal",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"muteLocal"),sJ.prototype),PU(sJ.prototype,"unmuteLocal",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"unmuteLocal"),sJ.prototype),PU(sJ.prototype,"close",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"close"),sJ.prototype),PU(sJ.prototype,"updateEncoderConfig",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"updateEncoderConfig"),sJ.prototype),PU(sJ.prototype,"updateSendParameters",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"updateSendParameters"),sJ.prototype),PU(sJ.prototype,"replaceTrack",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"replaceTrack"),sJ.prototype),PU(sJ.prototype,"getRemoteSSRC",[uJ],Object.getOwnPropertyDescriptor(sJ.prototype,"getRemoteSSRC"),sJ.prototype),sJ);function uJ(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From DataChannelConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return await r.apply(this,o)}finally{n()}},n}function hJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}class pJ extends ON{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;xr(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(IF.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(IF.CONNECTED):"closed"===this._state?this.emit(IF.CLOSED):"failed"===this._state&&this.emit(IF.FAILED))}constructor(e,t,n,r){super(),nR(this,"connectionID",0),nR(this,"currentURLIndex",0),nR(this,"reconnectReason",void 0),nR(this,"_reconnectMode","tryNext"),nR(this,"_initMutex",void 0),nR(this,"_name",void 0),nR(this,"_state","closed"),nR(this,"_reconnectInterrupter",void 0),nR(this,"_url",void 0),nR(this,"_retryConfig",void 0),nR(this,"_reconnectCount",0),nR(this,"_forceCloseTimeout",5e3),nR(this,"_onlineReconnectListener",void 0),nR(this,"_closeEstablishingTransmitter",()=>{}),nR(this,"_store",void 0),nR(this,"_joinChannelServiceRecordIndex",void 0),nR(this,"_transmitter",void 0),nR(this,"_useCompress",void 0),nR(this,"_inflateLength",0),nR(this,"_deflateLength",0),this._store=r,this._name=e,this._retryConfig=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hJ(Object(n),!0).forEach(function(t){nR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hJ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t),this._useCompress=n}resetReconnectCount(e){nk.debug("".concat(this._name," reset reconnect count, reason: ").concat(e)),this._reconnectCount=0}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const e=this._transmitter;t?setTimeout(()=>e.close(),500):e.close(),this._transmitter=void 0}this.state=e?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(e,t){if(!this._transmitter)return void nk.warning("[".concat(this._name,"] can not reconnect, no websocket"));var n;void 0!==e&&(this.reconnectMode=e),nk.debug("[".concat(this._name,"] reconnect is triggered initiative")),"number"==typeof this._joinChannelServiceRecordIndex&&(null===(n=this._store)||void 0===n||n.recordJoinChannelService({status:"error",errors:[new Error(t)]},this._joinChannelServiceRecordIndex));const r=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),r&&r.bind(this._transmitter)({code:9999,reason:t})}getInflateData(){const e=this._inflateLength,t=this._deflateLength;return this.clearInflateData(),{inflateLength:e,deflateLength:t}}setInflateData(e){this._deflateLength=this._deflateLength+e.originLength,this._inflateLength=this._inflateLength+e.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}let mJ=function(e){return e[e.Default=0]="Default",e[e.Ack=1]="Ack",e}({});class fJ{constructor(e,t,n){nR(this,"version",1),nR(this,"initialRTO",void 0),nR(this,"maxBatchAckCount",void 0),nR(this,"maxRTO",void 0),nR(this,"initialRTT",void 0),nR(this,"ID",void 0),nR(this,"rtt",void 0),nR(this,"packetNumber",1),nR(this,"rtoRatioMap",new Map),nR(this,"timeoutMap",new Map),nR(this,"unorderedPacketQueue",[]),nR(this,"batchAckPacketQueue",[]),nR(this,"lastOrderedPacketNumber",0),nR(this,"batchAckTimer",void 0),nR(this,"sendImpl",void 0),nR(this,"receiveImpl",void 0),this.sendImpl=e,this.receiveImpl=t,this.ID=vO(7,"transmitter-"),this.initialRTO=void 0!==(null==n?void 0:n.initialRTO)?n.initialRTO:SP("TRANSMITTER_INITIAL_RTO"),this.initialRTT=void 0!==(null==n?void 0:n.initialRTT)?n.initialRTT:SP("TRANSMITTER_INITIAL_RTT"),this.rtt=void 0!==(null==n?void 0:n.initialRTT)?n.initialRTT:SP("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=void 0!==(null==n?void 0:n.maxBatchAckCount)?n.maxBatchAckCount:SP("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=void 0!==(null==n?void 0:n.maxRTO)?n.maxRTO:SP("TRANSMITTER_MAX_RTO")}packetize(e,t){return{type:mJ.Default,version:this.version,packetNumber:t,payload:e}}serialize(e){switch(e.type){case mJ.Default:{let t;t="string"==typeof e.payload?(new TextEncoder).encode(e.payload):e.payload;const n=new ArrayBuffer(t.length+15),r=new DataView(n);return r.setUint16(0,e.version),r.setUint8(2,e.type),r.setUint32(3,e.packetNumber),TN(r,7,BigInt(e.sendTs)),new Uint8Array(r.buffer).set(t,15),n}case mJ.Ack:{const t=new ArrayBuffer(16),n=new DataView(t);return n.setUint16(0,e.version),n.setUint8(2,e.type),n.setUint32(3,e.maxAckPacketNumber),n.setUint8(7,e.shift),TN(n,8,BigInt(e.ackSendTs)),t}}}deserialize(e){const t=new DataView(e),n=t.getUint16(0),r=t.getUint8(2);switch(r){case mJ.Default:{const i=t.getUint32(3),o=SN(t,7),a=e.slice(15),s=new Uint8Array(a);return{version:n,type:r,packetNumber:i,sendTs:Number(o),payload:s}}case mJ.Ack:{const e=t.getUint32(3),i=t.getUint8(7),o=SN(t,8);return{version:n,type:r,maxAckPacketNumber:e,shift:i,ackSendTs:Number(o)}}default:throw nk.error("[".concat(this.ID,"] Unrecognized packet type ").concat(r)),new Error("Unrecognized packet type ".concat(r))}}sendMessage(e){SP("DC_DEBUG_LOG")&&"string"==typeof e&&nk.debug("[".concat(this.ID,"] sending message packet"),JSON.parse(e));const t=this.packetize(e,this.packetNumber);this.packetNumber=4294967295===this.packetNumber?1:this.packetNumber+1;const n=this.calculateRTO(t),r=window.setTimeout(()=>{this.resendMessage(t)},n);this.timeoutMap.set(t.packetNumber,r),this.sendPacket(t)}onData(e){const t=this.deserialize(e);t.type===mJ.Default?this.ack(t):t.type===mJ.Ack&&(this.updateRTT(t,Math.round(performance.now())),this.clearRTO(t))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(e=>{let[t,n]=e;window.clearTimeout(n)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,void 0!==this.batchAckTimer&&window.clearTimeout(this.batchAckTimer)}resendMessage(e){const t=this.calculateRTO(e),n=window.setTimeout(()=>{SP("DC_DEBUG_LOG")&&"string"==typeof e.payload&&nk.debug("[".concat(this.ID,"] resending message packet"),JSON.parse(e.payload),"timeout: ".concat(t)),this.resendMessage(e)},t);this.timeoutMap.set(e.packetNumber,n),this.sendPacket(e)}calculateRTO(e){const t=this.rtoRatioMap.get(e.packetNumber);if(void 0===t)return this.rtoRatioMap.set(e.packetNumber,1),this.initialRTO;{const n=9*this.rtt/8*t;return this.rtoRatioMap.set(e.packetNumber,t+1),n>this.maxRTO?this.maxRTO:n}}updateRTT(e,t){const n=e.ackSendTs;this.rtt=this.rtt*(7/8)+(t-n-this.rtt)/8}ack(e){if(e.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(e):(this.batchAckPacketQueue.push(e),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(e.payload);;){const e=this.unorderedPacketQueue[0];if(!e){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(e.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(e.packetNumber<=this.lastOrderedPacketNumber){const t={ackSendTs:e.sendTs,maxAckPacketNumber:e.packetNumber,shift:0,type:mJ.Ack,version:this.version};SP("DC_DEBUG_LOG")&&nk.debug("[".concat(this.ID,"] sending ack packet"),t,"packetNumber: ".concat(e.packetNumber)),this.sendPacket(t)}else if(e.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[e.packetNumber-this.lastOrderedPacketNumber-2]=e;const t={ackSendTs:e.sendTs,maxAckPacketNumber:e.packetNumber,shift:0,type:mJ.Ack,version:this.version};SP("DC_DEBUG_LOG")&&nk.debug("[".concat(this.ID,"] sending ack packet"),t,"packetNumber: ".concat(e.packetNumber)),this.sendPacket(t)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const e={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:mJ.Ack,version:this.version};SP("DC_DEBUG_LOG")&&nk.debug("[".concat(this.ID,"] sending batch ack packet"),e,"shift: ".concat(this.batchAckPacketQueue.length-1)),this.sendPacket(e),this.batchAckPacketQueue=[]}sendPacket(e){e.type===mJ.Default&&(e.sendTs=Math.round(performance.now()));const t=this.serialize(e);this.sendImpl(t)}clearRTO(e){for(let t=e.maxAckPacketNumber-e.shift;t<=e.maxAckPacketNumber;t++){const e=this.timeoutMap.get(t);void 0!==e&&window.clearTimeout(e),this.timeoutMap.delete(t),this.rtoRatioMap.delete(t)}}}class gJ extends pJ{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3?arguments[3]:void 0),nR(this,"_initMutex",void 0),nR(this,"_reconnectInterrupter",void 0),nR(this,"_url",void 0),nR(this,"_transmitter",void 0),nR(this,"_addresses",void 0),nR(this,"_reliableTransmission",void 0),nR(this,"_textEncoder",void 0),nR(this,"_textDecoder",void 0),this._textEncoder=new TextEncoder,this._textDecoder=new TextDecoder,this._initMutex=new kO("datachannel");const{timeout:n,timeoutFactor:r}=t,i=Math.max(300,Math.floor(3*n/5)),o=Math.max(1.2,Math.floor(8*r)/10);zN.ONLINE&&(this._retryConfig.timeout=i,this._retryConfig.timeoutFactor=o),ZN.on(KN.NETWORK_STATE_CHANGE,(e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===zN.ONLINE?(this._retryConfig.timeout=i,this._retryConfig.timeoutFactor=o):(this._retryConfig.timeout=n,this._retryConfig.timeoutFactor=r))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;this._forceCloseTimeout=t;const n=(t,n)=>{this._addresses=e,this.currentURLIndex=this._addresses.findIndex(e=>e.fingerprint||SP("FINGERPRINT"));const r=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(r).then(t).catch(n),this.once(IF.CLOSED,()=>n(new uk(hN.WS_DISCONNECT))),this.once(IF.CONNECTED,()=>t())};return this._initMutex.lock().then(e=>new ip((e,t)=>{n(e,t)}).then(()=>{e()}).catch(()=>{e()}))}async sendMessage(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new uk(hN.WS_ABORT,"datachannel is not ready");try{t||(e=JSON.stringify(e));const n=this._textEncoder.encode(e),r=hq(n,{raw:!0});this._reliableTransmission.sendMessage(r)}catch(e){throw new uk(hN.WS_ERR,"send datachannel signal message error"+e.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(e){const t=JSON.stringify(e);return{compressed:t,compressedLength:t.length,origin:e}}sendMessageWithUint8Array(e){return{compressed:e,compressedLength:e.byteLength,origin:e}}createTransmitterConnection(e){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(e.ip,":").concat(e.port),new ip((t,n)=>{var r;const i=()=>{nk.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="recover",this.state="connected",this.resetReconnectCount("opened"),t()},o=async e=>{var r;if(null===(r=this._closeEstablishingTransmitter)||void 0===r||r.call(this),nk.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const r=XN(this,IF.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,i=await this.reconnectWithAction(r);if("closed"===this.state)return void nk.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!i)return n(new uk(hN.WS_DISCONNECT,"datachannel reconnect failed: ".concat(e.code))),void this.close(!0);t()}else n(new uk(hN.WS_DISCONNECT,"datachannel close: ".concat(e.code))),this.close()},a=async e=>{try{var t;null===(t=this._reliableTransmission)||void 0===t||t.onData(e.data)}catch(e){console.log(e)}};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),nk.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(e)));const s=null===(r=this._store)||void 0===r?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),c=Date.now();YN(this,IF.TO_CONNECT_DATACHANNEL).then(e=>{var t,n;if(!e)throw new Error("transmissonInfo not exist yet");const{transmitter:r,close:l}=e;this._transmitter=r,null===(t=this._store)||void 0===t||t.signalChannelOpen();const d=Date.now()-c;nk.debug("[choose dc] dc open cost ".concat(d,"ms")),this._reliableTransmission=new fJ(e=>{var t;this._transmitter&&"open"===this._transmitter.readyState&&(null===(t=this._transmitter)||void 0===t||t.send(e))},e=>{if("string"==typeof e)this.emit(IF.ON_MESSAGE,e);else{const t=mq(e,{raw:!0}).buffer,n=this._textDecoder.decode(t);this.emit(IF.ON_MESSAGE,n)}}),this._closeEstablishingTransmitter=()=>{var e;null===(e=this._reliableTransmission)||void 0===e||e.close(),this._reliableTransmission=void 0,l()},i&&i(),r.onclose=o,r.onmessage=a,null===(n=this._store)||void 0===n||n.recordJoinChannelService({endTs:Date.now(),status:"success"},s),this._joinChannelServiceRecordIndex=s}).catch(e=>{var t;if(null===(t=this._store)||void 0===t||t.recordJoinChannelService({endTs:Date.now(),status:e instanceof uk&&e.code===hN.WS_ABORT?"aborted":"error",errors:[e]},s),"closed"!==this.state){if(e instanceof uk&&e.code===hN.WS_ERR){const t=new uk(hN.WS_ERR,"init datachannel failed! Error: ".concat(e.toString()));return nk.error("[".concat(this._name,"]").concat(t)),void n(t)}o&&o(e)}else n(new uk(hN.WS_DISCONNECT,"datachannel is closed: ".concat(e.toString())))})})}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount)return!1;if(!this._addresses)return!1;if("closed"===this.state)return!1;this._onlineReconnectListener||ZN.networkState!==zN.OFFLINE||(this._onlineReconnectListener=ZN.onlineWaiter&&ZN.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let n=!0;if(this._reconnectInterrupter=()=>{n=!1},t){const t=LO(this._reconnectCount,this._retryConfig);nk.debug("[".concat(this._name,"] wait ").concat(t,"ms to reconnect datachannel, mode: ").concat(e)),await ip.race([_O(t),this._onlineReconnectListener||new ip(()=>{})])}if("closed"===this.state||!n)return!1;this._reconnectCount+=1;const r=async(e,t)=>{this.emit(IF.RECONNECT_CREATE_CONNECTION,t),await this.createTransmitterConnection(e)};try{if("retry"===e){const t=this._addresses[this.currentURLIndex];await r(t,e)}else if("tryNext"===e){this.currentURLIndex+=1;for(let e=this.currentURLIndex;e<this._addresses.length;e++){if(this._addresses[e].fingerprint||SP("FINGERPRINT")){this.currentURLIndex=e;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return nk.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);nk.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const t=this._addresses[this.currentURLIndex];await r(t,e)}else"recover"===e&&(nk.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(IF.FAILBACK));return!0}catch(n){var i,o;return nk.error("[".concat(this._name,"] reconnect failed"),n.toString()),null!=n&&null!==(i=n.data)&&void 0!==i&&i.desc&&Array.isArray(n.data.desc)&&n.data.desc.length&&xr(o=n.data.desc).call(o,"dynamic key expired")?(this.emit(IF.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(e,t)}}}class _J extends ON{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===UU.CONNECTED?this.emit(FU.WS_CONNECTED):e===UU.RECONNECTING?this.emit(FU.WS_RECONNECTING,this._websocketReconnectReason):e===UU.CLOSED&&this.emit(FU.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}processPendingNotifications(){0!==this.pendingNotifications.length&&(nk.debug("[".concat(this.clientId,"] processing ").concat(this.pendingNotifications.length," pending notifications")),this.pendingNotifications.forEach(e=>{let{type:t,message:n}=e;this.emit(t,n),t===BU.ON_NOTIFICATION&&this.handleNotification(n),t===BU.ON_USER_BANNED&&this.handleUserBanned(n)}),this.pendingNotifications=[])}handleUserBanned(e){switch(e.error_code){case 14:this.close(UN.UID_BANNED);break;case 15:this.close(UN.IP_BANNED);break;case 16:this.close(UN.CHANNEL_BANNED)}}constructor(e,t){super(),nR(this,"__name__","DataChannelSignal"),nR(this,"_disconnectedReason",void 0),nR(this,"_websocketReconnectReason",void 0),nR(this,"_connectionState",UU.CLOSED),nR(this,"reconnectToken",void 0),nR(this,"websocket",void 0),nR(this,"openConnectionTime",void 0),nR(this,"clientId",void 0),nR(this,"lastMsgTime",Date.now()),nR(this,"uploadCache",[]),nR(this,"uploadCacheInterval",void 0),nR(this,"rttRolling",new FO(5)),nR(this,"pingpongTimer",void 0),nR(this,"inflateDataTimer",void 0),nR(this,"pingpongTimeoutCount",0),nR(this,"ortc",void 0),nR(this,"joinResponse",void 0),nR(this,"multiIpOption",void 0),nR(this,"initError",void 0),nR(this,"spec",void 0),nR(this,"store",void 0),nR(this,"isJoining",!1),nR(this,"pendingNotifications",[]),nR(this,"onWebsocketMessage",e=>{if(e instanceof ArrayBuffer)return void this.emit(FU.ON_BINARY_DATA,e);const t=JSON.parse(e);if(SP("DC_DEBUG_LOG")&&nk.debug("[datachannel-signal] received packet",t),this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else Object.prototype.hasOwnProperty.call(t,"_type")&&(this.isJoining?t._type===BU.ON_NOTIFICATION||t._type===BU.ON_USER_BANNED?(this.emit(t._type,t._message),t._type===BU.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===BU.ON_USER_BANNED&&this.handleUserBanned(t._message)):(this.pendingNotifications.push({type:t._type,message:t._message}),nk.debug("[".concat(this.clientId,"] cached notification during join: ").concat(t._type))):(this.emit(t._type,t._message),t._type===BU.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===BU.ON_USER_BANNED&&this.handleUserBanned(t._message)))}),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new gJ("gateway-".concat(this.clientId),this.spec.retryConfig,!0,t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===UU.CONNECTED&&this.reconnect("retry",AF.OFFLINE)})}async request(e,t,n,r){const i=vO(6,""),o={_id:i,_type:e,_message:t},a=this.websocket.connectionID,s=()=>new ip((t,n)=>{if(this.connectionState===UU.CONNECTED)return t();const r=()=>{this.off(FU.WS_CLOSED,i),t()},i=()=>{this.off(FU.WS_CONNECTED,r),n(new uk(hN.WS_ABORT))};this.once(FU.WS_CONNECTED,r),this.once(FU.WS_CLOSED,i),e!==jU.PUBLISH&&e!==jU.SUBSCRIBE&&e!==jU.UNSUBSCRIBE&&e!==jU.UNPUBLISH&&e!==jU.CONTROL&&e!==jU.RESTART_ICE||this.once(FU.DISCONNECT_P2P,()=>{n(new uk(hN.DISCONNECT_P2P))}),e!==jU.PUBLISH&&e!==jU.RESTART_ICE||this.once(FU.ABORT_P2P_EXECUTION,()=>{n(new uk(hN.DISCONNECT_P2P))})});if(this.connectionState!==UU.CONNECTING&&this.connectionState!==UU.RECONNECTING||e===jU.JOIN||e===jU.REJOIN||await s(),e===jU.LEAVE&&(this.websocket.unbindDcCloseEventListener(),r=!0),SP("DC_DEBUG_LOG")&&nk.debug("[datachannel-signal] sendMessage",o),await this.websocket.sendMessage(o,!0,!1),r)return;const c=new ip((n,r)=>{let o=!1;const s=(r,i)=>{o=!0,n({isSuccess:"success"===r,message:i||{}}),this.off(FU.WS_CLOSED,c),this.off(FU.WS_RECONNECTING,c),this.emit(FU.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),s);const c=()=>{r(new uk(hN.WS_ABORT,"type: ".concat(e))),this.off(FU.WS_CLOSED,c),this.off(FU.WS_RECONNECTING,c),this.off("res-@".concat(i),s)};this.once(FU.WS_CLOSED,c),this.once(FU.WS_RECONNECTING,c),_O(SP("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==a||o||(nk.warning("dc request timeout, type: ".concat(e)),this.emit(FU.REQUEST_TIMEOUT,e,t))})});let l=null;try{l=await c}catch(r){if(this.connectionState===UU.CLOSED||e===jU.LEAVE)throw new uk(hN.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===jU.JOIN||e===jU.REJOIN?null:(await s(),await this.request(e,t))}if(l.isSuccess)return l.message;const d=Number(l.message.error_code||l.message.code),u=VF(d),h=new uk(hN.UNEXPECTED_RESPONSE,"".concat(u.desc,": ").concat(l.message.error_str),{code:d,data:l.message});return"success"===u.action?l.message:(nk.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(u.desc,", action: ").concat(u.action)),d===MU.ERR_TOO_MANY_BROADCASTERS?e===jU.JOIN||e===jU.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===u.action?h.throw():"quit"===u.action?(this.initError=h,this.close(),h.throw()):(d===MU.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,nk.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",AF.MULTI_IP)):this.reconnect(u.action,AF.SERVER_ERROR),e===jU.JOIN||e===jU.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new ip(n=>{const r=i=>{(!t||t(i))&&(this.off(e,r),n(i))};this.on(e,r)})}uploadWRTCStats(e){if(!this.store.sessionId)return void nk.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(VU.WRTC_STATS,t)}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=SP("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==UU.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)},SP("UPLOAD_CACHE_INTERVAL")||2e3))}}async send(e,t){const n={_type:e,_message:t};await this.websocket.sendMessage(n)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ip((t,n)=>{this.once(FU.WS_CONNECTED,()=>t(this.joinResponse)),this.once(FU.WS_CLOSED,()=>n(this.initError||new uk(hN.WS_ABORT))),this.connectionState=UU.CONNECTING,this.websocket.init(e).catch(n),this.websocket.once(IF.FAILBACK,()=>{n(new uk(hN.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{void 0===this.openConnectionTime&&(nk.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),n(new uk(hN.INIT_DATACHANNEL_TIMEOUT)))},SP("DC_JOIN_WITH_FAILBACK"))})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this.isJoining=!1,this.pendingNotifications=[],this._disconnectedReason=e||UN.LEAVE,this.connectionState=UU.CLOSED,nk.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),e===UN.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new gJ("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),SP("DC_PINGPONG_INTERVAL")),!this.joinResponse){this.emit(FU.ABORT_P2P_EXECUTION),this.store.signalConnected();const e=await YN(this,FU.REQUEST_JOIN_INFO);this.store.joinReq(),this.isJoining=!0,this.pendingNotifications=[];const t=await this.request(jU.JOIN,e);if(this.store.joinRep(),this.ortc=null==e?void 0:e.ortc,!t)return this.emit(FU.REPORT_JOIN_GATEWAY,hN.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(FU.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=UU.CONNECTED,this.isJoining=!1,this.processPendingNotifications(),!0}async rejoin(){if(!this.reconnectToken)throw new uk(hN.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=JN(this,FU.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(jU.REJOIN,e);return!!t&&(this.connectionState=UU.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),SP("DC_PINGPONG_INTERVAL")),t.peers&&t.peers.forEach(e=>{this.emit(BU.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(BU.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(BU.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(BU.MUTE_AUDIO,{uid:e.uid}):this.emit(BU.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(BU.MUTE_VIDEO,{uid:e.uid}):this.emit(BU.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(BU.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(BU.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(BU.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(BU.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(BU.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})}),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}async downgradeCodec(e){if(!this.ortc)return!1;const t={downgrade_codec:e,ortc:this.ortc};return!!await this.request(jU.DOWNGRADE_CODEC,t)}handleNotification(e){nk.debug("[".concat(this.clientId,"] receive notification: "),e);const t=VF(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(UN.UID_BANNED),void this.close()):void this.reconnect(t.action,AF.SERVER_ERROR);nk.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1,SP("DC_DEBUG_LOG")&&console.debug("[datachannel-signal] pingpongTimeoutCount: ".concat(this.pingpongTimeoutCount));const e=SP("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(nk.warning("[datachannel-signal] PINGPONG Timeout. Last Socket Message: ".concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>SP("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("recover",AF.FALLBACK):this.request(jU.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),SP("REPORT_STATS")&&this.send(jU.PING_BACK,{pingpongElapse:e})}).catch(e=>{})}handleInflateData(){const{inflateLength:e,deflateLength:t}=this.websocket.getInflateData();0!==e&&0!==t&&this.upload(VU.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(IF.RECONNECT_CREATE_CONNECTION,e=>{this.emit(FU.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(IF.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(IF.CLOSED,()=>{this.connectionState=UU.CLOSED}),this.websocket.on(IF.FAILED,()=>{this._disconnectedReason=UN.NETWORK_ERROR,this.connectionState=UU.CLOSED}),this.websocket.on(IF.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===UU.CONNECTED?this.connectionState=UU.RECONNECTING:this.connectionState=UU.CONNECTING}),this.websocket.on(IF.WILL_RECONNECT,(e,t)=>{if(JN(this,FU.IS_P2P_DISCONNECTED)&&"retry"===e)return nk.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(FU.NEED_RENEW_SESSION),this.emit(FU.DISCONNECT_P2P),t("tryNext");"retry"!==e&&(nk.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(FU.NEED_RENEW_SESSION),this.emit(FU.DISCONNECT_P2P)),t(e)}),this.websocket.on(IF.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{nk.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",AF.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(FU.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof uk&&e.code===hN.UNEXPECTED_RESPONSE&&e.data.code===MU.ERR_NO_AUTHORIZED)return nk.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",AF.SERVER_ERROR);nk.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",AF.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(IF.REQUEST_NEW_URLS,(e,t)=>{YN(this,FU.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)}),this.websocket.on(IF.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(BU.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(IF.TO_CONNECT_DATACHANNEL,(e,t)=>{YN(this,FU.PRE_CONNECT_PC).then(e).catch(t)}),this.websocket.on(IF.FAILBACK,()=>{void 0!==this.openConnectionTime&&this.emit(FU.DATACHANNEL_FAILBACK)})}}const vJ={name:"DataChannelConnection",create:function(e){let{store:t,spec:n}=e;return new dJ(n,t)}},bJ={name:"DataChannelSignal",create:function(e){let{store:t,spec:n}=e;return new _J(n,t)}};uP(),yP("PROCESS_ID","process-".concat(vO(8,""),"-").concat(vO(4,""),"-").concat(vO(4,""),"-").concat(vO(4,""),"-").concat(vO(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void nk.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();nk.debug("Loading global parameters from cache",t),Object.keys(t).forEach(e=>{if(Object.prototype.hasOwnProperty.call(EP,e)){const{value:r,expires:i}=t[e];if(i&&i<=n)return;CP[e]=r,EP[e]=r}})}catch(t){nk.error("Error loading mutableParamsCache: ".concat(e),t.message)}}(),Array.isArray(CP.AREAS)&&CP.AREAS.length>0&&TV(CP.AREAS,!0);const EJ=(e,t,n)=>{nk.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),yP(e,t,n)};iV(Eq,!1),iV(Aq,!1),iV(kH,!1),iV(iX,!1),iV(_q,!1),iV(GX,!1),iV($X,!1),iV(tJ,!1),iV(vJ,!1),iV(bJ,!1);const yJ=function(e){const t=new ON,n=e,r={getListeners:t.getListeners.bind(t),on:(e,n)=>(function(e,t){e===NF.SECURITY_POLICY_VIOLATION&&LG(t,!0)}(e,n),t.on.bind(t)(e,n)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return DG(DG({},n),r)}({__TRACK_LIST__:xk,VERSION:hP,BUILD:vP,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:EJ,getParameter:SP,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;const n=await async function(e){let t;return pk().supportUnifiedPlan?(e.addTransceiver("video",{direction:"recvonly"}),e.addTransceiver("audio",{direction:"recvonly"}),t=(await e.createOffer()).sdp):t=(await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,t}(t);if(!n)return e;t.close(),t=null,e=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ H265/i)&&t.video.push("H265"),e.match(/ opus/i)&&t.audio.push("OPUS"),e.match(/ PCMU/i)&&t.audio.push("PCMU"),e.match(/ PCMA/i)&&t.audio.push("PCMA"),e.match(/ G722/i)&&t.audio.push("G722"),t}(n)}catch(e){throw new uk(hN.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return e},checkSystemRequirements:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=dk.reportApiInvoke(null,{name:DN.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:xN.TRACER}),n=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!1;try{const n=window.RTCPeerConnection,r=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,i=window.WebSocket;t=!(!n||!i),e&&!r&&(t=!1),t&&sN()&&HI(75)&&(new n).close()}catch(e){nk.error("check system requirement failed: ",e),t=!1}return t}(e),r=RG();nk.debug("checkSystemRequirements, api:",n,"browser",r);const i=n&&r;return t.onSuccess(i),SP("IGNORE_RTC_DEVICE_CHECK")?n:i},getDevices:function(e){return kD.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return kD.getRecordingDevices(e)},getCameras:function(e){return kD.getCamerasDevices(e)},getElectronScreenSources:CD,getPlaybackDevices:function(e){return kD.getSpeakers(e)},createClient:wG,createCameraVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=SP("CAMERA_CAPTURE_CONFIG"),n=vO(8,"track-cam-"),r=dk.reportApiInvoke(null,{id:n,tag:xN.TRACER,name:DN.CREATE_CAM_VIDEO_TRACK,options:[cD({},e),t]});t&&(e.encoderConfig=t);const i=YD(e);let o=null;nk.info("start create camera video track with config",JSON.stringify(e),"trackId",n);try{o=(await ID({video:i},n)).getVideoTracks()[0]||null}catch(e){throw r.onError(e),e}if(!o){const e=new pN(hN.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(e),e.throw(nk)}if(e.optimizationMode&&UL(n,o,e,Nk(e.encoderConfig)),SP("USE_STANDARD_BITRATE_DEFAULT")){const t=Nk(e.encoderConfig);e.encoderConfig=t,delete t.bitrateMax,delete t.bitrateMin}const a=new LL(o,e,i,e.scalabiltyMode?Pk(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,n);return r.onSuccess(a.getTrackId()),nk.info("create camera video success, trackId:",n),a},createCustomVideoTrack:function(e){const t=vO(8,"track-cus-"),n=dk.reportApiInvoke(null,{id:t,tag:xN.TRACER,name:DN.CREATE_CUSTOM_VIDEO_TRACK,options:[e]});SP("USE_STANDARD_BITRATE_DEFAULT")&&(delete e.bitrateMax,delete e.bitrateMin);const r=new xL(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?Pk(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,t,[Uk.CUSTOM_TRACK]);return n.onSuccess(r.getTrackId()),nk.info("create custom video track success with config",e,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const n="object"==typeof t?function(e){const t=qD(e);return bk()&&e.suppressLocalAudioPlayback&&(t.suppressLocalAudioPlayback=e.suppressLocalAudioPlayback),Ek()&&e.restrictOwnAudio&&(t.restrictOwnAudio=!0),t}(t):void 0;n&&(t="auto");const r=vO(8,"track-scr-v-"),i=dk.reportApiInvoke(null,{id:r,tag:xN.TRACER,name:DN.CREATE_SCREEN_VIDEO_TRACK,options:[cD({},e),t]});e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const o=function(e){const t={};e.screenSourceType&&(t.mediaSource=e.screenSourceType),e.extensionId&&MI()&&(t.extensionId=e.extensionId);const{displaySurface:n,selfBrowserSurface:r,surfaceSwitching:i,systemAudio:o,preferCurrentTab:a,windowAudio:s,monitorTypeSurfaces:c}=e;(WI(107)||zI(107)||ZI(93))&&(n&&(fN(n,"displaySurface",["browser","window","monitor"]),t.displaySurface=n),r?(fN(r,"selfBrowserSurface",["exclude","include"]),t.selfBrowserSurface=r):t.selfBrowserSurface="include",i&&(fN(i,"surfaceSwitching",["exclude","include"]),t.surfaceSwitching=i)),(WI(105)||zI(105)||ZI(91))&&o&&(fN(o,"systemAudio",["exclude","include"]),t.systemAudio=o),(WI(94)||zI(94)||ZI(80))&&a&&(t.preferCurrentTab=!0),(WI(141)||zI(141)||ZI(125))&&s&&(fN(s,"windowAudio",["exclude","system"]),t.windowAudio=s),(WI(119)||zI(119)||ZI(105))&&c&&(fN(c,"monitorTypeSurfaces",["exclude","include"]),t.monitorTypeSurfaces=c),e.electronScreenSourceId&&(t.sourceId=e.electronScreenSourceId);const l=e.encoderConfig?Ok(e.encoderConfig):null;return t.mandatory={chromeMediaSource:"desktop",maxWidth:l?l.width:void 0,maxHeight:l?l.height:void 0},l&&(l.frameRate&&("number"==typeof l.frameRate?(t.mandatory.maxFrameRate=l.frameRate,t.mandatory.minFrameRate=l.frameRate):(t.mandatory.maxFrameRate=l.frameRate.max||l.frameRate.ideal||l.frameRate.exact||void 0,t.mandatory.minFrameRate=l.frameRate.min||l.frameRate.ideal||l.frameRate.exact||void 0),t.frameRate=l.frameRate),l.width&&(t.width=l.width),l.height&&(t.height=l.height)),t}(e);let a=null,s=null;const c=pk();if(!c.supportShareAudio&&"enable"===t){const e=new pN(hN.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return i.onError(e),e.throw(nk)}nk.info("start create screen video track with config",e,"withAudio",t,"trackId",r);const l=c.supportShareAudio&&"disable"!==t;try{const e=await ID({screen:o,screenAudio:l?n||!0:void 0},r);a=e.getVideoTracks()[0]||null,s=e.getAudioTracks()[0]||null}catch(e){throw i.onError(e),e}if(!a){const e=new pN(hN.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(e),e.throw(nk)}if(!s&&"enable"===t){a&&a.stop();const e=new pN(hN.SHARE_AUDIO_NOT_ALLOWED);return i.onError(e),e.throw(nk)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(UL(r,a,e,e.encoderConfig&&Ok(e.encoderConfig)||void 0),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const d=new xL(a,e.encoderConfig?Ok(e.encoderConfig):{},e.scalabiltyMode?Pk(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,r,[Uk.SCREEN_TRACK]);if(!s)return i.onSuccess(d.getTrackId()),nk.info("create screen video track success","video:",d.getTrackId()),d;const u=new Vx(s,void 0,vO(8,"track-scr-a-"),!1);return i.onSuccess([d.getTrackId(),u.getTrackId()]),nk.info("create screen video track success","video:",d.getTrackId(),"audio:",u.getTrackId()),[d,u]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=SP("CAMERA_CAPTURE_CONFIG"),r=vO(8,"track-mic-"),i=vO(8,"track-cam-"),o=dk.reportApiInvoke(null,{id:"".concat(r,"-").concat(i),tag:xN.TRACER,name:DN.CREATE_MIC_AND_CAM_TRACKS,options:[e,t,n]});n&&(t.encoderConfig=n);const a=YD(t),s=XD(e);let c=null,l=null;nk.info("start create camera video track(".concat(i,") and microphone audio track(").concat(r,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{const e=await ID({audio:s,video:a},"".concat(r,"-").concat(i));c=e.getAudioTracks()[0],l=e.getVideoTracks()[0]}catch(e){throw o.onError(e),e}if(!c||!l){const e=new pN(hN.UNEXPECTED_ERROR,"can not find tracks in media stream");return o.onError(e),e.throw(nk)}if(t.optimizationMode&&UL(i,l,t,Nk(t.encoderConfig)),SP("USE_STANDARD_BITRATE_DEFAULT")){const e=Nk(t.encoderConfig);t.encoderConfig=e,delete e.bitrateMax,delete e.bitrateMin}const d=new Bx(c,e,s,r),u=new LL(l,t,a,t.scalabiltyMode?Pk(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,i);return o.onSuccess([d.getTrackId(),u.getTrackId()]),nk.info("create camera video track(".concat(i,") and microphone audio track(").concat(r,") success")),[d,u]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=vO(8,"track-mic-"),n=dk.reportApiInvoke(null,{id:t,tag:xN.TRACER,name:DN.CREATE_MIC_AUDIO_TRACK,options:[e]}),r=XD(e);let i=null;nk.info("start create microphone audio track with config",JSON.stringify(e),"trackId",t);try{i=(await ID({audio:r},t)).getAudioTracks()[0]||null}catch(e){throw n.onError(e),e}if(!i){const e=new pN(hN.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(e),e.throw(nk)}const o=new Bx(i,e,r,t);return n.onSuccess(o.getTrackId()),nk.info("create microphone audio track success, trackId:",t),o},createCustomAudioTrack:ML,createBufferSourceAudioTrack:async function(e){var t;const{cacheOnlineFile:n,encoderConfig:r}=e;let{source:i}=e;const o={source:i instanceof AudioBuffer?"AudioBuffer":i instanceof File?null!==(t=File.name)&&void 0!==t?t:"File":i,cacheOnlineFile:n,encoderConfig:r},a=vO(8,"track-buf-"),s=dk.reportApiInvoke(null,{id:a,tag:xN.TRACER,name:DN.CREATE_BUFFER_AUDIO_TRACK,options:[o]});if(SP("DISABLE_WEBAUDIO"))throw new pN(hN.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");nk.info("start create buffer source audio track with config",JSON.stringify(o),"trackId",a);const c=i;if(!(i instanceof AudioBuffer))try{i=await async function(e,t){let n=null;if("string"==typeof e){const t=zx.get(e);if(t)return nk.debug("use cached audio resource: ",e),t;try{n=(await MO(()=>EI.get(e,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new pN(hN.FETCH_AUDIO_FILE_FAILED,e.toString())}}else{const t=new ip((t,n)=>{const r=new FileReader;r.onload=e=>{e.target?t(e.target.result):n(new pN(hN.READ_LOCAL_AUDIO_FILE_ERROR))},r.onerror=()=>{n(new pN(hN.READ_LOCAL_AUDIO_FILE_ERROR))},r.readAsArrayBuffer(e)});n=await t}const r=await function(e){const t=fD();return new ip((n,r)=>{t.decodeAudioData(e,e=>{n(e)},e=>{r(new pN(hN.DECODE_AUDIO_FILE_FAILED,e.toString()))})})}(n);return"string"==typeof e&&t&&zx.set(e,r),r}(i,n)}catch(e){return s.onError(e),e.throw(nk)}const l=new Gx(i),d=new Wx(c,l,r?Dk(r):{},a);return nk.info("create buffer source audio track success, trackId:",a),s.onSuccess(d.getTrackId()),d},setAppType:function(e){if(nk.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw nk.debug("Invalid appType"),new uk(hN.INVALID_PARAMS,"invalid app type",e);yP("APP_TYPE",Math.floor(e))},setLogLevel:function(e){nk.setLogLevel(e)},enableLogUpload:function(){SP("USE_NEW_LOG")?yP("UPLOAD_LOG",!0):nk.enableLogUpload()},disableLogUpload:function(){SP("USE_NEW_LOG")?yP("UPLOAD_LOG",!1):nk.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new oB},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=dk.reportApiInvoke(null,{tag:xN.TRACER,name:DN.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Vx||e instanceof $L)){const e=new uk(hN.INVALID_TRACK,"the parameter is not a audio track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof Vx?e.getTrackLabel():"remote_track",i=e.getVolumeLevel();let o=i,a=i;const s=Date.now();return new ip(i=>{const c=setInterval(()=>{const l=e.getVolumeLevel();o=l>o?l:o,a=l<a?l:a;const d=o-a>1e-4,u=Date.now()-s;if(d||u>t){clearInterval(c);const t=d,a={duration:u,deviceLabel:r,maxVolumeLevel:o,result:t};nk.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(a))),n.onSuccess(a),i(t)}},200)})},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=dk.reportApiInvoke(null,{tag:xN.TRACER,name:DN.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof xL||e instanceof QL)){const e=new uk(hN.INVALID_TRACK,"the parameter is not a video track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof xL?e.getTrackLabel():"remote_track",i=e.getMediaStreamTrack(!0),o=document.createElement("video");o.style.width="1px",o.style.height="1px",o.setAttribute("muted",""),o.muted=!0,o.setAttribute("playsinline",""),o.controls=!1,(UI()||LI())&&(o.style.opacity="0.01",o.style.position="fixed",o.style.left="0",o.style.top="0",document.body.appendChild(o)),o.srcObject=new MediaStream([i]),o.play();const a=document.createElement("canvas");a.width=160,a.height=120;let s=0,c=0;try{const e=Date.now();s=await function(e,t,n,r){let i,o=0,a=null;return new ip((s,c)=>{function l(){o>r&&i&&(i(),s(o));const t=n.getContext("2d");if(!t){const e=new uk(hN.UNEXPECTED_ERROR,"can not get canvas 2d context.");return nk.error(e.toString()),void c(e)}t.drawImage(e,0,0,160,120);const l=t.getImageData(0,0,n.width,n.height),d=Math.floor(l.data.length/3);if(a){for(let e=0;e<d;e+=3)if(l.data[e]!==a[e])return o+=1,void(a=l.data);a=l.data}else a=l.data}setTimeout(()=>{i&&(i(),s(o))},t),i=vD(()=>{l()},30)})}(o,t,a,4),c=Date.now()-e}catch(e){throw n.onError(e),e}RW===AI.SAFARI&&(o.pause(),o.remove()),o.srcObject=null;const l=s>4,d={duration:c,changedPicNum:s,deviceLabel:r,result:l};return nk.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(d))),n.onSuccess(d),l},setArea:TV,audioElementPlayCenter:FD,resumeAudioContext:function(){return FD.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){PG.processExternalMediaAEC(e)},registerExtensions:function(e){const t=SP("PLUGIN_INFO")||[];e.forEach(e=>{"name"in e&&!xr(t).call(t,e.name)&&t.push(e.name);const n=e;n.__registered__=!0,n.logger.hookLog=nk.extLog,n.reporter.hookApiInvoke=dk.extApiInvoke,n.parameters&&Object.keys(n.parameters).forEach(e=>{n.parameters[e]=SP(e)})}),EJ("PLUGIN_INFO",t)},ChannelMediaRelayError:iF,ChannelMediaRelayEvent:nF,ChannelMediaRelayState:rF,RemoteStreamFallbackType:Vk,RemoteStreamType:jk,ConnectionDisconnectedReason:UN,AudienceLatencyLevelType:MN,AREAS:lF,preload:async function(e,t,n,r){return WW(e,t,n,r)},startLastmileProbeTest:async function(e,t,n,r){let i={state:"unavailable"};await WW(e,t,n,r);const o=await HW({appId:e,cname:t,token:n||e,uid:r,cloudProxyServer:"disabled"});if(!o)return i;await zW(o);let a,s=wG({mode:"rtc",codec:"vp8"});try{a=await s.join(e,t,n,r,{networkQualityProbe:!0})}catch(e){return i}const c=new BW,l=c.createMuteAudioTrack();let d=await ML({mediaStreamTrack:l});await s.publish([d]);let[u,h,p]=await new ip((e,t)=>{const n=setTimeout(()=>{clearTimeout(n),e([!0,null,"audio"])},5e3);s.on("user-published",async(t,r)=>{t.uid===a&&(clearTimeout(n),e([!1,t,r]))})});if(u||!h)return await s.unpublish([d]),await s.leave(),d.close(),c.close(),i;await s.subscribe(h,p),await new ip((e,t)=>{const n=setTimeout(()=>{clearTimeout(n),e(null)},5e3)});let m=s.getRTCStats(),f=s.getLocalAudioStats();const g=m.RTT,_=f.sendJitterMs,v=f.currentPacketLossRate;return i={state:"complete",rtt:g,packetLossRate:v,jitter:_,networkQuality:((e,t,n)=>{let r=1;if(n>0){let e=Math.log(100*n)/Math.log(2)+1;e=Math.min(5,Math.max(0,e)),r=1-e/5}let i=1;if(e>0){let t=Math.log(e/40)/Math.log(2)+1;t=Math.min(5,Math.max(0,t)),i=1-t/5}let o=1;if(t>0){let e=Math.log(t/10)/Math.log(2.5)+1;e=Math.min(5,Math.max(0,e)),o=1-e/5}const a=.5*r+.3*i+.2*o;let s=0;return s=a>=.8?1:a>=.6?2:a>=.4?3:a>=.2?4:5,s})(g,_,v)},await s.unsubscribe(h),await s.unpublish([d]),await s.leave(),d.close(),c.close(),await zW(o),i}});return Object.defineProperties(yJ,{onAudioAutoplayFailed:{get:()=>xD.onAudioAutoplayFailed,set:e=>{xD.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>xD.onAutoplayFailed,set:e=>{xD.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>yJ._onSecurityPolicyViolation,set(e){yJ._onSecurityPolicyViolation=e,LG(e)}},__CLIENT_LIST__:{get:()=>SP("SHOW_GLOBAL_CLIENT_LIST")?zM:[]}}),kD.on(eD.CAMERA_DEVICE_CHANGED,e=>{nk.info("camera device changed",JSON.stringify(e)),yJ.onCameraChanged&&yJ.onCameraChanged(e),yJ.safeEmit(NF.CAMERA_CHANGED,e)}),kD.on(eD.RECORDING_DEVICE_CHANGED,e=>{nk.info("microphone device changed",JSON.stringify(e)),yJ.onMicrophoneChanged&&yJ.onMicrophoneChanged(e),yJ.safeEmit(NF.MICROPHONE_CHANGED,e)}),kD.on(eD.PLAYOUT_DEVICE_CHANGED,e=>{nk.debug("playout device changed",JSON.stringify(e)),yJ.onPlaybackDeviceChanged&&yJ.onPlaybackDeviceChanged(e),yJ.safeEmit(NF.PLAYBACK_DEVICE_CHANGED,e)}),FD.onAutoplayFailed=()=>{nk.info("detect audio element autoplay failed"),xD.onAudioAutoplayFailed&&xD.onAudioAutoplayFailed()},mD.on("autoplay-failed",()=>{nk.info("detect webaudio autoplay failed"),xD.onAudioAutoplayFailed&&xD.onAudioAutoplayFailed(),yJ.safeEmit(NF.AUTOPLAY_FAILED)}),mD.on(yk.STATE_CHANGE,(e,t)=>{nk.info("audio context state changed: ".concat(t," => ").concat(e)),yJ.onAudioContextStateChanged&&yJ.onAudioContextStateChanged(e,t),yJ.safeEmit(NF.AUDIO_CONTEXT_STATE_CHANGED,e,t)}),ZN.on(KN.NETWORK_STATE_CHANGE,(e,t)=>{nk.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))}),window&&(window.__ARTC__=yJ),yJ}()},1852:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app=t.Action=void 0;var r,i=n(8154),o=n(6361);!function(e){e.APP="APP::PRINT::APP"}(r||(t.Action=r={})),t.app=function(){return(0,i.actionWrapper)({group:o.Group.Print,type:r.APP})}},2172:(e,t)=>{"use strict";function n(){return r()?window.location:void 0}function r(){return"undefined"!==typeof window}Object.defineProperty(t,"__esModule",{value:!0}),t.getWindow=t.getLocation=t.redirect=t.shouldRedirect=void 0,t.shouldRedirect=function(e){return e===window},t.redirect=function(e){var t=n();t&&t.assign(e)},t.getLocation=n,t.getWindow=function(){return r()?window:void 0}},2670:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0,function(e){e.INITIALIZE="APP::CLIENT::INITIALIZE"}(n||(t.Action=n={}))},2799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},2992:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/web-vitals.umd.5c9b7d9b25b4b8f4a270.cjs"},3002:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDevelopmentClient=t.isProduction=t.isDevelopment=t.isUnframed=t.isServer=t.isClient=void 0;var r=n(742),i=n(742);Object.defineProperty(t,"isClient",{enumerable:!0,get:function(){return i.isClient}}),Object.defineProperty(t,"isServer",{enumerable:!0,get:function(){return i.isServer}}),Object.defineProperty(t,"isUnframed",{enumerable:!0,get:function(){return i.isUnframed}}),t.isDevelopment="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_APP_ID:"656422a01e774a4ba5b2dc0ac12e5fe5",REACT_APP_BACKEND_HOST:"https://test-online-consultation.zend-apps.com",REACT_APP_FIREBASE_API_KEY:"AIzaSyCi61pDIUtbi7pvnxfFRNIpi8RjTHpFNxs",REACT_APP_FIREBASE_APP_ID:"1:465295888006:web:ae07e6f6667e0e6f838b07",REACT_APP_FIREBASE_AUTH_DOMAIN:"consultant-app-24ceb.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-9TD9Q1Q0PJ",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"465295888006",REACT_APP_FIREBASE_PROJECT_ID:"consultant-app-24ceb",REACT_APP_FIREBASE_STORAGE_BUCKET:"consultant-app-24ceb.firebasestorage.app",REACT_APP_FIREBASE_VAPID_KEY:"BB8E-fAs8w3xZZ3cL_R3jjnTHaNDu4LGcra1NJhX60UG0lxvzBHVzzblrvv7cm6FMaGo_o_r2hbiB1eibrtg1h0",REACT_APP_SHOPIFY_API_KEY:"1844b97873b270b025334fd34790185c"}&&!1,t.isProduction=!t.isDevelopment,t.isDevelopmentClient=t.isDevelopment&&r.isClient},3096:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockAppBridge=t.serverAppBridge=void 0;var r=n(713),i=function(){},o=new Promise(function(){});t.serverAppBridge={dispatch:function(){return{}},error:function(){return i},featuresAvailable:function(){return Promise.reject((0,r.fromAction)("Feature detection is only available on the client side.",r.AppActionType.WINDOW_UNDEFINED))},getState:function(){return Promise.reject((0,r.fromAction)("State is only available on the client side.",r.AppActionType.WINDOW_UNDEFINED))},localOrigin:"",hostOrigin:"",subscribe:function(){return i}},t.mockAppBridge={dispatch:function(){return{}},error:function(){return i},featuresAvailable:function(){return o},getState:function(){return o},localOrigin:"",hostOrigin:"",subscribe:function(){return i}}},3323:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isV1Config=t.MessageType=t.LifecycleHook=t.PermissionType=void 0;var r=n(9367);Object.defineProperty(t,"MessageType",{enumerable:!0,get:function(){return r.MessageType}});var i=n(9367);Object.defineProperty(t,"PermissionType",{enumerable:!0,get:function(){return i.PermissionType}}),Object.defineProperty(t,"LifecycleHook",{enumerable:!0,get:function(){return i.LifecycleHook}}),t.isV1Config=function(e){return!e.host}},3938:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9337),i=function(){function e(){this.map={}}return e.prototype.set=function(e,t){Object.prototype.hasOwnProperty.call(this.map,e)||(this.map[e]=[]);var n={handler:t,remove:function(){}},i=(0,r.addAndRemoveFromCollection)(this.map[e],n);return n={handler:t,remove:i},i},e.prototype.get=function(e){var t=this.map[e];return t?t.map(function(e){return e.handler}):void 0},e.prototype.run=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=0,a=this.get(e)||[];return function e(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=a[o++];return s?s(e).apply(n,r):t.apply(n,r)}.apply(n,r)},e}();t.default=i},3952:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){if(null==n)return n;if("undefined"===typeof t||!Object.prototype.isPrototypeOf.call(Object.getPrototypeOf(t),n)||"Object"!==n.constructor.name&&"Array"!==n.constructor.name)return n;var r={};return Object.keys(n).forEach(function(i){Object.prototype.hasOwnProperty.call(t,i)?"object"!==typeof t[i]||Array.isArray(t[i])?r[i]=n[i]:r[i]=e(t[i],n[i]):r[i]=n[i]}),Object.keys(t).forEach(function(e){Object.prototype.hasOwnProperty.call(n,e)||(r[e]=t[e])}),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}},4214:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPermitted=t.getPermissionKey=t.isPerformanceOrWebVitalsAction=t.isAppMessage=t.isAppBridgeAction=void 0;var r=n(9367),i=n(4465),o=n(8154);function a(e){return e.replace(new RegExp("^".concat(i.PREFIX).concat(i.SEPARATOR,"\\w+").concat(i.SEPARATOR)),"")}t.isAppBridgeAction=function(e){return e instanceof Object&&Object.prototype.hasOwnProperty.call(e,"type")&&e.type.toString().startsWith(i.PREFIX)},t.isAppMessage=function(e){if("object"!==typeof e||!e.data||"object"!==typeof e.data)return!1;var t=e.data;return Object.prototype.hasOwnProperty.call(t,"type")&&void 0!==(0,o.findMatchInEnum)(r.MessageType,t.type)},t.isPerformanceOrWebVitalsAction=function(e){return e.type.match(/^APP::(PERFORMANCE|WEB_VITALS)::/)},t.getPermissionKey=a,t.isPermitted=function(e,t,n){var r=t.group,i=t.type;if(!r||!Object.prototype.hasOwnProperty.call(e,r))return!1;var o=e[r];if(!o)return!1;var s=a(i);return!!o[s]&&!0===o[s][n]}},4274:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTransportListener=t.fromWindow=t.fromFrame=t.Context=void 0;var r,i=n(8197),o=n(4214),a=n(9367),s=n(6221),c=n(742);!function(e){e.Modal="Modal",e.Main="Main"}(r||(t.Context=r={})),t.fromFrame=function(e,t,n){var r=[],a=e.host,l=e.window;if(!a)throw(0,i.fromAction)("App frame is undefined",i.AppActionType.WINDOW_UNDEFINED);return c.isUnframed&&window.MobileWebView&&Object.assign(window.MobileWebView,{postMessageToIframe:function(e,t){null===l||void 0===l||l.postMessage(e,t),function(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)&&"dispatch"===e.type&&"object"===typeof e.payload}(e)&&a.postMessage(JSON.stringify(e.payload),location.origin)},updateIframeUrl:function(n){var r=window.location,i=(e.window||{}).location;try{new URL(n).origin===t&&i?i.replace(n):r.href=n}catch(o){}}}),a.addEventListener("message",function(e){if(e.source!==a&&(0,o.isAppMessage)(e))if(e.origin===t)if(c.isUnframed&&window.MobileWebView){d=JSON.stringify({id:"unframed://fromClient",origin:t,data:e.data});window.MobileWebView.postMessage(d)}else for(var n=0,s=r;n<s.length;n++){(0,s[n])(e)}else{var d,u="Message origin '".concat(e.origin,"' does not match app origin '").concat(t,"'."),h={type:"dispatch",payload:d=(0,i.invalidOriginAction)(u)};null===l||void 0===l||l.postMessage(h,e.origin)}}),{context:n,localOrigin:t,frameWindow:l,hostFrame:a,dispatch:function(e){null===l||void 0===l||l.postMessage(e,t)},subscribe:function(e){return(0,s.addAndRemoveFromCollection)(r,e)}}},t.fromWindow=function(e,t){var n=[];return void 0!==typeof window&&window.addEventListener("message",function(t){if((window!==e||c.isUnframed)&&t.source===e&&((0,o.isAppBridgeAction)(t.data.payload)||(0,o.isAppMessage)(t)))for(var r=0,i=n;r<i.length;r++){(0,i[r])(t)}}),{localOrigin:t,hostFrame:e,dispatch:function(n){var r;if(null===(r=n.source)||void 0===r?void 0:r.host)if(c.isUnframed&&window&&window.MobileWebView){var i=JSON.stringify({id:"unframed://fromClient",origin:t,data:n});window.MobileWebView.postMessage(i)}else{var o=new URL("https://".concat(n.source.host)).origin;e.postMessage(n,o)}},subscribe:function(e){return(0,s.addAndRemoveFromCollection)(n,e)}}},t.createTransportListener=function(){var e=[],t={};return{createSubscribeHandler:function(n){return function(){if(arguments.length<2)return(0,s.addAndRemoveFromCollection)(e,{callback:arguments[0]});var r=Array.from(arguments),i=r[0],o=r[1],c=r[2],l={callback:o,id:c},d={type:i,id:c};return Object.prototype.hasOwnProperty.call(t,i)||(t[i]=[]),n&&n(a.MessageType.Subscribe,d),(0,s.addAndRemoveFromCollection)(t[i],l,function(){n&&n(a.MessageType.Unsubscribe,d)})}},handleMessage:function(t){e.forEach(function(e){return e.callback(t)})},handleActionDispatch:function(e){var n=e.type,r=e.payload,i=!1;if(Object.prototype.hasOwnProperty.call(t,n))for(var o=0,a=t[n];o<a.length;o++){var s=a[o],c=s.id,l=s.callback;!(r&&r.id===c)&&c||(l(r),i=!0)}return i}}}},4288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function v(e,t,n){this.props=e,this.context=t,this.refs=_,this.updater=n||f}function b(){}function E(e,t,n){this.props=e,this.context=t,this.refs=_,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var y=E.prototype=new b;y.constructor=E,g(y,v.prototype),y.isPureReactComponent=!0;var S=Array.isArray;function T(){}var C={H:null,A:null,T:null,S:null},w=Object.prototype.hasOwnProperty;function R(e,t,r){var i=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==i?i:null,props:r}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function O(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c,l,d=!1;if(null===e)d=!0;else switch(s){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case n:case r:d=!0;break;case h:return O((d=e._init)(e._payload),t,i,o,a)}}if(d)return a=a(e),d=""===o?"."+N(e,0):o,S(a)?(i="",null!=d&&(i=d.replace(I,"$&/")+"/"),O(a,t,i,"",function(e){return e})):null!=a&&(A(a)&&(c=a,l=i+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+d,a=R(c.type,l,c.props)),t.push(a)),1;d=0;var u,p=""===o?".":o+":";if(S(e))for(var f=0;f<e.length;f++)d+=O(o=e[f],t,i,s=p+N(o,f),a);else if("function"===typeof(f=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=m&&u[m]||u["@@iterator"])?u:null))for(e=f.call(e),f=0;!(o=e.next()).done;)d+=O(o=o.value,t,i,s=p+N(o,f++),a);else if("object"===s){if("function"===typeof e.then)return O(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function P(e,t,n){if(null==e)return e;var r=[],i=0;return O(e,r,"","",function(e){return t.call(n,e,i++)}),r}function k(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},x={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=x,t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=E,t.StrictMode=o,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return C.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.key&&(i=""+t.key),t)!w.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var a=Array(o),s=0;s<o;s++)a[s]=arguments[s+2];r.children=a}return R(e.type,i,r)},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)w.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var a=arguments.length-2;if(1===a)i.children=n;else if(1<a){for(var s=Array(a),c=0;c<a;c++)s[c]=arguments[c+2];i.children=s}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===i[r]&&(i[r]=a[r]);return R(e,o,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:k}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.T,n={};C.T=n;try{var r=e(),i=C.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(T,D)}catch(o){D(o)}finally{null!==t&&null!==n.types&&(t.types=n.types),C.T=t}},t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},t.use=function(e){return C.H.use(e)},t.useActionState=function(e,t,n){return C.H.useActionState(e,t,n)},t.useCallback=function(e,t){return C.H.useCallback(e,t)},t.useContext=function(e){return C.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return C.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return C.H.useEffect(e,t)},t.useEffectEvent=function(e){return C.H.useEffectEvent(e)},t.useId=function(){return C.H.useId()},t.useImperativeHandle=function(e,t,n){return C.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return C.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return C.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return C.H.useMemo(e,t)},t.useOptimistic=function(e,t){return C.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return C.H.useReducer(e,t,n)},t.useRef=function(e){return C.H.useRef(e)},t.useState=function(e){return C.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return C.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return C.H.useTransition()},t.version="19.2.3"},4381:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWebVitals=t.interactionToNextPaint=t.timeToFirstByte=t.firstContentfulPaint=t.cumulativeLayoutShift=t.firstInputDelay=t.largestContentfulPaint=t.Action=void 0;var r=n(2992),i=n(8162);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return i.Action}});var o=n(3002),a=n(7053),s=n(894),c=n(7228);function l(e){return(0,s.actionWrapper)({group:a.Group.WebVitals,type:i.Action.LARGEST_CONTENTFUL_PAINT,payload:e})}function d(e){return(0,s.actionWrapper)({group:a.Group.WebVitals,type:i.Action.FIRST_INPUT_DELAY,payload:e})}function u(e){return(0,s.actionWrapper)({group:a.Group.WebVitals,type:i.Action.CUMULATIVE_LAYOUT_SHIFT,payload:e})}function h(e){return(0,s.actionWrapper)({group:a.Group.WebVitals,type:i.Action.FIRST_CONTENTFUL_PAINT,payload:e})}function p(e){return(0,s.actionWrapper)({group:a.Group.WebVitals,type:i.Action.TIME_TO_FIRST_BYTE,payload:e})}function m(e){return(0,s.actionWrapper)({group:a.Group.WebVitals,type:i.Action.INTERACTION_TO_NEXT_PAINT,payload:e})}t.largestContentfulPaint=l,t.firstInputDelay=d,t.cumulativeLayoutShift=u,t.firstContentfulPaint=h,t.timeToFirstByte=p,t.interactionToNextPaint=m,t.initializeWebVitals=function(e){function t(t){return function(n){var r=n.id,i=n.name,o=n.value,a=t({id:r,metricName:i,value:o});e.dispatch(a)}}var n=window;o.isServer||o.isClient&&n.__is_web_vitals_initialized__||(0,c.isMobile)()||(n.__is_web_vitals_initialized__=!0,(0,r.onLCP)(t(l)),(0,r.onFID)(t(d)),(0,r.onCLS)(t(u)),(0,r.onFCP)(t(h)),(0,r.onTTFB)(t(p)),(0,r.onINP)(t(m)))}},4391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(7004)},4465:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEPARATOR=t.PREFIX=void 0,t.PREFIX="APP",t.SEPARATOR="::"},4705:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function o(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>o})},4870:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9503);i(n(3323),t),i(n(9503),t),t.default=o.createClientApp},5024:e=>{"use strict";e.exports=JSON.parse('{"name":"@shopify/app-bridge","version":"3.7.11","types":"index.d.ts","main":"index.js","unpkg":"umd/index.js","jsdelivr":"umd/index.js","files":["/actions/","/client/","/umd/","/utilities/","/util/","/validate/","/development.d.ts","/development.js","/index.d.ts","/index.js","/MessageTransport.d.ts","/MessageTransport.js","/production.d.ts","/production.js"],"private":false,"publishConfig":{"access":"public","@shopify:registry":"https://registry.npmjs.org"},"repository":"git@github.com:Shopify/app-bridge.git","homepage":"https://shopify.dev/docs/api/app-bridge/previous-versions/app-bridge-from-npm/app-setup","author":"Shopify Inc.","license":"MIT","scripts":{"build":"yarn build:tsc && yarn build:npm && yarn build:umd","build:tsc":"NODE_ENV=production tsc","build:umd":"NODE_ENV=production webpack -p","build:npm":"shx cp -r ./npm/index.js ./index.js","check":"tsc","clean":"yarn clean:tsc && yarn clean:npm && yarn clean:umd","clean:tsc":"NODE_ENV=production tsc --build --clean","clean:umd":"rm -rf ./umd","clean:npm":"rm -rf ./index.js","size":"size-limit"},"sideEffects":false,"size-limit":[{"limit":"10.75 KB","path":"production.js"}],"dependencies":{"@shopify/app-bridge-core":"1.5.0","base64url":"^3.0.1","web-vitals":"^3.0.1"},"devDependencies":{"@types/node":"^10.12.5","shx":"^0.3.3"}}')},5043:(e,t,n)=>{"use strict";e.exports=n(4288)},5896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,c=e[s],l=s+1,d=e[l];if(0>o(c,n))l<i&&0>o(d,c)?(e[r]=d,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<i&&0>o(d,n)))break e;e[r]=d,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,_=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,E="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=r(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,n(l,t)}t=r(d)}}function S(e){if(g=!1,y(e),!f)if(null!==r(l))f=!0,C||(C=!0,T());else{var t=r(d);null!==t&&k(S,t.startTime-e)}}var T,C=!1,w=-1,R=5,A=-1;function I(){return!!_||!(t.unstable_now()-A<R)}function N(){if(_=!1,C){var e=t.unstable_now();A=e;var n=!0;try{e:{f=!1,g&&(g=!1,b(w),w=-1),m=!0;var o=p;try{t:{for(y(e),h=r(l);null!==h&&!(h.expirationTime>e&&I());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,y(e),n=!0;break t}h===r(l)&&i(l),y(e)}else i(l);h=r(l)}if(null!==h)n=!0;else{var c=r(d);null!==c&&k(S,c.startTime-e),n=!1}}break e}finally{h=null,p=o,m=!1}n=void 0}}finally{n?T():C=!1}}}if("function"===typeof E)T=function(){E(N)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,P=O.port2;O.port1.onmessage=N,T=function(){P.postMessage(null)}}else T=function(){v(N,0)};function k(e,n){w=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(d,e),null===r(l)&&e===r(d)&&(g?(b(w),w=-1):g=!0,k(S,o-a))):(e.sortIndex=s,n(l,e),f||m||(f=!0,C||(C=!0,T()))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},5918:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(4274),t)},6221:(e,t)=>{"use strict";function n(e,t,n){var r=e.findIndex(function(e){return e===t});return r>=0&&(e.splice(r,1),n&&n(t),!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.removeFromCollection=t.addAndRemoveFromCollection=void 0,t.addAndRemoveFromCollection=function(e,t,r){return e.push(t),function(){return n(e,t,r)}},t.removeFromCollection=n},6361:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentType=t.Group=void 0,function(e){e.AuthCode="AuthCode",e.Button="Button",e.ButtonGroup="ButtonGroup",e.Cart="Cart",e.Client="Client",e.ContextualSaveBar="ContextualSaveBar",e.Error="Error",e.Features="Features",e.FeedbackModal="FeedbackModal",e.Fullscreen="Fullscreen",e.LeaveConfirmation="LeaveConfirmation",e.Link="Link",e.Loading="Loading",e.Menu="Menu",e.Modal="Modal",e.Navigation="Navigation",e.Performance="Performance",e.Pos="Pos",e.Print="Print",e.ResourcePicker="Resource_Picker",e.unstable_Picker="unstable_Picker",e.Scanner="Scanner",e.SessionToken="SessionToken",e.Share="Share",e.TitleBar="TitleBar",e.Toast="Toast",e.MarketingExternalActivityTopBar="MarketingExternalActivityTopBar",e.WebVitals="WebVitals"}(n||(t.Group=n={})),function(e){e.Button="Button",e.ButtonGroup="ButtonGroup"}(r||(t.ComponentType=r={}))},6366:e=>{var t="undefined"!==typeof Element,n="function"===typeof Map,r="function"===typeof Set,i="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function o(e,a){if(e===a)return!0;if(e&&a&&"object"==typeof e&&"object"==typeof a){if(e.constructor!==a.constructor)return!1;var s,c,l,d;if(Array.isArray(e)){if((s=e.length)!=a.length)return!1;for(c=s;0!==c--;)if(!o(e[c],a[c]))return!1;return!0}if(n&&e instanceof Map&&a instanceof Map){if(e.size!==a.size)return!1;for(d=e.entries();!(c=d.next()).done;)if(!a.has(c.value[0]))return!1;for(d=e.entries();!(c=d.next()).done;)if(!o(c.value[1],a.get(c.value[0])))return!1;return!0}if(r&&e instanceof Set&&a instanceof Set){if(e.size!==a.size)return!1;for(d=e.entries();!(c=d.next()).done;)if(!a.has(c.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(a)){if((s=e.length)!=a.length)return!1;for(c=s;0!==c--;)if(e[c]!==a[c])return!1;return!0}if(e.constructor===RegExp)return e.source===a.source&&e.flags===a.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"===typeof e.valueOf&&"function"===typeof a.valueOf)return e.valueOf()===a.valueOf();if(e.toString!==Object.prototype.toString&&"function"===typeof e.toString&&"function"===typeof a.toString)return e.toString()===a.toString();if((s=(l=Object.keys(e)).length)!==Object.keys(a).length)return!1;for(c=s;0!==c--;)if(!Object.prototype.hasOwnProperty.call(a,l[c]))return!1;if(t&&e instanceof Element)return!1;for(c=s;0!==c--;)if(("_owner"!==l[c]&&"__v"!==l[c]&&"__o"!==l[c]||!e.$$typeof)&&!o(e[l[c]],a[l[c]]))return!1;return!0}return e!==e&&a!==a}e.exports=function(e,t){try{return o(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}},6672:(e,t,n)=>{"use strict";var r=n(5043);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var a={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},s=Symbol.for("react.portal");var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=c.T,n=a.p;try{if(c.T=null,a.p=2,e)return e()}finally{c.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=l(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===n&&a.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=l(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=l(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=l(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return c.H.useFormState(e,t,n)},t.useFormStatus=function(){return c.H.useHostTransitionStatus()},t.version="19.2.3"},7004:(e,t,n)=>{"use strict";var r=n(8853),i=n(5043),o=n(7950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function l(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(c(e)!==e)throw Error(a(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var I=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var N=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var P=Symbol.for("react.client.reference");function k(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===P?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case T:return"Suspense";case C:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case y:return e.displayName||"Context";case E:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case w:return null!==(t=e.displayName||null)?t:k(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return k(e(t))}catch(n){}}return null}var D=Array.isArray,x=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},U=[],F=-1;function j(e){return{current:e}}function V(e){0>F||(e.current=U[F],U[F]=null,F--)}function B(e,t){F++,U[F]=e.current,e.current=t}var W,H,G=j(null),z=j(null),K=j(null),Y=j(null);function q(e,t){switch(B(K,t),B(z,e),B(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?_u(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vu(t=_u(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V(G),B(G,e)}function X(){V(G),V(z),V(K)}function J(e){null!==e.memoizedState&&B(Y,e);var t=G.current,n=vu(t,e.type);t!==n&&(B(z,e),B(G,n))}function Z(e){z.current===e&&(V(G),V(z)),Y.current===e&&(V(Y),dh._currentValue=M)}function Q(e){if(void 0===W)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);W=t&&t[1]||"",H=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+W+e+H}var $=!1;function ee(e,t){if(!e||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){r=o}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),a=o[0],s=o[1];if(a&&s){var c=a.split("\n"),l=s.split("\n");for(i=r=0;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;for(;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;if(r===c.length||i===l.length)for(r=c.length-1,i=l.length-1;1<=r&&0<=i&&c[r]!==l[i];)i--;for(;1<=r&&0<=i;r--,i--)if(c[r]!==l[i]){if(1!==r||1!==i)do{if(r--,0>--i||c[r]!==l[i]){var d="\n"+c[r].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=r&&0<=i);break}}}finally{$=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Q(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return e.child!==t&&null!==t?Q("Suspense Fallback"):Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Q("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,oe=r.unstable_cancelCallback,ae=r.unstable_shouldYield,se=r.unstable_requestPaint,ce=r.unstable_now,le=r.unstable_getCurrentPriorityLevel,de=r.unstable_ImmediatePriority,ue=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,pe=r.unstable_LowPriority,me=r.unstable_IdlePriority,fe=r.log,ge=r.unstable_setDisableYieldValue,_e=null,ve=null;function be(e){if("function"===typeof fe&&ge(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(_e,e)}catch(t){}}var Ee=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ye(e)/Se|0)|0},ye=Math.log,Se=Math.LN2;var Te=256,Ce=262144,we=4194304;function Re(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,o=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~o)?i=Re(r):0!==(a&=s)?i=Re(a):n||0!==(n=s&~e)&&(i=Re(n)):0!==(s=r&~o)?i=Re(s):0!==a?i=Re(a):n||0!==(n=r&~e)&&(i=Re(n)),0===i?0:0!==t&&t!==i&&0===(t&o)&&((o=i&-i)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:i}function Ie(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ne(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Oe(){var e=we;return 0===(62914560&(we<<=1))&&(we=4194304),e}function Pe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ke(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function De(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Ee(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function xe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ee(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Le(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Me(n))&(e.suspendedLanes|t))?0:n}function Me(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ue(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:Rh(e.type)}function je(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var Ve=Math.random().toString(36).slice(2),Be="__reactFiber$"+Ve,We="__reactProps$"+Ve,He="__reactContainer$"+Ve,Ge="__reactEvents$"+Ve,ze="__reactListeners$"+Ve,Ke="__reactHandles$"+Ve,Ye="__reactResources$"+Ve,qe="__reactMarker$"+Ve;function Xe(e){delete e[Be],delete e[We],delete e[Ge],delete e[ze],delete e[Ke]}function Je(e){var t=e[Be];if(t)return t;for(var n=e.parentNode;n;){if(t=n[He]||n[Be]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Mu(e);null!==e;){if(n=e[Be])return n;e=Mu(e)}return t}n=(e=n).parentNode}return null}function Ze(e){if(e=e[Be]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function $e(e){var t=e[Ye];return t||(t=e[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[qe]=!0}var tt=new Set,nt={};function rt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var ot=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},st={};function ct(e,t,n){if(i=t,re.call(st,i)||!re.call(at,i)&&(ot.test(i)?st[i]=!0:(at[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function lt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function dt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function _t(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,i,o,a,s){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?Et(e,a,ut(t)):null!=n?Et(e,a,ut(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=o&&(e.defaultChecked=!!o),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+ut(s):e.removeAttribute("name")}function bt(e,t,n,r,i,o,a,s){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return void pt(e);n=null!=n?""+ut(n):"",t=null!=t?""+ut(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a),pt(e)}function Et(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function yt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ut(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function St(e,t,n){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ut(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(D(r)){if(1<r.length)throw Error(a(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ut(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),pt(e)}function Ct(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var wt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||wt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function At(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Rt(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&Rt(e,o,t[o])}function It(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ot=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Ot.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function kt(){}var Dt=null;function xt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,Mt=null;function Ut(e){var t=Ze(e);if(t&&(e=t.stateNode)){var n=e[We]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+_t(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[We]||null;if(!i)throw Error(a(90));vt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&mt(r)}break e;case"textarea":St(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&yt(e,!!n.multiple,t,!1)}}}var Ft=!1;function jt(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Lt||null!==Mt)&&($l(),Lt&&(t=Lt,e=Mt,Mt=Lt=null,Ut(t),e)))for(t=0;t<e.length;t++)Ut(e[t])}}function Vt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[We]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Bt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Wt=!1;if(Bt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Wt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Zh){Wt=!1}var Gt=null,zt=null,Kt=null;function Yt(){if(Kt)return Kt;var e,t,n=zt,r=n.length,i="value"in Gt?Gt.value:Gt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Kt=i.slice(e,1<t?1-t:void 0)}function qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Xt(){return!0}function Jt(){return!1}function Zt(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Xt:Jt,this.isPropagationStopped=Jt,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),t}var Qt,$t,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Zt(tn),rn=p({},tn,{view:0,detail:0}),on=Zt(rn),an=p({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Qt=e.screenX-en.screenX,$t=e.screenY-en.screenY):$t=Qt=0,en=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:$t}}),sn=Zt(an),cn=Zt(p({},an,{dataTransfer:0})),ln=Zt(p({},rn,{relatedTarget:0})),dn=Zt(p({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),un=Zt(p({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Zt(p({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fn[e])&&!!t[e]}function _n(){return gn}var vn=Zt(p({},rn,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?mn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Zt(p({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),En=Zt(p({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),yn=Zt(p({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sn=Zt(p({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Tn=Zt(p({},tn,{newState:0,oldState:0})),Cn=[9,13,27,32],wn=Bt&&"CompositionEvent"in window,Rn=null;Bt&&"documentMode"in document&&(Rn=document.documentMode);var An=Bt&&"TextEvent"in window&&!Rn,In=Bt&&(!wn||Rn&&8<Rn&&11>=Rn),Nn=String.fromCharCode(32),On=!1;function Pn(e,t){switch(e){case"keyup":return-1!==Cn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Dn=!1;var xn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!xn[e.type]:"textarea"===t}function Mn(e,t,n,r){Lt?Mt?Mt.push(r):Mt=[r]:Lt=r,0<(t=ru(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Un=null,Fn=null;function jn(e){Xd(e,0)}function Vn(e){if(mt(Qe(e)))return e}function Bn(e,t){if("change"===e)return t}var Wn=!1;if(Bt){var Hn;if(Bt){var Gn="oninput"in document;if(!Gn){var zn=document.createElement("div");zn.setAttribute("oninput","return;"),Gn="function"===typeof zn.oninput}Hn=Gn}else Hn=!1;Wn=Hn&&(!document.documentMode||9<document.documentMode)}function Kn(){Un&&(Un.detachEvent("onpropertychange",Yn),Fn=Un=null)}function Yn(e){if("value"===e.propertyName&&Vn(Fn)){var t=[];Mn(t,Fn,e,xt(e)),jt(jn,t)}}function qn(e,t,n){"focusin"===e?(Kn(),Fn=n,(Un=t).attachEvent("onpropertychange",Yn)):"focusout"===e&&Kn()}function Xn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Vn(Fn)}function Jn(e,t){if("click"===e)return Vn(t)}function Zn(e,t){if("input"===e||"change"===e)return Vn(t)}var Qn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function $n(e,t){if(Qn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!Qn(e[i],t[i]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function ir(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var or=Bt&&"documentMode"in document&&11>=document.documentMode,ar=null,sr=null,cr=null,lr=!1;function dr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;lr||null==ar||ar!==ft(r)||("selectionStart"in(r=ar)&&ir(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},cr&&$n(cr,r)||(cr=r,0<(r=ru(sr,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ar)))}function ur(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},pr={},mr={};function fr(e){if(pr[e])return pr[e];if(!hr[e])return e;var t,n=hr[e];for(t in n)if(n.hasOwnProperty(t)&&t in mr)return pr[e]=n[t];return e}Bt&&(mr=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);var gr=fr("animationend"),_r=fr("animationiteration"),vr=fr("animationstart"),br=fr("transitionrun"),Er=fr("transitionstart"),yr=fr("transitioncancel"),Sr=fr("transitionend"),Tr=new Map,Cr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wr(e,t){Tr.set(e,t),rt(t,[e])}Cr.push("scrollEnd");var Rr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ar=[],Ir=0,Nr=0;function Or(){for(var e=Ir,t=Nr=Ir=0;t<e;){var n=Ar[t];Ar[t++]=null;var r=Ar[t];Ar[t++]=null;var i=Ar[t];Ar[t++]=null;var o=Ar[t];if(Ar[t++]=null,null!==r&&null!==i){var a=r.pending;null===a?i.next=i:(i.next=a.next,a.next=i),r.pending=i}0!==o&&xr(n,i,o)}}function Pr(e,t,n,r){Ar[Ir++]=e,Ar[Ir++]=t,Ar[Ir++]=n,Ar[Ir++]=r,Nr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function kr(e,t,n,r){return Pr(e,t,n,r),Lr(e)}function Dr(e,t){return Pr(e,null,null,t),Lr(e)}function xr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(r=o.alternate)&&(r.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(i=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,i&&null!==t&&(i=31-Ee(n),null===(r=(e=o.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),o):null}function Lr(e){if(50<Gl)throw Gl=0,zl=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Mr={};function Ur(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new Ur(e,t,n,r)}function jr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vr(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Br(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Wr(e,t,n,r,i,o){var s=0;if(r=e,"function"===typeof e)jr(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Fr(31,n,t,i)).elementType=A,e.lanes=o,e;case _:return Hr(n.children,i,o,t);case v:s=8,i|=24;break;case b:return(e=Fr(12,n,t,2|i)).elementType=b,e.lanes=o,e;case T:return(e=Fr(13,n,t,i)).elementType=T,e.lanes=o,e;case C:return(e=Fr(19,n,t,i)).elementType=C,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case y:s=10;break e;case E:s=9;break e;case S:s=11;break e;case w:s=14;break e;case R:s=16,r=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null}return(t=Fr(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Hr(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function Gr(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function zr(e){var t=Fr(18,null,null,0);return t.stateNode=e,t}function Kr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Yr=new WeakMap;function qr(e,t){if("object"===typeof e&&null!==e){var n=Yr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Yr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Xr=[],Jr=0,Zr=null,Qr=0,$r=[],ei=0,ti=null,ni=1,ri="";function ii(e,t){Xr[Jr++]=Qr,Xr[Jr++]=Zr,Zr=e,Qr=t}function oi(e,t,n){$r[ei++]=ni,$r[ei++]=ri,$r[ei++]=ti,ti=e;var r=ni;e=ri;var i=32-Ee(r)-1;r&=~(1<<i),n+=1;var o=32-Ee(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,ni=1<<32-Ee(t)+i|n<<i|r,ri=o+e}else ni=1<<o|n<<i|r,ri=e}function ai(e){null!==e.return&&(ii(e,1),oi(e,1,0))}function si(e){for(;e===Zr;)Zr=Xr[--Jr],Xr[Jr]=null,Qr=Xr[--Jr],Xr[Jr]=null;for(;e===ti;)ti=$r[--ei],$r[ei]=null,ri=$r[--ei],$r[ei]=null,ni=$r[--ei],$r[ei]=null}function ci(e,t){$r[ei++]=ni,$r[ei++]=ri,$r[ei++]=ti,ni=t.id,ri=t.overflow,ti=e}var li=null,di=null,ui=!1,hi=null,pi=!1,mi=Error(a(519));function fi(e){throw yi(qr(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),mi}function gi(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Be]=e,t[We]=r,n){case"dialog":Jd("cancel",t),Jd("close",t);break;case"iframe":case"object":case"embed":Jd("load",t);break;case"video":case"audio":for(n=0;n<Yd.length;n++)Jd(Yd[n],t);break;case"source":Jd("error",t);break;case"img":case"image":case"link":Jd("error",t),Jd("load",t);break;case"details":Jd("toggle",t);break;case"input":Jd("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Jd("invalid",t);break;case"textarea":Jd("invalid",t),Tt(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||lu(t.textContent,n)?(null!=r.popover&&(Jd("beforetoggle",t),Jd("toggle",t)),null!=r.onScroll&&Jd("scroll",t),null!=r.onScrollEnd&&Jd("scrollend",t),null!=r.onClick&&(t.onclick=kt),t=!0):t=!1,t||fi(e,!0)}function _i(e){for(li=e.return;li;)switch(li.tag){case 5:case 31:case 13:return void(pi=!1);case 27:case 3:return void(pi=!0);default:li=li.return}}function vi(e){if(e!==li)return!1;if(!ui)return _i(e),ui=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bu(e.type,e.memoizedProps)),t=!t),t&&di&&fi(e),_i(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));di=Lu(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));di=Lu(e)}else 27===n?(n=di,Ru(e.type)?(e=xu,xu=null,di=e):di=n):di=li?Du(e.stateNode.nextSibling):null;return!0}function bi(){di=li=null,ui=!1}function Ei(){var e=hi;return null!==e&&(null===Ol?Ol=e:Ol.push.apply(Ol,e),hi=null),e}function yi(e){null===hi?hi=[e]:hi.push(e)}var Si=j(null),Ti=null,Ci=null;function wi(e,t,n){B(Si,t._currentValue),t._currentValue=n}function Ri(e){e._currentValue=Si.current,V(Si)}function Ai(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ii(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var s=i.child;o=o.firstContext;e:for(;null!==o;){var c=o;o=i;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ai(o.return,n,e),r||(s=null);break e}o=c.next}}else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Ai(s,n,e),s=null}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===e){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}}function Ni(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(0!==(524288&i.flags))o=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var s=i.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var c=i.type;Qn(i.pendingProps.value,s.value)||(null!==e?e.push(c):e=[c])}}else if(i===Y.current){if(null===(s=i.alternate))throw Error(a(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(dh):e=[dh])}i=i.return}null!==e&&Ii(t,e,n,r),t.flags|=262144}function Oi(e){for(e=e.firstContext;null!==e;){if(!Qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Pi(e){Ti=e,Ci=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ki(e){return xi(Ti,e)}function Di(e,t){return null===Ti&&Pi(e),xi(e,t)}function xi(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ci){if(null===e)throw Error(a(308));Ci=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ci=Ci.next=t;return n}var Li="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Mi=r.unstable_scheduleCallback,Ui=r.unstable_NormalPriority,Fi={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ji(){return{controller:new Li,data:new Map,refCount:0}}function Vi(e){e.refCount--,0===e.refCount&&Mi(Ui,function(){e.controller.abort()})}var Bi=null,Wi=0,Hi=0,Gi=null;function zi(){if(0===--Wi&&null!==Bi){null!==Gi&&(Gi.status="fulfilled");var e=Bi;Bi=null,Hi=0,Gi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ki=x.S;x.S=function(e,t){Dl=ce(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Bi){var n=Bi=[];Wi=0,Hi=Wd(),Gi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Wi++,t.then(zi,zi)}(0,t),null!==Ki&&Ki(e,t)};var Yi=j(null);function qi(){var e=Yi.current;return null!==e?e:ml.pooledCache}function Xi(e,t){B(Yi,null===t?Yi.current:t.pool)}function Ji(){var e=qi();return null===e?null:{parent:Fi._currentValue,pool:e}}var Zi=Error(a(460)),Qi=Error(a(474)),$i=Error(a(542)),eo={then:function(){}};function to(e){return"fulfilled"===(e=e.status)||"rejected"===e}function no(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(kt,kt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e;default:if("string"===typeof t.status)t.then(kt,kt);else{if(null!==(e=ml)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e}throw io=t,Zi}}function ro(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw io=t,Zi;throw t}}var io=null;function oo(){if(null===io)throw Error(a(459));var e=io;return io=null,e}function ao(e){if(e===Zi||e===$i)throw Error(a(483))}var so=null,co=0;function lo(e){var t=co;return co+=1,null===so&&(so=[]),no(so,e,t)}function uo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ho(e,t){if(t.$$typeof===m)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function po(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Vr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Gr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===_?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===R&&ro(o)===t.type)?(uo(t=i(t,n.props),n),t.return=e,t):(uo(t=Wr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Kr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function u(e,t,n,r,o){return null===t||7!==t.tag?((t=Hr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Gr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return uo(n=Wr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Kr(t,e.mode,n)).return=e,t;case R:return h(e,t=ro(t),n)}if(D(t)||O(t))return(t=Hr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,lo(t),n);if(t.$$typeof===y)return h(e,Di(e,t),n);ho(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return n.key===i?l(e,t,n,r):null;case g:return n.key===i?d(e,t,n,r):null;case R:return p(e,t,n=ro(n),r)}if(D(n)||O(n))return null!==i?null:u(e,t,n,r,null);if("function"===typeof n.then)return p(e,t,lo(n),r);if(n.$$typeof===y)return p(e,t,Di(e,n),r);ho(e,n)}return null}function m(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case f:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return m(e,t,n,r=ro(r),i)}if(D(r)||O(r))return u(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return m(e,t,n,lo(r),i);if(r.$$typeof===y)return m(e,t,n,Di(t,r),i);ho(t,r)}return null}function v(c,l,d,u){if("object"===typeof d&&null!==d&&d.type===_&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case f:e:{for(var b=d.key;null!==l;){if(l.key===b){if((b=d.type)===_){if(7===l.tag){n(c,l.sibling),(u=i(l,d.props.children)).return=c,c=u;break e}}else if(l.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===R&&ro(b)===l.type){n(c,l.sibling),uo(u=i(l,d.props),d),u.return=c,c=u;break e}n(c,l);break}t(c,l),l=l.sibling}d.type===_?((u=Hr(d.props.children,c.mode,u,d.key)).return=c,c=u):(uo(u=Wr(d.type,d.key,d.props,null,c.mode,u),d),u.return=c,c=u)}return s(c);case g:e:{for(b=d.key;null!==l;){if(l.key===b){if(4===l.tag&&l.stateNode.containerInfo===d.containerInfo&&l.stateNode.implementation===d.implementation){n(c,l.sibling),(u=i(l,d.children||[])).return=c,c=u;break e}n(c,l);break}t(c,l),l=l.sibling}(u=Kr(d,c.mode,u)).return=c,c=u}return s(c);case R:return v(c,l,d=ro(d),u)}if(D(d))return function(i,a,s,c){for(var l=null,d=null,u=a,f=a=0,g=null;null!==u&&f<s.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var _=p(i,u,s[f],c);if(null===_){null===u&&(u=g);break}e&&u&&null===_.alternate&&t(i,u),a=o(_,a,f),null===d?l=_:d.sibling=_,d=_,u=g}if(f===s.length)return n(i,u),ui&&ii(i,f),l;if(null===u){for(;f<s.length;f++)null!==(u=h(i,s[f],c))&&(a=o(u,a,f),null===d?l=u:d.sibling=u,d=u);return ui&&ii(i,f),l}for(u=r(u);f<s.length;f++)null!==(g=m(u,i,f,s[f],c))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),a=o(g,a,f),null===d?l=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(i,e)}),ui&&ii(i,f),l}(c,l,d,u);if(O(d)){if("function"!==typeof(b=O(d)))throw Error(a(150));return function(i,s,c,l){if(null==c)throw Error(a(151));for(var d=null,u=null,f=s,g=s=0,_=null,v=c.next();null!==f&&!v.done;g++,v=c.next()){f.index>g?(_=f,f=null):_=f.sibling;var b=p(i,f,v.value,l);if(null===b){null===f&&(f=_);break}e&&f&&null===b.alternate&&t(i,f),s=o(b,s,g),null===u?d=b:u.sibling=b,u=b,f=_}if(v.done)return n(i,f),ui&&ii(i,g),d;if(null===f){for(;!v.done;g++,v=c.next())null!==(v=h(i,v.value,l))&&(s=o(v,s,g),null===u?d=v:u.sibling=v,u=v);return ui&&ii(i,g),d}for(f=r(f);!v.done;g++,v=c.next())null!==(v=m(f,i,g,v.value,l))&&(e&&null!==v.alternate&&f.delete(null===v.key?g:v.key),s=o(v,s,g),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach(function(e){return t(i,e)}),ui&&ii(i,g),d}(c,l,d=b.call(d),u)}if("function"===typeof d.then)return v(c,l,lo(d),u);if(d.$$typeof===y)return v(c,l,Di(c,d),u);ho(c,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==l&&6===l.tag?(n(c,l.sibling),(u=i(l,d)).return=c,c=u):(n(c,l),(u=Gr(d,c.mode,u)).return=c,c=u),s(c)):n(c,l)}return function(e,t,n,r){try{co=0;var i=v(e,t,n,r);return so=null,i}catch(a){if(a===Zi||a===$i)throw a;var o=Fr(29,a,null,e.mode);return o.lanes=r,o.return=e,o}}}var mo=po(!0),fo=po(!1),go=!1;function _o(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Eo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&pl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Lr(e),xr(e,null,n),t}return Pr(e,r,t,n),Lr(e)}function yo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xe(e,n)}}function So(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var To=!1;function Co(){if(To){if(null!==Gi)throw Gi}}function wo(e,t,n,r){To=!1;var i=e.updateQueue;go=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?o=l:a.next=l,a=c;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==a&&(null===s?d.firstBaseUpdate=l:s.next=l,d.lastBaseUpdate=c))}if(null!==o){var u=i.baseState;for(a=0,d=l=c=null,s=o;;){var h=-536870913&s.lane,m=h!==s.lane;if(m?(gl&h)===h:(r&h)===h){0!==h&&h===Hi&&(To=!0),null!==d&&(d=d.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var f=e,g=s;h=t;var _=n;switch(g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(_,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=g.payload)?f.call(_,u,h):f)||void 0===h)break e;u=p({},u,h);break e;case 2:go=!0}}null!==(h=s.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=i.callbacks)?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(l=d=m,c=u):d=d.next=m,a|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(m=s).next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}null===d&&(c=u),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=d,null===o&&(i.shared.lanes=0),Cl|=a,e.lanes=a,e.memoizedState=u}}function Ro(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function Ao(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ro(n[e],t)}var Io=j(null),No=j(0);function Oo(e,t){B(No,e=Sl),B(Io,t),Sl=e|t.baseLanes}function Po(){B(No,Sl),B(Io,Io.current)}function ko(){Sl=No.current,V(Io),V(No)}var Do=j(null),xo=null;function Lo(e){var t=e.alternate;B(Vo,1&Vo.current),B(Do,e),null===xo&&(null===t||null!==Io.current||null!==t.memoizedState)&&(xo=e)}function Mo(e){B(Vo,Vo.current),B(Do,e),null===xo&&(xo=e)}function Uo(e){22===e.tag?(B(Vo,Vo.current),B(Do,e),null===xo&&(xo=e)):Fo()}function Fo(){B(Vo,Vo.current),B(Do,Do.current)}function jo(e){V(Do),xo===e&&(xo=null),V(Vo)}var Vo=j(0);function Bo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Pu(n)||ku(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wo=0,Ho=null,Go=null,zo=null,Ko=!1,Yo=!1,qo=!1,Xo=0,Jo=0,Zo=null,Qo=0;function $o(){throw Error(a(321))}function ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qn(e[n],t[n]))return!1;return!0}function ta(e,t,n,r,i,o){return Wo=o,Ho=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,x.H=null===e||null===e.memoizedState?gs:_s,qo=!1,o=n(r,i),qo=!1,Yo&&(o=ra(t,n,r,i)),na(e),o}function na(e){x.H=fs;var t=null!==Go&&null!==Go.next;if(Wo=0,zo=Go=Ho=null,Ko=!1,Jo=0,Zo=null,t)throw Error(a(300));null===e||Ds||null!==(e=e.dependencies)&&Oi(e)&&(Ds=!0)}function ra(e,t,n,r){Ho=e;var i=0;do{if(Yo&&(Zo=null),Jo=0,Yo=!1,25<=i)throw Error(a(301));if(i+=1,zo=Go=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}x.H=vs,o=t(n,r)}while(Yo);return o}function ia(){var e=x.H,t=e.useState()[0];return t="function"===typeof t.then?da(t):t,e=e.useState()[0],(null!==Go?Go.memoizedState:null)!==e&&(Ho.flags|=1024),t}function oa(){var e=0!==Xo;return Xo=0,e}function aa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function sa(e){if(Ko){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ko=!1}Wo=0,zo=Go=Ho=null,Yo=!1,Jo=Xo=0,Zo=null}function ca(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===zo?Ho.memoizedState=zo=e:zo=zo.next=e,zo}function la(){if(null===Go){var e=Ho.alternate;e=null!==e?e.memoizedState:null}else e=Go.next;var t=null===zo?Ho.memoizedState:zo.next;if(null!==t)zo=t,Go=e;else{if(null===e){if(null===Ho.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Go=e).memoizedState,baseState:Go.baseState,baseQueue:Go.baseQueue,queue:Go.queue,next:null},null===zo?Ho.memoizedState=zo=e:zo=zo.next=e}return zo}function da(e){var t=Jo;return Jo+=1,null===Zo&&(Zo=[]),e=no(Zo,e,t),t=Ho,null===(null===zo?t.memoizedState:zo.next)&&(t=t.alternate,x.H=null===t||null===t.memoizedState?gs:_s),e}function ua(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return da(e);if(e.$$typeof===y)return ki(e)}throw Error(a(438,String(e)))}function ha(e){var t=null,n=Ho.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Ho.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=I;return t.index++,n}function pa(e,t){return"function"===typeof t?t(e):t}function ma(e){return fa(la(),Go,e)}function fa(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var c=s=null,l=null,d=t=i.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(gl&h)===h:(Wo&h)===h){var p=d.revertLane;if(0===p)null!==l&&(l=l.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Hi&&(u=!0);else{if((Wo&p)===p){d=d.next,p===Hi&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===l?(c=l=h,s=o):l=l.next=h,Ho.lanes|=p,Cl|=p}h=d.action,qo&&n(o,h),o=d.hasEagerState?d.eagerState:n(o,h)}else p={lane:h,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===l?(c=l=p,s=o):l=l.next=p,Ho.lanes|=h,Cl|=h;d=d.next}while(null!==d&&d!==t);if(null===l?s=o:l.next=c,!Qn(o,e.memoizedState)&&(Ds=!0,u&&null!==(n=Gi)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function ga(e){var t=la(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);Qn(o,t.memoizedState)||(Ds=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function _a(e,t,n){var r=Ho,i=la(),o=ui;if(o){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Qn((Go||i).memoizedState,n);if(s&&(i.memoizedState=n,Ds=!0),i=i.queue,Wa(Ea.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||null!==zo&&1&zo.memoizedState.tag){if(r.flags|=2048,Ua(9,{destroy:void 0},ba.bind(null,r,i,n,t),null),null===ml)throw Error(a(349));o||0!==(127&Wo)||va(r,t,n)}return n}function va(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ho.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ba(e,t,n,r){t.value=n,t.getSnapshot=r,ya(t)&&Sa(e)}function Ea(e,t,n){return n(function(){ya(t)&&Sa(e)})}function ya(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qn(e,n)}catch(r){return!0}}function Sa(e){var t=Dr(e,2);null!==t&&ql(t,e,2)}function Ta(e){var t=ca();if("function"===typeof e){var n=e;if(e=n(),qo){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:e},t}function Ca(e,t,n,r){return e.baseState=n,fa(e,Go,"function"===typeof r?r:pa)}function wa(e,t,n,r,i){if(hs(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==x.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,Ra(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Ra(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=x.T,a={};x.T=a;try{var s=n(i,r),c=x.S;null!==c&&c(a,s),Aa(e,t,s)}catch(l){Na(e,t,l)}finally{null!==o&&null!==a.types&&(o.types=a.types),x.T=o}}else try{Aa(e,t,o=n(i,r))}catch(d){Na(e,t,d)}}function Aa(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Ia(e,t,n)},function(n){return Na(e,t,n)}):Ia(e,t,n)}function Ia(e,t,n){t.status="fulfilled",t.value=n,Oa(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ra(e,n)))}function Na(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Oa(t),t=t.next}while(t!==r)}e.action=null}function Oa(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Pa(e,t){return t}function ka(e,t){if(ui){var n=ml.formState;if(null!==n){e:{var r=Ho;if(ui){if(di){t:{for(var i=di,o=pi;8!==i.nodeType;){if(!o){i=null;break t}if(null===(i=Du(i.nextSibling))){i=null;break t}}i="F!"===(o=i.data)||"F"===o?i:null}if(i){di=Du(i.nextSibling),r="F!"===i.data;break e}}fi(r)}r=!1}r&&(t=n[0])}}return(n=ca()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:t},n.queue=r,n=ls.bind(null,Ho,r),r.dispatch=n,r=Ta(!1),o=us.bind(null,Ho,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=ca()).queue=i,n=wa.bind(null,Ho,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function Da(e){return xa(la(),Go,e)}function xa(e,t,n){if(t=fa(e,t,Pa)[0],e=ma(pa)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=da(t)}catch(a){if(a===Zi)throw $i;throw a}else r=t;var i=(t=la()).queue,o=i.dispatch;return n!==t.memoizedState&&(Ho.flags|=2048,Ua(9,{destroy:void 0},La.bind(null,i,n),null)),[r,o,e]}function La(e,t){e.action=t}function Ma(e){var t=la(),n=Go;if(null!==n)return xa(t,n,e);la(),t=t.memoizedState;var r=(n=la()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ua(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Ho.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fa(){return la().memoizedState}function ja(e,t,n,r){var i=ca();Ho.flags|=e,i.memoizedState=Ua(1|t,{destroy:void 0},n,void 0===r?null:r)}function Va(e,t,n,r){var i=la();r=void 0===r?null:r;var o=i.memoizedState.inst;null!==Go&&null!==r&&ea(r,Go.memoizedState.deps)?i.memoizedState=Ua(t,o,n,r):(Ho.flags|=e,i.memoizedState=Ua(1|t,o,n,r))}function Ba(e,t){ja(8390656,8,e,t)}function Wa(e,t){Va(2048,8,e,t)}function Ha(e){var t=la().memoizedState;return function(e){Ho.flags|=4;var t=Ho.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&pl))throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Ga(e,t){return Va(4,2,e,t)}function za(e,t){return Va(4,4,e,t)}function Ka(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ya(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Va(4,4,Ka.bind(null,t,e),n)}function qa(){}function Xa(e,t){var n=la();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&ea(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ja(e,t){var n=la();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&ea(t,r[1]))return r[0];if(r=e(),qo){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function Za(e,t,n){return void 0===n||0!==(1073741824&Wo)&&0===(261930&gl)?e.memoizedState=t:(e.memoizedState=n,e=Yl(),Ho.lanes|=e,Cl|=e,n)}function Qa(e,t,n,r){return Qn(n,t)?n:null!==Io.current?(e=Za(e,n,r),Qn(e,t)||(Ds=!0),e):0===(42&Wo)||0!==(1073741824&Wo)&&0===(261930&gl)?(Ds=!0,e.memoizedState=n):(e=Yl(),Ho.lanes|=e,Cl|=e,t)}function $a(e,t,n,r,i){var o=L.p;L.p=0!==o&&8>o?o:8;var a=x.T,s={};x.T=s,us(e,!1,t,n);try{var c=i(),l=x.S;if(null!==l&&l(s,c),null!==c&&"object"===typeof c&&"function"===typeof c.then)ds(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(c,r),Kl());else ds(e,t,r,Kl())}catch(d){ds(e,t,{then:function(){},status:"rejected",reason:d},Kl())}finally{L.p=o,null!==a&&null!==s.types&&(a.types=s.types),x.T=a}}function es(){}function ts(e,t,n,r){if(5!==e.tag)throw Error(a(476));var i=ns(e).queue;$a(e,i,t,M,null===n?es:function(){return rs(e),n(r)})}function ns(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function rs(e){var t=ns(e);null===t.next&&(t=e.alternate.memoizedState),ds(e,t.next.queue,{},Kl())}function is(){return ki(dh)}function os(){return la().memoizedState}function as(){return la().memoizedState}function ss(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Kl(),r=Eo(t,e=bo(n),n);return null!==r&&(ql(r,t,n),yo(r,t,n)),t={cache:ji()},void(e.payload=t)}t=t.return}}function cs(e,t,n){var r=Kl();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hs(e)?ps(t,n):null!==(n=kr(e,t,n,r))&&(ql(n,e,r),ms(n,t,r))}function ls(e,t,n){ds(e,t,n,Kl())}function ds(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hs(e))ps(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,Qn(s,a))return Pr(e,t,i,0),null===ml&&Or(),!1}catch(c){}if(null!==(n=kr(e,t,i,r)))return ql(n,e,r),ms(n,t,r),!0}return!1}function us(e,t,n,r){if(r={lane:2,revertLane:Wd(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hs(e)){if(t)throw Error(a(479))}else null!==(t=kr(e,n,r,2))&&ql(t,e,2)}function hs(e){var t=e.alternate;return e===Ho||null!==t&&t===Ho}function ps(e,t){Yo=Ko=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ms(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xe(e,n)}}var fs={readContext:ki,use:ua,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useLayoutEffect:$o,useInsertionEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useDeferredValue:$o,useTransition:$o,useSyncExternalStore:$o,useId:$o,useHostTransitionStatus:$o,useFormState:$o,useActionState:$o,useOptimistic:$o,useMemoCache:$o,useCacheRefresh:$o};fs.useEffectEvent=$o;var gs={readContext:ki,use:ua,useCallback:function(e,t){return ca().memoizedState=[e,void 0===t?null:t],e},useContext:ki,useEffect:Ba,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ja(4194308,4,Ka.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ja(4194308,4,e,t)},useInsertionEffect:function(e,t){ja(4,2,e,t)},useMemo:function(e,t){var n=ca();t=void 0===t?null:t;var r=e();if(qo){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=ca();if(void 0!==n){var i=n(t);if(qo){be(!0);try{n(t)}finally{be(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=cs.bind(null,Ho,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ca().memoizedState=e},useState:function(e){var t=(e=Ta(e)).queue,n=ls.bind(null,Ho,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:qa,useDeferredValue:function(e,t){return Za(ca(),e,t)},useTransition:function(){var e=Ta(!1);return e=$a.bind(null,Ho,e.queue,!0,!1),ca().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ho,i=ca();if(ui){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===ml)throw Error(a(349));0!==(127&gl)||va(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Ba(Ea.bind(null,r,o,e),[e]),r.flags|=2048,Ua(9,{destroy:void 0},ba.bind(null,r,o,n,t),null),n},useId:function(){var e=ca(),t=ml.identifierPrefix;if(ui){var n=ri;t="_"+t+"R_"+(n=(ni&~(1<<32-Ee(ni)-1)).toString(32)+n),0<(n=Xo++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Qo++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:is,useFormState:ka,useActionState:ka,useOptimistic:function(e){var t=ca();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=us.bind(null,Ho,!0,n),n.dispatch=t,[e,t]},useMemoCache:ha,useCacheRefresh:function(){return ca().memoizedState=ss.bind(null,Ho)},useEffectEvent:function(e){var t=ca(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&pl))throw Error(a(440));return n.impl.apply(void 0,arguments)}}},_s={readContext:ki,use:ua,useCallback:Xa,useContext:ki,useEffect:Wa,useImperativeHandle:Ya,useInsertionEffect:Ga,useLayoutEffect:za,useMemo:Ja,useReducer:ma,useRef:Fa,useState:function(){return ma(pa)},useDebugValue:qa,useDeferredValue:function(e,t){return Qa(la(),Go.memoizedState,e,t)},useTransition:function(){var e=ma(pa)[0],t=la().memoizedState;return["boolean"===typeof e?e:da(e),t]},useSyncExternalStore:_a,useId:os,useHostTransitionStatus:is,useFormState:Da,useActionState:Da,useOptimistic:function(e,t){return Ca(la(),0,e,t)},useMemoCache:ha,useCacheRefresh:as};_s.useEffectEvent=Ha;var vs={readContext:ki,use:ua,useCallback:Xa,useContext:ki,useEffect:Wa,useImperativeHandle:Ya,useInsertionEffect:Ga,useLayoutEffect:za,useMemo:Ja,useReducer:ga,useRef:Fa,useState:function(){return ga(pa)},useDebugValue:qa,useDeferredValue:function(e,t){var n=la();return null===Go?Za(n,e,t):Qa(n,Go.memoizedState,e,t)},useTransition:function(){var e=ga(pa)[0],t=la().memoizedState;return["boolean"===typeof e?e:da(e),t]},useSyncExternalStore:_a,useId:os,useHostTransitionStatus:is,useFormState:Ma,useActionState:Ma,useOptimistic:function(e,t){var n=la();return null!==Go?Ca(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ha,useCacheRefresh:as};function bs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}vs.useEffectEvent=Ha;var Es={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Kl(),i=bo(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Eo(e,i,r))&&(ql(t,e,r),yo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Kl(),i=bo(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Eo(e,i,r))&&(ql(t,e,r),yo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kl(),r=bo(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Eo(e,r,n))&&(ql(t,e,n),yo(t,e,n))}};function ys(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!$n(n,r)||!$n(i,o))}function Ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Es.enqueueReplaceState(t,t.state,null)}function Ts(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=p({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function Cs(e){Rr(e)}function ws(e){console.error(e)}function Rs(e){Rr(e)}function As(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Is(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Ns(e,t,n){return(n=bo(n)).tag=3,n.payload={element:null},n.callback=function(){As(e,t)},n}function Os(e){return(e=bo(e)).tag=3,e}function Ps(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){Is(t,n,r)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){Is(t,n,r),"function"!==typeof i&&(null===Ml?Ml=new Set([this]):Ml.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var ks=Error(a(461)),Ds=!1;function xs(e,t,n,r){t.child=null===e?fo(t,null,n,r):mo(t,e.child,n,r)}function Ls(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var a={};for(var s in r)"ref"!==s&&(a[s]=r[s])}else a=r;return Pi(t),r=ta(e,t,n,a,o,i),s=oa(),null===e||Ds?(ui&&s&&ai(t),t.flags|=1,xs(e,t,r,i),t.child):(aa(e,t,i),ic(e,t,i))}function Ms(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||jr(o)||void 0!==o.defaultProps||null!==n.compare?((e=Wr(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Us(e,t,o,r,i))}if(o=e.child,!oc(e,i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:$n)(a,r)&&e.ref===t.ref)return ic(e,t,i)}return t.flags|=1,(e=Vr(o,r)).ref=t.ref,e.return=t,t.child=e}function Us(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if($n(o,r)&&e.ref===t.ref){if(Ds=!1,t.pendingProps=r=o,!oc(e,i))return t.lanes=e.lanes,ic(e,t,i);0!==(131072&e.flags)&&(Ds=!0)}}return Gs(e,t,n,r,i)}function Fs(e,t,n,r){var i=r.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(o=null!==o?o.baseLanes|n:n,null!==e){for(r=t.child=e.child,i=0;null!==r;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~o}else r=0,t.child=null;return Vs(e,t,o,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Vs(e,t,null!==o?o.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Xi(0,null!==o?o.cachePool:null),null!==o?Oo(t,o):Po(),Uo(t)}else null!==o?(Xi(0,o.cachePool),Oo(t,o),Fo(),t.memoizedState=null):(null!==e&&Xi(0,null),Po(),Fo());return xs(e,t,i,n),t.child}function js(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Vs(e,t,n,r,i){var o=qi();return o=null===o?null:{parent:Fi._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Xi(0,null),Po(),Uo(t),null!==e&&Ni(e,t,r,!0),t.childLanes=i,null}function Bs(e,t){return(t=$s({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Ws(e,t,n){return mo(t,e.child,null,n),(e=Bs(t,t.pendingProps)).flags|=2,jo(t),t.memoizedState=null,e}function Hs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Gs(e,t,n,r,i){return Pi(t),n=ta(e,t,n,r,void 0,i),r=oa(),null===e||Ds?(ui&&r&&ai(t),t.flags|=1,xs(e,t,n,i),t.child):(aa(e,t,i),ic(e,t,i))}function zs(e,t,n,r,i,o){return Pi(t),t.updateQueue=null,n=ra(t,r,n,i),na(e),r=oa(),null===e||Ds?(ui&&r&&ai(t),t.flags|=1,xs(e,t,n,o),t.child):(aa(e,t,o),ic(e,t,o))}function Ks(e,t,n,r,i){if(Pi(t),null===t.stateNode){var o=Mr,a=n.contextType;"object"===typeof a&&null!==a&&(o=ki(a)),o=new n(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=Es,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},_o(t),a=n.contextType,o.context="object"===typeof a&&null!==a?ki(a):Mr,o.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(bs(t,n,a,r),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(a=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),a!==o.state&&Es.enqueueReplaceState(o,o.state,null),wo(t,r,o,i),Co(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var s=t.memoizedProps,c=Ts(n,s);o.props=c;var l=o.context,d=n.contextType;a=Mr,"object"===typeof d&&null!==d&&(a=ki(d));var u=n.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate,s=t.pendingProps!==s,d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s||l!==a)&&Ss(t,o,r,a),go=!1;var h=t.memoizedState;o.state=h,wo(t,r,o,i),Co(),l=t.memoizedState,s||h!==l||go?("function"===typeof u&&(bs(t,n,u,r),l=t.memoizedState),(c=go||ys(t,n,c,r,h,l,a))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=a,r=c):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,vo(e,t),d=Ts(n,a=t.memoizedProps),o.props=d,u=t.pendingProps,h=o.context,l=n.contextType,c=Mr,"object"===typeof l&&null!==l&&(c=ki(l)),(l="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==u||h!==c)&&Ss(t,o,r,c),go=!1,h=t.memoizedState,o.state=h,wo(t,r,o,i),Co();var p=t.memoizedState;a!==u||h!==p||go||null!==e&&null!==e.dependencies&&Oi(e.dependencies)?("function"===typeof s&&(bs(t,n,s,r),p=t.memoizedState),(d=go||ys(t,n,d,r,h,p,c)||null!==e&&null!==e.dependencies&&Oi(e.dependencies))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=c,r=d):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,Hs(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=mo(t,e.child,null,i),t.child=mo(t,null,n,i)):xs(e,t,n,i),t.memoizedState=o.state,e=t.child):e=ic(e,t,i),e}function Ys(e,t,n,r){return bi(),t.flags|=256,xs(e,t,n,r),t.child}var qs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xs(e){return{baseLanes:e,cachePool:Ji()}}function Js(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Al),e}function Zs(e,t,n){var r,i=t.pendingProps,o=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Vo.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ui){if(o?Lo(t):Fo(),(e=di)?null!==(e=null!==(e=Ou(e,pi))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},(n=zr(e)).return=t,t.child=n,li=t,di=null):e=null,null===e)throw fi(t);return ku(e)?t.lanes=32:t.lanes=536870912,null}var c=i.children;return i=i.fallback,o?(Fo(),c=$s({mode:"hidden",children:c},o=t.mode),i=Hr(i,o,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(i=t.child).memoizedState=Xs(n),i.childLanes=Js(e,r,n),t.memoizedState=qs,js(null,i)):(Lo(t),Qs(t,c))}var l=e.memoizedState;if(null!==l&&null!==(c=l.dehydrated)){if(s)256&t.flags?(Lo(t),t.flags&=-257,t=ec(e,t,n)):null!==t.memoizedState?(Fo(),t.child=e.child,t.flags|=128,t=null):(Fo(),c=i.fallback,o=t.mode,i=$s({mode:"visible",children:i.children},o),(c=Hr(c,o,n,null)).flags|=2,i.return=t,c.return=t,i.sibling=c,t.child=i,mo(t,e.child,null,n),(i=t.child).memoizedState=Xs(n),i.childLanes=Js(e,r,n),t.memoizedState=qs,t=js(null,i));else if(Lo(t),ku(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var d=r.dgst;r=d,(i=Error(a(419))).stack="",i.digest=r,yi({value:i,source:null,stack:null}),t=ec(e,t,n)}else if(Ds||Ni(e,t,n,!1),r=0!==(n&e.childLanes),Ds||r){if(null!==(r=ml)&&(0!==(i=Le(r,n))&&i!==l.retryLane))throw l.retryLane=i,Dr(e,i),ql(r,e,i),ks;Pu(c)||ad(),t=ec(e,t,n)}else Pu(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,di=Du(c.nextSibling),li=t,ui=!0,hi=null,pi=!1,null!==e&&ci(t,e),(t=Qs(t,i.children)).flags|=4096);return t}return o?(Fo(),c=i.fallback,o=t.mode,d=(l=e.child).sibling,(i=Vr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==d?c=Vr(d,c):(c=Hr(c,o,n,null)).flags|=2,c.return=t,i.return=t,i.sibling=c,t.child=i,js(null,i),i=t.child,null===(c=e.child.memoizedState)?c=Xs(n):(null!==(o=c.cachePool)?(l=Fi._currentValue,o=o.parent!==l?{parent:l,pool:l}:o):o=Ji(),c={baseLanes:c.baseLanes|n,cachePool:o}),i.memoizedState=c,i.childLanes=Js(e,r,n),t.memoizedState=qs,js(e.child,i)):(Lo(t),e=(n=e.child).sibling,(n=Vr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Qs(e,t){return(t=$s({mode:"visible",children:t},e.mode)).return=e,e.child=t}function $s(e,t){return(e=Fr(22,e,null,t)).lanes=0,e}function ec(e,t,n){return mo(t,e.child,null,n),(e=Qs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tc(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ai(e.return,t,n)}function nc(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i,a.treeForkCount=o)}function rc(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;r=r.children;var a=Vo.current,s=0!==(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,B(Vo,a),xs(e,t,r,n),r=ui?Qr:0,!s&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tc(e,n,t);else if(19===e.tag)tc(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Bo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),nc(t,!1,i,n,o,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Bo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}nc(t,!0,n,null,o,r);break;case"together":nc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function ic(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Cl|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ni(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Vr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Vr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function oc(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Oi(e))}function ac(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ds=!0;else{if(!oc(e,n)&&0===(128&t.flags))return Ds=!1,function(e,t,n){switch(t.tag){case 3:q(t,t.stateNode.containerInfo),wi(0,Fi,e.memoizedState.cache),bi();break;case 27:case 5:J(t);break;case 4:q(t,t.stateNode.containerInfo);break;case 10:wi(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Mo(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Lo(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Zs(e,t,n):(Lo(t),null!==(e=ic(e,t,n))?e.sibling:null);Lo(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ni(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return rc(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),B(Vo,Vo.current),r)break;return null;case 22:return t.lanes=0,Fs(e,t,n,t.pendingProps);case 24:wi(0,Fi,e.memoizedState.cache)}return ic(e,t,n)}(e,t,n);Ds=0!==(131072&e.flags)}else Ds=!1,ui&&0!==(1048576&t.flags)&&oi(t,Qr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ro(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var i=e.$$typeof;if(i===S){t.tag=11,t=Ls(null,t,e,r,n);break e}if(i===w){t.tag=14,t=Ms(null,t,e,r,n);break e}}throw t=k(e)||e,Error(a(306,t,""))}jr(e)?(r=Ts(e,r),t.tag=1,t=Ks(null,t,e,r,n)):(t.tag=0,t=Gs(null,t,e,r,n))}return t;case 0:return Gs(e,t,t.type,t.pendingProps,n);case 1:return Ks(e,t,r=t.type,i=Ts(r,t.pendingProps),n);case 3:e:{if(q(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,vo(e,t),wo(t,r,null,n);var s=t.memoizedState;if(r=s.cache,wi(0,Fi,r),r!==o.cache&&Ii(t,[Fi],n,!0),Co(),r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ys(e,t,r,n);break e}if(r!==i){yi(i=qr(Error(a(424)),t)),t=Ys(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(di=Du(e.firstChild),li=t,ui=!0,hi=null,pi=!0,n=fo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(bi(),r===i){t=ic(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 26:return Hs(e,t),null===e?(n=zu(t.type,null,t.pendingProps,null))?t.memoizedState=n:ui||(n=t.type,e=t.pendingProps,(r=gu(K.current).createElement(n))[Be]=t,r[We]=e,hu(r,n,e),et(r),t.stateNode=r):t.memoizedState=zu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return J(t),null===e&&ui&&(r=t.stateNode=Uu(t.type,t.pendingProps,K.current),li=t,pi=!0,i=di,Ru(t.type)?(xu=i,di=Du(r.firstChild)):di=i),xs(e,t,t.pendingProps.children,n),Hs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ui&&((i=r=di)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[qe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===o)return e}if(null===(e=Du(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,pi))?(t.stateNode=r,li=t,di=Du(r.firstChild),pi=!1,i=!0):i=!1),i||fi(t)),J(t),i=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,r=o.children,bu(i,o)?r=null:null!==s&&bu(i,s)&&(t.flags|=32),null!==t.memoizedState&&(i=ta(e,t,ia,null,null,n),dh._currentValue=i),Hs(e,t),xs(e,t,r,n),t.child;case 6:return null===e&&ui&&((e=n=di)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Du(e.nextSibling)))return null}return e}(n,t.pendingProps,pi))?(t.stateNode=n,li=t,di=null,e=!0):e=!1),e||fi(t)),null;case 13:return Zs(e,t,n);case 4:return q(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=mo(t,null,r,n):xs(e,t,r,n),t.child;case 11:return Ls(e,t,t.type,t.pendingProps,n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,wi(0,t.type,r.value),xs(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Pi(t),r=r(i=ki(i)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return Ms(e,t,t.type,t.pendingProps,n);case 15:return Us(e,t,t.type,t.pendingProps,n);case 19:return rc(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,i=0!==(128&t.flags);if(t.flags&=-129,null===e){if(ui){if("hidden"===r.mode)return e=Bs(t,r),t.lanes=536870912,js(null,e);if(Mo(t),(e=di)?null!==(e=null!==(e=Ou(e,pi))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},(n=zr(e)).return=t,t.child=n,li=t,di=null):e=null,null===e)throw fi(t);return t.lanes=536870912,null}return Bs(t,r)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(Mo(t),i)if(256&t.flags)t.flags&=-257,t=Ws(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ds||Ni(e,t,n,!1),i=0!==(n&e.childLanes),Ds||i){if(null!==(r=ml)&&0!==(s=Le(r,n))&&s!==o.retryLane)throw o.retryLane=s,Dr(e,s),ql(r,e,s),ks;ad(),t=Ws(e,t,n)}else e=o.treeContext,di=Du(s.nextSibling),li=t,ui=!0,hi=null,pi=!1,null!==e&&ci(t,e),(t=Bs(t,r)).flags|=4096;return t}return(e=Vr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fs(e,t,n,t.pendingProps);case 24:return Pi(t),r=ki(Fi),null===e?(null===(i=qi())&&(i=ml,o=ji(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},_o(t),wi(0,Fi,i)):(0!==(e.lanes&n)&&(vo(e,t),wo(t,null,null,n),Co()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),wi(0,Fi,r)):(r=o.cache,wi(0,Fi,r),r!==i.cache&&Ii(t,[Fi],n,!0))),xs(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function sc(e){e.flags|=4}function cc(e,t,n,r,i){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&i)===i)if(e.stateNode.complete)e.flags|=8192;else{if(!rd())throw io=eo,Qi;e.flags|=8192}}else e.flags&=-16777217}function lc(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ih(t)){if(!rd())throw io=eo,Qi;e.flags|=8192}}function dc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Oe():536870912,e.lanes|=t,Il|=t)}function uc(e,t){if(!ui)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hc(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function pc(e,t,n){var r=t.pendingProps;switch(si(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hc(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ri(Fi),X(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(vi(t)?sc(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,Ei())),hc(t),null;case 26:var i=t.type,o=t.memoizedState;return null===e?(sc(t),null!==o?(hc(t),lc(t,o)):(hc(t),cc(t,i,0,0,n))):o?o!==e.memoizedState?(sc(t),hc(t),lc(t,o)):(hc(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&sc(t),hc(t),cc(t,i,0,0,n)),null;case 27:if(Z(t),n=K.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sc(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hc(t),null}e=G.current,vi(t)?gi(t):(e=Uu(i,r,n),t.stateNode=e,sc(t))}return hc(t),null;case 5:if(Z(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sc(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hc(t),null}if(o=G.current,vi(t))gi(t);else{var s=gu(K.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"===typeof r.is?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o="string"===typeof r.is?s.createElement(i,{is:r.is}):s.createElement(i)}}o[Be]=t,o[We]=r;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(hu(o,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&sc(t)}}return hc(t),cc(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&sc(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(e=K.current,vi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=li))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||lu(e.nodeValue,n)))||fi(t,!0)}else(e=gu(e).createTextNode(r))[Be]=t,t.stateNode=e}return hc(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=vi(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[Be]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hc(t),e=!1}else n=Ei(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(jo(t),t):(jo(t),null);if(0!==(128&t.flags))throw Error(a(558))}return hc(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=vi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[Be]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hc(t),i=!1}else i=Ei(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(jo(t),t):(jo(t),null)}return jo(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),o=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),dc(t,t.updateQueue),hc(t),null);case 4:return X(),null===e&&$d(t.stateNode.containerInfo),hc(t),null;case 10:return Ri(t.type),hc(t),null;case 19:if(V(Vo),null===(r=t.memoizedState))return hc(t),null;if(i=0!==(128&t.flags),null===(o=r.rendering))if(i)uc(r,!1);else{if(0!==Tl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=Bo(e))){for(t.flags|=128,uc(r,!1),e=o.updateQueue,t.updateQueue=e,dc(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Br(n,e),n=n.sibling;return B(Vo,1&Vo.current|2),ui&&ii(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&ce()>xl&&(t.flags|=128,i=!0,uc(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Bo(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,dc(t,e),uc(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!ui)return hc(t),null}else 2*ce()-r.renderingStartTime>xl&&536870912!==n&&(t.flags|=128,i=!0,uc(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=r.last)?e.sibling=o:t.child=o,r.last=o)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=ce(),e.sibling=null,n=Vo.current,B(Vo,i?1&n|2:1&n),ui&&ii(t,r.treeForkCount),e):(hc(t),null);case 22:case 23:return jo(t),ko(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(hc(t),6&t.subtreeFlags&&(t.flags|=8192)):hc(t),null!==(n=t.updateQueue)&&dc(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&V(Yi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ri(Fi),hc(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function mc(e,t){switch(si(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ri(Fi),X(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Z(t),null;case 31:if(null!==t.memoizedState){if(jo(t),null===t.alternate)throw Error(a(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(jo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return V(Vo),null;case 4:return X(),null;case 10:return Ri(t.type),null;case 22:case 23:return jo(t),ko(),null!==e&&V(Yi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ri(Fi),null;default:return null}}function fc(e,t){switch(si(t),t.tag){case 3:Ri(Fi),X();break;case 26:case 27:case 5:Z(t);break;case 4:X();break;case 31:null!==t.memoizedState&&jo(t);break;case 13:jo(t);break;case 19:V(Vo);break;case 10:Ri(t.type);break;case 22:case 23:jo(t),ko(),null!==e&&V(Yi);break;case 24:Ri(Fi)}}function gc(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,a=n.inst;r=o(),a.destroy=r}n=n.next}while(n!==i)}}catch(s){Td(t,t.return,s)}}function _c(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var o=i.next;r=o;do{if((r.tag&e)===e){var a=r.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,i=t;var c=n,l=s;try{l()}catch(d){Td(i,c,d)}}}r=r.next}while(r!==o)}}catch(d){Td(t,t.return,d)}}function vc(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ao(t,n)}catch(r){Td(e,e.return,r)}}}function bc(e,t,n){n.props=Ts(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Td(e,t,r)}}function Ec(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){Td(e,t,i)}}function yc(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){Td(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){Td(e,t,o)}else n.current=null}function Sc(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){Td(e,e.return,i)}}function Tc(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,s=null,c=null,l=null,d=null,u=null;for(m in n){var h=n[m];if(n.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":l=h;default:r.hasOwnProperty(m)||du(e,t,m,null,r,h)}}for(var p in r){var m=r[p];if(h=n[p],r.hasOwnProperty(p)&&(null!=m||null!=h))switch(p){case"type":o=m;break;case"name":i=m;break;case"checked":d=m;break;case"defaultChecked":u=m;break;case"value":s=m;break;case"defaultValue":c=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(a(137,t));break;default:m!==h&&du(e,t,p,m,r,h)}}return void vt(e,s,c,l,d,u,o,i);case"select":for(o in m=s=c=p=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":m=l;default:r.hasOwnProperty(o)||du(e,t,o,null,r,l)}for(i in r)if(o=r[i],l=n[i],r.hasOwnProperty(i)&&(null!=o||null!=l))switch(i){case"value":p=o;break;case"defaultValue":c=o;break;case"multiple":s=o;default:o!==l&&du(e,t,i,o,r,l)}return t=c,n=s,r=m,void(null!=p?yt(e,!!n,p,!1):!!r!==!!n&&(null!=t?yt(e,!!n,t,!0):yt(e,!!n,n?[]:"",!1)));case"textarea":for(c in m=p=null,n)if(i=n[c],n.hasOwnProperty(c)&&null!=i&&!r.hasOwnProperty(c))switch(c){case"value":case"children":break;default:du(e,t,c,null,r,i)}for(s in r)if(i=r[s],o=n[s],r.hasOwnProperty(s)&&(null!=i||null!=o))switch(s){case"value":p=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(a(91));break;default:i!==o&&du(e,t,s,i,r,o)}return void St(e,p,m);case"option":for(var f in n)if(p=n[f],n.hasOwnProperty(f)&&null!=p&&!r.hasOwnProperty(f))if("selected"===f)e.selected=!1;else du(e,t,f,null,r,p);for(l in r)if(p=r[l],m=n[l],r.hasOwnProperty(l)&&p!==m&&(null!=p||null!=m))if("selected"===l)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else du(e,t,l,p,r,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!r.hasOwnProperty(g)&&du(e,t,g,null,r,p);for(d in r)if(p=r[d],m=n[d],r.hasOwnProperty(d)&&p!==m&&(null!=p||null!=m))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:du(e,t,d,p,r,m)}return;default:if(It(t)){for(var _ in n)p=n[_],n.hasOwnProperty(_)&&void 0!==p&&!r.hasOwnProperty(_)&&uu(e,t,_,void 0,r,p);for(u in r)p=r[u],m=n[u],!r.hasOwnProperty(u)||p===m||void 0===p&&void 0===m||uu(e,t,u,p,r,m);return}}for(var v in n)p=n[v],n.hasOwnProperty(v)&&null!=p&&!r.hasOwnProperty(v)&&du(e,t,v,null,r,p);for(h in r)p=r[h],m=n[h],!r.hasOwnProperty(h)||p===m||null==p&&null==m||du(e,t,h,p,r,m)}(r,e.type,n,t),r[We]=t}catch(i){Td(e,e.return,i)}}function Cc(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ru(e.type)||4===e.tag}function wc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Cc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ru(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Rc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=kt));else if(4!==r&&(27===r&&Ru(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Rc(e,t,n),e=e.sibling;null!==e;)Rc(e,t,n),e=e.sibling}function Ac(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Ru(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Ac(e,t,n),e=e.sibling;null!==e;)Ac(e,t,n),e=e.sibling}function Ic(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);hu(t,r,n),t[Be]=e,t[We]=n}catch(o){Td(e,e.return,o)}}var Nc=!1,Oc=!1,Pc=!1,kc="function"===typeof WeakSet?WeakSet:Set,Dc=null;function xc(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:qc(e,n),4&r&&gc(5,n);break;case 1:if(qc(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){Td(n,n.return,a)}else{var i=Ts(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Td(n,n.return,s)}}64&r&&vc(n),512&r&&Ec(n,n.return);break;case 3:if(qc(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ao(e,t)}catch(a){Td(n,n.return,a)}}break;case 27:null===t&&4&r&&Ic(n);case 26:case 5:qc(e,n),null===t&&4&r&&Sc(n),512&r&&Ec(n,n.return);break;case 12:qc(e,n);break;case 31:qc(e,n),4&r&&Vc(e,n);break;case 13:qc(e,n),4&r&&Bc(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Ad.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Nc)){t=null!==t&&null!==t.memoizedState||Oc,i=Nc;var o=Oc;Nc=r,(Oc=t)&&!o?Jc(e,n,0!==(8772&n.subtreeFlags)):qc(e,n),Nc=i,Oc=o}break;case 30:break;default:qc(e,n)}}function Lc(e){var t=e.alternate;null!==t&&(e.alternate=null,Lc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Mc=null,Uc=!1;function Fc(e,t,n){for(n=n.child;null!==n;)jc(e,t,n),n=n.sibling}function jc(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(_e,n)}catch(o){}switch(n.tag){case 26:Oc||yc(n,t),Fc(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Oc||yc(n,t);var r=Mc,i=Uc;Ru(n.type)&&(Mc=n.stateNode,Uc=!1),Fc(e,t,n),Fu(n.stateNode),Mc=r,Uc=i;break;case 5:Oc||yc(n,t);case 6:if(r=Mc,i=Uc,Mc=null,Fc(e,t,n),Uc=i,null!==(Mc=r))if(Uc)try{(9===Mc.nodeType?Mc.body:"HTML"===Mc.nodeName?Mc.ownerDocument.body:Mc).removeChild(n.stateNode)}catch(a){Td(n,t,a)}else try{Mc.removeChild(n.stateNode)}catch(a){Td(n,t,a)}break;case 18:null!==Mc&&(Uc?(Au(9===(e=Mc).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Gh(e)):Au(Mc,n.stateNode));break;case 4:r=Mc,i=Uc,Mc=n.stateNode.containerInfo,Uc=!0,Fc(e,t,n),Mc=r,Uc=i;break;case 0:case 11:case 14:case 15:_c(2,n,t),Oc||_c(4,n,t),Fc(e,t,n);break;case 1:Oc||(yc(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bc(n,t,r)),Fc(e,t,n);break;case 21:Fc(e,t,n);break;case 22:Oc=(r=Oc)||null!==n.memoizedState,Fc(e,t,n),Oc=r;break;default:Fc(e,t,n)}}function Vc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Gh(e)}catch(n){Td(t,t.return,n)}}}function Bc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Gh(e)}catch(n){Td(t,t.return,n)}}function Wc(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new kc),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new kc),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Id.bind(null,e,t);t.then(r,r)}})}function Hc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 27:if(Ru(c.type)){Mc=c.stateNode,Uc=!1;break e}break;case 5:Mc=c.stateNode,Uc=!1;break e;case 3:case 4:Mc=c.stateNode.containerInfo,Uc=!0;break e}c=c.return}if(null===Mc)throw Error(a(160));jc(o,s,i),Mc=null,Uc=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)zc(t,e),t=t.sibling}var Gc=null;function zc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Hc(t,e),Kc(e),4&r&&(_c(3,e,e.return),gc(3,e),_c(5,e,e.return));break;case 1:Hc(t,e),Kc(e),512&r&&(Oc||null===n||yc(n,n.return)),64&r&&Nc&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Gc;if(Hc(t,e),Kc(e),512&r&&(Oc||null===n||yc(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[qe]||o[Be]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),hu(o,r,n),o[Be]=e,et(o),r=o;break e;case"link":var s=nh("link","href",i).get(r+(n.href||""));if(s)for(var c=0;c<s.length;c++)if((o=s[c]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(c,1);break t}hu(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(s=nh("meta","content",i).get(r+(n.content||"")))for(c=0;c<s.length;c++)if((o=s[c]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(c,1);break t}hu(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(a(468,r))}o[Be]=e,et(o),r=o}e.stateNode=r}else rh(i,e.type,e.stateNode);else e.stateNode=Zu(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?rh(i,e.type,e.stateNode):Zu(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Tc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Hc(t,e),Kc(e),512&r&&(Oc||null===n||yc(n,n.return)),null!==n&&4&r&&Tc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Hc(t,e),Kc(e),512&r&&(Oc||null===n||yc(n,n.return)),32&e.flags){i=e.stateNode;try{Ct(i,"")}catch(f){Td(e,e.return,f)}}4&r&&null!=e.stateNode&&Tc(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(Pc=!0);break;case 6:if(Hc(t,e),Kc(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(f){Td(e,e.return,f)}}break;case 3:if(th=null,i=Gc,Gc=Bu(t.containerInfo),Hc(t,e),Gc=i,Kc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Gh(t.containerInfo)}catch(f){Td(e,e.return,f)}Pc&&(Pc=!1,Yc(e));break;case 4:r=Gc,Gc=Bu(e.stateNode.containerInfo),Hc(t,e),Kc(e),Gc=r;break;case 12:default:Hc(t,e),Kc(e);break;case 31:case 19:Hc(t,e),Kc(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Wc(e,r)));break;case 13:Hc(t,e),Kc(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(kl=ce()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Wc(e,r)));break;case 22:i=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,d=Nc,u=Oc;if(Nc=d||i,Oc=u||l,Hc(t,e),Oc=u,Nc=d,Kc(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||l||Nc||Oc||Xc(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,i)"function"===typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{c=l.stateNode;var h=l.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;c.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(f){Td(l,l.return,f)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=i?"":l.memoizedProps}catch(f){Td(l,l.return,f)}}}else if(18===t.tag){if(null===n){l=t;try{var m=l.stateNode;i?Iu(m,!0):Iu(l.stateNode,!1)}catch(f){Td(l,l.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Wc(e,n))));case 30:case 21:}}function Kc(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(Cc(r)){n=r;break}r=r.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var i=n.stateNode;Ac(e,wc(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(Ct(o,""),n.flags&=-33),Ac(e,wc(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;Rc(e,wc(e),s);break;default:throw Error(a(161))}}catch(c){Td(e,e.return,c)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Yc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Yc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function qc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)xc(e,t.alternate,t),t=t.sibling}function Xc(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:_c(4,t,t.return),Xc(t);break;case 1:yc(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bc(t,t.return,n),Xc(t);break;case 27:Fu(t.stateNode);case 26:case 5:yc(t,t.return),Xc(t);break;case 22:null===t.memoizedState&&Xc(t);break;default:Xc(t)}e=e.sibling}}function Jc(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,o=t,a=o.flags;switch(o.tag){case 0:case 11:case 15:Jc(i,o,n),gc(4,o);break;case 1:if(Jc(i,o,n),"function"===typeof(i=(r=o).stateNode).componentDidMount)try{i.componentDidMount()}catch(l){Td(r,r.return,l)}if(null!==(i=(r=o).updateQueue)){var s=r.stateNode;try{var c=i.shared.hiddenCallbacks;if(null!==c)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)Ro(c[i],s)}catch(l){Td(r,r.return,l)}}n&&64&a&&vc(o),Ec(o,o.return);break;case 27:Ic(o);case 26:case 5:Jc(i,o,n),n&&null===r&&4&a&&Sc(o),Ec(o,o.return);break;case 12:Jc(i,o,n);break;case 31:Jc(i,o,n),n&&4&a&&Vc(i,o);break;case 13:Jc(i,o,n),n&&4&a&&Bc(i,o);break;case 22:null===o.memoizedState&&Jc(i,o,n),Ec(o,o.return);break;case 30:break;default:Jc(i,o,n)}t=t.sibling}}function Zc(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Vi(n))}function Qc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vi(e))}function $c(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)el(e,t,n,r),t=t.sibling}function el(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:$c(e,t,n,r),2048&i&&gc(9,t);break;case 1:case 31:case 13:default:$c(e,t,n,r);break;case 3:$c(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vi(e)));break;case 12:if(2048&i){$c(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,a=o.id,s=o.onPostCommit;"function"===typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(c){Td(t,t.return,c)}}else $c(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,a=t.alternate,null!==t.memoizedState?2&o._visibility?$c(e,t,n,r):nl(e,t):2&o._visibility?$c(e,t,n,r):(o._visibility|=2,tl(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&i&&Zc(a,t);break;case 24:$c(e,t,n,r),2048&i&&Qc(t.alternate,t)}}function tl(e,t,n,r,i){for(i=i&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,a=t,s=n,c=r,l=a.flags;switch(a.tag){case 0:case 11:case 15:tl(o,a,s,c,i),gc(8,a);break;case 23:break;case 22:var d=a.stateNode;null!==a.memoizedState?2&d._visibility?tl(o,a,s,c,i):nl(o,a):(d._visibility|=2,tl(o,a,s,c,i)),i&&2048&l&&Zc(a.alternate,a);break;case 24:tl(o,a,s,c,i),i&&2048&l&&Qc(a.alternate,a);break;default:tl(o,a,s,c,i)}t=t.sibling}}function nl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:nl(n,r),2048&i&&Zc(r.alternate,r);break;case 24:nl(n,r),2048&i&&Qc(r.alternate,r);break;default:nl(n,r)}t=t.sibling}}var rl=8192;function il(e,t,n){if(e.subtreeFlags&rl)for(e=e.child;null!==e;)ol(e,t,n),e=e.sibling}function ol(e,t,n){switch(e.tag){case 26:il(e,t,n),e.flags&rl&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var i=Ku(r.href),o=t.querySelector(Yu(i));if(o)return null!==(t=o._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ah.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void et(o);o=t.ownerDocument||t,r=qu(r),(i=ju.get(i))&&$u(r,i),et(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),hu(o,"link",r),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ah.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Gc,e.memoizedState,e.memoizedProps);break;case 5:default:il(e,t,n);break;case 3:case 4:var r=Gc;Gc=Bu(e.stateNode.containerInfo),il(e,t,n),Gc=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rl,rl=16777216,il(e,t,n),rl=r):il(e,t,n))}}function al(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function sl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Dc=r,dl(r,e)}al(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)cl(e),e=e.sibling}function cl(e){switch(e.tag){case 0:case 11:case 15:sl(e),2048&e.flags&&_c(9,e,e.return);break;case 3:case 12:default:sl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ll(e)):sl(e)}}function ll(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Dc=r,dl(r,e)}al(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:_c(8,t,t.return),ll(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ll(t));break;default:ll(t)}e=e.sibling}}function dl(e,t){for(;null!==Dc;){var n=Dc;switch(n.tag){case 0:case 11:case 15:_c(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Vi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Dc=r;else e:for(n=e;null!==Dc;){var i=(r=Dc).sibling,o=r.return;if(Lc(r),r===n){Dc=null;break e}if(null!==i){i.return=o,Dc=i;break e}Dc=o}}}var ul={getCacheForType:function(e){var t=ki(Fi),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ki(Fi).controller.signal}},hl="function"===typeof WeakMap?WeakMap:Map,pl=0,ml=null,fl=null,gl=0,_l=0,vl=null,bl=!1,El=!1,yl=!1,Sl=0,Tl=0,Cl=0,wl=0,Rl=0,Al=0,Il=0,Nl=null,Ol=null,Pl=!1,kl=0,Dl=0,xl=1/0,Ll=null,Ml=null,Ul=0,Fl=null,jl=null,Vl=0,Bl=0,Wl=null,Hl=null,Gl=0,zl=null;function Kl(){return 0!==(2&pl)&&0!==gl?gl&-gl:null!==x.T?Wd():Fe()}function Yl(){if(0===Al)if(0===(536870912&gl)||ui){var e=Ce;0===(3932160&(Ce<<=1))&&(Ce=262144),Al=e}else Al=536870912;return null!==(e=Do.current)&&(e.flags|=32),Al}function ql(e,t,n){(e!==ml||2!==_l&&9!==_l)&&null===e.cancelPendingCommit||(td(e,0),Ql(e,gl,Al,!1)),ke(e,n),0!==(2&pl)&&e===ml||(e===ml&&(0===(2&pl)&&(wl|=n),4===Tl&&Ql(e,gl,Al,!1)),Ld(e))}function Xl(e,t,n){if(0!==(6&pl))throw Error(a(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ie(e,t),i=r?function(e,t){var n=pl;pl|=2;var r=id(),i=od();ml!==e||gl!==t?(Ll=null,xl=ce()+500,td(e,t)):El=Ie(e,t);e:for(;;)try{if(0!==_l&&null!==fl){t=fl;var o=vl;t:switch(_l){case 1:_l=0,vl=null,hd(e,t,o,1);break;case 2:case 9:if(to(o)){_l=0,vl=null,ud(t);break}t=function(){2!==_l&&9!==_l||ml!==e||(_l=7),Ld(e)},o.then(t,t);break e;case 3:_l=7;break e;case 4:_l=5;break e;case 7:to(o)?(_l=0,vl=null,ud(t)):(_l=0,vl=null,hd(e,t,o,7));break;case 5:var s=null;switch(fl.tag){case 26:s=fl.memoizedState;case 5:case 27:var c=fl;if(s?ih(s):c.stateNode.complete){_l=0,vl=null;var l=c.sibling;if(null!==l)fl=l;else{var d=c.return;null!==d?(fl=d,pd(d)):fl=null}break t}}_l=0,vl=null,hd(e,t,o,5);break;case 6:_l=0,vl=null,hd(e,t,o,6);break;case 8:ed(),Tl=6;break e;default:throw Error(a(462))}}ld();break}catch(u){nd(e,u)}return Ci=Ti=null,x.H=r,x.A=i,pl=n,null!==fl?0:(ml=null,gl=0,Or(),Tl)}(e,t):sd(e,t,!0),o=r;;){if(0===i){El&&!r&&Ql(e,t,0,!1);break}if(n=e.current.alternate,!o||Zl(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var c=e;i=Nl;var l=c.current.memoizedState.isDehydrated;if(l&&(td(c,s).flags|=256),2!==(s=sd(c,s,!1))){if(yl&&!l){c.errorRecoveryDisabledLanes|=o,wl|=o,i=4;break e}o=Ol,Ol=i,null!==o&&(null===Ol?Ol=o:Ol.push.apply(Ol,o))}i=s}if(o=!1,2!==i)continue}}if(1===i){td(e,0),Ql(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Ql(r,t,Al,!bl);break e;case 2:Ol=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(i=kl+300-ce())){if(Ql(r,t,Al,!bl),0!==Ae(r,0,!0))break e;Vl=t,r.timeoutHandle=yu(Jl.bind(null,r,n,Ol,Ll,Pl,t,Al,wl,Il,bl,o,"Throttled",-0,0),i)}else Jl(r,n,Ol,Ll,Pl,t,Al,wl,Il,bl,o,null,-0,0)}break}i=sd(e,t,!1),o=!1}Ld(e)}function Jl(e,t,n,r,i,o,a,s,c,l,d,u,h,p){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||16785408===(16785408&u)){ol(t,o,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:kt});var m=(62914560&o)===o?kl-ce():(4194048&o)===o?Dl-ce():0;if(null!==(m=function(e,t){return e.stylesheets&&0===e.count&&ch(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&ch(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===oh&&(oh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var i=n[r],o=i.transferSize,a=i.initiatorType,s=i.duration;if(o&&s&&pu(a)){for(a=0,s=i.responseEnd,r+=1;r<n.length;r++){var c=n[r],l=c.startTime;if(l>s)break;var d=c.transferSize,u=c.initiatorType;d&&pu(u)&&(a+=d*((c=c.responseEnd)<s?1:(s-l)/(c-l)))}if(--r,t+=8*(o+a)/(i.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var i=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&ch(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>oh?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}(u,m)))return Vl=o,e.cancelPendingCommit=m(fd.bind(null,e,t,o,n,r,i,a,s,c,d,u,null,h,p)),void Ql(e,o,a,!l)}fd(e,t,o,n,r,i,a,s,c)}function Zl(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Qn(o(),i))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ql(e,t,n,r){t&=~Rl,t&=~wl,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-Ee(i),a=1<<o;r[o]=-1,i&=~a}0!==n&&De(e,n,t)}function $l(){return 0!==(6&pl)||(Md(0,!1),!1)}function ed(){if(null!==fl){if(0===_l)var e=fl.return;else Ci=Ti=null,sa(e=fl),so=null,co=0,e=fl;for(;null!==e;)fc(e.alternate,e),e=e.return;fl=null}}function td(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Su(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Vl=0,ed(),ml=e,fl=n=Vr(e.current,null),gl=t,_l=0,vl=null,bl=!1,El=Ie(e,t),yl=!1,Il=Al=Rl=wl=Cl=Tl=0,Ol=Nl=null,Pl=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-Ee(r),o=1<<i;t|=e[i],r&=~o}return Sl=t,Or(),n}function nd(e,t){Ho=null,x.H=fs,t===Zi||t===$i?(t=oo(),_l=3):t===Qi?(t=oo(),_l=4):_l=t===ks?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,vl=t,null===fl&&(Tl=1,As(e,qr(t,e.current)))}function rd(){var e=Do.current;return null===e||((4194048&gl)===gl?null===xo:((62914560&gl)===gl||0!==(536870912&gl))&&e===xo)}function id(){var e=x.H;return x.H=fs,null===e?fs:e}function od(){var e=x.A;return x.A=ul,e}function ad(){Tl=4,bl||(4194048&gl)!==gl&&null!==Do.current||(El=!0),0===(134217727&Cl)&&0===(134217727&wl)||null===ml||Ql(ml,gl,Al,!1)}function sd(e,t,n){var r=pl;pl|=2;var i=id(),o=od();ml===e&&gl===t||(Ll=null,td(e,t)),t=!1;var a=Tl;e:for(;;)try{if(0!==_l&&null!==fl){var s=fl,c=vl;switch(_l){case 8:ed(),a=6;break e;case 3:case 2:case 9:case 6:null===Do.current&&(t=!0);var l=_l;if(_l=0,vl=null,hd(e,s,c,l),n&&El){a=0;break e}break;default:l=_l,_l=0,vl=null,hd(e,s,c,l)}}cd(),a=Tl;break}catch(d){nd(e,d)}return t&&e.shellSuspendCounter++,Ci=Ti=null,pl=r,x.H=i,x.A=o,null===fl&&(ml=null,gl=0,Or()),a}function cd(){for(;null!==fl;)dd(fl)}function ld(){for(;null!==fl&&!ae();)dd(fl)}function dd(e){var t=ac(e.alternate,e,Sl);e.memoizedProps=e.pendingProps,null===t?pd(e):fl=t}function ud(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=zs(n,t,t.pendingProps,t.type,void 0,gl);break;case 11:t=zs(n,t,t.pendingProps,t.type.render,t.ref,gl);break;case 5:sa(t);default:fc(n,t),t=ac(n,t=fl=Br(t,Sl),Sl)}e.memoizedProps=e.pendingProps,null===t?pd(e):fl=t}function hd(e,t,n,r){Ci=Ti=null,sa(t),so=null,co=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ni(t,n,i,!0),null!==(n=Do.current)){switch(n.tag){case 31:case 13:return null===xo?ad():null===n.alternate&&0===Tl&&(Tl=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===eo?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Cd(e,r,i)),!1;case 22:return n.flags|=65536,r===eo?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Cd(e,r,i)),!1}throw Error(a(435,n.tag))}return Cd(e,r,i),ad(),!1}if(ui)return null!==(t=Do.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==mi&&yi(qr(e=Error(a(422),{cause:r}),n))):(r!==mi&&yi(qr(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=qr(r,n),So(e,i=Ns(e.stateNode,r,i)),4!==Tl&&(Tl=2)),!1;var o=Error(a(520),{cause:r});if(o=qr(o,n),null===Nl?Nl=[o]:Nl.push(o),4!==Tl&&(Tl=2),null===t)return!0;r=qr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,So(n,e=Ns(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===Ml||!Ml.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Ps(i=Os(i),e,n,r),So(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,gl))return Tl=1,As(e,qr(n,e.current)),void(fl=null)}catch(o){if(null!==i)throw fl=i,o;return Tl=1,As(e,qr(n,e.current)),void(fl=null)}32768&t.flags?(ui||1===r?e=!0:El||0!==(536870912&gl)?e=!1:(bl=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Do.current)&&13===r.tag&&(r.flags|=16384))),md(t,e)):pd(t)}function pd(e){var t=e;do{if(0!==(32768&t.flags))return void md(t,bl);e=t.return;var n=pc(t.alternate,t,Sl);if(null!==n)return void(fl=n);if(null!==(t=t.sibling))return void(fl=t);fl=t=e}while(null!==t);0===Tl&&(Tl=5)}function md(e,t){do{var n=mc(e.alternate,e);if(null!==n)return n.flags&=32767,void(fl=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(fl=e);fl=e=n}while(null!==e);Tl=6,fl=null}function fd(e,t,n,r,i,o,s,c,l){e.cancelPendingCommit=null;do{Ed()}while(0!==Ul);if(0!==(6&pl))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,i,o){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=a&~n;0<n;){var d=31-Ee(n),u=1<<d;s[d]=0,c[d]=-1;var h=l[d];if(null!==h)for(l[d]=null,d=0;d<h.length;d++){var p=h[d];null!==p&&(p.lane&=-536870913)}n&=~u}0!==r&&De(e,r,0),0!==o&&0===i&&0!==e.tag&&(e.suspendedLanes|=o&~(a&~t))}(e,n,o|=Nr,s,c,l),e===ml&&(fl=ml=null,gl=0),jl=t,Fl=e,Vl=n,Bl=o,Wl=i,Hl=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ie(he,function(){return yd(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=x.T,x.T=null,i=L.p,L.p=2,s=pl,pl|=4;try{!function(e,t){if(e=e.containerInfo,mu=bh,ir(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(g){n=null;break e}var s=0,c=-1,l=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==i&&3!==h.nodeType||(c=s+i),h!==o||0!==r&&3!==h.nodeType||(l=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===i&&(c=s),p===o&&++u===r&&(l=s),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(fu={focusedElem:e,selectionRange:n},bh=!1,Dc=t;null!==Dc;)if(e=(t=Dc).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Dc=e;else for(;null!==Dc;){switch(o=(t=Dc).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var f=Ts(n.type,i);e=r.getSnapshotBeforeUpdate(f,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(_){Td(n,n.return,_)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Nu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Nu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Dc=e;break}Dc=t.return}}(e,t)}finally{pl=s,L.p=i,x.T=r}}Ul=1,gd(),_d(),vd()}}function gd(){if(1===Ul){Ul=0;var e=Fl,t=jl,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=x.T,x.T=null;var r=L.p;L.p=2;var i=pl;pl|=4;try{zc(t,e);var o=fu,a=rr(e.containerInfo),s=o.focusedElem,c=o.selectionRange;if(a!==s&&s&&s.ownerDocument&&nr(s.ownerDocument.documentElement,s)){if(null!==c&&ir(s)){var l=c.start,d=c.end;if(void 0===d&&(d=l),"selectionStart"in s)s.selectionStart=l,s.selectionEnd=Math.min(d,s.value.length);else{var u=s.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var p=h.getSelection(),m=s.textContent.length,f=Math.min(c.start,m),g=void 0===c.end?f:Math.min(c.end,m);!p.extend&&f>g&&(a=g,g=f,f=a);var _=tr(s,f),v=tr(s,g);if(_&&v&&(1!==p.rangeCount||p.anchorNode!==_.node||p.anchorOffset!==_.offset||p.focusNode!==v.node||p.focusOffset!==v.offset)){var b=u.createRange();b.setStart(_.node,_.offset),p.removeAllRanges(),f>g?(p.addRange(b),p.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),p.addRange(b))}}}}for(u=[],p=s;p=p.parentNode;)1===p.nodeType&&u.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<u.length;s++){var E=u[s];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}bh=!!mu,fu=mu=null}finally{pl=i,L.p=r,x.T=n}}e.current=t,Ul=2}}function _d(){if(2===Ul){Ul=0;var e=Fl,t=jl,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=x.T,x.T=null;var r=L.p;L.p=2;var i=pl;pl|=4;try{xc(e,t.alternate,t)}finally{pl=i,L.p=r,x.T=n}}Ul=3}}function vd(){if(4===Ul||3===Ul){Ul=0,se();var e=Fl,t=jl,n=Vl,r=Hl;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ul=5:(Ul=0,jl=Fl=null,bd(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Ml=null),Ue(n),t=t.stateNode,ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(_e,t,void 0,128===(128&t.current.flags))}catch(c){}if(null!==r){t=x.T,i=L.p,L.p=2,x.T=null;try{for(var o=e.onRecoverableError,a=0;a<r.length;a++){var s=r[a];o(s.value,{componentStack:s.stack})}}finally{x.T=t,L.p=i}}0!==(3&Vl)&&Ed(),Ld(e),i=e.pendingLanes,0!==(261930&n)&&0!==(42&i)?e===zl?Gl++:(Gl=0,zl=e):Gl=0,Md(0,!1)}}function bd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Vi(t)))}function Ed(){return gd(),_d(),vd(),yd()}function yd(){if(5!==Ul)return!1;var e=Fl,t=Bl;Bl=0;var n=Ue(Vl),r=x.T,i=L.p;try{L.p=32>n?32:n,x.T=null,n=Wl,Wl=null;var o=Fl,s=Vl;if(Ul=0,jl=Fl=null,Vl=0,0!==(6&pl))throw Error(a(331));var c=pl;if(pl|=4,cl(o.current),el(o,o.current,s,n),pl=c,Md(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(_e,o)}catch(l){}return!0}finally{L.p=i,x.T=r,bd(e,t)}}function Sd(e,t,n){t=qr(n,t),null!==(e=Eo(e,t=Ns(e.stateNode,t,2),2))&&(ke(e,2),Ld(e))}function Td(e,t,n){if(3===e.tag)Sd(e,e,n);else for(;null!==t;){if(3===t.tag){Sd(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ml||!Ml.has(r))){e=qr(n,e),null!==(r=Eo(t,n=Os(2),2))&&(Ps(n,r,t,e),ke(r,2),Ld(r));break}}t=t.return}}function Cd(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hl;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(yl=!0,i.add(n),e=wd.bind(null,e,t,n),t.then(e,e))}function wd(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ml===e&&(gl&n)===n&&(4===Tl||3===Tl&&(62914560&gl)===gl&&300>ce()-kl?0===(2&pl)&&td(e,0):Rl|=n,Il===gl&&(Il=0)),Ld(e)}function Rd(e,t){0===t&&(t=Oe()),null!==(e=Dr(e,t))&&(ke(e,t),Ld(e))}function Ad(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Rd(e,n)}function Id(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Rd(e,n)}var Nd=null,Od=null,Pd=!1,kd=!1,Dd=!1,xd=0;function Ld(e){e!==Od&&null===e.next&&(null===Od?Nd=Od=e:Od=Od.next=e),kd=!0,Pd||(Pd=!0,Cu(function(){0!==(6&pl)?ie(de,Ud):Fd()}))}function Md(e,t){if(!Dd&&kd){Dd=!0;do{for(var n=!1,r=Nd;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var o=0;else{var a=r.suspendedLanes,s=r.pingedLanes;o=(1<<31-Ee(42|e)+1)-1,o=201326741&(o&=i&~(a&~s))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Bd(r,o))}else o=gl,0===(3&(o=Ae(r,r===ml?o:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ie(r,o)||(n=!0,Bd(r,o));r=r.next}}while(n);Dd=!1}}function Ud(){Fd()}function Fd(){kd=Pd=!1;var e=0;0!==xd&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Eu&&(Eu=e,!0);return Eu=null,!1}()&&(e=xd);for(var t=ce(),n=null,r=Nd;null!==r;){var i=r.next,o=jd(r,t);0===o?(r.next=null,null===n?Nd=i:n.next=i,null===i&&(Od=n)):(n=r,(0!==e||0!==(3&o))&&(kd=!0)),r=i}0!==Ul&&5!==Ul||Md(e,!1),0!==xd&&(xd=0)}function jd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var a=31-Ee(o),s=1<<a,c=i[a];-1===c?0!==(s&n)&&0===(s&r)||(i[a]=Ne(s,t)):c<=t&&(e.expiredLanes|=s),o&=~s}if(n=gl,n=Ae(e,e===(t=ml)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===_l||9===_l)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&oe(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ie(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&oe(r),Ue(n)){case 2:case 8:n=ue;break;case 32:default:n=he;break;case 268435456:n=me}return r=Vd.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&oe(r),e.callbackPriority=2,e.callbackNode=null,2}function Vd(e,t){if(0!==Ul&&5!==Ul)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Ed()&&e.callbackNode!==n)return null;var r=gl;return 0===(r=Ae(e,e===ml?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Xl(e,r,t),jd(e,ce()),null!=e.callbackNode&&e.callbackNode===n?Vd.bind(null,e):null)}function Bd(e,t){if(Ed())return null;Xl(e,t,!0)}function Wd(){if(0===xd){var e=Hi;0===e&&(e=Te,0===(261888&(Te<<=1))&&(Te=256)),xd=e}return xd}function Hd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Gd(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var zd=0;zd<Cr.length;zd++){var Kd=Cr[zd];wr(Kd.toLowerCase(),"on"+(Kd[0].toUpperCase()+Kd.slice(1)))}wr(gr,"onAnimationEnd"),wr(_r,"onAnimationIteration"),wr(vr,"onAnimationStart"),wr("dblclick","onDoubleClick"),wr("focusin","onFocus"),wr("focusout","onBlur"),wr(br,"onTransitionRun"),wr(Er,"onTransitionStart"),wr(yr,"onTransitionCancel"),wr(Sr,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yd));function Xd(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==o&&i.isPropagationStopped())break e;o=s,i.currentTarget=l;try{o(i)}catch(d){Rr(d)}i.currentTarget=null,o=c}else for(a=0;a<r.length;a++){if(c=(s=r[a]).instance,l=s.currentTarget,s=s.listener,c!==o&&i.isPropagationStopped())break e;o=s,i.currentTarget=l;try{o(i)}catch(d){Rr(d)}i.currentTarget=null,o=c}}}}function Jd(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var r=e+"__bubble";n.has(r)||(eu(t,e,2,!1),n.add(r))}function Zd(e,t,n){var r=0;t&&(r|=4),eu(n,e,r,t)}var Qd="_reactListening"+Math.random().toString(36).slice(2);function $d(e){if(!e[Qd]){e[Qd]=!0,tt.forEach(function(t){"selectionchange"!==t&&(qd.has(t)||Zd(t,!1,e),Zd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qd]||(t[Qd]=!0,Zd("selectionchange",!1,t))}}function eu(e,t,n,r){switch(Rh(t)){case 2:var i=Eh;break;case 8:i=yh;break;default:i=Sh}n=i.bind(null,t,n,e),i=void 0,!Wt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function tu(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&a.stateNode.containerInfo===i)return;a=a.return}for(;null!==s;){if(null===(a=Je(s)))return;if(5===(l=a.tag)||6===l||26===l||27===l){r=o=a;continue e}s=s.parentNode}}r=r.return}jt(function(){var r=o,i=xt(n),a=[];e:{var s=Tr.get(e);if(void 0!==s){var l=nn,d=e;switch(e){case"keypress":if(0===qt(n))break e;case"keydown":case"keyup":l=vn;break;case"focusin":d="focus",l=ln;break;case"focusout":d="blur",l=ln;break;case"beforeblur":case"afterblur":l=ln;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=cn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=En;break;case gr:case _r:case vr:l=dn;break;case Sr:l=yn;break;case"scroll":case"scrollend":l=on;break;case"wheel":l=Sn;break;case"copy":case"cut":case"paste":l=un;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=bn;break;case"toggle":case"beforetoggle":l=Tn}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),p=u?null!==s?s+"Capture":null:s;u=[];for(var m,f=r;null!==f;){var g=f;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===p||null!=(g=Vt(f,p))&&u.push(nu(f,g,m)),h)break;f=f.return}0<u.length&&(s=new l(s,d,null,n,i),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Dt||!(d=n.relatedTarget||n.fromElement)||!Je(d)&&!d[He])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(d=(d=n.relatedTarget||n.toElement)?Je(d):null)&&(h=c(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(l=null,d=r),l!==d)){if(u=sn,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=bn,g="onPointerLeave",p="onPointerEnter",f="pointer"),h=null==l?s:Qe(l),m=null==d?s:Qe(d),(s=new u(g,f+"leave",l,n,i)).target=h,s.relatedTarget=m,g=null,Je(i)===r&&((u=new u(p,f+"enter",d,n,i)).target=m,u.relatedTarget=h,g=u),h=g,l&&d)e:{for(u=iu,f=d,m=0,g=p=l;g;g=u(g))m++;g=0;for(var _=f;_;_=u(_))g++;for(;0<m-g;)p=u(p),m--;for(;0<g-m;)f=u(f),g--;for(;m--;){if(p===f||null!==f&&p===f.alternate){u=p;break e}p=u(p),f=u(f)}u=null}else u=null;null!==l&&ou(a,s,l,u,!1),null!==d&&null!==h&&ou(a,h,d,u,!0)}if("select"===(l=(s=r?Qe(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var v=Bn;else if(Ln(s))if(Wn)v=Zn;else{v=Xn;var b=qn}else!(l=s.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&It(r.elementType)&&(v=Bn):v=Jn;switch(v&&(v=v(e,r))?Mn(a,v,n,i):(b&&b(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&Et(s,"number",s.value)),b=r?Qe(r):window,e){case"focusin":(Ln(b)||"true"===b.contentEditable)&&(ar=b,sr=r,cr=null);break;case"focusout":cr=sr=ar=null;break;case"mousedown":lr=!0;break;case"contextmenu":case"mouseup":case"dragend":lr=!1,dr(a,n,i);break;case"selectionchange":if(or)break;case"keydown":case"keyup":dr(a,n,i)}var E;if(wn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Dn?Pn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(In&&"ko"!==n.locale&&(Dn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Dn&&(E=Yt()):(zt="value"in(Gt=i)?Gt.value:Gt.textContent,Dn=!0)),0<(b=ru(r,y)).length&&(y=new hn(y,e,null,n,i),a.push({event:y,listeners:b}),E?y.data=E:null!==(E=kn(n))&&(y.data=E))),(E=An?function(e,t){switch(e){case"compositionend":return kn(t);case"keypress":return 32!==t.which?null:(On=!0,Nn);case"textInput":return(e=t.data)===Nn&&On?null:e;default:return null}}(e,n):function(e,t){if(Dn)return"compositionend"===e||!wn&&Pn(e,t)?(e=Yt(),Kt=zt=Gt=null,Dn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return In&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(y=ru(r,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,i),a.push({event:b,listeners:y}),b.data=E)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var o=Hd((i[We]||null).action),a=r.submitter;a&&null!==(t=(t=a[We]||null)?Hd(t.formAction):a.getAttribute("formAction"))&&(o=t,a=null);var s=new nn("action","action",null,r,i);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==xd){var e=a?Gd(i,a):new FormData(i);ts(n,{pending:!0,data:e,method:i.method,action:o},null,e)}}else"function"===typeof o&&(s.preventDefault(),e=a?Gd(i,a):new FormData(i),ts(n,{pending:!0,data:e,method:i.method,action:o},o,e))},currentTarget:i}]})}}(a,e,r,n,i)}Xd(a,t)})}function nu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ru(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===o||(null!=(i=Vt(e,n))&&r.unshift(nu(e,i,o)),null!=(i=Vt(e,t))&&r.push(nu(e,i,o))),3===e.tag)return r;e=e.return}return[]}function iu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function ou(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(s=s.tag,null!==c&&c===r)break;5!==s&&26!==s&&27!==s||null===l||(c=l,i?null!=(l=Vt(n,o))&&a.unshift(nu(n,l,c)):i||null!=(l=Vt(n,o))&&a.push(nu(n,l,c))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var au=/\r\n?/g,su=/\u0000|\uFFFD/g;function cu(e){return("string"===typeof e?e:""+e).replace(au,"\n").replace(su,"")}function lu(e,t){return t=cu(t),cu(e)===t}function du(e,t,n,r,i,o){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Ct(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Ct(e,""+r);break;case"className":lt(e,"class",r);break;case"tabIndex":lt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":lt(e,n,r);break;case"style":At(e,r,o);break;case"data":if("object"!==t){lt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&du(e,t,"name",i.name,i,null),du(e,t,"formEncType",i.formEncType,i,null),du(e,t,"formMethod",i.formMethod,i,null),du(e,t,"formTarget",i.formTarget,i,null)):(du(e,t,"encType",i.encType,i,null),du(e,t,"method",i.method,i,null),du(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=kt);break;case"onScroll":null!=r&&Jd("scroll",e);break;case"onScrollEnd":null!=r&&Jd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Pt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Jd("beforetoggle",e),Jd("toggle",e),ct(e,"popover",r);break;case"xlinkActuate":dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":dt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":dt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":dt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":dt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":ct(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ct(e,n=Nt.get(n)||n,r)}}function uu(e,t,n,r,i,o){switch(n){case"style":At(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Ct(e,r):("number"===typeof r||"bigint"===typeof r)&&Ct(e,""+r);break;case"onScroll":null!=r&&Jd("scroll",e);break;case"onScrollEnd":null!=r&&Jd("scrollend",e);break;case"onClick":null!=r&&(e.onclick=kt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(o=null!=(o=e[We]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):ct(e,n,r):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function hu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Jd("error",e),Jd("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:du(e,t,r,s,n,null)}}return o&&du(e,t,"srcSet",n.srcSet,n,null),void(i&&du(e,t,"src",n.src,n,null));case"input":Jd("invalid",e);var c=r=s=o=null,l=null,d=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(null!=u)switch(i){case"name":o=u;break;case"type":s=u;break;case"checked":l=u;break;case"defaultChecked":d=u;break;case"value":r=u;break;case"defaultValue":c=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(a(137,t));break;default:du(e,t,i,u,n,null)}}return void bt(e,r,c,l,d,s,o,!1);case"select":for(o in Jd("invalid",e),i=s=r=null,n)if(n.hasOwnProperty(o)&&null!=(c=n[o]))switch(o){case"value":r=c;break;case"defaultValue":s=c;break;case"multiple":i=c;default:du(e,t,o,c,n,null)}return t=r,n=s,e.multiple=!!i,void(null!=t?yt(e,!!i,t,!1):null!=n&&yt(e,!!i,n,!0));case"textarea":for(s in Jd("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(s)&&null!=(c=n[s]))switch(s){case"value":i=c;break;case"defaultValue":o=c;break;case"children":r=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(a(91));break;default:du(e,t,s,c,n,null)}return void Tt(e,i,o,r);case"option":for(l in n)if(n.hasOwnProperty(l)&&null!=(i=n[l]))if("selected"===l)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else du(e,t,l,i,n,null);return;case"dialog":Jd("beforetoggle",e),Jd("toggle",e),Jd("cancel",e),Jd("close",e);break;case"iframe":case"object":Jd("load",e);break;case"video":case"audio":for(i=0;i<Yd.length;i++)Jd(Yd[i],e);break;case"image":Jd("error",e),Jd("load",e);break;case"details":Jd("toggle",e);break;case"embed":case"source":case"link":Jd("error",e),Jd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(i=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:du(e,t,d,i,n,null)}return;default:if(It(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(i=n[u])&&uu(e,t,u,i,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(null!=(i=n[c])&&du(e,t,c,i,n,null))}function pu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var mu=null,fu=null;function gu(e){return 9===e.nodeType?e:e.ownerDocument}function _u(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Eu=null;var yu="function"===typeof setTimeout?setTimeout:void 0,Su="function"===typeof clearTimeout?clearTimeout:void 0,Tu="function"===typeof Promise?Promise:void 0,Cu="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Tu?function(e){return Tu.resolve(null).then(e).catch(wu)}:yu;function wu(e){setTimeout(function(){throw e})}function Ru(e){return"head"===e}function Au(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)||"/&"===n){if(0===r)return e.removeChild(i),void Gh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Fu(e.ownerDocument.documentElement);else if("head"===n){Fu(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var a=o.nextSibling,s=o.nodeName;o[qe]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=a}}else"body"===n&&Fu(e.ownerDocument.body);n=i}while(n);Gh(t)}function Iu(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Nu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Nu(n),Xe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Ou(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Du(e.nextSibling)))return null}return e}function Pu(e){return"$?"===e.data||"$~"===e.data}function ku(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Du(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var xu=null;function Lu(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Du(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Mu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Uu(e,t,n){switch(t=gu(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Fu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var ju=new Map,Vu=new Set;function Bu(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Wu=L.d;L.d={f:function(){var e=Wu.f(),t=$l();return e||t},r:function(e){var t=Ze(e);null!==t&&5===t.tag&&"form"===t.type?rs(t):Wu.r(e)},D:function(e){Wu.D(e),Gu("dns-prefetch",e,null)},C:function(e,t){Wu.C(e,t),Gu("preconnect",e,t)},L:function(e,t,n){Wu.L(e,t,n);var r=Hu;if(r&&e&&t){var i='link[rel="preload"][as="'+_t(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+_t(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+_t(n.imageSizes)+'"]')):i+='[href="'+_t(e)+'"]';var o=i;switch(t){case"style":o=Ku(e);break;case"script":o=Xu(e)}ju.has(o)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),ju.set(o,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Yu(o))||"script"===t&&r.querySelector(Ju(o))||(hu(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Wu.m(e,t);var n=Hu;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+_t(r)+'"][href="'+_t(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Xu(e)}if(!ju.has(o)&&(e=p({rel:"modulepreload",href:e},t),ju.set(o,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ju(o)))return}hu(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){Wu.X(e,t);var n=Hu;if(n&&e){var r=$e(n).hoistableScripts,i=Xu(e),o=r.get(i);o||((o=n.querySelector(Ju(i)))||(e=p({src:e,async:!0},t),(t=ju.get(i))&&eh(e,t),et(o=n.createElement("script")),hu(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}},S:function(e,t,n){Wu.S(e,t,n);var r=Hu;if(r&&e){var i=$e(r).hoistableStyles,o=Ku(e);t=t||"default";var a=i.get(o);if(!a){var s={loading:0,preload:null};if(a=r.querySelector(Yu(o)))s.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=ju.get(o))&&$u(e,n);var c=a=r.createElement("link");et(c),hu(c,"link",e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){s.loading|=1}),c.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Qu(a,t,r)}a={type:"stylesheet",instance:a,count:1,state:s},i.set(o,a)}}},M:function(e,t){Wu.M(e,t);var n=Hu;if(n&&e){var r=$e(n).hoistableScripts,i=Xu(e),o=r.get(i);o||((o=n.querySelector(Ju(i)))||(e=p({src:e,async:!0,type:"module"},t),(t=ju.get(i))&&eh(e,t),et(o=n.createElement("script")),hu(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}};var Hu="undefined"===typeof document?null:document;function Gu(e,t,n){var r=Hu;if(r&&"string"===typeof t&&t){var i=_t(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),Vu.has(i)||(Vu.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(hu(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function zu(e,t,n,r){var i,o,s,c,l=(l=K.current)?Bu(l):null;if(!l)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Ku(n.href),(r=(n=$e(l).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Ku(n.href);var d=$e(l).hoistableStyles,u=d.get(e);if(u||(l=l.ownerDocument||l,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=l.querySelector(Yu(e)))&&!d._p&&(u.instance=d,u.state.loading=5),ju.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},ju.set(e,n),d||(i=l,o=e,s=n,c=u.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=i.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),hu(o,"link",s),et(o),i.head.appendChild(o))))),t&&null===r)throw Error(a(528,""));return u}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Xu(n),(r=(n=$e(l).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Ku(e){return'href="'+_t(e)+'"'}function Yu(e){return'link[rel="stylesheet"]['+e+"]"}function qu(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Xu(e){return'[src="'+_t(e)+'"]'}function Ju(e){return"script[async]"+e}function Zu(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+_t(n.href)+'"]');if(r)return t.instance=r,et(r),r;var i=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),hu(r,"style",i),Qu(r,n.precedence,e),t.instance=r;case"stylesheet":i=Ku(n.href);var o=e.querySelector(Yu(i));if(o)return t.state.loading|=4,t.instance=o,et(o),o;r=qu(n),(i=ju.get(i))&&$u(r,i),et(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hu(o,"link",r),t.state.loading|=4,Qu(o,n.precedence,e),t.instance=o;case"script":return o=Xu(n.src),(i=e.querySelector(Ju(o)))?(t.instance=i,et(i),i):(r=n,(i=ju.get(o))&&eh(r=p({},n),i),et(i=(e=e.ownerDocument||e).createElement("script")),hu(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Qu(r,n.precedence,e));return t.instance}function Qu(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,a=0;a<r.length;a++){var s=r[a];if(s.dataset.precedence===t)o=s;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function $u(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var r=new Map,i=th=new Map;i.set(n,r)}else(r=(i=th).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[qe]||o[Be]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var a=o.getAttribute(t)||"";a=e+a;var s=r.get(a);s?s.push(o):r.set(a,[o])}}return r}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ih(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var oh=0;function ah(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)ch(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var sh=null;function ch(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,sh=new Map,t.forEach(lh,e),sh=null,ah.call(e))}function lh(e,t){if(!(4&t.state.loading)){var n=sh.get(e);if(n)var r=n.get(null);else{n=new Map,sh.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var a=i[o];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),r=a)}r&&n.set(null,r)}a=(i=t.instance).getAttribute("data-precedence"),(o=n.get(a)||r)===r&&n.set(null,i),n.set(a,i),this.count++,r=ah.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var dh={$$typeof:y,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function uh(e,t,n,r,i,o,a,s,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pe(0),this.hiddenUpdates=Pe(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function hh(e,t,n,r,i,o,a,s,c,l,d,u){return e=new uh(e,t,n,a,c,l,d,u,s),t=1,!0===o&&(t|=24),o=Fr(3,null,null,t),e.current=o,o.stateNode=e,(t=ji()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},_o(o),e}function ph(e){return e?e=Mr:Mr}function mh(e,t,n,r,i,o){i=ph(i),null===r.context?r.context=i:r.pendingContext=i,(r=bo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(n=Eo(e,r,t))&&(ql(n,0,t),yo(n,e,t))}function fh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gh(e,t){fh(e,t),(e=e.alternate)&&fh(e,t)}function _h(e){if(13===e.tag||31===e.tag){var t=Dr(e,67108864);null!==t&&ql(t,0,67108864),gh(e,67108864)}}function vh(e){if(13===e.tag||31===e.tag){var t=Kl(),n=Dr(e,t=Me(t));null!==n&&ql(n,0,t),gh(e,t)}}var bh=!0;function Eh(e,t,n,r){var i=x.T;x.T=null;var o=L.p;try{L.p=2,Sh(e,t,n,r)}finally{L.p=o,x.T=i}}function yh(e,t,n,r){var i=x.T;x.T=null;var o=L.p;try{L.p=8,Sh(e,t,n,r)}finally{L.p=o,x.T=i}}function Sh(e,t,n,r){if(bh){var i=Th(r);if(null===i)tu(e,t,r,Ch,n),Lh(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ih=Mh(Ih,e,t,n,r,i),!0;case"dragenter":return Nh=Mh(Nh,e,t,n,r,i),!0;case"mouseover":return Oh=Mh(Oh,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Ph.set(o,Mh(Ph.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,kh.set(o,Mh(kh.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lh(e,r),4&t&&-1<xh.indexOf(e)){for(;null!==i;){var o=Ze(i);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var a=Re(o.pendingLanes);if(0!==a){var s=o;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var c=1<<31-Ee(a);s.entanglements[1]|=c,a&=~c}Ld(o),0===(6&pl)&&(xl=ce()+500,Md(0,!1))}}break;case 31:case 13:null!==(s=Dr(o,2))&&ql(s,0,2),$l(),gh(o,2)}if(null===(o=Th(r))&&tu(e,t,r,Ch,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else tu(e,t,r,null,n)}}function Th(e){return wh(e=xt(e))}var Ch=null;function wh(e){if(Ch=null,null!==(e=Je(e))){var t=c(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=l(t)))return e;e=null}else if(31===n){if(null!==(e=d(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ch=e,null}function Rh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case de:return 2;case ue:return 8;case he:case pe:return 32;case me:return 268435456;default:return 32}default:return 32}}var Ah=!1,Ih=null,Nh=null,Oh=null,Ph=new Map,kh=new Map,Dh=[],xh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Lh(e,t){switch(e){case"focusin":case"focusout":Ih=null;break;case"dragenter":case"dragleave":Nh=null;break;case"mouseover":case"mouseout":Oh=null;break;case"pointerover":case"pointerout":Ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kh.delete(t.pointerId)}}function Mh(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Ze(t))&&_h(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Uh(e){var t=Je(e.target);if(null!==t){var n=c(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=l(n)))return e.blockedOn=t,void je(e.priority,function(){vh(n)})}else if(31===t){if(null!==(t=d(n)))return e.blockedOn=t,void je(e.priority,function(){vh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Th(e.nativeEvent);if(null!==n)return null!==(t=Ze(n))&&_h(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Dt=r,n.target.dispatchEvent(r),Dt=null,t.shift()}return!0}function jh(e,t,n){Fh(e)&&n.delete(t)}function Vh(){Ah=!1,null!==Ih&&Fh(Ih)&&(Ih=null),null!==Nh&&Fh(Nh)&&(Nh=null),null!==Oh&&Fh(Oh)&&(Oh=null),Ph.forEach(jh),kh.forEach(jh)}function Bh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ah||(Ah=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vh)))}var Wh=null;function Hh(e){Wh!==e&&(Wh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Wh===e&&(Wh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===wh(r||n))continue;break}var o=Ze(n);null!==o&&(e.splice(t,3),t-=3,ts(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Gh(e){function t(t){return Bh(t,e)}null!==Ih&&Bh(Ih,e),null!==Nh&&Bh(Nh,e),null!==Oh&&Bh(Oh,e),Ph.forEach(t),kh.forEach(t);for(var n=0;n<Dh.length;n++){var r=Dh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Dh.length&&null===(n=Dh[0]).blockedOn;)Uh(n),null===n.blockedOn&&Dh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],a=i[We]||null;if("function"===typeof o)a||Hh(n);else if(a){var s=null;if(o&&o.hasAttribute("formAction")){if(i=o,a=o[We]||null)s=a.formAction;else if(null!==wh(i))continue}else s=a.action;"function"===typeof s?n[r+1]=s:(n.splice(r,3),r-=3),Hh(n)}}}function zh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==i&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==i&&(i(),i=null)}}}function Kh(e){this._internalRoot=e}function Yh(e){this._internalRoot=e}Yh.prototype.render=Kh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));mh(t.current,Kl(),e,t,null,null)},Yh.prototype.unmount=Kh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),$l(),t[He]=null}},Yh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dh.length&&0!==t&&t<Dh[n].priority;n++);Dh.splice(n,0,e),0===n&&Uh(e)}};var qh=i.version;if("19.2.3"!==qh)throw Error(a(527,qh,"19.2.3"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=c(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return u(i),e;if(o===r)return u(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Xh={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:x,reconcilerVersion:"19.2.3"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{_e=Jh.inject(Xh),ve=Jh}catch(Qh){}}t.createRoot=function(e,t){if(!s(e))throw Error(a(299));var n=!1,r="",i=Cs,o=ws,c=Rs;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,r,null,i,o,c,zh),e[He]=t.current,$d(e),new Kh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(a(299));var r=!1,i="",o=Cs,c=ws,l=Rs,d=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(c=n.onCaughtError),void 0!==n.onRecoverableError&&(l=n.onRecoverableError),void 0!==n.formState&&(d=n.formState)),(t=hh(e,1,!0,t,0,r,i,d,o,c,l,zh)).context=ph(null),n=t.current,(i=bo(r=Me(r=Kl()))).callback=null,Eo(n,i,r),n=r,t.current.lanes=n,ke(t,n),Ld(t),e[He]=t.current,$d(e),new Yh(t)},t.version="19.2.3"},7053:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentType=t.Group=void 0;var r=n(6361);Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return r.Group}}),Object.defineProperty(t,"ComponentType",{enumerable:!0,get:function(){return r.ComponentType}})},7228:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShopifyPing=t.isShopifyPOS=t.isShopifyMobile=t.isShopifyEmbedded=t.isMobile=void 0;var r=n(3002);function i(){return"undefined"!==typeof navigator&&navigator.userAgent.indexOf("Shopify Mobile")>=0}function o(){return"undefined"!==typeof navigator&&navigator.userAgent.indexOf("Shopify POS")>=0}function a(){return"undefined"!==typeof navigator&&navigator.userAgent.indexOf("Shopify Ping")>=0}t.isMobile=function(){return i()||o()||a()},t.isShopifyEmbedded=function(){return r.isClient&&window.top!==window.self||r.isUnframed},t.isShopifyMobile=i,t.isShopifyPOS=o,t.isShopifyPing=a},7237:(e,t,n)=>{"use strict";e.exports=n(8365)},7454:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(4381),t)},7789:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,n){return e.concat(t).map(function(e){return r(e,n)})}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}(e))}function a(e,t){try{return t in e}catch(n){return!1}}function s(e,t,n){var i={};return n.isMergeableObject(e)&&o(e).forEach(function(t){i[t]=r(e[t],n)}),o(t).forEach(function(o){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(a(e,o)&&n.isMergeableObject(t[o])?i[o]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"===typeof n?n:c}(o,n)(e[o],t[o],n):i[o]=r(t[o],n))}),i}function c(e,n,o){(o=o||{}).arrayMerge=o.arrayMerge||i,o.isMergeableObject=o.isMergeableObject||t,o.cloneUnlessOtherwiseSpecified=r;var a=Array.isArray(n);return a===Array.isArray(e)?a?o.arrayMerge(e,n,o):s(e,n,o):r(n,o)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(e,n){return c(e,n,t)},{})};var l=c;e.exports=l},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(6672)},8154:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateActionFromPayload=t.isValidOptionalString=t.isValidOptionalNumber=t.forEachInEnum=t.getMergedProps=t.findMatchInEnum=t.getEventNameSpace=t.NonSnakeCaseGroup=t.actionWrapper=void 0;var i=r(n(3952)),o=n(4465),a=n(6361);function s(e,t){var n=(0,i.default)(e,t);return n||Object.assign(e,t)}t.actionWrapper=function(e){return e},t.NonSnakeCaseGroup=[a.Group.AuthCode,a.Group.Button,a.Group.ButtonGroup,a.Group.Cart,a.Group.Error,a.Group.Features,a.Group.Fullscreen,a.Group.Link,a.Group.Loading,a.Group.Menu,a.Group.Modal,a.Group.Navigation,a.Group.Pos,a.Group.Print,a.Group.ResourcePicker,a.Group.Scanner,a.Group.SessionToken,a.Group.Share,a.Group.TitleBar,a.Group.Toast,a.Group.unstable_Picker],t.getEventNameSpace=function(e,n,r){if(n.startsWith("".concat(o.PREFIX).concat(o.SEPARATOR)))return n;var i=function(e){return t.NonSnakeCaseGroup.includes(e)?e.toUpperCase():(n=e,n.replace(/([A-Z])/g,function(e,t,n){return"".concat(0===n?"":"_").concat(e[0].toLowerCase())})).toUpperCase();var n}(e);if(r){var a=r.subgroups,s=r.type;a&&a.length>0&&(i+=i.length>0?o.SEPARATOR:"",a.forEach(function(e,t){i+="".concat(e.toUpperCase()).concat(t<a.length-1?o.SEPARATOR:"")})),s!==e&&s&&(i+="".concat(i.length>0?o.SEPARATOR:"").concat(s.toUpperCase()))}return i&&(i+="".concat(i.length>0?o.SEPARATOR:"").concat(n.toUpperCase())),"".concat(o.PREFIX).concat(o.SEPARATOR).concat(i)},t.findMatchInEnum=function(e,t){var n=Object.keys(e).find(function(n){return t===e[n]});return n?e[n]:void 0},t.getMergedProps=s,t.forEachInEnum=function(e,t){Object.keys(e).forEach(function(n){t(e[n])})},t.isValidOptionalNumber=function(e){return null===e||void 0===e||"number"===typeof e},t.isValidOptionalString=function(e){return null===e||void 0===e||"string"===typeof e},t.updateActionFromPayload=function(e,t){return e.id===t.id&&(Object.assign(e,s(e,t)),!0)}},8162:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0,function(e){e.LARGEST_CONTENTFUL_PAINT="APP::WEB_VITALS::LARGEST_CONTENTFUL_PAINT",e.FIRST_INPUT_DELAY="APP::WEB_VITALS::FIRST_INPUT_DELAY",e.CUMULATIVE_LAYOUT_SHIFT="APP::WEB_VITALS::CUMULATIVE_LAYOUT_SHIFT",e.FIRST_CONTENTFUL_PAINT="APP::WEB_VITALS::FIRST_CONTENTFUL_PAINT",e.TIME_TO_FIRST_BYTE="APP::WEB_VITALS::TIME_TO_FIRST_BYTE",e.INTERACTION_TO_NEXT_PAINT="APP::WEB_VITALS::INTERACTION_TO_NEXT_PAINT"}(n||(t.Action=n={}))},8197:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.permissionAction=t.isErrorEventName=t.throwError=t.invalidOriginAction=t.fromAction=t.AppBridgeError=t.AppActionType=t.Action=void 0;var i,o,a=n(6361),s=n(8154);!function(e){e.INVALID_ACTION="APP::ERROR::INVALID_ACTION",e.INVALID_ACTION_TYPE="APP::ERROR::INVALID_ACTION_TYPE",e.INVALID_PAYLOAD="APP::ERROR::INVALID_PAYLOAD",e.INVALID_OPTIONS="APP::ERROR::INVALID_OPTIONS",e.UNEXPECTED_ACTION="APP::ERROR::UNEXPECTED_ACTION",e.PERSISTENCE="APP::ERROR::PERSISTENCE",e.UNSUPPORTED_OPERATION="APP::ERROR::UNSUPPORTED_OPERATION",e.NETWORK="APP::ERROR::NETWORK",e.PERMISSION="APP::ERROR::PERMISSION",e.FAILED_AUTHENTICATION="APP::ERROR::FAILED_AUTHENTICATION",e.INVALID_ORIGIN="APP::ERROR::INVALID_ORIGIN"}(i||(t.Action=i={})),function(e){e.INVALID_CONFIG="APP::ERROR::INVALID_CONFIG",e.MISSING_CONFIG="APP::APP_ERROR::MISSING_CONFIG",e.MISSING_APP_BRIDGE_MIDDLEWARE="APP::APP_ERROR::MISSING_APP_BRIDGE_MIDDLEWARE",e.WINDOW_UNDEFINED="APP::APP_ERROR::WINDOW_UNDEFINED",e.REDUX_REINSTANTIATED="APP::APP_ERROR::REDUX_REINSTANTIATED",e.MISSING_LOCAL_ORIGIN="APP::APP_ERROR::MISSING_LOCAL_ORIGIN",e.MISSING_HOST_PROVIDER="APP::APP_ERROR::MISSING_HOST_PROVIDER",e.MISSING_ROUTER_CONTEXT="APP::APP_ERROR::MISSING_ROUTER_CONTEXT",e.MISSING_HISTORY_BLOCK="APP::APP_ERROR::MISSING_HISTORY_BLOCK"}(o||(t.AppActionType=o={}));var c=function(e){function t(n){var r=e.call(this,n)||this;return r.name="AppBridgeError",r.message=n,Object.setPrototypeOf(r,t.prototype),"function"===typeof Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=new Error(r.message).stack,r}return r(t,e),t}(Error);function l(e,t,n){var r=e?"".concat(t,": ").concat(e):t,i=new c(r);return i.action=n,i.type=t,i}t.AppBridgeError=c,t.fromAction=l,t.invalidOriginAction=function(e){return(0,s.actionWrapper)({group:a.Group.Error,payload:{message:e,type:i.INVALID_ORIGIN},type:i.INVALID_ORIGIN})},t.throwError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r,i=e[0];throw"string"===typeof e[1]?n=e[1]:(r=e[1],n=e[2]||""),l(n,i,r)},t.isErrorEventName=function(e){return"string"===typeof(0,s.findMatchInEnum)(i,e)},t.permissionAction=function(e,t){return function(e,t,n){var r=t.payload;return(0,s.actionWrapper)({type:e,group:a.Group.Error,payload:{action:t,message:n,type:e,id:r&&r.id?r.id:void 0}})}(i.PERMISSION,e,t||"Action is not permitted")}},8365:(e,t,n)=>{"use strict";var r=n(5043);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useSyncExternalStore,a=r.useRef,s=r.useEffect,c=r.useMemo,l=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,d){var u=a(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=c(function(){function e(e){if(!s){if(s=!0,o=e,e=r(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return a=t}return a=e}if(t=a,i(o,e))return t;var n=r(e);return void 0!==d&&d(t,n)?(o=e,t):(o=e,a=n)}var o,a,s=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,d]);var p=o(e,u[0],u[1]);return s(function(){h.hasValue=!0,h.value=p},[p]),l(p),p}},8587:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}n.d(t,{A:()=>r})},8853:(e,t,n)=>{"use strict";e.exports=n(5896)},9329:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(4870);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.createApp}}),i(n(5918),t),i(n(4870),t)},9337:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeFromCollection=t.addAndRemoveFromCollection=void 0;var r=n(6221);Object.defineProperty(t,"addAndRemoveFromCollection",{enumerable:!0,get:function(){return r.addAndRemoveFromCollection}}),Object.defineProperty(t,"removeFromCollection",{enumerable:!0,get:function(){return r.removeFromCollection}})},9367:(e,t)=>{"use strict";var n,r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.LifecycleHook=t.PermissionType=t.MessageType=void 0,function(e){e.GetState="getState",e.Dispatch="dispatch",e.Subscribe="subscribe",e.Unsubscribe="unsubscribe"}(n||(t.MessageType=n={})),function(e){e.Dispatch="Dispatch",e.Subscribe="Subscribe"}(r||(t.PermissionType=r={})),function(e){e.UpdateAction="UpdateAction",e.DispatchAction="DispatchAction"}(i||(t.LifecycleHook=i={}))},9379:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(4705);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}},9416:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>y,K8:()=>b,WM:()=>E,getLocalVideoTrack:()=>h,getRemoteVideoTrack:()=>p,go:()=>_,t3:()=>m});var r=n(9379),i=n(830),o=n(1635),a=n.n(o);const s=a().createClient({mode:"rtc",codec:"vp8"});let c=null,l=null,d=null,u=null;const h=()=>l,p=()=>u,m=(0,i.zD)("call/startCall",async(e,t)=>{let{token:n,channel:r,uid:i,appId:o,callType:h="voice"}=e,{rejectWithValue:p}=t;try{const e="string"===typeof i?parseInt(i):i,t=o||"656422a01e774a4ba5b2dc0ac12e5fe5";if(console.log("Starting ".concat(h," call:"),{channel:r,uid:e,appId:t,tokenLength:null===n||void 0===n?void 0:n.length,callType:h}),!t)throw new Error("Agora App ID is required");if(!n)throw new Error("Token is required");if(!r)throw new Error("Channel name is required");if("DISCONNECTED"!==s.connectionState&&"DISCONNECTING"!==s.connectionState){console.log("Leaving existing connection...");try{await s.leave()}catch(_){console.warn("Error leaving previous connection:",_)}}console.log("Joining channel...",{appId:t,channel:r,uid:e,tokenPreview:(null===n||void 0===n?void 0:n.substring(0,20))+"..."});try{await s.join(t,r,n,e),console.log("Joined channel successfully. Connection state:",s.connectionState),console.log("Local UID after join:",s.uid)}catch(v){throw console.error("Failed to join channel:",v),new Error("Failed to join channel: ".concat(v.message))}if("video"===h){console.log("Creating video tracks...");try{var m,f;[c,l]=await a().createMicrophoneAndCameraTracks(),console.log("Video tracks created successfully"),c&&c.setEnabled(!0),l&&l.setEnabled(!0),console.log("Publishing video tracks..."),await s.publish([c,l]),console.log("Published local audio and video tracks successfully"),console.log("Published tracks status:",{audio:(null===(m=c)||void 0===m?void 0:m.isPlaying)||!1,video:(null===(f=l)||void 0===f?void 0:f.isPlaying)||!1});const e=()=>{const e=document.querySelector("[data-local-video]");e&&l&&l.play(e).then(()=>{console.log("Local video playing on element successfully")}).catch(e=>{console.error("Error playing local video:",e)})};setTimeout(e,100),setTimeout(e,500),setTimeout(e,1e3),window.dispatchEvent(new Event("local-video-ready"))}catch(b){throw console.error("Error creating/publishing video tracks:",b),new Error("Failed to create video tracks: ".concat(b.message))}}else{console.log("Creating audio track...");try{var g;c=await a().createMicrophoneAudioTrack(),console.log("Audio track created successfully"),c&&c.setEnabled(!0),console.log("Publishing audio track..."),await s.publish([c]),console.log("Published local audio track successfully"),console.log("Audio track status:",(null===(g=c)||void 0===g?void 0:g.isPlaying)||!1)}catch(b){throw console.error("Error creating/publishing audio track:",b),new Error("Failed to create audio track: ".concat(b.message))}}const p=s.localTracks;console.log("Local tracks published:",p.length),c&&(c.setEnabled(!0),console.log("Local audio track enabled:",c.isPlaying)),l&&(l.setEnabled(!0),console.log("Local video track enabled:",l.isPlaying)),console.log("Final connection state:",s.connectionState),console.log("Channel name:",r),console.log("Local UID:",s.uid);const E=async(e,t)=>{console.log("Remote user published ".concat(t,". User UID:"),e.uid);try{if("audio"===t)d=await s.subscribe(e,t),await d.play(),console.log("Playing remote audio successfully");else if("video"===t){u=await s.subscribe(e,t),console.log("Remote video track subscribed successfully");const n=()=>{const e=document.querySelector("[data-remote-video]");e&&u&&u.play(e).then(()=>{console.log("Playing remote video on element successfully")}).catch(e=>{console.error("Error playing remote video:",e)})};setTimeout(n,100),setTimeout(n,500),setTimeout(n,1e3),window.dispatchEvent(new Event("remote-video-ready"))}}catch(n){console.error("Error handling remote ".concat(t,":"),n)}};s.on("user-joined",e=>{console.log("User joined channel. UID:",e.uid)}),s.on("connection-state-change",(e,t)=>{console.log("Connection state changed:",{from:t,to:e})});const y=async(e,t)=>{var n;if("audio"===t)console.log("Remote user unpublished audio"),null===(n=d)||void 0===n||n.stop(),d=null;else if("video"===t){var r;console.log("Remote user unpublished video"),null===(r=u)||void 0===r||r.stop(),u=null}};return s.off("user-published",E),s.off("user-unpublished",y),s.on("user-published",E),s.on("user-unpublished",y),console.log("".concat(h," call setup complete")),{channel:r,type:h}}catch(E){return console.error("START ".concat(h.toUpperCase()," CALL FAILED:"),E),p(E.message)}}),f=(0,i.zD)("call/startVoice",async(e,t)=>{let{dispatch:n}=t;return n(m((0,r.A)((0,r.A)({},e),{},{callType:"voice"}))).unwrap()}),g=(0,i.zD)("call/startVideo",async(e,t)=>{let{dispatch:n}=t;return n(m((0,r.A)((0,r.A)({},e),{},{callType:"video"}))).unwrap()}),_=(0,i.zD)("call/end",async()=>{var e,t,n,r,i,o;null===(e=d)||void 0===e||e.stop(),d=null,null===(t=u)||void 0===t||t.stop(),u=null,null===(n=c)||void 0===n||n.stop(),null===(r=c)||void 0===r||r.close(),c=null,null===(i=l)||void 0===i||i.stop(),null===(o=l)||void 0===o||o.close(),l=null,await s.leave(),console.log("Call ended and cleaned up")}),v=(0,i.Z0)({name:"call",initialState:{inCall:!1,channel:null,type:null,muted:!1,videoEnabled:!0},reducers:{toggleMute:e=>{var t;e.muted=!e.muted,null===(t=c)||void 0===t||t.setEnabled(!e.muted)},toggleVideo:e=>{var t;e.videoEnabled=!e.videoEnabled,null===(t=l)||void 0===t||t.setEnabled(e.videoEnabled)}},extraReducers:e=>{e.addCase(m.pending,e=>{console.log("Call pending...")}).addCase(m.fulfilled,(e,t)=>{console.log("Call fulfilled:",t.payload),e.inCall=!0,e.channel=t.payload.channel,e.type=t.payload.type,e.videoEnabled="video"===t.payload.type}).addCase(m.rejected,(e,t)=>{console.error("Call rejected:",t.payload),e.inCall=!1,e.channel=null,e.type=null}).addCase(f.fulfilled,(e,t)=>{e.inCall=!0,e.channel=t.payload.channel,e.type="voice"}).addCase(g.fulfilled,(e,t)=>{e.inCall=!0,e.channel=t.payload.channel,e.type="video",e.videoEnabled=!0}).addCase(_.fulfilled,e=>{e.inCall=!1,e.channel=null,e.type=null,e.muted=!1,e.videoEnabled=!0})}}),{toggleMute:b,toggleVideo:E}=v.actions,y=v.reducer},9503:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createApp=t.createAppWrapper=t.createClientApp=t.WINDOW_UNDEFINED_MESSAGE=void 0;var a=n(894),s=n(992),c=n(713),l=n(5918),d=n(3096),u=n(3002),h=n(218),p=n(7454),m=n(9545),f=n(2172),g=n(3323),_=o(n(3938));t.WINDOW_UNDEFINED_MESSAGE="window is not defined. Running an app outside a browser is not supported";var v=function(e){return function(t){return e(r(r({},t),{version:(0,a.getVersion)(),clientInterface:{name:(0,a.getPackageName)(),version:(0,a.getVersion)()}}))}},b=function(e){e.set(g.LifecycleHook.DispatchAction,v)};function E(e,n,r){if(void 0===r&&(r=[]),!e)throw(0,c.fromAction)(t.WINDOW_UNDEFINED_MESSAGE,c.AppActionType.WINDOW_UNDEFINED);var o=(0,f.getLocation)(),a=n||o&&o.origin;if(!a)throw(0,c.fromAction)("local origin cannot be blank",c.AppActionType.MISSING_LOCAL_ORIGIN);var s=(0,l.fromWindow)(e,a);return(0,t.createClientApp)(s,i([b],r,!0))}function y(e){var t=(0,f.getWindow)();return t&&t.top?E(t.top)(e):d.serverAppBridge}t.createClientApp=function(e,t){void 0===t&&(t=[]);var n=[],o=(0,l.createTransportListener)();return e.subscribe(function(e){var t=e.data,r=t.type,i=t.payload;switch(r){case"getState":n.splice(0).forEach(function(e){return e(i)});break;case"dispatch":if(o.handleMessage(i),o.handleActionDispatch(i))return;var s=(0,a.findMatchInEnum)(c.Action,i.type);s&&(0,c.throwError)(s,i)}}),function(l){var v=function(e){var t;if(!e.host)throw(0,c.fromAction)("host must be provided",c.AppActionType.INVALID_CONFIG);if(!e.apiKey)throw(0,c.fromAction)("apiKey must be provided",c.AppActionType.INVALID_CONFIG);try{var n=atob(null===(t=e.host)||void 0===t?void 0:t.replace(/_/g,"/").replace(/-/g,"+"));return r(r({},e),{host:n})}catch(o){var i="not a valid host, please use the value provided by Shopify";throw(0,c.fromAction)(i,c.AppActionType.INVALID_CONFIG)}}(l),b=function(e,t){var n=t.apiKey,r=t.host,i=t.forceRedirect,o=void 0===i?!u.isDevelopmentClient:i,a=(0,f.getLocation)();if(u.isUnframed||!a||!n||!r||!o||!(0,f.shouldRedirect)(e))return!1;var s="https://".concat(r,"/apps/").concat(n).concat(a.pathname).concat(a.search||"");return(0,f.redirect)(s),!0}(e.hostFrame,v);if(b)return d.mockAppBridge;var E=function(e,t){return function(n,r){e.dispatch({payload:r,source:t,type:n})}}(e,v),y=o.createSubscribeHandler(E);function S(e){return E(g.MessageType.Dispatch,e),e}E(g.MessageType.Unsubscribe);for(var T=new URL("https://".concat(v.host)).origin,C=new _.default,w={hostOrigin:T,localOrigin:e.localOrigin,hooks:C,dispatch:function(e){return w.hooks?w.hooks.run(g.LifecycleHook.DispatchAction,S,w,e):S(e)},featuresAvailable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=Array.isArray(n)?i([],n,!0):e;return w.getState("features").then(function(e){return r.length?r.reduce(function(t,n){return Object.keys(e).includes(n)&&(t[n]=e[n]),t},{}):e})},getState:function(e){return e&&"string"!==typeof e?Promise.resolve(void 0):new Promise(function(e){n.push(e),E(g.MessageType.GetState)}).then(function(t){var n=t;if(e)for(var r=0,i=e.split(".");r<i.length;r++){var o=i[r];if(null==n||"object"!==typeof n||Array.isArray(n)||!Object.keys(n).includes(o))return;n=n[o]}return n})},subscribe:y,error:function(e,t){var n=[];return(0,a.forEachInEnum)(c.Action,function(r){n.push(y(r,e,t))}),function(){n.forEach(function(e){return e()})}}},R=0,A=t;R<A.length;R++){(0,A[R])(C,w)}return function(e){e.subscribe(s.Action.APP,m.handleAppPrint),e.dispatch((0,h.initialize)());try{(0,p.initializeWebVitals)(e)}catch(t){console.error("App-Bridge failed to initialize web-vitals",t)}}(w),w}},t.createAppWrapper=E,t.createApp=y,t.default=y},9545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAppPrint=void 0;var r=n(2172);function i(){var e;null===(e=(0,r.getWindow)())||void 0===e||e.print()}function o(){var e=function(){var e=(0,r.getWindow)();if(e&&e.document&&e.document.body){var t=e.document.createElement("input");return t.style.display="none",e.document.body.appendChild(t),t}}();e&&(e.select(),i(),e.remove())}t.handleAppPrint=function(){navigator.userAgent.indexOf("iOS")>=0?o():i()}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{"use strict";var e={};n.r(e),n.d(e,{hasBrowserEnv:()=>db,hasStandardBrowserEnv:()=>hb,hasStandardBrowserWebWorkerEnv:()=>pb,navigator:()=>ub,origin:()=>mb});var t={};n.r(t),n.d(t,{Decoder:()=>bw,Encoder:()=>_w,PacketType:()=>gw,protocol:()=>fw});var r=n(4391),i=n(5043),o=n(45),a=n(9379);const s=["sri"],c=["page"],l=["page","matches"],d=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],u=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],h=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var p="popstate";function m(){return y(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return v("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:b(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function f(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function g(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function _(e,t){return{usr:e.state,key:e.key,idx:t}}function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return(0,a.A)((0,a.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?E(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function b(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function E(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function y(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,c="POP",l=null,d=u();function u(){return(s.state||{idx:null}).idx}function h(){c="POP";let e=u(),t=null==e?null:e-d;d=e,l&&l({action:c,location:f.location,delta:t})}function m(e){return S(e)}null==d&&(d=0,s.replaceState((0,a.A)((0,a.A)({},s.state),{},{idx:d}),""));let f={get action(){return c},get location(){return e(i,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(p,h),l=e,()=>{i.removeEventListener(p,h),l=null}},createHref:e=>t(i,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){c="PUSH";let r=v(f.location,e,t);n&&n(r,e),d=u()+1;let a=_(r,d),h=f.createHref(r);try{s.pushState(a,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;i.location.assign(h)}o&&l&&l({action:c,location:f.location,delta:1})},replace:function(e,t){c="REPLACE";let r=v(f.location,e,t);n&&n(r,e),d=u();let i=_(r,d),a=f.createHref(r);s.replaceState(i,"",a),o&&l&&l({action:c,location:f.location,delta:0})},go:e=>s.go(e)};return f}function S(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),f(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:b(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function T(e,t){return C(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function C(e,t,n,r){let i=j(("string"===typeof t?E(t):t).pathname||"/",n);if(null==i)return null;let o=w(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=F(i);a=L(o[s],e,r)}return a}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,s=arguments.length>3?arguments[3]:void 0,c={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(r)&&a)return;f(c.relativePath.startsWith(r),'Absolute route path "'.concat(c.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),c.relativePath=c.relativePath.slice(r.length)}let l=G([r,c.relativePath]),d=n.concat(c);e.children&&e.children.length>0&&(f(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(l,'".')),w(e.children,t,d,l,a)),(null!=e.path||e.index)&&t.push({path:l,score:x(l,e.index),routesMeta:d})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of R(e.path))o(e,t,!0,r);else o(e,t)}),t}function R(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=R(r.join("/")),s=[];return s.push(...a.map(e=>""===e?o:[o,e].join("/"))),i&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var A=/^:[\w-]+$/,I=3,N=2,O=1,P=10,k=-2,D=e=>"*"===e;function x(e,t){let n=e.split("/"),r=n.length;return n.some(D)&&(r+=k),t&&(r+=N),n.filter(e=>!D(e)).reduce((e,t)=>e+(A.test(t)?I:""===t?O:P),r)}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,i={},o="/",a=[];for(let s=0;s<r.length;++s){let e=r[s],c=s===r.length-1,l="/"===o?t:t.slice(o.length)||"/",d=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),u=e.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:G([o,d.pathname]),pathnameBase:z(G([o,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(o=G([o,d.pathnameBase]))}return a}function M(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=U(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1),c=r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const c=s[n];return e[r]=i&&!c?void 0:(c||"").replace(/%2F/g,"/"),e},{});return{params:c,pathname:o,pathnameBase:a,pattern:e}}function U(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];g("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function F(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return g(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function j(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function V(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function B(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function W(e){let t=B(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function H(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=E(e):(r=(0,a.A)({},e),f(!r.pathname||!r.pathname.includes("?"),V("?","pathname","search",r)),f(!r.pathname||!r.pathname.includes("#"),V("#","pathname","hash",r)),f(!r.search||!r.search.includes("#"),V("#","search","hash",r)));let o,s=""===e||""===r.pathname,c=s?"/":r.pathname;if(null==c)o=n;else{let e=t.length-1;if(!i&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:i=""}="string"===typeof e?E(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:K(r),hash:Y(i)}}(r,o),d=c&&"/"!==c&&c.endsWith("/"),u=(s||"."===c)&&n.endsWith("/");return l.pathname.endsWith("/")||!d&&!u||(l.pathname+="/"),l}var G=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),K=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";var q=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:302;"number"===typeof t?t={status:t}:"undefined"===typeof t.status&&(t.status=302);let n=new Headers(t.headers);return n.set("Location",e),new Response(null,(0,a.A)((0,a.A)({},t),{},{headers:n}))};function X(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var J=["POST","PUT","PATCH","DELETE"],Z=(new Set(J),["GET",...J]);new Set(Z),Symbol("ResetLoaderData");var Q=i.createContext(null);Q.displayName="DataRouter";var $=i.createContext(null);$.displayName="DataRouterState";var ee=i.createContext(!1);var te=i.createContext({isTransitioning:!1});te.displayName="ViewTransition";var ne=i.createContext(new Map);ne.displayName="Fetchers";var re=i.createContext(null);re.displayName="Await";var ie=i.createContext(null);ie.displayName="Navigation";var oe=i.createContext(null);oe.displayName="Location";var ae=i.createContext({outlet:null,matches:[],isDataRoute:!1});ae.displayName="Route";var se=i.createContext(null);se.displayName="RouteError";function ce(){return null!=i.useContext(oe)}function le(){return f(ce(),"useLocation() may be used only in the context of a <Router> component."),i.useContext(oe).location}var de="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(e){i.useContext(ie).static||i.useLayoutEffect(e)}function he(){let{isDataRoute:e}=i.useContext(ae);return e?function(){let{router:e}=Se("useNavigate"),t=Ce("useNavigate"),n=i.useRef(!1);ue(()=>{n.current=!0});let r=i.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(n.current,de),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,(0,a.A)({fromRouteId:t},i)))},[e,t]);return r}():function(){f(ce(),"useNavigate() may be used only in the context of a <Router> component.");let e=i.useContext(Q),{basename:t,navigator:n}=i.useContext(ie),{matches:r}=i.useContext(ae),{pathname:o}=le(),a=JSON.stringify(W(r)),s=i.useRef(!1);ue(()=>{s.current=!0});let c=i.useCallback(function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(g(s.current,de),!s.current)return;if("number"===typeof r)return void n.go(r);let c=H(r,JSON.parse(a),o,"path"===i.relative);null==e&&"/"!==t&&(c.pathname="/"===c.pathname?t:G([t,c.pathname])),(i.replace?n.replace:n.push)(c,i.state,i)},[t,n,a,o,e]);return c}()}var pe=i.createContext(null);function me(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=i.useContext(ae),{pathname:r}=le(),o=JSON.stringify(W(n));return i.useMemo(()=>H(e,JSON.parse(o),r,"path"===t),[e,o,r,t])}function fe(e,t,n,r,o){f(ce(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=i.useContext(ie),{matches:c}=i.useContext(ae),l=c[c.length-1],d=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",p=l&&l.route;{let e=p&&p.path||"";Ae(u,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let m,_=le();if(t){var v;let e="string"===typeof t?E(t):t;f("/"===h||(null===(v=e.pathname)||void 0===v?void 0:v.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),m=e}else m=_;let b=m.pathname||"/",y=b;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let S=T(e,{pathname:y});g(p||null!=S,'No routes matched location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" ')),g(null==S||void 0!==S[S.length-1].route.element||void 0!==S[S.length-1].route.Component||void 0!==S[S.length-1].route.lazy,'Matched leaf route at location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let C=Ee(S&&S.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:G([h,s.encodeLocation?s.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:G([h,s.encodeLocation?s.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),c,n,r,o);return t&&C?i.createElement(oe.Provider,{value:{location:(0,a.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:"POP"}},C):C}function ge(){let e=we(),t=X(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=i.createElement(i.Fragment,null,i.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),i.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",i.createElement("code",{style:a},"ErrorBoundary")," or"," ",i.createElement("code",{style:a},"errorElement")," prop on your route.")),i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:o},n):null,s)}var _e=i.createElement(ge,null),ve=class extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?i.createElement(ae.Provider,{value:this.props.routeContext},i.createElement(se.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function be(e){let{routeContext:t,match:n,children:r}=e,o=i.useContext(Q);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(ae.Provider,{value:t},r)}function Ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let o=e,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let e=o.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));f(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),o=o.slice(0,Math.min(o.length,e+1))}let s=!1,c=-1;if(n)for(let i=0;i<o.length;i++){let e=o[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){s=!0,o=c>=0?o.slice(0,c+1):[o[0]];break}}}return o.reduceRight((e,l,d)=>{let u,h=!1,p=null,m=null;n&&(u=a&&l.route.id?a[l.route.id]:void 0,p=l.route.errorElement||_e,s&&(c<0&&0===d?(Ae("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):c===d&&(h=!0,m=l.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,d+1)),g=()=>{let t;return t=u?p:h?m:l.route.Component?i.createElement(l.route.Component,null):l.route.element?l.route.element:e,i.createElement(be,{match:l,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===d)?i.createElement(ve,{location:n.location,revalidation:n.revalidation,component:p,error:u,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0},unstable_onError:r}):g()},null)}function ye(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Se(e){let t=i.useContext(Q);return f(t,ye(e)),t}function Te(e){let t=i.useContext($);return f(t,ye(e)),t}function Ce(e){let t=function(e){let t=i.useContext(ae);return f(t,ye(e)),t}(e),n=t.matches[t.matches.length-1];return f(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function we(){var e;let t=i.useContext(se),n=Te("useRouteError"),r=Ce("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var Re={};function Ae(e,t,n){t||Re[e]||(Re[e]=!0,g(!1,n))}var Ie={};function Ne(e,t){e||Ie[t]||(Ie[t]=!0,console.warn(t))}i.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:i}=e;return fe(t,void 0,r,i,n)});function Oe(e){return function(e){let t=i.useContext(ae).outlet;return i.useMemo(()=>t&&i.createElement(pe.Provider,{value:e},t),[t,e])}(e.context)}function Pe(e){f(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ke(e){let{basename:t="/",children:n=null,location:r,navigationType:o="POP",navigator:a,static:s=!1}=e;f(!ce(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),l=i.useMemo(()=>({basename:c,navigator:a,static:s,future:{}}),[c,a,s]);"string"===typeof r&&(r=E(r));let{pathname:d="/",search:u="",hash:h="",state:p=null,key:m="default"}=r,_=i.useMemo(()=>{let e=j(d,c);return null==e?null:{location:{pathname:e,search:u,hash:h,state:p,key:m},navigationType:o}},[c,d,u,h,p,m,o]);return g(null!=_,'<Router basename="'.concat(c,'"> is not able to match the URL "').concat(d).concat(u).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==_?null:i.createElement(ie.Provider,{value:l},i.createElement(oe.Provider,{children:n,value:_}))}function De(e){let{children:t,location:n}=e;return fe(xe(t),n)}i.Component;function xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let o=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,xe(e.props.children,o));f(e.type===Pe,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),f(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=xe(e.props.children,o)),n.push(a)}),n}var Le="get",Me="application/x-www-form-urlencoded";function Ue(e){return null!=e&&"string"===typeof e.tagName}function Fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}var je=null;var Ve=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Be(e){return null==e||Ve.has(e)?e:(g(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Me,'"')),null)}function We(e,t){let n,r,i,o,a;if(Ue(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?j(a,t):null,n=e.getAttribute("method")||Le,i=Be(e.getAttribute("enctype"))||Me,o=new FormData(e)}else if(function(e){return Ue(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ue(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(r=s?j(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Le,i=Be(e.getAttribute("formenctype"))||Be(a.getAttribute("enctype"))||Me,o=new FormData(a,e),!function(){if(null===je)try{new FormData(document.createElement("form"),0),je=!1}catch(e){je=!0}return je}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,r)}}else{if(Ue(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Le,r=null,i=Me,a=e}var s;return o&&"text/plain"===i&&(a=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function He(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ge(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===j(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function ze(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ke(e){return null!=e&&"string"===typeof e.page}function Ye(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function qe(e,t,n,r,i,o){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter((e,t)=>a(e,t)||s(e,t)):"data"===o?t.filter((t,o)=>{let c=r.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){var l;let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:(null===(l=n[0])||void 0===l?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Xe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1),[...new Set(r)];var r}function Je(e,t){let n=new Set,r=new Set(t);return e.reduce((e,i)=>{if(t&&!Ke(i)&&"script"===i.as&&i.href&&r.has(i.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(i));return n.has(o)||(n.add(o),e.push({key:o,link:i})),e},[])}function Ze(e,t){return"lazy"===e.mode&&!0===t}function Qe(){let e=i.useContext(Q);return He(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function $e(){let e=i.useContext($);return He(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var et=i.createContext(void 0);function tt(){let e=i.useContext(et);return He(e,"You must render this element inside a <HydratedRouter> element"),e}function nt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function rt(e,t,n){if(n&&!st)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}et.displayName="FrameworkContext";function it(e){let{page:t}=e,n=(0,o.A)(e,c),{router:r}=Qe(),s=i.useMemo(()=>T(r.routes,t,r.basename),[r.routes,t,r.basename]);return s?i.createElement(at,(0,a.A)({page:t,matches:s},n)):null}function ot(e){let{manifest:t,routeModules:n}=tt(),[r,o]=i.useState([]);return i.useEffect(()=>{let r=!1;return async function(e,t,n){return Je((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await ze(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Ye).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,a.A)((0,a.A)({},e),{},{rel:"prefetch",as:"style"}):(0,a.A)((0,a.A)({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||o(e)}),()=>{r=!0}},[e,t,n]),r}function at(e){let{page:t,matches:n}=e,r=(0,o.A)(e,l),s=le(),{manifest:c,routeModules:d}=tt(),{basename:u}=Qe(),{loaderData:h,matches:p}=$e(),m=i.useMemo(()=>qe(t,n,p,c,s,"data"),[t,n,p,c,s]),f=i.useMemo(()=>qe(t,n,p,c,s,"assets"),[t,n,p,c,s]),g=i.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let i=c.routes[t.route.id];i&&i.hasLoader&&(!m.some(e=>e.route.id===t.route.id)&&t.route.id in h&&null!==(n=d[t.route.id])&&void 0!==n&&n.shouldRevalidate||i.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let i=Ge(t,u,"data");return r&&e.size>0&&i.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[i.pathname+i.search]},[u,h,s,c,m,n,t,d]),_=i.useMemo(()=>Xe(f,c),[f,c]),v=ot(f);return i.createElement(i.Fragment,null,g.map(e=>i.createElement("link",(0,a.A)({key:e,rel:"prefetch",as:"fetch",href:e},r))),_.map(e=>i.createElement("link",(0,a.A)({key:e,rel:"modulepreload",href:e},r))),v.map(e=>{let{key:t,link:n}=e;return i.createElement("link",(0,a.A)({key:t,nonce:r.nonce},n))}))}var st=!1;function ct(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:c,routeDiscovery:l,ssr:d}=tt(),{router:u,static:h,staticContext:p}=Qe(),{matches:m}=$e(),f=i.useContext(ee),g=Ze(l,d);c&&(c.didRenderScripts=!0);let _=rt(m,null,r);i.useEffect(()=>{0},[]);let v=i.useMemo(()=>{var r;if(f)return null;let c=p?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",l=h?"".concat(null!==t.hmr&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(_.map((e,n)=>{let r="route".concat(n),i=t.routes[e.route.id];He(i,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:o,clientLoaderModule:a,clientMiddlewareModule:s,hydrateFallbackModule:c,module:l}=i,d=[...o?[{module:o,varName:"".concat(r,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(r,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(r,"_clientMiddleware")}]:[],...c?[{module:c,varName:"".concat(r,"_HydrateFallback")}]:[],{module:l,varName:"".concat(r,"_main")}];return 1===d.length?"import * as ".concat(r," from ").concat(JSON.stringify(l),";"):[d.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(d.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=(0,o.A)(e,s),i=new Set(t.state.matches.map(e=>e.route.id)),c=t.state.location.pathname.split("/").filter(Boolean),l=["/"];for(c.pop();c.length>0;)l.push("/".concat(c.join("/"))),c.pop();l.forEach(e=>{let n=T(t.routes,e,t.basename);n&&n.forEach(e=>i.add(e.route.id))});let d=[...i].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return(0,a.A)((0,a.A)({},r),{},{routes:d,sri:!!n||void 0})}(t,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(_.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return i.createElement(i.Fragment,null,i.createElement("script",(0,a.A)((0,a.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:c},type:void 0})),i.createElement("script",(0,a.A)((0,a.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:l},type:"module",async:!0})))},[]),b=st||f?[]:(t.entry.imports.concat(Xe(_,t,{includeHydrateFallback:!0})),[...new Set(E)]);var E;let y="object"===typeof t.sri?t.sri:{};return Ne(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),st||f?null:i.createElement(i.Fragment,null,"object"===typeof t.sri?i.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:y})}}):null,g?null:i.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:y[t.url],suppressHydrationWarning:!0}),i.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:y[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>i.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:y[t],suppressHydrationWarning:!0})),v)}function lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}i.Component;function dt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,o=i.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(X(t))return i.createElement(ut,{title:"Unhandled Thrown Response!"},i.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),o);if(t instanceof Error)0;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);new Error(e)}return i.createElement(ut,{title:"Application Error!",isOutsideRemixApp:n},i.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),i.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),o)}function ut(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:o,children:a}=e,{routeModules:s}=tt();return null!==s.root&&void 0!==t&&t.Layout&&!o?a:i.createElement("html",{lang:"en"},i.createElement("head",null,i.createElement("meta",{charSet:"utf-8"}),i.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),i.createElement("title",null,n)),i.createElement("body",null,i.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,r?i.createElement(ct,null):null)))}var ht="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ht&&(window.__reactRouterVersion="7.9.5")}catch($D){}function pt(e){let{basename:t,children:n,window:r}=e,o=i.useRef();null==o.current&&(o.current=m({window:r,v5Compat:!0}));let a=o.current,[s,c]=i.useState({action:a.action,location:a.location}),l=i.useCallback(e=>{i.startTransition(()=>c(e))},[c]);return i.useLayoutEffect(()=>a.listen(l),[a,l]),i.createElement(ke,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a})}var mt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ft=i.forwardRef(function(e,t){let n,{onClick:r,discover:s="render",prefetch:c="none",relative:l,reloadDocument:u,replace:h,state:p,target:m,to:_,preventScrollReset:v,viewTransition:E}=e,y=(0,o.A)(e,d),{basename:S}=i.useContext(ie),T="string"===typeof _&&mt.test(_),C=!1;if("string"===typeof _&&T&&(n=_,ht))try{let e=new URL(window.location.href),t=_.startsWith("//")?new URL(e.protocol+_):new URL(_),n=j(t.pathname,S);t.origin===e.origin&&null!=n?_=n+t.search+t.hash:C=!0}catch($D){g(!1,'<Link to="'.concat(_,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let w=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(ce(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=i.useContext(ie),{hash:o,pathname:a,search:s}=me(e,{relative:t}),c=a;return"/"!==n&&(c="/"===a?n:G([n,a])),r.createHref({pathname:c,search:s,hash:o})}(_,{relative:l}),[R,A,I]=function(e,t){let n=i.useContext(et),[r,o]=i.useState(!1),[a,s]=i.useState(!1),{onFocus:c,onBlur:l,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=t,p=i.useRef(null);i.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),i.useEffect(()=>{if(r){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[r]);let m=()=>{o(!0)},f=()=>{o(!1),s(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:nt(c,m),onBlur:nt(l,f),onMouseEnter:nt(d,m),onMouseLeave:nt(u,f),onTouchStart:nt(h,m)}]:[!1,p,{}]}(c,y),N=function(e){let{target:t,replace:n,state:r,preventScrollReset:o,relative:a,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=he(),l=le(),d=me(e,{relative:a});return i.useCallback(i=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(i,t)){i.preventDefault();let t=void 0!==n?n:b(l)===b(d);c(e,{replace:t,state:r,preventScrollReset:o,relative:a,viewTransition:s})}},[l,c,d,n,r,t,e,o,a,s])}(_,{replace:h,state:p,target:m,preventScrollReset:v,relative:l,viewTransition:E});let O=i.createElement("a",(0,a.A)((0,a.A)((0,a.A)({},y),I),{},{href:n||w,onClick:C||u?r:function(e){r&&r(e),e.defaultPrevented||N(e)},ref:lt(t,A),target:m,"data-discover":T||"render"!==s?void 0:"true"}));return R&&!T?i.createElement(i.Fragment,null,O,i.createElement(it,{page:w})):O});ft.displayName="Link";var gt=i.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:s="",end:c=!1,style:l,to:d,viewTransition:h,children:p}=e,m=(0,o.A)(e,u),g=me(d,{relative:m.relative}),_=le(),v=i.useContext($),{navigator:b,basename:E}=i.useContext(ie),y=null!=v&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.useContext(te);f(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=bt("useViewTransitionState"),o=me(e,{relative:t});if(!n.isTransitioning)return!1;let a=j(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=j(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=M(o.pathname,s)||null!=M(o.pathname,a)}(g)&&!0===h,S=b.encodeLocation?b.encodeLocation(g).pathname:g.pathname,T=_.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(T=T.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&E&&(C=j(C,E)||C);const w="/"!==S&&S.endsWith("/")?S.length-1:S.length;let R,A=T===S||!c&&T.startsWith(S)&&"/"===T.charAt(w),I=null!=C&&(C===S||!c&&C.startsWith(S)&&"/"===C.charAt(S.length)),N={isActive:A,isPending:I,isTransitioning:y},O=A?n:void 0;R="function"===typeof s?s(N):[s,A?"active":null,I?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof l?l(N):l;return i.createElement(ft,(0,a.A)((0,a.A)({},m),{},{"aria-current":O,className:R,ref:t,style:P,to:d,viewTransition:h}),"function"===typeof p?p(N):p)});gt.displayName="NavLink";var _t=i.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:s,reloadDocument:c,replace:l,state:d,method:u=Le,action:p,onSubmit:m,relative:g,preventScrollReset:_,viewTransition:v}=e,E=(0,o.A)(e,h),y=Tt(),S=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=i.useContext(ie),r=i.useContext(ae);f(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),s=(0,a.A)({},me(e||".",{relative:t})),c=le();if(null==e){s.search=c.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?"?".concat(n):""}}e&&"."!==e||!o.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(s.pathname="/"===s.pathname?n:G([n,s.pathname]));return b(s)}(p,{relative:g}),T="get"===u.toLowerCase()?"get":"post",C="string"===typeof p&&mt.test(p);return i.createElement("form",(0,a.A)((0,a.A)({ref:t,method:T,action:S,onSubmit:c?m:e=>{if(m&&m(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;y(t||e.currentTarget,{fetcherKey:r,method:n,navigate:s,replace:l,state:d,relative:g,preventScrollReset:_,viewTransition:v})}},E),{},{"data-discover":C||"render"!==n?void 0:"true"}))});function vt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function bt(e){let t=i.useContext(Q);return f(t,vt(e)),t}function Et(e){g("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=i.useRef(Fe(e)),n=i.useRef(!1),r=le(),o=i.useMemo(()=>function(e,t){let n=Fe(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),a=he(),s=i.useCallback((e,t)=>{const r=Fe("function"===typeof e?e(new URLSearchParams(o)):e);n.current=!0,a("?"+r,t)},[a,o]);return[o,s]}_t.displayName="Form";var yt=0,St=()=>"__".concat(String(++yt),"__");function Tt(){let{router:e}=bt("useSubmit"),{basename:t}=i.useContext(ie),n=Ce("useRouteId");return i.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:s,formData:c,body:l}=We(r,t);if(!1===i.navigate){let t=i.fetcherKey||St();await e.fetch(t,n,i.action||o,{preventScrollReset:i.preventScrollReset,formData:c,body:l,formMethod:i.method||a,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:c,body:l,formMethod:i.method||a,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}var Ct=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M3 4.75a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5h-12.5a.75.75 0 0 1-.75-.75Z"}),i.createElement("path",{fillRule:"evenodd",d:"M3 10a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5h-12.5a.75.75 0 0 1-.75-.75Z"}),i.createElement("path",{fillRule:"evenodd",d:"M3 15.25a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5h-12.5a.75.75 0 0 1-.75-.75Z"}))};Ct.displayName="MenuIcon";var wt,Rt=["xs","sm","md","lg","xl"];function At(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(d){l=!0,i=d}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return It(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return It(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Nt,Ot,Pt="px",kt="em",Dt="rem",xt=new RegExp(String.raw(wt||(Nt=["-?d+(?:.d+|d*)"],(Ot=["-?\\d+(?:\\.\\d+|\\d*)"])||(Ot=Nt.slice(0)),Nt.raw=Ot,wt=Nt))),Lt=new RegExp("px|em|"+Dt);function Mt(e){void 0===e&&(e="");var t=e.match(new RegExp(xt.source+"("+Lt.source+")"));return t&&t[1]}function Ut(e){void 0===e&&(e="");var t=Mt(e);return t?t===Pt?e:t===kt||t===Dt?""+16*parseFloat(e)+Pt:void 0:e}function Ft(e,t){void 0===e&&(e=""),void 0===t&&(t=16);var n=Mt(e);return n?n===kt?e:n===Pt?""+parseFloat(e)/t+kt:n===Dt?""+16*parseFloat(e)/t+kt:void 0:e}function jt(e){return e.replace(new RegExp(xt.source+"("+"px)","g"),function(e){var t;return null!=(t=function(e){void 0===e&&(e="");var t=Mt(e);return t?t===Dt?e:t===kt?""+parseFloat(e)+Dt:t===Pt?""+parseFloat(e)/16+Dt:void 0:e}(e))?t:e})}function Vt(e){return Object.fromEntries(Object.entries(e).map(function(e){var t=At(e,2),n=t[0],r=t[1];return[n,Object.assign(Object.assign({},r),{},{value:jt(r.value)})]}))}function Bt(e){return"--p-"+e}function Wt(e){return"var("+Bt(e)+")"}function Ht(e){return Object.values(e).flatMap(function(e){return Object.keys(e)})}function Gt(e){var t=Object.entries(e),n=t.length-1;return Object.fromEntries(t.map(function(e,r){var i=At(e,2),o=i[0],a=i[1],s=function(e){return"(min-width: "+Ft(e)+")"}(a);return[o,{up:s,down:zt(a),only:r===n?s:s+" and "+zt(t[r+1][1])}]}))}function zt(e){var t;return"(max-width: "+Ft(parseFloat(null!=(t=Ut(e))?t:"")-.04+"px")+")"}var Kt=["border","breakpoints","font","height","shadow","space","text","width"];var Yt=n(7789),qt="0px",Xt="0.66px",Jt="1px",Zt="2px",Qt="4px",$t="6px",en="8px",tn="11px",nn="12px",rn="13px",on="14px",an="16px",sn="18px",cn="20px",ln="22px",dn="24px",un="28px",hn="30px",pn="32px",mn="36px",fn="40px",gn="48px",_n="64px",vn="80px",bn="96px",En="112px",yn="128px",Sn={"border-radius-0":{value:qt},"border-radius-050":{value:Zt},"border-radius-100":{value:Qt},"border-radius-150":{value:$t},"border-radius-200":{value:en},"border-radius-300":{value:nn},"border-radius-400":{value:an},"border-radius-500":{value:cn},"border-radius-750":{value:hn},"border-radius-full":{value:"9999px"},"border-width-0":{value:qt},"border-width-0165":{value:Xt},"border-width-025":{value:Jt},"border-width-050":{value:Zt},"border-width-100":{value:Qt}},Tn="rgba(255, 255, 255, 1)",Cn="rgba(253, 253, 253, 1)",wn="rgba(250, 250, 250, 1)",Rn="rgba(247, 247, 247, 1)",An="rgba(243, 243, 243, 1)",In="rgba(241, 241, 241, 1)",Nn="rgba(235, 235, 235, 1)",On="rgba(227, 227, 227, 1)",Pn="rgba(212, 212, 212, 1)",kn="rgba(204, 204, 204, 1)",Dn="rgba(181, 181, 181, 1)",xn="rgba(138, 138, 138, 1)",Ln="rgba(97, 97, 97, 1)",Mn="rgba(74, 74, 74, 1)",Un="rgba(48, 48, 48, 1)",Fn="rgba(26, 26, 26, 1)",jn="rgba(234, 244, 255, 1)",Vn="rgba(224, 240, 255, 1)",Bn="rgba(213, 235, 255, 1)",Wn="rgba(202, 230, 255, 1)",Hn="rgba(168, 216, 255, 1)",Gn="rgba(145, 208, 255, 1)",zn="rgba(81, 192, 255, 1)",Kn="rgba(0, 148, 213, 1)",Yn="rgba(0, 124, 180, 1)",qn="rgba(0, 58, 90, 1)",Xn="rgba(0, 33, 51, 1)",Jn="rgba(226, 231, 255, 1)",Zn="rgba(0, 91, 211, 1)",Qn="rgba(0, 66, 153, 1)",$n="rgba(0, 46, 106, 1)",er="rgba(180, 254, 210, 1)",tr="rgba(146, 254, 194, 1)",nr="rgba(41, 132, 90, 1)",rr="rgba(12, 81, 50, 1)",ir="rgba(178, 132, 0, 1)",or="rgba(37, 26, 0, 1)",ar="rgba(248, 247, 255, 1)",sr="rgba(233, 229, 255, 1)",cr="rgba(228, 222, 255, 1)",lr="rgba(148, 116, 255, 1)",dr="rgba(128, 81, 255, 1)",ur="rgba(229, 28, 0, 1)",hr="rgba(142, 31, 11, 1)",pr="rgba(255, 235, 120, 1)",mr="rgba(51, 46, 0, 1)",fr="rgba(0, 0, 0, 0.02)",gr="rgba(0, 0, 0, 0.05)",_r="rgba(0, 0, 0, 0.08)",vr="rgba(0, 0, 0, 0.20)",br="rgba(0, 0, 0, 0.71)",Er="rgba(255, 255, 255, 0.03)",yr="rgba(255, 255, 255, 0.11)",Sr="rgba(255, 255, 255, 0.17)",Tr="rgba(255, 255, 255, 0.20)",Cr="rgba(255, 255, 255, 0.28)",wr={"color-scheme":{value:"light"},"color-bg":{value:In,description:"The default background color of the admin."},"color-bg-inverse":{value:Fn,description:"Use for high contrast page or component backgrounds."},"color-bg-surface":{value:Tn,description:"The background color for elements with the highest level of prominence, like a card."},"color-bg-surface-hover":{value:Rn,description:"The hover state color for elements with the highest level of prominence."},"color-bg-surface-active":{value:An,description:"The active state (on press) color for elements with the highest level of prominence."},"color-bg-surface-selected":{value:In,description:"The selected state color for elements with the highest level of prominence."},"color-bg-surface-disabled":{value:gr,description:"The disabled state color for elements."},"color-bg-surface-secondary":{value:Rn,description:"The background color for elements with a secondary level of prominence."},"color-bg-surface-secondary-hover":{value:In,description:"The hover state color for elements with a secondary level of prominence."},"color-bg-surface-secondary-active":{value:Nn,description:"The active state (on press) color for elements with a secondary level of prominence."},"color-bg-surface-secondary-selected":{value:Nn,description:"The selected state color for elements with a secondary level of prominence."},"color-bg-surface-tertiary":{value:An,description:"The background color for elements with a third level of prominence."},"color-bg-surface-tertiary-hover":{value:Nn,description:"The hover state color for elements with a third level of prominence."},"color-bg-surface-tertiary-active":{value:On,description:"The active state (on press) color for elements with a third level of prominence."},"color-bg-surface-brand":{value:On,description:"Use to apply the key color to elements."},"color-bg-surface-brand-hover":{value:Nn,description:"The hover state color for key elements."},"color-bg-surface-brand-active":{value:In,description:"The active state (on press) color for key elements."},"color-bg-surface-brand-selected":{value:In,description:"The selected state color for key elements."},"color-bg-surface-info":{value:jn,description:"Use for backgrounds communicating important information, like banners."},"color-bg-surface-info-hover":{value:Vn,description:"The hover state color for communicating important information."},"color-bg-surface-info-active":{value:Wn,description:"The active state (on press) color for communicating important information."},"color-bg-surface-success":{value:"rgba(205, 254, 225, 1)",description:"Use for backgrounds communicating success, like banners."},"color-bg-surface-success-hover":{value:er,description:"The hover state color for communicating success."},"color-bg-surface-success-active":{value:tr,description:"The active state (on press) color for communicating success."},"color-bg-surface-caution":{value:"rgba(255, 248, 219, 1)",description:"Use for backgrounds communicating caution, like banners."},"color-bg-surface-caution-hover":{value:"rgba(255, 244, 191, 1)",description:"The hover state for communicating caution."},"color-bg-surface-caution-active":{value:"rgba(255, 239, 157, 1)",description:"The active state (on press) color for communicating caution."},"color-bg-surface-warning":{value:"rgba(255, 241, 227, 1)",description:"Use for backgrounds communicating warning, like banners."},"color-bg-surface-warning-hover":{value:"rgba(255, 235, 213, 1)",description:"The hover state color for communicating warning."},"color-bg-surface-warning-active":{value:"rgba(255, 228, 198, 1)",description:"The active state (on press) color for communicating warning."},"color-bg-surface-critical":{value:"rgba(254, 233, 232, 1)",description:"Use for backgrounds communicating critical information, like banners or input errors."},"color-bg-surface-critical-hover":{value:"rgba(254, 226, 225, 1)",description:"The hover state color for communicating critical information."},"color-bg-surface-critical-active":{value:"rgba(254, 218, 217, 1)",description:"The active state (on press) color for communicating critical information."},"color-bg-surface-emphasis":{value:"rgba(240, 242, 255, 1)",description:"Use for backgrounds indicating areas of focus in editors, such as the theme editor."},"color-bg-surface-emphasis-hover":{value:"rgba(234, 237, 255, 1)",description:"The hover state color for elements indicating areas of focus in editors."},"color-bg-surface-emphasis-active":{value:Jn,description:"The active state (on press) color for elements indicating areas of focus in editors."},"color-bg-surface-magic":{value:ar,description:"Use for backgrounds of elements suggested by magic AI."},"color-bg-surface-magic-hover":{value:"rgba(243, 241, 255, 1)",description:"The hover state color for elements suggested by magic AI."},"color-bg-surface-magic-active":{value:sr,description:"The active state (on press) color for elements suggested by magic AI."},"color-bg-surface-inverse":{value:Un,description:"Use for elements on bg-inverse."},"color-bg-surface-transparent":{value:"rgba(0, 0, 0, 0)",description:"Use for elements that need a fully transparent background."},"color-bg-fill":{value:Tn,description:"The background color of contained elements with a smaller surface area, like a button."},"color-bg-fill-hover":{value:wn,description:"The hover state color of contained elements with a smaller surface area, like a button."},"color-bg-fill-active":{value:Rn,description:"The active state (on press) color of contained elements with a smaller surface area, like a button."},"color-bg-fill-selected":{value:kn,description:"The selected state color of contained elements with a smaller surface area, like a button or checkbox."},"color-bg-fill-disabled":{value:gr,description:"The disabled state color of contained elements with a smaller surface area, like a button."},"color-bg-fill-secondary":{value:In,description:"The background color of elements with a smaller surface area and a secondary level of prominence."},"color-bg-fill-secondary-hover":{value:Nn,description:"The hover state color of elements with a smaller surface area and a secondary level of prominence."},"color-bg-fill-secondary-active":{value:On,description:"The active state (on press) color of elements with a smaller surface area and a secondary level of prominence."},"color-bg-fill-tertiary":{value:On,description:"The background color of elements with a smaller surface area and a third level of prominence."},"color-bg-fill-tertiary-hover":{value:Pn,description:"The hover state color of elements with a smaller surface area and a third level of prominence."},"color-bg-fill-tertiary-active":{value:kn,description:"The active state (on press) color of elements with a smaller surface area and a third level of prominence."},"color-bg-fill-brand":{value:Un,description:"The background color of main actions, like primary buttons."},"color-bg-fill-brand-hover":{value:Fn,description:"The hover state color of main actions, like primary buttons."},"color-bg-fill-brand-active":{value:Fn,description:"The active state (on press) color of main actions, like primary buttons."},"color-bg-fill-brand-selected":{value:Un,description:"The selected state color of main actions, like primary buttons."},"color-bg-fill-brand-disabled":{value:"rgba(0, 0, 0, 0.17)",description:"The disabled state color of main actions, like primary buttons."},"color-bg-fill-info":{value:Gn,description:"Use for backgrounds communicating important information on elements with a smaller surface area, like a badge or button."},"color-bg-fill-info-hover":{value:zn,description:"The hover state color for communicating important information on elements with a smaller surface area."},"color-bg-fill-info-active":{value:Kn,description:"The active state (on press) color for communicating important information on elements with a smaller surface area."},"color-bg-fill-info-secondary":{value:Bn,description:"Use for backgrounds communicating important information on elements with a smaller surface area, with a secondary level of prominence."},"color-bg-fill-success":{value:nr,description:"Use for backgrounds communicating success on elements with a smaller surface area, like a badge or a banner."},"color-bg-fill-success-hover":{value:"rgba(19, 111, 69, 1)",description:"The hover state color for communicating success on elements with a smaller surface area."},"color-bg-fill-success-active":{value:rr,description:"The active state (on press) color for communicating success on elements with a smaller surface area."},"color-bg-fill-success-secondary":{value:er,description:"Use for backgrounds communicating success on elements with a smaller surface area, with a secondary level of prominence."},"color-bg-fill-warning":{value:"rgba(255, 184, 0, 1)",description:"Use for backgrounds communicating warning on elements with a smaller surface area, like a badge or a banner."},"color-bg-fill-warning-hover":{value:"rgba(229, 165, 0, 1)",description:"The hover state color for communicating warning on elements with a smaller surface area."},"color-bg-fill-warning-active":{value:ir,description:"The active state (on press) color for communicating warning on elements with a smaller surface area."},"color-bg-fill-warning-secondary":{value:"rgba(255, 214, 164, 1)",description:"Use for backgrounds communicating warning on elements with a smaller surface area, with a secondary level of prominence."},"color-bg-fill-caution":{value:"rgba(255, 230, 0, 1)",description:"Use for backgrounds communicating caution on elements with a smaller surface area, like a badge or a banner."},"color-bg-fill-caution-hover":{value:"rgba(234, 211, 0, 1)",description:"The hover state color for communicating caution on elements with a smaller surface area."},"color-bg-fill-caution-active":{value:"rgba(225, 203, 0, 1)",description:"The active state (on press) color for communicating caution on elements with a smaller surface area."},"color-bg-fill-caution-secondary":{value:pr,description:"Use for backgrounds communicating caution on elements with a smaller surface area, with a secondary level of prominence."},"color-bg-fill-critical":{value:ur,description:"Use for backgrounds communicating critical information on elements with a smaller surface area, like a badge or a banner."},"color-bg-fill-critical-hover":{value:"rgba(181, 38, 11, 1)",description:"The hover state color for communicating critical information on elements with a smaller surface area."},"color-bg-fill-critical-active":{value:hr,description:"The active state (on press) color for communicating critical information on elements with a smaller surface area."},"color-bg-fill-critical-selected":{value:hr,description:"The selected state color for communicating critical information on elements with a smaller surface area."},"color-bg-fill-critical-secondary":{value:"rgba(254, 211, 209, 1)",description:"Use for backgrounds communicating critical information on elements with a smaller surface area, with a secondary level of prominence."},"color-bg-fill-emphasis":{value:Zn,description:"Use for backgrounds indicating areas of focus in editors on elements with a smaller surface area, like a button or a badge."},"color-bg-fill-emphasis-hover":{value:Qn,description:"The hover state color for indicating areas of focus in editors on elements with a smaller surface area."},"color-bg-fill-emphasis-active":{value:$n,description:"The active state (on press) color for indicating areas of focus in editors on elements with a smaller surface area."},"color-bg-fill-magic":{value:dr,description:"The background color of elements suggested by magic AI, like a badge or a banner."},"color-bg-fill-magic-secondary":{value:sr,description:"The background color of elements suggested by magic AI, with a secondary level of prominence."},"color-bg-fill-magic-secondary-hover":{value:cr,description:"The hover state color of elements suggested by magic AI, with a secondary level of prominence."},"color-bg-fill-magic-secondary-active":{value:"rgba(223, 217, 255, 1)",description:"The active state (on press) color of elements suggested by magic AI, with a secondary level of prominence."},"color-bg-fill-inverse":{value:Un,description:"The background color of elements with a smaller surface area on an inverse background."},"color-bg-fill-inverse-hover":{value:Mn,description:"The hover state color of elements with a smaller surface area on an inverse background."},"color-bg-fill-inverse-active":{value:Ln,description:"The active state (on press) color of elements with a smaller surface area on an inverse background."},"color-bg-fill-transparent":{value:fr,description:"The background color of elements that need to sit on different background colors, like tabs."},"color-bg-fill-transparent-hover":{value:gr,description:"The hover state color of elements that need to sit on different background colors, like tabs."},"color-bg-fill-transparent-active":{value:_r,description:"The active state (on press) color of elements that need to sit on different background colors, like tabs."},"color-bg-fill-transparent-selected":{value:_r,description:"The selected state color of elements that need to sit on different background colors, like tabs."},"color-bg-fill-transparent-secondary":{value:"rgba(0, 0, 0, 0.06)",description:"The background color of elements that need to sit on different background colors, with a secondary level of prominence."},"color-bg-fill-transparent-secondary-hover":{value:_r,description:"The hover state color of elements that need to sit on different background colors, with a secondary level of prominence."},"color-bg-fill-transparent-secondary-active":{value:"rgba(0, 0, 0, 0.11)",description:"The active state (on press) color of elements that need to sit on different background colors, with a secondary level of prominence."},"color-text":{value:Un,description:"The default text color."},"color-text-secondary":{value:Ln,description:"Use for text with a secondary level of prominence."},"color-text-disabled":{value:Dn,description:"Use for text in a disabled state."},"color-text-link":{value:Zn,description:"Use for text links."},"color-text-link-hover":{value:Qn,description:"The hover state color for text links."},"color-text-link-active":{value:$n,description:"The active state (on press) color for text links."},"color-text-brand":{value:Mn,description:"Use for text that needs to pull attention."},"color-text-brand-hover":{value:Un,description:"The hover state color for text that needs to pull attention."},"color-text-brand-on-bg-fill":{value:Tn,description:"Use for text on bg-fill-brand, like primary buttons."},"color-text-brand-on-bg-fill-hover":{value:On,description:"The hover state color for text on bg-fill-brand-hover."},"color-text-brand-on-bg-fill-active":{value:kn,description:"The active state (on press) color for text on bg-fill-brand."},"color-text-brand-on-bg-fill-disabled":{value:Tn,description:"The disabled state color for text on bg-fill-brand-disabled."},"color-text-info":{value:qn,description:"Use for text communicating important information."},"color-text-info-hover":{value:qn,description:"The hover state color for text communicating important information."},"color-text-info-active":{value:Xn,description:"The active state (on press) color for text communicating important information."},"color-text-info-secondary":{value:Yn,description:"Use for text communicating important information with a secondary level of prominence."},"color-text-info-on-bg-fill":{value:Xn,description:"Use for text and icons on bg-fill-info."},"color-text-success":{value:rr,description:"Use for text communicating success."},"color-text-success-hover":{value:"rgba(8, 61, 37, 1)",description:"The hover state color for text communicating success."},"color-text-success-active":{value:"rgba(9, 42, 27, 1)",description:"The active state (on press) color for text communicating success."},"color-text-success-secondary":{value:nr,description:"Use for text communicating success with a secondary level of prominence."},"color-text-success-on-bg-fill":{value:"rgba(248, 255, 251, 1)",description:"Use for text and icons on bg-fill-success."},"color-text-caution":{value:"rgba(79, 71, 0, 1)",description:"Use for text communicating caution."},"color-text-caution-hover":{value:mr,description:"The hover state color for text communicating caution."},"color-text-caution-active":{value:"rgba(31, 28, 0, 1)",description:"The active state (on press) color for text communicating caution."},"color-text-caution-secondary":{value:"rgba(130, 117, 0, 1)",description:"Use for text communicating caution with a secondary level of prominence."},"color-text-caution-on-bg-fill":{value:mr,description:"Use for text and icons on bg-fill-caution."},"color-text-warning":{value:"rgba(94, 66, 0, 1)",description:"Use for text communicating warning."},"color-text-warning-hover":{value:"rgba(65, 45, 0, 1)",description:"The hover state color for text communicating warning."},"color-text-warning-active":{value:or,description:"The active state (on press) color for text communicating warning."},"color-text-warning-secondary":{value:"rgba(149, 111, 0, 1)",description:"Use for text communicating warning with a secondary level of prominence."},"color-text-warning-on-bg-fill":{value:or,description:"Use for text and icons on bg-fill-warning."},"color-text-critical":{value:hr,description:"Use for text communicating critical information."},"color-text-critical-hover":{value:"rgba(95, 21, 7, 1)",description:"The hover state color for text communicating critical information."},"color-text-critical-active":{value:"rgba(47, 10, 4, 1)",description:"The active state (on press) color for text communicating critical information."},"color-text-critical-secondary":{value:ur,description:"Use for text communicating critical information with a secondary level of prominence."},"color-text-critical-on-bg-fill":{value:"rgba(255, 251, 251, 1)",description:"Use for text and icons on bg-fill-critical."},"color-text-emphasis":{value:Zn,description:"Use for text indicating areas of focus in editors, like the theme editor."},"color-text-emphasis-hover":{value:Qn,description:"The hover state color for text indicating areas of focus."},"color-text-emphasis-active":{value:$n,description:"The active state (on press) color for text indicating areas of focus."},"color-text-emphasis-on-bg-fill":{value:"rgba(252, 253, 255, 1)",description:"Use for text and icons on bg-fill-emphasis."},"color-text-emphasis-on-bg-fill-hover":{value:Jn,description:"Use for text and icons on bg-fill-emphasis-hover."},"color-text-emphasis-on-bg-fill-active":{value:"rgba(213, 220, 255, 1)",description:"Use for text and icons on bg-fill-emphasis-active."},"color-text-magic":{value:"rgba(87, 0, 209, 1)",description:"Use for text suggested by magic AI."},"color-text-magic-secondary":{value:"rgba(113, 38, 255, 1)",description:"Use for text suggested by magic AI with a secondary level of prominence."},"color-text-magic-on-bg-fill":{value:"rgba(253, 253, 255, 1)",description:"Use for text and icons on bg-fill-magic."},"color-text-inverse":{value:On,description:"Use for text on an inverse background."},"color-text-inverse-secondary":{value:Dn,description:"Use for secondary text on an inverse background."},"color-text-link-inverse":{value:"rgba(197, 208, 255, 1)",description:"Use for text links on an inverse background."},"color-border":{value:On,description:"The default color for borders on any element."},"color-border-hover":{value:kn,description:"The hover color for borders on any element."},"color-border-disabled":{value:Nn,description:"The disabled color for borders on any element."},"color-border-secondary":{value:Nn,description:"The color for hr elements or any visual dividers."},"color-border-tertiary":{value:kn,description:"The border color on any element. Pair with bg-surface-tertiary or bg-fill-tertiary."},"color-border-focus":{value:Zn,description:"The focus ring for any interactive element in a focused state."},"color-border-brand":{value:On,description:"Use for borders paired with brand colors."},"color-border-info":{value:Hn,description:"Use for borders communicating information."},"color-border-success":{value:tr,description:"Use for borders communicating success."},"color-border-caution":{value:pr,description:"Use for borders communicating caution."},"color-border-warning":{value:"rgba(255, 200, 121, 1)",description:"Use for borders communicating warning."},"color-border-critical":{value:"rgba(254, 195, 193, 1)",description:"Use for borders communicating critical information."},"color-border-critical-secondary":{value:hr,description:"Use for borders communicating critical information, such as borders on invalid text fields."},"color-border-emphasis":{value:Zn,description:"Use for borders indicating areas of focus."},"color-border-emphasis-hover":{value:Qn,description:"The hover state color for borders indicating areas of focus."},"color-border-emphasis-active":{value:$n,description:"The active state (on press) color for borders indicating areas of focus."},"color-border-magic":{value:cr,description:"Use for borders suggested by magic AI."},"color-border-magic-secondary":{value:lr,description:"Use for borders suggested by magic AI, such as borders on text fields."},"color-border-magic-secondary-hover":{value:dr,description:"Use for borders suggested by magic AI, such as borders on text fields."},"color-border-inverse":{value:Ln,description:"Use for borders on an inverse background, such as borders on the global search."},"color-border-inverse-hover":{value:kn,description:"The hover state color for borders on an inverse background."},"color-border-inverse-active":{value:On,description:"The active state (on press) color for borders on an inverse background."},"color-tooltip-tail-down-border-experimental":{value:Pn,description:"The border color for tooltip tails pointing down."},"color-tooltip-tail-up-border-experimental":{value:On,description:"The border color for tooltip tails pointing up."},"color-border-gradient-experimental":{value:"linear-gradient(to bottom, "+Nn+", "+kn+" 78%, "+Dn+")"},"color-border-gradient-hover-experimental":{value:"linear-gradient(to bottom, "+Nn+", "+kn+" 78%, "+Dn+")"},"color-border-gradient-selected-experimental":{value:"linear-gradient(to bottom, "+Nn+", "+kn+" 78%, "+Dn+")"},"color-border-gradient-active-experimental":{value:"linear-gradient(to bottom, "+Nn+", "+kn+" 78%, "+Dn+")"},"color-icon":{value:Mn,description:"The default color for icons."},"color-icon-hover":{value:Un,description:"The hover state color for icons."},"color-icon-active":{value:Fn,description:"The active state (on press) color for icons."},"color-icon-disabled":{value:kn,description:"The disabled state color for icons."},"color-icon-secondary":{value:xn,description:"Use for secondary icons."},"color-icon-secondary-hover":{value:Ln,description:"The hover state color for secondary icons."},"color-icon-secondary-active":{value:Mn,description:"The active state (on press) color for secondary icons."},"color-icon-brand":{value:Fn,description:"Use for icons that need to pull more focus."},"color-icon-info":{value:Kn,description:"Use for icons communicating information."},"color-icon-success":{value:nr,description:"Use for icons communicating success."},"color-icon-caution":{value:"rgba(153, 138, 0, 1)",description:"Use for icons communicating caution."},"color-icon-warning":{value:ir,description:"Use for icons communicating warning."},"color-icon-critical":{value:"rgba(239, 77, 47, 1)",description:"Use for icons communicating critical information."},"color-icon-emphasis":{value:Zn,description:"Use for icons indicating areas of focus in editors, like the theme editor."},"color-icon-emphasis-hover":{value:Qn,description:"The hover color for icons indicating areas of focus in editors."},"color-icon-emphasis-active":{value:$n,description:"The active state (on press) color for icons indicating areas of focus in editors."},"color-icon-magic":{value:dr,description:"Use for icons suggested by magic AI."},"color-icon-inverse":{value:On,description:"Use for icons on an inverse background."},"color-avatar-bg-fill":{value:Dn},"color-avatar-five-bg-fill":{value:"rgba(253, 75, 146, 1)"},"color-avatar-five-text-on-bg-fill":{value:"rgba(255, 246, 248, 1)"},"color-avatar-four-bg-fill":{value:zn},"color-avatar-four-text-on-bg-fill":{value:Xn},"color-avatar-one-bg-fill":{value:"rgba(197, 48, 197, 1)"},"color-avatar-one-text-on-bg-fill":{value:"rgba(253, 239, 253, 1)"},"color-avatar-seven-bg-fill":{value:lr},"color-avatar-seven-text-on-bg-fill":{value:ar},"color-avatar-six-bg-fill":{value:"rgba(37, 232, 43, 1)"},"color-avatar-six-text-on-bg-fill":{value:"rgba(3, 61, 5, 1)"},"color-avatar-text-on-bg-fill":{value:Tn},"color-avatar-three-bg-fill":{value:"rgba(44, 224, 212, 1)"},"color-avatar-three-text-on-bg-fill":{value:"rgba(3, 60, 57, 1)"},"color-avatar-two-bg-fill":{value:"rgba(56, 250, 163, 1)"},"color-avatar-two-text-on-bg-fill":{value:rr},"color-backdrop-bg":{value:br},"color-button-gradient-bg-fill":{value:"linear-gradient(180deg, rgba(48, 48, 48, 0) 63.53%, rgba(255, 255, 255, 0.15) 100%)"},"color-checkbox-bg-surface-disabled":{value:_r},"color-checkbox-icon-disabled":{value:Tn},"color-input-bg-surface":{value:Cn},"color-input-bg-surface-hover":{value:wn},"color-input-bg-surface-active":{value:Rn},"color-input-border":{value:xn},"color-input-border-hover":{value:Ln},"color-input-border-active":{value:Fn},"color-nav-bg":{value:Nn},"color-nav-bg-surface":{value:fr},"color-nav-bg-surface-hover":{value:In},"color-nav-bg-surface-active":{value:wn},"color-nav-bg-surface-selected":{value:wn},"color-radio-button-bg-surface-disabled":{value:_r},"color-radio-button-icon-disabled":{value:Tn},"color-video-thumbnail-play-button-bg-fill-hover":{value:"rgba(0, 0, 0, 0.81)"},"color-video-thumbnail-play-button-bg-fill":{value:br},"color-video-thumbnail-play-button-text-on-bg-fill":{value:Tn},"color-scrollbar-thumb-bg-hover":{value:xn}},Rr={"font-family-sans":{value:"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif"},"font-family-mono":{value:"ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace"},"font-size-275":{value:tn},"font-size-300":{value:nn},"font-size-325":{value:rn},"font-size-350":{value:on},"font-size-400":{value:an},"font-size-450":{value:sn},"font-size-500":{value:cn},"font-size-550":{value:ln},"font-size-600":{value:dn},"font-size-750":{value:hn},"font-size-800":{value:pn},"font-size-900":{value:mn},"font-size-1000":{value:fn},"font-weight-regular":{value:"450"},"font-weight-medium":{value:"550"},"font-weight-semibold":{value:"650"},"font-weight-bold":{value:"700"},"font-letter-spacing-densest":{value:"-0.54px"},"font-letter-spacing-denser":{value:"-0.3px"},"font-letter-spacing-dense":{value:"-0.2px"},"font-letter-spacing-normal":{value:"0px"},"font-line-height-300":{value:nn},"font-line-height-400":{value:an},"font-line-height-500":{value:cn},"font-line-height-600":{value:dn},"font-line-height-700":{value:un},"font-line-height-800":{value:pn},"font-line-height-1000":{value:fn},"font-line-height-1200":{value:gn}},Ar={"height-0":{value:qt},"height-025":{value:Jt},"height-050":{value:Zt},"height-100":{value:Qt},"height-150":{value:$t},"height-200":{value:en},"height-300":{value:nn},"height-400":{value:an},"height-500":{value:cn},"height-600":{value:dn},"height-700":{value:un},"height-800":{value:pn},"height-900":{value:mn},"height-1000":{value:fn},"height-1200":{value:gn},"height-1600":{value:_n},"height-2000":{value:vn},"height-2400":{value:bn},"height-2800":{value:En},"height-3200":{value:yn}},Ir={"space-0":{value:qt},"space-025":{value:Jt},"space-050":{value:Zt},"space-100":{value:Qt},"space-150":{value:$t},"space-200":{value:en},"space-300":{value:nn},"space-400":{value:an},"space-500":{value:cn},"space-600":{value:dn},"space-800":{value:pn},"space-1000":{value:fn},"space-1200":{value:gn},"space-1600":{value:_n},"space-2000":{value:vn},"space-2400":{value:bn},"space-2800":{value:En},"space-3200":{value:yn},"space-button-group-gap":{value:Nr("space-200")},"space-card-gap":{value:Nr("space-400")},"space-card-padding":{value:Nr("space-400")},"space-table-cell-padding":{value:Nr("space-150")}};function Nr(e){return"var("+Bt(e)+")"}var Or,Pr={"text-heading-3xl-font-family":{value:Wt("font-family-sans")},"text-heading-3xl-font-size":{value:Wt("font-size-900")},"text-heading-3xl-font-weight":{value:Wt("font-weight-bold")},"text-heading-3xl-font-letter-spacing":{value:Wt("font-letter-spacing-densest")},"text-heading-3xl-font-line-height":{value:Wt("font-line-height-1200")},"text-heading-2xl-font-family":{value:Wt("font-family-sans")},"text-heading-2xl-font-size":{value:Wt("font-size-750")},"text-heading-2xl-font-weight":{value:Wt("font-weight-bold")},"text-heading-2xl-font-letter-spacing":{value:Wt("font-letter-spacing-denser")},"text-heading-2xl-font-line-height":{value:Wt("font-line-height-1000")},"text-heading-xl-font-family":{value:Wt("font-family-sans")},"text-heading-xl-font-size":{value:Wt("font-size-600")},"text-heading-xl-font-weight":{value:Wt("font-weight-bold")},"text-heading-xl-font-letter-spacing":{value:Wt("font-letter-spacing-dense")},"text-heading-xl-font-line-height":{value:Wt("font-line-height-800")},"text-heading-lg-font-family":{value:Wt("font-family-sans")},"text-heading-lg-font-size":{value:Wt("font-size-500")},"text-heading-lg-font-weight":{value:Wt("font-weight-semibold")},"text-heading-lg-font-letter-spacing":{value:Wt("font-letter-spacing-dense")},"text-heading-lg-font-line-height":{value:Wt("font-line-height-600")},"text-heading-md-font-family":{value:Wt("font-family-sans")},"text-heading-md-font-size":{value:Wt("font-size-350")},"text-heading-md-font-weight":{value:Wt("font-weight-semibold")},"text-heading-md-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-heading-md-font-line-height":{value:Wt("font-line-height-500")},"text-heading-sm-font-family":{value:Wt("font-family-sans")},"text-heading-sm-font-size":{value:Wt("font-size-325")},"text-heading-sm-font-weight":{value:Wt("font-weight-semibold")},"text-heading-sm-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-heading-sm-font-line-height":{value:Wt("font-line-height-500")},"text-heading-xs-font-family":{value:Wt("font-family-sans")},"text-heading-xs-font-size":{value:Wt("font-size-300")},"text-heading-xs-font-weight":{value:Wt("font-weight-semibold")},"text-heading-xs-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-heading-xs-font-line-height":{value:Wt("font-line-height-400")},"text-body-lg-font-family":{value:Wt("font-family-sans")},"text-body-lg-font-size":{value:Wt("font-size-350")},"text-body-lg-font-weight":{value:Wt("font-weight-regular")},"text-body-lg-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-body-lg-font-line-height":{value:Wt("font-line-height-500")},"text-body-md-font-family":{value:Wt("font-family-sans")},"text-body-md-font-size":{value:Wt("font-size-325")},"text-body-md-font-weight":{value:Wt("font-weight-regular")},"text-body-md-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-body-md-font-line-height":{value:Wt("font-line-height-500")},"text-body-sm-font-family":{value:Wt("font-family-sans")},"text-body-sm-font-size":{value:Wt("font-size-300")},"text-body-sm-font-weight":{value:Wt("font-weight-regular")},"text-body-sm-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-body-sm-font-line-height":{value:Wt("font-line-height-400")},"text-body-xs-font-family":{value:Wt("font-family-sans")},"text-body-xs-font-size":{value:Wt("font-size-275")},"text-body-xs-font-weight":{value:Wt("font-weight-regular")},"text-body-xs-font-letter-spacing":{value:Wt("font-letter-spacing-normal")},"text-body-xs-font-line-height":{value:Wt("font-line-height-300")}},kr=(Or={border:Sn,breakpoints:{"breakpoints-xs":{value:"0px",description:"Commonly used for sizing containers (e.g. max-width). See below for media query usage."},"breakpoints-sm":{value:"490px",description:"Commonly used for sizing containers (e.g. max-width). See below for media query usage."},"breakpoints-md":{value:"768px",description:"Commonly used for sizing containers (e.g. max-width). See below for media query usage."},"breakpoints-lg":{value:"1040px",description:"Commonly used for sizing containers (e.g. max-width). See below for media query usage."},"breakpoints-xl":{value:"1440px",description:"Commonly used for sizing containers (e.g. max-width). See below for media query usage."}},color:wr,font:Rr,height:Ar,motion:{"motion-duration-0":{value:"0ms"},"motion-duration-50":{value:"50ms"},"motion-duration-100":{value:"100ms"},"motion-duration-150":{value:"150ms"},"motion-duration-200":{value:"200ms"},"motion-duration-250":{value:"250ms"},"motion-duration-300":{value:"300ms"},"motion-duration-350":{value:"350ms"},"motion-duration-400":{value:"400ms"},"motion-duration-450":{value:"450ms"},"motion-duration-500":{value:"500ms"},"motion-duration-5000":{value:"5000ms"},"motion-ease":{value:"cubic-bezier(0.25, 0.1, 0.25, 1)",description:"Responds quickly and finishes with control. A great default for any user interaction."},"motion-ease-in":{value:"cubic-bezier(0.42, 0, 1, 1)",description:"Starts slowly and finishes at top speed. Use sparingly."},"motion-ease-out":{value:"cubic-bezier(0.19, 0.91, 0.38, 1)",description:"Starts at top speed and finishes slowly. Use sparingly."},"motion-ease-in-out":{value:"cubic-bezier(0.42, 0, 0.58, 1)",description:"Starts and finishes with equal speed. A good default for transitions triggered by the system."},"motion-linear":{value:"cubic-bezier(0, 0, 1, 1)",description:"Moves with constant speed. Use for continuous and mechanical animations, such as rotating spinners."},"motion-keyframes-bounce":{value:"{ from, 65%, 85% { transform: scale(1) } 75% { transform: scale(0.85) } 82.5% { transform: scale(1.05) } }"},"motion-keyframes-fade-in":{value:"{ to { opacity: 1 } }"},"motion-keyframes-pulse":{value:"{ from, 75% { transform: scale(0.85); opacity: 1; } to { transform: scale(2.5); opacity: 0; } }"},"motion-keyframes-spin":{value:"{ to { transform: rotate(1turn) } }"},"motion-keyframes-appear-above":{value:"{ from { transform: translateY(var(--p-space-100)); opacity: 0; } to { transform: none; opacity: 1; } }"},"motion-keyframes-appear-below":{value:"{ from { transform: translateY(calc(var(--p-space-100) * -1)); opacity: 0; } to { transform: none; opacity: 1; } }"}},shadow:{"shadow-0":{value:"none"},"shadow-100":{value:"0px 1px 0px 0px rgba(26, 26, 26, 0.07)"},"shadow-200":{value:"0px 3px 1px -1px rgba(26, 26, 26, 0.07)"},"shadow-300":{value:"0px 4px 6px -2px rgba(26, 26, 26, 0.20)"},"shadow-400":{value:"0px 8px 16px -4px rgba(26, 26, 26, 0.22)"},"shadow-500":{value:"0px 12px 20px -8px rgba(26, 26, 26, 0.24)"},"shadow-600":{value:"0px 20px 20px -8px rgba(26, 26, 26, 0.28)"},"shadow-bevel-100":{value:"1px 0px 0px 0px rgba(0, 0, 0, 0.13) inset, -1px 0px 0px 0px rgba(0, 0, 0, 0.13) inset, 0px -1px 0px 0px rgba(0, 0, 0, 0.17) inset, 0px 1px 0px 0px rgba(204, 204, 204, 0.5) inset"},"shadow-inset-100":{value:"0px 1px 2px 0px rgba(26, 26, 26, 0.15) inset, 0px 1px 1px 0px rgba(26, 26, 26, 0.15) inset"},"shadow-inset-200":{value:"0px 2px 1px 0px rgba(26, 26, 26, 0.20) inset, 1px 0px 1px 0px rgba(26, 26, 26, 0.12) inset, -1px 0px 1px 0px rgba(26, 26, 26, 0.12) inset"},"shadow-button":{value:"0px -1px 0px 0px #b5b5b5 inset, 0px 0px 0px 1px rgba(0, 0, 0, 0.1) inset, 0px 0.5px 0px 1.5px #FFF inset"},"shadow-button-hover":{value:"0px 1px 0px 0px #EBEBEB inset, -1px 0px 0px 0px #EBEBEB inset, 1px 0px 0px 0px #EBEBEB inset, 0px -1px 0px 0px #CCC inset"},"shadow-button-inset":{value:"-1px 0px 1px 0px rgba(26, 26, 26, 0.122) inset, 1px 0px 1px 0px rgba(26, 26, 26, 0.122) inset, 0px 2px 1px 0px rgba(26, 26, 26, 0.2) inset"},"shadow-button-primary":{value:"0px -1px 0px 1px rgba(0, 0, 0, 0.8) inset, 0px 0px 0px 1px rgba(48, 48, 48, 1) inset, 0px 0.5px 0px 1.5px rgba(255, 255, 255, 0.25) inset;"},"shadow-button-primary-hover":{value:"0px 1px 0px 0px rgba(255, 255, 255, 0.24) inset, 1px 0px 0px 0px rgba(255, 255, 255, 0.20) inset, -1px 0px 0px 0px rgba(255, 255, 255, 0.20) inset, 0px -1px 0px 0px #000 inset, 0px -1px 0px 1px #1A1A1A"},"shadow-button-primary-inset":{value:"0px 3px 0px 0px rgb(0, 0, 0) inset"},"shadow-button-primary-critical":{value:"0px -1px 0px 1px rgba(142, 31, 11, 0.8) inset, 0px 0px 0px 1px rgba(181, 38, 11, 0.8) inset, 0px 0.5px 0px 1.5px rgba(255, 255, 255, 0.349) inset"},"shadow-button-primary-critical-hover":{value:"0px 1px 0px 0px rgba(255, 255, 255, 0.48) inset, 1px 0px 0px 0px rgba(255, 255, 255, 0.20) inset, -1px 0px 0px 0px rgba(255, 255, 255, 0.20) inset, 0px -1.5px 0px 0px rgba(0, 0, 0, 0.25) inset"},"shadow-button-primary-critical-inset":{value:"-1px 0px 1px 0px rgba(0, 0, 0, 0.2) inset, 1px 0px 1px 0px rgba(0, 0, 0, 0.2) inset, 0px 2px 0px 0px rgba(0, 0, 0, 0.6) inset"},"shadow-button-primary-success":{value:"0px -1px 0px 1px rgba(12, 81, 50, 0.8) inset, 0px 0px 0px 1px rgba(19, 111, 69, 0.8) inset, 0px 0.5px 0px 1.5px rgba(255, 255, 255, 0.251) inset"},"shadow-button-primary-success-hover":{value:"0px 1px 0px 0px rgba(255, 255, 255, 0.48) inset, 1px 0px 0px 0px rgba(255, 255, 255, 0.20) inset, -1px 0px 0px 0px rgba(255, 255, 255, 0.20) inset, 0px -1.5px 0px 0px rgba(0, 0, 0, 0.25) inset"},"shadow-button-primary-success-inset":{value:"-1px 0px 1px 0px rgba(0, 0, 0, 0.2) inset, 1px 0px 1px 0px rgba(0, 0, 0, 0.2) inset, 0px 2px 0px 0px rgba(0, 0, 0, 0.6) inset"},"shadow-border-inset":{value:"0px 0px 0px 1px rgba(0, 0, 0, 0.08) inset"}},space:Ir,text:Pr,width:{"width-0":{value:qt},"width-025":{value:Jt},"width-050":{value:Zt},"width-100":{value:Qt},"width-150":{value:$t},"width-200":{value:en},"width-300":{value:nn},"width-400":{value:an},"width-500":{value:cn},"width-600":{value:dn},"width-700":{value:un},"width-800":{value:pn},"width-900":{value:mn},"width-1000":{value:fn},"width-1200":{value:gn},"width-1600":{value:_n},"width-2000":{value:vn},"width-2400":{value:bn},"width-2800":{value:En},"width-3200":{value:yn}},zIndex:{"z-index-0":{value:"auto"},"z-index-1":{value:"100"},"z-index-2":{value:"400"},"z-index-3":{value:"510"},"z-index-4":{value:"512"},"z-index-5":{value:"513"},"z-index-6":{value:"514"},"z-index-7":{value:"515"},"z-index-8":{value:"516"},"z-index-9":{value:"517"},"z-index-10":{value:"518"},"z-index-11":{value:"519"},"z-index-12":{value:"520"}}},Object.fromEntries(Object.entries(Or).map(function(e){var t=At(e,2),n=t[0],r=t[1];return[n,Kt.includes(n)?Vt(r):r]})));function Dr(e){return Object.fromEntries(Object.entries(e).map(function(e){var t=At(e,2),n=t[0],r=t[1];return[n,r&&Kt.includes(n)?Vt(r):r]}))}function xr(e){return Yt(kr,e)}function Lr(e){return"p-theme-"+e}function Mr(e){var t=new Set(Ht(e));return function(e){return t.has(e)}}Mr(kr);var Ur="light",Fr=Ur,jr=[Ur,"light-mobile","light-high-contrast-experimental","dark-experimental"],Vr=Dr({}),Br=(xr(Vr),Dr({color:{"color-text":{value:Fn},"color-text-secondary":{value:Fn},"color-text-brand":{value:Fn},"color-icon-secondary":{value:Mn},"color-border":{value:xn},"color-input-border":{value:Mn},"color-border-secondary":{value:xn},"color-bg-surface-secondary":{value:In}},shadow:{"shadow-bevel-100":{value:"0px 1px 0px 0px rgba(26, 26, 26, 0.07), 0px 1px 0px 0px rgba(208, 208, 208, 0.40) inset, 1px 0px 0px 0px #CCC inset, -1px 0px 0px 0px #CCC inset, 0px -1px 0px 0px #999 inset"}}})),Wr=(xr(Br),"0 0 0 "+Wt("border-width-025")+" "+Wt("color-border")+" inset"),Hr=Dr({color:{"color-button-gradient-bg-fill":{value:"none"}},shadow:{"shadow-100":{value:"none"},"shadow-bevel-100":{value:"none"},"shadow-button":{value:Wr},"shadow-button-hover":{value:Wr},"shadow-button-inset":{value:Wr},"shadow-button-primary":{value:"none"},"shadow-button-primary-hover":{value:"none"},"shadow-button-primary-inset":{value:"none"},"shadow-button-primary-critical":{value:"none"},"shadow-button-primary-critical-hover":{value:"none"},"shadow-button-primary-critical-inset":{value:"none"},"shadow-button-primary-success":{value:"none"},"shadow-button-primary-success-hover":{value:"none"},"shadow-button-primary-success-inset":{value:"none"}},space:{"space-card-gap":{value:Wt("space-200")}},text:{"text-heading-2xl-font-size":{value:Wt("font-size-800")},"text-heading-xl-font-size":{value:Wt("font-size-550")},"text-heading-xl-font-line-height":{value:Wt("font-line-height-700")},"text-heading-lg-font-size":{value:Wt("font-size-450")},"text-heading-md-font-size":{value:Wt("font-size-400")},"text-heading-sm-font-size":{value:Wt("font-size-350")},"text-body-lg-font-size":{value:Wt("font-size-450")},"text-body-lg-font-line-height":{value:Wt("font-line-height-700")},"text-body-md-font-size":{value:Wt("font-size-400")},"text-body-md-font-line-height":{value:Wt("font-line-height-600")},"text-body-sm-font-size":{value:Wt("font-size-350")},"text-body-sm-font-line-height":{value:Wt("font-line-height-500")},"text-body-xs-font-size":{value:Wt("font-size-300")},"text-body-xs-font-line-height":{value:Wt("font-line-height-400")}}}),Gr=(xr(Hr),Dr({color:{"color-scheme":{value:"dark"},"color-bg":{value:Fn},"color-bg-surface":{value:Un},"color-bg-fill":{value:Un},"color-icon":{value:On},"color-icon-secondary":{value:xn},"color-text":{value:On},"color-text-secondary":{value:Dn},"color-bg-surface-secondary-active":{value:Ln},"color-bg-surface-secondary-hover":{value:Mn},"color-bg-fill-transparent":{value:yr},"color-bg-fill-brand":{value:Tn},"color-text-brand-on-bg-fill":{value:Un},"color-bg-surface-hover":{value:Mn},"color-bg-fill-hover":{value:Mn},"color-bg-fill-transparent-hover":{value:Sr},"color-bg-fill-brand-hover":{value:An},"color-bg-surface-selected":{value:Ln},"color-bg-fill-selected":{value:Ln},"color-bg-fill-transparent-selected":{value:Cr},"color-bg-fill-brand-selected":{value:Pn},"color-bg-surface-active":{value:Ln},"color-bg-fill-active":{value:Ln},"color-bg-fill-transparent-active":{value:Tr},"color-bg-fill-brand-active":{value:Rn},"color-bg-surface-brand-selected":{value:Mn},"color-border-secondary":{value:Ln},"color-tooltip-tail-down-border-experimental":{value:"rgba(60, 60, 60, 1)"},"color-tooltip-tail-up-border-experimental":{value:"rgba(71, 71, 71, 1)"},"color-border-gradient-experimental":{value:"linear-gradient(to bottom, "+Sr+", "+Er+")"},"color-border-gradient-hover-experimental":{value:"linear-gradient(to bottom, "+Sr+", "+Er+")"},"color-border-gradient-selected-experimental":{value:"linear-gradient(to bottom, "+vr+", "+Tr+")"},"color-border-gradient-active-experimental":{value:"linear-gradient(to bottom, "+Tr+", "+Er+")"}},shadow:{"shadow-bevel-100":{value:"1px 0px 0px 0px rgba(204, 204, 204, 0.08) inset, -1px 0px 0px 0px rgba(204, 204, 204, 0.08) inset, 0px -1px 0px 0px rgba(204, 204, 204, 0.08) inset, 0px 1px 0px 0px rgba(204, 204, 204, 0.16) inset"}}})),zr=(xr(Gr),xr({light:Vr,"light-mobile":Hr,"light-high-contrast-experimental":Br,"dark-experimental":Gr}[Fr]),{light:{border:{"border-radius-0":"0rem","border-radius-050":"0.125rem","border-radius-100":"0.25rem","border-radius-150":"0.375rem","border-radius-200":"0.5rem","border-radius-300":"0.75rem","border-radius-400":"1rem","border-radius-500":"1.25rem","border-radius-750":"1.875rem","border-radius-full":"624.9375rem","border-width-0":"0rem","border-width-0165":"0.04125rem","border-width-025":"0.0625rem","border-width-050":"0.125rem","border-width-100":"0.25rem"},breakpoints:{"breakpoints-xs":"0rem","breakpoints-sm":"30.625rem","breakpoints-md":"48rem","breakpoints-lg":"65rem","breakpoints-xl":"90rem"},color:{"color-scheme":"light","color-bg":"rgba(241, 241, 241, 1)","color-bg-inverse":"rgba(26, 26, 26, 1)","color-bg-surface":"rgba(255, 255, 255, 1)","color-bg-surface-hover":"rgba(247, 247, 247, 1)","color-bg-surface-active":"rgba(243, 243, 243, 1)","color-bg-surface-selected":"rgba(241, 241, 241, 1)","color-bg-surface-disabled":"rgba(0, 0, 0, 0.05)","color-bg-surface-secondary":"rgba(247, 247, 247, 1)","color-bg-surface-secondary-hover":"rgba(241, 241, 241, 1)","color-bg-surface-secondary-active":"rgba(235, 235, 235, 1)","color-bg-surface-secondary-selected":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary":"rgba(243, 243, 243, 1)","color-bg-surface-tertiary-hover":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary-active":"rgba(227, 227, 227, 1)","color-bg-surface-brand":"rgba(227, 227, 227, 1)","color-bg-surface-brand-hover":"rgba(235, 235, 235, 1)","color-bg-surface-brand-active":"rgba(241, 241, 241, 1)","color-bg-surface-brand-selected":"rgba(241, 241, 241, 1)","color-bg-surface-info":"rgba(234, 244, 255, 1)","color-bg-surface-info-hover":"rgba(224, 240, 255, 1)","color-bg-surface-info-active":"rgba(202, 230, 255, 1)","color-bg-surface-success":"rgba(205, 254, 225, 1)","color-bg-surface-success-hover":"rgba(180, 254, 210, 1)","color-bg-surface-success-active":"rgba(146, 254, 194, 1)","color-bg-surface-caution":"rgba(255, 248, 219, 1)","color-bg-surface-caution-hover":"rgba(255, 244, 191, 1)","color-bg-surface-caution-active":"rgba(255, 239, 157, 1)","color-bg-surface-warning":"rgba(255, 241, 227, 1)","color-bg-surface-warning-hover":"rgba(255, 235, 213, 1)","color-bg-surface-warning-active":"rgba(255, 228, 198, 1)","color-bg-surface-critical":"rgba(254, 233, 232, 1)","color-bg-surface-critical-hover":"rgba(254, 226, 225, 1)","color-bg-surface-critical-active":"rgba(254, 218, 217, 1)","color-bg-surface-emphasis":"rgba(240, 242, 255, 1)","color-bg-surface-emphasis-hover":"rgba(234, 237, 255, 1)","color-bg-surface-emphasis-active":"rgba(226, 231, 255, 1)","color-bg-surface-magic":"rgba(248, 247, 255, 1)","color-bg-surface-magic-hover":"rgba(243, 241, 255, 1)","color-bg-surface-magic-active":"rgba(233, 229, 255, 1)","color-bg-surface-inverse":"rgba(48, 48, 48, 1)","color-bg-surface-transparent":"rgba(0, 0, 0, 0)","color-bg-fill":"rgba(255, 255, 255, 1)","color-bg-fill-hover":"rgba(250, 250, 250, 1)","color-bg-fill-active":"rgba(247, 247, 247, 1)","color-bg-fill-selected":"rgba(204, 204, 204, 1)","color-bg-fill-disabled":"rgba(0, 0, 0, 0.05)","color-bg-fill-secondary":"rgba(241, 241, 241, 1)","color-bg-fill-secondary-hover":"rgba(235, 235, 235, 1)","color-bg-fill-secondary-active":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary-hover":"rgba(212, 212, 212, 1)","color-bg-fill-tertiary-active":"rgba(204, 204, 204, 1)","color-bg-fill-brand":"rgba(48, 48, 48, 1)","color-bg-fill-brand-hover":"rgba(26, 26, 26, 1)","color-bg-fill-brand-active":"rgba(26, 26, 26, 1)","color-bg-fill-brand-selected":"rgba(48, 48, 48, 1)","color-bg-fill-brand-disabled":"rgba(0, 0, 0, 0.17)","color-bg-fill-info":"rgba(145, 208, 255, 1)","color-bg-fill-info-hover":"rgba(81, 192, 255, 1)","color-bg-fill-info-active":"rgba(0, 148, 213, 1)","color-bg-fill-info-secondary":"rgba(213, 235, 255, 1)","color-bg-fill-success":"rgba(41, 132, 90, 1)","color-bg-fill-success-hover":"rgba(19, 111, 69, 1)","color-bg-fill-success-active":"rgba(12, 81, 50, 1)","color-bg-fill-success-secondary":"rgba(180, 254, 210, 1)","color-bg-fill-warning":"rgba(255, 184, 0, 1)","color-bg-fill-warning-hover":"rgba(229, 165, 0, 1)","color-bg-fill-warning-active":"rgba(178, 132, 0, 1)","color-bg-fill-warning-secondary":"rgba(255, 214, 164, 1)","color-bg-fill-caution":"rgba(255, 230, 0, 1)","color-bg-fill-caution-hover":"rgba(234, 211, 0, 1)","color-bg-fill-caution-active":"rgba(225, 203, 0, 1)","color-bg-fill-caution-secondary":"rgba(255, 235, 120, 1)","color-bg-fill-critical":"rgba(229, 28, 0, 1)","color-bg-fill-critical-hover":"rgba(181, 38, 11, 1)","color-bg-fill-critical-active":"rgba(142, 31, 11, 1)","color-bg-fill-critical-selected":"rgba(142, 31, 11, 1)","color-bg-fill-critical-secondary":"rgba(254, 211, 209, 1)","color-bg-fill-emphasis":"rgba(0, 91, 211, 1)","color-bg-fill-emphasis-hover":"rgba(0, 66, 153, 1)","color-bg-fill-emphasis-active":"rgba(0, 46, 106, 1)","color-bg-fill-magic":"rgba(128, 81, 255, 1)","color-bg-fill-magic-secondary":"rgba(233, 229, 255, 1)","color-bg-fill-magic-secondary-hover":"rgba(228, 222, 255, 1)","color-bg-fill-magic-secondary-active":"rgba(223, 217, 255, 1)","color-bg-fill-inverse":"rgba(48, 48, 48, 1)","color-bg-fill-inverse-hover":"rgba(74, 74, 74, 1)","color-bg-fill-inverse-active":"rgba(97, 97, 97, 1)","color-bg-fill-transparent":"rgba(0, 0, 0, 0.02)","color-bg-fill-transparent-hover":"rgba(0, 0, 0, 0.05)","color-bg-fill-transparent-active":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-selected":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary":"rgba(0, 0, 0, 0.06)","color-bg-fill-transparent-secondary-hover":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary-active":"rgba(0, 0, 0, 0.11)","color-text":"rgba(48, 48, 48, 1)","color-text-secondary":"rgba(97, 97, 97, 1)","color-text-disabled":"rgba(181, 181, 181, 1)","color-text-link":"rgba(0, 91, 211, 1)","color-text-link-hover":"rgba(0, 66, 153, 1)","color-text-link-active":"rgba(0, 46, 106, 1)","color-text-brand":"rgba(74, 74, 74, 1)","color-text-brand-hover":"rgba(48, 48, 48, 1)","color-text-brand-on-bg-fill":"rgba(255, 255, 255, 1)","color-text-brand-on-bg-fill-hover":"rgba(227, 227, 227, 1)","color-text-brand-on-bg-fill-active":"rgba(204, 204, 204, 1)","color-text-brand-on-bg-fill-disabled":"rgba(255, 255, 255, 1)","color-text-info":"rgba(0, 58, 90, 1)","color-text-info-hover":"rgba(0, 58, 90, 1)","color-text-info-active":"rgba(0, 33, 51, 1)","color-text-info-secondary":"rgba(0, 124, 180, 1)","color-text-info-on-bg-fill":"rgba(0, 33, 51, 1)","color-text-success":"rgba(12, 81, 50, 1)","color-text-success-hover":"rgba(8, 61, 37, 1)","color-text-success-active":"rgba(9, 42, 27, 1)","color-text-success-secondary":"rgba(41, 132, 90, 1)","color-text-success-on-bg-fill":"rgba(248, 255, 251, 1)","color-text-caution":"rgba(79, 71, 0, 1)","color-text-caution-hover":"rgba(51, 46, 0, 1)","color-text-caution-active":"rgba(31, 28, 0, 1)","color-text-caution-secondary":"rgba(130, 117, 0, 1)","color-text-caution-on-bg-fill":"rgba(51, 46, 0, 1)","color-text-warning":"rgba(94, 66, 0, 1)","color-text-warning-hover":"rgba(65, 45, 0, 1)","color-text-warning-active":"rgba(37, 26, 0, 1)","color-text-warning-secondary":"rgba(149, 111, 0, 1)","color-text-warning-on-bg-fill":"rgba(37, 26, 0, 1)","color-text-critical":"rgba(142, 31, 11, 1)","color-text-critical-hover":"rgba(95, 21, 7, 1)","color-text-critical-active":"rgba(47, 10, 4, 1)","color-text-critical-secondary":"rgba(229, 28, 0, 1)","color-text-critical-on-bg-fill":"rgba(255, 251, 251, 1)","color-text-emphasis":"rgba(0, 91, 211, 1)","color-text-emphasis-hover":"rgba(0, 66, 153, 1)","color-text-emphasis-active":"rgba(0, 46, 106, 1)","color-text-emphasis-on-bg-fill":"rgba(252, 253, 255, 1)","color-text-emphasis-on-bg-fill-hover":"rgba(226, 231, 255, 1)","color-text-emphasis-on-bg-fill-active":"rgba(213, 220, 255, 1)","color-text-magic":"rgba(87, 0, 209, 1)","color-text-magic-secondary":"rgba(113, 38, 255, 1)","color-text-magic-on-bg-fill":"rgba(253, 253, 255, 1)","color-text-inverse":"rgba(227, 227, 227, 1)","color-text-inverse-secondary":"rgba(181, 181, 181, 1)","color-text-link-inverse":"rgba(197, 208, 255, 1)","color-border":"rgba(227, 227, 227, 1)","color-border-hover":"rgba(204, 204, 204, 1)","color-border-disabled":"rgba(235, 235, 235, 1)","color-border-secondary":"rgba(235, 235, 235, 1)","color-border-tertiary":"rgba(204, 204, 204, 1)","color-border-focus":"rgba(0, 91, 211, 1)","color-border-brand":"rgba(227, 227, 227, 1)","color-border-info":"rgba(168, 216, 255, 1)","color-border-success":"rgba(146, 254, 194, 1)","color-border-caution":"rgba(255, 235, 120, 1)","color-border-warning":"rgba(255, 200, 121, 1)","color-border-critical":"rgba(254, 195, 193, 1)","color-border-critical-secondary":"rgba(142, 31, 11, 1)","color-border-emphasis":"rgba(0, 91, 211, 1)","color-border-emphasis-hover":"rgba(0, 66, 153, 1)","color-border-emphasis-active":"rgba(0, 46, 106, 1)","color-border-magic":"rgba(228, 222, 255, 1)","color-border-magic-secondary":"rgba(148, 116, 255, 1)","color-border-magic-secondary-hover":"rgba(128, 81, 255, 1)","color-border-inverse":"rgba(97, 97, 97, 1)","color-border-inverse-hover":"rgba(204, 204, 204, 1)","color-border-inverse-active":"rgba(227, 227, 227, 1)","color-tooltip-tail-down-border-experimental":"rgba(212, 212, 212, 1)","color-tooltip-tail-up-border-experimental":"rgba(227, 227, 227, 1)","color-border-gradient-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-hover-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-selected-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-active-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-icon":"rgba(74, 74, 74, 1)","color-icon-hover":"rgba(48, 48, 48, 1)","color-icon-active":"rgba(26, 26, 26, 1)","color-icon-disabled":"rgba(204, 204, 204, 1)","color-icon-secondary":"rgba(138, 138, 138, 1)","color-icon-secondary-hover":"rgba(97, 97, 97, 1)","color-icon-secondary-active":"rgba(74, 74, 74, 1)","color-icon-brand":"rgba(26, 26, 26, 1)","color-icon-info":"rgba(0, 148, 213, 1)","color-icon-success":"rgba(41, 132, 90, 1)","color-icon-caution":"rgba(153, 138, 0, 1)","color-icon-warning":"rgba(178, 132, 0, 1)","color-icon-critical":"rgba(239, 77, 47, 1)","color-icon-emphasis":"rgba(0, 91, 211, 1)","color-icon-emphasis-hover":"rgba(0, 66, 153, 1)","color-icon-emphasis-active":"rgba(0, 46, 106, 1)","color-icon-magic":"rgba(128, 81, 255, 1)","color-icon-inverse":"rgba(227, 227, 227, 1)","color-avatar-bg-fill":"rgba(181, 181, 181, 1)","color-avatar-five-bg-fill":"rgba(253, 75, 146, 1)","color-avatar-five-text-on-bg-fill":"rgba(255, 246, 248, 1)","color-avatar-four-bg-fill":"rgba(81, 192, 255, 1)","color-avatar-four-text-on-bg-fill":"rgba(0, 33, 51, 1)","color-avatar-one-bg-fill":"rgba(197, 48, 197, 1)","color-avatar-one-text-on-bg-fill":"rgba(253, 239, 253, 1)","color-avatar-seven-bg-fill":"rgba(148, 116, 255, 1)","color-avatar-seven-text-on-bg-fill":"rgba(248, 247, 255, 1)","color-avatar-six-bg-fill":"rgba(37, 232, 43, 1)","color-avatar-six-text-on-bg-fill":"rgba(3, 61, 5, 1)","color-avatar-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-avatar-three-bg-fill":"rgba(44, 224, 212, 1)","color-avatar-three-text-on-bg-fill":"rgba(3, 60, 57, 1)","color-avatar-two-bg-fill":"rgba(56, 250, 163, 1)","color-avatar-two-text-on-bg-fill":"rgba(12, 81, 50, 1)","color-backdrop-bg":"rgba(0, 0, 0, 0.71)","color-button-gradient-bg-fill":"linear-gradient(180deg, rgba(48, 48, 48, 0) 63.53%, rgba(255, 255, 255, 0.15) 100%)","color-checkbox-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-checkbox-icon-disabled":"rgba(255, 255, 255, 1)","color-input-bg-surface":"rgba(253, 253, 253, 1)","color-input-bg-surface-hover":"rgba(250, 250, 250, 1)","color-input-bg-surface-active":"rgba(247, 247, 247, 1)","color-input-border":"rgba(138, 138, 138, 1)","color-input-border-hover":"rgba(97, 97, 97, 1)","color-input-border-active":"rgba(26, 26, 26, 1)","color-nav-bg":"rgba(235, 235, 235, 1)","color-nav-bg-surface":"rgba(0, 0, 0, 0.02)","color-nav-bg-surface-hover":"rgba(241, 241, 241, 1)","color-nav-bg-surface-active":"rgba(250, 250, 250, 1)","color-nav-bg-surface-selected":"rgba(250, 250, 250, 1)","color-radio-button-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-radio-button-icon-disabled":"rgba(255, 255, 255, 1)","color-video-thumbnail-play-button-bg-fill-hover":"rgba(0, 0, 0, 0.81)","color-video-thumbnail-play-button-bg-fill":"rgba(0, 0, 0, 0.71)","color-video-thumbnail-play-button-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-scrollbar-thumb-bg-hover":"rgba(138, 138, 138, 1)"},font:{"font-family-sans":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","font-family-mono":"ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace","font-size-275":"0.6875rem","font-size-300":"0.75rem","font-size-325":"0.8125rem","font-size-350":"0.875rem","font-size-400":"1rem","font-size-450":"1.125rem","font-size-500":"1.25rem","font-size-550":"1.375rem","font-size-600":"1.5rem","font-size-750":"1.875rem","font-size-800":"2rem","font-size-900":"2.25rem","font-size-1000":"2.5rem","font-weight-regular":"450","font-weight-medium":"550","font-weight-semibold":"650","font-weight-bold":"700","font-letter-spacing-densest":"-0.03375rem","font-letter-spacing-denser":"-0.01875rem","font-letter-spacing-dense":"-0.0125rem","font-letter-spacing-normal":"0rem","font-line-height-300":"0.75rem","font-line-height-400":"1rem","font-line-height-500":"1.25rem","font-line-height-600":"1.5rem","font-line-height-700":"1.75rem","font-line-height-800":"2rem","font-line-height-1000":"2.5rem","font-line-height-1200":"3rem"},height:{"height-0":"0rem","height-025":"0.0625rem","height-050":"0.125rem","height-100":"0.25rem","height-150":"0.375rem","height-200":"0.5rem","height-300":"0.75rem","height-400":"1rem","height-500":"1.25rem","height-600":"1.5rem","height-700":"1.75rem","height-800":"2rem","height-900":"2.25rem","height-1000":"2.5rem","height-1200":"3rem","height-1600":"4rem","height-2000":"5rem","height-2400":"6rem","height-2800":"7rem","height-3200":"8rem"},motion:{"motion-duration-0":"0ms","motion-duration-50":"50ms","motion-duration-100":"100ms","motion-duration-150":"150ms","motion-duration-200":"200ms","motion-duration-250":"250ms","motion-duration-300":"300ms","motion-duration-350":"350ms","motion-duration-400":"400ms","motion-duration-450":"450ms","motion-duration-500":"500ms","motion-duration-5000":"5000ms","motion-ease":"cubic-bezier(0.25, 0.1, 0.25, 1)","motion-ease-in":"cubic-bezier(0.42, 0, 1, 1)","motion-ease-out":"cubic-bezier(0.19, 0.91, 0.38, 1)","motion-ease-in-out":"cubic-bezier(0.42, 0, 0.58, 1)","motion-linear":"cubic-bezier(0, 0, 1, 1)","motion-keyframes-bounce":"{ from, 65%, 85% { transform: scale(1) } 75% { transform: scale(0.85) } 82.5% { transform: scale(1.05) } }","motion-keyframes-fade-in":"{ to { opacity: 1 } }","motion-keyframes-pulse":"{ from, 75% { transform: scale(0.85); opacity: 1; } to { transform: scale(2.5); opacity: 0; } }","motion-keyframes-spin":"{ to { transform: rotate(1turn) } }","motion-keyframes-appear-above":"{ from { transform: translateY(var(--p-space-100)); opacity: 0; } to { transform: none; opacity: 1; } }","motion-keyframes-appear-below":"{ from { transform: translateY(calc(var(--p-space-100) * -1)); opacity: 0; } to { transform: none; opacity: 1; } }"},shadow:{"shadow-0":"none","shadow-100":"0rem 0.0625rem 0rem 0rem rgba(26, 26, 26, 0.07)","shadow-200":"0rem 0.1875rem 0.0625rem -0.0625rem rgba(26, 26, 26, 0.07)","shadow-300":"0rem 0.25rem 0.375rem -0.125rem rgba(26, 26, 26, 0.20)","shadow-400":"0rem 0.5rem 1rem -0.25rem rgba(26, 26, 26, 0.22)","shadow-500":"0rem 0.75rem 1.25rem -0.5rem rgba(26, 26, 26, 0.24)","shadow-600":"0rem 1.25rem 1.25rem -0.5rem rgba(26, 26, 26, 0.28)","shadow-bevel-100":"0.0625rem 0rem 0rem 0rem rgba(0, 0, 0, 0.13) inset, -0.0625rem 0rem 0rem 0rem rgba(0, 0, 0, 0.13) inset, 0rem -0.0625rem 0rem 0rem rgba(0, 0, 0, 0.17) inset, 0rem 0.0625rem 0rem 0rem rgba(204, 204, 204, 0.5) inset","shadow-inset-100":"0rem 0.0625rem 0.125rem 0rem rgba(26, 26, 26, 0.15) inset, 0rem 0.0625rem 0.0625rem 0rem rgba(26, 26, 26, 0.15) inset","shadow-inset-200":"0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.20) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset, -0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset","shadow-button":"0rem -0.0625rem 0rem 0rem #b5b5b5 inset, 0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.1) inset, 0rem 0.03125rem 0rem 0.09375rem #FFF inset","shadow-button-hover":"0rem 0.0625rem 0rem 0rem #EBEBEB inset, -0.0625rem 0rem 0rem 0rem #EBEBEB inset, 0.0625rem 0rem 0rem 0rem #EBEBEB inset, 0rem -0.0625rem 0rem 0rem #CCC inset","shadow-button-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.122) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.122) inset, 0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.2) inset","shadow-button-primary":"0rem -0.0625rem 0rem 0.0625rem rgba(0, 0, 0, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(48, 48, 48, 1) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.25) inset;","shadow-button-primary-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.24) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.0625rem 0rem 0rem #000 inset, 0rem -0.0625rem 0rem 0.0625rem #1A1A1A","shadow-button-primary-inset":"0rem 0.1875rem 0rem 0rem rgb(0, 0, 0) inset","shadow-button-primary-critical":"0rem -0.0625rem 0rem 0.0625rem rgba(142, 31, 11, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(181, 38, 11, 0.8) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.349) inset","shadow-button-primary-critical-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.48) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.09375rem 0rem 0rem rgba(0, 0, 0, 0.25) inset","shadow-button-primary-critical-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0rem 0.125rem 0rem 0rem rgba(0, 0, 0, 0.6) inset","shadow-button-primary-success":"0rem -0.0625rem 0rem 0.0625rem rgba(12, 81, 50, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(19, 111, 69, 0.8) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.251) inset","shadow-button-primary-success-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.48) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.09375rem 0rem 0rem rgba(0, 0, 0, 0.25) inset","shadow-button-primary-success-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0rem 0.125rem 0rem 0rem rgba(0, 0, 0, 0.6) inset","shadow-border-inset":"0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.08) inset"},space:{"space-0":"0rem","space-025":"0.0625rem","space-050":"0.125rem","space-100":"0.25rem","space-150":"0.375rem","space-200":"0.5rem","space-300":"0.75rem","space-400":"1rem","space-500":"1.25rem","space-600":"1.5rem","space-800":"2rem","space-1000":"2.5rem","space-1200":"3rem","space-1600":"4rem","space-2000":"5rem","space-2400":"6rem","space-2800":"7rem","space-3200":"8rem","space-button-group-gap":"0.5rem","space-card-gap":"1rem","space-card-padding":"1rem","space-table-cell-padding":"0.375rem"},text:{"text-heading-3xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-3xl-font-size":"2.25rem","text-heading-3xl-font-weight":"700","text-heading-3xl-font-letter-spacing":"-0.03375rem","text-heading-3xl-font-line-height":"3rem","text-heading-2xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-2xl-font-size":"1.875rem","text-heading-2xl-font-weight":"700","text-heading-2xl-font-letter-spacing":"-0.01875rem","text-heading-2xl-font-line-height":"2.5rem","text-heading-xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xl-font-size":"1.5rem","text-heading-xl-font-weight":"700","text-heading-xl-font-letter-spacing":"-0.0125rem","text-heading-xl-font-line-height":"2rem","text-heading-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-lg-font-size":"1.25rem","text-heading-lg-font-weight":"650","text-heading-lg-font-letter-spacing":"-0.0125rem","text-heading-lg-font-line-height":"1.5rem","text-heading-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-md-font-size":"0.875rem","text-heading-md-font-weight":"650","text-heading-md-font-letter-spacing":"0rem","text-heading-md-font-line-height":"1.25rem","text-heading-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-sm-font-size":"0.8125rem","text-heading-sm-font-weight":"650","text-heading-sm-font-letter-spacing":"0rem","text-heading-sm-font-line-height":"1.25rem","text-heading-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xs-font-size":"0.75rem","text-heading-xs-font-weight":"650","text-heading-xs-font-letter-spacing":"0rem","text-heading-xs-font-line-height":"1rem","text-body-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-lg-font-size":"0.875rem","text-body-lg-font-weight":"450","text-body-lg-font-letter-spacing":"0rem","text-body-lg-font-line-height":"1.25rem","text-body-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-md-font-size":"0.8125rem","text-body-md-font-weight":"450","text-body-md-font-letter-spacing":"0rem","text-body-md-font-line-height":"1.25rem","text-body-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-sm-font-size":"0.75rem","text-body-sm-font-weight":"450","text-body-sm-font-letter-spacing":"0rem","text-body-sm-font-line-height":"1rem","text-body-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-xs-font-size":"0.6875rem","text-body-xs-font-weight":"450","text-body-xs-font-letter-spacing":"0rem","text-body-xs-font-line-height":"0.75rem"},width:{"width-0":"0rem","width-025":"0.0625rem","width-050":"0.125rem","width-100":"0.25rem","width-150":"0.375rem","width-200":"0.5rem","width-300":"0.75rem","width-400":"1rem","width-500":"1.25rem","width-600":"1.5rem","width-700":"1.75rem","width-800":"2rem","width-900":"2.25rem","width-1000":"2.5rem","width-1200":"3rem","width-1600":"4rem","width-2000":"5rem","width-2400":"6rem","width-2800":"7rem","width-3200":"8rem"},zIndex:{"z-index-0":"auto","z-index-1":"100","z-index-2":"400","z-index-3":"510","z-index-4":"512","z-index-5":"513","z-index-6":"514","z-index-7":"515","z-index-8":"516","z-index-9":"517","z-index-10":"518","z-index-11":"519","z-index-12":"520"}},"light-mobile":{border:{"border-radius-0":"0rem","border-radius-050":"0.125rem","border-radius-100":"0.25rem","border-radius-150":"0.375rem","border-radius-200":"0.5rem","border-radius-300":"0.75rem","border-radius-400":"1rem","border-radius-500":"1.25rem","border-radius-750":"1.875rem","border-radius-full":"624.9375rem","border-width-0":"0rem","border-width-0165":"0.04125rem","border-width-025":"0.0625rem","border-width-050":"0.125rem","border-width-100":"0.25rem"},breakpoints:{"breakpoints-xs":"0rem","breakpoints-sm":"30.625rem","breakpoints-md":"48rem","breakpoints-lg":"65rem","breakpoints-xl":"90rem"},color:{"color-scheme":"light","color-bg":"rgba(241, 241, 241, 1)","color-bg-inverse":"rgba(26, 26, 26, 1)","color-bg-surface":"rgba(255, 255, 255, 1)","color-bg-surface-hover":"rgba(247, 247, 247, 1)","color-bg-surface-active":"rgba(243, 243, 243, 1)","color-bg-surface-selected":"rgba(241, 241, 241, 1)","color-bg-surface-disabled":"rgba(0, 0, 0, 0.05)","color-bg-surface-secondary":"rgba(247, 247, 247, 1)","color-bg-surface-secondary-hover":"rgba(241, 241, 241, 1)","color-bg-surface-secondary-active":"rgba(235, 235, 235, 1)","color-bg-surface-secondary-selected":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary":"rgba(243, 243, 243, 1)","color-bg-surface-tertiary-hover":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary-active":"rgba(227, 227, 227, 1)","color-bg-surface-brand":"rgba(227, 227, 227, 1)","color-bg-surface-brand-hover":"rgba(235, 235, 235, 1)","color-bg-surface-brand-active":"rgba(241, 241, 241, 1)","color-bg-surface-brand-selected":"rgba(241, 241, 241, 1)","color-bg-surface-info":"rgba(234, 244, 255, 1)","color-bg-surface-info-hover":"rgba(224, 240, 255, 1)","color-bg-surface-info-active":"rgba(202, 230, 255, 1)","color-bg-surface-success":"rgba(205, 254, 225, 1)","color-bg-surface-success-hover":"rgba(180, 254, 210, 1)","color-bg-surface-success-active":"rgba(146, 254, 194, 1)","color-bg-surface-caution":"rgba(255, 248, 219, 1)","color-bg-surface-caution-hover":"rgba(255, 244, 191, 1)","color-bg-surface-caution-active":"rgba(255, 239, 157, 1)","color-bg-surface-warning":"rgba(255, 241, 227, 1)","color-bg-surface-warning-hover":"rgba(255, 235, 213, 1)","color-bg-surface-warning-active":"rgba(255, 228, 198, 1)","color-bg-surface-critical":"rgba(254, 233, 232, 1)","color-bg-surface-critical-hover":"rgba(254, 226, 225, 1)","color-bg-surface-critical-active":"rgba(254, 218, 217, 1)","color-bg-surface-emphasis":"rgba(240, 242, 255, 1)","color-bg-surface-emphasis-hover":"rgba(234, 237, 255, 1)","color-bg-surface-emphasis-active":"rgba(226, 231, 255, 1)","color-bg-surface-magic":"rgba(248, 247, 255, 1)","color-bg-surface-magic-hover":"rgba(243, 241, 255, 1)","color-bg-surface-magic-active":"rgba(233, 229, 255, 1)","color-bg-surface-inverse":"rgba(48, 48, 48, 1)","color-bg-surface-transparent":"rgba(0, 0, 0, 0)","color-bg-fill":"rgba(255, 255, 255, 1)","color-bg-fill-hover":"rgba(250, 250, 250, 1)","color-bg-fill-active":"rgba(247, 247, 247, 1)","color-bg-fill-selected":"rgba(204, 204, 204, 1)","color-bg-fill-disabled":"rgba(0, 0, 0, 0.05)","color-bg-fill-secondary":"rgba(241, 241, 241, 1)","color-bg-fill-secondary-hover":"rgba(235, 235, 235, 1)","color-bg-fill-secondary-active":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary-hover":"rgba(212, 212, 212, 1)","color-bg-fill-tertiary-active":"rgba(204, 204, 204, 1)","color-bg-fill-brand":"rgba(48, 48, 48, 1)","color-bg-fill-brand-hover":"rgba(26, 26, 26, 1)","color-bg-fill-brand-active":"rgba(26, 26, 26, 1)","color-bg-fill-brand-selected":"rgba(48, 48, 48, 1)","color-bg-fill-brand-disabled":"rgba(0, 0, 0, 0.17)","color-bg-fill-info":"rgba(145, 208, 255, 1)","color-bg-fill-info-hover":"rgba(81, 192, 255, 1)","color-bg-fill-info-active":"rgba(0, 148, 213, 1)","color-bg-fill-info-secondary":"rgba(213, 235, 255, 1)","color-bg-fill-success":"rgba(41, 132, 90, 1)","color-bg-fill-success-hover":"rgba(19, 111, 69, 1)","color-bg-fill-success-active":"rgba(12, 81, 50, 1)","color-bg-fill-success-secondary":"rgba(180, 254, 210, 1)","color-bg-fill-warning":"rgba(255, 184, 0, 1)","color-bg-fill-warning-hover":"rgba(229, 165, 0, 1)","color-bg-fill-warning-active":"rgba(178, 132, 0, 1)","color-bg-fill-warning-secondary":"rgba(255, 214, 164, 1)","color-bg-fill-caution":"rgba(255, 230, 0, 1)","color-bg-fill-caution-hover":"rgba(234, 211, 0, 1)","color-bg-fill-caution-active":"rgba(225, 203, 0, 1)","color-bg-fill-caution-secondary":"rgba(255, 235, 120, 1)","color-bg-fill-critical":"rgba(229, 28, 0, 1)","color-bg-fill-critical-hover":"rgba(181, 38, 11, 1)","color-bg-fill-critical-active":"rgba(142, 31, 11, 1)","color-bg-fill-critical-selected":"rgba(142, 31, 11, 1)","color-bg-fill-critical-secondary":"rgba(254, 211, 209, 1)","color-bg-fill-emphasis":"rgba(0, 91, 211, 1)","color-bg-fill-emphasis-hover":"rgba(0, 66, 153, 1)","color-bg-fill-emphasis-active":"rgba(0, 46, 106, 1)","color-bg-fill-magic":"rgba(128, 81, 255, 1)","color-bg-fill-magic-secondary":"rgba(233, 229, 255, 1)","color-bg-fill-magic-secondary-hover":"rgba(228, 222, 255, 1)","color-bg-fill-magic-secondary-active":"rgba(223, 217, 255, 1)","color-bg-fill-inverse":"rgba(48, 48, 48, 1)","color-bg-fill-inverse-hover":"rgba(74, 74, 74, 1)","color-bg-fill-inverse-active":"rgba(97, 97, 97, 1)","color-bg-fill-transparent":"rgba(0, 0, 0, 0.02)","color-bg-fill-transparent-hover":"rgba(0, 0, 0, 0.05)","color-bg-fill-transparent-active":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-selected":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary":"rgba(0, 0, 0, 0.06)","color-bg-fill-transparent-secondary-hover":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary-active":"rgba(0, 0, 0, 0.11)","color-text":"rgba(48, 48, 48, 1)","color-text-secondary":"rgba(97, 97, 97, 1)","color-text-disabled":"rgba(181, 181, 181, 1)","color-text-link":"rgba(0, 91, 211, 1)","color-text-link-hover":"rgba(0, 66, 153, 1)","color-text-link-active":"rgba(0, 46, 106, 1)","color-text-brand":"rgba(74, 74, 74, 1)","color-text-brand-hover":"rgba(48, 48, 48, 1)","color-text-brand-on-bg-fill":"rgba(255, 255, 255, 1)","color-text-brand-on-bg-fill-hover":"rgba(227, 227, 227, 1)","color-text-brand-on-bg-fill-active":"rgba(204, 204, 204, 1)","color-text-brand-on-bg-fill-disabled":"rgba(255, 255, 255, 1)","color-text-info":"rgba(0, 58, 90, 1)","color-text-info-hover":"rgba(0, 58, 90, 1)","color-text-info-active":"rgba(0, 33, 51, 1)","color-text-info-secondary":"rgba(0, 124, 180, 1)","color-text-info-on-bg-fill":"rgba(0, 33, 51, 1)","color-text-success":"rgba(12, 81, 50, 1)","color-text-success-hover":"rgba(8, 61, 37, 1)","color-text-success-active":"rgba(9, 42, 27, 1)","color-text-success-secondary":"rgba(41, 132, 90, 1)","color-text-success-on-bg-fill":"rgba(248, 255, 251, 1)","color-text-caution":"rgba(79, 71, 0, 1)","color-text-caution-hover":"rgba(51, 46, 0, 1)","color-text-caution-active":"rgba(31, 28, 0, 1)","color-text-caution-secondary":"rgba(130, 117, 0, 1)","color-text-caution-on-bg-fill":"rgba(51, 46, 0, 1)","color-text-warning":"rgba(94, 66, 0, 1)","color-text-warning-hover":"rgba(65, 45, 0, 1)","color-text-warning-active":"rgba(37, 26, 0, 1)","color-text-warning-secondary":"rgba(149, 111, 0, 1)","color-text-warning-on-bg-fill":"rgba(37, 26, 0, 1)","color-text-critical":"rgba(142, 31, 11, 1)","color-text-critical-hover":"rgba(95, 21, 7, 1)","color-text-critical-active":"rgba(47, 10, 4, 1)","color-text-critical-secondary":"rgba(229, 28, 0, 1)","color-text-critical-on-bg-fill":"rgba(255, 251, 251, 1)","color-text-emphasis":"rgba(0, 91, 211, 1)","color-text-emphasis-hover":"rgba(0, 66, 153, 1)","color-text-emphasis-active":"rgba(0, 46, 106, 1)","color-text-emphasis-on-bg-fill":"rgba(252, 253, 255, 1)","color-text-emphasis-on-bg-fill-hover":"rgba(226, 231, 255, 1)","color-text-emphasis-on-bg-fill-active":"rgba(213, 220, 255, 1)","color-text-magic":"rgba(87, 0, 209, 1)","color-text-magic-secondary":"rgba(113, 38, 255, 1)","color-text-magic-on-bg-fill":"rgba(253, 253, 255, 1)","color-text-inverse":"rgba(227, 227, 227, 1)","color-text-inverse-secondary":"rgba(181, 181, 181, 1)","color-text-link-inverse":"rgba(197, 208, 255, 1)","color-border":"rgba(227, 227, 227, 1)","color-border-hover":"rgba(204, 204, 204, 1)","color-border-disabled":"rgba(235, 235, 235, 1)","color-border-secondary":"rgba(235, 235, 235, 1)","color-border-tertiary":"rgba(204, 204, 204, 1)","color-border-focus":"rgba(0, 91, 211, 1)","color-border-brand":"rgba(227, 227, 227, 1)","color-border-info":"rgba(168, 216, 255, 1)","color-border-success":"rgba(146, 254, 194, 1)","color-border-caution":"rgba(255, 235, 120, 1)","color-border-warning":"rgba(255, 200, 121, 1)","color-border-critical":"rgba(254, 195, 193, 1)","color-border-critical-secondary":"rgba(142, 31, 11, 1)","color-border-emphasis":"rgba(0, 91, 211, 1)","color-border-emphasis-hover":"rgba(0, 66, 153, 1)","color-border-emphasis-active":"rgba(0, 46, 106, 1)","color-border-magic":"rgba(228, 222, 255, 1)","color-border-magic-secondary":"rgba(148, 116, 255, 1)","color-border-magic-secondary-hover":"rgba(128, 81, 255, 1)","color-border-inverse":"rgba(97, 97, 97, 1)","color-border-inverse-hover":"rgba(204, 204, 204, 1)","color-border-inverse-active":"rgba(227, 227, 227, 1)","color-tooltip-tail-down-border-experimental":"rgba(212, 212, 212, 1)","color-tooltip-tail-up-border-experimental":"rgba(227, 227, 227, 1)","color-border-gradient-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-hover-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-selected-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-active-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-icon":"rgba(74, 74, 74, 1)","color-icon-hover":"rgba(48, 48, 48, 1)","color-icon-active":"rgba(26, 26, 26, 1)","color-icon-disabled":"rgba(204, 204, 204, 1)","color-icon-secondary":"rgba(138, 138, 138, 1)","color-icon-secondary-hover":"rgba(97, 97, 97, 1)","color-icon-secondary-active":"rgba(74, 74, 74, 1)","color-icon-brand":"rgba(26, 26, 26, 1)","color-icon-info":"rgba(0, 148, 213, 1)","color-icon-success":"rgba(41, 132, 90, 1)","color-icon-caution":"rgba(153, 138, 0, 1)","color-icon-warning":"rgba(178, 132, 0, 1)","color-icon-critical":"rgba(239, 77, 47, 1)","color-icon-emphasis":"rgba(0, 91, 211, 1)","color-icon-emphasis-hover":"rgba(0, 66, 153, 1)","color-icon-emphasis-active":"rgba(0, 46, 106, 1)","color-icon-magic":"rgba(128, 81, 255, 1)","color-icon-inverse":"rgba(227, 227, 227, 1)","color-avatar-bg-fill":"rgba(181, 181, 181, 1)","color-avatar-five-bg-fill":"rgba(253, 75, 146, 1)","color-avatar-five-text-on-bg-fill":"rgba(255, 246, 248, 1)","color-avatar-four-bg-fill":"rgba(81, 192, 255, 1)","color-avatar-four-text-on-bg-fill":"rgba(0, 33, 51, 1)","color-avatar-one-bg-fill":"rgba(197, 48, 197, 1)","color-avatar-one-text-on-bg-fill":"rgba(253, 239, 253, 1)","color-avatar-seven-bg-fill":"rgba(148, 116, 255, 1)","color-avatar-seven-text-on-bg-fill":"rgba(248, 247, 255, 1)","color-avatar-six-bg-fill":"rgba(37, 232, 43, 1)","color-avatar-six-text-on-bg-fill":"rgba(3, 61, 5, 1)","color-avatar-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-avatar-three-bg-fill":"rgba(44, 224, 212, 1)","color-avatar-three-text-on-bg-fill":"rgba(3, 60, 57, 1)","color-avatar-two-bg-fill":"rgba(56, 250, 163, 1)","color-avatar-two-text-on-bg-fill":"rgba(12, 81, 50, 1)","color-backdrop-bg":"rgba(0, 0, 0, 0.71)","color-button-gradient-bg-fill":"none","color-checkbox-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-checkbox-icon-disabled":"rgba(255, 255, 255, 1)","color-input-bg-surface":"rgba(253, 253, 253, 1)","color-input-bg-surface-hover":"rgba(250, 250, 250, 1)","color-input-bg-surface-active":"rgba(247, 247, 247, 1)","color-input-border":"rgba(138, 138, 138, 1)","color-input-border-hover":"rgba(97, 97, 97, 1)","color-input-border-active":"rgba(26, 26, 26, 1)","color-nav-bg":"rgba(235, 235, 235, 1)","color-nav-bg-surface":"rgba(0, 0, 0, 0.02)","color-nav-bg-surface-hover":"rgba(241, 241, 241, 1)","color-nav-bg-surface-active":"rgba(250, 250, 250, 1)","color-nav-bg-surface-selected":"rgba(250, 250, 250, 1)","color-radio-button-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-radio-button-icon-disabled":"rgba(255, 255, 255, 1)","color-video-thumbnail-play-button-bg-fill-hover":"rgba(0, 0, 0, 0.81)","color-video-thumbnail-play-button-bg-fill":"rgba(0, 0, 0, 0.71)","color-video-thumbnail-play-button-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-scrollbar-thumb-bg-hover":"rgba(138, 138, 138, 1)"},font:{"font-family-sans":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","font-family-mono":"ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace","font-size-275":"0.6875rem","font-size-300":"0.75rem","font-size-325":"0.8125rem","font-size-350":"0.875rem","font-size-400":"1rem","font-size-450":"1.125rem","font-size-500":"1.25rem","font-size-550":"1.375rem","font-size-600":"1.5rem","font-size-750":"1.875rem","font-size-800":"2rem","font-size-900":"2.25rem","font-size-1000":"2.5rem","font-weight-regular":"450","font-weight-medium":"550","font-weight-semibold":"650","font-weight-bold":"700","font-letter-spacing-densest":"-0.03375rem","font-letter-spacing-denser":"-0.01875rem","font-letter-spacing-dense":"-0.0125rem","font-letter-spacing-normal":"0rem","font-line-height-300":"0.75rem","font-line-height-400":"1rem","font-line-height-500":"1.25rem","font-line-height-600":"1.5rem","font-line-height-700":"1.75rem","font-line-height-800":"2rem","font-line-height-1000":"2.5rem","font-line-height-1200":"3rem"},height:{"height-0":"0rem","height-025":"0.0625rem","height-050":"0.125rem","height-100":"0.25rem","height-150":"0.375rem","height-200":"0.5rem","height-300":"0.75rem","height-400":"1rem","height-500":"1.25rem","height-600":"1.5rem","height-700":"1.75rem","height-800":"2rem","height-900":"2.25rem","height-1000":"2.5rem","height-1200":"3rem","height-1600":"4rem","height-2000":"5rem","height-2400":"6rem","height-2800":"7rem","height-3200":"8rem"},motion:{"motion-duration-0":"0ms","motion-duration-50":"50ms","motion-duration-100":"100ms","motion-duration-150":"150ms","motion-duration-200":"200ms","motion-duration-250":"250ms","motion-duration-300":"300ms","motion-duration-350":"350ms","motion-duration-400":"400ms","motion-duration-450":"450ms","motion-duration-500":"500ms","motion-duration-5000":"5000ms","motion-ease":"cubic-bezier(0.25, 0.1, 0.25, 1)","motion-ease-in":"cubic-bezier(0.42, 0, 1, 1)","motion-ease-out":"cubic-bezier(0.19, 0.91, 0.38, 1)","motion-ease-in-out":"cubic-bezier(0.42, 0, 0.58, 1)","motion-linear":"cubic-bezier(0, 0, 1, 1)","motion-keyframes-bounce":"{ from, 65%, 85% { transform: scale(1) } 75% { transform: scale(0.85) } 82.5% { transform: scale(1.05) } }","motion-keyframes-fade-in":"{ to { opacity: 1 } }","motion-keyframes-pulse":"{ from, 75% { transform: scale(0.85); opacity: 1; } to { transform: scale(2.5); opacity: 0; } }","motion-keyframes-spin":"{ to { transform: rotate(1turn) } }","motion-keyframes-appear-above":"{ from { transform: translateY(var(--p-space-100)); opacity: 0; } to { transform: none; opacity: 1; } }","motion-keyframes-appear-below":"{ from { transform: translateY(calc(var(--p-space-100) * -1)); opacity: 0; } to { transform: none; opacity: 1; } }"},shadow:{"shadow-0":"none","shadow-100":"none","shadow-200":"0rem 0.1875rem 0.0625rem -0.0625rem rgba(26, 26, 26, 0.07)","shadow-300":"0rem 0.25rem 0.375rem -0.125rem rgba(26, 26, 26, 0.20)","shadow-400":"0rem 0.5rem 1rem -0.25rem rgba(26, 26, 26, 0.22)","shadow-500":"0rem 0.75rem 1.25rem -0.5rem rgba(26, 26, 26, 0.24)","shadow-600":"0rem 1.25rem 1.25rem -0.5rem rgba(26, 26, 26, 0.28)","shadow-bevel-100":"none","shadow-inset-100":"0rem 0.0625rem 0.125rem 0rem rgba(26, 26, 26, 0.15) inset, 0rem 0.0625rem 0.0625rem 0rem rgba(26, 26, 26, 0.15) inset","shadow-inset-200":"0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.20) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset, -0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset","shadow-button":"0 0 0 var(--p-border-width-025) var(--p-color-border) inset","shadow-button-hover":"0 0 0 var(--p-border-width-025) var(--p-color-border) inset","shadow-button-inset":"0 0 0 var(--p-border-width-025) var(--p-color-border) inset","shadow-button-primary":"none","shadow-button-primary-hover":"none","shadow-button-primary-inset":"none","shadow-button-primary-critical":"none","shadow-button-primary-critical-hover":"none","shadow-button-primary-critical-inset":"none","shadow-button-primary-success":"none","shadow-button-primary-success-hover":"none","shadow-button-primary-success-inset":"none","shadow-border-inset":"0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.08) inset"},space:{"space-0":"0rem","space-025":"0.0625rem","space-050":"0.125rem","space-100":"0.25rem","space-150":"0.375rem","space-200":"0.5rem","space-300":"0.75rem","space-400":"1rem","space-500":"1.25rem","space-600":"1.5rem","space-800":"2rem","space-1000":"2.5rem","space-1200":"3rem","space-1600":"4rem","space-2000":"5rem","space-2400":"6rem","space-2800":"7rem","space-3200":"8rem","space-button-group-gap":"0.5rem","space-card-gap":"0.5rem","space-card-padding":"1rem","space-table-cell-padding":"0.375rem"},text:{"text-heading-3xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-3xl-font-size":"2.25rem","text-heading-3xl-font-weight":"700","text-heading-3xl-font-letter-spacing":"-0.03375rem","text-heading-3xl-font-line-height":"3rem","text-heading-2xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-2xl-font-size":"2rem","text-heading-2xl-font-weight":"700","text-heading-2xl-font-letter-spacing":"-0.01875rem","text-heading-2xl-font-line-height":"2.5rem","text-heading-xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xl-font-size":"1.375rem","text-heading-xl-font-weight":"700","text-heading-xl-font-letter-spacing":"-0.0125rem","text-heading-xl-font-line-height":"1.75rem","text-heading-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-lg-font-size":"1.125rem","text-heading-lg-font-weight":"650","text-heading-lg-font-letter-spacing":"-0.0125rem","text-heading-lg-font-line-height":"1.5rem","text-heading-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-md-font-size":"1rem","text-heading-md-font-weight":"650","text-heading-md-font-letter-spacing":"0rem","text-heading-md-font-line-height":"1.25rem","text-heading-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-sm-font-size":"0.875rem","text-heading-sm-font-weight":"650","text-heading-sm-font-letter-spacing":"0rem","text-heading-sm-font-line-height":"1.25rem","text-heading-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xs-font-size":"0.75rem","text-heading-xs-font-weight":"650","text-heading-xs-font-letter-spacing":"0rem","text-heading-xs-font-line-height":"1rem","text-body-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-lg-font-size":"1.125rem","text-body-lg-font-weight":"450","text-body-lg-font-letter-spacing":"0rem","text-body-lg-font-line-height":"1.75rem","text-body-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-md-font-size":"1rem","text-body-md-font-weight":"450","text-body-md-font-letter-spacing":"0rem","text-body-md-font-line-height":"1.5rem","text-body-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-sm-font-size":"0.875rem","text-body-sm-font-weight":"450","text-body-sm-font-letter-spacing":"0rem","text-body-sm-font-line-height":"1.25rem","text-body-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-xs-font-size":"0.75rem","text-body-xs-font-weight":"450","text-body-xs-font-letter-spacing":"0rem","text-body-xs-font-line-height":"1rem"},width:{"width-0":"0rem","width-025":"0.0625rem","width-050":"0.125rem","width-100":"0.25rem","width-150":"0.375rem","width-200":"0.5rem","width-300":"0.75rem","width-400":"1rem","width-500":"1.25rem","width-600":"1.5rem","width-700":"1.75rem","width-800":"2rem","width-900":"2.25rem","width-1000":"2.5rem","width-1200":"3rem","width-1600":"4rem","width-2000":"5rem","width-2400":"6rem","width-2800":"7rem","width-3200":"8rem"},zIndex:{"z-index-0":"auto","z-index-1":"100","z-index-2":"400","z-index-3":"510","z-index-4":"512","z-index-5":"513","z-index-6":"514","z-index-7":"515","z-index-8":"516","z-index-9":"517","z-index-10":"518","z-index-11":"519","z-index-12":"520"}},"light-high-contrast-experimental":{border:{"border-radius-0":"0rem","border-radius-050":"0.125rem","border-radius-100":"0.25rem","border-radius-150":"0.375rem","border-radius-200":"0.5rem","border-radius-300":"0.75rem","border-radius-400":"1rem","border-radius-500":"1.25rem","border-radius-750":"1.875rem","border-radius-full":"624.9375rem","border-width-0":"0rem","border-width-0165":"0.04125rem","border-width-025":"0.0625rem","border-width-050":"0.125rem","border-width-100":"0.25rem"},breakpoints:{"breakpoints-xs":"0rem","breakpoints-sm":"30.625rem","breakpoints-md":"48rem","breakpoints-lg":"65rem","breakpoints-xl":"90rem"},color:{"color-scheme":"light","color-bg":"rgba(241, 241, 241, 1)","color-bg-inverse":"rgba(26, 26, 26, 1)","color-bg-surface":"rgba(255, 255, 255, 1)","color-bg-surface-hover":"rgba(247, 247, 247, 1)","color-bg-surface-active":"rgba(243, 243, 243, 1)","color-bg-surface-selected":"rgba(241, 241, 241, 1)","color-bg-surface-disabled":"rgba(0, 0, 0, 0.05)","color-bg-surface-secondary":"rgba(241, 241, 241, 1)","color-bg-surface-secondary-hover":"rgba(241, 241, 241, 1)","color-bg-surface-secondary-active":"rgba(235, 235, 235, 1)","color-bg-surface-secondary-selected":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary":"rgba(243, 243, 243, 1)","color-bg-surface-tertiary-hover":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary-active":"rgba(227, 227, 227, 1)","color-bg-surface-brand":"rgba(227, 227, 227, 1)","color-bg-surface-brand-hover":"rgba(235, 235, 235, 1)","color-bg-surface-brand-active":"rgba(241, 241, 241, 1)","color-bg-surface-brand-selected":"rgba(241, 241, 241, 1)","color-bg-surface-info":"rgba(234, 244, 255, 1)","color-bg-surface-info-hover":"rgba(224, 240, 255, 1)","color-bg-surface-info-active":"rgba(202, 230, 255, 1)","color-bg-surface-success":"rgba(205, 254, 225, 1)","color-bg-surface-success-hover":"rgba(180, 254, 210, 1)","color-bg-surface-success-active":"rgba(146, 254, 194, 1)","color-bg-surface-caution":"rgba(255, 248, 219, 1)","color-bg-surface-caution-hover":"rgba(255, 244, 191, 1)","color-bg-surface-caution-active":"rgba(255, 239, 157, 1)","color-bg-surface-warning":"rgba(255, 241, 227, 1)","color-bg-surface-warning-hover":"rgba(255, 235, 213, 1)","color-bg-surface-warning-active":"rgba(255, 228, 198, 1)","color-bg-surface-critical":"rgba(254, 233, 232, 1)","color-bg-surface-critical-hover":"rgba(254, 226, 225, 1)","color-bg-surface-critical-active":"rgba(254, 218, 217, 1)","color-bg-surface-emphasis":"rgba(240, 242, 255, 1)","color-bg-surface-emphasis-hover":"rgba(234, 237, 255, 1)","color-bg-surface-emphasis-active":"rgba(226, 231, 255, 1)","color-bg-surface-magic":"rgba(248, 247, 255, 1)","color-bg-surface-magic-hover":"rgba(243, 241, 255, 1)","color-bg-surface-magic-active":"rgba(233, 229, 255, 1)","color-bg-surface-inverse":"rgba(48, 48, 48, 1)","color-bg-surface-transparent":"rgba(0, 0, 0, 0)","color-bg-fill":"rgba(255, 255, 255, 1)","color-bg-fill-hover":"rgba(250, 250, 250, 1)","color-bg-fill-active":"rgba(247, 247, 247, 1)","color-bg-fill-selected":"rgba(204, 204, 204, 1)","color-bg-fill-disabled":"rgba(0, 0, 0, 0.05)","color-bg-fill-secondary":"rgba(241, 241, 241, 1)","color-bg-fill-secondary-hover":"rgba(235, 235, 235, 1)","color-bg-fill-secondary-active":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary-hover":"rgba(212, 212, 212, 1)","color-bg-fill-tertiary-active":"rgba(204, 204, 204, 1)","color-bg-fill-brand":"rgba(48, 48, 48, 1)","color-bg-fill-brand-hover":"rgba(26, 26, 26, 1)","color-bg-fill-brand-active":"rgba(26, 26, 26, 1)","color-bg-fill-brand-selected":"rgba(48, 48, 48, 1)","color-bg-fill-brand-disabled":"rgba(0, 0, 0, 0.17)","color-bg-fill-info":"rgba(145, 208, 255, 1)","color-bg-fill-info-hover":"rgba(81, 192, 255, 1)","color-bg-fill-info-active":"rgba(0, 148, 213, 1)","color-bg-fill-info-secondary":"rgba(213, 235, 255, 1)","color-bg-fill-success":"rgba(41, 132, 90, 1)","color-bg-fill-success-hover":"rgba(19, 111, 69, 1)","color-bg-fill-success-active":"rgba(12, 81, 50, 1)","color-bg-fill-success-secondary":"rgba(180, 254, 210, 1)","color-bg-fill-warning":"rgba(255, 184, 0, 1)","color-bg-fill-warning-hover":"rgba(229, 165, 0, 1)","color-bg-fill-warning-active":"rgba(178, 132, 0, 1)","color-bg-fill-warning-secondary":"rgba(255, 214, 164, 1)","color-bg-fill-caution":"rgba(255, 230, 0, 1)","color-bg-fill-caution-hover":"rgba(234, 211, 0, 1)","color-bg-fill-caution-active":"rgba(225, 203, 0, 1)","color-bg-fill-caution-secondary":"rgba(255, 235, 120, 1)","color-bg-fill-critical":"rgba(229, 28, 0, 1)","color-bg-fill-critical-hover":"rgba(181, 38, 11, 1)","color-bg-fill-critical-active":"rgba(142, 31, 11, 1)","color-bg-fill-critical-selected":"rgba(142, 31, 11, 1)","color-bg-fill-critical-secondary":"rgba(254, 211, 209, 1)","color-bg-fill-emphasis":"rgba(0, 91, 211, 1)","color-bg-fill-emphasis-hover":"rgba(0, 66, 153, 1)","color-bg-fill-emphasis-active":"rgba(0, 46, 106, 1)","color-bg-fill-magic":"rgba(128, 81, 255, 1)","color-bg-fill-magic-secondary":"rgba(233, 229, 255, 1)","color-bg-fill-magic-secondary-hover":"rgba(228, 222, 255, 1)","color-bg-fill-magic-secondary-active":"rgba(223, 217, 255, 1)","color-bg-fill-inverse":"rgba(48, 48, 48, 1)","color-bg-fill-inverse-hover":"rgba(74, 74, 74, 1)","color-bg-fill-inverse-active":"rgba(97, 97, 97, 1)","color-bg-fill-transparent":"rgba(0, 0, 0, 0.02)","color-bg-fill-transparent-hover":"rgba(0, 0, 0, 0.05)","color-bg-fill-transparent-active":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-selected":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary":"rgba(0, 0, 0, 0.06)","color-bg-fill-transparent-secondary-hover":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary-active":"rgba(0, 0, 0, 0.11)","color-text":"rgba(26, 26, 26, 1)","color-text-secondary":"rgba(26, 26, 26, 1)","color-text-disabled":"rgba(181, 181, 181, 1)","color-text-link":"rgba(0, 91, 211, 1)","color-text-link-hover":"rgba(0, 66, 153, 1)","color-text-link-active":"rgba(0, 46, 106, 1)","color-text-brand":"rgba(26, 26, 26, 1)","color-text-brand-hover":"rgba(48, 48, 48, 1)","color-text-brand-on-bg-fill":"rgba(255, 255, 255, 1)","color-text-brand-on-bg-fill-hover":"rgba(227, 227, 227, 1)","color-text-brand-on-bg-fill-active":"rgba(204, 204, 204, 1)","color-text-brand-on-bg-fill-disabled":"rgba(255, 255, 255, 1)","color-text-info":"rgba(0, 58, 90, 1)","color-text-info-hover":"rgba(0, 58, 90, 1)","color-text-info-active":"rgba(0, 33, 51, 1)","color-text-info-secondary":"rgba(0, 124, 180, 1)","color-text-info-on-bg-fill":"rgba(0, 33, 51, 1)","color-text-success":"rgba(12, 81, 50, 1)","color-text-success-hover":"rgba(8, 61, 37, 1)","color-text-success-active":"rgba(9, 42, 27, 1)","color-text-success-secondary":"rgba(41, 132, 90, 1)","color-text-success-on-bg-fill":"rgba(248, 255, 251, 1)","color-text-caution":"rgba(79, 71, 0, 1)","color-text-caution-hover":"rgba(51, 46, 0, 1)","color-text-caution-active":"rgba(31, 28, 0, 1)","color-text-caution-secondary":"rgba(130, 117, 0, 1)","color-text-caution-on-bg-fill":"rgba(51, 46, 0, 1)","color-text-warning":"rgba(94, 66, 0, 1)","color-text-warning-hover":"rgba(65, 45, 0, 1)","color-text-warning-active":"rgba(37, 26, 0, 1)","color-text-warning-secondary":"rgba(149, 111, 0, 1)","color-text-warning-on-bg-fill":"rgba(37, 26, 0, 1)","color-text-critical":"rgba(142, 31, 11, 1)","color-text-critical-hover":"rgba(95, 21, 7, 1)","color-text-critical-active":"rgba(47, 10, 4, 1)","color-text-critical-secondary":"rgba(229, 28, 0, 1)","color-text-critical-on-bg-fill":"rgba(255, 251, 251, 1)","color-text-emphasis":"rgba(0, 91, 211, 1)","color-text-emphasis-hover":"rgba(0, 66, 153, 1)","color-text-emphasis-active":"rgba(0, 46, 106, 1)","color-text-emphasis-on-bg-fill":"rgba(252, 253, 255, 1)","color-text-emphasis-on-bg-fill-hover":"rgba(226, 231, 255, 1)","color-text-emphasis-on-bg-fill-active":"rgba(213, 220, 255, 1)","color-text-magic":"rgba(87, 0, 209, 1)","color-text-magic-secondary":"rgba(113, 38, 255, 1)","color-text-magic-on-bg-fill":"rgba(253, 253, 255, 1)","color-text-inverse":"rgba(227, 227, 227, 1)","color-text-inverse-secondary":"rgba(181, 181, 181, 1)","color-text-link-inverse":"rgba(197, 208, 255, 1)","color-border":"rgba(138, 138, 138, 1)","color-border-hover":"rgba(204, 204, 204, 1)","color-border-disabled":"rgba(235, 235, 235, 1)","color-border-secondary":"rgba(138, 138, 138, 1)","color-border-tertiary":"rgba(204, 204, 204, 1)","color-border-focus":"rgba(0, 91, 211, 1)","color-border-brand":"rgba(227, 227, 227, 1)","color-border-info":"rgba(168, 216, 255, 1)","color-border-success":"rgba(146, 254, 194, 1)","color-border-caution":"rgba(255, 235, 120, 1)","color-border-warning":"rgba(255, 200, 121, 1)","color-border-critical":"rgba(254, 195, 193, 1)","color-border-critical-secondary":"rgba(142, 31, 11, 1)","color-border-emphasis":"rgba(0, 91, 211, 1)","color-border-emphasis-hover":"rgba(0, 66, 153, 1)","color-border-emphasis-active":"rgba(0, 46, 106, 1)","color-border-magic":"rgba(228, 222, 255, 1)","color-border-magic-secondary":"rgba(148, 116, 255, 1)","color-border-magic-secondary-hover":"rgba(128, 81, 255, 1)","color-border-inverse":"rgba(97, 97, 97, 1)","color-border-inverse-hover":"rgba(204, 204, 204, 1)","color-border-inverse-active":"rgba(227, 227, 227, 1)","color-tooltip-tail-down-border-experimental":"rgba(212, 212, 212, 1)","color-tooltip-tail-up-border-experimental":"rgba(227, 227, 227, 1)","color-border-gradient-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-hover-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-selected-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-border-gradient-active-experimental":"linear-gradient(to bottom, rgba(235, 235, 235, 1), rgba(204, 204, 204, 1) 78%, rgba(181, 181, 181, 1))","color-icon":"rgba(74, 74, 74, 1)","color-icon-hover":"rgba(48, 48, 48, 1)","color-icon-active":"rgba(26, 26, 26, 1)","color-icon-disabled":"rgba(204, 204, 204, 1)","color-icon-secondary":"rgba(74, 74, 74, 1)","color-icon-secondary-hover":"rgba(97, 97, 97, 1)","color-icon-secondary-active":"rgba(74, 74, 74, 1)","color-icon-brand":"rgba(26, 26, 26, 1)","color-icon-info":"rgba(0, 148, 213, 1)","color-icon-success":"rgba(41, 132, 90, 1)","color-icon-caution":"rgba(153, 138, 0, 1)","color-icon-warning":"rgba(178, 132, 0, 1)","color-icon-critical":"rgba(239, 77, 47, 1)","color-icon-emphasis":"rgba(0, 91, 211, 1)","color-icon-emphasis-hover":"rgba(0, 66, 153, 1)","color-icon-emphasis-active":"rgba(0, 46, 106, 1)","color-icon-magic":"rgba(128, 81, 255, 1)","color-icon-inverse":"rgba(227, 227, 227, 1)","color-avatar-bg-fill":"rgba(181, 181, 181, 1)","color-avatar-five-bg-fill":"rgba(253, 75, 146, 1)","color-avatar-five-text-on-bg-fill":"rgba(255, 246, 248, 1)","color-avatar-four-bg-fill":"rgba(81, 192, 255, 1)","color-avatar-four-text-on-bg-fill":"rgba(0, 33, 51, 1)","color-avatar-one-bg-fill":"rgba(197, 48, 197, 1)","color-avatar-one-text-on-bg-fill":"rgba(253, 239, 253, 1)","color-avatar-seven-bg-fill":"rgba(148, 116, 255, 1)","color-avatar-seven-text-on-bg-fill":"rgba(248, 247, 255, 1)","color-avatar-six-bg-fill":"rgba(37, 232, 43, 1)","color-avatar-six-text-on-bg-fill":"rgba(3, 61, 5, 1)","color-avatar-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-avatar-three-bg-fill":"rgba(44, 224, 212, 1)","color-avatar-three-text-on-bg-fill":"rgba(3, 60, 57, 1)","color-avatar-two-bg-fill":"rgba(56, 250, 163, 1)","color-avatar-two-text-on-bg-fill":"rgba(12, 81, 50, 1)","color-backdrop-bg":"rgba(0, 0, 0, 0.71)","color-button-gradient-bg-fill":"linear-gradient(180deg, rgba(48, 48, 48, 0) 63.53%, rgba(255, 255, 255, 0.15) 100%)","color-checkbox-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-checkbox-icon-disabled":"rgba(255, 255, 255, 1)","color-input-bg-surface":"rgba(253, 253, 253, 1)","color-input-bg-surface-hover":"rgba(250, 250, 250, 1)","color-input-bg-surface-active":"rgba(247, 247, 247, 1)","color-input-border":"rgba(74, 74, 74, 1)","color-input-border-hover":"rgba(97, 97, 97, 1)","color-input-border-active":"rgba(26, 26, 26, 1)","color-nav-bg":"rgba(235, 235, 235, 1)","color-nav-bg-surface":"rgba(0, 0, 0, 0.02)","color-nav-bg-surface-hover":"rgba(241, 241, 241, 1)","color-nav-bg-surface-active":"rgba(250, 250, 250, 1)","color-nav-bg-surface-selected":"rgba(250, 250, 250, 1)","color-radio-button-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-radio-button-icon-disabled":"rgba(255, 255, 255, 1)","color-video-thumbnail-play-button-bg-fill-hover":"rgba(0, 0, 0, 0.81)","color-video-thumbnail-play-button-bg-fill":"rgba(0, 0, 0, 0.71)","color-video-thumbnail-play-button-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-scrollbar-thumb-bg-hover":"rgba(138, 138, 138, 1)"},font:{"font-family-sans":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","font-family-mono":"ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace","font-size-275":"0.6875rem","font-size-300":"0.75rem","font-size-325":"0.8125rem","font-size-350":"0.875rem","font-size-400":"1rem","font-size-450":"1.125rem","font-size-500":"1.25rem","font-size-550":"1.375rem","font-size-600":"1.5rem","font-size-750":"1.875rem","font-size-800":"2rem","font-size-900":"2.25rem","font-size-1000":"2.5rem","font-weight-regular":"450","font-weight-medium":"550","font-weight-semibold":"650","font-weight-bold":"700","font-letter-spacing-densest":"-0.03375rem","font-letter-spacing-denser":"-0.01875rem","font-letter-spacing-dense":"-0.0125rem","font-letter-spacing-normal":"0rem","font-line-height-300":"0.75rem","font-line-height-400":"1rem","font-line-height-500":"1.25rem","font-line-height-600":"1.5rem","font-line-height-700":"1.75rem","font-line-height-800":"2rem","font-line-height-1000":"2.5rem","font-line-height-1200":"3rem"},height:{"height-0":"0rem","height-025":"0.0625rem","height-050":"0.125rem","height-100":"0.25rem","height-150":"0.375rem","height-200":"0.5rem","height-300":"0.75rem","height-400":"1rem","height-500":"1.25rem","height-600":"1.5rem","height-700":"1.75rem","height-800":"2rem","height-900":"2.25rem","height-1000":"2.5rem","height-1200":"3rem","height-1600":"4rem","height-2000":"5rem","height-2400":"6rem","height-2800":"7rem","height-3200":"8rem"},motion:{"motion-duration-0":"0ms","motion-duration-50":"50ms","motion-duration-100":"100ms","motion-duration-150":"150ms","motion-duration-200":"200ms","motion-duration-250":"250ms","motion-duration-300":"300ms","motion-duration-350":"350ms","motion-duration-400":"400ms","motion-duration-450":"450ms","motion-duration-500":"500ms","motion-duration-5000":"5000ms","motion-ease":"cubic-bezier(0.25, 0.1, 0.25, 1)","motion-ease-in":"cubic-bezier(0.42, 0, 1, 1)","motion-ease-out":"cubic-bezier(0.19, 0.91, 0.38, 1)","motion-ease-in-out":"cubic-bezier(0.42, 0, 0.58, 1)","motion-linear":"cubic-bezier(0, 0, 1, 1)","motion-keyframes-bounce":"{ from, 65%, 85% { transform: scale(1) } 75% { transform: scale(0.85) } 82.5% { transform: scale(1.05) } }","motion-keyframes-fade-in":"{ to { opacity: 1 } }","motion-keyframes-pulse":"{ from, 75% { transform: scale(0.85); opacity: 1; } to { transform: scale(2.5); opacity: 0; } }","motion-keyframes-spin":"{ to { transform: rotate(1turn) } }","motion-keyframes-appear-above":"{ from { transform: translateY(var(--p-space-100)); opacity: 0; } to { transform: none; opacity: 1; } }","motion-keyframes-appear-below":"{ from { transform: translateY(calc(var(--p-space-100) * -1)); opacity: 0; } to { transform: none; opacity: 1; } }"},shadow:{"shadow-0":"none","shadow-100":"0rem 0.0625rem 0rem 0rem rgba(26, 26, 26, 0.07)","shadow-200":"0rem 0.1875rem 0.0625rem -0.0625rem rgba(26, 26, 26, 0.07)","shadow-300":"0rem 0.25rem 0.375rem -0.125rem rgba(26, 26, 26, 0.20)","shadow-400":"0rem 0.5rem 1rem -0.25rem rgba(26, 26, 26, 0.22)","shadow-500":"0rem 0.75rem 1.25rem -0.5rem rgba(26, 26, 26, 0.24)","shadow-600":"0rem 1.25rem 1.25rem -0.5rem rgba(26, 26, 26, 0.28)","shadow-bevel-100":"0rem 0.0625rem 0rem 0rem rgba(26, 26, 26, 0.07), 0rem 0.0625rem 0rem 0rem rgba(208, 208, 208, 0.40) inset, 0.0625rem 0rem 0rem 0rem #CCC inset, -0.0625rem 0rem 0rem 0rem #CCC inset, 0rem -0.0625rem 0rem 0rem #999 inset","shadow-inset-100":"0rem 0.0625rem 0.125rem 0rem rgba(26, 26, 26, 0.15) inset, 0rem 0.0625rem 0.0625rem 0rem rgba(26, 26, 26, 0.15) inset","shadow-inset-200":"0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.20) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset, -0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset","shadow-button":"0rem -0.0625rem 0rem 0rem #b5b5b5 inset, 0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.1) inset, 0rem 0.03125rem 0rem 0.09375rem #FFF inset","shadow-button-hover":"0rem 0.0625rem 0rem 0rem #EBEBEB inset, -0.0625rem 0rem 0rem 0rem #EBEBEB inset, 0.0625rem 0rem 0rem 0rem #EBEBEB inset, 0rem -0.0625rem 0rem 0rem #CCC inset","shadow-button-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.122) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.122) inset, 0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.2) inset","shadow-button-primary":"0rem -0.0625rem 0rem 0.0625rem rgba(0, 0, 0, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(48, 48, 48, 1) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.25) inset;","shadow-button-primary-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.24) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.0625rem 0rem 0rem #000 inset, 0rem -0.0625rem 0rem 0.0625rem #1A1A1A","shadow-button-primary-inset":"0rem 0.1875rem 0rem 0rem rgb(0, 0, 0) inset","shadow-button-primary-critical":"0rem -0.0625rem 0rem 0.0625rem rgba(142, 31, 11, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(181, 38, 11, 0.8) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.349) inset","shadow-button-primary-critical-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.48) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.09375rem 0rem 0rem rgba(0, 0, 0, 0.25) inset","shadow-button-primary-critical-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0rem 0.125rem 0rem 0rem rgba(0, 0, 0, 0.6) inset","shadow-button-primary-success":"0rem -0.0625rem 0rem 0.0625rem rgba(12, 81, 50, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(19, 111, 69, 0.8) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.251) inset","shadow-button-primary-success-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.48) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.09375rem 0rem 0rem rgba(0, 0, 0, 0.25) inset","shadow-button-primary-success-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0rem 0.125rem 0rem 0rem rgba(0, 0, 0, 0.6) inset","shadow-border-inset":"0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.08) inset"},space:{"space-0":"0rem","space-025":"0.0625rem","space-050":"0.125rem","space-100":"0.25rem","space-150":"0.375rem","space-200":"0.5rem","space-300":"0.75rem","space-400":"1rem","space-500":"1.25rem","space-600":"1.5rem","space-800":"2rem","space-1000":"2.5rem","space-1200":"3rem","space-1600":"4rem","space-2000":"5rem","space-2400":"6rem","space-2800":"7rem","space-3200":"8rem","space-button-group-gap":"0.5rem","space-card-gap":"1rem","space-card-padding":"1rem","space-table-cell-padding":"0.375rem"},text:{"text-heading-3xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-3xl-font-size":"2.25rem","text-heading-3xl-font-weight":"700","text-heading-3xl-font-letter-spacing":"-0.03375rem","text-heading-3xl-font-line-height":"3rem","text-heading-2xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-2xl-font-size":"1.875rem","text-heading-2xl-font-weight":"700","text-heading-2xl-font-letter-spacing":"-0.01875rem","text-heading-2xl-font-line-height":"2.5rem","text-heading-xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xl-font-size":"1.5rem","text-heading-xl-font-weight":"700","text-heading-xl-font-letter-spacing":"-0.0125rem","text-heading-xl-font-line-height":"2rem","text-heading-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-lg-font-size":"1.25rem","text-heading-lg-font-weight":"650","text-heading-lg-font-letter-spacing":"-0.0125rem","text-heading-lg-font-line-height":"1.5rem","text-heading-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-md-font-size":"0.875rem","text-heading-md-font-weight":"650","text-heading-md-font-letter-spacing":"0rem","text-heading-md-font-line-height":"1.25rem","text-heading-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-sm-font-size":"0.8125rem","text-heading-sm-font-weight":"650","text-heading-sm-font-letter-spacing":"0rem","text-heading-sm-font-line-height":"1.25rem","text-heading-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xs-font-size":"0.75rem","text-heading-xs-font-weight":"650","text-heading-xs-font-letter-spacing":"0rem","text-heading-xs-font-line-height":"1rem","text-body-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-lg-font-size":"0.875rem","text-body-lg-font-weight":"450","text-body-lg-font-letter-spacing":"0rem","text-body-lg-font-line-height":"1.25rem","text-body-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-md-font-size":"0.8125rem","text-body-md-font-weight":"450","text-body-md-font-letter-spacing":"0rem","text-body-md-font-line-height":"1.25rem","text-body-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-sm-font-size":"0.75rem","text-body-sm-font-weight":"450","text-body-sm-font-letter-spacing":"0rem","text-body-sm-font-line-height":"1rem","text-body-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-xs-font-size":"0.6875rem","text-body-xs-font-weight":"450","text-body-xs-font-letter-spacing":"0rem","text-body-xs-font-line-height":"0.75rem"},width:{"width-0":"0rem","width-025":"0.0625rem","width-050":"0.125rem","width-100":"0.25rem","width-150":"0.375rem","width-200":"0.5rem","width-300":"0.75rem","width-400":"1rem","width-500":"1.25rem","width-600":"1.5rem","width-700":"1.75rem","width-800":"2rem","width-900":"2.25rem","width-1000":"2.5rem","width-1200":"3rem","width-1600":"4rem","width-2000":"5rem","width-2400":"6rem","width-2800":"7rem","width-3200":"8rem"},zIndex:{"z-index-0":"auto","z-index-1":"100","z-index-2":"400","z-index-3":"510","z-index-4":"512","z-index-5":"513","z-index-6":"514","z-index-7":"515","z-index-8":"516","z-index-9":"517","z-index-10":"518","z-index-11":"519","z-index-12":"520"}},"dark-experimental":{border:{"border-radius-0":"0rem","border-radius-050":"0.125rem","border-radius-100":"0.25rem","border-radius-150":"0.375rem","border-radius-200":"0.5rem","border-radius-300":"0.75rem","border-radius-400":"1rem","border-radius-500":"1.25rem","border-radius-750":"1.875rem","border-radius-full":"624.9375rem","border-width-0":"0rem","border-width-0165":"0.04125rem","border-width-025":"0.0625rem","border-width-050":"0.125rem","border-width-100":"0.25rem"},breakpoints:{"breakpoints-xs":"0rem","breakpoints-sm":"30.625rem","breakpoints-md":"48rem","breakpoints-lg":"65rem","breakpoints-xl":"90rem"},color:{"color-scheme":"dark","color-bg":"rgba(26, 26, 26, 1)","color-bg-inverse":"rgba(26, 26, 26, 1)","color-bg-surface":"rgba(48, 48, 48, 1)","color-bg-surface-hover":"rgba(74, 74, 74, 1)","color-bg-surface-active":"rgba(97, 97, 97, 1)","color-bg-surface-selected":"rgba(97, 97, 97, 1)","color-bg-surface-disabled":"rgba(0, 0, 0, 0.05)","color-bg-surface-secondary":"rgba(247, 247, 247, 1)","color-bg-surface-secondary-hover":"rgba(74, 74, 74, 1)","color-bg-surface-secondary-active":"rgba(97, 97, 97, 1)","color-bg-surface-secondary-selected":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary":"rgba(243, 243, 243, 1)","color-bg-surface-tertiary-hover":"rgba(235, 235, 235, 1)","color-bg-surface-tertiary-active":"rgba(227, 227, 227, 1)","color-bg-surface-brand":"rgba(227, 227, 227, 1)","color-bg-surface-brand-hover":"rgba(235, 235, 235, 1)","color-bg-surface-brand-active":"rgba(241, 241, 241, 1)","color-bg-surface-brand-selected":"rgba(74, 74, 74, 1)","color-bg-surface-info":"rgba(234, 244, 255, 1)","color-bg-surface-info-hover":"rgba(224, 240, 255, 1)","color-bg-surface-info-active":"rgba(202, 230, 255, 1)","color-bg-surface-success":"rgba(205, 254, 225, 1)","color-bg-surface-success-hover":"rgba(180, 254, 210, 1)","color-bg-surface-success-active":"rgba(146, 254, 194, 1)","color-bg-surface-caution":"rgba(255, 248, 219, 1)","color-bg-surface-caution-hover":"rgba(255, 244, 191, 1)","color-bg-surface-caution-active":"rgba(255, 239, 157, 1)","color-bg-surface-warning":"rgba(255, 241, 227, 1)","color-bg-surface-warning-hover":"rgba(255, 235, 213, 1)","color-bg-surface-warning-active":"rgba(255, 228, 198, 1)","color-bg-surface-critical":"rgba(254, 233, 232, 1)","color-bg-surface-critical-hover":"rgba(254, 226, 225, 1)","color-bg-surface-critical-active":"rgba(254, 218, 217, 1)","color-bg-surface-emphasis":"rgba(240, 242, 255, 1)","color-bg-surface-emphasis-hover":"rgba(234, 237, 255, 1)","color-bg-surface-emphasis-active":"rgba(226, 231, 255, 1)","color-bg-surface-magic":"rgba(248, 247, 255, 1)","color-bg-surface-magic-hover":"rgba(243, 241, 255, 1)","color-bg-surface-magic-active":"rgba(233, 229, 255, 1)","color-bg-surface-inverse":"rgba(48, 48, 48, 1)","color-bg-surface-transparent":"rgba(0, 0, 0, 0)","color-bg-fill":"rgba(48, 48, 48, 1)","color-bg-fill-hover":"rgba(74, 74, 74, 1)","color-bg-fill-active":"rgba(97, 97, 97, 1)","color-bg-fill-selected":"rgba(97, 97, 97, 1)","color-bg-fill-disabled":"rgba(0, 0, 0, 0.05)","color-bg-fill-secondary":"rgba(241, 241, 241, 1)","color-bg-fill-secondary-hover":"rgba(235, 235, 235, 1)","color-bg-fill-secondary-active":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary":"rgba(227, 227, 227, 1)","color-bg-fill-tertiary-hover":"rgba(212, 212, 212, 1)","color-bg-fill-tertiary-active":"rgba(204, 204, 204, 1)","color-bg-fill-brand":"rgba(255, 255, 255, 1)","color-bg-fill-brand-hover":"rgba(243, 243, 243, 1)","color-bg-fill-brand-active":"rgba(247, 247, 247, 1)","color-bg-fill-brand-selected":"rgba(212, 212, 212, 1)","color-bg-fill-brand-disabled":"rgba(0, 0, 0, 0.17)","color-bg-fill-info":"rgba(145, 208, 255, 1)","color-bg-fill-info-hover":"rgba(81, 192, 255, 1)","color-bg-fill-info-active":"rgba(0, 148, 213, 1)","color-bg-fill-info-secondary":"rgba(213, 235, 255, 1)","color-bg-fill-success":"rgba(41, 132, 90, 1)","color-bg-fill-success-hover":"rgba(19, 111, 69, 1)","color-bg-fill-success-active":"rgba(12, 81, 50, 1)","color-bg-fill-success-secondary":"rgba(180, 254, 210, 1)","color-bg-fill-warning":"rgba(255, 184, 0, 1)","color-bg-fill-warning-hover":"rgba(229, 165, 0, 1)","color-bg-fill-warning-active":"rgba(178, 132, 0, 1)","color-bg-fill-warning-secondary":"rgba(255, 214, 164, 1)","color-bg-fill-caution":"rgba(255, 230, 0, 1)","color-bg-fill-caution-hover":"rgba(234, 211, 0, 1)","color-bg-fill-caution-active":"rgba(225, 203, 0, 1)","color-bg-fill-caution-secondary":"rgba(255, 235, 120, 1)","color-bg-fill-critical":"rgba(229, 28, 0, 1)","color-bg-fill-critical-hover":"rgba(181, 38, 11, 1)","color-bg-fill-critical-active":"rgba(142, 31, 11, 1)","color-bg-fill-critical-selected":"rgba(142, 31, 11, 1)","color-bg-fill-critical-secondary":"rgba(254, 211, 209, 1)","color-bg-fill-emphasis":"rgba(0, 91, 211, 1)","color-bg-fill-emphasis-hover":"rgba(0, 66, 153, 1)","color-bg-fill-emphasis-active":"rgba(0, 46, 106, 1)","color-bg-fill-magic":"rgba(128, 81, 255, 1)","color-bg-fill-magic-secondary":"rgba(233, 229, 255, 1)","color-bg-fill-magic-secondary-hover":"rgba(228, 222, 255, 1)","color-bg-fill-magic-secondary-active":"rgba(223, 217, 255, 1)","color-bg-fill-inverse":"rgba(48, 48, 48, 1)","color-bg-fill-inverse-hover":"rgba(74, 74, 74, 1)","color-bg-fill-inverse-active":"rgba(97, 97, 97, 1)","color-bg-fill-transparent":"rgba(255, 255, 255, 0.11)","color-bg-fill-transparent-hover":"rgba(255, 255, 255, 0.17)","color-bg-fill-transparent-active":"rgba(255, 255, 255, 0.20)","color-bg-fill-transparent-selected":"rgba(255, 255, 255, 0.28)","color-bg-fill-transparent-secondary":"rgba(0, 0, 0, 0.06)","color-bg-fill-transparent-secondary-hover":"rgba(0, 0, 0, 0.08)","color-bg-fill-transparent-secondary-active":"rgba(0, 0, 0, 0.11)","color-text":"rgba(227, 227, 227, 1)","color-text-secondary":"rgba(181, 181, 181, 1)","color-text-disabled":"rgba(181, 181, 181, 1)","color-text-link":"rgba(0, 91, 211, 1)","color-text-link-hover":"rgba(0, 66, 153, 1)","color-text-link-active":"rgba(0, 46, 106, 1)","color-text-brand":"rgba(74, 74, 74, 1)","color-text-brand-hover":"rgba(48, 48, 48, 1)","color-text-brand-on-bg-fill":"rgba(48, 48, 48, 1)","color-text-brand-on-bg-fill-hover":"rgba(227, 227, 227, 1)","color-text-brand-on-bg-fill-active":"rgba(204, 204, 204, 1)","color-text-brand-on-bg-fill-disabled":"rgba(255, 255, 255, 1)","color-text-info":"rgba(0, 58, 90, 1)","color-text-info-hover":"rgba(0, 58, 90, 1)","color-text-info-active":"rgba(0, 33, 51, 1)","color-text-info-secondary":"rgba(0, 124, 180, 1)","color-text-info-on-bg-fill":"rgba(0, 33, 51, 1)","color-text-success":"rgba(12, 81, 50, 1)","color-text-success-hover":"rgba(8, 61, 37, 1)","color-text-success-active":"rgba(9, 42, 27, 1)","color-text-success-secondary":"rgba(41, 132, 90, 1)","color-text-success-on-bg-fill":"rgba(248, 255, 251, 1)","color-text-caution":"rgba(79, 71, 0, 1)","color-text-caution-hover":"rgba(51, 46, 0, 1)","color-text-caution-active":"rgba(31, 28, 0, 1)","color-text-caution-secondary":"rgba(130, 117, 0, 1)","color-text-caution-on-bg-fill":"rgba(51, 46, 0, 1)","color-text-warning":"rgba(94, 66, 0, 1)","color-text-warning-hover":"rgba(65, 45, 0, 1)","color-text-warning-active":"rgba(37, 26, 0, 1)","color-text-warning-secondary":"rgba(149, 111, 0, 1)","color-text-warning-on-bg-fill":"rgba(37, 26, 0, 1)","color-text-critical":"rgba(142, 31, 11, 1)","color-text-critical-hover":"rgba(95, 21, 7, 1)","color-text-critical-active":"rgba(47, 10, 4, 1)","color-text-critical-secondary":"rgba(229, 28, 0, 1)","color-text-critical-on-bg-fill":"rgba(255, 251, 251, 1)","color-text-emphasis":"rgba(0, 91, 211, 1)","color-text-emphasis-hover":"rgba(0, 66, 153, 1)","color-text-emphasis-active":"rgba(0, 46, 106, 1)","color-text-emphasis-on-bg-fill":"rgba(252, 253, 255, 1)","color-text-emphasis-on-bg-fill-hover":"rgba(226, 231, 255, 1)","color-text-emphasis-on-bg-fill-active":"rgba(213, 220, 255, 1)","color-text-magic":"rgba(87, 0, 209, 1)","color-text-magic-secondary":"rgba(113, 38, 255, 1)","color-text-magic-on-bg-fill":"rgba(253, 253, 255, 1)","color-text-inverse":"rgba(227, 227, 227, 1)","color-text-inverse-secondary":"rgba(181, 181, 181, 1)","color-text-link-inverse":"rgba(197, 208, 255, 1)","color-border":"rgba(227, 227, 227, 1)","color-border-hover":"rgba(204, 204, 204, 1)","color-border-disabled":"rgba(235, 235, 235, 1)","color-border-secondary":"rgba(97, 97, 97, 1)","color-border-tertiary":"rgba(204, 204, 204, 1)","color-border-focus":"rgba(0, 91, 211, 1)","color-border-brand":"rgba(227, 227, 227, 1)","color-border-info":"rgba(168, 216, 255, 1)","color-border-success":"rgba(146, 254, 194, 1)","color-border-caution":"rgba(255, 235, 120, 1)","color-border-warning":"rgba(255, 200, 121, 1)","color-border-critical":"rgba(254, 195, 193, 1)","color-border-critical-secondary":"rgba(142, 31, 11, 1)","color-border-emphasis":"rgba(0, 91, 211, 1)","color-border-emphasis-hover":"rgba(0, 66, 153, 1)","color-border-emphasis-active":"rgba(0, 46, 106, 1)","color-border-magic":"rgba(228, 222, 255, 1)","color-border-magic-secondary":"rgba(148, 116, 255, 1)","color-border-magic-secondary-hover":"rgba(128, 81, 255, 1)","color-border-inverse":"rgba(97, 97, 97, 1)","color-border-inverse-hover":"rgba(204, 204, 204, 1)","color-border-inverse-active":"rgba(227, 227, 227, 1)","color-tooltip-tail-down-border-experimental":"rgba(60, 60, 60, 1)","color-tooltip-tail-up-border-experimental":"rgba(71, 71, 71, 1)","color-border-gradient-experimental":"linear-gradient(to bottom, rgba(255, 255, 255, 0.17), rgba(255, 255, 255, 0.03))","color-border-gradient-hover-experimental":"linear-gradient(to bottom, rgba(255, 255, 255, 0.17), rgba(255, 255, 255, 0.03))","color-border-gradient-selected-experimental":"linear-gradient(to bottom, rgba(0, 0, 0, 0.20), rgba(255, 255, 255, 0.20))","color-border-gradient-active-experimental":"linear-gradient(to bottom, rgba(255, 255, 255, 0.20), rgba(255, 255, 255, 0.03))","color-icon":"rgba(227, 227, 227, 1)","color-icon-hover":"rgba(48, 48, 48, 1)","color-icon-active":"rgba(26, 26, 26, 1)","color-icon-disabled":"rgba(204, 204, 204, 1)","color-icon-secondary":"rgba(138, 138, 138, 1)","color-icon-secondary-hover":"rgba(97, 97, 97, 1)","color-icon-secondary-active":"rgba(74, 74, 74, 1)","color-icon-brand":"rgba(26, 26, 26, 1)","color-icon-info":"rgba(0, 148, 213, 1)","color-icon-success":"rgba(41, 132, 90, 1)","color-icon-caution":"rgba(153, 138, 0, 1)","color-icon-warning":"rgba(178, 132, 0, 1)","color-icon-critical":"rgba(239, 77, 47, 1)","color-icon-emphasis":"rgba(0, 91, 211, 1)","color-icon-emphasis-hover":"rgba(0, 66, 153, 1)","color-icon-emphasis-active":"rgba(0, 46, 106, 1)","color-icon-magic":"rgba(128, 81, 255, 1)","color-icon-inverse":"rgba(227, 227, 227, 1)","color-avatar-bg-fill":"rgba(181, 181, 181, 1)","color-avatar-five-bg-fill":"rgba(253, 75, 146, 1)","color-avatar-five-text-on-bg-fill":"rgba(255, 246, 248, 1)","color-avatar-four-bg-fill":"rgba(81, 192, 255, 1)","color-avatar-four-text-on-bg-fill":"rgba(0, 33, 51, 1)","color-avatar-one-bg-fill":"rgba(197, 48, 197, 1)","color-avatar-one-text-on-bg-fill":"rgba(253, 239, 253, 1)","color-avatar-seven-bg-fill":"rgba(148, 116, 255, 1)","color-avatar-seven-text-on-bg-fill":"rgba(248, 247, 255, 1)","color-avatar-six-bg-fill":"rgba(37, 232, 43, 1)","color-avatar-six-text-on-bg-fill":"rgba(3, 61, 5, 1)","color-avatar-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-avatar-three-bg-fill":"rgba(44, 224, 212, 1)","color-avatar-three-text-on-bg-fill":"rgba(3, 60, 57, 1)","color-avatar-two-bg-fill":"rgba(56, 250, 163, 1)","color-avatar-two-text-on-bg-fill":"rgba(12, 81, 50, 1)","color-backdrop-bg":"rgba(0, 0, 0, 0.71)","color-button-gradient-bg-fill":"linear-gradient(180deg, rgba(48, 48, 48, 0) 63.53%, rgba(255, 255, 255, 0.15) 100%)","color-checkbox-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-checkbox-icon-disabled":"rgba(255, 255, 255, 1)","color-input-bg-surface":"rgba(253, 253, 253, 1)","color-input-bg-surface-hover":"rgba(250, 250, 250, 1)","color-input-bg-surface-active":"rgba(247, 247, 247, 1)","color-input-border":"rgba(138, 138, 138, 1)","color-input-border-hover":"rgba(97, 97, 97, 1)","color-input-border-active":"rgba(26, 26, 26, 1)","color-nav-bg":"rgba(235, 235, 235, 1)","color-nav-bg-surface":"rgba(0, 0, 0, 0.02)","color-nav-bg-surface-hover":"rgba(241, 241, 241, 1)","color-nav-bg-surface-active":"rgba(250, 250, 250, 1)","color-nav-bg-surface-selected":"rgba(250, 250, 250, 1)","color-radio-button-bg-surface-disabled":"rgba(0, 0, 0, 0.08)","color-radio-button-icon-disabled":"rgba(255, 255, 255, 1)","color-video-thumbnail-play-button-bg-fill-hover":"rgba(0, 0, 0, 0.81)","color-video-thumbnail-play-button-bg-fill":"rgba(0, 0, 0, 0.71)","color-video-thumbnail-play-button-text-on-bg-fill":"rgba(255, 255, 255, 1)","color-scrollbar-thumb-bg-hover":"rgba(138, 138, 138, 1)"},font:{"font-family-sans":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","font-family-mono":"ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace","font-size-275":"0.6875rem","font-size-300":"0.75rem","font-size-325":"0.8125rem","font-size-350":"0.875rem","font-size-400":"1rem","font-size-450":"1.125rem","font-size-500":"1.25rem","font-size-550":"1.375rem","font-size-600":"1.5rem","font-size-750":"1.875rem","font-size-800":"2rem","font-size-900":"2.25rem","font-size-1000":"2.5rem","font-weight-regular":"450","font-weight-medium":"550","font-weight-semibold":"650","font-weight-bold":"700","font-letter-spacing-densest":"-0.03375rem","font-letter-spacing-denser":"-0.01875rem","font-letter-spacing-dense":"-0.0125rem","font-letter-spacing-normal":"0rem","font-line-height-300":"0.75rem","font-line-height-400":"1rem","font-line-height-500":"1.25rem","font-line-height-600":"1.5rem","font-line-height-700":"1.75rem","font-line-height-800":"2rem","font-line-height-1000":"2.5rem","font-line-height-1200":"3rem"},height:{"height-0":"0rem","height-025":"0.0625rem","height-050":"0.125rem","height-100":"0.25rem","height-150":"0.375rem","height-200":"0.5rem","height-300":"0.75rem","height-400":"1rem","height-500":"1.25rem","height-600":"1.5rem","height-700":"1.75rem","height-800":"2rem","height-900":"2.25rem","height-1000":"2.5rem","height-1200":"3rem","height-1600":"4rem","height-2000":"5rem","height-2400":"6rem","height-2800":"7rem","height-3200":"8rem"},motion:{"motion-duration-0":"0ms","motion-duration-50":"50ms","motion-duration-100":"100ms","motion-duration-150":"150ms","motion-duration-200":"200ms","motion-duration-250":"250ms","motion-duration-300":"300ms","motion-duration-350":"350ms","motion-duration-400":"400ms","motion-duration-450":"450ms","motion-duration-500":"500ms","motion-duration-5000":"5000ms","motion-ease":"cubic-bezier(0.25, 0.1, 0.25, 1)","motion-ease-in":"cubic-bezier(0.42, 0, 1, 1)","motion-ease-out":"cubic-bezier(0.19, 0.91, 0.38, 1)","motion-ease-in-out":"cubic-bezier(0.42, 0, 0.58, 1)","motion-linear":"cubic-bezier(0, 0, 1, 1)","motion-keyframes-bounce":"{ from, 65%, 85% { transform: scale(1) } 75% { transform: scale(0.85) } 82.5% { transform: scale(1.05) } }","motion-keyframes-fade-in":"{ to { opacity: 1 } }","motion-keyframes-pulse":"{ from, 75% { transform: scale(0.85); opacity: 1; } to { transform: scale(2.5); opacity: 0; } }","motion-keyframes-spin":"{ to { transform: rotate(1turn) } }","motion-keyframes-appear-above":"{ from { transform: translateY(var(--p-space-100)); opacity: 0; } to { transform: none; opacity: 1; } }","motion-keyframes-appear-below":"{ from { transform: translateY(calc(var(--p-space-100) * -1)); opacity: 0; } to { transform: none; opacity: 1; } }"},shadow:{"shadow-0":"none","shadow-100":"0rem 0.0625rem 0rem 0rem rgba(26, 26, 26, 0.07)","shadow-200":"0rem 0.1875rem 0.0625rem -0.0625rem rgba(26, 26, 26, 0.07)","shadow-300":"0rem 0.25rem 0.375rem -0.125rem rgba(26, 26, 26, 0.20)","shadow-400":"0rem 0.5rem 1rem -0.25rem rgba(26, 26, 26, 0.22)","shadow-500":"0rem 0.75rem 1.25rem -0.5rem rgba(26, 26, 26, 0.24)","shadow-600":"0rem 1.25rem 1.25rem -0.5rem rgba(26, 26, 26, 0.28)","shadow-bevel-100":"0.0625rem 0rem 0rem 0rem rgba(204, 204, 204, 0.08) inset, -0.0625rem 0rem 0rem 0rem rgba(204, 204, 204, 0.08) inset, 0rem -0.0625rem 0rem 0rem rgba(204, 204, 204, 0.08) inset, 0rem 0.0625rem 0rem 0rem rgba(204, 204, 204, 0.16) inset","shadow-inset-100":"0rem 0.0625rem 0.125rem 0rem rgba(26, 26, 26, 0.15) inset, 0rem 0.0625rem 0.0625rem 0rem rgba(26, 26, 26, 0.15) inset","shadow-inset-200":"0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.20) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset, -0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.12) inset","shadow-button":"0rem -0.0625rem 0rem 0rem #b5b5b5 inset, 0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.1) inset, 0rem 0.03125rem 0rem 0.09375rem #FFF inset","shadow-button-hover":"0rem 0.0625rem 0rem 0rem #EBEBEB inset, -0.0625rem 0rem 0rem 0rem #EBEBEB inset, 0.0625rem 0rem 0rem 0rem #EBEBEB inset, 0rem -0.0625rem 0rem 0rem #CCC inset","shadow-button-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.122) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(26, 26, 26, 0.122) inset, 0rem 0.125rem 0.0625rem 0rem rgba(26, 26, 26, 0.2) inset","shadow-button-primary":"0rem -0.0625rem 0rem 0.0625rem rgba(0, 0, 0, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(48, 48, 48, 1) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.25) inset;","shadow-button-primary-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.24) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.0625rem 0rem 0rem #000 inset, 0rem -0.0625rem 0rem 0.0625rem #1A1A1A","shadow-button-primary-inset":"0rem 0.1875rem 0rem 0rem rgb(0, 0, 0) inset","shadow-button-primary-critical":"0rem -0.0625rem 0rem 0.0625rem rgba(142, 31, 11, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(181, 38, 11, 0.8) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.349) inset","shadow-button-primary-critical-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.48) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.09375rem 0rem 0rem rgba(0, 0, 0, 0.25) inset","shadow-button-primary-critical-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0rem 0.125rem 0rem 0rem rgba(0, 0, 0, 0.6) inset","shadow-button-primary-success":"0rem -0.0625rem 0rem 0.0625rem rgba(12, 81, 50, 0.8) inset, 0rem 0rem 0rem 0.0625rem rgba(19, 111, 69, 0.8) inset, 0rem 0.03125rem 0rem 0.09375rem rgba(255, 255, 255, 0.251) inset","shadow-button-primary-success-hover":"0rem 0.0625rem 0rem 0rem rgba(255, 255, 255, 0.48) inset, 0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, -0.0625rem 0rem 0rem 0rem rgba(255, 255, 255, 0.20) inset, 0rem -0.09375rem 0rem 0rem rgba(0, 0, 0, 0.25) inset","shadow-button-primary-success-inset":"-0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0.0625rem 0rem 0.0625rem 0rem rgba(0, 0, 0, 0.2) inset, 0rem 0.125rem 0rem 0rem rgba(0, 0, 0, 0.6) inset","shadow-border-inset":"0rem 0rem 0rem 0.0625rem rgba(0, 0, 0, 0.08) inset"},space:{"space-0":"0rem","space-025":"0.0625rem","space-050":"0.125rem","space-100":"0.25rem","space-150":"0.375rem","space-200":"0.5rem","space-300":"0.75rem","space-400":"1rem","space-500":"1.25rem","space-600":"1.5rem","space-800":"2rem","space-1000":"2.5rem","space-1200":"3rem","space-1600":"4rem","space-2000":"5rem","space-2400":"6rem","space-2800":"7rem","space-3200":"8rem","space-button-group-gap":"0.5rem","space-card-gap":"1rem","space-card-padding":"1rem","space-table-cell-padding":"0.375rem"},text:{"text-heading-3xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-3xl-font-size":"2.25rem","text-heading-3xl-font-weight":"700","text-heading-3xl-font-letter-spacing":"-0.03375rem","text-heading-3xl-font-line-height":"3rem","text-heading-2xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-2xl-font-size":"1.875rem","text-heading-2xl-font-weight":"700","text-heading-2xl-font-letter-spacing":"-0.01875rem","text-heading-2xl-font-line-height":"2.5rem","text-heading-xl-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xl-font-size":"1.5rem","text-heading-xl-font-weight":"700","text-heading-xl-font-letter-spacing":"-0.0125rem","text-heading-xl-font-line-height":"2rem","text-heading-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-lg-font-size":"1.25rem","text-heading-lg-font-weight":"650","text-heading-lg-font-letter-spacing":"-0.0125rem","text-heading-lg-font-line-height":"1.5rem","text-heading-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-md-font-size":"0.875rem","text-heading-md-font-weight":"650","text-heading-md-font-letter-spacing":"0rem","text-heading-md-font-line-height":"1.25rem","text-heading-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-sm-font-size":"0.8125rem","text-heading-sm-font-weight":"650","text-heading-sm-font-letter-spacing":"0rem","text-heading-sm-font-line-height":"1.25rem","text-heading-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-heading-xs-font-size":"0.75rem","text-heading-xs-font-weight":"650","text-heading-xs-font-letter-spacing":"0rem","text-heading-xs-font-line-height":"1rem","text-body-lg-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-lg-font-size":"0.875rem","text-body-lg-font-weight":"450","text-body-lg-font-letter-spacing":"0rem","text-body-lg-font-line-height":"1.25rem","text-body-md-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-md-font-size":"0.8125rem","text-body-md-font-weight":"450","text-body-md-font-letter-spacing":"0rem","text-body-md-font-line-height":"1.25rem","text-body-sm-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-sm-font-size":"0.75rem","text-body-sm-font-weight":"450","text-body-sm-font-letter-spacing":"0rem","text-body-sm-font-line-height":"1rem","text-body-xs-font-family":"'Inter', -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif","text-body-xs-font-size":"0.6875rem","text-body-xs-font-weight":"450","text-body-xs-font-letter-spacing":"0rem","text-body-xs-font-line-height":"0.75rem"},width:{"width-0":"0rem","width-025":"0.0625rem","width-050":"0.125rem","width-100":"0.25rem","width-150":"0.375rem","width-200":"0.5rem","width-300":"0.75rem","width-400":"1rem","width-500":"1.25rem","width-600":"1.5rem","width-700":"1.75rem","width-800":"2rem","width-900":"2.25rem","width-1000":"2.5rem","width-1200":"3rem","width-1600":"4rem","width-2000":"5rem","width-2400":"6rem","width-2800":"7rem","width-3200":"8rem"},zIndex:{"z-index-0":"auto","z-index-1":"100","z-index-2":"400","z-index-3":"510","z-index-4":"512","z-index-5":"513","z-index-6":"514","z-index-7":"515","z-index-8":"516","z-index-9":"517","z-index-10":"518","z-index-11":"519","z-index-12":"520"}}}),Kr=zr[Fr];Mr(zr[Fr]);function Yr(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)}function qr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function Xr(e,t){return"".concat(e).concat(t.charAt(0).toUpperCase()).concat(t.slice(1))}function Jr(e){const t=Object.entries(e).filter(e=>{let[t,n]=e;return null!=n});return t.length?Object.fromEntries(t):void 0}function Zr(e,t,n,r){if(!r)return{};let i;return i=Yr(r)?Object.fromEntries(Object.entries(r).map(e=>{let[t,r]=e;return[t,"var(--p-".concat(n,"-").concat(r,")")]})):{[Rt[0]]:"var(--p-".concat(n,"-").concat(r,")")},Object.fromEntries(Object.entries(i).map(n=>{let[r,i]=n;return["--pc-".concat(e,"-").concat(t,"-").concat(r),i]}))}function Qr(e,t,n){return n?Yr(n)?Object.fromEntries(Object.entries(n).map(n=>{let[r,i]=n;return["--pc-".concat(e,"-").concat(t,"-").concat(r),i]})):{["--pc-".concat(e,"-").concat(t,"-").concat(Rt[0])]:n}:{}}function $r(e,t){if(!e)return null;const n=Object.keys(e);for(const r of n){if(r===t)return e[t];if(Yr(e[r])){const n=$r(e[r],t);if(n)return n}}return null}function ei(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n="number"===typeof e?e:$r(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"width");return"".concat(n||t,"px")}function ti(e){const[t,n]=(0,i.useState)(e);return{value:t,toggle:(0,i.useCallback)(()=>n(e=>!e),[]),setTrue:(0,i.useCallback)(()=>n(!0),[]),setFalse:(0,i.useCallback)(()=>n(!1),[])}}var ni="Polaris-TopBar",ri="Polaris-TopBar__Container",ii="Polaris-TopBar__LogoDisplayControl",oi="Polaris-TopBar__LogoDisplayContainer",ai="Polaris-TopBar__LogoContainer",si="Polaris-TopBar--hasLogoSuffix",ci="Polaris-TopBar__Logo",li="Polaris-TopBar__LogoLink",di="Polaris-TopBar__ContextControl",ui="Polaris-TopBar__NavigationIcon",hi="Polaris-TopBar--focused",pi="Polaris-TopBar__IconWrapper",mi="Polaris-TopBar__LeftContent",fi="Polaris-TopBar__Search",gi="Polaris-TopBar__RightContent",_i="Polaris-TopBar__SecondaryMenu",vi="Polaris-TopBar-Search",bi="Polaris-TopBar-Search__SearchContent",Ei="Polaris-TopBar-Search--visible",yi="Polaris-TopBar-Search__Results",Si="Polaris-TopBar-SearchDismissOverlay",Ti="Polaris-TopBar-SearchDismissOverlay--visible";class Ci extends Error{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super("".concat(e?"".concat(e," "):e,"Your application must be wrapped in an <AppProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.")),this.name="MissingAppProviderError"}}const wi=(0,i.createContext)(void 0);function Ri(e){const t=function(){const e=(0,i.useContext)(wi);if(!e)throw new Ci("No ScrollLockManager was provided.");return e}();return(0,i.useEffect)(()=>(t.registerScrollLock(),()=>{t.unregisterScrollLock()}),[t]),null}function Ai(e){let{onDismiss:t,visible:n}=e;const r=(0,i.useRef)(null),o=(0,i.useCallback)(e=>{let{target:n}=e;n===r.current&&null!=t&&t()},[t]);return i.createElement(i.Fragment,null,n?i.createElement(Ri,null):null,i.createElement("div",{ref:r,className:qr(Si,n&&Ti),onClick:o}))}function Ii(e){let{visible:t,children:n,onDismiss:r,overlayVisible:o=!1}=e;if(null==n)return null;const a=t?i.createElement(Ai,{onDismiss:r,visible:o}):null;return i.createElement(i.Fragment,null,a,i.createElement("div",{className:qr(vi,t&&Ei)},i.createElement("div",{className:bi},i.createElement("div",{className:yi},n))))}var Ni=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M13.03 6.97a.75.75 0 0 1 0 1.06l-1.97 1.97 1.97 1.97a.75.75 0 1 1-1.06 1.06l-1.97-1.97-1.97 1.97a.75.75 0 0 1-1.06-1.06l1.97-1.97-1.97-1.97a.75.75 0 0 1 1.06-1.06l1.97 1.97 1.97-1.97a.75.75 0 0 1 1.06 0Z"}),i.createElement("path",{fillRule:"evenodd",d:"M10 17a7 7 0 1 0 0-14 7 7 0 0 0 0 14Zm0-1.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11Z"}))};Ni.displayName="XCircleIcon";var Oi=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M12.323 13.383a5.5 5.5 0 1 1 1.06-1.06l2.897 2.897a.75.75 0 1 1-1.06 1.06l-2.897-2.897Zm.677-4.383a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"}))};Oi.displayName="SearchIcon";var Pi="Polaris-TopBar-SearchField",ki="Polaris-TopBar-SearchField--focused",Di="Polaris-TopBar-SearchField__Input",xi="Polaris-TopBar-SearchField__Backdrop",Li="Polaris-TopBar-SearchField__BackdropShowFocusBorder",Mi="Polaris-TopBar-SearchField__Icon",Ui="Polaris-TopBar-SearchField__Clear";const Fi=(0,i.createContext)(void 0);function ji(){const e=(0,i.useContext)(Fi);if(!e)throw new Ci("No i18n was provided.");return e}const Vi="undefined"===typeof window||"undefined"===typeof document,Bi=Vi?i.useEffect:i.useLayoutEffect,Wi="767.95px",Hi="1039.95px",Gi={media:"",addListener:zi,removeListener:zi,matches:!1,onchange:zi,addEventListener:zi,removeEventListener:zi,dispatchEvent:e=>!0};function zi(){}function Ki(){return"undefined"===typeof window?Gi:window.matchMedia("(max-width: ".concat(Wi,")"))}const Yi=function(e){const t=Object.entries(Gt(e));return t.map(e=>{let[t,n]=e;return Object.entries(n).map(e=>{let[n,r]=e;const i=t.split("-")[1];var o;return["".concat(i).concat((o=n).charAt(0).toUpperCase()+o.slice(1)),r]})}).flat()}(Kr.breakpoints);function qi(e,t){return Vi||t?"object"===typeof e&&null!==e?Object.fromEntries(Yi.map(t=>{var n;let[r]=t;return[r,null!==(n=e[r])&&void 0!==n&&n]})):Object.fromEntries(Yi.map(t=>{let[n]=t;return[n,null!==e&&void 0!==e&&e]})):Object.fromEntries(Yi.map(e=>{let[t,n]=e;return[t,window.matchMedia(n).matches]}))}function Xi(e){const[t,n]=(0,i.useState)(qi(null===e||void 0===e?void 0:e.defaults,!0));return Bi(()=>{const e=Yi.map(e=>{let[t,n]=e;return window.matchMedia(n)}),t=()=>n(qi());return e.forEach(e=>{e.addListener?e.addListener(t):e.addEventListener("change",t)}),t(),()=>{e.forEach(e=>{e.removeListener?e.removeListener(t):e.removeEventListener("change",t)})}},[]),t}var Ji={Icon:"Polaris-Icon",toneInherit:"Polaris-Icon--toneInherit",toneBase:"Polaris-Icon--toneBase",toneSubdued:"Polaris-Icon--toneSubdued",toneCaution:"Polaris-Icon--toneCaution",toneWarning:"Polaris-Icon--toneWarning",toneCritical:"Polaris-Icon--toneCritical",toneInteractive:"Polaris-Icon--toneInteractive",toneInfo:"Polaris-Icon--toneInfo",toneSuccess:"Polaris-Icon--toneSuccess",tonePrimary:"Polaris-Icon--tonePrimary",toneEmphasis:"Polaris-Icon--toneEmphasis",toneMagic:"Polaris-Icon--toneMagic",toneTextCaution:"Polaris-Icon--toneTextCaution",toneTextWarning:"Polaris-Icon--toneTextWarning",toneTextCritical:"Polaris-Icon--toneTextCritical",toneTextInfo:"Polaris-Icon--toneTextInfo",toneTextPrimary:"Polaris-Icon--toneTextPrimary",toneTextSuccess:"Polaris-Icon--toneTextSuccess",toneTextMagic:"Polaris-Icon--toneTextMagic",Svg:"Polaris-Icon__Svg",Img:"Polaris-Icon__Img",Placeholder:"Polaris-Icon__Placeholder"},Zi={root:"Polaris-Text--root",block:"Polaris-Text--block",truncate:"Polaris-Text--truncate",visuallyHidden:"Polaris-Text--visuallyHidden",start:"Polaris-Text--start",center:"Polaris-Text--center",end:"Polaris-Text--end",justify:"Polaris-Text--justify",base:"Polaris-Text--base",inherit:"Polaris-Text--inherit",disabled:"Polaris-Text--disabled",success:"Polaris-Text--success",critical:"Polaris-Text--critical",caution:"Polaris-Text--caution",subdued:"Polaris-Text--subdued",magic:"Polaris-Text--magic","magic-subdued":"Polaris-Text__magic--subdued","text-inverse":"Polaris-Text__text--inverse","text-inverse-secondary":"Polaris-Text--textInverseSecondary",headingXs:"Polaris-Text--headingXs",headingSm:"Polaris-Text--headingSm",headingMd:"Polaris-Text--headingMd",headingLg:"Polaris-Text--headingLg",headingXl:"Polaris-Text--headingXl",heading2xl:"Polaris-Text--heading2xl",heading3xl:"Polaris-Text--heading3xl",bodyXs:"Polaris-Text--bodyXs",bodySm:"Polaris-Text--bodySm",bodyMd:"Polaris-Text--bodyMd",bodyLg:"Polaris-Text--bodyLg",regular:"Polaris-Text--regular",medium:"Polaris-Text--medium",semibold:"Polaris-Text--semibold",bold:"Polaris-Text--bold",break:"Polaris-Text--break",numeric:"Polaris-Text--numeric","line-through":"Polaris-Text__line--through"};const Qi=e=>{let{alignment:t,as:n,breakWord:r,children:o,tone:a,fontWeight:s,id:c,numeric:l=!1,truncate:d=!1,variant:u,visuallyHidden:h=!1,textDecorationLine:p}=e;const m=n||(h?"span":"p"),f=qr(Zi.root,u&&Zi[u],s&&Zi[s],(t||d)&&Zi.block,t&&Zi[t],r&&Zi.break,a&&Zi[a],l&&Zi.numeric,d&&Zi.truncate,h&&Zi.visuallyHidden,p&&Zi[p]);return i.createElement(m,Object.assign({className:f},c&&{id:c}),o)};function $i(e){let t,{source:n,tone:r,accessibilityLabel:o}=e;t="function"===typeof n?"function":"placeholder"===n?"placeholder":"external";const a=qr(Ji.Icon,r&&Ji[Xr("tone",r)]),{mdDown:s}=Xi(),c=n,l={function:i.createElement(c,Object.assign({className:Ji.Svg,focusable:"false","aria-hidden":"true"},s?{viewBox:"1 1 18 18"}:{})),placeholder:i.createElement("div",{className:Ji.Placeholder}),external:i.createElement("img",{className:Ji.Img,src:"data:image/svg+xml;utf8,".concat(n),alt:"","aria-hidden":"true"})};return i.createElement("span",{className:a},o&&i.createElement(Qi,{as:"span",visuallyHidden:!0},o),l[t])}function eo(e){"Enter"===e.key&&e.preventDefault()}var to={Details:"Polaris-TopBar-UserMenu__Details"},no="Polaris-MessageIndicator__MessageIndicatorWrapper",ro="Polaris-MessageIndicator";function io(e){let{children:t,active:n}=e;const r=n&&i.createElement("div",{className:ro});return i.createElement("div",{className:no},r,t)}var oo={ActivatorWrapper:"Polaris-TopBar-Menu__ActivatorWrapper",Activator:"Polaris-TopBar-Menu__Activator","Activator-userMenu":"Polaris-TopBar-Menu__Activator--userMenu",Section:"Polaris-TopBar-Menu__Section"},ao="Polaris-Menu-Message__Section";const so=(0,i.createContext)(!1);var co="Polaris-Link",lo="Polaris-Link--monochrome",uo="Polaris-Link--removeUnderline";const ho={"data-polaris-scrollable":!0},po="[data-polaris-scrollable]",mo={props:{"data-polaris-overlay":!0},selector:"[data-polaris-overlay]"},fo={props:{"data-polaris-layer":!0},selector:"[data-polaris-layer]"},go={"data-polaris-unstyled":!0},_o="[data-polaris-top-bar]",vo="[data-portal-id]",bo=(0,i.createContext)(void 0);const Eo=["external","url","target"],yo=(0,i.memo)((0,i.forwardRef)(function(e,t){const n=(0,i.useContext)(bo);if(n)return i.createElement(n,Object.assign({},go,e,{ref:t}));const{external:r,url:a,target:s}=e,c=(0,o.A)(e,Eo);let l;l=r?"_blank":null!==s&&void 0!==s?s:void 0;const d="_blank"===l?"noopener noreferrer":void 0;return i.createElement("a",Object.assign({target:l},c,{href:a,rel:d},go,{ref:t}))}));function So(e){let{url:t,children:n,onClick:r,external:o,target:a,id:s,monochrome:c,removeUnderline:l,accessibilityLabel:d,dataPrimaryLink:u}=e;return i.createElement(so.Consumer,null,e=>{const h=qr(co,(c||e)&&lo,l&&uo);return t?i.createElement(yo,{onClick:r,className:h,url:t,external:o,target:a,id:s,"aria-label":d,"data-primary-link":u},n):i.createElement("button",{type:"button",onClick:r,className:h,id:s,"aria-label":d,"data-primary-link":u},n)})}const To=(0,i.createContext)(!1);var Co={Badge:"Polaris-Badge",toneSuccess:"Polaris-Badge--toneSuccess","toneSuccess-strong":"Polaris-Badge__toneSuccess--strong",toneInfo:"Polaris-Badge--toneInfo","toneInfo-strong":"Polaris-Badge__toneInfo--strong",toneAttention:"Polaris-Badge--toneAttention","toneAttention-strong":"Polaris-Badge__toneAttention--strong",toneWarning:"Polaris-Badge--toneWarning","toneWarning-strong":"Polaris-Badge__toneWarning--strong",toneCritical:"Polaris-Badge--toneCritical","toneCritical-strong":"Polaris-Badge__toneCritical--strong",toneNew:"Polaris-Badge--toneNew",toneMagic:"Polaris-Badge--toneMagic","toneRead-only":"Polaris-Badge__toneRead--only",toneEnabled:"Polaris-Badge--toneEnabled",sizeLarge:"Polaris-Badge--sizeLarge",withinFilter:"Polaris-Badge--withinFilter",Icon:"Polaris-Badge__Icon",PipContainer:"Polaris-Badge__PipContainer"};let wo,Ro;function Ao(e,t,n){let r="",i="";if(!t&&!n)return"";switch(t){case Ro.Incomplete:r=e.translate("Polaris.Badge.PROGRESS_LABELS.incomplete");break;case Ro.PartiallyComplete:r=e.translate("Polaris.Badge.PROGRESS_LABELS.partiallyComplete");break;case Ro.Complete:r=e.translate("Polaris.Badge.PROGRESS_LABELS.complete")}switch(n){case wo.Info:case wo.InfoStrong:i=e.translate("Polaris.Badge.TONE_LABELS.info");break;case wo.Success:case wo.SuccessStrong:i=e.translate("Polaris.Badge.TONE_LABELS.success");break;case wo.Warning:case wo.WarningStrong:i=e.translate("Polaris.Badge.TONE_LABELS.warning");break;case wo.Critical:case wo.CriticalStrong:i=e.translate("Polaris.Badge.TONE_LABELS.critical");break;case wo.Attention:case wo.AttentionStrong:i=e.translate("Polaris.Badge.TONE_LABELS.attention");break;case wo.New:i=e.translate("Polaris.Badge.TONE_LABELS.new");break;case wo.ReadOnly:i=e.translate("Polaris.Badge.TONE_LABELS.readOnly");break;case wo.Enabled:i=e.translate("Polaris.Badge.TONE_LABELS.enabled")}return!n&&t?r:n&&!t?i:e.translate("Polaris.Badge.progressAndTone",{progressLabel:r,toneLabel:i})}!function(e){e.Info="info",e.Success="success",e.Warning="warning",e.Critical="critical",e.Attention="attention",e.New="new",e.Magic="magic",e.InfoStrong="info-strong",e.SuccessStrong="success-strong",e.WarningStrong="warning-strong",e.CriticalStrong="critical-strong",e.AttentionStrong="attention-strong",e.ReadOnly="read-only",e.Enabled="enabled"}(wo||(wo={})),function(e){e.Incomplete="incomplete",e.PartiallyComplete="partiallyComplete",e.Complete="complete"}(Ro||(Ro={}));var Io={Pip:"Polaris-Badge-Pip",toneInfo:"Polaris-Badge-Pip--toneInfo",toneSuccess:"Polaris-Badge-Pip--toneSuccess",toneNew:"Polaris-Badge-Pip--toneNew",toneAttention:"Polaris-Badge-Pip--toneAttention",toneWarning:"Polaris-Badge-Pip--toneWarning",toneCritical:"Polaris-Badge-Pip--toneCritical",progressIncomplete:"Polaris-Badge-Pip--progressIncomplete",progressPartiallyComplete:"Polaris-Badge-Pip--progressPartiallyComplete",progressComplete:"Polaris-Badge-Pip--progressComplete"};const No="medium",Oo={complete:()=>i.createElement("svg",{viewBox:"0 0 20 20"},i.createElement("path",{d:"M6 10c0-.93 0-1.395.102-1.776a3 3 0 0 1 2.121-2.122C8.605 6 9.07 6 10 6c.93 0 1.395 0 1.776.102a3 3 0 0 1 2.122 2.122C14 8.605 14 9.07 14 10s0 1.395-.102 1.777a3 3 0 0 1-2.122 2.12C11.395 14 10.93 14 10 14s-1.395 0-1.777-.102a3 3 0 0 1-2.12-2.121C6 11.395 6 10.93 6 10Z"})),partiallyComplete:()=>i.createElement("svg",{viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"m8.888 6.014-.017-.018-.02.02c-.253.013-.45.038-.628.086a3 3 0 0 0-2.12 2.122C6 8.605 6 9.07 6 10s0 1.395.102 1.777a3 3 0 0 0 2.121 2.12C8.605 14 9.07 14 10 14c.93 0 1.395 0 1.776-.102a3 3 0 0 0 2.122-2.121C14 11.395 14 10.93 14 10c0-.93 0-1.395-.102-1.776a3 3 0 0 0-2.122-2.122C11.395 6 10.93 6 10 6c-.475 0-.829 0-1.112.014ZM8.446 7.34a1.75 1.75 0 0 0-1.041.94l4.314 4.315c.443-.2.786-.576.941-1.042L8.446 7.34Zm4.304 2.536L10.124 7.25c.908.001 1.154.013 1.329.06a1.75 1.75 0 0 1 1.237 1.237c.047.175.059.42.06 1.329ZM8.547 12.69c.182.05.442.06 1.453.06h.106L7.25 9.894V10c0 1.01.01 1.27.06 1.453a1.75 1.75 0 0 0 1.237 1.237Z"})),incomplete:()=>i.createElement("svg",{viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M8.547 12.69c.183.05.443.06 1.453.06s1.27-.01 1.453-.06a1.75 1.75 0 0 0 1.237-1.237c.05-.182.06-.443.06-1.453s-.01-1.27-.06-1.453a1.75 1.75 0 0 0-1.237-1.237c-.182-.05-.443-.06-1.453-.06s-1.27.01-1.453.06A1.75 1.75 0 0 0 7.31 8.547c-.05.183-.06.443-.06 1.453s.01 1.27.06 1.453a1.75 1.75 0 0 0 1.237 1.237ZM6.102 8.224C6 8.605 6 9.07 6 10s0 1.395.102 1.777a3 3 0 0 0 2.122 2.12C8.605 14 9.07 14 10 14s1.395 0 1.777-.102a3 3 0 0 0 2.12-2.121C14 11.395 14 10.93 14 10c0-.93 0-1.395-.102-1.776a3 3 0 0 0-2.121-2.122C11.395 6 10.93 6 10 6c-.93 0-1.395 0-1.776.102a3 3 0 0 0-2.122 2.122Z"}))};function Po(e){let{children:t,tone:n,progress:r,icon:o,size:a=No,toneAndProgressLabelOverride:s}=e;const c=ji(),l=(0,i.useContext)(To),d=qr(Co.Badge,n&&Co[Xr("tone",n)],a&&a!==No&&Co[Xr("size",a)],l&&Co.withinFilter),u=s||Ao(c,r,n);let h=Boolean(u)&&i.createElement(Qi,{as:"span",visuallyHidden:!0},u);return r&&!o&&(h=i.createElement("span",{className:Co.Icon},i.createElement($i,{accessibilityLabel:u,source:Oo[r]}))),i.createElement("span",{className:d},h,o&&i.createElement("span",{className:Co.Icon},i.createElement($i,{source:o})),t&&i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"new"===n?"medium":void 0},t))}function ko(e){const{top:t,left:n,bottom:r,right:i}=e.getBoundingClientRect();return t>=0&&i<=window.innerWidth&&r<=window.innerHeight&&n>=0}Po.Pip=function(e){let{tone:t,progress:n="complete",accessibilityLabelOverride:r}=e;const o=ji(),a=qr(Io.Pip,t&&Io[Xr("tone",t)],n&&Io[Xr("progress",n)]),s=r||Ao(o,n,t);return i.createElement("span",{className:a},i.createElement(Qi,{as:"span",visuallyHidden:!0},s))};const Do='a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not([aria-disabled="true"]):not([tabindex="-1"]):not(:disabled),*[tabindex]',xo='a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not([aria-disabled="true"]):not([tabindex="-1"]):not(:disabled),*[tabindex]:not([tabindex="-1"])',Lo=e=>{let{currentTarget:t}=e;return t.blur()};function Mo(e){return!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&Go(e,Do)?e:e.querySelector(Do)}function Uo(e){const t="a,button,frame,iframe,input:not([type=hidden]),select,textarea,*[tabindex]";return Go(e,t)?e:e.querySelector(t)}function Fo(e){var t;null===(t=Mo(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]))||void 0===t||t.focus()}function jo(e,t){const n=function(e,t){const n=[...document.querySelectorAll(Do)],r=n.indexOf(e)+1,i=n.slice(r);for(const o of i)if(ko(o)&&(!t||t&&t(o)))return o;return null}(e,t);return!!(n&&n instanceof HTMLElement)&&(n.focus(),!0)}function Vo(e){return!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&Go(e,xo)?e:e.querySelector(xo)}function Bo(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&Go(e,xo))return e;const t=e.querySelectorAll(xo);return t[t.length-1]}function Wo(e){return e.querySelectorAll('a[role="menuitem"],frame[role="menuitem"],iframe[role="menuitem"],input[role="menuitem"]:not([type=hidden]):not(:disabled),select[role="menuitem"]:not(:disabled),textarea[role="menuitem"]:not(:disabled),button[role="menuitem"]:not(:disabled),*[tabindex]:not([tabindex="-1"])')}function Ho(e,t){let n=0;for(const r of e){if(r===t)break;n++}return n===e.length?-1:n}function Go(e,t){if(e.matches)return e.matches(t);const n=(e.ownerDocument||document).querySelectorAll(t);let r=n.length;for(;--r>=0&&n.item(r)!==e;)return r>-1}function zo(e,t,n){return null==e?null:Yo(e,t)?e:i.createElement(t,n,e)}const Ko=(e,t)=>e===t;function Yo(e,t){var n;if(null==e||!(0,i.isValidElement)(e)||"string"===typeof e.type)return!1;const{type:r}=e,o=(null===(n=e.props)||void 0===n?void 0:n.__type__)||r;return(Array.isArray(t)?t:[t]).some(e=>"string"!==typeof o&&Ko(e,o))}function qo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return i.Children.toArray(e).filter(e=>(0,i.isValidElement)(e)&&t(e))}function Xo(e){let{condition:t,wrapper:n,children:r}=e;return t?n(r):r}function Jo(e){let{condition:t,children:n}=e;return t?n:null}let Zo;!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Pause=19]="Pause",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Key0=48]="Key0",e[e.Key1=49]="Key1",e[e.Key2=50]="Key2",e[e.Key3=51]="Key3",e[e.Key4=52]="Key4",e[e.Key5=53]="Key5",e[e.Key6=54]="Key6",e[e.Key7=55]="Key7",e[e.Key8=56]="Key8",e[e.Key9=57]="Key9",e[e.KeyA=65]="KeyA",e[e.KeyB=66]="KeyB",e[e.KeyC=67]="KeyC",e[e.KeyD=68]="KeyD",e[e.KeyE=69]="KeyE",e[e.KeyF=70]="KeyF",e[e.KeyG=71]="KeyG",e[e.KeyH=72]="KeyH",e[e.KeyI=73]="KeyI",e[e.KeyJ=74]="KeyJ",e[e.KeyK=75]="KeyK",e[e.KeyL=76]="KeyL",e[e.KeyM=77]="KeyM",e[e.KeyN=78]="KeyN",e[e.KeyO=79]="KeyO",e[e.KeyP=80]="KeyP",e[e.KeyQ=81]="KeyQ",e[e.KeyR=82]="KeyR",e[e.KeyS=83]="KeyS",e[e.KeyT=84]="KeyT",e[e.KeyU=85]="KeyU",e[e.KeyV=86]="KeyV",e[e.KeyW=87]="KeyW",e[e.KeyX=88]="KeyX",e[e.KeyY=89]="KeyY",e[e.KeyZ=90]="KeyZ",e[e.LeftMeta=91]="LeftMeta",e[e.RightMeta=92]="RightMeta",e[e.Select=93]="Select",e[e.Numpad0=96]="Numpad0",e[e.Numpad1=97]="Numpad1",e[e.Numpad2=98]="Numpad2",e[e.Numpad3=99]="Numpad3",e[e.Numpad4=100]="Numpad4",e[e.Numpad5=101]="Numpad5",e[e.Numpad6=102]="Numpad6",e[e.Numpad7=103]="Numpad7",e[e.Numpad8=104]="Numpad8",e[e.Numpad9=105]="Numpad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.Decimal=110]="Decimal",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.Semicolon=186]="Semicolon",e[e.Equals=187]="Equals",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBracket=221]="CloseBracket",e[e.SingleQuote=222]="SingleQuote"}(Zo||(Zo={}));var Qo={Popover:"Polaris-Popover",PopoverOverlay:"Polaris-Popover__PopoverOverlay","PopoverOverlay-noAnimation":"Polaris-Popover__PopoverOverlay--noAnimation","PopoverOverlay-entering":"Polaris-Popover__PopoverOverlay--entering","PopoverOverlay-open":"Polaris-Popover__PopoverOverlay--open",measuring:"Polaris-Popover--measuring","PopoverOverlay-exiting":"Polaris-Popover__PopoverOverlay--exiting",fullWidth:"Polaris-Popover--fullWidth",Content:"Polaris-Popover__Content",positionedAbove:"Polaris-Popover--positionedAbove",positionedCover:"Polaris-Popover--positionedCover",ContentContainer:"Polaris-Popover__ContentContainer","Content-fullHeight":"Polaris-Popover__Content--fullHeight","Content-fluidContent":"Polaris-Popover__Content--fluidContent",Pane:"Polaris-Popover__Pane","Pane-fixed":"Polaris-Popover__Pane--fixed","Pane-subdued":"Polaris-Popover__Pane--subdued","Pane-captureOverscroll":"Polaris-Popover__Pane--captureOverscroll",Section:"Polaris-Popover__Section",FocusTracker:"Polaris-Popover__FocusTracker","PopoverOverlay-hideOnPrint":"Polaris-Popover__PopoverOverlay--hideOnPrint"},$o="Polaris-Box--listReset",ea="Polaris-Box",ta="Polaris-Box--visuallyHidden",na="Polaris-Box--printHidden";const ra=["as","background","borderColor","borderStyle","borderWidth","borderBlockStartWidth","borderBlockEndWidth","borderInlineStartWidth","borderInlineEndWidth","borderRadius","borderEndStartRadius","borderEndEndRadius","borderStartStartRadius","borderStartEndRadius","children","color","id","minHeight","minWidth","maxWidth","overflowX","overflowY","outlineColor","outlineStyle","outlineWidth","padding","paddingBlock","paddingBlockStart","paddingBlockEnd","paddingInline","paddingInlineStart","paddingInlineEnd","role","shadow","tabIndex","width","printHidden","visuallyHidden","position","insetBlockStart","insetBlockEnd","insetInlineStart","insetInlineEnd","zIndex","opacity"],ia=(0,i.forwardRef)((e,t)=>{let{as:n="div",background:r,borderColor:s,borderStyle:c,borderWidth:l,borderBlockStartWidth:d,borderBlockEndWidth:u,borderInlineStartWidth:h,borderInlineEndWidth:p,borderRadius:m,borderEndStartRadius:f,borderEndEndRadius:g,borderStartStartRadius:_,borderStartEndRadius:v,children:b,color:E,id:y,minHeight:S,minWidth:T,maxWidth:C,overflowX:w,overflowY:R,outlineColor:A,outlineStyle:I,outlineWidth:N,padding:O,paddingBlock:P,paddingBlockStart:k,paddingBlockEnd:D,paddingInline:x,paddingInlineStart:L,paddingInlineEnd:M,role:U,shadow:F,tabIndex:j,width:V,printHidden:B,visuallyHidden:W,position:H,insetBlockStart:G,insetBlockEnd:z,insetInlineStart:K,insetInlineEnd:Y,zIndex:q,opacity:X}=e,J=(0,o.A)(e,ra);const Z=c||(s||l||d||u||h||p?"solid":void 0),Q=I||(A||N?"solid":void 0),$=(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({"--pc-box-color":E?"var(--p-color-".concat(E,")"):void 0,"--pc-box-background":r?"var(--p-color-".concat(r,")"):void 0,"--pc-box-border-color":s?"transparent"===s?"transparent":"var(--p-color-".concat(s,")"):void 0,"--pc-box-border-style":Z,"--pc-box-border-radius":m?"var(--p-border-radius-".concat(m,")"):void 0,"--pc-box-border-end-start-radius":f?"var(--p-border-radius-".concat(f,")"):void 0,"--pc-box-border-end-end-radius":g?"var(--p-border-radius-".concat(g,")"):void 0,"--pc-box-border-start-start-radius":_?"var(--p-border-radius-".concat(_,")"):void 0,"--pc-box-border-start-end-radius":v?"var(--p-border-radius-".concat(v,")"):void 0,"--pc-box-border-width":l?"var(--p-border-width-".concat(l,")"):void 0,"--pc-box-border-block-start-width":d?"var(--p-border-width-".concat(d,")"):void 0,"--pc-box-border-block-end-width":u?"var(--p-border-width-".concat(u,")"):void 0,"--pc-box-border-inline-start-width":h?"var(--p-border-width-".concat(h,")"):void 0,"--pc-box-border-inline-end-width":p?"var(--p-border-width-".concat(p,")"):void 0,"--pc-box-min-height":S,"--pc-box-min-width":T,"--pc-box-max-width":C,"--pc-box-outline-color":A?"var(--p-color-".concat(A,")"):void 0,"--pc-box-outline-style":Q,"--pc-box-outline-width":N?"var(--p-border-width-".concat(N,")"):void 0,"--pc-box-overflow-x":w,"--pc-box-overflow-y":R},Zr("box","padding-block-start","space",k||P||O)),Zr("box","padding-block-end","space",D||P||O)),Zr("box","padding-inline-start","space",L||x||O)),Zr("box","padding-inline-end","space",M||x||O)),{},{"--pc-box-shadow":F?"var(--p-shadow-".concat(F,")"):void 0,"--pc-box-width":V,position:H,"--pc-box-inset-block-start":G?"var(--p-space-".concat(G,")"):void 0,"--pc-box-inset-block-end":z?"var(--p-space-".concat(z,")"):void 0,"--pc-box-inset-inline-start":K?"var(--p-space-".concat(K,")"):void 0,"--pc-box-inset-inline-end":Y?"var(--p-space-".concat(Y,")"):void 0,zIndex:q,opacity:X}),ee=qr(ea,W&&ta,B&&na,"ul"===n&&$o);return i.createElement(n,(0,a.A)({className:ee,id:y,ref:t,style:Jr($),role:U,tabIndex:j},J),b)});function oa(e){let{children:t}=e;return i.createElement("div",{className:Qo.Section},i.createElement(ia,{paddingInlineStart:"300",paddingInlineEnd:"300",paddingBlockStart:"200",paddingBlockEnd:"150"},t))}function aa(e,t,n){let r,i,o,a,s,c,l=0,d=!1,u=!1,h=!0;const p=!t&&0!==t;if("function"!==typeof e)throw new TypeError("Expected a function");const m=t||0;function f(t){const n=r,o=i;return r=void 0,i=void 0,l=t,a=e.apply(o,n),a}function g(e,t){return p?(cancelAnimationFrame(s),requestAnimationFrame(e)):setTimeout(e,t)}function _(e){const t=e-c;return void 0===c||t>=m||t<0||u&&o&&e-l>=o}function v(){const e=Date.now();if(_(e))return b(e);s=g(v,function(e){const t=e-l,n=m-(e-c);return u&&o?Math.min(n,o-t):n}(e))}function b(e){return s=void 0,h&&r?f(e):(r=i=void 0,a)}function E(){const e=Date.now(),t=_(e);for(var n=arguments.length,o=new Array(n),h=0;h<n;h++)o[h]=arguments[h];if(r=o,i=this,c=e,t){if(void 0===s)return function(e){return l=e,s=g(v,m),d?f(e):a}(c);if(u)return s=g(v,m),f(c)}return void 0===s&&(s=g(v,m)),a}return"object"===typeof n&&(d=Boolean(n.leading),u="maxWait"in n,o=u?Math.max(Number(n.maxWait)||0,m):void 0,h="trailing"in n?Boolean(n.trailing):h),E.cancel=function(){void 0!==s&&function(e){if(p)return cancelAnimationFrame(e);clearTimeout(e)}(s),l=0,r=c=i=s=void 0},E.flush=function(){return void 0===s?a:b(Date.now())},E.pending=function(){return void 0!==s},E}ia.displayName="Box";const sa=Symbol("unique_identifier");function ca(){const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t(!0)},[]),e}function la(e){const t=ca(),n=(0,i.useRef)(!1);if(t&&!n.current)return n.current=!0,e()}const da=(0,i.createContext)(void 0);var ua={Scrollable:"Polaris-Scrollable",hasTopShadow:"Polaris-Scrollable--hasTopShadow",hasBottomShadow:"Polaris-Scrollable--hasBottomShadow",horizontal:"Polaris-Scrollable--horizontal",vertical:"Polaris-Scrollable--vertical",scrollbarWidthThin:"Polaris-Scrollable--scrollbarWidthThin",scrollbarWidthNone:"Polaris-Scrollable--scrollbarWidthNone",scrollbarWidthAuto:"Polaris-Scrollable--scrollbarWidthAuto",scrollbarGutterStable:"Polaris-Scrollable--scrollbarGutterStable","scrollbarGutterStableboth-edges":"Polaris-Scrollable__scrollbarGutterStableboth--edges"};class ha{static get zero(){return new ha}constructor(){let{top:e=0,left:t=0,width:n=0,height:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.top=e,this.left=t,this.width=n,this.height=r}get center(){return{x:this.left+this.width/2,y:this.top+this.height/2}}}function pa(e){if(!(e instanceof Element))return new ha({width:window.innerWidth,height:window.innerHeight});const t=e.getBoundingClientRect();return new ha({top:t.top,left:t.left,width:t.width,height:t.height})}const ma=1e3/60;class fa{constructor(e){this.stickyItems=[],this.stuckItems=[],this.container=null,this.topBarOffset=0,this.handleResize=aa(()=>{this.manageStickyItems()},ma,{leading:!0,trailing:!0,maxWait:ma}),this.handleScroll=aa(()=>{this.manageStickyItems()},ma,{leading:!0,trailing:!0,maxWait:ma}),e&&this.setContainer(e)}registerStickyItem(e){this.stickyItems.push(e)}unregisterStickyItem(e){const t=this.stickyItems.findIndex(t=>{let{stickyNode:n}=t;return e===n});this.stickyItems.splice(t,1)}setContainer(e){this.container=e,ga(e)&&this.setTopBarOffset(e),this.container.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize),this.manageStickyItems()}removeScrollListener(){this.container&&(this.container.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize))}manageStickyItems(){if(this.stickyItems.length<=0)return;const e=this.container?ga(t=this.container)?document.body.scrollTop||document.documentElement.scrollTop:t.scrollTop:0;var t;const n=pa(this.container).top+this.topBarOffset;this.stickyItems.forEach(t=>{const{handlePositioning:r}=t,{sticky:i,top:o,left:a,width:s}=this.evaluateStickyItem(t,e,n);this.updateStuckItems(t,i),r(i,o,a,s)})}evaluateStickyItem(e,t,n){const{stickyNode:r,placeHolderNode:i,boundingElement:o,offset:a,disableWhenStacked:s}=e;if(s&&("undefined"===typeof window?Gi:window.matchMedia("(max-width: ".concat(Hi,")"))).matches)return{sticky:!1,top:0,left:0,width:"auto"};const c=a?this.getOffset(r)+parseInt(Kr.space["space-500"],10):this.getOffset(r),l=t+c,d=i.getBoundingClientRect().top-n+t,u=n+c,h=i.getBoundingClientRect().width,p=i.getBoundingClientRect().left;let m;if(null==o)m=l>=d;else{var f;const e=r.getBoundingClientRect().height||(null===(f=r.firstElementChild)||void 0===f?void 0:f.getBoundingClientRect().height)||0,i=o.getBoundingClientRect().bottom-e+t-n;m=l>=d&&l<i}return{sticky:m,top:u,left:p,width:h}}updateStuckItems(e,t){const{stickyNode:n}=e;t&&!this.isNodeStuck(n)?this.addStuckItem(e):!t&&this.isNodeStuck(n)&&this.removeStuckItem(e)}addStuckItem(e){this.stuckItems.push(e)}removeStuckItem(e){const{stickyNode:t}=e,n=this.stuckItems.findIndex(e=>{let{stickyNode:n}=e;return t===n});this.stuckItems.splice(n,1)}getOffset(e){if(0===this.stuckItems.length)return 0;let t=0,n=0;const r=this.stuckItems.length,i=pa(e);for(;n<r;){const r=this.stuckItems[n].stickyNode;if(r===e)break;_a(i,pa(r))||(t+=pa(r).height);n++}return t}isNodeStuck(e){return this.stuckItems.findIndex(t=>{let{stickyNode:n}=t;return e===n})>=0}setTopBarOffset(e){const t=e.querySelector(":not(".concat(po,") ").concat(_o));this.topBarOffset=t?t.clientHeight:0}}function ga(e){return e===document}function _a(e,t){const n=e.left,r=e.left+e.width,i=t.left;return t.left+t.width<n||r<i}const va=(0,i.createContext)(void 0),ba=["children","className","horizontal","vertical","shadow","hint","focusable","scrollbarWidth","scrollbarGutter","onScrolledToBottom"],Ea=100,ya=(0,i.forwardRef)((e,t)=>{let{children:n,className:r,horizontal:a=!0,vertical:s=!0,shadow:c,hint:l,focusable:d,scrollbarWidth:u="thin",scrollbarGutter:h,onScrolledToBottom:p}=e,m=(0,o.A)(e,ba);const[f,g]=(0,i.useState)(!1),[_,v]=(0,i.useState)(!1),b=function(e){const t=(0,i.useRef)(sa);return t.current===sa&&(t.current=e()),t}(()=>new fa),E=(0,i.useRef)(null),y=(0,i.useCallback)(function(e){var t;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).behavior||"smooth",r=Sa()?"auto":n;null===(t=E.current)||void 0===t||t.scrollTo({top:e,behavior:r})},[]),S=(0,i.useRef)();(0,i.useImperativeHandle)(t||S,()=>({scrollTo:y}));const T=(0,i.useCallback)(()=>{const e=E.current;e&&requestAnimationFrame(()=>{const{scrollTop:t,clientHeight:n,scrollHeight:r}=e,i=Boolean(r>n),o=Boolean(t>0),a=Boolean(t+n>=r-2);g(o),v(!a),i&&a&&p&&p()})},[p]);la(()=>{T(),l&&requestAnimationFrame(()=>function(e){if(!e||Sa())return;const t=e.scrollHeight-e.clientHeight,n=Math.min(Ea,t)-2,r=()=>{requestAnimationFrame(()=>{e.scrollTop>=n&&(e.removeEventListener("scroll",r),e.scrollTo({top:0,behavior:"smooth"}))})};e.addEventListener("scroll",r),e.scrollTo({top:Ea,behavior:"smooth"})}(E.current))}),(0,i.useEffect)(()=>{var e;const t=E.current;if(!t)return;const n=aa(T,50,{trailing:!0});return null===(e=b.current)||void 0===e||e.setContainer(t),t.addEventListener("scroll",T),globalThis.addEventListener("resize",n),()=>{t.removeEventListener("scroll",T),globalThis.removeEventListener("resize",n)}},[b,T]);const C=qr(r,ua.Scrollable,s&&ua.vertical,a&&ua.horizontal,c&&f&&ua.hasTopShadow,c&&_&&ua.hasBottomShadow,u&&ua[Xr("scrollbarWidth",u)],h&&ua[Xr("scrollbarGutter",h.replace(" ",""))]);return i.createElement(da.Provider,{value:y},i.createElement(va.Provider,{value:b.current},i.createElement("div",Object.assign({className:C},ho,m,{ref:E,tabIndex:d?0:void 0}),n)))});function Sa(){try{return window.matchMedia("(prefers-reduced-motion: reduce)").matches}catch(e){return!1}}ya.displayName="Scrollable";const Ta=ya;function Ca(e){let{captureOverscroll:t=!1,fixed:n,sectioned:r,children:o,height:a,subdued:s,onScrolledToBottom:c}=e;const l=qr(Qo.Pane,n&&Qo["Pane-fixed"],s&&Qo["Pane-subdued"],t&&Qo["Pane-captureOverscroll"]),d=r?zo(o,oa,{}):o,u=a?{height:a,maxHeight:a,minHeight:a}:void 0;return n?i.createElement("div",{style:u,className:l},d):i.createElement(Ta,{shadow:!0,className:l,style:u,onScrolledToBottom:c,scrollbarWidth:"thin"},d)}Ta.ScrollTo=function(){const e=(0,i.useRef)(null),t=(0,i.useContext)(da);(0,i.useEffect)(()=>{t&&e.current&&t(e.current.offsetTop)},[t]);const n=(0,i.useId)();return i.createElement("a",{id:n,ref:e})},Ta.forNode=e=>{const t=e.closest(po);return t instanceof HTMLElement?t:document};const wa=(0,i.createContext)(void 0),Ra=["passive"];class Aa extends i.PureComponent{componentDidMount(){this.attachListener()}componentDidUpdate(e){let{passive:t}=e,n=(0,o.A)(e,Ra);this.detachListener(n),this.attachListener()}componentWillUnmount(){this.detachListener()}render(){return null}attachListener(){const{event:e,handler:t,capture:n,passive:r}=this.props;window.addEventListener(e,t,{capture:n,passive:r})}detachListener(e){const{event:t,handler:n,capture:r}=e||this.props;window.removeEventListener(t,n,r)}}function Ia(e){let{keyCode:t,handler:n,keyEvent:r="keyup",options:o,useCapture:a}=e;const s=(0,i.useRef)({handler:n,keyCode:t});Bi(()=>{s.current={handler:n,keyCode:t}},[n,t]);const c=(0,i.useCallback)(e=>{const{handler:t,keyCode:n}=s.current;e.keyCode===n&&t(e)},[]);return(0,i.useEffect)(()=>(document.addEventListener(r,c,a||o),()=>{document.removeEventListener(r,c,a||o)}),[r,c,a,o]),null}function Na(e,t){const{center:n}=e;return n.y<t.top||n.y>t.top+t.height}function Oa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pa();const n=Math.max(e.top,0),r=Math.max(e.left,0),i=Math.min(e.top+e.height,t.height),o=Math.min(e.left+e.width,t.width);return new ha({top:n,left:r,height:i-n,width:o-r})}function Pa(){return new ha({top:window.scrollY,left:window.scrollX,height:window.innerHeight,width:document.body.clientWidth})}var ka="Polaris-PositionedOverlay",Da="Polaris-PositionedOverlay--fixed",xa="Polaris-PositionedOverlay--preventInteraction";const La={childList:!0,subtree:!0,characterData:!0,attributeFilter:["style"]};class Ma extends i.PureComponent{constructor(e){super(e),this.state={measuring:!0,activatorRect:pa(this.props.activator),right:void 0,left:void 0,top:0,height:0,width:null,positioning:"below",zIndex:null,outsideScrollableContainer:!1,lockPosition:!1,chevronOffset:0},this.overlay=null,this.scrollableContainers=[],this.overlayDetails=()=>{const{measuring:e,left:t,right:n,positioning:r,height:i,activatorRect:o,chevronOffset:a}=this.state;return{measuring:e,left:t,right:n,desiredHeight:i,positioning:r,activatorRect:o,chevronOffset:a}},this.setOverlay=e=>{this.overlay=e},this.setScrollableContainers=()=>{const e=[];let t=Ta.forNode(this.props.activator);if(t)for(e.push(t);null!==(n=t)&&void 0!==n&&n.parentElement;){var n;t=Ta.forNode(t.parentElement),e.push(t)}this.scrollableContainers=e},this.registerScrollHandlers=()=>{this.scrollableContainers.forEach(e=>{e.addEventListener("scroll",this.handleMeasurement)})},this.unregisterScrollHandlers=()=>{this.scrollableContainers.forEach(e=>{e.removeEventListener("scroll",this.handleMeasurement)})},this.handleMeasurement=()=>{const{lockPosition:e,top:t}=this.state;this.observer.disconnect(),this.setState(e=>{let{left:t,top:n,right:r}=e;return{left:t,right:r,top:n,height:0,positioning:"below",measuring:!0}},()=>{if(null==this.overlay||null==this.firstScrollableContainer)return;const{activator:n,preferredPosition:r="below",preferredAlignment:i="center",onScrollOut:o,fullWidth:s,fixed:c,preferInputActivator:l=!0}=this.props,d=pa(l&&n.querySelector("input")||n),u=pa(this.overlay),h=this.firstScrollableContainer===document?document.body:this.firstScrollableContainer;const p=pa(h),m=s||"cover"===r?new ha((0,a.A)((0,a.A)({},u),{},{width:d.width})):u;h===document.body&&(p.height=document.body.scrollHeight);let f=0;const g=h.querySelector("".concat(_o));g&&(f=g.clientHeight);const _=this.overlay.firstElementChild&&this.overlay.firstChild instanceof HTMLElement?function(e){const t=window.getComputedStyle(e);return{activator:parseFloat(t.marginTop||"0"),container:parseFloat(t.marginBottom||"0"),horizontal:parseFloat(t.marginLeft||"0")}}(this.overlay.firstElementChild):{activator:0,container:0,horizontal:0},v=Pa(),b=function(e){const t=e.closest(fo.selector)||document.body,n=t===document.body?"auto":parseInt(window.getComputedStyle(t).zIndex||"0",10);return"auto"===n||isNaN(n)?null:n}(n),E=null==b?b:b+1,y=function(e,t,n,r,i,o,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;const c=e.top,l=c+e.height,d=e.top-s,u=i.height-e.top-e.height,h=t.height,p=n.activator+n.container,m=n.container,f=e.top-Math.max(r.top,0),g=i.top+Math.min(i.height,r.top+r.height)-(e.top+e.height),_=f>=m,v=g>=m,b=Math.min(d,h),E=Math.min(u,h),y=Math.min(d+e.height,h),S=Math.min(u+e.height,h),T=a?0:i.top,C={height:b-p,top:c+T-b,positioning:"above"},w={height:E-p,top:l+T,positioning:"below"},R={height:S-p,top:c+T,positioning:"cover"},A={height:y-p,top:c+T-b+e.height+p,positioning:"cover"};return"above"===o?(_||f>=g&&!v)&&(d>h||d>u)?C:w:"below"===o?(v||g>=f&&!_)&&(u>h||u>d)?w:C:"cover"===o?(v||g>=f&&!_)&&(u+e.height>h||u>d)?R:A:_&&v?d>u?C:w:f>m?C:w}(d,m,_,p,v,r,c,f),S=function(e,t,n,r,i){const o=n.width-t.width;if("left"===i)return Math.min(o,Math.max(0,e.left-r.horizontal));if("right"===i){const t=n.width-(e.left+e.width);return Math.min(o,Math.max(0,t-r.horizontal))}return Math.min(o,Math.max(0,e.center.x-t.width/2))}(d,m,v,_,i),T=d.center.x-S+2*_.horizontal;this.setState({measuring:!1,activatorRect:pa(n),left:"right"!==i?S:void 0,right:"right"===i?S:void 0,top:e?t:y.top,lockPosition:Boolean(c),height:y.height||0,width:s||"cover"===r?m.width:null,positioning:y.positioning,outsideScrollableContainer:null!=o&&Na(d,Oa(p)),zIndex:E,chevronOffset:T},()=>{this.overlay&&(this.observer.observe(this.overlay,La),this.observer.observe(n,La))})})},this.observer=new MutationObserver(this.handleMeasurement)}componentDidMount(){this.setScrollableContainers(),this.scrollableContainers.length&&!this.props.fixed&&this.registerScrollHandlers(),this.handleMeasurement()}componentWillUnmount(){this.observer.disconnect(),this.scrollableContainers.length&&!this.props.fixed&&this.unregisterScrollHandlers()}componentDidUpdate(){const{outsideScrollableContainer:e,top:t}=this.state,{onScrollOut:n,active:r}=this.props;r&&null!=n&&0!==t&&e&&n()}render(){const{left:e,right:t,top:n,zIndex:r,width:o}=this.state,{render:a,fixed:s,preventInteraction:c,classNames:l,zIndexOverride:d}=this.props,u={top:null==n||isNaN(n)?void 0:n,left:null==e||isNaN(e)?void 0:e,right:null==t||isNaN(t)?void 0:t,width:null==o||isNaN(o)?void 0:o,zIndex:d||r||void 0},h=qr(ka,s&&Da,c&&xa,l);return i.createElement("div",{className:h,style:u,ref:this.setOverlay},i.createElement(Aa,{event:"resize",handler:this.handleMeasurement}),a(this.overlayDetails()))}get firstScrollableContainer(){var e;return null!==(e=this.scrollableContainers[0])&&void 0!==e?e:null}forceUpdatePosition(){requestAnimationFrame(this.handleMeasurement)}}let Ua;var Fa;!function(e){e[e.Click=0]="Click",e[e.EscapeKeypress=1]="EscapeKeypress",e[e.FocusOut=2]="FocusOut",e[e.ScrollOut=3]="ScrollOut"}(Ua||(Ua={})),function(e){e.Entering="entering",e.Entered="entered",e.Exiting="exiting",e.Exited="exited"}(Fa||(Fa={}));class ja extends i.PureComponent{constructor(e){super(e),this.state={transitionStatus:this.props.active?Fa.Entering:Fa.Exited},this.contentNode=(0,i.createRef)(),this.renderPopover=e=>{const{measuring:t,desiredHeight:n,positioning:r}=e,{id:o,children:a,sectioned:s,fullWidth:c,fullHeight:l,fluidContent:d,hideOnPrint:u,autofocusTarget:h,captureOverscroll:p}=this.props,m=qr(Qo.Popover,t&&Qo.measuring,(c||"cover"===r)&&Qo.fullWidth,u&&Qo["PopoverOverlay-hideOnPrint"],r&&Qo[Xr("positioned",r)]),f=t?void 0:{height:n},g=qr(Qo.Content,l&&Qo["Content-fullHeight"],d&&Qo["Content-fluidContent"]);return i.createElement("div",Object.assign({className:m},mo.props),i.createElement(Aa,{event:"click",handler:this.handleClick}),i.createElement(Aa,{event:"touchstart",handler:this.handleClick}),i.createElement(Ia,{keyCode:Zo.Escape,handler:this.handleEscape}),i.createElement("div",{className:Qo.FocusTracker,tabIndex:0,onFocus:this.handleFocusFirstItem}),i.createElement("div",{className:Qo.ContentContainer},i.createElement("div",{id:o,tabIndex:"none"===h?void 0:-1,className:g,style:f,ref:this.contentNode},function(e,t){const n=i.Children.toArray(e);if(Yo(n[0],Ca))return n;return zo(n,Ca,t)}(a,{captureOverscroll:p,sectioned:s}))),i.createElement("div",{className:Qo.FocusTracker,tabIndex:0,onFocus:this.handleFocusLastItem}))},this.handleClick=e=>{const t=e.target,{contentNode:n,props:{activator:r,onClose:i,preventCloseOnChildOverlayClick:o}}=this,a=e.composedPath(),s=o?function(e,t){return e.some(e=>e instanceof Node&&(null===t||void 0===t?void 0:t.contains(e)))}(a,this.context.container):Ba(a,n),c=Va(r,t);s||c||this.state.transitionStatus!==Fa.Entered||i(Ua.Click)},this.handleScrollOut=()=>{this.props.onClose(Ua.ScrollOut)},this.handleEscape=e=>{const t=e.target,{contentNode:n,props:{activator:r}}=this,i=Ba(e.composedPath(),n),o=Va(r,t);(i||o)&&this.props.onClose(Ua.EscapeKeypress)},this.handleFocusFirstItem=()=>{this.props.onClose(Ua.FocusOut)},this.handleFocusLastItem=()=>{this.props.onClose(Ua.FocusOut)},this.overlayRef=(0,i.createRef)()}forceUpdatePosition(){var e;null===(e=this.overlayRef.current)||void 0===e||e.forceUpdatePosition()}changeTransitionStatus(e,t){this.setState({transitionStatus:e},t),this.contentNode.current&&this.contentNode.current.getBoundingClientRect()}componentDidMount(){this.props.active&&(this.focusContent(),this.changeTransitionStatus(Fa.Entered))}componentDidUpdate(e){this.props.active&&!e.active&&(this.focusContent(),this.changeTransitionStatus(Fa.Entering,()=>{this.clearTransitionTimeout(),this.enteringTimer=window.setTimeout(()=>{this.setState({transitionStatus:Fa.Entered})},parseInt(Kr.motion["motion-duration-100"],10))})),!this.props.active&&e.active&&(this.clearTransitionTimeout(),this.setState({transitionStatus:Fa.Exited}))}componentWillUnmount(){this.clearTransitionTimeout()}render(){const{active:e,activator:t,fullWidth:n,preferredPosition:r="below",preferredAlignment:o="center",preferInputActivator:a=!0,fixed:s,zIndexOverride:c}=this.props,{transitionStatus:l}=this.state;if(l===Fa.Exited&&!e)return null;const d=qr(Qo.PopoverOverlay,l===Fa.Entering&&Qo["PopoverOverlay-entering"],l===Fa.Entered&&Qo["PopoverOverlay-open"],l===Fa.Exiting&&Qo["PopoverOverlay-exiting"],"cover"===r&&Qo["PopoverOverlay-noAnimation"]);return i.createElement(Ma,{ref:this.overlayRef,fullWidth:n,active:e,activator:t,preferInputActivator:a,preferredPosition:r,preferredAlignment:o,render:this.renderPopover.bind(this),fixed:s,onScrollOut:this.handleScrollOut,classNames:d,zIndexOverride:c})}clearTransitionTimeout(){this.enteringTimer&&window.clearTimeout(this.enteringTimer)}focusContent(){const{autofocusTarget:e="container"}=this.props;"none"!==e&&null!=this.contentNode&&requestAnimationFrame(()=>{if(null==this.contentNode.current)return;const t=Vo(this.contentNode.current);t&&"first-node"===e?t.focus({preventScroll:!1}):this.contentNode.current.focus({preventScroll:!1})})}}function Va(e,t){if(e===t)return!0;let n=t.parentNode;for(;null!=n;){if(n===e)return!0;n=n.parentNode}return!1}function Ba(e,t){return null!=t.current&&e.includes(t.current)}ja.contextType=wa;var Wa=n(7950);const Ha=(0,i.createContext)(null),Ga=(0,i.createContext)(null);function za(e){return zr[e]}function Ka(){const e=(0,i.useContext)(Ha);if(!e)throw new Error("No theme was provided. Your application must be wrapped in an <AppProvider> or <ThemeProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return e}var Ya="Polaris-ThemeProvider--themeContainer";const qa=["light","dark-experimental"];function Xa(e){const{as:t="div",children:n,className:r,theme:o=Fr}=e;return i.createElement(Ga.Provider,{value:o},i.createElement(Ha.Provider,{value:za(o)},i.createElement(t,{"data-portal-id":e["data-portal-id"],className:qr(Lr(o),Ya,r)},n)))}function Ja(e){let{children:t,idPrefix:n="",onPortalCreated:r=Za}=e;const o=function(){const e=(0,i.useContext)(Ga);if(!e)throw new Error("No themeName was provided. Your application must be wrapped in an <AppProvider> or <ThemeProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return e}(),{container:a}=function(){const e=(0,i.useContext)(wa);if(!e)throw new Error("No portals manager was provided. Your application must be wrapped in an <AppProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return e}(),s=(0,i.useId)(),c=""!==n?"".concat(n,"-").concat(s):s;return(0,i.useEffect)(()=>{r()},[r]),a?(0,Wa.createPortal)(i.createElement(Xa,{theme:(l=o,qa.includes(l)?o:Fr),"data-portal-id":c},t),a):null;var l}function Za(){}const Qa=["activatorWrapper","children","onClose","activator","preventFocusOnClose","active","fixed","ariaHaspopup","preferInputActivator","zIndexOverride"],$a=(0,i.forwardRef)(function(e,t){let{activatorWrapper:n="div",children:r,onClose:a,activator:s,preventFocusOnClose:c,active:l,fixed:d,ariaHaspopup:u,preferInputActivator:h=!0,zIndexOverride:p}=e,m=(0,o.A)(e,Qa);const[f,g]=(0,i.useState)(),_=(0,i.useRef)(null),v=(0,i.useRef)(null),b=n,E=(0,i.useId)();function y(){var e;null===(e=_.current)||void 0===e||e.forceUpdatePosition()}(0,i.useImperativeHandle)(t,()=>({forceUpdatePosition:y}));const S=(0,i.useCallback)(()=>{if(null==v.current)return;const e=Uo(v.current)||v.current,t="disabled"in e&&Boolean(e.disabled);!function(e,t){let{id:n,active:r=!1,ariaHaspopup:i,activatorDisabled:o=!1}=t;o||(e.tabIndex=e.tabIndex||0),e.setAttribute("aria-controls",n),e.setAttribute("aria-owns",n),e.setAttribute("aria-expanded",String(r)),e.setAttribute("data-state",r?"open":"closed"),null!=i&&e.setAttribute("aria-haspopup",String(i))}(e,{id:E,active:l,ariaHaspopup:u,activatorDisabled:t})},[E,l,u]);(0,i.useEffect)(()=>{(!f&&v.current||f&&v.current&&!v.current.contains(f))&&g(v.current.firstElementChild),S()},[f,S]),(0,i.useEffect)(()=>{f&&v.current&&g(v.current.firstElementChild),S()},[f,S]);const T=f?i.createElement(Ja,{idPrefix:"popover"},i.createElement(ja,Object.assign({ref:_,id:E,activator:f,preferInputActivator:h,onClose:e=>{if(a(e),null!=v.current&&!c)if(e===Ua.FocusOut&&f){const e=Uo(f)||Uo(v.current)||v.current;jo(e,es)||e.focus()}else if(e===Ua.EscapeKeypress&&f){const e=Uo(f)||Uo(v.current)||v.current;e?e.focus():jo(e,es)}},active:l,fixed:d,zIndexOverride:p},m),r)):null;return i.createElement(b,{ref:v},i.Children.only(s),T)});function es(e){let t=e.parentElement;for(;t;){if(t.matches(vo))return!1;t=t.parentElement}return!0}const ts=Object.assign($a,{Pane:Ca,Section:oa});var ns={LegacyStack:"Polaris-LegacyStack",Item:"Polaris-LegacyStack__Item",noWrap:"Polaris-LegacyStack--noWrap",spacingNone:"Polaris-LegacyStack--spacingNone",spacingExtraTight:"Polaris-LegacyStack--spacingExtraTight",spacingTight:"Polaris-LegacyStack--spacingTight",spacingBaseTight:"Polaris-LegacyStack--spacingBaseTight",spacingLoose:"Polaris-LegacyStack--spacingLoose",spacingExtraLoose:"Polaris-LegacyStack--spacingExtraLoose",distributionLeading:"Polaris-LegacyStack--distributionLeading",distributionTrailing:"Polaris-LegacyStack--distributionTrailing",distributionCenter:"Polaris-LegacyStack--distributionCenter",distributionEqualSpacing:"Polaris-LegacyStack--distributionEqualSpacing",distributionFill:"Polaris-LegacyStack--distributionFill",distributionFillEvenly:"Polaris-LegacyStack--distributionFillEvenly",alignmentLeading:"Polaris-LegacyStack--alignmentLeading",alignmentTrailing:"Polaris-LegacyStack--alignmentTrailing",alignmentCenter:"Polaris-LegacyStack--alignmentCenter",alignmentFill:"Polaris-LegacyStack--alignmentFill",alignmentBaseline:"Polaris-LegacyStack--alignmentBaseline",vertical:"Polaris-LegacyStack--vertical","Item-fill":"Polaris-LegacyStack__Item--fill"};function rs(e){let{children:t,fill:n}=e;const r=qr(ns.Item,n&&ns["Item-fill"]);return i.createElement("div",{className:r},t)}const is=(0,i.memo)(function(e){let{children:t,vertical:n,spacing:r,distribution:o,alignment:a,wrap:s}=e;const c=qr(ns.LegacyStack,n&&ns.vertical,r&&ns[Xr("spacing",r)],o&&ns[Xr("distribution",o)],a&&ns[Xr("alignment",a)],!1===s&&ns.noWrap),l=qo(t).map((e,t)=>zo(e,rs,{key:t}));return i.createElement("div",{className:c},l)});is.Item=rs;var os={TextContainer:"Polaris-TextContainer",spacingTight:"Polaris-TextContainer--spacingTight",spacingLoose:"Polaris-TextContainer--spacingLoose"};function as(e){let{spacing:t,children:n}=e;const r=qr(os.TextContainer,t&&os[Xr("spacing",t)]);return i.createElement("div",{className:r},n)}var ss=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M14.53 12.28a.75.75 0 0 1-1.06 0l-3.47-3.47-3.47 3.47a.75.75 0 0 1-1.06-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 0 1 0 1.06Z"}))};ss.displayName="ChevronUpIcon";var cs=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M5.72 8.47a.75.75 0 0 1 1.06 0l3.47 3.47 3.47-3.47a.75.75 0 1 1 1.06 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 0-1.06Z"}))};cs.displayName="ChevronDownIcon";var ls=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10.884 4.323a1.25 1.25 0 0 0-1.768 0l-2.646 2.647a.75.75 0 0 0 1.06 1.06l2.47-2.47 2.47 2.47a.75.75 0 1 0 1.06-1.06l-2.646-2.647Z"}),i.createElement("path",{d:"m13.53 13.03-2.646 2.647a1.25 1.25 0 0 1-1.768 0l-2.646-2.647a.75.75 0 0 1 1.06-1.06l2.47 2.47 2.47-2.47a.75.75 0 0 1 1.06 1.06Z"}))};ls.displayName="SelectIcon";var ds={Button:"Polaris-Button",disabled:"Polaris-Button--disabled",pressed:"Polaris-Button--pressed",variantPrimary:"Polaris-Button--variantPrimary",variantSecondary:"Polaris-Button--variantSecondary",variantTertiary:"Polaris-Button--variantTertiary",variantPlain:"Polaris-Button--variantPlain",removeUnderline:"Polaris-Button--removeUnderline",variantMonochromePlain:"Polaris-Button--variantMonochromePlain",toneSuccess:"Polaris-Button--toneSuccess",toneCritical:"Polaris-Button--toneCritical",sizeMicro:"Polaris-Button--sizeMicro",sizeSlim:"Polaris-Button--sizeSlim",sizeMedium:"Polaris-Button--sizeMedium",sizeLarge:"Polaris-Button--sizeLarge",textAlignCenter:"Polaris-Button--textAlignCenter",textAlignStart:"Polaris-Button--textAlignStart",textAlignLeft:"Polaris-Button--textAlignLeft",textAlignEnd:"Polaris-Button--textAlignEnd",textAlignRight:"Polaris-Button--textAlignRight",fullWidth:"Polaris-Button--fullWidth",iconOnly:"Polaris-Button--iconOnly",iconWithText:"Polaris-Button--iconWithText",disclosure:"Polaris-Button--disclosure",loading:"Polaris-Button--loading",pressable:"Polaris-Button--pressable",hidden:"Polaris-Button--hidden",Icon:"Polaris-Button__Icon",Spinner:"Polaris-Button__Spinner"},us={Spinner:"Polaris-Spinner",sizeSmall:"Polaris-Spinner--sizeSmall",sizeLarge:"Polaris-Spinner--sizeLarge"};function hs(e){let{size:t="large",accessibilityLabel:n,hasFocusableParent:r}=e;const o=ca(),s=qr(us.Spinner,t&&us[Xr("size",t)]),c="large"===t?i.createElement("svg",{viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M15.542 1.487A21.507 21.507 0 00.5 22c0 11.874 9.626 21.5 21.5 21.5 9.847 0 18.364-6.675 20.809-16.072a1.5 1.5 0 00-2.904-.756C37.803 34.755 30.473 40.5 22 40.5 11.783 40.5 3.5 32.217 3.5 22c0-8.137 5.3-15.247 12.942-17.65a1.5 1.5 0 10-.9-2.863z"})):i.createElement("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M7.229 1.173a9.25 9.25 0 1011.655 11.412 1.25 1.25 0 10-2.4-.698 6.75 6.75 0 11-8.506-8.329 1.25 1.25 0 10-.75-2.385z"})),l=(0,a.A)({},!r&&{role:"status"}),d=(o||!r)&&i.createElement(Qi,{as:"span",visuallyHidden:!0},n);return i.createElement(i.Fragment,null,i.createElement("span",{className:s},c),i.createElement("span",l,d))}const ps=["id","children","className","url","external","target","download","submit","disabled","loading","pressed","accessibilityLabel","role","ariaControls","ariaExpanded","ariaDescribedBy","ariaChecked","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","onMouseEnter","onTouchStart"];function ms(e){let t,{id:n,children:r,className:s,url:c,external:l,target:d,download:u,submit:h,disabled:p,loading:m,pressed:f,accessibilityLabel:g,role:_,ariaControls:v,ariaExpanded:b,ariaDescribedBy:E,ariaChecked:y,onClick:S,onFocus:T,onBlur:C,onKeyDown:w,onKeyPress:R,onKeyUp:A,onMouseEnter:I,onTouchStart:N}=e,O=(0,o.A)(e,ps);const P={id:n,className:s,"aria-label":g},k=(0,a.A)((0,a.A)({},P),{},{role:_,onClick:S,onFocus:T,onBlur:C,onMouseUp:Lo,onMouseEnter:I,onTouchStart:N}),D=function(e,t){const n=(0,i.useCallback)(t=>{e&&(t.preventDefault(),t.stopPropagation())},[e]);return e?n:t}(p,S);return t=c?p?i.createElement("a",P,r):i.createElement(yo,Object.assign({},k,{url:c,external:l,target:d,download:u},O),r):i.createElement("button",Object.assign({},k,{"aria-disabled":p,type:h?"submit":"button","aria-busy":!!m||void 0,"aria-controls":v,"aria-expanded":b,"aria-describedby":E,"aria-checked":y,"aria-pressed":f,onKeyDown:w,onKeyUp:A,onKeyPress:R,onClick:D,tabIndex:p?-1:void 0},O),r),t}function fs(e){let{id:t,children:n,url:r,disabled:o,external:a,download:s,target:c,submit:l,loading:d,pressed:u,accessibilityLabel:h,role:p,ariaControls:m,ariaExpanded:f,ariaDescribedBy:g,ariaChecked:_,onClick:v,onFocus:b,onBlur:E,onKeyDown:y,onKeyPress:S,onKeyUp:T,onMouseEnter:C,onTouchStart:w,onPointerDown:R,icon:A,disclosure:I,removeUnderline:N,size:O="medium",textAlign:P="center",fullWidth:k,dataPrimaryLink:D,tone:x,variant:L="secondary"}=e;const M=ji(),U=o||d,{mdUp:F}=Xi(),j=qr(ds.Button,ds.pressable,ds[Xr("variant",L)],ds[Xr("size",O)],ds[Xr("textAlign",P)],k&&ds.fullWidth,I&&ds.disclosure,A&&n&&ds.iconWithText,A&&null==n&&ds.iconOnly,U&&ds.disabled,d&&ds.loading,u&&!o&&!r&&ds.pressed,N&&ds.removeUnderline,x&&ds[Xr("tone",x)]),V=I?i.createElement("span",{className:d?ds.hidden:ds.Icon},i.createElement($i,{source:d?"placeholder":gs(I,ss,cs)})):null,B="string"===typeof(W=A)||"object"===typeof W&&W.body||"function"===typeof W?i.createElement($i,{source:d?"placeholder":A}):A;var W;const H=B?i.createElement("span",{className:d?ds.hidden:ds.Icon},B):null,G=["plain","monochromePlain"].includes(L);let z="medium";G?z="regular":"primary"===L&&(z=F?"medium":"semibold");let K="bodySm";("large"===O||G&&"micro"!==O)&&(K="bodyMd");const Y=n?i.createElement(Qi,{as:"span",variant:K,fontWeight:z,key:o?"text-disabled":"text"},n):null,q=d?i.createElement("span",{className:ds.Spinner},i.createElement(hs,{size:"small",accessibilityLabel:M.translate("Polaris.Button.spinnerAccessibilityLabel")})):null,X={id:t,className:j,accessibilityLabel:h,ariaDescribedBy:g,role:p,onClick:v,onFocus:b,onBlur:E,onMouseUp:Lo,onMouseEnter:C,onTouchStart:w,"data-primary-link":D},J={url:r,external:a,download:s,target:c},Z={submit:l,disabled:U,loading:d,ariaControls:m,ariaExpanded:f,ariaChecked:_,pressed:u,onKeyDown:y,onKeyUp:T,onKeyPress:S,onPointerDown:R};return i.createElement(ms,Object.assign({},X,J,Z),q,H,Y,V)}function gs(e,t,n){return"select"===e?ls:"up"===e?t:n}function _s(e){let{title:t,description:n,action:r,link:o,badge:a}=e;const s=a&&i.createElement(Po,{tone:a.tone},a.content),{to:c,content:l}=o,{onClick:d,content:u}=r;return i.createElement("div",{className:ao},i.createElement(ts.Section,null,i.createElement(is,{vertical:!0,spacing:"tight"},i.createElement(as,null,i.createElement(Qi,{variant:"headingMd",as:"h2"},t,s),i.createElement("p",null,n)),i.createElement(So,{url:c},l),i.createElement(fs,{variant:"plain",onClick:d},u))))}const vs=(0,i.createContext)(!1);function bs(e){let{children:t,filterActions:n}=e;return i.createElement(vs.Provider,{value:n},t)}var Es="Polaris-ActionList__Item",ys="Polaris-ActionList--default",Ss="Polaris-ActionList--active",Ts="Polaris-ActionList--destructive",Cs="Polaris-ActionList--disabled",ws="Polaris-ActionList__Prefix",Rs="Polaris-ActionList__Suffix",As="Polaris-ActionList--indented",Is="Polaris-ActionList--menu",Ns="Polaris-ActionList__Text",Os="Polaris-Tooltip__TooltipContainer",Ps="Polaris-Tooltip__HasUnderline";const ks=(0,i.createContext)(void 0);function Ds(){const e=(0,i.useContext)(ks);if(!e)throw new Error("No ephemeral presence manager was provided. Your application must be wrapped in an <AppProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return e}var xs={TooltipOverlay:"Polaris-Tooltip-TooltipOverlay",Tail:"Polaris-Tooltip-TooltipOverlay__Tail",positionedAbove:"Polaris-Tooltip-TooltipOverlay--positionedAbove",measuring:"Polaris-Tooltip-TooltipOverlay--measuring",measured:"Polaris-Tooltip-TooltipOverlay--measured",instant:"Polaris-Tooltip-TooltipOverlay--instant",Content:"Polaris-Tooltip-TooltipOverlay__Content",default:"Polaris-Tooltip-TooltipOverlay--default",wide:"Polaris-Tooltip-TooltipOverlay--wide"};const Ls=i.createElement(i.Fragment,null,i.createElement("path",{d:"M18.829 8.171 11.862.921A3 3 0 0 0 7.619.838L0 8.171h1.442l6.87-6.612a2 2 0 0 1 2.83.055l6.3 6.557h1.387Z",fill:"var(--p-color-tooltip-tail-up-border-experimental)"}),i.createElement("path",{d:"M17.442 10.171h-16v-2l6.87-6.612a2 2 0 0 1 2.83.055l6.3 6.557v2Z",fill:"var(--p-color-bg-surface)"})),Ms=i.createElement(i.Fragment,null,i.createElement("path",{d:"m0 2 6.967 7.25a3 3 0 0 0 4.243.083L18.829 2h-1.442l-6.87 6.612a2 2 0 0 1-2.83-.055L1.387 2H0Z",fill:"var(--p-color-tooltip-tail-down-border-experimental)"}),i.createElement("path",{d:"M1.387 0h16v2l-6.87 6.612a2 2 0 0 1-2.83-.055L1.387 2V0Z",fill:"var(--p-color-bg-surface)"}));function Us(e){let{active:t,activator:n,preferredPosition:r="above",preventInteraction:o,id:s,children:c,accessibilityLabel:l,width:d,padding:u,borderRadius:h,zIndexOverride:p,instant:m}=e;const f=ji();return t?i.createElement(Ma,{active:t,activator:n,preferredPosition:r,preventInteraction:o,render:function(e){const{measuring:t,desiredHeight:n,positioning:r,chevronOffset:o}=e,p=qr(xs.TooltipOverlay,t&&xs.measuring,!t&&xs.measured,m&&xs.instant,"above"===r&&xs.positionedAbove),g=qr(xs.Content,d&&xs[d]),_=t?void 0:{minHeight:n},v={"--pc-tooltip-chevron-x-pos":"".concat(o,"px"),"--pc-tooltip-border-radius":h?"var(--p-border-radius-".concat(h,")"):void 0,"--pc-tooltip-padding":u&&"default"===u?"var(--p-space-100) var(--p-space-200)":"var(--p-space-".concat(u,")")};return i.createElement("div",Object.assign({style:v,className:p},fo.props),i.createElement("svg",{className:xs.Tail,width:"19",height:"11",fill:"none"},"above"===r?Ms:Ls),i.createElement("div",{id:s,role:"tooltip",className:g,style:(0,a.A)((0,a.A)({},_),v),"aria-label":l?f.translate("Polaris.TooltipOverlay.accessibilityLabel",{label:l}):void 0},c))},zIndexOverride:p}):null}function Fs(e){let{children:t,content:n,dismissOnMouseOut:r,active:o,hoverDelay:a,preferredPosition:s="above",activatorWrapper:c="span",accessibilityLabel:l,width:d="default",padding:u="default",borderRadius:h,zIndexOverride:p,hasUnderline:m,persistOnClick:f,onOpen:g,onClose:_}=e;const v=h||"200",b=c,{value:E,setTrue:y,setFalse:S}=ti(Boolean(o)),{value:T,toggle:C}=ti(Boolean(o)&&Boolean(f)),[w,R]=(0,i.useState)(null),{presenceList:A,addPresence:I,removePresence:N}=Ds(),O=(0,i.useId)(),P=(0,i.useRef)(null),k=(0,i.useRef)(!1),[D,x]=(0,i.useState)(Boolean(!o)),L=(0,i.useRef)(null),M=(0,i.useRef)(null),U=(0,i.useCallback)(()=>{!1!==o&&y()},[o,y]);(0,i.useEffect)(()=>{const e=(P.current?Mo(P.current):null)||P.current;e&&(e.tabIndex=0,e.setAttribute("aria-describedby",O),e.setAttribute("data-polaris-tooltip-activator","true"))},[O,t]),(0,i.useEffect)(()=>()=>{L.current&&clearTimeout(L.current),M.current&&clearTimeout(M.current)},[]);const F=(0,i.useCallback)(()=>{x(!A.tooltip&&!E),null===g||void 0===g||g(),I("tooltip")},[I,A.tooltip,g,E]),j=(0,i.useCallback)(()=>{null===_||void 0===_||_(),x(!1),M.current=setTimeout(()=>{N("tooltip")},150)},[N,_]),V=(0,i.useCallback)(e=>{"Escape"===e.key&&(null===j||void 0===j||j(),S(),f&&C())},[S,j,f,C]);(0,i.useEffect)(()=>{!1===o&&E&&(j(),S())},[o,E,j,S]);const B=w?i.createElement(Ja,{idPrefix:"tooltip"},i.createElement(Us,{id:O,preferredPosition:s,activator:w,active:E,accessibilityLabel:l,onClose:js,preventInteraction:r,width:d,padding:u,borderRadius:v,zIndexOverride:p,instant:!D},i.createElement(Qi,{as:"span",variant:"bodyMd"},n))):null,W=qr("div"===c&&Os,m&&Ps);return i.createElement(b,{onFocus:()=>{F(),U()},onBlur:()=>{j(),S(),f&&C()},onMouseLeave:function(){L.current&&(clearTimeout(L.current),L.current=null);k.current=!1,j(),T||S()},onMouseOver:function(){!k.current&&(k.current=!0,a&&!A.tooltip?L.current=setTimeout(()=>{F(),U()},a):(F(),U()))},onMouseDown:f?C:void 0,ref:function(e){const t=P;if(null==e)return t.current=null,void R(null);e.firstElementChild instanceof HTMLElement&&R(e.firstElementChild),t.current=e},onKeyUp:V,className:W},t,B)}function js(){}var Vs="Polaris-InlineStack";const Bs=function(e){let{as:t="div",align:n,direction:r="row",blockAlign:o,gap:s,wrap:c=!0,children:l}=e;const d=(0,a.A)((0,a.A)({"--pc-inline-stack-align":n,"--pc-inline-stack-block-align":o,"--pc-inline-stack-wrap":c?"wrap":"nowrap"},Zr("inline-stack","gap","space",s)),Qr("inline-stack","flex-direction",r));return i.createElement(t,{className:Vs,style:d},l)};function Ws(e){let{id:t,badge:n,content:r,accessibilityLabel:o,helpText:a,url:s,onAction:c,onMouseEnter:l,icon:d,image:u,prefix:h,suffix:p,disabled:m,external:f,destructive:g,ellipsis:_,truncate:v,active:b,role:E,variant:y="default"}=e;const S=qr(Es,m&&Cs,g&&Ts,b&&Ss,"default"===y&&ys,"indented"===y&&As,"menu"===y&&Is);let T=null;h?T=i.createElement("span",{className:ws},h):d?T=i.createElement("span",{className:ws},i.createElement($i,{source:d})):u&&(T=i.createElement("span",{role:"presentation",className:ws,style:{backgroundImage:"url(".concat(u)}}));let C=r||"";v&&r?C=i.createElement(Hs,null,r):_&&(C="".concat(r,"\u2026"));const w=a?i.createElement(i.Fragment,null,i.createElement(ia,null,C),i.createElement(Qi,{as:"span",variant:"bodySm",tone:b||m?void 0:"subdued"},a)):i.createElement(Qi,{as:"span",variant:"bodyMd",fontWeight:b?"semibold":"regular"},C),R=n&&i.createElement("span",{className:Rs},i.createElement(Po,{tone:n.tone},n.content)),A=p&&i.createElement(ia,null,i.createElement("span",{className:Rs},p)),I=i.createElement("span",{className:Ns},i.createElement(Qi,{as:"span",variant:"bodyMd",fontWeight:b?"semibold":"regular"},w)),N=i.createElement(Bs,{blockAlign:"center",gap:"150",wrap:!1},T,I,R,A),O=i.createElement(ia,{width:"100%"},N),P=b?i.createElement(Ta.ScrollTo,null):null,k=s?i.createElement(yo,{id:t,url:m?null:s,className:S,external:f,"aria-label":o,onClick:m?null:c,role:E},O):i.createElement("button",{id:t,type:"button",className:S,disabled:m,"aria-label":o,onClick:c,onMouseUp:Lo,role:E,onMouseEnter:l},O);return i.createElement(i.Fragment,null,P,k)}const Hs=e=>{let{children:t}=e;const n=Ka(),r=(0,i.useRef)(null),[o,a]=(0,i.useState)(!1);Bi(()=>{r.current&&a(r.current.scrollWidth>r.current.offsetWidth)},[t]);const s=i.createElement(Qi,{as:"span",truncate:!0},i.createElement(ia,{width:"100%",ref:r},t));return o?i.createElement(Fs,{zIndexOverride:Number(n.zIndex["z-index-11"]),preferredPosition:"above",hoverDelay:1e3,content:t,dismissOnMouseOut:!0},i.createElement(Qi,{as:"span",truncate:!0},t)):s};var Gs="Polaris-BlockStack",zs="Polaris-BlockStack--listReset",Ks="Polaris-BlockStack--fieldsetReset";const Ys=["as","children","align","inlineAlign","gap","id","reverseOrder"],qs=e=>{let{as:t="div",children:n,align:r,inlineAlign:s,gap:c,id:l,reverseOrder:d=!1}=e,u=(0,o.A)(e,Ys);const h=qr(Gs,("ul"===t||"ol"===t)&&zs,"fieldset"===t&&Ks),p=(0,a.A)({"--pc-block-stack-align":r?"".concat(r):null,"--pc-block-stack-inline-align":s?"".concat(s):null,"--pc-block-stack-order":d?"column-reverse":"column"},Zr("block-stack","gap","space",c));return i.createElement(t,(0,a.A)({className:h,id:l,style:Jr(p)},u),n)},Xs=["content","helpText","onAction"];function Js(e){let{section:t,hasMultipleSections:n,isFirst:r,actionRole:a,onActionAnyItem:s}=e;const c=t.items.map((e,t)=>{let{content:n,helpText:r,onAction:c}=e,l=(0,o.A)(e,Xs);const d=i.createElement(Ws,Object.assign({content:n,helpText:r,role:a,onAction:(u=c,()=>{u&&u(),s&&s()})},l));var u;return i.createElement(ia,{as:"li",key:"".concat(n,"-").concat(t),role:"menuitem"===a?"presentation":void 0},i.createElement(Bs,{wrap:!1},d))});let l,d=null;switch(t.title&&(d="string"===typeof t.title?i.createElement(ia,{paddingBlockStart:"300",paddingBlockEnd:"100",paddingInlineStart:"300",paddingInlineEnd:"300"},i.createElement(Qi,{as:"p",variant:"headingSm"},t.title)):i.createElement(ia,{padding:"200",paddingInlineEnd:"150"},t.title)),a){case"option":l="presentation";break;case"menuitem":l=n?"presentation":"menu";break;default:l=void 0}const u=i.createElement(i.Fragment,null,d,i.createElement(ia,Object.assign({as:"div",padding:"150"},n&&{paddingBlockStart:"0"},{tabIndex:n?void 0:-1}),i.createElement(qs,Object.assign({gap:"050",as:"ul"},l&&{role:l}),c)));return n?i.createElement(ia,Object.assign({as:"li",role:"presentation",borderColor:"border-secondary"},!r&&{borderBlockStartWidth:"025"},!t.title&&{paddingBlockStart:"150"}),u):u}function Zs(e,t,n,r){const o=(0,i.useRef)(t),a=(0,i.useRef)(r);Bi(()=>{o.current=t},[t]),Bi(()=>{a.current=r},[r]),(0,i.useEffect)(()=>{if("string"!==typeof e||null===n)return;let t;if("undefined"===typeof n)t=window;else if("current"in n){if(null===n.current)return;t=n.current}else t=n;const r=a.current,i=e=>o.current(e);return t.addEventListener(e,i,r),()=>{t.removeEventListener(e,i,r)}},[e,n])}var Qs={TextField:"Polaris-TextField",ClearButton:"Polaris-TextField__ClearButton",Loading:"Polaris-TextField__Loading",disabled:"Polaris-TextField--disabled",error:"Polaris-TextField--error",readOnly:"Polaris-TextField--readOnly",Input:"Polaris-TextField__Input",Backdrop:"Polaris-TextField__Backdrop",multiline:"Polaris-TextField--multiline",hasValue:"Polaris-TextField--hasValue",focus:"Polaris-TextField--focus",VerticalContent:"Polaris-TextField__VerticalContent",InputAndSuffixWrapper:"Polaris-TextField__InputAndSuffixWrapper",toneMagic:"Polaris-TextField--toneMagic",Prefix:"Polaris-TextField__Prefix",Suffix:"Polaris-TextField__Suffix",AutoSizeWrapper:"Polaris-TextField__AutoSizeWrapper",AutoSizeWrapperWithSuffix:"Polaris-TextField__AutoSizeWrapperWithSuffix",suggestion:"Polaris-TextField--suggestion",borderless:"Polaris-TextField--borderless",slim:"Polaris-TextField--slim","Input-hasClearButton":"Polaris-TextField__Input--hasClearButton","Input-suffixed":"Polaris-TextField__Input--suffixed","Input-alignRight":"Polaris-TextField__Input--alignRight","Input-alignLeft":"Polaris-TextField__Input--alignLeft","Input-alignCenter":"Polaris-TextField__Input--alignCenter","Input-autoSize":"Polaris-TextField__Input--autoSize",PrefixIcon:"Polaris-TextField__PrefixIcon",CharacterCount:"Polaris-TextField__CharacterCount",AlignFieldBottom:"Polaris-TextField__AlignFieldBottom",Spinner:"Polaris-TextField__Spinner",SpinnerIcon:"Polaris-TextField__SpinnerIcon",Resizer:"Polaris-TextField__Resizer",DummyInput:"Polaris-TextField__DummyInput",Segment:"Polaris-TextField__Segment",monospaced:"Polaris-TextField--monospaced"};const $s=i.forwardRef(function(e,t){let{onChange:n,onClick:r,onMouseDown:o,onMouseUp:a,onBlur:s}=e;function c(e){return()=>n(e)}function l(e){return t=>{0===t.button&&(null===o||void 0===o||o(e))}}return i.createElement("div",{className:Qs.Spinner,onClick:r,"aria-hidden":!0,ref:t},i.createElement("div",{role:"button",className:Qs.Segment,tabIndex:-1,onClick:c(1),onMouseDown:l(c(1)),onMouseUp:a,onBlur:s},i.createElement("div",{className:Qs.SpinnerIcon},i.createElement($i,{source:ss}))),i.createElement("div",{role:"button",className:Qs.Segment,tabIndex:-1,onClick:c(-1),onMouseDown:l(c(-1)),onMouseUp:a,onBlur:s},i.createElement("div",{className:Qs.SpinnerIcon},i.createElement($i,{source:cs}))))});var ec="Polaris-Labelled--hidden",tc="Polaris-Labelled__LabelWrapper",nc="Polaris-Labelled--disabled",rc="Polaris-Labelled__HelpText",ic="Polaris-Labelled--readOnly",oc="Polaris-Labelled__Error",ac="Polaris-Labelled__Action",sc=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10 6a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"}),i.createElement("path",{d:"M11 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}),i.createElement("path",{fillRule:"evenodd",d:"M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Zm-1.5 0a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0Z"}))};sc.displayName="AlertCircleIcon";var cc="Polaris-InlineError",lc="Polaris-InlineError__Icon";function dc(e){let{message:t,fieldID:n}=e;return t?i.createElement("div",{id:uc(n),className:cc},i.createElement("div",{className:lc},i.createElement($i,{source:sc})),i.createElement(Qi,{as:"span",variant:"bodyMd"},t)):null}function uc(e){return"".concat(e,"Error")}var hc="Polaris-Label",pc="Polaris-Label--hidden",mc="Polaris-Label__Text",fc="Polaris-Label__RequiredIndicator";function gc(e){return"".concat(e,"Label")}function _c(e){let{children:t,id:n,hidden:r,requiredIndicator:o}=e;const a=qr(hc,r&&pc);return i.createElement("div",{className:a},i.createElement("label",{id:gc(n),htmlFor:n,className:qr(mc,o&&fc)},i.createElement(Qi,{as:"span",variant:"bodyMd"},t)))}const vc=["content","onAction","plain","destructive"];function bc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(e))return e.map((e,n)=>Ec(e,t,n));return Ec(e,t)}function Ec(e,t,n){let{content:r,onAction:a,plain:s,destructive:c}=e,l=(0,o.A)(e,vc);const d=s?"plain":void 0,u=c?"primary":void 0,h=null!==t&&void 0!==t&&t.tone||!c?null===t||void 0===t?void 0:t.tone:"critical";return i.createElement(fs,Object.assign({key:n,onClick:a,tone:h,variant:d||u},l,t),r)}const yc=["id","label","error","action","helpText","children","labelHidden","requiredIndicator","disabled","readOnly"];function Sc(e){let{id:t,label:n,error:r,action:a,helpText:s,children:c,labelHidden:l,requiredIndicator:d,disabled:u,readOnly:h}=e,p=(0,o.A)(e,yc);const m=qr(l&&ec,u&&nc,h&&ic),f=a?i.createElement("div",{className:ac},Ec(a,{variant:"plain"})):null,g=s?i.createElement("div",{className:rc,id:Tc(t),"aria-disabled":u},i.createElement(Qi,{as:"span",tone:"subdued",variant:"bodyMd",breakWord:!0},s)):null,_=r&&"boolean"!==typeof r&&i.createElement("div",{className:oc},i.createElement(dc,{message:r,fieldID:t})),v=n?i.createElement("div",{className:tc},i.createElement(_c,Object.assign({id:t,requiredIndicator:d},p,{hidden:!1}),n),f):null;return i.createElement("div",{className:m},v,c,_,g)}function Tc(e){return"".concat(e,"HelpText")}var Cc={Connected:"Polaris-Connected",Item:"Polaris-Connected__Item","Item-primary":"Polaris-Connected__Item--primary","Item-focused":"Polaris-Connected__Item--focused"};function wc(e){let{children:t,position:n}=e;const{value:r,setTrue:o,setFalse:a}=ti(!1),s=qr(Cc.Item,r&&Cc["Item-focused"],"primary"===n?Cc["Item-primary"]:Cc["Item-connection"]);return i.createElement("div",{onBlur:a,onFocus:o,className:s},t)}function Rc(e){let{children:t,left:n,right:r}=e;const o=n?i.createElement(wc,{position:"left"},n):null,a=r?i.createElement(wc,{position:"right"},r):null;return i.createElement("div",{className:Cc.Connected},o,i.createElement(wc,{position:"primary"},t),a)}function Ac(e){let{contents:t,currentHeight:n=null,minimumLines:r,onHeightChange:o}=e;const a=(0,i.useRef)(null),s=(0,i.useRef)(null),c=(0,i.useRef)(),l=(0,i.useRef)(n);n!==l.current&&(l.current=n),(0,i.useEffect)(()=>()=>{c.current&&cancelAnimationFrame(c.current)},[]);const d=r?i.createElement("div",{ref:s,className:Qs.DummyInput,dangerouslySetInnerHTML:{__html:Pc(r)}}):null,u=(0,i.useCallback)(()=>{c.current&&cancelAnimationFrame(c.current),c.current=requestAnimationFrame(()=>{if(!a.current||!s.current)return;const e=Math.max(a.current.offsetHeight,s.current.offsetHeight);e!==l.current&&o(e)})},[o]);return Bi(()=>{u()}),i.createElement("div",{"aria-hidden":!0,className:Qs.Resizer},i.createElement(Aa,{event:"resize",handler:u}),i.createElement("div",{ref:a,className:Qs.DummyInput,dangerouslySetInnerHTML:{__html:kc(t)}}),d)}const Ic={"&":"&amp;","<":"&lt;",">":"&gt;","\n":"<br>","\r":""},Nc=new RegExp("[".concat(Object.keys(Ic).join(),"]"),"g");function Oc(e){return Ic[e]}function Pc(e){let t="";for(let n=0;n<e;n++)t+="<br>";return t}function kc(e){return e?"".concat(e.replace(Nc,Oc),"<br>"):"<br>"}function Dc(e){let{prefix:t,suffix:n,verticalContent:r,placeholder:o,value:s="",helpText:c,label:l,labelAction:d,labelHidden:u,disabled:h,clearButton:p,readOnly:m,autoFocus:f,focused:g,multiline:_,error:v,connectedRight:b,connectedLeft:E,type:y="text",name:S,id:T,role:C,step:w,largeStep:R,autoComplete:A,max:I,maxLength:N,maxHeight:O,min:P,minLength:k,pattern:D,inputMode:x,spellCheck:L,ariaOwns:M,ariaControls:U,ariaExpanded:F,ariaActiveDescendant:j,ariaAutocomplete:V,showCharacterCount:B,align:W,requiredIndicator:H,monospaced:G,selectTextOnFocus:z,suggestion:K,variant:Y="inherit",size:q="medium",onClearButtonClick:X,onChange:J,onSpinnerChange:Z,onFocus:Q,onBlur:$,tone:ee,autoSize:te,loading:ne}=e;const re=ji(),[ie,oe]=(0,i.useState)(null),[ae,se]=(0,i.useState)(Boolean(g)),ce=ca(),le=(0,i.useId)(),de=null!==T&&void 0!==T?T:le,ue=(0,i.useRef)(null),he=(0,i.useRef)(null),pe=(0,i.useRef)(null),me=(0,i.useRef)(null),fe=(0,i.useRef)(null),ge=(0,i.useRef)(null),_e=(0,i.useRef)(null),ve=(0,i.useRef)(),be=(0,i.useRef)(null),Ee=(0,i.useCallback)(()=>_?pe.current:he.current,[_]);(0,i.useEffect)(()=>{const e=Ee();e&&void 0!==g&&(g?e.focus():e.blur())},[g,r,Ee]),(0,i.useEffect)(()=>{const e=he.current;e&&("text"===y||"tel"===y||"search"===y||"url"===y||"password"===y)&&K&&e.setSelectionRange(s.length,K.length)},[ae,s,y,K]);const ye=K||s,Se=null!=w?w:1,Te=null!=I?I:1/0,Ce=null!=P?P:-1/0,we=qr(Qs.TextField,Boolean(ye)&&Qs.hasValue,h&&Qs.disabled,m&&Qs.readOnly,v&&Qs.error,ee&&Qs[Xr("tone",ee)],_&&Qs.multiline,ae&&!h&&Qs.focus,"inherit"!==Y&&Qs[Y],"slim"===q&&Qs.slim),Re="currency"===y?"text":y,Ae="number"===y||"integer"===y,Ie=i.isValidElement(t)&&t.type===$i,Ne=t?i.createElement("div",{className:qr(Qs.Prefix,Ie&&Qs.PrefixIcon),id:"".concat(de,"-Prefix"),ref:me},i.createElement(Qi,{as:"span",variant:"bodyMd"},t)):null,Oe=n?i.createElement("div",{className:Qs.Suffix,id:"".concat(de,"-Suffix"),ref:fe},i.createElement(Qi,{as:"span",variant:"bodyMd"},n)):null,Pe=ne?i.createElement("div",{className:Qs.Loading,id:"".concat(de,"-Loading"),ref:ge},i.createElement(hs,{size:"small"})):null;let ke=null;if(B){const e=ye.length,t=N?re.translate("Polaris.TextField.characterCountWithMaxLength",{count:e,limit:N}):re.translate("Polaris.TextField.characterCount",{count:e}),n=qr(Qs.CharacterCount,_&&Qs.AlignFieldBottom),r=N?"".concat(e,"/").concat(N):e;ke=i.createElement("div",{id:"".concat(de,"-CharacterCounter"),className:n,"aria-label":t,"aria-live":ae?"polite":"off","aria-atomic":"true",onClick:Ze},i.createElement(Qi,{as:"span",variant:"bodyMd"},r))}const De=p&&""!==ye?i.createElement("button",{type:"button",className:Qs.ClearButton,onClick:function(){X&&X(de)},disabled:h},i.createElement(Qi,{as:"span",visuallyHidden:!0},re.translate("Polaris.Common.clear")),i.createElement($i,{source:Ni,tone:"base"})):null,xe=(0,i.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Se;if(null==J&&null==Z)return;const n=e=>(e.toString().split(".")[1]||[]).length,r=s?parseFloat(s):0;if(isNaN(r))return;const i="integer"===y?0:Math.max(n(r),n(t)),o=Math.min(Number(Te),Math.max(r+e*t,Number(Ce)));null!=Z?Z(String(o.toFixed(i)),de):null!=J&&J(String(o.toFixed(i)),de)},[de,Te,Ce,J,Z,Se,y,s]),Le=(0,i.useCallback)(()=>{clearTimeout(ve.current)},[]),Me=(0,i.useCallback)(e=>{let t=200;const n=()=>{t>50&&(t-=10),e(0),ve.current=window.setTimeout(n,t)};ve.current=window.setTimeout(n,t),document.addEventListener("mouseup",Le,{once:!0})},[Le]),Ue=!Ae||0===w||h||m?null:i.createElement($s,{onClick:Ze,onChange:xe,onMouseDown:Me,onMouseUp:Le,ref:be,onBlur:Qe}),Fe=_&&ie?{height:ie,maxHeight:O}:null,je=(0,i.useCallback)(e=>{oe(e)},[]),Ve=_&&ce?i.createElement(Ac,{contents:ye||o,currentHeight:ie,minimumLines:"number"===typeof _?_:1,onHeightChange:je}):null,Be=[];v&&Be.push("".concat(de,"Error")),c&&Be.push(Tc(de)),B&&Be.push("".concat(de,"-CharacterCounter"));const We=[];t&&We.push("".concat(de,"-Prefix")),n&&We.push("".concat(de,"-Suffix")),r&&We.push("".concat(de,"-VerticalContent")),We.unshift(gc(de));const He=qr(Qs.Input,W&&Qs[Xr("Input-align",W)],n&&Qs["Input-suffixed"],p&&Qs["Input-hasClearButton"],G&&Qs.monospaced,K&&Qs.suggestion,te&&Qs["Input-autoSize"]),Ge=e=>{if(se(!0),z&&!K){const e=Ee();null===e||void 0===e||e.select()}Q&&Q(e)};Zs("wheel",function(e){document.activeElement===e.target&&Ae&&e.stopPropagation()},he);const ze=(0,i.createElement)(_?"textarea":"input",(0,a.A)((0,a.A)({name:S,id:de,disabled:h,readOnly:m,role:C,autoFocus:f,value:ye,placeholder:o,style:Fe,autoComplete:A,className:He,ref:_?pe:he,min:P,max:I,step:w,minLength:k,maxLength:N,spellCheck:L,pattern:D,inputMode:x,type:Re,rows:xc(_),size:te?1:void 0,"aria-describedby":Be.length?Be.join(" "):void 0,"aria-labelledby":We.join(" "),"aria-invalid":Boolean(v),"aria-owns":M,"aria-activedescendant":j,"aria-autocomplete":V,"aria-controls":U,"aria-expanded":F,"aria-required":H},function(e){return e&&(Boolean(e)||"number"===typeof e&&e>0)?{"aria-multiline":!0}:void 0}(_)),{},{onFocus:Ge,onBlur:Qe,onClick:Ze,onKeyPress:function(e){const{key:t,which:n}=e;if(!Ae||n===Zo.Enter||"number"===y&&/[\d.,eE+-]$/.test(t)||"integer"===y&&/[\deE+-]$/.test(t))return;e.preventDefault()},onKeyDown:function(e){if(!Ae)return;const{key:t,which:n}=e;"integer"!==y||"ArrowUp"!==t&&n!==Zo.UpArrow||(xe(1),e.preventDefault());"integer"!==y||"ArrowDown"!==t&&n!==Zo.DownArrow||(xe(-1),e.preventDefault());n!==Zo.Home&&"Home"!==t||void 0===P||(null!=Z?Z(String(P),de):null!=J&&J(String(P),de));n!==Zo.End&&"End"!==t||void 0===I||(null!=Z?Z(String(I),de):null!=J&&J(String(I),de));n!==Zo.PageUp&&"PageUp"!==t||void 0===R||xe(1,R);n!==Zo.PageDown&&"PageDown"!==t||void 0===R||xe(-1,R)},onChange:K?void 0:Je,onInput:K?Je:void 0,"data-1p-ignore":"off"===A||void 0,"data-lpignore":"off"===A||void 0,"data-form-type":"off"===A?"other":void 0})),Ke=r?i.createElement("div",{className:Qs.VerticalContent,id:"".concat(de,"-VerticalContent"),ref:_e,onClick:Ze},r,ze):null,Ye=r?Ke:ze,qe=i.createElement("div",{className:qr(Qs.Backdrop,E&&Qs["Backdrop-connectedLeft"],b&&Qs["Backdrop-connectedRight"])}),Xe=te?i.createElement("div",{className:Qs.InputAndSuffixWrapper},i.createElement("div",{className:qr(Qs.AutoSizeWrapper,n&&Qs.AutoSizeWrapperWithSuffix),"data-auto-size-value":s||o},Ye),Oe):i.createElement(i.Fragment,null,Ye,Oe);return i.createElement(Sc,{label:l,id:de,error:v,action:d,labelHidden:u,helpText:c,requiredIndicator:H,disabled:h,readOnly:m},i.createElement(Rc,{left:E,right:b},i.createElement("div",{className:we,onClick:function(e){var t,n;const{target:r}=e,i=null===he||void 0===he||null===(t=he.current)||void 0===t?void 0:t.getAttribute("role");if(r===he.current&&"combobox"===i){var o;return null===(o=he.current)||void 0===o||o.focus(),void Ge(e)}if(et(r)||rt(r)||$e(r)||tt(r)||nt(r)||ae)return;null===(n=Ee())||void 0===n||n.focus()},ref:ue},Ne,Xe,ke,Pe,De,Ue,qe,Ve)));function Je(e){J&&J(e.currentTarget.value,de)}function Ze(e){var t;tt(e.target)||$e(e.target)||e.stopPropagation(),et(e.target)||rt(e.target)||$e(e.target)||nt(e.target)||ae||(se(!0),null===(t=Ee())||void 0===t||t.focus())}function Qe(e){var t;se(!1),null!==(t=ue.current)&&void 0!==t&&t.contains(null===e||void 0===e?void 0:e.relatedTarget)||$&&$(e)}function $e(e){const t=Ee();return e instanceof HTMLElement&&t&&(t.contains(e)||t.contains(document.activeElement))}function et(e){return e instanceof Element&&(me.current&&me.current.contains(e)||fe.current&&fe.current.contains(e))}function tt(e){return e instanceof Element&&be.current&&be.current.contains(e)}function nt(e){return e instanceof Element&&ge.current&&ge.current.contains(e)}function rt(e){return e instanceof Element&&_e.current&&(_e.current.contains(e)||_e.current.contains(document.activeElement))}}function xc(e){if(e)return"number"===typeof e?e:1}function Lc(e){var t,n,r;let{items:o,sections:s=[],actionRole:c,allowFiltering:l,onActionAnyItem:d}=e;const u=ji(),h=(0,i.useContext)(vs);let p=[];const m=(0,i.useRef)(null),[f,g]=(0,i.useState)("");o?p=[{items:o},...s]:s&&(p=s);const _=null===(t=p)||void 0===t?void 0:t.some(e=>e.items.some(e=>"string"===typeof e.content)),v=p.length>1,b=v&&"menuitem"===c?"menu":void 0,E=v&&"menuitem"===c?-1:void 0,y=null===(n=p)||void 0===n?void 0:n.map(e=>(0,a.A)((0,a.A)({},e),{},{items:e.items.filter(e=>{let{content:t}=e;return"string"===typeof t?null===t||void 0===t?void 0:t.toLowerCase().includes(f.toLowerCase()):t})})),S=y.map((e,t)=>e.items.length>0?i.createElement(Js,{key:"string"===typeof e.title?e.title:t,section:e,hasMultipleSections:v,actionRole:c,onActionAnyItem:d,isFirst:0===t}):null),T="menuitem"===c?i.createElement(i.Fragment,null,i.createElement(Ia,{keyEvent:"keydown",keyCode:Zo.DownArrow,handler:e=>{e.preventDefault(),m.current&&e.target&&m.current.contains(e.target)&&function(e,t){const n=Wo(e),r=Ho(n,t);-1===r?n[0].focus():n[(r+1)%n.length].focus()}(m.current,e.target)}}),i.createElement(Ia,{keyEvent:"keydown",keyCode:Zo.UpArrow,handler:e=>{e.preventDefault(),m.current&&e.target&&m.current.contains(e.target)&&function(e,t){const n=Wo(e),r=Ho(n,t);-1===r?n[0].focus():n[(r-1+n.length)%n.length].focus()}(m.current,e.target)}})):null,C=(0,i.useMemo)(()=>(null===y||void 0===y?void 0:y.reduce((e,t)=>e+t.items.length,0))||0,[y]),w=((null===(r=p)||void 0===r?void 0:r.reduce((e,t)=>e+t.items.length,0))||0)>=8;return i.createElement(i.Fragment,null,(l||h)&&w&&_&&i.createElement(ia,{padding:"200",paddingBlockEnd:C>0?"0":"200"},i.createElement(Dc,{clearButton:!0,labelHidden:!0,label:u.translate("Polaris.ActionList.SearchField.placeholder"),placeholder:u.translate("Polaris.ActionList.SearchField.placeholder"),autoComplete:"off",value:f,onChange:e=>g(e),prefix:i.createElement($i,{source:Oi}),onClearButtonClick:()=>g("")})),i.createElement(ia,{as:v?"ul":"div",ref:m,role:b,tabIndex:E},T,S))}function Mc(e){const{actions:t,onOpen:n,onClose:r,open:o,activatorContent:a,message:s,accessibilityLabel:c,customWidth:l,userMenu:d}=e,u=s&&s.badge&&{content:s.badge.content,tone:s.badge.tone},h=s&&i.createElement(_s,{title:s.title,description:s.description,action:{onClick:s.action.onClick,content:s.action.content},link:{to:s.link.to,content:s.link.content},badge:u});return i.createElement(ts,{activator:i.createElement("div",{className:oo.ActivatorWrapper},i.createElement("button",{type:"button",className:qr(oo.Activator,d&&oo["Activator-userMenu"]),onClick:n,"aria-label":c},a)),active:o,onClose:r,fixed:!0,fullHeight:!0,preferredAlignment:"right"},i.createElement("div",{className:oo.MenuItems},i.createElement(ia,{width:l},i.createElement(Lc,{actionRole:"menuitem",onActionAnyItem:r,sections:t}),h)))}Lc.Item=Ws;var Uc={Avatar:"Polaris-Avatar",imageHasLoaded:"Polaris-Avatar--imageHasLoaded",Text:"Polaris-Avatar__Text",long:"Polaris-Avatar--long",hidden:"Polaris-Avatar--hidden",sizeXs:"Polaris-Avatar--sizeXs",sizeSm:"Polaris-Avatar--sizeSm",sizeMd:"Polaris-Avatar--sizeMd",sizeLg:"Polaris-Avatar--sizeLg",sizeXl:"Polaris-Avatar--sizeXl",styleOne:"Polaris-Avatar--styleOne",styleTwo:"Polaris-Avatar--styleTwo",styleThree:"Polaris-Avatar--styleThree",styleFour:"Polaris-Avatar--styleFour",styleFive:"Polaris-Avatar--styleFive",styleSix:"Polaris-Avatar--styleSix",styleSeven:"Polaris-Avatar--styleSeven",Image:"Polaris-Avatar__Image",Initials:"Polaris-Avatar__Initials",Svg:"Polaris-Avatar__Svg"};const Fc=["alt","sourceSet","source","crossOrigin","onLoad","className"];function jc(e){let{alt:t,sourceSet:n,source:r,crossOrigin:a,onLoad:s,className:c}=e,l=(0,o.A)(e,Fc);const d=n?n.map(e=>{let{source:t,descriptor:n}=e;return"".concat(t," ").concat(n)}).join(","):null,u=(0,i.useCallback)(()=>{s&&s()},[s]);return i.createElement("img",Object.assign({alt:t,src:r,crossOrigin:a,className:c,onLoad:u},d?{srcSet:d}:{},l))}var Vc;!function(e){e.Pending="PENDING",e.Loaded="LOADED",e.Errored="ERRORED"}(Vc||(Vc={}));const Bc=["one","two","three","four","five","six","seven"],Wc={xs:"3",sm:"2.5",md:"2.5",lg:"2.5",xl:"2"};function Hc(e){let{name:t,source:n,onError:r,initials:o,customer:a,size:s="md",accessibilityLabel:c}=e;const l=ji(),d=ca(),[u,h]=(0,i.useState)(Vc.Pending);(0,i.useEffect)(()=>{h(Vc.Pending)},[n]);const p=(0,i.useCallback)(()=>{h(Vc.Errored),r&&r()},[r]),m=(0,i.useCallback)(()=>{h(Vc.Loaded)},[]),f=n&&u!==Vc.Errored,g=t||o;let _;if(c)_=c;else if(t)_=t;else if(o){const e=o.split("").join(" ");_=l.translate("Polaris.Avatar.labelWithInitials",{initials:e})}const v=qr(Uc.Avatar,s&&Uc[Xr("size",s)],f&&u===Vc.Loaded&&Uc.imageHasLoaded,!a&&!f&&Uc[Xr("style",function(e){return e?Bc[function(e){let t=0;for(const n of e)t^=n.charCodeAt(0);return t}(e)%Bc.length]:Bc[0]}(g))]),b=qr(Uc.Text,((null===o||void 0===o?void 0:o.length)||0)>2&&Uc.long),E=qr(Uc.Image,u!==Vc.Loaded&&Uc.hidden),y=n&&d&&u!==Vc.Errored?i.createElement(jc,{className:E,source:n,alt:"",role:"presentation",onLoad:m,onError:p}):null,S=i.createElement(i.Fragment,null,i.createElement("path",{fill:"none",d:"M25.5 13.5C25.5 16.5376 23.0376 19 20 19C16.9624 19 14.5 16.5376 14.5 13.5C14.5 10.4624 16.9624 8 20 8C23.0376 8 25.5 10.4624 25.5 13.5Z",stroke:"currentColor",strokeWidth:Wc[s]}),i.createElement("path",{fill:"none",d:"M10.3433 29.682L9.47 31.254C9.03481 32.0373 9.60125 33 10.4974 33H29.5026C30.3988 33 30.9652 32.0373 30.53 31.254L29.6567 29.682C27.7084 26.175 24.0119 24 20 24C15.9882 24 12.2916 26.175 10.3433 29.682Z",stroke:"currentColor",strokeWidth:Wc[s],strokeLinecap:"round",strokeLinejoin:"round"})),T=a||!o?S:i.createElement("text",{className:b,x:"50%",y:"50%",dy:"0.35em",fill:"currentColor",textAnchor:"middle"},o),C=f?null:i.createElement("span",{className:Uc.Initials},i.createElement("svg",{className:Uc.Svg,viewBox:"0 0 40 40"},T));return i.createElement("span",{"aria-label":_,role:_?"img":"presentation",className:v},C,y)}const Gc=(0,i.createContext)(void 0);function zc(){const e=(0,i.useContext)(Gc);if(!e)throw new Error("No Frame context was provided. Your component must be wrapped in a <Frame> component. See https://polaris.shopify.com/components/internal-only/frame for implementation instructions.");return e}const Kc=function(e){let{showNavigationToggle:t,userMenu:n,searchResults:r,searchField:o,secondaryMenu:a,searchResultsVisible:s,searchResultsOverlayVisible:c=!1,onNavigationToggle:l,onSearchResultsDismiss:d,contextControl:u,logoSuffix:h}=e;const p=ji(),{logo:m}=zc(),{value:f,setTrue:g,setFalse:_}=ti(!1),v=qr(ui,f&&hi),b=t?i.createElement("button",{type:"button",className:v,onClick:l,onFocus:g,onBlur:_,"aria-label":p.translate("Polaris.TopBar.toggleMenuLabel")},i.createElement("div",{className:pi},i.createElement($i,{source:Ct}))):null,E=ei(m,104);let y;if(u)y=i.createElement("div",{className:di},u);else if(m){const e=qr(ai,t||o?ii:oi,h&&si);y=i.createElement("div",{className:e},i.createElement(yo,{url:m.url||"",className:li,style:{width:E}},i.createElement(jc,{source:m.topBarSource||"",alt:m.accessibilityLabel||"",className:ci,style:{width:E}})),h)}const S=o?i.createElement(i.Fragment,null,o,i.createElement(Ii,{visible:s,onDismiss:d,overlayVisible:c},r)):null;return i.createElement("div",{className:ni},i.createElement("div",{className:ri},i.createElement("div",{className:mi},b,y),i.createElement("div",{className:fi},S),i.createElement("div",{className:gi},i.createElement("div",{className:_i},a),n)))};Kc.Menu=Mc,Kc.SearchField=function(e){let{value:t,focused:n,active:r,placeholder:o,onChange:a,onFocus:s,onBlur:c,onCancel:l,showFocusBorder:d}=e;const u=ji(),[h,p]=(0,i.useState)(!1),m=(0,i.useRef)(null),f=(0,i.useId)(),g=(0,i.useCallback)(e=>{let{currentTarget:t}=e;a(t.value)},[a]),_=(0,i.useCallback)(()=>s&&s(),[s]),v=(0,i.useCallback)(()=>c&&c(),[c]),b=(0,i.useCallback)(()=>{l&&l(),m.current&&(m.current.value="",a(""),m.current.focus())},[l,a]);(0,i.useEffect)(()=>{m.current&&(n?m.current.focus():m.current.blur())},[n]);const E=""!==t&&i.createElement("button",{type:"button","aria-label":u.translate("Polaris.TopBar.SearchField.clearButtonLabel"),className:Ui,onClick:b,onBlur:()=>{p(!1),b()},onFocus:()=>{_(),p(!0)}},i.createElement($i,{source:Ni})),y=qr(Pi,(n||r||h)&&ki);return i.createElement("div",{className:y,onFocus:_,onBlur:v},i.createElement(Qi,{as:"span",visuallyHidden:!0},i.createElement("label",{htmlFor:f},u.translate("Polaris.TopBar.SearchField.search"))),i.createElement("input",{id:f,className:Di,placeholder:o,type:"search",autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",ref:m,value:t,onChange:g,onKeyDown:eo}),i.createElement("span",{className:Mi},i.createElement($i,{source:Oi})),E,i.createElement("div",{className:qr(xi,d&&Li)}))},Kc.UserMenu=function(e){let{name:t,detail:n,avatar:r,initials:o,actions:a,message:s,onToggle:c,open:l,accessibilityLabel:d,customActivator:u,customWidth:h}=e;const p=Boolean(s),m=u||i.createElement(i.Fragment,null,i.createElement("span",{className:to.Details},i.createElement(Qi,{as:"p",variant:"bodySm",alignment:"start",fontWeight:"medium",truncate:!0},t),i.createElement("span",{className:to.Message},i.createElement(Qi,{as:"p",variant:"bodyXs",alignment:"start",tone:"text-inverse-secondary",truncate:!0},n))),i.createElement(io,{active:p},i.createElement(Hc,{size:"md",initials:o&&o.replace(" ",""),source:r,name:t})));return i.createElement(Mc,{activatorContent:m,open:l,onOpen:c,onClose:c,actions:a,message:s,accessibilityLabel:d,customWidth:h,userMenu:!0})};var Yc=n(6366),qc=n.n(Yc);function Xc(e,t,n){(0,i.useEffect)(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qc();const n=(0,i.useRef)(e);return t(n.current,e)||(n.current=e),n.current}(t,n))}const Jc=(0,i.memo)(function(e){const t=(0,i.useId)(),{showToast:n,hideToast:r}=zc();return Xc(()=>(n((0,a.A)({id:t},e)),()=>{r({id:t})}),[e]),null});var Zc=n(8587);function Qc(){return Qc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qc.apply(null,arguments)}function $c(e,t){return $c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$c(e,t)}function el(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,$c(e,t)}const tl=i.createContext(null);function nl(e,t){var n=Object.create(null);return e&&i.Children.map(e,function(e){return e}).forEach(function(e){n[e.key]=function(e){return t&&(0,i.isValidElement)(e)?t(e):e}(e)}),n}function rl(e,t,n){return null!=n[t]?n[t]:e.props[t]}function il(e,t,n){var r=nl(e.children),o=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),o=[];for(var a in e)a in t?o.length&&(i[a]=o,o=[]):o.push(a);var s={};for(var c in t){if(i[c])for(r=0;r<i[c].length;r++){var l=i[c][r];s[i[c][r]]=n(l)}s[c]=n(c)}for(r=0;r<o.length;r++)s[o[r]]=n(o[r]);return s}(t,r);return Object.keys(o).forEach(function(a){var s=o[a];if((0,i.isValidElement)(s)){var c=a in t,l=a in r,d=t[a],u=(0,i.isValidElement)(d)&&!d.props.in;!l||c&&!u?l||!c||u?l&&c&&(0,i.isValidElement)(d)&&(o[a]=(0,i.cloneElement)(s,{onExited:n.bind(null,s),in:d.props.in,exit:rl(s,"exit",e),enter:rl(s,"enter",e)})):o[a]=(0,i.cloneElement)(s,{in:!1}):o[a]=(0,i.cloneElement)(s,{onExited:n.bind(null,s),in:!0,exit:rl(s,"exit",e),enter:rl(s,"enter",e)})}}),o}var ol=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},al=function(e){function t(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}el(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,r,o=t.children,a=t.handleExited;return{children:t.firstRender?(n=e,r=a,nl(n.children,function(e){return(0,i.cloneElement)(e,{onExited:r.bind(null,e),in:!0,appear:rl(e,"appear",n),enter:rl(e,"enter",n),exit:rl(e,"exit",n)})})):il(e,o,a),firstRender:!1}},n.handleExited=function(e,t){var n=nl(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var n=Qc({},t.children);return delete n[e.key],{children:n}}))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=(0,Zc.A)(e,["component","childFactory"]),o=this.state.contextValue,a=ol(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?i.createElement(tl.Provider,{value:o},a):i.createElement(tl.Provider,{value:o},i.createElement(t,r,a))},t}(i.Component);al.propTypes={},al.defaultProps={component:"div",childFactory:function(e){return e}};const sl=al,cl=(0,i.createContext)(!1);var ll="Polaris-Modal__Body",dl="Polaris-Modal__NoScrollBody",ul="Polaris-Modal__IFrame",hl="Polaris-Modal-Section",pl="Polaris-Modal-Section--titleHidden";function ml(e){let{children:t,flush:n=!1,subdued:r=!1,titleHidden:o=!1}=e;const a=qr(hl,o&&pl);return i.createElement("div",{className:a},i.createElement(ia,Object.assign({as:"section",padding:n?"0":"400"},o&&{paddingInlineEnd:"0"},r&&{background:"bg-surface-tertiary"}),t))}const fl=!1;var gl=function(e){return e.scrollTop},_l="unmounted",vl="exited",bl="entering",El="entered",yl="exiting",Sl=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i,o=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(i=vl,r.appearStatus=bl):i=El:i=t.unmountOnExit||t.mountOnEnter?_l:vl,r.state={status:i},r.nextCallback=null,r}el(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===_l?{status:vl}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==bl&&n!==El&&(t=bl):n!==bl&&n!==El||(t=yl)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===bl){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:Wa.findDOMNode(this);n&&gl(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===vl&&this.setState({status:_l})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[Wa.findDOMNode(this),r],o=i[0],a=i[1],s=this.getTimeouts(),c=r?s.appear:s.enter;!e&&!n||fl?this.safeSetState({status:El},function(){t.props.onEntered(o)}):(this.props.onEnter(o,a),this.safeSetState({status:bl},function(){t.props.onEntering(o,a),t.onTransitionEnd(c,function(){t.safeSetState({status:El},function(){t.props.onEntered(o,a)})})}))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:Wa.findDOMNode(this);t&&!fl?(this.props.onExit(r),this.safeSetState({status:yl},function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,function(){e.safeSetState({status:vl},function(){e.props.onExited(r)})})})):this.safeSetState({status:vl},function(){e.props.onExited(r)})},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:Wa.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=i[0],a=i[1];this.props.addEndListener(o,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===_l)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,Zc.A)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return i.createElement(tl.Provider,{value:null},"function"===typeof n?n(e,r):i.cloneElement(i.Children.only(n),r))},t}(i.Component);function Tl(){}Sl.contextType=tl,Sl.propTypes={},Sl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Tl,onEntering:Tl,onEntered:Tl,onExit:Tl,onExiting:Tl,onExited:Tl},Sl.UNMOUNTED=_l,Sl.EXITED=vl,Sl.ENTERING=bl,Sl.ENTERED=El,Sl.EXITING=yl;const Cl=Sl;function wl(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var Rl=function(e,t){return e&&t&&t.split(" ").forEach(function(t){return r=t,void((n=e).classList?n.classList.remove(r):"string"===typeof n.className?n.className=wl(n.className,r):n.setAttribute("class",wl(n.className&&n.className.baseVal||"",r)));var n,r})},Al=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),i=r[0],o=r[1];t.removeClasses(i,"exit"),t.addClass(i,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),i=r[0],o=r[1]?"appear":"enter";t.addClass(i,o,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),i=r[0],o=r[1]?"appear":"enter";t.removeClasses(i,o),t.addClass(i,o,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"===typeof n,i=r?""+(r&&n?n+"-":"")+e:n[e];return{baseClassName:i,activeClassName:r?i+"-active":n[e+"Active"],doneClassName:r?i+"-done":n[e+"Done"]}},t}el(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],i=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&i&&(r+=" "+i),"active"===n&&e&&gl(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach(function(t){return r=t,void((n=e).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"===typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)));var n,r})}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,i=n.active,o=n.done;this.appliedClasses[t]={},r&&Rl(e,r),i&&Rl(e,i),o&&Rl(e,o)},n.render=function(){var e=this.props,t=(e.classNames,(0,Zc.A)(e,["classNames"]));return i.createElement(Cl,Qc({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(i.Component);Al.defaultProps={classNames:""},Al.propTypes={};const Il=Al;var Nl={Container:"Polaris-Modal-Dialog__Container",Dialog:"Polaris-Modal-Dialog",Modal:"Polaris-Modal-Dialog__Modal",limitHeight:"Polaris-Modal-Dialog--limitHeight",sizeSmall:"Polaris-Modal-Dialog--sizeSmall",sizeLarge:"Polaris-Modal-Dialog--sizeLarge",sizeFullScreen:"Polaris-Modal-Dialog--sizeFullScreen",animateFadeUp:"Polaris-Modal-Dialog--animateFadeUp",entering:"Polaris-Modal-Dialog--entering",exiting:"Polaris-Modal-Dialog--exiting",exited:"Polaris-Modal-Dialog--exited",entered:"Polaris-Modal-Dialog--entered"};const Ol=(0,i.createContext)(void 0);const Pl=(0,i.memo)(function(e){let{children:t,disabled:n,root:r}=e;return(0,i.useEffect)(()=>{if(n||!r)return;const e=void 0!==r.current?r.current:r;e&&!e.querySelector("[autofocus]")&&Fo(e,!1)},[n,r]),i.createElement(i.Fragment,null,t)});function kl(e){let{trapping:t=!0,children:n}=e;const{canSafelyFocus:r}=function(e){let{trapping:t}=e;const n=(0,i.useContext)(Ol),r=(0,i.useId)();if(!n)throw new Ci("No FocusManager was provided.");const{trapFocusList:o,add:a,remove:s}=n,c=o[0]===r,l=(0,i.useMemo)(()=>({canSafelyFocus:c}),[c]);return(0,i.useEffect)(()=>{if(t)return a(r),()=>{s(r)}},[a,r,s,t]),l}({trapping:t}),o=(0,i.useRef)(null),[a,s]=(0,i.useState)(!0);(0,i.useEffect)(()=>{const e=!!(!r||o.current&&o.current.contains(document.activeElement))||!t;s(e)},[r,t]);return i.createElement(Pl,{disabled:a,root:o.current},i.createElement("div",{ref:o},i.createElement(Aa,{event:"focusin",handler:e=>{const n=o.current&&o.current.contains(document.activeElement);!1===t||!o.current||n||e.target instanceof Element&&e.target.matches("".concat(vo," *"))||r&&e.target instanceof HTMLElement&&o.current!==e.target&&!o.current.contains(e.target)&&Fo(o.current)}}),i.createElement(Ia,{keyCode:Zo.Tab,keyEvent:"keydown",handler:e=>{if(!1===t||!o.current)return;const n=Vo(o.current),r=Bo(o.current);e.target!==r||e.shiftKey||(e.preventDefault(),function(e){const t=Vo(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);!!t&&t.focus()}(o.current)),e.target===n&&e.shiftKey&&(e.preventDefault(),function(e){const t=Bo(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);!!t&&t.focus()}(o.current))}}),n))}const Dl=["instant","labelledBy","children","limitHeight","size","onClose","onExited","onEntered","setClosing","hasToasts"],xl=["children"];function Ll(e){let{instant:t,labelledBy:n,children:r,limitHeight:a,size:s,onClose:c,onExited:l,onEntered:d,setClosing:u,hasToasts:h}=e,p=(0,o.A)(e,Dl);const m=Ka(),f=(0,i.useRef)(null),g=(0,i.useContext)(Gc);let _;g&&(_=g.toastMessages);const v=qr(Nl.Modal,s&&Nl[Xr("size",s)],a&&Nl.limitHeight),b=t?Cl:Ul;(0,i.useEffect)(()=>{f.current&&!f.current.contains(document.activeElement)&&Fo(f.current)},[]);const E=i.createElement("div",{"aria-live":"assertive"},_?_.map(e=>i.createElement(Qi,{visuallyHidden:!0,as:"p",key:e.id},e.content)):null);return i.createElement(b,Object.assign({},p,{nodeRef:f,mountOnEnter:!0,unmountOnExit:!0,timeout:parseInt(m.motion["motion-duration-200"],10),onEntered:d,onExited:l}),i.createElement("div",{className:Nl.Container,"data-polaris-layer":!0,"data-polaris-overlay":!0,ref:f},i.createElement(kl,null,i.createElement("div",{role:"dialog","aria-modal":!0,"aria-label":n,"aria-labelledby":n,tabIndex:-1,className:Nl.Dialog},i.createElement("div",{className:v},i.createElement(Ia,{keyCode:Zo.Escape,keyEvent:"keydown",handler:()=>{u&&u(!0)}}),i.createElement(Ia,{keyCode:Zo.Escape,handler:()=>{u&&u(!1),c()}}),r),E))))}const Ml={appear:qr(Nl.animateFadeUp,Nl.entering),appearActive:qr(Nl.animateFadeUp,Nl.entered),enter:qr(Nl.animateFadeUp,Nl.entering),enterActive:qr(Nl.animateFadeUp,Nl.entered),exit:qr(Nl.animateFadeUp,Nl.exiting),exitActive:qr(Nl.animateFadeUp,Nl.exited)};function Ul(e){let{children:t}=e,n=(0,o.A)(e,xl);return i.createElement(Il,Object.assign({},n,{classNames:Ml}),t)}var Fl=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M12.72 13.78a.75.75 0 1 0 1.06-1.06l-2.72-2.72 2.72-2.72a.75.75 0 0 0-1.06-1.06l-2.72 2.72-2.72-2.72a.75.75 0 0 0-1.06 1.06l2.72 2.72-2.72 2.72a.75.75 0 1 0 1.06 1.06l2.72-2.72 2.72 2.72Z"}))};function jl(e){let{pressed:t,onClick:n}=e;const r=ji();return i.createElement(fs,{variant:"tertiary",pressed:t,icon:Fl,onClick:n,accessibilityLabel:r.translate("Polaris.Common.close")})}Fl.displayName="XIcon";var Vl="Polaris-InlineGrid";function Bl(e){let{children:t,columns:n,gap:r,alignItems:o}=e;const s=(0,a.A)((0,a.A)((0,a.A)({},Qr("inline-grid","grid-template-columns",function(e){if("object"===typeof e&&null!==e&&!Array.isArray(e))return Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,Wl(n)]}));return Wl(e)}(n))),Zr("inline-grid","gap","space",r)),{},{"--pc-inline-grid-align-items":o});return i.createElement("div",{className:Vl,style:Jr(s)},t)}function Wl(e){if(e)return"number"!==typeof e&&isNaN(Number(e))?"string"===typeof e?e:e.map(e=>{switch(e){case"oneThird":case"oneHalf":return"minmax(0, 1fr)";case"twoThirds":return"minmax(0, 2fr)"}}).join(" "):"repeat(".concat(Number(e),", minmax(0, 1fr))")}function Hl(e){let{id:t,children:n,closing:r,titleHidden:o,onClose:a}=e;const s="400";return o||!n?i.createElement(ia,{position:"absolute",insetInlineEnd:s,insetBlockStart:"400",zIndex:"1"},i.createElement(jl,{onClick:a})):i.createElement(ia,{paddingBlockStart:"400",paddingBlockEnd:"400",paddingInlineStart:s,paddingInlineEnd:s,borderBlockEndWidth:"025",borderColor:"border",background:"bg-surface-tertiary"},i.createElement(Bl,{columns:{xs:"1fr auto"},gap:"400"},i.createElement(Bs,{gap:"400",blockAlign:"center"},i.createElement(Qi,{id:t,as:"h2",variant:"headingMd",breakWord:!0},n)),i.createElement(jl,{pressed:r,onClick:a})))}var Gl="Polaris-Backdrop",zl="Polaris-Backdrop--transparent",Kl="Polaris-Backdrop--belowNavigation";function Yl(e){const{onClick:t,onTouchStart:n,belowNavigation:r,transparent:o,setClosing:a}=e,s=qr(Gl,r&&Kl,o&&zl);return i.createElement(i.Fragment,null,i.createElement(Ri,null),i.createElement("div",{className:s,onClick:()=>{a&&a(!1),t&&t()},onTouchStart:n,onMouseDown:()=>{a&&a(!0)}}))}function ql(e){let{primaryAction:t,secondaryActions:n,children:r}=e;const o=t&&bc(t,{variant:"primary"})||null,a=n&&bc(n)||null,s=o||a?i.createElement(Bs,{gap:"200"},a,o):null;return i.createElement(Bs,{gap:"400",blockAlign:"center"},i.createElement(ia,{borderColor:"border",borderBlockStartWidth:"025",padding:"400",width:"100%"},i.createElement(Bs,{gap:"400",blockAlign:"center",align:"space-between"},i.createElement(ia,null,r),s)))}const Xl=function(e){let{children:t,title:n,titleHidden:r=!1,src:o,iFrameName:a,open:s,instant:c,sectioned:l,loading:d,size:u,limitHeight:h,footer:p,primaryAction:m,secondaryActions:f,onScrolledToBottom:g,activator:_,activatorWrapper:v="div",onClose:b,onIFrameLoad:E,onTransitionEnd:y,noScroll:S}=e;const[T,C]=(0,i.useState)(200),[w,R]=(0,i.useState)(!1),A=(0,i.useId)(),I=(0,i.useRef)(null),N=ji().translate("Polaris.Modal.iFrameTitle");let O,P;const k=(0,i.useCallback)(()=>{y&&y()},[y]),D=(0,i.useCallback)(()=>{C(200);const e=_&&Jl(_)?_&&_.current:I.current;e&&requestAnimationFrame(()=>Fo(e))},[_]),x=(0,i.useCallback)(e=>{const t=e.target;if(t&&t.contentWindow)try{C(t.contentWindow.document.body.scrollHeight)}catch(n){C(400)}null!=E&&E(e)},[E]);if(s){const e=p||m||f?i.createElement(ql,{primaryAction:m,secondaryActions:f},p):null,s=l?zo(t,ml,{titleHidden:r}):t,_=d?i.createElement(ia,{padding:"400"},i.createElement(Bs,{gap:"400",align:"center",blockAlign:"center"},i.createElement(hs,null))):s,v=S?i.createElement("div",{className:dl},i.createElement(ia,{width:"100%",overflowX:"hidden",overflowY:"hidden"},_)):i.createElement(Ta,{shadow:!0,className:ll,onScrolledToBottom:g},_),E=o?i.createElement("iframe",{name:a,title:N,src:o,className:ul,onLoad:x,style:{height:"".concat(T,"px")}}):v;O=i.createElement(Ll,{instant:c,labelledBy:A,onClose:b,onEntered:k,onExited:D,size:u,limitHeight:h,setClosing:R},i.createElement(Hl,{titleHidden:r,id:A,closing:w,onClose:b},n),E,e),P=i.createElement(Yl,{setClosing:R,onClick:b})}const L=!c,M=_&&!Jl(_)?i.createElement(ia,{ref:I,as:v},_):null;return i.createElement(cl.Provider,{value:!0},M,i.createElement(Ja,{idPrefix:"modal"},i.createElement(sl,{appear:L,enter:L,exit:L},O),P))};function Jl(e){return Object.prototype.hasOwnProperty.call(e,"current")}Xl.Section=ml;var Zl="Polaris-FormLayout__Item",Ql="Polaris-FormLayout--grouped",$l="Polaris-FormLayout--condensed";function ed(e){let{children:t,condensed:n=!1}=e;const r=qr(Zl,n?$l:Ql);return t?i.createElement("div",{className:r},t):null}function td(e){let{children:t,condensed:n,title:r,helpText:o}=e;const a=(0,i.useId)();let s,c,l=null,d=null;o&&(s="".concat(a,"HelpText"),l=i.createElement(ia,{id:s,color:"text-secondary"},o)),r&&(c="".concat(a,"Title"),d=i.createElement(Qi,{id:c,as:"p"},r));const u=i.Children.map(t,e=>zo(e,ed,{condensed:n}));return i.createElement(qs,{role:"group",gap:"200","aria-labelledby":c,"aria-describedby":s},d,i.createElement(Bs,{gap:"300"},u),l)}const nd=(0,i.memo)(function(e){let{children:t}=e;return i.createElement(qs,{gap:"400"},i.Children.map(t,rd))});function rd(e,t){if(Yo(e,td))return e;return zo(e,ed,{key:t})}nd.Group=td;var id="Polaris-FooterHelp";function od(e){let{children:t,align:n="center"}=e;const r={"--pc-footer-help-align":n};return i.createElement("div",{className:id,style:r},i.createElement(Qi,{as:"p",variant:"bodyLg"},t))}var ad=n(579);const sd=function(){return(0,ad.jsxs)(od,{children:["Learn more about"," ",(0,ad.jsx)(So,{url:"https://help.shopify.com/manual/orders/fulfill-orders",children:"fulfilling orders"})]})};function cd(){const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(!1),[o,a]=(0,i.useState)(!1),[s,c]=(0,i.useState)(""),[l,d]=(0,i.useState)(""),[u,h]=(0,i.useState)(null),p=new URLSearchParams(window.location.search).get("adminId");(0,i.useEffect)(()=>{p&&(localStorage.setItem("domain_V_id",p),h(p))},[p]);(0,i.useCallback)(()=>t(e=>!e),[]);return(0,ad.jsxs)(i.Fragment,{children:[(0,ad.jsx)(Oe,{context:{adminIdLocal:u}}),(0,ad.jsx)(sd,{}),n&&(0,ad.jsx)(Jc,{content:"Saved successfully",onDismiss:()=>r(!1)}),(0,ad.jsx)(Xl,{open:o,onClose:()=>a(!1),title:"Contact support",primaryAction:{content:"Send",onAction:()=>a(!1)},children:(0,ad.jsx)(Xl.Section,{children:(0,ad.jsxs)(nd,{children:[(0,ad.jsx)(Dc,{label:"Subject",value:s,onChange:c}),(0,ad.jsx)(Dc,{label:"Message",value:l,onChange:d,multiline:!0})]})})})]})}function ld(e){return!(0,i.isValidElement)(e)&&void 0!==e}function dd(e){return(0,i.isValidElement)(e)&&void 0!==e}var ud="Polaris-Page",hd="Polaris-Page--fullWidth",pd="Polaris-Page--narrowWidth",md="Polaris-Page__Content",fd={TitleWrapper:"Polaris-Page-Header__TitleWrapper",TitleWrapperExpand:"Polaris-Page-Header__TitleWrapperExpand",BreadcrumbWrapper:"Polaris-Page-Header__BreadcrumbWrapper",PaginationWrapper:"Polaris-Page-Header__PaginationWrapper",PrimaryActionWrapper:"Polaris-Page-Header__PrimaryActionWrapper",Row:"Polaris-Page-Header__Row",mobileView:"Polaris-Page-Header--mobileView",RightAlign:"Polaris-Page-Header__RightAlign",noBreadcrumbs:"Polaris-Page-Header--noBreadcrumbs",AdditionalMetaData:"Polaris-Page-Header__AdditionalMetaData",Actions:"Polaris-Page-Header__Actions",longTitle:"Polaris-Page-Header--longTitle",mediumTitle:"Polaris-Page-Header--mediumTitle",isSingleRow:"Polaris-Page-Header--isSingleRow"},gd=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M16.5 10a.75.75 0 0 1-.75.75h-9.69l2.72 2.72a.75.75 0 0 1-1.06 1.06l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 1 1 1.06 1.06l-2.72 2.72h9.69a.75.75 0 0 1 .75.75Z"}))};function _d(e){var t;let{backAction:n}=e;const{content:r}=n;return i.createElement(fs,{key:r,url:"url"in n?n.url:void 0,onClick:"onAction"in n?n.onAction:void 0,onPointerDown:Lo,icon:gd,accessibilityLabel:null!==(t=n.accessibilityLabel)&&void 0!==t?t:r})}gd.displayName="ArrowLeftIcon";var vd="Polaris-Header-Title",bd="Polaris-Header-Title__TitleWithSubtitle",Ed="Polaris-Header-Title__TitleWrapper",yd="Polaris-Header-Title__SubTitle",Sd="Polaris-Header-Title__SubtitleCompact",Td="Polaris-Header-Title__SubtitleMaxWidth",Cd="Polaris-Bleed";const wd=e=>{let{marginInline:t,marginBlock:n,marginBlockStart:r,marginBlockEnd:o,marginInlineStart:s,marginInlineEnd:c,children:l}=e;const d=e=>{const i={marginBlockStart:r,marginBlockEnd:o,marginInlineStart:s,marginInlineEnd:c,marginInline:t,marginBlock:n};return i[e]?i[e]:["marginInlineStart","marginInlineEnd"].includes(e)&&t?i.marginInline:["marginBlockStart","marginBlockEnd"].includes(e)&&n?i.marginBlock:void 0},u=d("marginBlockStart"),h=d("marginBlockEnd"),p=d("marginInlineStart"),m=d("marginInlineEnd"),f=(0,a.A)((0,a.A)((0,a.A)((0,a.A)({},Zr("bleed","margin-block-start","space",u)),Zr("bleed","margin-block-end","space",h)),Zr("bleed","margin-inline-start","space",p)),Zr("bleed","margin-inline-end","space",m));return i.createElement("div",{className:Cd,style:Jr(f)},l)};function Rd(e){let{title:t,subtitle:n,titleMetadata:r,compactTitle:o,hasSubtitleMaxWidth:a}=e;const s=qr(vd,n&&bd),c=t?i.createElement("h1",{className:s},i.createElement(Qi,{as:"span",variant:"headingLg",fontWeight:"bold"},t)):null,l=r?i.createElement(wd,{marginBlock:"100"},r):null,d=i.createElement("div",{className:Ed},c,l),u=n?i.createElement("div",{className:qr(yd,o&&Sd,a&&Td)},i.createElement(Qi,{as:"p",variant:"bodySm",tone:"subdued"},n)):null;return i.createElement(i.Fragment,null,d,u)}var Ad={ActionMenu:"Polaris-ActionMenu"},Id=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M6 10a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}),i.createElement("path",{d:"M11.5 10a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}),i.createElement("path",{d:"M17 10a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))};Id.displayName="MenuHorizontalIcon";var Nd="Polaris-ActionMenu-RollupActions__RollupActivator";function Od(e){let{accessibilityLabel:t,items:n=[],sections:r=[]}=e;const o=ji(),{value:a,toggle:s}=ti(!1);if(0===n.length&&0===r.length)return null;const c=i.createElement("div",{className:Nd},i.createElement(fs,{icon:Id,accessibilityLabel:t||o.translate("Polaris.ActionMenu.RollupActions.rollupButton"),onClick:s}));return i.createElement(ts,{active:a,activator:c,preferredAlignment:"right",onClose:s,hideOnPrint:!0},i.createElement(Lc,{items:n,sections:r,onActionAnyItem:s}))}var Pd="Polaris-ActionMenu-Actions__ActionsLayoutOuter",kd="Polaris-ActionMenu-Actions__ActionsLayout",Dd="Polaris-ActionMenu-Actions--actionsLayoutMeasuring",xd="Polaris-ActionMenu-Actions__ActionsLayoutMeasurer";function Ld(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const o=r.reduce((e,t)=>e+t,0),a=e.map((e,t)=>t),s=t.map((e,t)=>t),c=[],l=[],d=[],u=[];if(i>o)c.push(...a),d.push(...s);else{let t=0;a.forEach(e=>{const o=r[e];t+o>=i-n?l.push(e):(c.push(e),t+=o)}),s.forEach(o=>{const a=r[o+e.length];t+a>=i-n?u.push(o):(d.push(o),t+=a)})}return{visibleActions:c,hiddenActions:l,visibleGroups:d,hiddenGroups:u}}var Md="Polaris-ActionMenu-MenuGroup__Details",Ud="Polaris-ActionMenu-SecondaryAction",Fd="Polaris-ActionMenu-SecondaryAction--critical";const jd=["children","tone","helpText","onAction","destructive"];function Vd(e){let{children:t,tone:n,helpText:r,onAction:a,destructive:s}=e,c=(0,o.A)(e,jd);const l=i.createElement(fs,Object.assign({onClick:a,tone:s?"critical":void 0},c),t),d=r?i.createElement(Fs,{preferredPosition:"below",content:r},l):l;return i.createElement("div",{className:qr(Ud,"critical"===n&&Fd)},d)}function Bd(e){let{accessibilityLabel:t,active:n,actions:r,details:o,title:a,icon:s,disabled:c,onClick:l,onClose:d,onOpen:u,sections:h}=e;const p=(0,i.useCallback)(()=>{d(a)},[d,a]),m=(0,i.useCallback)(()=>{u(a)},[u,a]),f=(0,i.useCallback)(()=>{l?l(m):m()},[l,m]),g=i.createElement(Vd,{disclosure:!0,disabled:c,icon:s,accessibilityLabel:t,onClick:f},a);return i.createElement(ts,{active:Boolean(n),activator:g,preferredAlignment:"left",onClose:p,hideOnPrint:!0},i.createElement(Lc,{items:r,sections:h,onActionAnyItem:p}),o&&i.createElement("div",{className:Md},o))}const Wd=["content","onAction"];function Hd(e){let{actions:t=[],groups:n=[],handleMeasurement:r}=e;const a=ji(),s=(0,i.useRef)(null),c={title:a.translate("Polaris.ActionMenu.Actions.moreActions"),actions:[]},l=i.createElement(Vd,{disclosure:!0},c.title),d=(0,i.useCallback)(()=>{if(!s.current)return;const e=s.current.offsetWidth,t=s.current.children,n=Array.from(t).map(e=>Math.ceil(e.getBoundingClientRect().width)+8),i=n.pop()||0;r({containerWidth:e,disclosureWidth:i,hiddenActionsWidths:n})},[r]);(0,i.useEffect)(()=>{d()},[d,t,n]);const u=t.map(e=>{const{content:t,onAction:n}=e,r=(0,o.A)(e,Wd);return i.createElement(Vd,Object.assign({key:t,onClick:n},r),t)}),h=n.map(e=>{const{title:t,icon:n}=e;return i.createElement(Vd,{key:t,disclosure:!0,icon:n},t)});return Zs("resize",d),i.createElement("div",{className:xd,ref:s},u,h,l)}const Gd=["content","onAction"],zd=["title","actions"];function Kd(e){let{actions:t,groups:n,onActionRollup:r}=e;const s=ji(),c=(0,i.useRef)(null),[l,d]=(0,i.useState)(void 0),[u,h]=(0,i.useReducer)((e,t)=>(0,a.A)((0,a.A)({},e),t),{disclosureWidth:0,containerWidth:1/0,actionsWidths:[],visibleActions:[],hiddenActions:[],visibleGroups:[],hiddenGroups:[],hasMeasured:!1}),{visibleActions:p,hiddenActions:m,visibleGroups:f,hiddenGroups:g,containerWidth:_,disclosureWidth:v,actionsWidths:b,hasMeasured:E}=u,y={title:s.translate("Polaris.ActionMenu.Actions.moreActions"),actions:[]},S=(0,i.useCallback)(e=>d(l?void 0:e),[l]),T=(0,i.useCallback)(()=>d(void 0),[]);(0,i.useEffect)(()=>{if(0===_)return;const{visibleActions:e,visibleGroups:r,hiddenActions:i,hiddenGroups:o}=Ld(t,n,v,b,_);h({visibleActions:e,visibleGroups:r,hiddenActions:i,hiddenGroups:o,hasMeasured:_!==1/0})},[_,v,t,n,b,h]);const C=(0,i.useMemo)(()=>null!==t&&void 0!==t?t:[],[t]),w=(0,i.useMemo)(()=>null!==n&&void 0!==n?n:[],[n]),R=C.filter((e,t)=>!!p.includes(t)).map(e=>{const{content:t,onAction:n}=e,r=(0,o.A)(e,Gd);return i.createElement(Vd,Object.assign({key:t,onClick:n},r),t)}),A=(g.length>0||m.length>0?[...w,y]:[...w]).filter((e,t)=>{const n=0===w.length,r=f.includes(t),i=e===y;return n?m.length>0:!!i||r}),I=m.map(e=>C[e]).filter(e=>null!=e),N=g.map(e=>w[e]).filter(e=>null!=e),O=A.map(e=>{const{title:t,actions:n}=e,r=(0,o.A)(e,zd),s=e===y,c=[...I,...N],[d,u]=c.reduce((e,t)=>{let[n,r]=e;return"title"in t?r.push({title:t.title,items:t.actions.map(e=>(0,a.A)((0,a.A)({},e),{},{disabled:t.disabled||e.disabled}))}):n.push(t),[n,r]},[[],[]]);return s?i.createElement(Bd,Object.assign({key:t,title:t,active:t===l,actions:[...d,...n],sections:u},r,{onOpen:S,onClose:T})):i.createElement(Bd,Object.assign({key:t,title:t,active:t===l,actions:n},r,{onOpen:S,onClose:T}))}),P=(0,i.useCallback)(e=>{const{hiddenActionsWidths:t,containerWidth:n,disclosureWidth:i}=e,{visibleActions:o,hiddenActions:a,visibleGroups:s,hiddenGroups:l}=Ld(C,w,i,t,n);if(r){const e=a.length>0||l.length>0;c.current!==e&&(r(e),c.current=e)}h({visibleActions:o,hiddenActions:a,visibleGroups:s,hiddenGroups:l,actionsWidths:t,containerWidth:n,disclosureWidth:i,hasMeasured:!0})},[C,w,r]),k=i.createElement(Hd,{actions:t,groups:n,handleMeasurement:P});return i.createElement("div",{className:Pd},k,i.createElement("div",{className:qr(kd,!E&&Dd)},R,O))}function Yd(e){let{actions:t=[],groups:n=[],rollup:r,rollupActionsLabel:o,onActionRollup:s}=e;if(0===t.length&&0===n.length)return null;const c=qr(Ad.ActionMenu,r&&Ad.rollup),l=n.map(e=>function(e){let{title:t,actions:n,disabled:r}=e;return{title:t,items:n.map(e=>(0,a.A)((0,a.A)({},e),{},{disabled:r||e.disabled}))}}(e));return i.createElement("div",{className:c},r?i.createElement(Od,{accessibilityLabel:o,items:t,sections:l}):i.createElement(Kd,{actions:t,groups:n,onActionRollup:s}))}const qd=(0,i.createContext)(void 0);function Xd(){const e=(0,i.useContext)(qd);if(!e)throw new Error("No mediaQuery was provided. Your application must be wrapped in an <AppProvider> component. See https://polaris.shopify.com/components/app-provider for implementation instructions.");return e}var Jd=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M11.764 5.204a.75.75 0 0 1 .032 1.06l-3.516 3.736 3.516 3.736a.75.75 0 1 1-1.092 1.028l-4-4.25a.75.75 0 0 1 0-1.028l4-4.25a.75.75 0 0 1 1.06-.032Z"}))};Jd.displayName="ChevronLeftIcon";var Zd,Qd=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M7.72 14.53a.75.75 0 0 1 0-1.06l3.47-3.47-3.47-3.47a.75.75 0 0 1 1.06-1.06l4 4a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0Z"}))};Qd.displayName="ChevronRightIcon",function(e){e.Input="INPUT",e.Textarea="TEXTAREA",e.Select="SELECT",e.ContentEditable="contenteditable"}(Zd||(Zd={}));var $d="Polaris-Pagination",eu="Polaris-Pagination--table",tu="Polaris-Pagination__TablePaginationActions",nu={ButtonGroup:"Polaris-ButtonGroup",Item:"Polaris-ButtonGroup__Item","Item-plain":"Polaris-ButtonGroup__Item--plain",variantSegmented:"Polaris-ButtonGroup--variantSegmented","Item-focused":"Polaris-ButtonGroup__Item--focused",fullWidth:"Polaris-ButtonGroup--fullWidth",extraTight:"Polaris-ButtonGroup--extraTight",tight:"Polaris-ButtonGroup--tight",loose:"Polaris-ButtonGroup--loose",noWrap:"Polaris-ButtonGroup--noWrap"};function ru(e){let{button:t}=e;const{value:n,setTrue:r,setFalse:o}=ti(!1),a=qr(nu.Item,n&&nu["Item-focused"],"plain"===t.props.variant&&nu["Item-plain"]);return i.createElement("div",{className:a,onFocus:r,onBlur:o},t)}function iu(e){let{children:t,gap:n,variant:r,fullWidth:o,connectedTop:a,noWrap:s}=e;const c=qr(nu.ButtonGroup,n&&nu[n],r&&nu[Xr("variant",r)],o&&nu.fullWidth,s&&nu.noWrap),l=qo(t).map((e,t)=>i.createElement(ru,{button:e,key:t}));return i.createElement("div",{className:c,"data-buttongroup-variant":r,"data-buttongroup-connected-top":a,"data-buttongroup-full-width":o,"data-buttongroup-no-wrap":s},l)}function ou(e){let{hasNext:t,hasPrevious:n,nextURL:r,previousURL:o,onNext:a,onPrevious:s,nextTooltip:c,previousTooltip:l,nextKeys:d,previousKeys:u,accessibilityLabel:h,accessibilityLabels:p,label:m,type:f="page"}=e;const g=ji(),_=(0,i.createRef)(),v=h||g.translate("Polaris.Pagination.pagination"),b=(null===p||void 0===p?void 0:p.previous)||g.translate("Polaris.Pagination.previous"),E=(null===p||void 0===p?void 0:p.next)||g.translate("Polaris.Pagination.next"),y=i.createElement(fs,{icon:Jd,accessibilityLabel:b,url:o,onClick:s,disabled:!n,id:"previousURL"}),S=l&&n?i.createElement(Fs,{activatorWrapper:"span",content:l,preferredPosition:"below"},y):y,T=i.createElement(fs,{icon:Qd,accessibilityLabel:E,url:r,onClick:a,disabled:!t,id:"nextURL"}),C=c&&t?i.createElement(Fs,{activatorWrapper:"span",content:c,preferredPosition:"below"},T):T,w=s||cu,R=u&&(o||s)&&n&&u.map(e=>i.createElement(Ia,{key:e,keyCode:e,handler:su(o?au("previousURL",_):w)})),A=a||cu,I=d&&(r||a)&&t&&d.map(e=>i.createElement(Ia,{key:e,keyCode:e,handler:su(r?au("nextURL",_):A)}));if("table"===f){const e=m?i.createElement(ia,{padding:"300",paddingBlockStart:"0",paddingBlockEnd:"0"},i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium"},m)):null;return i.createElement("nav",{"aria-label":v,ref:_,className:qr($d,eu)},R,I,i.createElement(ia,{background:"bg-surface-secondary",paddingBlockStart:"150",paddingBlockEnd:"150",paddingInlineStart:"300",paddingInlineEnd:"200"},i.createElement(Bs,{align:"center",blockAlign:"center"},i.createElement("div",{className:tu,"data-buttongroup-variant":"segmented"},i.createElement("div",null,S),e,i.createElement("div",null,C)))))}const N=t&&n?i.createElement("span",null,m):i.createElement(Qi,{tone:"subdued",as:"span"},m),O=m?i.createElement(ia,{padding:"300",paddingBlockStart:"0",paddingBlockEnd:"0"},i.createElement("div",{"aria-live":"polite"},N)):null;return i.createElement("nav",{"aria-label":v,ref:_,className:$d},R,I,i.createElement(iu,{variant:"segmented"},S,O,C))}function au(e,t){return()=>{if(null==t.current)return;const n=t.current.querySelector("#".concat(e));n&&n.click()}}function su(e){return()=>{(function(){if(null==document||null==document.activeElement)return!1;const{tagName:e}=document.activeElement;return e===Zd.Input||e===Zd.Textarea||e===Zd.Select||document.activeElement.hasAttribute(Zd.ContentEditable)})()||e()}}function cu(){}function lu(e){let{title:t,subtitle:n,pageReadyAccessibilityLabel:r,titleMetadata:o,additionalMetadata:a,titleHidden:s=!1,primaryAction:c,pagination:l,filterActions:d,backAction:u,secondaryActions:h=[],actionGroups:p=[],compactTitle:m=!1,onActionRollup:f}=e;const g=ji(),{isNavigationCollapsed:_}=Xd(),v=!c&&!l&&(ld(h)&&!h.length||dd(h))&&!p.length,b=p.length>0||ld(h)&&h.length>0||dd(h),E=u?i.createElement("div",{className:fd.BreadcrumbWrapper},i.createElement(ia,{maxWidth:"100%",paddingInlineEnd:"100",printHidden:!0},i.createElement(_d,{backAction:u}))):null,y=l&&!_?i.createElement("div",{className:fd.PaginationWrapper},i.createElement(ia,{printHidden:!0},i.createElement(ou,Object.assign({},l,{hasPrevious:l.hasPrevious,hasNext:l.hasNext})))):null,S=i.createElement("div",{className:qr(fd.TitleWrapper,!b&&fd.TitleWrapperExpand)},i.createElement(Rd,{title:t,subtitle:n,titleMetadata:o,compactTitle:m,hasSubtitleMaxWidth:b})),T=r||t,C=T?i.createElement("div",{role:"status"},i.createElement(Qi,{visuallyHidden:!0,as:"p"},g.translate("Polaris.Page.Header.pageReadyAccessibilityLabel",{title:T}))):void 0,w=c?i.createElement(du,{primaryAction:c}):null;let R=null;ld(h)&&(h.length>0||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0!==e.length&&e.some(e=>e.actions.length>0)}(p))?R=i.createElement(Yd,{actions:h,groups:p,rollup:_,rollupActionsLabel:t?g.translate("Polaris.Page.Header.rollupActionsLabel",{title:t}):void 0,onActionRollup:f}):dd(h)&&(R=i.createElement(i.Fragment,null,h));const A=E||y?i.createElement(ia,{printHidden:!0,paddingBlockEnd:"100",paddingInlineEnd:R&&_?"1000":void 0},i.createElement(Bs,{gap:"400",align:"space-between",blockAlign:"center"},E,y)):null,I=a?i.createElement("div",{className:fd.AdditionalMetaData},i.createElement(Qi,{tone:"subdued",as:"span",variant:"bodySm"},a)):null,N=qr(v&&fd.isSingleRow,A&&fd.hasNavigation,R&&fd.hasActionMenu,_&&fd.mobileView,!u&&fd.noBreadcrumbs,t&&t.length<34&&fd.mediumTitle,t&&t.length>34&&fd.longTitle),{slot1:O,slot2:P,slot3:k,slot4:D,slot5:x}=function(e){let{actionMenuMarkup:t,additionalMetadataMarkup:n,breadcrumbMarkup:r,isNavigationCollapsed:o,pageTitleMarkup:a,paginationMarkup:s,primaryActionMarkup:c,title:l}=e;const d={mobileCompact:{slots:{slot1:null,slot2:a,slot3:t,slot4:c,slot5:n},condition:o&&null==r&&null!=l&&l.length<=8},mobileDefault:{slots:{slot1:r,slot2:a,slot3:t,slot4:c,slot5:n},condition:o},desktopCompact:{slots:{slot1:r,slot2:a,slot3:t,slot4:c,slot5:n},condition:!o&&null==s&&null==t&&null!=l&&l.length<=20},desktopDefault:{slots:{slot1:r,slot2:a,slot3:i.createElement(i.Fragment,null,t,c),slot4:s,slot5:n},condition:!o}};return(Object.values(d).find(e=>e.condition)||d.desktopDefault).slots}({actionMenuMarkup:R,additionalMetadataMarkup:I,breadcrumbMarkup:E,isNavigationCollapsed:_,pageTitleMarkup:S,paginationMarkup:y,primaryActionMarkup:w,title:t});return i.createElement(ia,{position:"relative",paddingBlockStart:{xs:"400",md:"600"},paddingBlockEnd:{xs:"400",md:"600"},paddingInlineStart:{xs:"400",sm:"0"},paddingInlineEnd:{xs:"400",sm:"0"},visuallyHidden:s},C,i.createElement("div",{className:N},i.createElement(bs,{filterActions:Boolean(d)},i.createElement(Jo,{condition:[O,P,k,D].some(uu)},i.createElement("div",{className:fd.Row},O,P,i.createElement(Jo,{condition:[k,D].some(uu)},i.createElement("div",{className:fd.RightAlign},i.createElement(Xo,{condition:[k,D].every(uu),wrapper:e=>i.createElement("div",{className:fd.Actions},e)},k,D))))),i.createElement(Jo,{condition:[x].some(uu)},i.createElement("div",{className:fd.Row},i.createElement(Bs,{gap:"400"},x))))))}function du(e){let{primaryAction:t}=e;const{isNavigationCollapsed:n}=Xd();let r;if(ld(t)){const{primary:e,helpText:o}=t,s=void 0===e||e,c=Ec(function(e,t){let{content:n,accessibilityLabel:r}=t;const{icon:i}=t;if(null==i)return(0,a.A)((0,a.A)({},t),{},{icon:void 0});e&&(r=r||n,n=void 0);return(0,a.A)((0,a.A)({},t),{},{content:n,accessibilityLabel:r,icon:i})}(n,t),{variant:s?"primary":void 0});r=o?i.createElement(Fs,{content:o},c):c}else r=t;return i.createElement("div",{className:fd.PrimaryActionWrapper},i.createElement(ia,{printHidden:!0},r))}function uu(e){return null!=e}const hu=["children","fullWidth","narrowWidth"];function pu(e){let{children:t,fullWidth:n,narrowWidth:r}=e,a=(0,o.A)(e,hu);const s=qr(ud,n&&hd,r&&pd),c=null!=a.title&&""!==a.title||null!=a.subtitle&&""!==a.subtitle||null!=a.primaryAction||null!=a.secondaryActions&&(ld(a.secondaryActions)&&a.secondaryActions.length>0||dd(a.secondaryActions))||null!=a.actionGroups&&a.actionGroups.length>0||null!=a.backAction,l=qr(!c&&md),d=c?i.createElement(lu,Object.assign({filterActions:!0},a)):null;return i.createElement("div",{className:s},d,i.createElement("div",{className:l},t))}var mu={Layout:"Polaris-Layout",Section:"Polaris-Layout__Section","Section-fullWidth":"Polaris-Layout__Section--fullWidth","Section-oneHalf":"Polaris-Layout__Section--oneHalf","Section-oneThird":"Polaris-Layout__Section--oneThird",AnnotatedSection:"Polaris-Layout__AnnotatedSection",AnnotationWrapper:"Polaris-Layout__AnnotationWrapper",AnnotationContent:"Polaris-Layout__AnnotationContent",Annotation:"Polaris-Layout__Annotation"};function fu(e){let{children:t,variant:n}=e;const r=qr(mu.Section,mu["Section-".concat(n)]);return i.createElement("div",{className:r},t)}const gu=function(e){let{sectioned:t,children:n}=e;const r=t?i.createElement(fu,null,n):n;return i.createElement("div",{className:mu.Layout},r)};gu.AnnotatedSection=function(e){let{children:t,title:n,description:r,id:o}=e;const a="string"===typeof r?i.createElement(Qi,{as:"p",variant:"bodyMd"},r):r;return i.createElement("div",{className:mu.AnnotatedSection},i.createElement("div",{className:mu.AnnotationWrapper},i.createElement("div",{className:mu.Annotation},i.createElement(as,{spacing:"tight"},i.createElement(Qi,{id:o,variant:"headingMd",as:"h2"},n),a&&i.createElement(ia,{color:"text-secondary"},a))),i.createElement("div",{className:mu.AnnotationContent},t)))},gu.Section=fu;var _u={Banner:"Polaris-Banner",keyFocused:"Polaris-Banner--keyFocused",withinContentContainer:"Polaris-Banner--withinContentContainer",withinPage:"Polaris-Banner--withinPage",DismissIcon:"Polaris-Banner__DismissIcon","text-success-on-bg-fill":"Polaris-Banner--textSuccessOnBgFill","text-success":"Polaris-Banner__text--success","text-warning-on-bg-fill":"Polaris-Banner--textWarningOnBgFill","text-warning":"Polaris-Banner__text--warning","text-critical-on-bg-fill":"Polaris-Banner--textCriticalOnBgFill","text-critical":"Polaris-Banner__text--critical","text-info-on-bg-fill":"Polaris-Banner--textInfoOnBgFill","text-info":"Polaris-Banner__text--info","icon-secondary":"Polaris-Banner__icon--secondary"},vu=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M15.78 5.97a.75.75 0 0 1 0 1.06l-6.5 6.5a.75.75 0 0 1-1.06 0l-3.25-3.25a.75.75 0 1 1 1.06-1.06l2.72 2.72 5.97-5.97a.75.75 0 0 1 1.06 0Z"}))};vu.displayName="CheckIcon";var bu=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10 6.75a.75.75 0 0 1 .75.75v3.5a.75.75 0 1 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"}),i.createElement("path",{d:"M11 13.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}),i.createElement("path",{fillRule:"evenodd",d:"M10 3.5c-1.045 0-1.784.702-2.152 1.447a449.26 449.26 0 0 1-2.005 3.847l-.028.052a403.426 403.426 0 0 0-2.008 3.856c-.372.752-.478 1.75.093 2.614.57.863 1.542 1.184 2.464 1.184h7.272c.922 0 1.895-.32 2.464-1.184.57-.864.465-1.862.093-2.614-.21-.424-1.113-2.147-2.004-3.847l-.032-.061a429.497 429.497 0 0 1-2.005-3.847c-.368-.745-1.107-1.447-2.152-1.447Zm-.808 2.112c.404-.816 1.212-.816 1.616 0 .202.409 1.112 2.145 2.022 3.88a418.904 418.904 0 0 1 2.018 3.875c.404.817 0 1.633-1.212 1.633h-7.272c-1.212 0-1.617-.816-1.212-1.633.202-.408 1.113-2.147 2.023-3.883a421.932 421.932 0 0 0 2.017-3.872Z"}))};bu.displayName="AlertTriangleIcon";var Eu=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10 6a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5a.75.75 0 0 1 .75-.75Z"}),i.createElement("path",{d:"M11 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"}),i.createElement("path",{fillRule:"evenodd",d:"M11.237 3.177a1.75 1.75 0 0 0-2.474 0l-5.586 5.585a1.75 1.75 0 0 0 0 2.475l5.586 5.586a1.75 1.75 0 0 0 2.474 0l5.586-5.586a1.75 1.75 0 0 0 0-2.475l-5.586-5.585Zm-1.414 1.06a.25.25 0 0 1 .354 0l5.586 5.586a.25.25 0 0 1 0 .354l-5.586 5.585a.25.25 0 0 1-.354 0l-5.586-5.585a.25.25 0 0 1 0-.354l5.586-5.586Z"}))};Eu.displayName="AlertDiamondIcon";var yu=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10 14a.75.75 0 0 1-.75-.75v-3.5a.75.75 0 0 1 1.5 0v3.5a.75.75 0 0 1-.75.75Z"}),i.createElement("path",{d:"M9 7a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z"}),i.createElement("path",{fillRule:"evenodd",d:"M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Zm-1.5 0a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0Z"}))};yu.displayName="InfoIcon";const Su={success:{withinPage:{background:"bg-fill-success",text:"text-success-on-bg-fill",icon:"text-success-on-bg-fill"},withinContentContainer:{background:"bg-surface-success",text:"text-success",icon:"text-success"},icon:vu},warning:{withinPage:{background:"bg-fill-warning",text:"text-warning-on-bg-fill",icon:"text-warning-on-bg-fill"},withinContentContainer:{background:"bg-surface-warning",text:"text-warning",icon:"text-warning"},icon:bu},critical:{withinPage:{background:"bg-fill-critical",text:"text-critical-on-bg-fill",icon:"text-critical-on-bg-fill"},withinContentContainer:{background:"bg-surface-critical",text:"text-critical",icon:"text-critical"},icon:Eu},info:{withinPage:{background:"bg-fill-info",text:"text-info-on-bg-fill",icon:"text-info-on-bg-fill"},withinContentContainer:{background:"bg-surface-info",text:"text-info",icon:"text-info"},icon:yu}};const Tu=(0,i.forwardRef)(function(e,t){const{tone:n,stopAnnouncements:r}=e,o=(0,i.useContext)(cl),{wrapperRef:a,handleKeyUp:s,handleBlur:c,handleMouseUp:l,shouldShowFocus:d}=function(e){const t=(0,i.useRef)(null),[n,r]=(0,i.useState)(!1);return(0,i.useImperativeHandle)(e,()=>({focus:()=>{var e;null===(e=t.current)||void 0===e||e.focus(),r(!0)}}),[]),{wrapperRef:t,handleKeyUp:e=>{e.target===t.current&&r(!0)},handleBlur:()=>r(!1),handleMouseUp:e=>{e.currentTarget.blur(),r(!1)},shouldShowFocus:n}}(t),u=qr(_u.Banner,d&&_u.keyFocused,o?_u.withinContentContainer:_u.withinPage);return i.createElement(so.Provider,{value:!0},i.createElement("div",{className:u,tabIndex:0,ref:a,role:"warning"===n||"critical"===n?"alert":"status","aria-live":r?"off":"polite",onMouseUp:l,onKeyUp:s,onBlur:c},i.createElement(Cu,e)))});function Cu(e){let{tone:t="info",icon:n,hideIcon:r,onDismiss:o,action:a,secondaryAction:s,title:c,children:l}=e;const d=ji(),u=(0,i.useContext)(cl),h=!c&&!u,p=Object.keys(Su).includes(t)?t:"info",m=Su[p][u?"withinContentContainer":"withinPage"],f={backgroundColor:m.background,textColor:m.text,bannerTitle:c?i.createElement(Qi,{as:"h2",variant:"headingSm",breakWord:!0},c):null,bannerIcon:r?null:i.createElement("span",{className:_u[m.icon]},i.createElement($i,{source:null!==n&&void 0!==n?n:Su[p].icon})),actionButtons:a||s?i.createElement(iu,null,a&&i.createElement(fs,Object.assign({onClick:a.onAction},a),a.content),s&&i.createElement(fs,Object.assign({onClick:s.onAction},s),s.content)):null,dismissButton:o?i.createElement(fs,{variant:"tertiary",icon:i.createElement("span",{className:_u[h?"icon-secondary":m.icon]},i.createElement($i,{source:Fl})),onClick:o,accessibilityLabel:d.translate("Polaris.Banner.dismissButton")}):null},g=l?i.createElement(Qi,{as:"span",variant:"bodyMd"},l):null;return u?i.createElement(Au,f,g):h?i.createElement(Ru,f,g):i.createElement(wu,f,g)}function wu(e){let{backgroundColor:t,textColor:n,bannerTitle:r,bannerIcon:o,actionButtons:a,dismissButton:s,children:c}=e;const{smUp:l}=Xi(),d=c||a;return i.createElement(ia,{width:"100%"},i.createElement(qs,{align:"space-between"},i.createElement(ia,{background:t,color:n,borderStartStartRadius:l?"300":void 0,borderStartEndRadius:l?"300":void 0,borderEndStartRadius:!d&&l?"300":void 0,borderEndEndRadius:!d&&l?"300":void 0,padding:"300"},i.createElement(Bs,{align:"space-between",blockAlign:"center",gap:"200",wrap:!1},i.createElement(Bs,{gap:"100",wrap:!1},o,r),s)),d&&i.createElement(ia,{padding:{xs:"300",md:"400"},paddingBlockStart:"300"},i.createElement(qs,{gap:"200"},i.createElement("div",null,c),a))))}function Ru(e){let{backgroundColor:t,bannerIcon:n,actionButtons:r,dismissButton:o,children:a}=e;const[s,c]=(0,i.useState)("center"),l=(0,i.useRef)(null),d=(0,i.useRef)(null),u=(0,i.useRef)(null),h=(0,i.useCallback)(()=>{var e,t,n;const r=null===(e=l.current)||void 0===e?void 0:e.offsetHeight,i=(null===(t=d.current)||void 0===t?void 0:t.offsetHeight)||(null===(n=u.current)||void 0===n?void 0:n.offsetHeight);r&&i&&c(r>i?"start":"center")},[]);return(0,i.useEffect)(()=>h(),[h]),Zs("resize",h),i.createElement(ia,{width:"100%",padding:"300",borderRadius:"300"},i.createElement(Bs,{align:"space-between",blockAlign:s,wrap:!1},i.createElement(ia,{width:"100%"},i.createElement(Bs,{gap:"200",wrap:!1,blockAlign:s},n?i.createElement("div",{ref:d},i.createElement(ia,{background:t,borderRadius:"200",padding:"100"},n)):null,i.createElement(ia,{ref:l,width:"100%"},i.createElement(qs,{gap:"200"},i.createElement("div",null,a),r)))),i.createElement("div",{ref:u,className:_u.DismissIcon},o)))}function Au(e){let{backgroundColor:t,textColor:n,bannerTitle:r,bannerIcon:o,actionButtons:a,dismissButton:s,children:c}=e;return i.createElement(ia,{width:"100%",background:t,padding:"200",borderRadius:"200",color:n},i.createElement(Bs,{align:"space-between",blockAlign:"start",wrap:!1,gap:"200"},i.createElement(Bs,{gap:"150",wrap:!1},o,i.createElement(ia,{width:"100%"},i.createElement(qs,{gap:"200"},i.createElement(qs,{gap:"050"},r,i.createElement("div",null,c)),a))),s))}var Iu="Polaris-Grid",Nu={Cell:"Polaris-Grid-Cell","Cell-1-column-xs":"Polaris-Grid-Cell--cell_1ColumnXs","Cell-2-column-xs":"Polaris-Grid-Cell--cell_2ColumnXs","Cell-3-column-xs":"Polaris-Grid-Cell--cell_3ColumnXs","Cell-4-column-xs":"Polaris-Grid-Cell--cell_4ColumnXs","Cell-5-column-xs":"Polaris-Grid-Cell--cell_5ColumnXs","Cell-6-column-xs":"Polaris-Grid-Cell--cell_6ColumnXs","Cell-1-column-sm":"Polaris-Grid-Cell--cell_1ColumnSm","Cell-2-column-sm":"Polaris-Grid-Cell--cell_2ColumnSm","Cell-3-column-sm":"Polaris-Grid-Cell--cell_3ColumnSm","Cell-4-column-sm":"Polaris-Grid-Cell--cell_4ColumnSm","Cell-5-column-sm":"Polaris-Grid-Cell--cell_5ColumnSm","Cell-6-column-sm":"Polaris-Grid-Cell--cell_6ColumnSm","Cell-1-column-md":"Polaris-Grid-Cell--cell_1ColumnMd","Cell-2-column-md":"Polaris-Grid-Cell--cell_2ColumnMd","Cell-3-column-md":"Polaris-Grid-Cell--cell_3ColumnMd","Cell-4-column-md":"Polaris-Grid-Cell--cell_4ColumnMd","Cell-5-column-md":"Polaris-Grid-Cell--cell_5ColumnMd","Cell-6-column-md":"Polaris-Grid-Cell--cell_6ColumnMd","Cell-1-column-lg":"Polaris-Grid-Cell--cell_1ColumnLg","Cell-2-column-lg":"Polaris-Grid-Cell--cell_2ColumnLg","Cell-3-column-lg":"Polaris-Grid-Cell--cell_3ColumnLg","Cell-4-column-lg":"Polaris-Grid-Cell--cell_4ColumnLg","Cell-5-column-lg":"Polaris-Grid-Cell--cell_5ColumnLg","Cell-6-column-lg":"Polaris-Grid-Cell--cell_6ColumnLg","Cell-7-column-lg":"Polaris-Grid-Cell--cell_7ColumnLg","Cell-8-column-lg":"Polaris-Grid-Cell--cell_8ColumnLg","Cell-9-column-lg":"Polaris-Grid-Cell--cell_9ColumnLg","Cell-10-column-lg":"Polaris-Grid-Cell--cell_10ColumnLg","Cell-11-column-lg":"Polaris-Grid-Cell--cell_11ColumnLg","Cell-12-column-lg":"Polaris-Grid-Cell--cell_12ColumnLg","Cell-1-column-xl":"Polaris-Grid-Cell--cell_1ColumnXl","Cell-2-column-xl":"Polaris-Grid-Cell--cell_2ColumnXl","Cell-3-column-xl":"Polaris-Grid-Cell--cell_3ColumnXl","Cell-4-column-xl":"Polaris-Grid-Cell--cell_4ColumnXl","Cell-5-column-xl":"Polaris-Grid-Cell--cell_5ColumnXl","Cell-6-column-xl":"Polaris-Grid-Cell--cell_6ColumnXl","Cell-7-column-xl":"Polaris-Grid-Cell--cell_7ColumnXl","Cell-8-column-xl":"Polaris-Grid-Cell--cell_8ColumnXl","Cell-9-column-xl":"Polaris-Grid-Cell--cell_9ColumnXl","Cell-10-column-xl":"Polaris-Grid-Cell--cell_10ColumnXl","Cell-11-column-xl":"Polaris-Grid-Cell--cell_11ColumnXl","Cell-12-column-xl":"Polaris-Grid-Cell--cell_12ColumnXl"};const Ou=function(e){let{gap:t,areas:n,children:r,columns:o}=e;const a={"--pc-grid-gap-xs":null===t||void 0===t?void 0:t.xs,"--pc-grid-gap-sm":null===t||void 0===t?void 0:t.sm,"--pc-grid-gap-md":null===t||void 0===t?void 0:t.md,"--pc-grid-gap-lg":null===t||void 0===t?void 0:t.lg,"--pc-grid-gap-xl":null===t||void 0===t?void 0:t.xl,"--pc-grid-columns-xs":null===o||void 0===o?void 0:o.xs,"--pc-grid-columns-sm":null===o||void 0===o?void 0:o.sm,"--pc-grid-columns-md":null===o||void 0===o?void 0:o.md,"--pc-grid-columns-lg":null===o||void 0===o?void 0:o.lg,"--pc-grid-columns-xl":null===o||void 0===o?void 0:o.xl,"--pc-grid-areas-xs":Pu(null===n||void 0===n?void 0:n.xs),"--pc-grid-areas-sm":Pu(null===n||void 0===n?void 0:n.sm),"--pc-grid-areas-md":Pu(null===n||void 0===n?void 0:n.md),"--pc-grid-areas-lg":Pu(null===n||void 0===n?void 0:n.lg),"--pc-grid-areas-xl":Pu(null===n||void 0===n?void 0:n.xl)};return i.createElement("div",{className:Iu,style:a},r)};function Pu(e){if(e)return"'".concat(null===e||void 0===e?void 0:e.join("' '"),"'")}Ou.Cell=function(e){let{area:t,column:n,columnSpan:r,row:o,children:a}=e;const s=qr(Nu.Cell,(null===r||void 0===r?void 0:r.xs)&&Nu["Cell-".concat(r.xs,"-column-xs")],(null===r||void 0===r?void 0:r.sm)&&Nu["Cell-".concat(r.sm,"-column-sm")],(null===r||void 0===r?void 0:r.md)&&Nu["Cell-".concat(r.md,"-column-md")],(null===r||void 0===r?void 0:r.lg)&&Nu["Cell-".concat(r.lg,"-column-lg")],(null===r||void 0===r?void 0:r.xl)&&Nu["Cell-".concat(r.xl,"-column-xl")]),c={gridArea:t,"--pc-column-xs":null===n||void 0===n?void 0:n.xs,"--pc-column-sm":null===n||void 0===n?void 0:n.sm,"--pc-column-md":null===n||void 0===n?void 0:n.md,"--pc-column-lg":null===n||void 0===n?void 0:n.lg,"--pc-column-xl":null===n||void 0===n?void 0:n.xl,"--pc-row-xs":null===o||void 0===o?void 0:o.xs,"--pc-row-sm":null===o||void 0===o?void 0:o.sm,"--pc-row-md":null===o||void 0===o?void 0:o.md,"--pc-row-lg":null===o||void 0===o?void 0:o.lg,"--pc-row-xl":null===o||void 0===o?void 0:o.xl};return i.createElement("div",{className:s,style:c},a)};var ku="Polaris-LegacyCard",Du="Polaris-LegacyCard__Section",xu="Polaris-LegacyCard--subdued",Lu="Polaris-LegacyCard__Section--hideOnPrint",Mu="Polaris-LegacyCard--hideOnPrint",Uu="Polaris-LegacyCard__Header",Fu="Polaris-LegacyCard__Section--fullWidth",ju="Polaris-LegacyCard__Section--flush",Vu="Polaris-LegacyCard__Section--subdued",Bu="Polaris-LegacyCard__SectionHeader",Wu="Polaris-LegacyCard__Subsection",Hu="Polaris-LegacyCard__Footer",Gu="Polaris-LegacyCard__LeftJustified",zu="Polaris-LegacyCard__FirstSectionPadding",Ku="Polaris-LegacyCard__LastSectionPadding";function Yu(e){let{children:t,title:n,actions:r}=e;const o=r?i.createElement(iu,null,bc(r,{variant:"plain"})):null,a=(0,i.isValidElement)(n)?n:i.createElement(Qi,{variant:"headingSm",as:"h2"},n),s=o||t?i.createElement(Bs,{wrap:!1,gap:"200",align:"space-between",blockAlign:"center"},a,i.createElement(Bs,{wrap:!1,gap:"400",blockAlign:"center"},o,t)):a;return i.createElement("div",{className:Uu},s)}function qu(e){let{children:t,title:n,subdued:r,flush:o,fullWidth:a,actions:s,hideOnPrint:c}=e;const l=qr(Du,o&&ju,r&&Vu,a&&Fu,c&&Lu),d=s?i.createElement(iu,null,bc(s,{variant:"plain"})):null,u="string"===typeof n?i.createElement(Qi,{variant:"headingSm",as:"h3",fontWeight:"medium"},n):n,h=u||d?i.createElement("div",{className:Bu},d?i.createElement(is,{alignment:"baseline"},i.createElement(is.Item,{fill:!0},u),d):u):null;return i.createElement("div",{className:l},h,t)}const Xu=function(e){let{children:t,hideOnPrint:n,title:r,subdued:o,sectioned:a,actions:s,primaryFooterAction:c,secondaryFooterActions:l,secondaryFooterActionsDisclosureText:d,footerActionAlignment:u="right"}=e;const h=ji(),{value:p,toggle:m}=ti(!1),f=function(){const e=(0,i.useRef)(null);return(0,i.useEffect)(()=>{const t=e.current;let n,r;if(t){const e=()=>{var e,i;Ju(n,"top",!1),Ju(r,"bottom",!1);const o=t.querySelectorAll(".".concat(Du,", .").concat(Uu,", .").concat(Hu));if(null===o||void 0===o||!o.length)return;const a=o[0],s=function(e){let t=e[0];return e.forEach(e=>{t.contains(e)||(t=e)}),t}(o);null!==(e=t.firstChild)&&void 0!==e&&e.contains(a)&&(n=a,Ju(n,"top",!0)),null!==(i=t.lastChild)&&void 0!==i&&i.contains(s)&&(r=s,Ju(r,"bottom",!0))};e();const i=new MutationObserver(e);return i.observe(t,{childList:!0,subtree:!0}),()=>{Ju(n,"top",!1),Ju(r,"bottom",!1),i.disconnect()}}},[]),e}(),g=qr(ku,o&&xu,n&&Mu),_=r||s?i.createElement(Yu,{actions:s,title:r}):null,v=a?i.createElement(qu,null,t):t,b=c?Ec(c,{variant:"primary"}):null;let E=null;l&&l.length&&(E=1===l.length?Ec(l[0]):i.createElement(i.Fragment,null,i.createElement(ts,{active:p,activator:i.createElement(fs,{disclosure:!0,onClick:m},d||h.translate("Polaris.Common.more")),onClose:m},i.createElement(Lc,{items:l}))));const y=b||E?i.createElement("div",{className:qr(Hu,"left"===u&&Gu)},"right"===u?i.createElement(iu,null,E,b):i.createElement(iu,null,b,E)):null;return i.createElement(cl.Provider,{value:!0},i.createElement("div",{className:g,ref:f},_,v,y))};function Ju(e,t,n){if(e&&!e.className.includes(ju))switch(t){case"top":return void e.classList.toggle(zu,n);case"bottom":e.classList.toggle(Ku,n)}}Xu.Header=Yu,Xu.Section=qu,Xu.Subsection=function(e){let{children:t}=e;return i.createElement("div",{className:Wu},t)};var Zu=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M12.72 13.78a.75.75 0 1 0 1.06-1.06l-2.72-2.72 2.72-2.72a.75.75 0 0 0-1.06-1.06l-2.72 2.72-2.72-2.72a.75.75 0 0 0-1.06 1.06l2.72 2.72-2.72 2.72a.75.75 0 1 0 1.06 1.06l2.72-2.72 2.72 2.72Z"}))};Zu.displayName="XSmallIcon";var Qu="Polaris-CalloutCard",$u="Polaris-CalloutCard__Image",eh="Polaris-CalloutCard__DismissImage",th="Polaris-CalloutCard__Content",nh="Polaris-CalloutCard__Title",rh="Polaris-CalloutCard__Buttons",ih="Polaris-CalloutCard__Container",oh="Polaris-CalloutCard__Dismiss",ah="Polaris-CalloutCard--hasDismiss";function sh(e){var t;let{title:n,children:r,illustration:o,primaryAction:a,secondaryAction:s,onDismiss:c}=e;const l=Ec(a),d=s?Ec(s,{variant:null!==(t=s.variant)&&void 0!==t?t:"tertiary"}):null,u=d?i.createElement(iu,null,l,d):l,h=c?i.createElement("div",{className:oh},i.createElement(fs,{variant:"plain",icon:Zu,onClick:c,accessibilityLabel:"Dismiss card"})):null,p=qr($u,c&&eh),m=qr(ih,c&&ah);return i.createElement(Xu,null,i.createElement("div",{className:m},h,i.createElement(Xu.Section,null,i.createElement("div",{className:Qu},i.createElement("div",{className:th},i.createElement("div",{className:nh},i.createElement(Qi,{variant:"headingSm",as:"h2"},n)),i.createElement(Qi,{as:"span",variant:"bodyMd"},i.createElement(qs,null,r)),i.createElement("div",{className:rh},u)),i.createElement(jc,{alt:"",className:p,source:o})))))}var ch=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M11.75 3.5a.75.75 0 0 0 0 1.5h2.19l-4.97 4.97a.75.75 0 1 0 1.06 1.06l4.97-4.97v2.19a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-.75-.75h-4Z"}),i.createElement("path",{d:"M15 10.967a.75.75 0 0 0-1.5 0v2.783c0 .69-.56 1.25-1.25 1.25h-6c-.69 0-1.25-.56-1.25-1.25v-6c0-.69.56-1.25 1.25-1.25h2.783a.75.75 0 0 0 0-1.5h-2.783a2.75 2.75 0 0 0-2.75 2.75v6a2.75 2.75 0 0 0 2.75 2.75h6a2.75 2.75 0 0 0 2.75-2.75v-2.783Z"}))};ch.displayName="ExternalIcon";var lh=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10.029 3.033a.75.75 0 0 1 .5.935l-.703 2.313a.75.75 0 0 1-1.436-.436l.703-2.313a.75.75 0 0 1 .936-.5Z"}),i.createElement("path",{d:"M16 3.75a.75.75 0 0 0-1.5 0v.25h-.25a.75.75 0 0 0 0 1.5h.25v.25a.75.75 0 0 0 1.5 0v-.25h.25a.75.75 0 0 0 0-1.5h-.25v-.25Z"}),i.createElement("path",{fillRule:"evenodd",d:"M8.306 7.746a1.75 1.75 0 0 0-2.834.521l-2.093 4.669a2.75 2.75 0 0 0 .565 3.07l.051.05a2.75 2.75 0 0 0 3.07.565l4.668-2.093a1.75 1.75 0 0 0 .521-2.834l-3.948-3.948Zm-1.465 1.135a.25.25 0 0 1 .405-.074l3.948 3.947a.25.25 0 0 1-.075.405l-4.668 2.093a1.25 1.25 0 0 1-1.395-.257l-.051-.05a1.25 1.25 0 0 1-.257-1.396l2.093-4.668Z"}),i.createElement("path",{d:"M5.75 3a.75.75 0 0 1 .75.75v.25h.25a.75.75 0 1 1 0 1.5h-.25v.25a.75.75 0 0 1-1.5 0v-.25h-.25a.75.75 0 0 1 0-1.5h.25v-.25a.75.75 0 0 1 .75-.75Z"}),i.createElement("path",{d:"M16 13.25a.75.75 0 0 0-1.5 0v.25h-.25a.75.75 0 0 0 0 1.5h.25v.25a.75.75 0 0 0 1.5 0v-.25h.25a.75.75 0 0 0 0-1.5h-.25v-.25Z"}),i.createElement("path",{d:"M13.53 7.53a.75.75 0 0 0-1.06-1.06l-1 1a.75.75 0 0 0 1.06 1.06l1-1Z"}),i.createElement("path",{d:"M16.578 11.032a.75.75 0 1 0-.413-1.442l-2.343.672a.75.75 0 1 0 .413 1.442l2.343-.672Z"}))};lh.displayName="ConfettiIcon";class dh{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>e.finished))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e){const t=this.animations.map(t=>t.attachTimeline(e));return()=>{t.forEach((e,t)=>{e&&e(),this.animations[t].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){return uh(this.animations,"duration")}get iterationDuration(){return uh(this.animations,"iterationDuration")}runAll(e){this.animations.forEach(t=>t[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function uh(e,t){let n=0;for(let r=0;r<e.length;r++){const i=e[r][t];null!==i&&i>n&&(n=i)}return n}class hh extends dh{then(e,t){return this.finished.finally(e).then(()=>{})}}function ph(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const mh=(e,t,n)=>n>t?t:n<e?e:n,fh=e=>1e3*e,gh=e=>e/1e3,_h=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r="";const i=Math.max(Math.round(t/n),2);for(let o=0;o<i;o++)r+=Math.round(1e4*e(o/(i-1)))/1e4+", ";return"linear(".concat(r.substring(0,r.length-2),")")},vh=2e4;function bh(e){let t=0;let n=e.next(t);for(;!n.done&&t<vh;)t+=50,n=e.next(t);return t>=vh?1/0:t}function Eh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=(arguments.length>2?arguments[2]:void 0)((0,a.A)((0,a.A)({},e),{},{keyframes:[0,t]})),r=Math.min(bh(n),vh);return{type:"keyframes",ease:e=>n.next(r*e).value/t,duration:gh(r)}}function yh(e,t){return t?e*(1e3/t):0}function Sh(e,t,n){const r=Math.max(t-5,0);return yh(n-e(r),t-r)}const Th={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};let Ch=()=>{};const wh=.001;function Rh(e){let t,n,{duration:r=Th.duration,bounce:i=Th.bounce,velocity:o=Th.velocity,mass:a=Th.mass}=e;fh(Th.maxDuration);let s=1-i;s=mh(Th.minDamping,Th.maxDamping,s),r=mh(Th.minDuration,Th.maxDuration,gh(r)),s<1?(t=e=>{const t=e*s,n=t*r,i=t-o,a=Ih(e,s),c=Math.exp(-n);return wh-i/a*c},n=e=>{const n=e*s*r,i=n*o+o,a=Math.pow(s,2)*Math.pow(e,2)*r,c=Math.exp(-n),l=Ih(Math.pow(e,2),s);return(-t(e)+wh>0?-1:1)*((i-a)*c)/l}):(t=e=>Math.exp(-e*r)*((e-o)*r+1)-.001,n=e=>Math.exp(-e*r)*(r*r*(o-e)));const c=function(e,t,n){let r=n;for(let i=1;i<Ah;i++)r-=e(r)/t(r);return r}(t,n,5/r);if(r=fh(r),isNaN(c))return{stiffness:Th.stiffness,damping:Th.damping,duration:r};{const e=Math.pow(c,2)*a;return{stiffness:e,damping:2*s*Math.sqrt(a*e),duration:r}}}const Ah=12;function Ih(e,t){return e*Math.sqrt(1-t*t)}const Nh=["duration","bounce"],Oh=["stiffness","damping","mass"];function Ph(e,t){return t.some(t=>void 0!==e[t])}function kh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Th.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Th.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:i}=n;const o=n.keyframes[0],s=n.keyframes[n.keyframes.length-1],c={done:!1,value:o},{stiffness:l,damping:d,mass:u,duration:h,velocity:p,isResolvedFromDuration:m}=function(e){let t=(0,a.A)({velocity:Th.velocity,stiffness:Th.stiffness,damping:Th.damping,mass:Th.mass,isResolvedFromDuration:!1},e);if(!Ph(e,Oh)&&Ph(e,Nh))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),i=r*r,o=2*mh(.05,1,1-(e.bounce||0))*Math.sqrt(i);t=(0,a.A)((0,a.A)({},t),{},{mass:Th.mass,stiffness:i,damping:o})}else{const n=Rh(e);t=(0,a.A)((0,a.A)((0,a.A)({},t),n),{},{mass:Th.mass}),t.isResolvedFromDuration=!0}return t}((0,a.A)((0,a.A)({},n),{},{velocity:-gh(n.velocity||0)})),f=p||0,g=d/(2*Math.sqrt(l*u)),_=s-o,v=gh(Math.sqrt(l/u)),b=Math.abs(_)<5;let E;if(r||(r=b?Th.restSpeed.granular:Th.restSpeed.default),i||(i=b?Th.restDelta.granular:Th.restDelta.default),g<1){const e=Ih(v,g);E=t=>{const n=Math.exp(-g*v*t);return s-n*((f+g*v*_)/e*Math.sin(e*t)+_*Math.cos(e*t))}}else if(1===g)E=e=>s-Math.exp(-v*e)*(_+(f+v*_)*e);else{const e=v*Math.sqrt(g*g-1);E=t=>{const n=Math.exp(-g*v*t),r=Math.min(e*t,300);return s-n*((f+g*v*_)*Math.sinh(r)+e*_*Math.cosh(r))/e}}const y={calculatedDuration:m&&h||null,next:e=>{const t=E(e);if(m)c.done=e>=h;else{let n=0===e?f:0;g<1&&(n=0===e?fh(f):Sh(E,e,t));const o=Math.abs(n)<=r,a=Math.abs(s-t)<=i;c.done=o&&a}return c.value=c.done?s:t,c},toString:()=>{const e=Math.min(bh(y),vh),t=_h(t=>y.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return y}kh.applyToOptions=e=>{const t=Eh(e,100,kh);return e.ease=t.ease,e.duration=fh(t.duration),e.type="keyframes",e};const Dh=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r},xh=(e,t,n)=>e+(t-e)*n;function Lh(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=Dh(0,t,r);e.push(xh(n,1,i))}}function Mh(e){const t=[0];return Lh(t,e.length-1),t}function Uh(e){return"function"===typeof e&&"applyToOptions"in e}const Fh=e=>Boolean(e&&e.getVelocity),jh=e=>Array.isArray(e)&&"number"!==typeof e[0];function Vh(e,t){return jh(e)?e[((e,t,n)=>{const r=t-e;return((n-e)%r+r)%r+e})(0,e.length,t)]:e}function Bh(e){return"object"===typeof e&&!Array.isArray(e)}function Wh(e,t,n,r){return"string"===typeof e&&Bh(t)?function(e,t,n){if(e instanceof EventTarget)return[e];if("string"===typeof e){var r;let i=document;t&&(i=t.current);const o=null!==(r=null===n||void 0===n?void 0:n[e])&&void 0!==r?r:i.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}(e,n,r):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e]}function Hh(e,t,n){return e*(t+1)}function Gh(e,t,n,r){return"number"===typeof t?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):"<"===t?n:t.startsWith("<")?Math.max(0,n+parseFloat(t.slice(1))):null!==(i=r.get(t))&&void 0!==i?i:e;var i}function zh(e,t,n,r,i,o){!function(e,t,n){for(let r=0;r<e.length;r++){const i=e[r];i.at>t&&i.at<n&&(ph(e,i),r--)}}(e,i,o);for(let a=0;a<t.length;a++)e.push({value:t[a],at:xh(i,o,r[a]),easing:Vh(n,a)})}function Kh(e,t){for(let n=0;n<e.length;n++)e[n]=e[n]/(t+1)}function Yh(e,t){return e.at===t.at?null===e.value?1:null===t.value?-1:0:e.at-t.at}const qh=["defaultTransition"],Xh=["delay","times","type","repeat","repeatType","repeatDelay"];function Jh(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function Zh(e,t){return t[e]||(t[e]=[]),t[e]}function Qh(e){return Array.isArray(e)?e:[e]}function $h(e,t){return e&&e[t]?(0,a.A)((0,a.A)({},e),e[t]):(0,a.A)({},e)}const ep=e=>"number"===typeof e,tp=e=>e.every(ep),np=new WeakMap;function rp(e,t){var n,r;return null!==(n=null!==(r=null===e||void 0===e?void 0:e[t])&&void 0!==r?r:null===e||void 0===e?void 0:e.default)&&void 0!==n?n:e}const ip=e=>e,op={},ap=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],sp={value:null,addProjectionMetrics:null};function cp(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,a=ap.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,r=new Set,i=!1,o=!1;const a=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},c=0;function l(t){a.has(t)&&(d.schedule(t),e()),c++,t(s)}const d={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&i?n:r;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&a.add(e),t.has(e)||t.add(e),e},cancel:e=>{r.delete(e),a.delete(e)},process:e=>{s=e,i?o=!0:(i=!0,[n,r]=[r,n],n.forEach(l),t&&sp.value&&sp.value.frameloop[t].push(c),c=0,n.clear(),i=!1,o&&(o=!1,d.process(e)))}};return d}(o,t?n:void 0),e),{}),{setup:s,read:c,resolveKeyframes:l,preUpdate:d,update:u,preRender:h,render:p,postRender:m}=a,f=()=>{const o=op.useManualTiming?i.timestamp:performance.now();n=!1,op.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(o-i.timestamp,40),1)),i.timestamp=o,i.isProcessing=!0,s.process(i),c.process(i),l.process(i),d.process(i),u.process(i),h.process(i),p.process(i),m.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(f))},g=ap.reduce((t,o)=>{const s=a[o];return t[o]=function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,i.isProcessing||e(f)),s.schedule(t,o,a)},t},{});return{schedule:g,cancel:e=>{for(let t=0;t<ap.length;t++)a[ap[t]].cancel(e)},state:i,steps:a}}const{schedule:lp,cancel:dp,state:up,steps:hp}=cp("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:ip,!0),pp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],mp=(()=>new Set(pp))(),fp=new Set(["width","height","top","left","right","bottom",...pp]);class gp{constructor(){this.subscriptions=[]}add(e){var t,n;return t=this.subscriptions,n=e,-1===t.indexOf(n)&&t.push(n),()=>ph(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let i=0;i<r;i++){const r=this.subscriptions[i];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}let _p;function vp(){_p=void 0}const bp={now:()=>(void 0===_p&&bp.set(up.isProcessing||op.useManualTiming?up.timestamp:performance.now()),_p),set:e=>{_p=e,queueMicrotask(vp)}},Ep={current:void 0};class yp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=bp.now();var n;if((this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev)&&(null===(n=this.events.change)||void 0===n||n.notify(this.current),this.dependents))for(const r of this.dependents)r.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=bp.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(e=>!isNaN(parseFloat(e)))(this.current))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new gp);const n=this.events[e].add(t);return"change"===e?()=>{n(),lp.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null===(e=this.events.change)||void 0===e||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return Ep.current&&Ep.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=bp.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return yh(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null===(e=this.dependents)||void 0===e||e.clear(),null===(t=this.events.destroy)||void 0===t||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Sp(e,t){return new yp(e,t)}function Tp(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function Cp(e,t,n,r){if("function"===typeof t){const[i,o]=Tp(r);t=t(void 0!==n?n:e.custom,i,o)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[i,o]=Tp(r);t=t(void 0!==n?n:e.custom,i,o)}return t}const wp=["transitionEnd","transition"];function Rp(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Sp(n))}function Ap(e){return(e=>Array.isArray(e))(e)?e[e.length-1]||0:e}function Ip(e,t){const n=function(e,t,n){const r=e.getProps();return Cp(r,t,void 0!==n?n:r.custom,e)}(e,t);let r=n||{},{transitionEnd:i={},transition:s={}}=r,c=(0,o.A)(r,wp);c=(0,a.A)((0,a.A)({},c),i);for(const o in c){Rp(e,o,Ap(c[o]))}}function Np(e,t){const n=e.getValue("willChange");if(function(e){return Boolean(Fh(e)&&e.add)}(n))return n.add(t);if(!n&&op.WillChange){const n=new op.WillChange("auto");e.addValue("willChange",n),n.add(t)}}const Op=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Pp="data-"+Op("framerAppearId");function kp(e){return e.props[Pp]}function Dp(e){e.duration=0,e.type="keyframes"}const xp=(e,t)=>n=>t(e(n)),Lp=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(xp)},Mp={layout:0,mainThread:0,waapi:0},Up=e=>t=>"string"===typeof t&&t.startsWith(e),Fp=Up("--"),jp=Up("var(--"),Vp=e=>!!jp(e)&&Bp.test(e.split("/*")[0].trim()),Bp=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i,Wp={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},Hp=(0,a.A)((0,a.A)({},Wp),{},{transform:e=>mh(0,1,e)}),Gp=(0,a.A)((0,a.A)({},Wp),{},{default:1}),zp=e=>Math.round(1e5*e)/1e5,Kp=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const Yp=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,qp=(e,t)=>n=>Boolean("string"===typeof n&&Yp.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),Xp=(e,t,n)=>r=>{if("string"!==typeof r)return r;const[i,o,a,s]=r.match(Kp);return{[e]:parseFloat(i),[t]:parseFloat(o),[n]:parseFloat(a),alpha:void 0!==s?parseFloat(s):1}},Jp=(0,a.A)((0,a.A)({},Wp),{},{transform:e=>Math.round((e=>mh(0,255,e))(e))}),Zp={test:qp("rgb","red"),parse:Xp("red","green","blue"),transform:e=>{let{red:t,green:n,blue:r,alpha:i=1}=e;return"rgba("+Jp.transform(t)+", "+Jp.transform(n)+", "+Jp.transform(r)+", "+zp(Hp.transform(i))+")"}};const Qp={test:qp("#"),parse:function(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}},transform:Zp.transform},$p=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),em=$p("deg"),tm=$p("%"),nm=$p("px"),rm=$p("vh"),im=$p("vw"),om=(()=>(0,a.A)((0,a.A)({},tm),{},{parse:e=>tm.parse(e)/100,transform:e=>tm.transform(100*e)}))(),am={test:qp("hsl","hue"),parse:Xp("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:r,alpha:i=1}=e;return"hsla("+Math.round(t)+", "+tm.transform(zp(n))+", "+tm.transform(zp(r))+", "+zp(Hp.transform(i))+")"}},sm={test:e=>Zp.test(e)||Qp.test(e)||am.test(e),parse:e=>Zp.test(e)?Zp.parse(e):am.test(e)?am.parse(e):Qp.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?Zp.transform(e):am.transform(e),getAnimatableNone:e=>{const t=sm.parse(e);return t.alpha=0,sm.transform(t)}},cm=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const lm="number",dm="color",um=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function hm(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[];let o=0;const a=t.replace(um,e=>(sm.test(e)?(r.color.push(o),i.push(dm),n.push(sm.parse(e))):e.startsWith("var(")?(r.var.push(o),i.push("var"),n.push(e)):(r.number.push(o),i.push(lm),n.push(parseFloat(e))),++o,"${}")).split("${}");return{values:n,split:a,indexes:r,types:i}}function pm(e){return hm(e).values}function mm(e){const{split:t,types:n}=hm(e),r=t.length;return e=>{let i="";for(let o=0;o<r;o++)if(i+=t[o],void 0!==e[o]){const t=n[o];i+=t===lm?zp(e[o]):t===dm?sm.transform(e[o]):e[o]}return i}}const fm=e=>"number"===typeof e?0:sm.test(e)?sm.getAnimatableNone(e):e;const gm={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(Kp))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(cm))||void 0===n?void 0:n.length)||0)>0},parse:pm,createTransformer:mm,getAnimatableNone:function(e){const t=pm(e);return mm(e)(t.map(fm))}};function _m(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function vm(e,t){return n=>n>0?t:e}const bm=(e,t,n)=>{const r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},Em=[Qp,Zp,am];function ym(e){const t=(n=e,Em.find(e=>e.test(n)));var n;if(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),!Boolean(t))return!1;let r=t.parse(e);return t===am&&(r=function(e){let{hue:t,saturation:n,lightness:r,alpha:i}=e;t/=360,n/=100,r/=100;let o=0,a=0,s=0;if(n){const e=r<.5?r*(1+n):r+n-r*n,i=2*r-e;o=_m(i,e,t+1/3),a=_m(i,e,t),s=_m(i,e,t-1/3)}else o=a=s=r;return{red:Math.round(255*o),green:Math.round(255*a),blue:Math.round(255*s),alpha:i}}(r)),r}const Sm=(e,t)=>{const n=ym(e),r=ym(t);if(!n||!r)return vm(e,t);const i=(0,a.A)({},n);return e=>(i.red=bm(n.red,r.red,e),i.green=bm(n.green,r.green,e),i.blue=bm(n.blue,r.blue,e),i.alpha=xh(n.alpha,r.alpha,e),Zp.transform(i))},Tm=new Set(["none","hidden"]);function Cm(e,t){return n=>xh(e,t,n)}function wm(e){return"number"===typeof e?Cm:"string"===typeof e?Vp(e)?vm:sm.test(e)?Sm:Im:Array.isArray(e)?Rm:"object"===typeof e?sm.test(e)?Sm:Am:vm}function Rm(e,t){const n=[...e],r=n.length,i=e.map((e,n)=>wm(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=i[t](e);return n}}function Am(e,t){const n=(0,a.A)((0,a.A)({},e),t),r={};for(const i in n)void 0!==e[i]&&void 0!==t[i]&&(r[i]=wm(e[i])(e[i],t[i]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const Im=(e,t)=>{const n=gm.createTransformer(t),r=hm(e),i=hm(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Tm.has(e)&&!i.values.length||Tm.has(t)&&!r.values.length?function(e,t){return Tm.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):Lp(Rm(function(e,t){const n=[],r={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){var i;const a=t.types[o],s=e.indexes[a][r[a]],c=null!==(i=e.values[s])&&void 0!==i?i:0;n[o]=c,r[a]++}return n}(r,i),i.values),n):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),vm(e,t))};function Nm(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return xh(e,t,n);return wm(e)(e,t)}const Om=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return lp.update(t,e)},stop:()=>dp(t),now:()=>up.isProcessing?up.timestamp:bp.now()}};function Pm(e){let{keyframes:t,velocity:n=0,power:r=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:s,min:c,max:l,restDelta:d=.5,restSpeed:u}=e;const h=t[0],p={done:!1,value:h},m=e=>void 0===c?l:void 0===l||Math.abs(c-e)<Math.abs(l-e)?c:l;let f=r*n;const g=h+f,_=void 0===s?g:s(g);_!==g&&(f=_-h);const v=e=>-f*Math.exp(-e/i),b=e=>_+v(e),E=e=>{const t=v(e),n=b(e);p.done=Math.abs(t)<=d,p.value=p.done?_:n};let y,S;const T=e=>{var t;(t=p.value,void 0!==c&&t<c||void 0!==l&&t>l)&&(y=e,S=kh({keyframes:[p.value,m(p.value)],velocity:Sh(b,e,p.value),damping:o,stiffness:a,restDelta:d,restSpeed:u}))};return T(0),{calculatedDuration:null,next:e=>{let t=!1;return S||void 0!==y||(t=!0,E(e),T(e)),void 0!==y&&e>=y?S.next(e-y):(!t&&E(e),p)}}}const km=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function Dm(e,t,n,r){if(e===t&&n===r)return ip;const i=t=>function(e,t,n,r,i){let o,a,s=0;do{a=t+(n-t)/2,o=km(a,r,i)-e,o>0?n=a:t=a}while(Math.abs(o)>1e-7&&++s<12);return a}(t,0,1,e,n);return e=>0===e||1===e?e:km(i(e),t,r)}const xm=Dm(.42,0,1,1),Lm=Dm(0,0,.58,1),Mm=Dm(.42,0,.58,1),Um=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Fm=e=>t=>1-e(1-t),jm=Dm(.33,1.53,.69,.99),Vm=Fm(jm),Bm=Um(Vm),Wm=e=>(e*=2)<1?.5*Vm(e):.5*(2-Math.pow(2,-10*(e-1))),Hm=e=>1-Math.sin(Math.acos(e)),Gm=Fm(Hm),zm=Um(Hm),Km=e=>Array.isArray(e)&&"number"===typeof e[0],Ym={linear:ip,easeIn:xm,easeInOut:Mm,easeOut:Lm,circIn:Hm,circInOut:zm,circOut:Gm,backIn:Vm,backInOut:Bm,backOut:jm,anticipate:Wm},qm=e=>{if(Km(e)){e.length;const[t,n,r,i]=e;return Dm(t,n,r,i)}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),Ym[e]):e};function Xm(e,t){let{clamp:n=!0,ease:r,mixer:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=e.length;if(t.length,1===o)return()=>t[0];if(2===o&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=function(e,t,n){const r=[],i=n||op.mix||Nm,o=e.length-1;for(let a=0;a<o;a++){let n=i(e[a],e[a+1]);if(t){const e=Array.isArray(t)?t[a]||ip:t;n=Lp(e,n)}r.push(n)}return r}(t,r,i),c=s.length,l=n=>{if(a&&n<e[0])return t[0];let r=0;if(c>1)for(;r<e.length-2&&!(n<e[r+1]);r++);const i=Dh(e[r],e[r+1],n);return s[r](i)};return n?t=>l(mh(e[0],e[o-1],t)):l}function Jm(e,t){return e.map(()=>t||Mm).splice(0,e.length-1)}function Zm(e){let{duration:t=300,keyframes:n,times:r,ease:i="easeInOut"}=e;const o=jh(i)?i.map(qm):qm(i),a={done:!1,value:n[0]},s=function(e,t){return e.map(e=>e*t)}(r&&r.length===n.length?r:Mh(n),t),c=Xm(s,n,{ease:Array.isArray(o)?o:Jm(n,o)});return{calculatedDuration:t,next:e=>(a.value=c(e),a.done=e>=t,a)}}const Qm=e=>null!==e;function $m(e,t,n){let{repeat:r,repeatType:i="loop"}=t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const a=e.filter(Qm),s=o<0||r&&"loop"!==i&&r%2===1?0:a.length-1;return s&&void 0!==n?n:a[s]}const ef={decay:Pm,inertia:Pm,tween:Zm,keyframes:Zm,spring:kh};function tf(e){"string"===typeof e.type&&(e.type=ef[e.type])}class nf{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const rf=e=>e/100;class of extends nf{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:n}=this.options;n&&n.updatedAt!==bp.now()&&this.tick(bp.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null===(e=(t=this.options).onStop)||void 0===e||e.call(t))},Mp.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;tf(e);const{type:t=Zm,repeat:n=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=e;let{keyframes:s}=e;const c=t||Zm;c!==Zm&&"number"!==typeof s[0]&&(this.mixKeyframes=Lp(rf,Nm(s[0],s[1])),s=[0,100]);const l=c((0,a.A)((0,a.A)({},e),{},{keyframes:s}));"mirror"===i&&(this.mirroredGenerator=c((0,a.A)((0,a.A)({},e),{},{keyframes:[...s].reverse(),velocity:-o}))),null===l.calculatedDuration&&(l.calculatedDuration=bh(l));const{calculatedDuration:d}=l;this.calculatedDuration=d,this.resolvedDuration=d+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=l}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{generator:n,totalDuration:r,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:s}=this;if(null===this.startTime)return n.next(0);const{delay:c=0,keyframes:l,repeat:d,repeatType:u,repeatDelay:h,type:p,onUpdate:m,finalKeyframe:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const g=this.currentTime-c*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?g<0:g>r;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let v=this.currentTime,b=n;if(d){const e=Math.min(this.currentTime,r)/a;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(n=1-n,h&&(n-=h/a)):"mirror"===u&&(b=o)),v=mh(0,1,n)*a}const E=_?{done:!1,value:l[0]}:b.next(v);i&&(E.value=i(E.value));let{done:y}=E;_||null===s||(y=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const S=null===this.holdTime&&("finished"===this.state||"running"===this.state&&y);return S&&p!==Pm&&(E.value=$m(l,this.options,f,this.speed)),m&&m(E.value),S&&this.finish(),E}then(e,t){return this.finished.then(e,t)}get duration(){return gh(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+gh(e)}get time(){return gh(this.currentTime)}set time(e){var t;e=fh(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null===(t=this.driver)||void 0===t||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(bp.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=gh(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:n=Om,startTime:r}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null===(e=(t=this.options).onPlay)||void 0===e||e.call(t);const i=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=i):null!==this.holdTime?this.startTime=i-this.holdTime:this.startTime||(this.startTime=null!==r&&void 0!==r?r:i),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(bp.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null===(e=(t=this.options).onComplete)||void 0===e||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null===(e=(t=this.options).onCancel)||void 0===e||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,Mp.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null===(t=this.driver)||void 0===t||t.stop(),e.observe(this)}}const af=e=>180*e/Math.PI,sf=e=>{const t=af(Math.atan2(e[1],e[0]));return lf(t)},cf={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:sf,rotateZ:sf,skewX:e=>af(Math.atan(e[1])),skewY:e=>af(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},lf=e=>((e%=360)<0&&(e+=360),e),df=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),uf=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),hf={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:df,scaleY:uf,scale:e=>(df(e)+uf(e))/2,rotateX:e=>lf(af(Math.atan2(e[6],e[5]))),rotateY:e=>lf(af(Math.atan2(-e[2],e[0]))),rotateZ:sf,rotate:sf,skewX:e=>af(Math.atan(e[4])),skewY:e=>af(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function pf(e){return e.includes("scale")?1:0}function mf(e,t){if(!e||"none"===e)return pf(t);const n=e.match(/^matrix3d\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);let r,i;if(n)r=hf,i=n;else{const t=e.match(/^matrix\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);r=cf,i=t}if(!i)return pf(t);const o=r[t],a=i[1].split(",").map(ff);return"function"===typeof o?o(a):a[o]}function ff(e){return parseFloat(e.trim())}const gf=e=>e===Wp||e===nm,_f=new Set(["x","y","z"]),vf=pp.filter(e=>!_f.has(e));const bf={width:(e,t)=>{let{x:n}=e,{paddingLeft:r="0",paddingRight:i="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(i)},height:(e,t)=>{let{y:n}=e,{paddingTop:r="0",paddingBottom:i="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(i)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:r}=t;return parseFloat(r)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:r}=t;return parseFloat(r)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return mf(n,"x")},y:(e,t)=>{let{transform:n}=t;return mf(n,"y")}};bf.translateX=bf.x,bf.translateY=bf.y;const Ef=new Set;let yf=!1,Sf=!1,Tf=!1;function Cf(){if(Sf){const e=Array.from(Ef).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return vf.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(t=>{var n;let[r,i]=t;null===(n=e.getValue(r))||void 0===n||n.set(i)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}Sf=!1,yf=!1,Ef.forEach(e=>e.complete(Tf)),Ef.clear()}function wf(){Ef.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Sf=!0)})}class Rf{constructor(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Ef.add(this),yf||(yf=!0,lp.read(wf),lp.resolveKeyframes(Cf))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(null===e[0]){const i=null===r||void 0===r?void 0:r.get(),o=e[e.length-1];if(void 0!==i)e[0]=i;else if(n&&t){const r=n.readValue(t,o);void 0!==r&&null!==r&&(e[0]=r)}void 0===e[0]&&(e[0]=o),r&&void 0===i&&r.set(e[0])}!function(e){for(let n=1;n<e.length;n++){var t;null!==(t=e[n])&&void 0!==t||(e[n]=e[n-1])}}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Ef.delete(this)}cancel(){"scheduled"===this.state&&(Ef.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}function Af(e){let t;return()=>(void 0===t&&(t=e()),t)}const If=Af(()=>void 0!==window.ScrollTimeline),Nf={};function Of(e,t){const n=Af(e);return()=>{var e;return null!==(e=Nf[t])&&void 0!==e?e:n()}}const Pf=Of(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch($D){return!1}return!0},"linearEasing"),kf=e=>{let[t,n,r,i]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(r,", ").concat(i,")")},Df={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:kf([0,.65,.55,1]),circOut:kf([.55,0,1,.45]),backIn:kf([.31,.01,.66,-.59]),backOut:kf([.33,1.53,.69,.99])};function xf(e,t){return e?"function"===typeof e?Pf()?_h(e,t):"ease-out":Km(e)?kf(e):Array.isArray(e)?e.map(e=>xf(e,t)||Df.easeOut):Df[e]:void 0}function Lf(e,t,n){let{delay:r=0,duration:i=300,repeat:o=0,repeatType:a="loop",ease:s="easeOut",times:c}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const d={[t]:n};c&&(d.offset=c);const u=xf(s,i);Array.isArray(u)&&(d.easing=u),sp.value&&Mp.waapi++;const h={delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:"reverse"===a?"alternate":"normal"};l&&(h.pseudoElement=l);const p=e.animate(d,h);return sp.value&&p.finished.finally(()=>{Mp.waapi--}),p}const Mf=["type"];class Uf extends nf{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:s,onComplete:c}=e;this.isPseudoElement=Boolean(i),this.allowFlatten=a,this.options=e,e.type;const l=function(e){let{type:t}=e,n=(0,o.A)(e,Mf);return Uh(t)&&Pf()?t.applyToOptions(n):(null!==(r=n.duration)&&void 0!==r||(n.duration=300),null!==(i=n.ease)&&void 0!==i||(n.ease="easeOut"),n);var r,i}(e);this.animation=Lf(t,n,r,l,i),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const e=$m(r,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null===c||void 0===c||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null===(e=(t=this.animation).finish)||void 0===e||e.call(t)}cancel(){try{this.animation.cancel()}catch($D){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(null===(e=(t=this.animation).commitStyles)||void 0===e||e.call(t))}get duration(){var e,t;const n=(null===(e=this.animation.effect)||void 0===e||null===(t=e.getComputedTiming)||void 0===t?void 0:t.call(e).duration)||0;return gh(Number(n))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+gh(e)}get time(){return gh(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=fh(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:n}=e;var r;this.allowFlatten&&(null===(r=this.animation.effect)||void 0===r||r.updateTiming({easing:"linear"}));return this.animation.onfinish=null,t&&If()?(this.animation.timeline=t,ip):n(this)}}const Ff={anticipate:Wm,backInOut:Bm,circInOut:zm};function jf(e){"string"===typeof e.ease&&e.ease in Ff&&(e.ease=Ff[e.ease])}const Vf=["motionValue","onUpdate","onComplete","element"];class Bf extends Uf{constructor(e){jf(e),tf(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const n=this.options,{motionValue:r,onUpdate:i,onComplete:s,element:c}=n,l=(0,o.A)(n,Vf);if(!r)return;if(void 0!==e)return void r.set(e);const d=new of((0,a.A)((0,a.A)({},l),{},{autoplay:!1})),u=fh(null!==(t=this.finishedTime)&&void 0!==t?t:this.time);r.setWithVelocity(d.sample(u-10).value,d.sample(u).value,10),d.stop()}}const Wf=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!gm.test(e)&&"0"!==e||e.startsWith("url(")));const Hf=new Set(["opacity","clipPath","filter","transform"]),Gf=Af(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const zf=["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"];class Kf extends nf{constructor(e){var t;let{autoplay:n=!0,delay:r=0,type:i="keyframes",repeat:s=0,repeatDelay:c=0,repeatType:l="loop",keyframes:d,name:u,motionValue:h,element:p}=e,m=(0,o.A)(e,zf);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null===(t=this.stopTimeline)||void 0===t||t.call(this));null===(e=this.keyframeResolver)||void 0===e||e.cancel()},this.createdAt=bp.now();const f=(0,a.A)({autoplay:n,delay:r,type:i,repeat:s,repeatDelay:c,repeatType:l,name:u,motionValue:h,element:p},m),g=(null===p||void 0===p?void 0:p.KeyframeResolver)||Rf;this.keyframeResolver=new g(d,(e,t,n)=>this.onKeyframesResolved(e,t,f,!n),u,h,p),null===(t=this.keyframeResolver)||void 0===t||t.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:i,type:o,velocity:s,delay:c,isHandoff:l,onUpdate:d}=n;this.resolvedAt=bp.now(),function(e,t,n,r){const i=e[0];if(null===i)return!1;if("display"===t||"visibility"===t)return!0;const o=e[e.length-1],a=Wf(i,t),s=Wf(o,t);return"You are trying to animate ".concat(t,' from "').concat(i,'" to "').concat(o,'". "').concat(a?o:i,'" is not an animatable value.'),!(!a||!s)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||Uh(n))&&r)}(e,i,o,s)||(!op.instantAnimations&&c||null===d||void 0===d||d($m(e,n,t)),e[0]=e[e.length-1],Dp(n),n.repeat=0);const u=r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,h=(0,a.A)((0,a.A)({startTime:u,finalKeyframe:t},n),{},{keyframes:e}),p=!l&&function(e){var t;const{motionValue:n,name:r,repeatDelay:i,repeatType:o,damping:a,type:s}=e;if(!((null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:l}=n.owner.getProps();return Gf()&&r&&Hf.has(r)&&("transform"!==r||!l)&&!c&&!i&&"mirror"!==o&&0!==a&&"inertia"!==s}(h)?new Bf((0,a.A)((0,a.A)({},h),{},{element:h.motionValue.owner.current})):new of(h);p.finished.then(()=>this.notifyFinished()).catch(ip),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;this._animation||(null===(e=this.keyframeResolver)||void 0===e||e.resume(),Tf=!0,wf(),Cf(),Tf=!1);return this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null===(e=this.keyframeResolver)||void 0===e||e.cancel()}}const Yf=e=>null!==e;const qf={type:"spring",stiffness:500,damping:25,restSpeed:10},Xf={type:"keyframes",duration:.8},Jf={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Zf=(e,t)=>{let{keyframes:n}=t;return n.length>2?Xf:mp.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:qf:Jf},Qf=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const $f=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return c=>{const l=rp(r,e)||{},d=l.delay||r.delay||0;let{elapsed:u=0}=r;u-=fh(d);const h=(0,a.A)((0,a.A)({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},l),{},{delay:-u,onUpdate:e=>{t.set(e),l.onUpdate&&l.onUpdate(e)},onComplete:()=>{c(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:s?void 0:i});(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:i,staggerDirection:a,repeat:s,repeatType:c,repeatDelay:l,from:d,elapsed:u}=e,h=(0,o.A)(e,Qf);return!!Object.keys(h).length})(l)||Object.assign(h,Zf(e,h)),h.duration&&(h.duration=fh(h.duration)),h.repeatDelay&&(h.repeatDelay=fh(h.repeatDelay)),void 0!==h.from&&(h.keyframes[0]=h.from);let p=!1;if((!1===h.type||0===h.duration&&!h.repeatDelay)&&(Dp(h),0===h.delay&&(p=!0)),(op.instantAnimations||op.skipAnimations)&&(p=!0,Dp(h),h.delay=0),h.allowFlatten=!l.type&&!l.ease,p&&!s&&void 0!==t.get()){const e=function(e,t,n){let{repeat:r,repeatType:i="loop"}=t;const o=e.filter(Yf),a=r&&"loop"!==i&&r%2===1?0:o.length-1;return a&&void 0!==n?n:o[a]}(h.keyframes,l);if(void 0!==e)return void lp.update(()=>{h.onUpdate(e),h.onComplete()})}return l.isSync?new of(h):new Kf(h)}},eg=["transition","transitionEnd"];function tg(e,t){let{protectedKeys:n,needsAnimating:r}=e;const i=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,i}function ng(e,t){let{delay:n=0,transitionOverride:r,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:s=e.getDefaultTransition(),transitionEnd:c}=t,l=(0,o.A)(t,eg);r&&(s=r);const d=[],u=i&&e.animationState&&e.animationState.getState()[i];for(const o in l){var h;const t=e.getValue(o,null!==(h=e.latestValues[o])&&void 0!==h?h:null),r=l[o];if(void 0===r||u&&tg(u,o))continue;const i=(0,a.A)({delay:n},rp(s||{},o)),c=t.get();if(void 0!==c&&!t.isAnimating&&!Array.isArray(r)&&r===c&&!i.velocity)continue;let p=!1;if(window.MotionHandoffAnimation){const t=kp(e);if(t){const e=window.MotionHandoffAnimation(t,o,lp);null!==e&&(i.startTime=e,p=!0)}}Np(e,o),t.start($f(o,t,r,e.shouldReduceMotion&&fp.has(o)?{type:!1}:i,e,p));const m=t.animation;m&&d.push(m)}return c&&Promise.all(d).then(()=>{lp.update(()=>{c&&Ip(e,c)})}),d}function rg(e){return function(e){return"object"===typeof e&&null!==e}(e)&&"ownerSVGElement"in e}function ig(e,t){return function(e){let{top:t,left:n,right:r,bottom:i}=e;return{x:{min:n,max:r},y:{min:t,max:i}}}(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const og=e=>t=>t.test(e),ag=[Wp,nm,tm,em,im,rm,{test:e=>"auto"===e,parse:e=>e}],sg=e=>ag.find(og(e)),cg=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),lg=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function dg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');const[r,i]=function(e){const t=lg.exec(e);if(!t)return[,];const[,n,r,i]=t;return["--".concat(null!==n&&void 0!==n?n:r),i]}(e);if(!r)return;const o=window.getComputedStyle(t).getPropertyValue(r);if(o){const e=o.trim();return cg(e)?parseFloat(e):e}return Vp(i)?dg(i,t,n+1):i}const ug=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function hg(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||ug(e))}const pg=new Set(["brightness","contrast","saturate","opacity"]);function mg(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(Kp)||[];if(!r)return e;const i=n.replace(r,"");let o=pg.has(t)?1:0;return r!==n&&(o*=100),t+"("+o+i+")"}const fg=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,gg=(0,a.A)((0,a.A)({},gm),{},{getAnimatableNone:e=>{const t=e.match(fg);return t?t.map(mg).join(" "):e}}),_g=(0,a.A)((0,a.A)({},Wp),{},{transform:Math.round}),vg={rotate:em,rotateX:em,rotateY:em,rotateZ:em,scale:Gp,scaleX:Gp,scaleY:Gp,scaleZ:Gp,skew:em,skewX:em,skewY:em,distance:nm,translateX:nm,translateY:nm,translateZ:nm,x:nm,y:nm,z:nm,perspective:nm,transformPerspective:nm,opacity:Hp,originX:om,originY:om,originZ:nm},bg=(0,a.A)((0,a.A)({borderWidth:nm,borderTopWidth:nm,borderRightWidth:nm,borderBottomWidth:nm,borderLeftWidth:nm,borderRadius:nm,radius:nm,borderTopLeftRadius:nm,borderTopRightRadius:nm,borderBottomRightRadius:nm,borderBottomLeftRadius:nm,width:nm,maxWidth:nm,height:nm,maxHeight:nm,top:nm,right:nm,bottom:nm,left:nm,padding:nm,paddingTop:nm,paddingRight:nm,paddingBottom:nm,paddingLeft:nm,margin:nm,marginTop:nm,marginRight:nm,marginBottom:nm,marginLeft:nm,backgroundPositionX:nm,backgroundPositionY:nm},vg),{},{zIndex:_g,fillOpacity:Hp,strokeOpacity:Hp,numOctaves:_g}),Eg=(0,a.A)((0,a.A)({},bg),{},{color:sm,backgroundColor:sm,outlineColor:sm,fill:sm,stroke:sm,borderColor:sm,borderTopColor:sm,borderRightColor:sm,borderBottomColor:sm,borderLeftColor:sm,filter:gg,WebkitFilter:gg}),yg=e=>Eg[e];function Sg(e,t){let n=yg(e);return n!==gg&&(n=gm),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Tg=new Set(["auto","none","0"]);class Cg extends Rf{constructor(e,t,n,r,i){super(e,t,n,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let s=0;s<e.length;s++){let n=e[s];if("string"===typeof n&&(n=n.trim(),Vp(n))){const r=dg(n,t.current);void 0!==r&&(e[s]=r),s===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!fp.has(n)||2!==e.length)return;const[r,i]=e,o=sg(r),a=sg(i);if(o!==a)if(gf(o)&&gf(a))for(let s=0;s<e.length;s++){const t=e[s];"string"===typeof t&&(e[s]=parseFloat(t))}else bf[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)(null===e[r]||hg(e[r]))&&n.push(r);n.length&&function(e,t,n){let r,i=0;for(;i<e.length&&!r;){const t=e[i];"string"===typeof t&&!Tg.has(t)&&hm(t).values.length&&(r=e[i]),i++}if(r&&n)for(const o of t)e[o]=Sg(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=bf[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const i=t.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=bf[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==a&&void 0===this.finalKeyframe&&(this.finalKeyframe=a),null!==(e=this.removedTransforms)&&void 0!==e&&e.length&&this.removedTransforms.forEach(e=>{let[n,r]=e;t.getValue(n).set(r)}),this.resolveNoneKeyframes()}}const wg=[...ag,sm,gm],{schedule:Rg,cancel:Ag}=cp(queueMicrotask,!1),Ig={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ng={};for(const n in Ig)Ng[n]={isEnabled:e=>Ig[n].some(t=>!!e[t])};const Og=()=>({x:{min:0,max:0},y:{min:0,max:0}}),Pg="undefined"!==typeof window,kg={current:null},Dg={current:!1};const xg=["initial","animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"];function Lg(e){return null!==(t=e.animate)&&"object"===typeof t&&"function"===typeof t.start||xg.some(t=>function(e){return"string"===typeof e||Array.isArray(e)}(e[t]));var t}const Mg=["willChange"],Ug=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Fg{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:c}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Rf,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=bp.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,lp.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=c;this.latestValues=d,this.baseTarget=(0,a.A)({},d),this.initialValues=n.initial?(0,a.A)({},d):{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=l,this.blockInitialAnimation=Boolean(s),this.isControllingVariants=Lg(n),this.isVariantNode=function(e){return Boolean(Lg(e)||e.variants)}(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const h=this.scrapeMotionValuesFromProps(n,{},this),{willChange:p}=h,m=(0,o.A)(h,Mg);for(const o in m){const e=m[o];void 0!==d[o]&&Fh(e)&&e.set(d[o])}}mount(e){var t;this.current=e,np.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),Dg.current||function(){if(Dg.current=!0,Pg)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>kg.current=e.matches;e.addEventListener("change",t),t()}else kg.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||kg.current),null===(t=this.parent)||void 0===t||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),dp(this.notifyUpdate),dp(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null===(e=this.parent)||void 0===e||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){var t;this.children.add(e),null!==(t=this.enteringChildren)&&void 0!==t||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=mp.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&lp.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Ng){const t=Ng[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Ug.length;n++){const t=Ug[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const i=t[r],o=n[r];if(Fh(i))e.addValue(r,i);else if(Fh(o))e.addValue(r,Sp(i,{owner:e}));else if(o!==i)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(i):t.hasAnimated||t.set(i)}else{const t=e.getStaticValue(r);e.addValue(r,Sp(void 0!==t?t:i,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=Sp(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var i;return void 0!==r&&null!==r&&("string"===typeof r&&(cg(r)||ug(r))?r=parseFloat(r):(i=r,!wg.find(og(i))&&gm.test(t)&&(r=Sg(e,t))),this.setBaseTarget(e,Fh(r)?r.get():r)),Fh(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if("string"===typeof t||"object"===typeof t){var r;const i=Cp(this.props,t,null===(r=this.presenceContext)||void 0===r?void 0:r.custom);i&&(n=i[e])}if(t&&void 0!==n)return n;const i=this.getBaseTargetFromProps(this.props,e);return void 0===i||Fh(i)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:i}on(e,t){return this.events[e]||(this.events[e]=new gp),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e].notify(...n)}}scheduleRenderMicrotask(){Rg.render(this.render)}}class jg extends Fg{constructor(){super(...arguments),this.KeyframeResolver=Cg}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:r}=t;delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Fh(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}}const Vg=(e,t)=>t&&"number"===typeof e?t.transform(e):e,Bg={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Wg=pp.length;function Hg(e,t,n){const{style:r,vars:i,transformOrigin:o}=e;let a=!1,s=!1;for(const c in t){const e=t[c];if(mp.has(c))a=!0;else if(Fp(c))i[c]=e;else{const t=Vg(e,bg[c]);c.startsWith("origin")?(s=!0,o[c]=t):r[c]=t}}if(t.transform||(a||n?r.transform=function(e,t,n){let r="",i=!0;for(let o=0;o<Wg;o++){const a=pp[o],s=e[a];if(void 0===s)continue;let c=!0;if(c="number"===typeof s?s===(a.startsWith("scale")?1:0):0===parseFloat(s),!c||n){const e=Vg(s,bg[a]);c||(i=!1,r+="".concat(Bg[a]||a,"(").concat(e,") ")),n&&(t[a]=e)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:e="50%",originY:t="50%",originZ:n=0}=o;r.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function Gg(e,t,n,r){let{style:i,vars:o}=t;const a=e.style;let s;for(s in i)a[s]=i[s];for(s in null===r||void 0===r||r.applyProjectionStyles(a,n),o)a.setProperty(s,o[s])}const zg={};function Kg(e,t){let{layout:n,layoutId:r}=t;return mp.has(e)||e.startsWith("origin")||(n||void 0!==r)&&(!!zg[e]||"opacity"===e)}function Yg(e,t,n){const{style:r}=e,i={};for(const a in r){var o;(Fh(r[a])||t.style&&Fh(t.style[a])||Kg(a,e)||void 0!==(null===n||void 0===n||null===(o=n.getValue(a))||void 0===o?void 0:o.liveStyle))&&(i[a]=r[a])}return i}class qg extends jg{constructor(){super(...arguments),this.type="html",this.renderInstance=Gg}readValueFromInstance(e,t){var n,r;if(mp.has(t))return null!==(n=this.projection)&&void 0!==n&&n.isProjecting?pf(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return mf(n,t)})(e,t);{const n=(r=e,window.getComputedStyle(r)),i=(Fp(t)?n.getPropertyValue(t):n[t])||0;return"string"===typeof i?i.trim():i}}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return ig(e,n)}build(e,t,n){Hg(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return Yg(e,t,n)}}class Xg extends Fg{constructor(){super(...arguments),this.type="object"}readValueFromInstance(e,t){if(function(e,t){return e in t}(t,e)){const n=e[t];if("string"===typeof n||"number"===typeof n)return n}}getBaseTargetFromProps(){}removeValueFromRenderState(e,t){delete t.output[e]}measureInstanceViewportBox(){return{x:{min:0,max:0},y:{min:0,max:0}}}build(e,t){Object.assign(e.output,t)}renderInstance(e,t){let{output:n}=t;Object.assign(e,n)}sortInstanceNodePosition(){return 0}}const Jg={offset:"stroke-dashoffset",array:"stroke-dasharray"},Zg={offset:"strokeDashoffset",array:"strokeDasharray"};const Qg=["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"];function $g(e,t,n,r,i){let{attrX:a,attrY:s,attrScale:c,pathLength:l,pathSpacing:d=1,pathOffset:u=0}=t;if(Hg(e,(0,o.A)(t,Qg),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:h,style:p}=e;var m,f;(h.transform&&(p.transform=h.transform,delete h.transform),p.transform||h.transformOrigin)&&(p.transformOrigin=null!==(m=h.transformOrigin)&&void 0!==m?m:"50% 50%",delete h.transformOrigin);p.transform&&(p.transformBox=null!==(f=null===i||void 0===i?void 0:i.transformBox)&&void 0!==f?f:"fill-box",delete h.transformBox);void 0!==a&&(h.x=a),void 0!==s&&(h.y=s),void 0!==c&&(h.scale=c),void 0!==l&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const o=i?Jg:Zg;e[o.offset]=nm.transform(-r);const a=nm.transform(t),s=nm.transform(n);e[o.array]="".concat(a," ").concat(s)}(h,l,d,u,!1)}const e_=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);class t_ extends jg{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Og}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(mp.has(t)){const e=yg(t);return e&&e.default||0}return t=e_.has(t)?t:Op(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return function(e,t,n){const r=Yg(e,t,n);for(const i in e)(Fh(e[i])||Fh(t[i]))&&(r[-1!==pp.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=e[i]);return r}(e,t,n)}build(e,t,n){$g(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){!function(e,t,n,r){Gg(e,t,void 0,r);for(const i in t.attrs)e.setAttribute(e_.has(i)?i:Op(i),t.attrs[i])}(e,t,0,r)}mount(e){var t;this.isSVGTag="string"===typeof(t=e.tagName)&&"svg"===t.toLowerCase(),super.mount(e)}}function n_(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=rg(e)&&!function(e){return rg(e)&&"svg"===e.tagName}(e)?new t_(t):new qg(t);n.mount(e),np.set(e,n)}function r_(e){const t=new Xg({presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}});t.mount(e),np.set(e,t)}function i_(e,t,n,r){const i=[];if(function(e,t){return Fh(e)||"number"===typeof e||"string"===typeof e&&!Bh(t)}(e,t))i.push(function(e,t,n){const r=Fh(e)?e:Sp(e);return r.start($f("",r,t,n)),r.animation}(e,Bh(t)&&t.default||t,n&&n.default||n));else{const o=Wh(e,t,r),s=o.length;Boolean(s);for(let e=0;e<s;e++){const r=o[e];Ch();const c=r instanceof Element?n_:r_;np.has(r)||c(r);const l=np.get(r),d=(0,a.A)({},n);"delay"in d&&"function"===typeof d.delay&&(d.delay=d.delay(e,s)),i.push(...ng(l,(0,a.A)((0,a.A)({},t),{},{transition:d}),{}))}}return i}function o_(e,t,n){const r=[],i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{defaultTransition:n={}}=t,r=(0,o.A)(t,qh),i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;const c=n.duration||.3,l=new Map,d=new Map,u={},h=new Map;let p=0,m=0,f=0;for(let g=0;g<e.length;g++){const t=e[g];if("string"===typeof t){h.set(t,m);continue}if(!Array.isArray(t)){h.set(t.name,Gh(m,t.at,p,h));continue}let[r,l,_={}]=t;void 0!==_.at&&(m=Gh(m,_.at,p,h));let v=0;const b=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const d=Qh(e),{delay:u=0,times:h=Mh(d),type:p="keyframes",repeat:g,repeatType:_,repeatDelay:b=0}=t,E=(0,o.A)(t,Xh);let{ease:y=n.ease||"easeOut",duration:S}=t;const T="function"===typeof u?u(i,l):u,C=d.length,w=Uh(p)?p:null===s||void 0===s?void 0:s[p||"keyframes"];if(C<=2&&w){let e=100;if(2===C&&tp(d)){const t=d[1]-d[0];e=Math.abs(t)}const t=(0,a.A)({},E);void 0!==S&&(t.duration=fh(S));const n=Eh(t,e,w);y=n.ease,S=n.duration}null!==S&&void 0!==S||(S=c);const R=m+T;1===h.length&&0===h[0]&&(h[1]=1);const A=h.length-d.length;if(A>0&&Lh(h,A),1===d.length&&d.unshift(null),g){S=Hh(S,g);const e=[...d],t=[...h];y=Array.isArray(y)?[...y]:[y];const n=[...y];for(let r=0;r<g;r++){d.push(...e);for(let i=0;i<e.length;i++)h.push(t[i]+(r+1)),y.push(0===i?"linear":Vh(n,i-1))}Kh(h,g)}const I=R+S;zh(r,d,y,h,R,I),v=Math.max(T+S,v),f=Math.max(I,f)};if(Fh(r))b(l,_,Zh("default",Jh(r,d)));else{const e=Wh(r,l,i,u),t=e.length;for(let n=0;n<t;n++){const r=Jh(e[n],d);for(const e in l)b(l[e],$h(_,e),Zh(e,r),n,t)}}p=m,m+=v}return d.forEach((e,t)=>{for(const i in e){const o=e[i];o.sort(Yh);const s=[],c=[],d=[];for(let e=0;e<o.length;e++){const{at:t,value:n,easing:r}=o[e];s.push(n),c.push(Dh(0,f,t)),d.push(r||"easeOut")}0!==c[0]&&(c.unshift(0),s.unshift(s[0]),d.unshift("easeInOut")),1!==c[c.length-1]&&(c.push(1),s.push(null)),l.has(t)||l.set(t,{keyframes:{},transition:{}});const u=l.get(t);u.keyframes[i]=s,u.transition[i]=(0,a.A)((0,a.A)({},n),{},{duration:f,ease:d,times:c},r)}}),l}(e,t,n,{spring:kh});return i.forEach((e,t)=>{let{keyframes:n,transition:i}=e;r.push(...i_(t,n,i))}),r}const a_=["onComplete"];const s_=function(e,t,n){let r,i=[];if(function(e){return Array.isArray(e)&&e.some(Array.isArray)}(e))i=o_(e,t,c_);else{const a=n||{},{onComplete:s}=a;"function"===typeof s&&(r=s),i=i_(e,t,(0,o.A)(a,a_),c_)}const a=new hh(i);return r&&a.finished.then(r),c_&&(c_.animations.push(a),a.finished.then(()=>{ph(c_.animations,a)})),a};var c_;var l_=n(9329),d_=n.n(l_);const u_=(0,i.createContext)(null),h_=()=>(0,i.useContext)(u_),p_=e=>{let{children:t}=e;const n=(()=>{const e=new URLSearchParams(window.location.search);let t=e.get("host");const n=e.get("shop");if(t)return t;if(window.location.hash){if(t=new URLSearchParams(window.location.hash.substring(1)).get("host"),t)return t}return n&&t||console.warn("Missing shop or host parameter. App should be accessed through Shopify admin."),t||null})(),r="1844b97873b270b025334fd34790185c";console.log("apiKey",r);const o=(0,i.useMemo)(()=>{if(!n)return console.warn("App Bridge: Host parameter not found. App should be accessed through Shopify admin."),null;try{console.log("-------------------------"),console.log("apiKey",r),console.log("host",n);const e=d_()({apiKey:r,host:n,forceRedirect:!0,embedded:!0});return console.log("\u2705 App Bridge initialized successfully with host:",n),e}catch(e){return console.error("\u274c Error initializing App Bridge:",e),null}},[n,r]);return(0,i.useEffect)(()=>{n&&r?console.log("App Bridge Debug:",{host:n,apiKey:"SET",appInitialized:null!==o}):console.warn("App Bridge Debug:",{host:n||"NOT FOUND",apiKey:r?"SET":"NOT SET",message:"App Bridge will not work without host and API key"})},[n,r,o]),(0,ad.jsx)(u_.Provider,{value:o,children:t})};var m_="Polaris-ShadowBevel";function f_(e){const{as:t="div",bevel:n=!0,borderRadius:r,boxShadow:o,children:s,zIndex:c="0"}=e,l=t;return i.createElement(l,{className:m_,style:(0,a.A)((0,a.A)((0,a.A)({"--pc-shadow-bevel-z-index":c},Qr("shadow-bevel","content",g_(n,e=>e?'""':"none"))),Qr("shadow-bevel","box-shadow",g_(n,e=>e?"var(--p-shadow-".concat(o,")"):"none"))),Qr("shadow-bevel","border-radius",g_(n,e=>e?"var(--p-border-radius-".concat(r,")"):"var(--p-border-radius-0)")))},s)}function g_(e,t){return"boolean"===typeof e?t(e):Object.fromEntries(Object.entries(e).map(e=>{let[n,r]=e;return[n,t(r)]}))}const __=e=>{let{children:t,background:n="bg-surface",padding:r={xs:"400"},roundedAbove:o="sm"}=e;const a=Xi(),s=Boolean(a["".concat(o,"Up")]);return i.createElement(cl.Provider,{value:!0},i.createElement(f_,{boxShadow:"100",borderRadius:s?"300":"0",zIndex:"32"},i.createElement(ia,{background:n,padding:r,overflowX:"clip",overflowY:"clip",minHeight:"100%"},t)))};var v_={ProgressBar:"Polaris-ProgressBar",sizeSmall:"Polaris-ProgressBar--sizeSmall",sizeMedium:"Polaris-ProgressBar--sizeMedium",sizeLarge:"Polaris-ProgressBar--sizeLarge",toneHighlight:"Polaris-ProgressBar--toneHighlight",tonePrimary:"Polaris-ProgressBar--tonePrimary",toneSuccess:"Polaris-ProgressBar--toneSuccess",toneCritical:"Polaris-ProgressBar--toneCritical",Indicator:"Polaris-ProgressBar__Indicator",IndicatorAppearActive:"Polaris-ProgressBar__IndicatorAppearActive",IndicatorAppearDone:"Polaris-ProgressBar__IndicatorAppearDone",Progress:"Polaris-ProgressBar__Progress",Label:"Polaris-ProgressBar__Label"};function b_(e){let{progress:t=0,size:n="medium",tone:r="highlight",animated:o=!0,ariaLabelledBy:a}=e;const s=Ka(),c=ji(),l=(0,i.useRef)(null),d=qr(v_.ProgressBar,n&&v_[Xr("size",n)],r&&v_[Xr("tone",r)]),u=(c.translate(t<0?"Polaris.ProgressBar.negativeWarningMessage":"Polaris.ProgressBar.exceedWarningMessage",{progress:t}),function(e){let t;t=e<0?0:e>100?100:e;return t}(t)),h=o?s.motion["motion-duration-500"]:s.motion["motion-duration-0"];return i.createElement("div",{className:d},i.createElement("progress",{"aria-labelledby":a,className:v_.Progress,value:u,max:"100"}),i.createElement(Il,{in:!0,appear:!0,timeout:parseInt(h,10),nodeRef:l,classNames:{appearActive:v_.IndicatorAppearActive,appearDone:v_.IndicatorAppearDone}},i.createElement("div",{ref:l,className:v_.Indicator,style:{"--pc-progress-bar-duration":h,"--pc-progress-bar-percent":u/100}},i.createElement("span",{className:v_.Label},u,"%"))))}var E_="Polaris-Collapsible",y_="Polaris-Collapsible--isFullyClosed",S_="Polaris-Collapsible--expandOnPrint";function T_(e){let{id:t,expandOnPrint:n,open:r,transition:o=!0,children:s,onAnimationEnd:c}=e;const[l,d]=(0,i.useState)(0),[u,h]=(0,i.useState)(r),[p,m]=(0,i.useState)("idle"),f=(0,i.useRef)(null),g="idle"===p&&r&&u,_="idle"===p&&!r&&!u,v=n||!_?s:null,b=qr(E_,_&&y_,n&&S_),E=function(e){if("boolean"===typeof e)return!e;const{duration:t}=e;if(t&&C_.test(t.trim()))return!0;return!1}(o),y="object"===typeof o&&{transitionDuration:o.duration,transitionTimingFunction:o.timingFunction},S=(0,a.A)((0,a.A)({},y),{maxHeight:g?"none":"".concat(l,"px"),overflow:g?"visible":"hidden"}),T=(0,i.useCallback)(e=>{let{target:t}=e;t===f.current&&(m("idle"),h(r),c&&c())},[c,r]),C=(0,i.useCallback)(()=>{E?(h(r),m("idle"),r&&f.current?d(f.current.scrollHeight):d(0)):m("measuring")},[r,E]);return(0,i.useEffect)(()=>{r!==u&&C()},[r,u]),(0,i.useEffect)(()=>{r&&f.current&&d(f.current.scrollHeight)},[]),(0,i.useEffect)(()=>{if(f.current)switch(p){case"idle":break;case"measuring":d(f.current.scrollHeight),m("animating");break;case"animating":d(r?f.current.scrollHeight:0)}},[p,r,u]),i.createElement("div",{id:t,style:S,ref:f,className:b,onTransitionEnd:T,"aria-hidden":!r},v)}const C_=/^0(ms|s)$/;const w_="SetupGuide_setupItem__H8EJy",R_="SetupGuide_setupItemExpanded__VVQVC",A_="SetupGuide_completeButton__vQPW4",I_="SetupGuide_itemContent__El1eZ",N_="SetupGuide_itemImage__jXy+d",O_=()=>{const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)(P_);return e?(0,ad.jsx)("div",{className:"max-w-[60rem] m-auto",children:(0,ad.jsx)(k_,{onDismiss:()=>{t(!1),r(P_)},onStepComplete:async e=>{try{await new Promise(e=>setTimeout(()=>{e()},1e3)),r(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{complete:!t.complete}):t))}catch($D){console.error($D)}},items:n})}):(0,ad.jsx)(fs,{onClick:()=>t(!0),children:"Show Setup Guide"})},P_=[{id:0,title:"App Status Configuration",description:"Go to the top of the dashboard page and click the Enable/Disable button to activate or deactivate the consultant management system.",complete:!1,primaryButton:{content:"Go to Dashboard",props:{external:!1}}},{id:1,title:"Add Your First Consultant",description:"Navigate to the Consultant List page and click on 'Add Consultant' button. Fill in all the required details including name, email, contact, profession, experience, and conversion fees.",complete:!1,primaryButton:{content:"Add Consultant",props:{external:!1}}},{id:2,title:"Manage Consultant Status",description:"Use the toggle switch in the Status column to activate or deactivate consultants. Active consultants are available for consultations, while inactive ones are temporarily disabled.",complete:!1,primaryButton:{content:"View Consultants",props:{external:!1}}},{id:3,title:"Filter Consultants",description:"Use the filter tabs (All, Chat, Voice Call, Video Call) to view consultants by their consultation type. You can also use the search bar to find consultants by name, email, or profession.",complete:!1,primaryButton:{content:"View Consultants",props:{external:!1}}},{id:4,title:"Edit Consultant Information",description:"Click on the Edit icon in the Action column to update consultant details. You can modify their contact information, profession, experience, and conversion fees at any time.",complete:!1,primaryButton:{content:"View Consultants",props:{external:!1}}},{id:5,title:"Monitor Dashboard Statistics",description:"Check the dashboard to view key metrics including total clients, conversion rate, total consultations, and total revenue. These statistics help you track your consultant management performance.",complete:!1,primaryButton:{content:"View Dashboard",props:{external:!1}}}],k_=e=>{let{onDismiss:t,onStepComplete:n,items:r}=e;const[o,s]=(0,i.useState)(r.findIndex(e=>!e.complete)),[c,l]=(0,i.useState)(!0),[d,u]=(0,i.useState)(!1),h=(0,i.useId)(),p=r.filter(e=>e.complete).length;return(0,ad.jsxs)(__,{padding:"0",children:[(0,ad.jsx)(ia,{padding:"400",paddingBlockEnd:"400",children:(0,ad.jsxs)(qs,{children:[(0,ad.jsxs)(Bs,{align:"space-between",blockAlign:"center",children:[(0,ad.jsx)(Qi,{as:"h3",variant:"headingMd",children:"Consultant Management Setup Guide"}),(0,ad.jsxs)(iu,{gap:"tight",noWrap:!0,children:[(0,ad.jsx)(ts,{active:d,onClose:()=>u(e=>!e),activator:(0,ad.jsx)(fs,{onClick:()=>u(e=>!e),variant:"tertiary",icon:Id}),children:(0,ad.jsx)(Lc,{actionRole:"menuitem",items:[{content:"Dismiss",onAction:t,prefix:(0,ad.jsx)("div",{style:{height:"1rem",width:"1rem",paddingTop:".05rem"},children:(0,ad.jsx)($i,{tone:"subdued",source:Fl})})}]})}),(0,ad.jsx)(fs,{variant:"tertiary",icon:c?ss:cs,onClick:()=>{l(e=>(e||s(r.findIndex(e=>!e.complete)),!e))},ariaControls:h})]})]}),(0,ad.jsx)(Qi,{as:"p",variant:"bodyMd",children:"Follow these instructions to set up and manage your consultant management system."}),(0,ad.jsx)("div",{style:{marginTop:".8rem"},children:(0,ad.jsxs)(Bs,{blockAlign:"center",gap:"200",children:[p===r.length?(0,ad.jsx)("div",{style:{maxHeight:"1rem"},children:(0,ad.jsxs)(Bs,{wrap:!1,gap:"100",children:[(0,ad.jsx)($i,{source:vu,tone:"subdued",accessibilityLabel:"Check icon to indicate completion of Setup Guide"}),(0,ad.jsx)(Qi,{as:"p",variant:"bodySm",tone:"subdued",children:"Done"})]})}):(0,ad.jsx)(Qi,{as:"span",variant:"bodySm",children:"".concat(p," / ").concat(r.length," completed")}),p!==r.length?(0,ad.jsx)("div",{style:{width:"100px"},children:(0,ad.jsx)(b_,{progress:r.filter(e=>e.complete).length/r.length*100,size:"small",tone:"primary",animated:!0})}):null]})})]})}),(0,ad.jsx)(T_,{open:c,id:h,children:(0,ad.jsx)(ia,{padding:"200",children:(0,ad.jsx)(qs,{gap:"100",children:r.map(e=>(0,ad.jsx)(D_,(0,a.A)({expanded:o===e.id,setExpanded:()=>s(e.id),onComplete:n},e),e.id))})})}),p===r.length?(0,ad.jsx)(ia,{background:"bg-surface-secondary",borderBlockStartWidth:"025",borderColor:"border-secondary",padding:"300",children:(0,ad.jsx)(Bs,{align:"end",children:(0,ad.jsx)(fs,{onClick:t,children:"Dismiss Guide"})})}):null]})},D_=e=>{let{complete:t,onComplete:n,expanded:r,setExpanded:o,title:s,description:c,image:l,primaryButton:d,secondaryButton:u,id:h}=e;const[p,m]=(0,i.useState)(!1);return(0,ad.jsx)(ia,{borderRadius:"200",background:r?"bg-surface-active":void 0,children:(0,ad.jsx)("div",{className:"".concat(w_," ").concat(r?R_:""),children:(0,ad.jsxs)(Bs,{gap:"200",align:"start",blockAlign:"start",wrap:!1,children:[(0,ad.jsx)(Fs,{content:t?"Mark as not done":"Mark as done",activatorWrapper:"div",children:(0,ad.jsx)("div",{className:A_,onClick:async()=>{m(!0),await n(h),m(!1)},style:{cursor:"pointer"},children:p?(0,ad.jsx)(hs,{size:"small"}):t?(0,ad.jsx)(vu,{style:{width:"1.25rem",height:"1.25rem",borderRadius:"100%",background:"#303030",display:"flex",justifyContent:"center",alignItems:"center",fill:"white"}}):(0,ad.jsx)("div",{style:{width:"1.25rem",height:"1.25rem"},children:x_})})}),(0,ad.jsxs)("div",{className:I_,onClick:r?()=>null:o,style:{cursor:r?"default":"pointer",paddingTop:".15rem",width:"100%"},children:[(0,ad.jsxs)(qs,{gap:"300",id:h.toString(),children:[(0,ad.jsx)(Qi,{as:"h4",variant:r?"headingSm":"bodyMd",children:s}),(0,ad.jsx)(T_,{open:r,id:h.toString(),children:(0,ad.jsx)(ia,{paddingBlockEnd:"150",paddingInlineEnd:"150",children:(0,ad.jsxs)(qs,{gap:"400",children:[(0,ad.jsx)(Qi,{as:"p",variant:"bodyMd",children:c}),d||u?(0,ad.jsxs)(iu,{gap:"loose",children:[d?(0,ad.jsx)(fs,(0,a.A)((0,a.A)({variant:"primary"},d.props),{},{children:d.content})):null,u?(0,ad.jsx)(fs,(0,a.A)((0,a.A)({variant:"tertiary"},u.props),{},{children:u.content})):null]}):null]})})})]}),l&&r?(0,ad.jsx)(jc,{className:N_,source:l.url,alt:l.alt,style:{maxHeight:"7.75rem"}}):null]})]})})})},x_=(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.9147 13.3062L19.9315 13.0475C19.9761 12.7056 19.9993 12.3561 19.9993 12.0001C19.9993 11.6442 19.9761 11.2946 19.9315 10.9527L21.9147 10.694C21.9705 11.1215 21.9993 11.5575 21.9993 12.0001C21.9993 12.4428 21.9705 12.8787 21.9147 13.3062ZM21.2405 8.17224L19.393 8.93835C19.1238 8.28906 18.7709 7.68206 18.3474 7.13093L19.9333 5.91228C20.4621 6.6004 20.9033 7.35927 21.2405 8.17224ZM18.0871 4.06613L16.8685 5.65197C16.3173 5.22845 15.7103 4.87563 15.061 4.60638L15.8271 2.75893C16.6401 3.09605 17.399 3.53734 18.0871 4.06613ZM13.3054 2.08464L13.0467 4.06784C12.7048 4.02324 12.3552 4.00012 11.9993 4.00012C11.6433 4.00012 11.2938 4.02324 10.9519 4.06784L10.6932 2.08464C11.1206 2.02889 11.5566 2.00012 11.9993 2.00012C12.4419 2.00012 12.8779 2.02889 13.3054 2.08464ZM8.17139 2.75893L8.9375 4.60638C8.2882 4.87563 7.6812 5.22845 7.13008 5.65197L5.91143 4.06613C6.59954 3.53734 7.35841 3.09606 8.17139 2.75893ZM4.06527 5.91228L5.65111 7.13093C5.22759 7.68206 4.87478 8.28906 4.60552 8.93835L2.75807 8.17225C3.0952 7.35927 3.53648 6.6004 4.06527 5.91228ZM2.08379 10.694C2.02803 11.1215 1.99927 11.5575 1.99927 12.0001C1.99927 12.4428 2.02803 12.8787 2.08379 13.3062L4.06699 13.0475C4.02239 12.7056 3.99927 12.3561 3.99927 12.0001C3.99927 11.6442 4.02239 11.2946 4.06699 10.9527L2.08379 10.694ZM2.75807 15.828L4.60553 15.0619C4.87478 15.7112 5.22759 16.3182 5.65111 16.8693L4.06527 18.088C3.53648 17.3998 3.0952 16.641 2.75807 15.828ZM5.91143 19.9341L7.13008 18.3483C7.68121 18.7718 8.28821 19.1246 8.9375 19.3939L8.17139 21.2413C7.35841 20.9042 6.59955 20.4629 5.91143 19.9341ZM10.6932 21.9156L10.9519 19.9324C11.2938 19.977 11.6433 20.0001 11.9993 20.0001C12.3552 20.0001 12.7048 19.977 13.0467 19.9324L13.3054 21.9156C12.8779 21.9714 12.4419 22.0001 11.9993 22.0001C11.5566 22.0001 11.1206 21.9714 10.6932 21.9156ZM15.8271 21.2413L15.061 19.3939C15.7103 19.1246 16.3173 18.7718 16.8685 18.3483L18.0871 19.9341C17.399 20.4629 16.6401 20.9042 15.8271 21.2413ZM19.9333 18.088L18.3474 16.8693C18.7709 16.3182 19.1238 15.7112 19.393 15.0619L21.2405 15.828C20.9033 16.641 20.4621 17.3998 19.9333 18.088Z",fill:"#8C9196",style:{display:"none"}}),(0,ad.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5334 2.10692C11.0126 2.03643 11.5024 2 12 2C12.4976 2 12.9874 2.03643 13.4666 2.10692C14.013 2.18729 14.3908 2.6954 14.3104 3.2418C14.23 3.78821 13.7219 4.166 13.1755 4.08563C12.7924 4.02927 12.3999 4 12 4C11.6001 4 11.2076 4.02927 10.8245 4.08563C10.2781 4.166 9.76995 3.78821 9.68958 3.2418C9.6092 2.6954 9.987 2.18729 10.5334 2.10692ZM7.44122 4.17428C7.77056 4.61763 7.67814 5.24401 7.23479 5.57335C6.603 6.04267 6.04267 6.603 5.57335 7.23479C5.24401 7.67814 4.61763 7.77056 4.17428 7.44122C3.73094 7.11188 3.63852 6.4855 3.96785 6.04216C4.55386 5.25329 5.25329 4.55386 6.04216 3.96785C6.4855 3.63852 7.11188 3.73094 7.44122 4.17428ZM16.5588 4.17428C16.8881 3.73094 17.5145 3.63852 17.9578 3.96785C18.7467 4.55386 19.4461 5.25329 20.0321 6.04216C20.3615 6.4855 20.2691 7.11188 19.8257 7.44122C19.3824 7.77056 18.756 7.67814 18.4267 7.23479C17.9573 6.603 17.397 6.04267 16.7652 5.57335C16.3219 5.24401 16.2294 4.61763 16.5588 4.17428ZM3.2418 9.68958C3.78821 9.76995 4.166 10.2781 4.08563 10.8245C4.02927 11.2076 4 11.6001 4 12C4 12.3999 4.02927 12.7924 4.08563 13.1755C4.166 13.7219 3.78821 14.23 3.2418 14.3104C2.6954 14.3908 2.18729 14.013 2.10692 13.4666C2.03643 12.9874 2 12.4976 2 12C2 11.5024 2.03643 11.0126 2.10692 10.5334C2.18729 9.987 2.6954 9.6092 3.2418 9.68958ZM20.7582 9.68958C21.3046 9.6092 21.8127 9.987 21.8931 10.5334C21.9636 11.0126 22 11.5024 22 12C22 12.4976 21.9636 12.9874 21.8931 13.4666C21.8127 14.013 21.3046 14.3908 20.7582 14.3104C20.2118 14.23 19.834 13.7219 19.9144 13.1755C19.9707 12.7924 20 12.3999 20 12C20 11.6001 19.9707 11.2076 19.9144 10.8245C19.834 10.2781 20.2118 9.76995 20.7582 9.68958ZM4.17428 16.5588C4.61763 16.2294 5.24401 16.3219 5.57335 16.7652C6.04267 17.397 6.603 17.9573 7.23479 18.4267C7.67814 18.756 7.77056 19.3824 7.44122 19.8257C7.11188 20.2691 6.4855 20.3615 6.04216 20.0321C5.25329 19.4461 4.55386 18.7467 3.96785 17.9578C3.63852 17.5145 3.73094 16.8881 4.17428 16.5588ZM19.8257 16.5588C20.2691 16.8881 20.3615 17.5145 20.0321 17.9578C19.4461 18.7467 18.7467 19.4461 17.9578 20.0321C17.5145 20.3615 16.8881 20.2691 16.5588 19.8257C16.2294 19.3824 16.3219 18.756 16.7652 18.4267C17.397 17.9573 17.9573 17.397 18.4267 16.7652C18.756 16.3219 19.3824 16.2294 19.8257 16.5588ZM9.68958 20.7582C9.76995 20.2118 10.2781 19.834 10.8245 19.9144C11.2076 19.9707 11.6001 20 12 20C12.3999 20 12.7924 19.9707 13.1755 19.9144C13.7219 19.834 14.23 20.2118 14.3104 20.7582C14.3908 21.3046 14.013 21.8127 13.4666 21.8931C12.9874 21.9636 12.4976 22 12 22C11.5024 22 11.0126 21.9636 10.5334 21.8931C9.987 21.8127 9.6092 21.3046 9.68958 20.7582Z",fill:"#8A8A8A"}),(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#DBDDDF",style:{display:"none"}}),(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"9",fill:"#F6F6F7",stroke:"#999EA4",strokeWidth:"2",style:{display:"none"}})]});function L_(){const[e,t]=(0,i.useState)(!0),n=(0,i.useCallback)(()=>t(e=>!e),[]),r=e?"Disable App":"Enable App",o="app-status-toggle-uuid",{mdDown:a}=Xi(),s=e?"success":"critical",c=e?"Enabled":"Disabled",l="App Status",d=(0,ad.jsx)(Po,{tone:s,toneAndProgressLabelOverride:"App is ".concat(c),children:c}),u=(0,ad.jsx)(fs,{variant:"plain",icon:yu,accessibilityLabel:"Learn more"}),h=l?(0,ad.jsx)(Bs,{gap:"200",wrap:!1,children:(0,ad.jsxs)(Bs,{gap:"200",align:"start",blockAlign:"baseline",children:[(0,ad.jsx)("label",{htmlFor:o,children:(0,ad.jsx)(Qi,{variant:"headingMd",as:"h6",children:l})}),(0,ad.jsxs)(Bs,{gap:"200",align:"center",blockAlign:"center",children:[d,u]})]})}):null,p=(0,ad.jsx)(fs,{role:"switch",id:o,ariaChecked:e?"true":"false",onClick:n,size:"slim",children:r}),m=(0,ad.jsx)(ia,{width:"100%",children:(0,ad.jsxs)(Bs,{gap:"1200",align:"space-between",blockAlign:"start",wrap:!1,children:[h,a?null:(0,ad.jsx)(ia,{minWidth:"fit-content",children:(0,ad.jsx)(Bs,{align:"end",children:p})})]})}),f=(0,ad.jsxs)(qs,{gap:"400",children:[(0,ad.jsx)(Qi,{id:"app-status-description-uuid",variant:"bodyMd",as:"p",tone:"subdued",children:"Control whether your app is active and functioning. When disabled, the app will not process any requests or perform its intended functions."}),a?(0,ad.jsx)(ia,{width:"100%",children:(0,ad.jsx)(Bs,{align:"start",children:p})}):null]});return(0,ad.jsx)(__,{children:(0,ad.jsxs)(qs,{gap:{xs:"400",sm:"500"},children:[(0,ad.jsx)(ia,{width:"100%",children:(0,ad.jsxs)(qs,{gap:{xs:"200",sm:"400"},children:[m,f]})}),(0,ad.jsx)(Qi,{variant:"bodyMd",as:"p",children:e?"Your app is currently active and processing requests.":"Your app is currently disabled and not processing any requests."})]})})}const M_=[{code:"en",name:"English",flag:"./images/flag/en.svg"},{code:"fr",name:"French",flag:"./images/flag/fr.svg"},{code:"hi",name:"Hindi",flag:"./images/flag/hi.svg"},{code:"ja",name:"Japanese",flag:"./images/flag/ja.svg"},{code:"ru",name:"Russian",flag:"./images/flag/ru.svg"},{code:"sn",name:"Shona",flag:"./images/flag/sn.svg"},{code:"st",name:"Sesotho",flag:"./images/flag/st.svg"},{code:"es",name:"Spanish",flag:"./images/flag/es.svg"},{code:"tg",name:"Tajik",flag:"./images/flag/tg.svg"}];function U_(){const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(M_[0]),o=(0,i.useCallback)(()=>t(e=>!e),[]);return(0,ad.jsx)(ia,{children:(0,ad.jsx)(ts,{active:e,activator:(0,ad.jsx)(fs,{onClick:o,disclosure:"down",variant:"secondary",icon:(0,ad.jsx)(ia,{style:{display:"flex",alignItems:"center"},children:(0,ad.jsx)("img",{src:n.flag,alt:n.name,width:16,height:16,style:{borderRadius:"50%",objectFit:"cover",marginRight:"5px",verticalAlign:"middle",boxShadow:"0px 0px 10px 1px #0000001f"}})}),children:n.name}),onClose:()=>t(!1),children:(0,ad.jsx)(ia,{padding:"100",minWidth:"130px",children:(0,ad.jsx)(Lc,{actionRole:"menuitem",items:M_.map(e=>({content:e.name,prefix:(0,ad.jsx)("img",{src:e.flag,alt:e.name,width:16,height:16,style:{borderRadius:"50%",objectFit:"cover",boxShadow:"0px 0px 10px 1px #0000001f"}}),onAction:()=>(e=>{r(e),t(!1)})(e)}))})})})})}var F_=n(7237);function j_(e){e()}var V_={notify(){},get:()=>[]};function B_(e,t){let n,r=V_,i=0,o=!1;function a(){l.onStateChange&&l.onStateChange()}function s(){i++,n||(n=t?t.addNestedSub(a):e.subscribe(a),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){j_(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){r&&null!==e&&(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}())}function c(){i--,n&&0===i&&(n(),n=void 0,r.clear(),r=V_)}const l={addNestedSub:function(e){s();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),c())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:a,isSubscribed:function(){return o},trySubscribe:function(){o||(o=!0,s())},tryUnsubscribe:function(){o&&(o=!1,c())},getListeners:()=>r};return l}var W_=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),H_=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),G_=(()=>W_||H_?i.useLayoutEffect:i.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var z_=Symbol.for("react-redux-context"),K_="undefined"!==typeof globalThis?globalThis:{};function Y_(){var e;if(!i.createContext)return{};const t=null!==(e=K_[z_])&&void 0!==e?e:K_[z_]=new Map;let n=t.get(i.createContext);return n||(n=i.createContext(null),t.set(i.createContext,n)),n}var q_=Y_();var X_=function(e){const{children:t,context:n,serverState:r,store:o}=e,a=i.useMemo(()=>{const e=B_(o);return{store:o,subscription:e,getServerState:r?()=>r:void 0}},[o,r]),s=i.useMemo(()=>o.getState(),[o]);G_(()=>{const{subscription:e}=a;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==o.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[a,s]);const c=n||q_;return i.createElement(c.Provider,{value:a},t)};function J_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q_;return function(){return i.useContext(e)}}var Z_=J_();function Q_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q_;const t=e===q_?Z_:J_(e),n=()=>{const{store:e}=t();return e};return Object.assign(n,{withTypes:()=>n}),n}var $_=Q_();function ev(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q_;const t=e===q_?$_:Q_(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var tv=ev(),nv=(e,t)=>e===t;function rv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q_;const t=e===q_?Z_:J_(e),n=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:r=nv}="function"===typeof n?{equalityFn:n}:n;const o=t(),{store:a,subscription:s,getServerState:c}=o,l=(i.useRef(!0),i.useCallback({[e.name]:t=>e(t)}[e.name],[e])),d=(0,F_.useSyncExternalStoreWithSelector)(s.addNestedSub,a.getState,c||a.getState,l,r);return i.useDebugValue(d),d};return Object.assign(n,{withTypes:()=>n}),n}var iv=rv(),ov=n(830);function av(e,t){return function(){return e.apply(t,arguments)}}const{toString:sv}=Object.prototype,{getPrototypeOf:cv}=Object,{iterator:lv,toStringTag:dv}=Symbol,uv=(e=>t=>{const n=sv.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),hv=e=>(e=e.toLowerCase(),t=>uv(t)===e),pv=e=>t=>typeof t===e,{isArray:mv}=Array,fv=pv("undefined");function gv(e){return null!==e&&!fv(e)&&null!==e.constructor&&!fv(e.constructor)&&bv(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _v=hv("ArrayBuffer");const vv=pv("string"),bv=pv("function"),Ev=pv("number"),yv=e=>null!==e&&"object"===typeof e,Sv=e=>{if("object"!==uv(e))return!1;const t=cv(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(dv in e)&&!(lv in e)},Tv=hv("Date"),Cv=hv("File"),wv=hv("Blob"),Rv=hv("FileList"),Av=hv("URLSearchParams"),[Iv,Nv,Ov,Pv]=["ReadableStream","Request","Response","Headers"].map(hv);function kv(e,t){let n,r,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),mv(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(gv(e))return;const r=i?Object.getOwnPropertyNames(e):Object.keys(e),o=r.length;let a;for(n=0;n<o;n++)a=r[n],t.call(null,e[a],a,e)}}function Dv(e,t){if(gv(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const xv="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Lv=e=>!fv(e)&&e!==xv;const Mv=(Uv="undefined"!==typeof Uint8Array&&cv(Uint8Array),e=>Uv&&e instanceof Uv);var Uv;const Fv=hv("HTMLFormElement"),jv=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),Vv=hv("RegExp"),Bv=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};kv(n,(n,i)=>{let o;!1!==(o=t(n,i,e))&&(r[i]=o||n)}),Object.defineProperties(e,r)};const Wv=hv("AsyncFunction"),Hv=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),r=[],xv.addEventListener("message",e=>{let{source:t,data:i}=e;t===xv&&i===n&&r.length&&r.shift()()},!1),e=>{r.push(e),xv.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,bv(xv.postMessage)),Gv="undefined"!==typeof queueMicrotask?queueMicrotask.bind(xv):"undefined"!==typeof process&&process.nextTick||Hv,zv={isArray:mv,isArrayBuffer:_v,isBuffer:gv,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||bv(e.append)&&("formdata"===(t=uv(e))||"object"===t&&bv(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&_v(e.buffer),t},isString:vv,isNumber:Ev,isBoolean:e=>!0===e||!1===e,isObject:yv,isPlainObject:Sv,isEmptyObject:e=>{if(!yv(e)||gv(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch($D){return!1}},isReadableStream:Iv,isRequest:Nv,isResponse:Ov,isHeaders:Pv,isUndefined:fv,isDate:Tv,isFile:Cv,isBlob:wv,isRegExp:Vv,isFunction:bv,isStream:e=>yv(e)&&bv(e.pipe),isURLSearchParams:Av,isTypedArray:Mv,isFileList:Rv,forEach:kv,merge:function e(){const{caseless:t,skipUndefined:n}=Lv(this)&&this||{},r={},i=(i,o)=>{const a=t&&Dv(r,o)||o;Sv(r[a])&&Sv(i)?r[a]=e(r[a],i):Sv(i)?r[a]=e({},i):mv(i)?r[a]=i.slice():n&&fv(i)||(r[a]=i)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&kv(arguments[o],i);return r},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return kv(t,(t,r)=>{n&&bv(t)?e[r]=av(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,o,a;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)a=i[o],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&cv(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:uv,kindOfTest:hv,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(mv(e))return e;let t=e.length;if(!Ev(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[lv]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Fv,hasOwnProperty:jv,hasOwnProp:jv,reduceDescriptors:Bv,freezeMethods:e=>{Bv(e,(t,n)=>{if(bv(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];bv(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return mv(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Dv,global:xv,isContextDefined:Lv,isSpecCompliantForm:function(e){return!!(e&&bv(e.append)&&"FormData"===e[dv]&&e[lv])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(yv(e)){if(t.indexOf(e)>=0)return;if(gv(e))return e;if(!("toJSON"in e)){t[r]=e;const i=mv(e)?[]:{};return kv(e,(e,t)=>{const o=n(e,r+1);!fv(o)&&(i[t]=o)}),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:Wv,isThenable:e=>e&&(yv(e)||bv(e))&&bv(e.then)&&bv(e.catch),setImmediate:Hv,asap:Gv,isIterable:e=>null!=e&&bv(e[lv])};function Kv(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}zv.inherits(Kv,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:zv.toJSONObject(this.config),code:this.code,status:this.status}}});const Yv=Kv.prototype,qv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{qv[e]={value:e}}),Object.defineProperties(Kv,qv),Object.defineProperty(Yv,"isAxiosError",{value:!0}),Kv.from=(e,t,n,r,i,o)=>{const a=Object.create(Yv);zv.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const s=e&&e.message?e.message:"Error",c=null==t&&e?e.code:t;return Kv.call(a,s,c,n,r,i),e&&null==a.cause&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",o&&Object.assign(a,o),a};const Xv=Kv;function Jv(e){return zv.isPlainObject(e)||zv.isArray(e)}function Zv(e){return zv.endsWith(e,"[]")?e.slice(0,-2):e}function Qv(e,t,n){return e?e.concat(t).map(function(e,t){return e=Zv(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const $v=zv.toFlatObject(zv,{},null,function(e){return/^is[A-Z]/.test(e)});const eb=function(e,t,n){if(!zv.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=zv.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!zv.isUndefined(t[e])})).metaTokens,i=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&zv.isSpecCompliantForm(t);if(!zv.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(zv.isDate(e))return e.toISOString();if(zv.isBoolean(e))return e.toString();if(!s&&zv.isBlob(e))throw new Xv("Blob is not supported. Use a Buffer instead.");return zv.isArrayBuffer(e)||zv.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,i){let s=e;if(e&&!i&&"object"===typeof e)if(zv.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(zv.isArray(e)&&function(e){return zv.isArray(e)&&!e.some(Jv)}(e)||(zv.isFileList(e)||zv.endsWith(n,"[]"))&&(s=zv.toArray(e)))return n=Zv(n),s.forEach(function(e,r){!zv.isUndefined(e)&&null!==e&&t.append(!0===a?Qv([n],r,o):null===a?n:n+"[]",c(e))}),!1;return!!Jv(e)||(t.append(Qv(i,n,o),c(e)),!1)}const d=[],u=Object.assign($v,{defaultVisitor:l,convertValue:c,isVisitable:Jv});if(!zv.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!zv.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),zv.forEach(n,function(n,o){!0===(!(zv.isUndefined(n)||null===n)&&i.call(t,n,zv.isString(o)?o.trim():o,r,u))&&e(n,r?r.concat(o):[o])}),d.pop()}}(e),t};function tb(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function nb(e,t){this._pairs=[],e&&eb(e,this,t)}const rb=nb.prototype;rb.append=function(e,t){this._pairs.push([e,t])},rb.toString=function(e){const t=e?function(t){return e.call(this,t,tb)}:tb;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const ib=nb;function ob(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ab(e,t,n){if(!t)return e;const r=n&&n.encode||ob;zv.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let o;if(o=i?i(t,n):zv.isURLSearchParams(t)?t.toString():new ib(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const sb=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){zv.forEach(this.handlers,function(t){null!==t&&e(t)})}},cb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lb={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:ib,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},db="undefined"!==typeof window&&"undefined"!==typeof document,ub="object"===typeof navigator&&navigator||void 0,hb=db&&(!ub||["ReactNative","NativeScript","NS"].indexOf(ub.product)<0),pb="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,mb=db&&window.location.href||"http://localhost",fb=(0,a.A)((0,a.A)({},e),lb);const gb=function(e){function t(e,n,r,i){let o=e[i++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),s=i>=e.length;if(o=!o&&zv.isArray(r)?r.length:o,s)return zv.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!a;r[o]&&zv.isObject(r[o])||(r[o]=[]);return t(e,n,r[o],i)&&zv.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}(r[o])),!a}if(zv.isFormData(e)&&zv.isFunction(e.entries)){const n={};return zv.forEachEntry(e,(e,r)=>{t(function(e){return zv.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const _b={transitional:cb,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=zv.isObject(e);i&&zv.isHTMLForm(e)&&(e=new FormData(e));if(zv.isFormData(e))return r?JSON.stringify(gb(e)):e;if(zv.isArrayBuffer(e)||zv.isBuffer(e)||zv.isStream(e)||zv.isFile(e)||zv.isBlob(e)||zv.isReadableStream(e))return e;if(zv.isArrayBufferView(e))return e.buffer;if(zv.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return eb(e,new fb.classes.URLSearchParams,(0,a.A)({visitor:function(e,t,n,r){return fb.isNode&&zv.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=zv.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return eb(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(zv.isString(e))try{return(t||JSON.parse)(e),zv.trim(e)}catch($D){if("SyntaxError"!==$D.name)throw $D}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||_b.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(zv.isResponse(e)||zv.isReadableStream(e))return e;if(e&&zv.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch($D){if(n){if("SyntaxError"===$D.name)throw Xv.from($D,Xv.ERR_BAD_RESPONSE,this,null,this.response);throw $D}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fb.classes.FormData,Blob:fb.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};zv.forEach(["delete","get","head","post","put","patch"],e=>{_b.headers[e]={}});const vb=_b,bb=zv.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Eb=Symbol("internals");function yb(e){return e&&String(e).trim().toLowerCase()}function Sb(e){return!1===e||null==e?e:zv.isArray(e)?e.map(Sb):String(e)}function Tb(e,t,n,r,i){return zv.isFunction(r)?r.call(this,t,n):(i&&(t=n),zv.isString(t)?zv.isString(r)?-1!==t.indexOf(r):zv.isRegExp(r)?r.test(t):void 0:void 0)}class Cb{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=yb(t);if(!i)throw new Error("header name must be a non-empty string");const o=zv.findKey(r,i);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=Sb(e))}const o=(e,t)=>zv.forEach(e,(e,n)=>i(e,n,t));if(zv.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(zv.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))o((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach(function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&bb[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(zv.isObject(e)&&zv.isIterable(e)){let n,r,i={};for(const t of e){if(!zv.isArray(t))throw TypeError("Object iterator must return a key-value pair");i[r=t[0]]=(n=i[r])?zv.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}o(i,t)}else null!=e&&i(t,e,n);return this}get(e,t){if(e=yb(e)){const n=zv.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(zv.isFunction(t))return t.call(this,e,n);if(zv.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=yb(e)){const n=zv.findKey(this,e);return!(!n||void 0===this[n]||t&&!Tb(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=yb(e)){const i=zv.findKey(n,e);!i||t&&!Tb(0,n[i],i,t)||(delete n[i],r=!0)}}return zv.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!Tb(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return zv.forEach(this,(r,i)=>{const o=zv.findKey(n,i);if(o)return t[o]=Sb(r),void delete t[i];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(i):String(i).trim();a!==i&&delete t[i],t[a]=Sb(r),n[a]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return zv.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&zv.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[Eb]=this[Eb]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=yb(e);t[r]||(!function(e,t){const n=zv.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})})}(n,e),t[r]=!0)}return zv.isArray(e)?e.forEach(r):r(e),this}}Cb.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),zv.reduceDescriptors(Cb.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),zv.freezeMethods(Cb);const wb=Cb;function Rb(e,t){const n=this||vb,r=t||n,i=wb.from(r.headers);let o=r.data;return zv.forEach(e,function(e){o=e.call(n,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function Ab(e){return!(!e||!e.__CANCEL__)}function Ib(e,t,n){Xv.call(this,null==e?"canceled":e,Xv.ERR_CANCELED,t,n),this.name="CanceledError"}zv.inherits(Ib,Xv,{__CANCEL__:!0});const Nb=Ib;function Ob(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new Xv("Request failed with status code "+n.status,[Xv.ERR_BAD_REQUEST,Xv.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Pb=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];i||(i=c),n[o]=s,r[o]=c;let d=a,u=0;for(;d!==o;)u+=n[d++],d%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),c-i<t)return;const h=l&&c-l;return h?Math.round(1e3*u/h):void 0}};const kb=function(e,t){let n,r,i=0,o=1e3/t;const a=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();i=o,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[function(){const e=Date.now(),t=e-i;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];t>=o?a(c,e):(n=c,r||(r=setTimeout(()=>{r=null,a(n)},o-t)))},()=>n&&a(n)]},Db=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const i=Pb(50,250);return kb(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,s=o-r,c=i(s);r=o;e({loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&o<=a?(a-o)/c:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},xb=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Lb=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return zv.asap(()=>e(...n))},Mb=fb.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,fb.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(fb.origin),fb.navigator&&/(msie|trident)/i.test(fb.navigator.userAgent)):()=>!0,Ub=fb.hasStandardBrowserEnv?{write(e,t,n,r,i,o,a){if("undefined"===typeof document)return;const s=["".concat(e,"=").concat(encodeURIComponent(t))];zv.isNumber(n)&&s.push("expires=".concat(new Date(n).toUTCString())),zv.isString(r)&&s.push("path=".concat(r)),zv.isString(i)&&s.push("domain=".concat(i)),!0===o&&s.push("secure"),zv.isString(a)&&s.push("SameSite=".concat(a)),document.cookie=s.join("; ")},read(e){if("undefined"===typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Fb(e,t,n){let r=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const jb=e=>e instanceof wb?(0,a.A)({},e):e;function Vb(e,t){t=t||{};const n={};function r(e,t,n,r){return zv.isPlainObject(e)&&zv.isPlainObject(t)?zv.merge.call({caseless:r},e,t):zv.isPlainObject(t)?zv.merge({},t):zv.isArray(t)?t.slice():t}function i(e,t,n,i){return zv.isUndefined(t)?zv.isUndefined(e)?void 0:r(void 0,e,0,i):r(e,t,0,i)}function o(e,t){if(!zv.isUndefined(t))return r(void 0,t)}function s(e,t){return zv.isUndefined(t)?zv.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function c(n,i,o){return o in t?r(n,i):o in e?r(void 0,n):void 0}const l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c,headers:(e,t,n)=>i(jb(e),jb(t),0,!0)};return zv.forEach(Object.keys((0,a.A)((0,a.A)({},e),t)),function(r){const o=l[r]||i,a=o(e[r],t[r],r);zv.isUndefined(a)&&o!==c||(n[r]=a)}),n}const Bb=e=>{const t=Vb({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:a,auth:s}=t;if(t.headers=a=wb.from(a),t.url=ab(Fb(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),zv.isFormData(n))if(fb.hasStandardBrowserEnv||fb.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(zv.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,r]=e;t.includes(n.toLowerCase())&&a.set(n,r)})}if(fb.hasStandardBrowserEnv&&(r&&zv.isFunction(r)&&(r=r(t)),r||!1!==r&&Mb(t.url))){const e=i&&o&&Ub.read(o);e&&a.set(i,e)}return t},Wb="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=Bb(e);let i=r.data;const o=wb.from(r.headers).normalize();let a,s,c,l,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=r;function m(){l&&l(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let f=new XMLHttpRequest;function g(){if(!f)return;const r=wb.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());Ob(function(e){t(e),m()},function(e){n(e),m()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f}),f=null}f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new Xv("Request aborted",Xv.ECONNABORTED,e,f)),f=null)},f.onerror=function(t){const r=t&&t.message?t.message:"Network Error",i=new Xv(r,Xv.ERR_NETWORK,e,f);i.event=t||null,n(i),f=null},f.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||cb;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new Xv(t,i.clarifyTimeoutError?Xv.ETIMEDOUT:Xv.ECONNABORTED,e,f)),f=null},void 0===i&&o.setContentType(null),"setRequestHeader"in f&&zv.forEach(o.toJSON(),function(e,t){f.setRequestHeader(t,e)}),zv.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),u&&"json"!==u&&(f.responseType=r.responseType),p&&([c,d]=Db(p,!0),f.addEventListener("progress",c)),h&&f.upload&&([s,l]=Db(h),f.upload.addEventListener("progress",s),f.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(a=t=>{f&&(n(!t||t.type?new Nb(null,e,f):t),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));const _=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);_&&-1===fb.protocols.indexOf(_)?n(new Xv("Unsupported protocol "+_+":",Xv.ERR_BAD_REQUEST,e)):f.send(i||null)})},Hb=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const i=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;r.abort(t instanceof Xv?t:new Nb(t instanceof Error?t.message:t))}};let o=t&&setTimeout(()=>{o=null,i(new Xv("timeout ".concat(t," of ms exceeded"),Xv.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)}),e=null)};e.forEach(e=>e.addEventListener("abort",i));const{signal:s}=r;return s.unsubscribe=()=>zv.asap(a),s}};function Gb(e,t){this.v=e,this.k=t}function zb(e){return function(){return new Kb(e.apply(this,arguments))}}function Kb(e){var t,n;function r(t,n){try{var o=e[t](n),a=o.value,s=a instanceof Gb;Promise.resolve(s?a.v:a).then(function(n){if(s){var c="return"===t?"return":"next";if(!a.k||n.done)return r(c,n);n=e[c](n).value}i(o.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(o,a){var s={key:e,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function Yb(e){return new Gb(e,0)}function qb(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise(function(n){n(e[t](r))}),{done:!1,value:new Gb(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function Xb(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new Jb(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function Jb(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Jb=function(e){this.s=e,this.n=e.next},Jb.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Jb(e)}Kb.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Kb.prototype.next=function(e){return this._invoke("next",e)},Kb.prototype.throw=function(e){return this._invoke("throw",e)},Kb.prototype.return=function(e){return this._invoke("return",e)};const Zb=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,i=0;for(;i<n;)r=i+t,yield e.slice(i,r),i=r},Qb=function(){var e=zb(function*(e,t){var n,r=!1,i=!1;try{for(var o,a=Xb($b(e));r=!(o=yield Yb(a.next())).done;r=!1){const e=o.value;yield*qb(Xb(Zb(e,t)))}}catch(s){i=!0,n=s}finally{try{r&&null!=a.return&&(yield Yb(a.return()))}finally{if(i)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),$b=function(){var e=zb(function*(e){if(e[Symbol.asyncIterator])return void(yield*qb(Xb(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield Yb(t.read());if(e)break;yield n}}finally{yield Yb(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),eE=(e,t,n,r)=>{const i=Qb(e,t);let o,a=0,s=e=>{o||(o=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await i.next();if(t)return s(),void e.close();let o=r.byteLength;if(n){let e=a+=o;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw s(t),t}},cancel:e=>(s(e),i.return())},{highWaterMark:2})},{isFunction:tE}=zv,nE=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(zv.global),{ReadableStream:rE,TextEncoder:iE}=zv.global,oE=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch($D){return!1}},aE=e=>{e=zv.merge.call({skipUndefined:!0},nE,e);const{fetch:t,Request:n,Response:r}=e,i=t?tE(t):"function"===typeof fetch,o=tE(n),s=tE(r);if(!i)return!1;const c=i&&tE(rE),l=i&&("function"===typeof iE?(d=new iE,e=>d.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var d;const u=o&&c&&oE(()=>{let e=!1;const t=new n(fb.origin,{body:new rE,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),h=s&&c&&oE(()=>zv.isReadableStream(new r("").body)),p={stream:h&&(e=>e.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!p[e]&&(p[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new Xv("Response type '".concat(e,"' is not supported"),Xv.ERR_NOT_SUPPORT,n)})});const m=async(e,t)=>{const r=zv.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(zv.isBlob(e))return e.size;if(zv.isSpecCompliantForm(e)){const t=new n(fb.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return zv.isArrayBufferView(e)||zv.isArrayBuffer(e)?e.byteLength:(zv.isURLSearchParams(e)&&(e+=""),zv.isString(e)?(await l(e)).byteLength:void 0)})(t):r};return async e=>{let{url:i,method:s,data:c,signal:l,cancelToken:d,timeout:f,onDownloadProgress:g,onUploadProgress:_,responseType:v,headers:b,withCredentials:E="same-origin",fetchOptions:y}=Bb(e),S=t||fetch;v=v?(v+"").toLowerCase():"text";let T=Hb([l,d&&d.toAbortSignal()],f),C=null;const w=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let R;try{if(_&&u&&"get"!==s&&"head"!==s&&0!==(R=await m(b,c))){let e,t=new n(i,{method:"POST",body:c,duplex:"half"});if(zv.isFormData(c)&&(e=t.headers.get("content-type"))&&b.setContentType(e),t.body){const[e,n]=xb(R,Db(Lb(_)));c=eE(t.body,65536,e,n)}}zv.isString(E)||(E=E?"include":"omit");const t=o&&"credentials"in n.prototype,l=(0,a.A)((0,a.A)({},y),{},{signal:T,method:s.toUpperCase(),headers:b.normalize().toJSON(),body:c,duplex:"half",credentials:t?E:void 0});C=o&&new n(i,l);let d=await(o?S(C,y):S(i,l));const f=h&&("stream"===v||"response"===v);if(h&&(g||f&&w)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=d[t]});const t=zv.toFiniteNumber(d.headers.get("content-length")),[n,i]=g&&xb(t,Db(Lb(g),!0))||[];d=new r(eE(d.body,65536,n,()=>{i&&i(),w&&w()}),e)}v=v||"text";let A=await p[zv.findKey(p,v)||"text"](d,e);return!f&&w&&w(),await new Promise((t,n)=>{Ob(t,n,{data:A,headers:wb.from(d.headers),status:d.status,statusText:d.statusText,config:e,request:C})})}catch(A){if(w&&w(),A&&"TypeError"===A.name&&/Load failed|fetch/i.test(A.message))throw Object.assign(new Xv("Network Error",Xv.ERR_NETWORK,e,C),{cause:A.cause||A});throw Xv.from(A,A&&A.code,e,C)}}},sE=new Map,cE=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:i}=t,o=[r,i,n];let a,s,c=o.length,l=sE;for(;c--;)a=o[c],s=l.get(a),void 0===s&&l.set(a,s=c?new Map:aE(t)),l=s;return s},lE=(cE(),{http:null,xhr:Wb,fetch:{get:cE}});zv.forEach(lE,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch($D){}Object.defineProperty(e,"adapterName",{value:t})}});const dE=e=>"- ".concat(e),uE=e=>zv.isFunction(e)||null===e||!1===e;const hE={getAdapter:function(e,t){e=zv.isArray(e)?e:[e];const{length:n}=e;let r,i;const o={};for(let a=0;a<n;a++){let n;if(r=e[a],i=r,!uE(r)&&(i=lE[(n=String(r)).toLowerCase()],void 0===i))throw new Xv("Unknown adapter '".concat(n,"'"));if(i&&(zv.isFunction(i)||(i=i.get(t))))break;o[n||"#"+a]=i}if(!i){const e=Object.entries(o).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let t=n?e.length>1?"since :\n"+e.map(dE).join("\n"):" "+dE(e[0]):"as no adapter specified";throw new Xv("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return i},adapters:lE};function pE(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Nb(null,e)}function mE(e){pE(e),e.headers=wb.from(e.headers),e.data=Rb.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return hE.getAdapter(e.adapter||vb.adapter,e)(e).then(function(t){return pE(e),t.data=Rb.call(e,e.transformResponse,t),t.headers=wb.from(t.headers),t},function(t){return Ab(t)||(pE(e),t&&t.response&&(t.response.data=Rb.call(e,e.transformResponse,t.response),t.response.headers=wb.from(t.response.headers))),Promise.reject(t)})}const fE="1.13.2",gE={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gE[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const _E={};gE.transitional=function(e,t,n){function r(e,t){return"[Axios v"+fE+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,o)=>{if(!1===e)throw new Xv(r(i," has been removed"+(t?" in "+t:"")),Xv.ERR_DEPRECATED);return t&&!_E[i]&&(_E[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}},gE.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const vE={assertOptions:function(e,t,n){if("object"!==typeof e)throw new Xv("options must be an object",Xv.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new Xv("option "+o+" must be "+n,Xv.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Xv("Unknown option "+o,Xv.ERR_BAD_OPTION)}},validators:gE},bE=vE.validators;class EE{constructor(e){this.defaults=e||{},this.interceptors={request:new sb,response:new sb}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch($D){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Vb(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&vE.assertOptions(n,{silentJSONParsing:bE.transitional(bE.boolean),forcedJSONParsing:bE.transitional(bE.boolean),clarifyTimeoutError:bE.transitional(bE.boolean)},!1),null!=r&&(zv.isFunction(r)?t.paramsSerializer={serialize:r}:vE.assertOptions(r,{encode:bE.function,serialize:bE.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),vE.assertOptions(t,{baseUrl:bE.spelling("baseURL"),withXsrfToken:bE.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&zv.merge(i.common,i[t.method]);i&&zv.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=wb.concat(o,i);const a=[];let s=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const c=[];let l;this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected)});let d,u=0;if(!s){const e=[mE.bind(this),void 0];for(e.unshift(...a),e.push(...c),d=e.length,l=Promise.resolve(t);u<d;)l=l.then(e[u++],e[u++]);return l}d=a.length;let h=t;for(;u<d;){const e=a[u++],t=a[u++];try{h=e(h)}catch(p){t.call(this,p);break}}try{l=mE.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return ab(Fb((e=Vb(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}zv.forEach(["delete","get","head","options"],function(e){EE.prototype[e]=function(t,n){return this.request(Vb(n||{},{method:e,url:t,data:(n||{}).data}))}}),zv.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,i){return this.request(Vb(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}EE.prototype[e]=t(),EE.prototype[e+"Form"]=t(!0)});const yE=EE;class SE{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,i){n.reason||(n.reason=new Nb(e,r,i),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new SE(function(t){e=t}),cancel:e}}}const TE=SE;const CE={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(CE).forEach(e=>{let[t,n]=e;CE[n]=t});const wE=CE;const RE=function e(t){const n=new yE(t),r=av(yE.prototype.request,n);return zv.extend(r,yE.prototype,n,{allOwnKeys:!0}),zv.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Vb(t,n))},r}(vb);RE.Axios=yE,RE.CanceledError=Nb,RE.CancelToken=TE,RE.isCancel=Ab,RE.VERSION=fE,RE.toFormData=eb,RE.AxiosError=Xv,RE.Cancel=RE.CanceledError,RE.all=function(e){return Promise.all(e)},RE.spread=function(e){return function(t){return e.apply(null,t)}},RE.isAxiosError=function(e){return zv.isObject(e)&&!0===e.isAxiosError},RE.mergeConfig=Vb,RE.AxiosHeaders=wb,RE.formToJSON=e=>gb(zv.isHTMLForm(e)?new FormData(e):e),RE.getAdapter=hE.getAdapter,RE.HttpStatusCode=wE,RE.default=RE;const AE=RE,IE=(0,ov.zD)("users/fetch",async()=>(await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api/users/user-details"))).data),NE=(0,ov.zD)("users/fetch-details",async e=>(await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api/users/shopify/users/").concat(e))).data),OE=(0,ov.Z0)({name:"users",initialState:{users:[],loading:!1,error:null,userDetails:null},extraReducers:e=>{e.addCase(IE.pending,e=>{e.loading=!0}).addCase(IE.fulfilled,(e,t)=>{e.loading=!1,e.users=t.payload}).addCase(IE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(NE.pending,e=>{e.loading=!0}).addCase(NE.fulfilled,(e,t)=>{e.loading=!1,e.userDetails=t.payload}).addCase(NE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message})}}).reducer,PE=(0,ov.zD)("consultants/fetch",async e=>{console.log("adminIdLocal__________REDUX",e);const t=await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/api-find-consultant/").concat(e),{headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"},params:{_t:Date.now()}});return console.log("response_________________",t.data),t.data}),kE=(0,ov.zD)("consultants/fetchById",async e=>{let{shop_id:t,consultant_id:n}=e;console.log("shop_id____________________REDUX",t),console.log("consultant_id________________REDUX",n);return(await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/consultant-by-shop-id-and-consultant-id/").concat(t,"/").concat(n))).data}),DE=(0,ov.zD)("consultants/fetchChatHistory",async e=>{let{shopId:t,userId:n,consultantId:r}=e;return(await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api/chat/get/chat-history/").concat(t,"/").concat(n,"/").concat(r))).data}),xE=(0,ov.zD)("consultants/delete",async e=>(await AE.delete("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/delete-consultant/").concat(e))).data),LE=(0,ov.zD)("consultants/updateUserRequestById",async e=>{let{shopId:t,userId:n,consultantId:r}=e;return(await AE.put("".concat("https://test-online-consultation.zend-apps.com","/api/chat/update-user-request/").concat(t,"/").concat(n,"/").concat(r))).data}),ME=(0,ov.Z0)({name:"consultants",initialState:{consultants:[],consultantOverview:null,chatHistory:null,loading:!1,error:null,deletedConsultant:null,userInRequest:null},extraReducers:e=>{e.addCase(PE.pending,e=>{e.loading=!0}).addCase(PE.fulfilled,(e,t)=>{e.loading=!1,e.consultants=t.payload}).addCase(PE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(xE.pending,e=>{e.loading=!0}).addCase(xE.fulfilled,(e,t)=>{e.loading=!1,e.deletedConsultant=t.payload}).addCase(xE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(kE.pending,e=>{e.loading=!0}).addCase(kE.fulfilled,(e,t)=>{e.loading=!1,e.consultantOverview=t.payload}).addCase(kE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(DE.pending,e=>{e.loading=!0}).addCase(DE.fulfilled,(e,t)=>{e.loading=!1,e.chatHistory=t.payload}).addCase(DE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(LE.pending,e=>{e.loading=!0}).addCase(LE.fulfilled,(e,t)=>{e.loading=!1,e.userInRequest=t.payload}).addCase(LE.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message})}}).reducer,UE=[{label:"Name",value:"name asc",directionLabel:"A-Z"},{label:"Name",value:"name desc",directionLabel:"Z-A"},{label:"Email _id",value:"email asc",directionLabel:"A-Z"},{label:"Email _id",value:"email desc",directionLabel:"Z-A"},{label:"Contact",value:"contact asc",directionLabel:"Ascending"},{label:"Contact",value:"contact desc",directionLabel:"Descending"},{label:"Profession",value:"profession asc",directionLabel:"A-Z"},{label:"Profession",value:"profession desc",directionLabel:"Z-A"},{label:"Experience",value:"experience asc",directionLabel:"Ascending"},{label:"Experience",value:"experience desc",directionLabel:"Descending"},{label:"Conversion Fees",value:"conversionFees asc",directionLabel:"Ascending"},{label:"Conversion Fees",value:"conversionFees desc",directionLabel:"Descending"},{label:"Status",value:"status asc",directionLabel:"A-Z"},{label:"Status",value:"status desc",directionLabel:"Z-A"}],FE=[{title:"Sr. No."},{title:"Image"},{title:"Name"},{title:"Email _id"},{title:"Contact"},{title:"Profession"},{title:"Experience"},{title:"Conversion Fees",alignment:"end"},{title:"Status"},{title:"Action"}],jE=[],VE=["English","French","Hindi","Japanese","Russian","Shona","Sesotho","Spanish","Tajik"],BE=[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"Other",value:"other"}],WE=()=>(0,ad.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),(0,ad.jsx)("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),(0,ad.jsx)("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"}),(0,ad.jsx)("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"})]}),HE=()=>(0,ad.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,ad.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});function GE(e){let{value:t}=e;const n=t||0,[r,o]=(0,i.useState)(n),[a,s]=(0,i.useState)(!1),c=(0,i.useRef)(n);return(0,i.useEffect)(()=>{if(void 0===t||null===t)return void o(0);const e=c.current;if(c.current=t,e!==t){s(!0);const n=s_(e,t,{duration:1.5,ease:[.16,1,.3,1],onUpdate:e=>{o(Math.round(e))},onComplete:()=>{s(!1)}});return()=>n.stop()}},[t]),(0,ad.jsx)("span",{style:{display:"inline-block",transform:a?"scale(1.1)":"scale(1)",transition:"transform 0.3s ease-out"},children:r},t)}const zE=function(){var e,t,n;const[r,o]=(0,i.useState)(!0),[a,s]=(0,i.useState)(null),[c,l]=(0,i.useState)(null),d=h_(),u=new URLSearchParams(window.location.search),h=(u.get("host"),u.get("AdminId")),p="690c374f605cb8b946503ccb";console.log("adminId",h),(0,i.useEffect)(()=>{p&&localStorage.setItem("doamin_V_id","690c374f605cb8b946503ccb")},[p]),(0,i.useEffect)(()=>{const e=localStorage.getItem("doamin_V_id");l(e)},[]),console.log("adminIdLocal",c);const m=tv(),{users:f,loading:g}=iv(e=>e.users),{consultants:_,loading:v}=iv(e=>e.consultants),b=(null===f||void 0===f||null===(e=f.data)||void 0===e?void 0:e.length)||0,E=(null===_||void 0===_||null===(t=_.findConsultant)||void 0===t?void 0:t.length)||0;return(0,i.useEffect)(()=>{m(PE(c))},[m,c]),(0,i.useEffect)(()=>{m(IE())},[m]),(0,i.useEffect)(()=>{p&&(async()=>{const e=localStorage.getItem("doamin_V_id"),t=await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api/admin/admin/").concat(e));var n;console.log("response",t),200===t.status&&(console.log("response",t.data),s(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.data))})()},[p]),(0,ad.jsxs)(ad.Fragment,{children:[d&&(0,ad.jsx)("ui-title-bar",{title:""}),(0,ad.jsx)(pu,{title:"vc-consultant app",primaryAction:(0,ad.jsx)(U_,{}),secondaryActions:[{content:"Publish App",external:!0,icon:ch}],children:(0,ad.jsxs)(gu,{children:[r&&(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Tu,{title:"Welcome to Consultant Management System",tone:"info",onDismiss:()=>o(!1),icon:lh,children:(0,ad.jsxs)(qs,{gap:"200",children:[(0,ad.jsx)("p",{children:"Manage your consultants efficiently and track their performance."}),(0,ad.jsx)("p",{children:"Add new consultants, update their status, and monitor consultations."})]})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsxs)(Ou,{children:[(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:3,xl:3},children:(0,ad.jsx)(Xu,{children:(0,ad.jsx)(ia,{padding:"400",children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,ad.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",backgroundColor:"#E3F2FD",border:"2px solid rgb(185, 14, 71)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"},children:"\ud83d\udc65"}),(0,ad.jsxs)("div",{style:{flex:1},children:[(0,ad.jsx)(Qi,{variant:"headingLg",as:"h2",fontWeight:"bold",children:(0,ad.jsx)(GE,{value:b})}),(0,ad.jsx)(Qi,{variant:"bodyMd",as:"p",tone:"subdued",style:{},children:"Total Clients"})]})]})})})}),(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:3,xl:3},children:(0,ad.jsx)(Xu,{children:(0,ad.jsx)(ia,{padding:"400",children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,ad.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",backgroundColor:"#FFF3E0",border:"2px solid #FF9800",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"},children:"\ud83d\udcc8"}),(0,ad.jsxs)("div",{style:{flex:1},children:[(0,ad.jsx)(Qi,{variant:"headingLg",as:"h2",fontWeight:"bold",children:"0%"}),(0,ad.jsx)(Qi,{variant:"bodyMd",as:"p",tone:"subdued",children:"Conversion Rate"})]})]})})})}),(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:3,xl:3},children:(0,ad.jsx)(Xu,{children:(0,ad.jsx)(ia,{padding:"400",children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,ad.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",backgroundColor:"#F3E5F5",border:"2px solid #9C27B0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"},children:"\ud83d\udcbc"}),(0,ad.jsxs)("div",{style:{flex:1},children:[(0,ad.jsx)(Qi,{variant:"headingLg",as:"h2",fontWeight:"bold",children:(0,ad.jsx)(GE,{value:E})}),(0,ad.jsx)(Qi,{variant:"bodyMd",as:"p",tone:"subdued",children:"Total Consultations"})]})]})})})}),(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:3,xl:3},children:(0,ad.jsx)(Xu,{children:(0,ad.jsx)(ia,{padding:"400",children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,ad.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",backgroundColor:"#FFEBEE",border:"2px solid #F44336",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"},children:"\ud83d\udcb0"}),(0,ad.jsxs)("div",{style:{flex:1},children:[(0,ad.jsxs)(Qi,{variant:"headingLg",as:"h2",fontWeight:"bold",children:["\u20b9",parseFloat((null===a||void 0===a||null===(n=a.adminWalletBalance)||void 0===n?void 0:n.$numberDecimal)||0).toFixed(2)]}),(0,ad.jsx)(Qi,{variant:"bodyMd",as:"p",tone:"subdued",children:"Total Revenue"})]})]})})})})]})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(L_,{})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(O_,{})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(sh,{title:"Manage Your Consultants Effectively",illustration:"/jqv_intro.png",primaryAction:{content:"View All Consultants",url:"/consultant-list"},children:(0,ad.jsx)("p",{children:"Access your consultant list to view, edit, and manage all your consultants. Track their availability, status, and consultation history in one place."})})})]})})]})};var KE={Thumbnail:"Polaris-Thumbnail",sizeExtraSmall:"Polaris-Thumbnail--sizeExtraSmall",sizeSmall:"Polaris-Thumbnail--sizeSmall",sizeMedium:"Polaris-Thumbnail--sizeMedium",sizeLarge:"Polaris-Thumbnail--sizeLarge",transparent:"Polaris-Thumbnail--transparent"};function YE(e){let{source:t,alt:n,size:r="medium",transparent:o}=e;const a=qr(KE.Thumbnail,r&&KE[Xr("size",r)],o&&KE.transparent),s="string"===typeof t?i.createElement(jc,{alt:n,source:t}):i.createElement($i,{accessibilityLabel:n,source:t});return i.createElement("span",{className:a},s)}var qE=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M15.655 4.344a2.695 2.695 0 0 0-3.81 0l-.599.599-.009-.009-1.06 1.06.008.01-5.88 5.88a2.75 2.75 0 0 0-.805 1.944v1.922a.75.75 0 0 0 .75.75h1.922a2.75 2.75 0 0 0 1.944-.806l7.54-7.539a2.695 2.695 0 0 0 0-3.81Zm-4.409 2.72-5.88 5.88a1.25 1.25 0 0 0-.366.884v1.172h1.172c.331 0 .65-.132.883-.366l5.88-5.88-1.689-1.69Zm2.75.629.599-.599a1.195 1.195 0 1 0-1.69-1.689l-.598.599 1.69 1.689Z"}))};qE.displayName="EditIcon";var XE=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M11.25 8.5c-.414 0-.75.336-.75.75v1.25h-1.25c-.414 0-.75.336-.75.75s.336.75.75.75h1.25v1.25c0 .414.336.75.75.75s.75-.336.75-.75v-1.25h1.25c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-1.25v-1.25c0-.414-.336-.75-.75-.75Z"}),i.createElement("path",{fillRule:"evenodd",d:"M8.75 16.5c-1.438 0-2.618-1.104-2.74-2.51-1.406-.122-2.51-1.302-2.51-2.74v-5c0-1.519 1.231-2.75 2.75-2.75h5c1.438 0 2.618 1.104 2.74 2.51 1.406.122 2.51 1.302 2.51 2.74v5c0 1.519-1.231 2.75-2.75 2.75h-5Zm0-10.5c-1.519 0-2.75 1.231-2.75 2.75v3.725c-.57-.116-1-.62-1-1.225v-5c0-.69.56-1.25 1.25-1.25h5c.605 0 1.11.43 1.225 1h-3.725Zm0 1.5c-.69 0-1.25.56-1.25 1.25v5c0 .69.56 1.25 1.25 1.25h5c.69 0 1.25-.56 1.25-1.25v-5c0-.69-.56-1.25-1.25-1.25h-5Z"}))};XE.displayName="DuplicateIcon";var JE=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M11.5 8.25a.75.75 0 0 1 .75.75v4.25a.75.75 0 0 1-1.5 0v-4.25a.75.75 0 0 1 .75-.75Z"}),i.createElement("path",{d:"M9.25 9a.75.75 0 0 0-1.5 0v4.25a.75.75 0 0 0 1.5 0v-4.25Z"}),i.createElement("path",{fillRule:"evenodd",d:"M7.25 5.25a2.75 2.75 0 0 1 5.5 0h3a.75.75 0 0 1 0 1.5h-.75v5.45c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311c-.642.327-1.482.327-3.162.327h-.4c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311c-.327-.642-.327-1.482-.327-3.162v-5.45h-.75a.75.75 0 0 1 0-1.5h3Zm1.5 0a1.25 1.25 0 1 1 2.5 0h-2.5Zm-2.25 1.5h7v5.45c0 .865-.001 1.423-.036 1.848-.033.408-.09.559-.128.633a1.5 1.5 0 0 1-.655.655c-.074.038-.225.095-.633.128-.425.035-.983.036-1.848.036h-.4c-.865 0-1.423-.001-1.848-.036-.408-.033-.559-.09-.633-.128a1.5 1.5 0 0 1-.656-.655c-.037-.074-.094-.225-.127-.633-.035-.425-.036-.983-.036-1.848v-5.45Z"}))};JE.displayName="DeleteIcon";var ZE=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M10.75 5.75c0-.414-.336-.75-.75-.75s-.75.336-.75.75v3.5h-3.5c-.414 0-.75.336-.75.75s.336.75.75.75h3.5v3.5c0 .414.336.75.75.75s.75-.336.75-.75v-3.5h3.5c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-3.5v-3.5Z"}))};let QE;function $E(e,t){const n=i.useRef(e);(0,i.useEffect)(()=>{const r=n.current;e!==n.current&&(n.current=e,t(e,r))},[e,t])}ZE.displayName="PlusIcon",function(e){e.Default="DEFAULT",e.Filtering="FILTERING",e.EditingColumns="EDITING_COLUMNS"}(QE||(QE={}));var ey={IndexFiltersWrapper:"Polaris-IndexFilters__IndexFiltersWrapper",IndexFilters:"Polaris-IndexFilters",IndexFiltersSticky:"Polaris-IndexFilters__IndexFiltersSticky",IndexFiltersStickyFlush:"Polaris-IndexFilters__IndexFiltersStickyFlush",TabsWrapper:"Polaris-IndexFilters__TabsWrapper",SmallScreenTabsWrapper:"Polaris-IndexFilters__SmallScreenTabsWrapper",TabsWrapperLoading:"Polaris-IndexFilters__TabsWrapperLoading",DesktopLoading:"Polaris-IndexFilters__DesktopLoading",TabsLoading:"Polaris-IndexFilters__TabsLoading",ActionWrap:"Polaris-IndexFilters__ActionWrap",Spinner:"Polaris-IndexFilters__Spinner",ButtonWrap:"Polaris-IndexFilters__ButtonWrap"};function ty(){const[e,t]=(0,i.useState)(!1);return Zs("touchstart",(0,i.useCallback)(()=>t(!0),[])),e}function ny(e){let{acceptCharset:t,action:n,autoComplete:r,children:o,encType:a,implicitSubmit:s=!0,method:c="post",name:l,noValidate:d,preventDefault:u=!0,target:h,onSubmit:p}=e;const m=ji(),f=(0,i.useCallback)(e=>{u&&(e.preventDefault(),p(e))},[p,u]),g=function(e){if(null==e)return e;return e?"on":"off"}(r),_=s?i.createElement(Qi,{as:"span",visuallyHidden:!0},i.createElement("button",{type:"submit","aria-hidden":"true",tabIndex:-1},m.translate("Polaris.Common.submit"))):null;return i.createElement("form",{acceptCharset:t,action:n,autoComplete:g,encType:a,method:c,name:l,noValidate:d,target:h,onSubmit:f},_,o)}function ry(e){let{primaryAction:t,cancelAction:n,viewNames:r,disabled:o}=e;const a=ji(),[s,c]=(0,i.useState)(""),[l,d]=(0,i.useState)(!1),u=(0,i.useRef)(null),h=ty();function p(){d(!1)}async function m(){v||(await(null===t||void 0===t?void 0:t.onAction(s)),p())}(0,i.useEffect)(()=>{u.current&&!h&&l&&Fo(u.current)},[l,h]);const f=(0,i.useMemo)(()=>"save"===(null===t||void 0===t?void 0:t.type)?a.translate("Polaris.IndexFilters.UpdateButtons.save"):a.translate("Polaris.IndexFilters.UpdateButtons.saveAs"),[null===t||void 0===t?void 0:t.type,a]),g=i.createElement(fs,{size:"micro",onClick:async function(){"save-as"===(null===t||void 0===t?void 0:t.type)?d(!0):await(null===t||void 0===t?void 0:t.onAction(""))},disabled:(null===t||void 0===t?void 0:t.disabled)||o},f),_=r.some(e=>e.trim().toLowerCase()===s.trim().toLowerCase()),v=_||!s||(null===t||void 0===t?void 0:t.loading)||s.length>40,b=n?i.createElement(fs,{variant:"tertiary",size:"micro",onClick:n.onAction,disabled:o},a.translate("Polaris.IndexFilters.UpdateButtons.cancel")):null;return t?i.createElement(Bs,{align:"start",blockAlign:"center",gap:"100"},b,"save-as"===t.type?i.createElement(Xl,{activator:i.createElement(Bs,null,g),open:l,title:a.translate("Polaris.IndexFilters.UpdateButtons.modal.title"),onClose:p,primaryAction:{onAction:m,content:a.translate("Polaris.IndexFilters.UpdateButtons.modal.save"),disabled:v},secondaryActions:[{onAction:p,content:a.translate("Polaris.IndexFilters.UpdateButtons.modal.cancel")}]},i.createElement(Xl.Section,null,i.createElement(ny,{onSubmit:m},i.createElement(nd,null,i.createElement("div",{ref:u},i.createElement(Dc,{label:a.translate("Polaris.IndexFilters.UpdateButtons.modal.label"),value:s,onChange:function(e){c(e)},autoComplete:"off",maxLength:40,showCharacterCount:!0,error:_?a.translate("Polaris.IndexFilters.UpdateButtons.modal.sameName",{name:s}):void 0})))))):g):b}var iy=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M7.75 6.06v7.69a.75.75 0 0 1-1.5 0v-7.69l-1.72 1.72a.75.75 0 0 1-1.06-1.06l3-3a.75.75 0 0 1 1.06 0l3 3a.75.75 0 1 1-1.06 1.06l-1.72-1.72Z"}),i.createElement("path",{d:"M13.75 6.25a.75.75 0 0 0-1.5 0v7.69l-1.72-1.72a.75.75 0 1 0-1.06 1.06l3 3a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72v-7.69Z"}))};iy.displayName="SortIcon";var oy="Polaris-ChoiceList__ChoiceChildren",ay={RadioButton:"Polaris-RadioButton",Input:"Polaris-RadioButton__Input",Backdrop:"Polaris-RadioButton__Backdrop",ChoiceLabel:"Polaris-RadioButton__ChoiceLabel",toneMagic:"Polaris-RadioButton--toneMagic"},sy={Choice:"Polaris-Choice",labelHidden:"Polaris-Choice--labelHidden",Label:"Polaris-Choice__Label",Control:"Polaris-Choice__Control",disabled:"Polaris-Choice--disabled",toneMagic:"Polaris-Choice--toneMagic",Descriptions:"Polaris-Choice__Descriptions",HelpText:"Polaris-Choice__HelpText"};function cy(e){let{id:t,label:n,disabled:r,error:o,children:s,labelHidden:c,helpText:l,onClick:d,labelClassName:u,fill:h,bleed:p,bleedBlockStart:m,bleedBlockEnd:f,bleedInlineStart:g,bleedInlineEnd:_,tone:v}=e;const b=qr(sy.Choice,c&&sy.labelHidden,r&&sy.disabled,v&&sy[Xr("tone",v)],u),E=(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},Zr("choice","bleed-block-end","space",f||p)),Zr("choice","bleed-block-start","space",m||p)),Zr("choice","bleed-inline-start","space",g||p)),Zr("choice","bleed-inline-end","space",_||p)),Object.fromEntries(Object.entries(Qr("choice","fill",h)).map(e=>{let[t,n]=e;return[t,n?"100%":"auto"]}))),y=i.createElement("label",{className:b,htmlFor:t,onClick:d,style:Jr(E)},i.createElement("span",{className:sy.Control},s),i.createElement("span",{className:sy.Label},i.createElement(Qi,{as:"span",variant:"bodyMd"},n))),S=l?i.createElement("div",{className:sy.HelpText,id:ly(t)},i.createElement(Qi,{as:"span",tone:r?void 0:"subdued"},l)):null,T=o&&"boolean"!==typeof o&&i.createElement("div",{className:sy.Error},i.createElement(dc,{message:o,fieldID:t})),C=S||T?i.createElement("div",{className:sy.Descriptions},T,S):null;return C?i.createElement("div",null,y,C):y}function ly(e){return"".concat(e,"HelpText")}function dy(e){let{ariaDescribedBy:t,label:n,labelHidden:r,helpText:o,checked:a,disabled:s,onChange:c,onFocus:l,onBlur:d,id:u,name:h,value:p,fill:m,bleed:f,bleedBlockStart:g,bleedBlockEnd:_,bleedInlineStart:v,bleedInlineEnd:b,tone:E}=e;const y=(0,i.useId)(),S=null!==u&&void 0!==u?u:y,T=h||S,C=(0,i.useRef)(null);const w=[];o&&w.push(ly(S)),t&&w.push(t);const R=w.length?w.join(" "):void 0,A=qr(ay.Input,E&&ay[Xr("tone",E)]),I={helpText:o,bleed:f,bleedBlockStart:g,bleedBlockEnd:_,bleedInlineStart:v,bleedInlineEnd:b};return i.createElement(cy,Object.assign({label:n,labelHidden:r,disabled:s,id:S,labelClassName:ay.ChoiceLabel,fill:m},I,a?{tone:E}:{}),i.createElement("span",{className:ay.RadioButton},i.createElement("input",{id:S,name:T,value:p,type:"radio",checked:a,disabled:s,className:A,onChange:function(e){let{currentTarget:t}=e;c&&c(t.checked,S)},onFocus:l,onBlur:()=>{d&&d()},"aria-describedby":R,ref:C}),i.createElement("span",{className:ay.Backdrop})))}var uy=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M5 10c0-.414.336-.75.75-.75h8.5c.414 0 .75.336.75.75s-.336.75-.75.75h-8.5c-.414 0-.75-.336-.75-.75Z"}))};uy.displayName="MinusIcon";const hy=(0,i.createContext)(!1);var py={Checkbox:"Polaris-Checkbox",ChoiceLabel:"Polaris-Checkbox__ChoiceLabel",Backdrop:"Polaris-Checkbox__Backdrop",Input:"Polaris-Checkbox__Input","Input-indeterminate":"Polaris-Checkbox__Input--indeterminate",Icon:"Polaris-Checkbox__Icon",animated:"Polaris-Checkbox--animated",toneMagic:"Polaris-Checkbox--toneMagic",hover:"Polaris-Checkbox--hover",error:"Polaris-Checkbox--error",checked:"Polaris-Checkbox--checked",pathAnimation:"Polaris-Checkbox--pathAnimation"};const my=(0,i.forwardRef)(function(e,t){let{ariaControls:n,ariaDescribedBy:r,label:o,labelHidden:a,checked:s=!1,helpText:c,disabled:l,id:d,name:u,value:h,error:p,onChange:m,onFocus:f,onBlur:g,labelClassName:_,fill:v,bleed:b,bleedBlockStart:E,bleedBlockEnd:y,bleedInlineStart:S,bleedInlineEnd:T,tone:C}=e;const w=(0,i.useRef)(null),R=(0,i.useId)(),A=null!==d&&void 0!==d?d:R,I=(0,i.useContext)(hy);(0,i.useImperativeHandle)(t,()=>({focus:()=>{w.current&&w.current.focus()}}));const N=[];p&&"boolean"!==typeof p&&N.push(uc(A)),c&&N.push(ly(A)),r&&N.push(r);const O=N.length?N.join(" "):void 0,P=qr(py.Checkbox,p&&py.error),k="indeterminate"===s,D=!k&&Boolean(s),x=k?{indeterminate:"true","aria-checked":"mixed"}:{"aria-checked":D},L=i.createElement("svg",{viewBox:"0 0 16 16",shapeRendering:"geometricPrecision",textRendering:"geometricPrecision"},i.createElement("path",{className:qr(s&&py.checked),d:"M1.5,5.5L3.44655,8.22517C3.72862,8.62007,4.30578,8.64717,4.62362,8.28044L10.5,1.5",transform:"translate(2 2.980376)",opacity:"0",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",pathLength:"1"})),M=qr(py.Input,k&&py["Input-indeterminate"],C&&py[Xr("tone",C)]),U={helpText:c,error:p,bleed:b,bleedBlockStart:E,bleedBlockEnd:y,bleedInlineStart:S,bleedInlineEnd:T};return i.createElement(cy,Object.assign({id:A,label:o,labelHidden:a,disabled:l,labelClassName:qr(py.ChoiceLabel,_),fill:v,tone:C},U),i.createElement("span",{className:P},i.createElement("input",Object.assign({ref:w,id:A,name:u,value:h,type:"checkbox",checked:D,disabled:l,className:M,onBlur:()=>{g&&g()},onChange:fy,onClick:()=>{null==m||null==w.current||l||(m(w.current.checked,A),w.current.focus())},onFocus:f,"aria-invalid":null!=p,"aria-controls":n,"aria-describedby":O,role:I?"presentation":"checkbox"},x)),i.createElement("span",{className:py.Backdrop,onClick:gy,onKeyUp:gy}),i.createElement("span",{className:qr(py.Icon,!k&&py.animated)},k?i.createElement($i,{source:uy}):L)))});function fy(){}function gy(e){e.stopPropagation()}function _y(e){let{title:t,titleHidden:n,allowMultiple:r,choices:o,selected:a,onChange:s=vy,error:c,disabled:l=!1,name:d,tone:u}=e;const h=r?my:dy,p=(0,i.useId)(),m=null!==d&&void 0!==d?d:p,f=r?"".concat(m,"[]"):m,g=t?i.createElement(ia,{as:"legend",paddingBlockEnd:{xs:"0",md:"100"}},i.createElement(Qi,{as:"span",variant:"bodyMd",visuallyHidden:n},t)):null,_=o.map(e=>{const{value:t,id:n,label:o,helpText:d,disabled:p,describedByError:g}=e;const _=by(e,a),v=e.renderChildren?e.renderChildren(_):null,b=v?i.createElement("div",{className:oy},i.createElement(ia,{paddingBlockStart:{xs:"400",md:"0"}},v)):null;return i.createElement("li",{key:t},i.createElement(wd,{marginBlockEnd:d?{xs:"100",md:"0"}:{xs:"0"}},i.createElement(h,{name:f,value:t,id:n,label:o,disabled:p||l,fill:{xs:!0,sm:!1},checked:by(e,a),helpText:d,onChange:function(t){s(function(e,t,n){let{value:r}=e,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t)return i?[...n,r]:[r];return n.filter(e=>e!==r)}(e,t,a,r),m)},ariaDescribedBy:c&&g?uc(f):null,tone:u}),b))}),v=c&&i.createElement(ia,{paddingBlockStart:{xs:"0",md:"100"},paddingBlockEnd:"200"},i.createElement(dc,{message:c,fieldID:f}));return i.createElement(qs,{as:"fieldset",gap:{xs:"400",md:"0"},"aria-invalid":null!=c,id:f},g,i.createElement(qs,{as:"ul",gap:{xs:"400",md:"0"}},_),v)}function vy(){}function by(e,t){let{value:n}=e;return t.includes(n)}var Ey=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M10 16.5a.75.75 0 0 1-.75-.75v-9.69l-2.72 2.72a.75.75 0 1 1-1.06-1.06l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06l-2.72-2.72v9.69a.75.75 0 0 1-.75.75Z"}))};Ey.displayName="ArrowUpIcon";var yy=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M10 3.5a.75.75 0 0 1 .75.75v9.69l2.72-2.72a.75.75 0 0 1 1.06 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 0 1 1.06-1.06l2.72 2.72v-9.69a.75.75 0 0 1 .75-.75Z"}))};yy.displayName="ArrowDownIcon";var Sy="Polaris-SortButton-DirectionButton",Ty="Polaris-SortButton-DirectionButton__DirectionButton--active";function Cy(e){let{onClick:t,active:n,children:r,direction:o,value:a}=e;const s=qr(Sy,n&&Ty);return i.createElement(ms,{className:s,onClick:function(){t([a])}},i.createElement($i,{source:"asc"===o?Ey:yy,tone:"base"}),i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium"},r))}let wy;function Ry(e){var t,n,r,o;let{choices:a,selected:s,onChange:c,disabled:l,onChangeKey:d,onChangeDirection:u}=e;const h=ji(),[p,m]=(0,i.useState)(!1),[f,g]=s[0].split(" ");function _(e){if(u){const[,t]=e[0].split(" ");u(t)}else c(e)}const v=(0,i.useMemo)(()=>a.reduce((e,t)=>{const n=e.some(e=>e.label===t.label),[,r]=t.value.split(" ");return n?r===g?e.map(e=>e.label===t.label?t:e):e:[...e,t]},[]),[a,g]),b=a.filter(e=>{const[t]=e.value.split(" ");return t===f}),E=i.createElement(Fs,{content:h.translate("Polaris.IndexFilters.SortButton.tooltip"),preferredPosition:"above",hoverDelay:400},i.createElement(fs,{size:"slim",icon:iy,onClick:function(){m(e=>!e)},disabled:l,accessibilityLabel:h.translate("Polaris.IndexFilters.SortButton.ariaLabel")}));return i.createElement(ts,{active:p&&!l,activator:E,autofocusTarget:"first-node",onClose:function(){m(!1)},preferredAlignment:"right",fluidContent:!0},i.createElement(ia,{minWidth:"148px",paddingInlineStart:"300",paddingInlineEnd:"300",paddingBlockStart:"200",paddingBlockEnd:"200",borderBlockEndWidth:"025",borderColor:"border-secondary"},i.createElement(_y,{title:h.translate("Polaris.IndexFilters.SortButton.title"),choices:v,selected:s,onChange:function(e){if(d){const[t]=e[0].split(" ");d(t)}else c(e)}})),i.createElement(ia,{paddingInlineStart:"150",paddingInlineEnd:"150",paddingBlockStart:"200",paddingBlockEnd:"200"},i.createElement(Cy,{direction:"asc",active:g===wy.Asc,onClick:_,value:null===b||void 0===b||null===(t=b[0])||void 0===t?void 0:t.value},null===b||void 0===b||null===(n=b[0])||void 0===n?void 0:n.directionLabel),i.createElement(Cy,{direction:"desc",active:g===wy.Desc,onClick:_,value:null===b||void 0===b||null===(r=b[1])||void 0===r?void 0:r.value},null===b||void 0===b||null===(o=b[1])||void 0===o?void 0:o.directionLabel)))}!function(e){e.Asc="asc",e.Desc="desc"}(wy||(wy={}));var Ay="Polaris-IndexFilters-Container";const Iy=e=>{let{children:t}=e;return i.createElement("div",{className:Ay},t)};function Ny(e){const t=(0,i.useRef)();return(0,i.useEffect)(()=>{t.current=e},[e]),t.current}function Oy(e,t,n,r,i){const o=r.reduce((e,t)=>e+t,0),a=e.map((e,t)=>t),s=[],c=[];if(i>o)s.push(...a);else{s.push(t);let e=r[t];a.forEach(o=>{if(o!==t){const t=r[o];if(e+t>=i-n)return void c.push(o);s.push(o),e+=t}})}return{visibleTabs:s,hiddenTabs:c}}var Py={Outer:"Polaris-Tabs__Outer",Wrapper:"Polaris-Tabs__Wrapper",WrapperWithNewButton:"Polaris-Tabs__WrapperWithNewButton",ButtonWrapper:"Polaris-Tabs__ButtonWrapper",Tabs:"Polaris-Tabs",Tab:"Polaris-Tabs__Tab","Tab-active":"Polaris-Tabs__Tab--active","Tab-hasActions":"Polaris-Tabs__Tab--hasActions","Tab-iconOnly":"Polaris-Tabs__Tab--iconOnly",fillSpace:"Polaris-Tabs--fillSpace",TabContainer:"Polaris-Tabs__TabContainer",fitted:"Polaris-Tabs--fitted",titleWithIcon:"Polaris-Tabs--titleWithIcon",List:"Polaris-Tabs__List",Item:"Polaris-Tabs__Item",DisclosureTab:"Polaris-Tabs__DisclosureTab","DisclosureTab-visible":"Polaris-Tabs__DisclosureTab--visible",DisclosureActivator:"Polaris-Tabs__DisclosureActivator",TabsMeasurer:"Polaris-Tabs__TabsMeasurer",NewTab:"Polaris-Tabs__NewTab",ActionListWrap:"Polaris-Tabs__ActionListWrap",Panel:"Polaris-Tabs__Panel","Panel-hidden":"Polaris-Tabs__Panel--hidden"},ky=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M3 6.75c0-2.071 1.679-3.75 3.75-3.75h6.5c2.071 0 3.75 1.679 3.75 3.75v6.5c0 2.071-1.679 3.75-3.75 3.75h-6.5c-2.071 0-3.75-1.679-3.75-3.75v-6.5Zm3.75-2.25c-1.243 0-2.25 1.007-2.25 2.25v6.5c0 1.243 1.007 2.25 2.25 2.25h.5v-11h-.5Zm4.5 11h-2.5v-11h2.5v11Zm1.5 0h.5c1.243 0 2.25-1.007 2.25-2.25v-6.5c0-1.243-1.007-2.25-2.25-2.25h-.5v11Z"}))};ky.displayName="LayoutColumns3Icon";function Dy(e){let{open:t,isModalLoading:n,name:r,onClose:o,onClickPrimaryAction:a,onClickSecondaryAction:s,helpText:c,viewNames:l}=e;const d=ji(),[u,h]=(0,i.useState)(r),p=(0,i.useRef)(null),m=null===l||void 0===l?void 0:l.some(e=>e.trim().toLowerCase()===u.trim().toLowerCase()),f=n||m||!u||u.length>40;(0,i.useEffect)(()=>{p.current&&t&&Fo(p.current)},[t]),(0,i.useEffect)(()=>{t&&h(r.slice(0,40))},[r,t]);const g=(0,i.useCallback)(e=>{h(e)},[]);async function _(){f||(await a(u),h(""),o())}return i.createElement(Xl,{open:t,onClose:o,title:d.translate("Polaris.Tabs.DuplicateModal.title"),primaryAction:{content:d.translate("Polaris.Tabs.DuplicateModal.create"),onAction:_,disabled:f},secondaryActions:[{content:d.translate("Polaris.Tabs.DuplicateModal.cancel"),onAction:function(){null===s||void 0===s||s(),h(r),o()}}],instant:!0},i.createElement(Xl.Section,null,i.createElement(ny,{onSubmit:_},i.createElement(nd,null,i.createElement("div",{ref:p},i.createElement(Dc,{label:d.translate("Polaris.Tabs.DuplicateModal.label"),value:u,onChange:g,autoComplete:"off",helpText:c,maxLength:40,showCharacterCount:!0,error:m?d.translate("Polaris.Tabs.DuplicateModal.errors.sameName",{name:u}):void 0}))))))}function xy(e){let{open:t,isModalLoading:n,name:r,onClose:o,onClickPrimaryAction:a,onClickSecondaryAction:s,helpText:c,viewNames:l}=e;const d=ji(),[u,h]=(0,i.useState)(r),p=(0,i.useRef)(null),m=null===l||void 0===l?void 0:l.filter(e=>e!==r).some(e=>e.trim().toLowerCase()===u.trim().toLowerCase()),f=n||m||u===r||!u;(0,i.useEffect)(()=>{p.current&&t&&Fo(p.current)},[t]),(0,i.useEffect)(()=>{t&&h(r)},[r,t]);const g=(0,i.useCallback)(e=>{h(e)},[]);async function _(){f||(await a(u),h(""),o())}return i.createElement(Xl,{open:t,onClose:o,title:d.translate("Polaris.Tabs.RenameModal.title"),primaryAction:{content:d.translate("Polaris.Tabs.RenameModal.create"),onAction:_,disabled:f},secondaryActions:[{content:d.translate("Polaris.Tabs.RenameModal.cancel"),onAction:function(){null===s||void 0===s||s(),h(r),o()}}],instant:!0},i.createElement(Xl.Section,null,i.createElement(ny,{onSubmit:_},i.createElement(nd,null,i.createElement("div",{ref:p},i.createElement(Dc,{label:d.translate("Polaris.Tabs.RenameModal.label"),value:u,onChange:g,autoComplete:"off",helpText:c,maxLength:40,showCharacterCount:!0,error:m?d.translate("Polaris.Tabs.RenameModal.errors.sameName",{name:u}):void 0}))))))}const Ly=["type","onAction","onPrimaryAction"],My=(0,i.forwardRef)((e,t)=>{let{content:n,accessibilityLabel:r,badge:s,id:c,panelID:l,url:d,onAction:u,actions:h,disabled:p,isModalLoading:m,icon:f,siblingTabHasFocus:g,measuring:_,focused:v,selected:b,onToggleModal:E,onTogglePopover:y,viewNames:S,tabIndexOverride:T,onFocus:C}=e;const w=ji(),[R,A]=(0,i.useState)(!1),[I,N]=(0,i.useState)(null),O=(0,i.useRef)(b),P=(0,i.useRef)(!1),k=(0,i.useRef)(null);let D;(0,i.useEffect)(()=>{y(R)},[R,y]),(0,i.useEffect)(()=>{E(Boolean(I))},[I,E]),(0,i.useEffect)(()=>()=>{E(!1),y(!1)},[E,y]),(0,i.useEffect)(()=>{if(_)return;(v||document.activeElement&&document.activeElement.id===c)&&b&&null!=l&&!P.current&&(Uy(l),P.current=!0),b&&!O.current&&null!=l?Uy(l):v&&null!=k.current&&null==I&&!p&&Fo(k.current),O.current=b},[v,c,n,_,l,b,I,p]),D=!b||g||_?v&&!_?0:-1:0,null!=T&&(D=T);const x=null===h||void 0===h?void 0:h.find(e=>"rename"===e.type),L=null===h||void 0===h?void 0:h.find(e=>"duplicate"===e.type),M=null===h||void 0===h?void 0:h.find(e=>"delete"===e.type),U=(0,i.useCallback)(()=>{null!==h&&void 0!==h&&h.length&&A(e=>!e)},[h]),F=(0,i.useCallback)(()=>{p||(b?U():null===u||void 0===u||u())},[b,u,U,p]),j=()=>{N(null)},V=(0,i.useCallback)(async e=>{var t;await(null===x||void 0===x||null===(t=x.onPrimaryAction)||void 0===t?void 0:t.call(x,e)),setTimeout(()=>{k.current&&Fo(k.current)},250)},[x]),B=(0,i.useCallback)(async()=>{var e;await(null===M||void 0===M||null===(e=M.onPrimaryAction)||void 0===e?void 0:e.call(M,n)),j()},[M,n]),W=(0,i.useCallback)(async e=>{var t;await(null===L||void 0===L||null===(t=L.onPrimaryAction)||void 0===t?void 0:t.call(L,e))},[L]),H={rename:{icon:yu,content:w.translate("Polaris.Tabs.Tab.rename")},duplicate:{icon:XE,content:w.translate("Polaris.Tabs.Tab.duplicate")},edit:{icon:qE,content:w.translate("Polaris.Tabs.Tab.edit")},"edit-columns":{icon:ky,content:w.translate("Polaris.Tabs.Tab.editColumns")},delete:{icon:JE,content:w.translate("Polaris.Tabs.Tab.delete"),destructive:!0}},G=null===h||void 0===h?void 0:h.map(e=>{let{type:t,onAction:r,onPrimaryAction:i}=e,s=(0,o.A)(e,Ly);const c=!t.includes("edit");return(0,a.A)((0,a.A)((0,a.A)({},H[t]),s),{},{onAction:()=>{null===r||void 0===r||r(n),U(),c&&(e=>{N(e)})(t)}})}),z=(0,i.useCallback)(e=>{" "===e.key&&(e.preventDefault(),F())},[F]),K=qr(Py.TabContainer,b&&Py.Underline),Y=p||b?void 0:d,q=Y?yo:ms,X=qr(Py.Tab,f&&Py["Tab-iconOnly"],R&&Py["Tab-popoverActive"],b&&Py["Tab-active"],b&&(null===h||void 0===h?void 0:h.length)&&Py["Tab-hasActions"]),J=s?i.createElement(Po,{tone:b?void 0:"new"},s):null,Z=b&&null!==h&&void 0!==h&&h.length?i.createElement("div",{className:qr(Py.IconWrap)},i.createElement($i,{source:cs})):null,Q=i.createElement(q,{id:c,className:X,tabIndex:D,"aria-selected":b,"aria-controls":l,"aria-label":r,role:null==T?"tab":void 0,disabled:p,url:Y,onFocus:C,onMouseUp:Lo,onClick:F,onKeyDown:z},i.createElement(Bs,{gap:"200",align:"center",blockAlign:"center",wrap:!1},i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium"},null!==f&&void 0!==f?f:n),J),Z),$=!b||!(null!==h&&void 0!==h&&h.length),ee=x?i.createElement(xy,{name:n,open:"rename"===I,onClose:j,onClickPrimaryAction:V,isModalLoading:m,viewNames:S}):null,te=L?i.createElement(Dy,{open:"duplicate"===I,name:w.translate("Polaris.Tabs.Tab.copy",{name:n}),onClose:j,onClickPrimaryAction:W,isModalLoading:m,viewNames:S||[]}):null,ne=M?i.createElement(Xl,{open:"delete"===I,onClose:j,primaryAction:{content:w.translate("Polaris.Tabs.Tab.deleteModal.delete"),onAction:B,destructive:!0,disabled:m},secondaryActions:[{content:w.translate("Polaris.Tabs.Tab.deleteModal.cancel"),onAction:j}],title:w.translate("Polaris.Tabs.Tab.deleteModal.title"),instant:!0},i.createElement(Xl.Section,null,w.translate("Polaris.Tabs.Tab.deleteModal.description",{viewName:n}))):null,re=$||p?Q:i.createElement(i.Fragment,null,i.createElement(ts,{active:R,activator:Q,autofocusTarget:"first-node",onClose:U},i.createElement("div",{className:Py.ActionListWrap},i.createElement(Lc,{actionRole:"menuitem",items:G}))),ee,te,ne);return f?re:i.createElement("li",{className:K,ref:(ie=[k,t],e=>{for(const t of ie)null!=t&&(t.current=e)}),role:"presentation"},re);var ie});function Uy(e){const t=document.getElementById(e);t&&t.focus({preventScroll:!0})}My.displayName="Tab";const Fy=(0,i.memo)(function(e){let{selected:t,tabs:n,activator:r,tabToFocus:o,siblingTabHasFocus:a,handleMeasurement:s}=e;const c=(0,i.useRef)(null),l=(0,i.useRef)(null),d=(0,i.useCallback)(()=>{l.current&&cancelAnimationFrame(l.current),l.current=requestAnimationFrame(()=>{if(!c.current)return;const e=c.current.offsetWidth-20-28,t=c.current.children,n=Array.from(t).map(e=>Math.ceil(e.getBoundingClientRect().width)+4),r=n.pop()||0;s({containerWidth:e,disclosureWidth:r,hiddenTabWidths:n})})},[s]);(0,i.useEffect)(()=>{d()},[d,n]),la(()=>{0});const u=n.map((e,n)=>i.createElement(My,{measuring:!0,key:"$".concat(e.id,"Hidden"),id:"".concat(e.id,"Measurer"),siblingTabHasFocus:a,focused:n===o,selected:n===t,url:e.url,content:e.content,onTogglePopover:jy,onToggleModal:jy})),h=qr(Py.Tabs,Py.TabsMeasurer);return Zs("resize",d),i.createElement("div",{className:h,ref:c},u,r)});function jy(){}function Vy(e){let{hidden:t,id:n,tabID:r,children:o}=e;const a=qr(Py.Panel,t&&Py["Panel-hidden"]);return i.createElement("div",{className:a,id:n,role:"tabpanel","aria-labelledby":r,tabIndex:-1},o)}const By=(0,i.memo)(function(e){let{id:t,focused:n,children:r,url:o,accessibilityLabel:a,onClick:s=Wy}=e;const c=(0,i.useRef)(null);(0,i.useEffect)(()=>{c.current&&c.current instanceof HTMLElement&&n&&c.current.focus()},[c,n]);const l=qr(Py.Item),d={id:t,ref:c,onClick:s,className:l,"aria-selected":!1,"aria-label":a},u=o?i.createElement(yo,Object.assign({},d,{url:o}),r):i.createElement("button",Object.assign({},d,{ref:c,type:"button"}),r);return i.createElement("li",null,u)});function Wy(){}const Hy=["id","content"];function Gy(e){let{focusIndex:t,disclosureTabs:n,onClick:r=zy,onKeyPress:a=zy}=e;const s=n.map((e,n)=>{let{id:a,content:s}=e,c=(0,o.A)(e,Hy);return i.createElement(By,Object.assign({key:a},c,{id:a,focused:n===t,onClick:r.bind(null,a)}),s)});return i.createElement("ul",{className:Py.List,onKeyDown:Ky,onKeyUp:a},s)}function zy(){}function Ky(e){const{key:t}=e;"ArrowLeft"!==t&&"ArrowRight"!==t||(e.preventDefault(),e.stopPropagation())}function Yy(e){let{activator:t,open:n,onClose:r,onClickPrimaryAction:o,onClickSecondaryAction:a,viewNames:s}=e;const c=ji(),[l,d]=(0,i.useState)(""),[u,h]=(0,i.useState)(!1),p=(0,i.useRef)(null),m=ty(),f=s.some(e=>e.trim().toLowerCase()===l.trim().toLowerCase()),g=!l||f||u||l.length>40;(0,i.useEffect)(()=>{if(p.current&&!m&&n){Fo(p.current);const e=setTimeout(()=>{p.current&&Fo(p.current)},50);return()=>clearTimeout(e)}},[n,m]);const _=(0,i.useCallback)(e=>{d(e)},[]);async function v(){f||g||(h(!0),await o(l),h(!1),d(""),r())}return i.createElement(Xl,{activator:t,open:n,onClose:r,title:c.translate("Polaris.Tabs.CreateViewModal.title"),primaryAction:{content:c.translate("Polaris.Tabs.CreateViewModal.create"),onAction:v,disabled:g},secondaryActions:[{content:c.translate("Polaris.Tabs.CreateViewModal.cancel"),onAction:function(){null===a||void 0===a||a(),d(""),r()}}]},i.createElement(Xl.Section,null,i.createElement(ny,{onSubmit:v},i.createElement(nd,null,i.createElement("div",{ref:p},i.createElement(Dc,{label:c.translate("Polaris.Tabs.CreateViewModal.label"),value:l,onChange:_,autoComplete:"off",maxLength:40,showCharacterCount:!0,error:f?c.translate("Polaris.Tabs.CreateViewModal.errors.sameName",{name:l}):void 0}))))))}const qy=e=>{let{tabs:t,children:n,selected:r,newViewAccessibilityLabel:o,canCreateNewView:s,disabled:c,onCreateNewView:l,onSelect:d,fitted:u,disclosureText:h}=e;const p=ji(),{mdDown:m}=Xi(),f=(0,i.useRef)(null),g=(0,i.useRef)(null),_=(0,i.useRef)(null),[v,b]=(0,i.useReducer)((e,t)=>(0,a.A)((0,a.A)({},e),t),{disclosureWidth:0,containerWidth:1/0,tabWidths:[],visibleTabs:[],hiddenTabs:[],showDisclosure:!1,tabToFocus:-1,isNewViewModalActive:!1,modalSubmitted:!1,isTabsFocused:!1,isTabPopoverOpen:!1,isTabModalOpen:!1}),{tabToFocus:E,visibleTabs:y,hiddenTabs:S,showDisclosure:T,isNewViewModalActive:C,modalSubmitted:w,disclosureWidth:R,tabWidths:A,containerWidth:I,isTabsFocused:N,isTabModalOpen:O,isTabPopoverOpen:P}=v,k=Ny(O),D=Ny(P);(0,i.useEffect)(()=>{(k&&!O||D&&!P&&!O)&&b({isTabsFocused:!0,tabToFocus:r})},[D,P,k,O,r,E]);const x=(0,i.useCallback)(e=>b({isTabPopoverOpen:e}),[]),L=(0,i.useCallback)(e=>b({isTabModalOpen:e}),[]),M=(0,i.useCallback)(e=>{const n=t.find(t=>t.id===e);if(null==n)return null;const r=t.indexOf(n);null===d||void 0===d||d(r)},[t,d]),U=(0,i.useCallback)((e,o)=>{const a=t.map(e=>{let{content:t}=e;return t}),s=e.panelID||"".concat(e.id,"-panel");return i.createElement(My,Object.assign({},e,{key:"".concat(o,"-").concat(e.id),id:e.id,panelID:n?s:void 0,disabled:c||e.disabled,siblingTabHasFocus:E>-1,focused:o===E,selected:o===r,onAction:()=>{var t;M(e.id),null===(t=e.onAction)||void 0===t||t.call(e)},accessibilityLabel:e.accessibilityLabel,url:e.url,content:e.content,onToggleModal:L,onTogglePopover:x,viewNames:a,ref:o===r?_:null}))},[c,M,t,n,r,E,L,x]),F=(0,i.useCallback)(e=>{const t=e.target,n=t.classList.contains(Py.Item),r=t.closest("[data-tabs-focus-catchment]")||n;!t.classList.contains(Py.DisclosureActivator)&&r&&b({isTabsFocused:!0})},[]),j=(0,i.useCallback)(e=>{var t,n,r;const i=e.target,o=e.relatedTarget,a=null===o||void 0===o||null===(t=o.closest)||void 0===t?void 0:t.call(o,".".concat(Py.Tabs)),s=null===i||void 0===i||null===(n=i.classList)||void 0===n||null===(r=n.contains)||void 0===r?void 0:r.call(n,Py.Tab),c=null===o||void 0===o?void 0:o.classList.contains(Py.Item);b((o||O||s||c)&&(a||O||s||c)?{isTabsFocused:!1}:{tabToFocus:-1})},[O]);(0,i.useEffect)(()=>{const{visibleTabs:e,hiddenTabs:n}=Oy(t,r,R,A,I);b({visibleTabs:e,hiddenTabs:n})},[I,R,t,r,A,b]);const V=(0,i.useCallback)(()=>{var e;const t=null===(e=_.current)||void 0===e?void 0:e.querySelector(".".concat(Py["Tab-active"]));t&&G(t.offsetLeft)},[]);(0,i.useEffect)(()=>{m&&V()},[V,r,m]),(0,i.useEffect)(()=>{if(N&&!T){b({tabToFocus:r})}},[N,r,b,T]);const B=e=>{const{showDisclosure:t,visibleTabs:n,hiddenTabs:r,tabToFocus:i,isNewViewModalActive:o}=v;if(O||P||o)return;const a=e.key,s=t||m?n.concat(r):[...n];let c=s.indexOf(i);"ArrowRight"===a&&(c+=1,c===s.length&&(c=0)),"ArrowLeft"===a&&(-1===c||0===c?c=s.length-1:c-=1);const l=s[c];null!=l&&b({tabToFocus:l})},W=()=>{b({showDisclosure:!1})},H=(0,i.useCallback)(e=>{const{hiddenTabWidths:n,containerWidth:i,disclosureWidth:o}=e,{visibleTabs:a,hiddenTabs:s}=Oy(t,r,o,n,i);b({visibleTabs:a,hiddenTabs:s,disclosureWidth:o,containerWidth:i,tabWidths:n})},[t,r,b]),G=e=>{setTimeout(()=>{if(f.current&&"function"===typeof f.current.scroll){var t,n;const r=(null===g||void 0===g||null===(t=g.current)||void 0===t?void 0:t.offsetLeft)||0;null===f||void 0===f||null===(n=f.current)||void 0===n||n.scroll({left:e-r})}},0)},z=o||p.translate("Polaris.Tabs.newViewAccessibilityLabel"),K=m?[...y,...S]:y,Y=K.sort((e,t)=>e-t).filter(e=>t[e]).map(e=>U(t[e],e)),q=y.length<t.length&&!m,X=qr(Py.Tabs,u&&Py.fitted,q&&Py.fillSpace),J=qr(Py.Wrapper,s&&Py.WrapperWithNewButton),Z=qr(Py.DisclosureTab,q&&Py["DisclosureTab-visible"]),Q=qr(Py.DisclosureActivator),$=i.createElement(i.Fragment,null,i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium"},null!==h&&void 0!==h?h:p.translate("Polaris.Tabs.toggleTabsLabel")),i.createElement("div",{className:qr(Py.IconWrap,q&&T&&Py["IconWrap-open"])},i.createElement($i,{source:cs,tone:"subdued"}))),ee=i.createElement(ms,{type:"button",className:Q,onClick:()=>{b({showDisclosure:!T,tabToFocus:S[0]})},"aria-label":null!==h&&void 0!==h?h:p.translate("Polaris.Tabs.toggleTabsLabel"),disabled:c},$),te=S.map(e=>t[e]),ne=t.map(e=>{let{content:t}=e;return t}),re=i.createElement(Fy,{tabToFocus:E,activator:ee,selected:r,tabs:t,siblingTabHasFocus:E>-1,handleMeasurement:H}),ie=i.createElement(My,{id:"create-new-view",content:z,actions:[],onAction:()=>{b({isNewViewModalActive:!0})},onFocus:()=>{w&&b({tabToFocus:r,modalSubmitted:!1})},icon:i.createElement($i,{source:ZE,accessibilityLabel:z}),disabled:c,onTogglePopover:x,onToggleModal:L,tabIndexOverride:0}),oe=n?t.map((e,o)=>r===o?i.createElement(Vy,{id:t[o].panelID||"".concat(t[o].id,"-panel"),tabID:t[o].id,key:t[o].id},n):i.createElement(Vy,{id:t[o].panelID||"".concat(t[o].id,"-panel"),tabID:t[o].id,key:t[o].id,hidden:!0})):null;return i.createElement("div",{className:Py.Outer},i.createElement(ia,{padding:{md:"200"}},re,i.createElement("div",{className:J,ref:f},i.createElement("div",{className:Py.ButtonWrapper,ref:g},i.createElement("ul",{role:Y.length>0?"tablist":void 0,className:X,onFocus:F,onBlur:j,onKeyDown:e=>{if(P||O||C)return;const{key:t}=e;"ArrowLeft"!==t&&"ArrowRight"!==t||(e.preventDefault(),e.stopPropagation())},onKeyUp:B,"data-tabs-focus-catchment":!0},Y,m||0===K.length?null:i.createElement("li",{className:Z,role:"presentation"},i.createElement(ts,{preferredPosition:"below",preferredAlignment:"left",activator:ee,active:q&&T,onClose:W,autofocusTarget:"first-node"},i.createElement(Gy,{focusIndex:S.indexOf(E),disclosureTabs:te,onClick:e=>{M(e),W(),b({isTabsFocused:!0})},onKeyPress:B})))),s&&K.length>0?i.createElement("div",{className:Py.NewTab},i.createElement(Yy,{open:C,onClose:()=>{b({isNewViewModalActive:!1})},onClickPrimaryAction:async e=>{if(!l)return!1;const t=await(null===l||void 0===l?void 0:l(e));return t&&b({modalSubmitted:!0}),t},viewNames:ne,activator:c?ie:i.createElement("div",null,i.createElement(Fs,{content:p.translate("Polaris.Tabs.newViewTooltip"),preferredPosition:"above",hoverDelay:400},ie))})):null))),oe)};var Xy=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M3 6a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5h-12.5a.75.75 0 0 1-.75-.75Z"}),i.createElement("path",{d:"M6.75 14a.75.75 0 0 1 .75-.75h5a.75.75 0 0 1 0 1.5h-5a.75.75 0 0 1-.75-.75Z"}),i.createElement("path",{d:"M5.5 9.25a.75.75 0 0 0 0 1.5h9a.75.75 0 0 0 0-1.5h-9Z"}))};function Jy(e){let{onClick:t,label:n,disabled:r,tooltipContent:o,style:a,hideFilters:s,hideQueryField:c}=e;const l=i.createElement(Bs,{gap:"0"},c?null:i.createElement($i,{source:Oi,tone:"base"}),s?null:i.createElement($i,{source:Xy,tone:"base"})),d=i.createElement("div",{style:a},i.createElement(fs,{size:"slim",onClick:t,disabled:r,icon:l,accessibilityLabel:n})),u=i.createElement(Qi,{as:"span",variant:"bodyMd",alignment:"center"},o);return i.createElement(Fs,{content:u,preferredPosition:"above",hoverDelay:400},d)}Xy.displayName="FilterIcon";var Zy={Container:"Polaris-Filters__Container",SearchField:"Polaris-Filters__SearchField",FiltersWrapper:"Polaris-Filters__FiltersWrapper",hideQueryField:"Polaris-Filters--hideQueryField",FiltersInner:"Polaris-Filters__FiltersInner",AddFilter:"Polaris-Filters__AddFilter",FiltersWrapperWithAddButton:"Polaris-Filters__FiltersWrapperWithAddButton",AddFilterActivatorMultiple:"Polaris-Filters__AddFilterActivatorMultiple",FiltersStickyArea:"Polaris-Filters__FiltersStickyArea",ClearAll:"Polaris-Filters__ClearAll",MultiplePinnedFilterClearAll:"Polaris-Filters__MultiplePinnedFilterClearAll"};function Qy(e){let{onChange:t,onClear:n,onFocus:r,onBlur:o,focused:a,value:s,placeholder:c,disabled:l,borderlessQueryField:d,loading:u,selectedViewName:h}=e;const p=ji(),m=(0,i.useId)(),{mdUp:f}=Xi(),g=s&&h&&f?i.createElement(Qi,{as:"span",variant:"bodyMd",tone:"subdued"},p.translate("Polaris.Filters.searchInView",{viewName:h})):null;return i.createElement(Dc,{id:m,value:s,onChange:function(e){t(null!==e&&void 0!==e?e:s)},onFocus:r,onBlur:o,onClearButtonClick:function(){n?n():t("")},autoComplete:"off",placeholder:c,disabled:l,variant:d?"borderless":"inherit",size:"slim",prefix:f?i.createElement($i,{source:Oi}):void 0,suffix:g,focused:a,label:c,labelHidden:!0,clearButton:!0,autoSize:Boolean(g),loading:u})}var $y={FilterButton:"Polaris-Filters-FilterPill__FilterButton",focusedFilterButton:"Polaris-Filters-FilterPill--focusedFilterButton",ActiveFilterButton:"Polaris-Filters-FilterPill__ActiveFilterButton",PlainButton:"Polaris-Filters-FilterPill__PlainButton",ToggleButton:"Polaris-Filters-FilterPill__ToggleButton",clearButton:"Polaris-Filters-FilterPill--clearButton",IconWrapper:"Polaris-Filters-FilterPill__IconWrapper",PopoverWrapper:"Polaris-Filters-FilterPill__PopoverWrapper",ClearButtonWrapper:"Polaris-Filters-FilterPill__ClearButtonWrapper"};function eS(e){let{unsavedChanges:t=!1,filterKey:n,label:r,filter:o,disabled:a,hideClearButton:s,selected:c,initialActive:l,closeOnChildOverlayClick:d,onRemove:u,onClick:h}=e;const p=ji(),m=(0,i.useRef)(null),{value:f,setTrue:g,setFalse:_}=ti(!1),[v,b]=(0,i.useState)(l);(0,i.useEffect)(()=>{var e,t;const n=m.current;if(!n||!v)return;const r=null===(e=n.parentElement)||void 0===e?void 0:e.parentElement;r&&(null===(t=r.scroll)||void 0===t||t.call(r,{left:n.offsetLeft}))},[m,v]);const E=(0,i.useCallback)(()=>{o&&b(e=>!e),h&&h(n)},[o,n,h]),y=(0,i.useCallback)(()=>{E(),c||null===u||void 0===u||u(n)},[u,c,n,E]),S=()=>{u&&u(n),b(!1)},T=qr($y.FilterButton,c&&$y.ActiveFilterButton,v&&$y.FocusFilterButton,f&&$y.focusedFilterButton),C=qr($y.PlainButton,$y.clearButton),w=qr($y.PlainButton,$y.ToggleButton),R=c?null:i.createElement("div",{className:$y.IconWrapper},i.createElement($i,{source:cs,tone:"base"})),A=i.createElement(ia,{paddingInlineStart:t?"0":"050"},i.createElement(Bs,null,i.createElement(Qi,{variant:"bodySm",as:"span"},r))),I=t?i.createElement(ia,{paddingInlineEnd:"150"},i.createElement(ia,{background:"bg-fill-emphasis",borderRadius:"050",width:"6px",minHeight:"6px"})):null,N=c?i.createElement(ms,{onClick:S,className:C,type:"button","aria-label":p.translate("Polaris.FilterPill.clear")},i.createElement("div",{className:$y.IconWrapper},i.createElement($i,{source:Zu,tone:"base"}))):null,O=i.createElement("div",{className:T},i.createElement(Bs,{gap:"0",wrap:!1},i.createElement(ms,{onFocus:g,onBlur:_,onClick:E,className:w,type:"button",accessibilityLabel:t?p.translate("Polaris.FilterPill.unsavedChanges",{label:r}):r},i.createElement(Bs,{wrap:!1,align:"center",blockAlign:"center",gap:"0"},I,A,R)),N)),P=!s&&i.createElement("div",{className:$y.ClearButtonWrapper},i.createElement(fs,{onClick:S,variant:"plain",disabled:!c,textAlign:"left"},p.translate("Polaris.FilterPill.clear")));return a?null:i.createElement("div",{ref:m},i.createElement(ts,{active:v,activator:O,key:n,onClose:y,preferredAlignment:"left",preventCloseOnChildOverlayClick:!d},i.createElement("div",{className:$y.PopoverWrapper},i.createElement(ts.Section,null,i.createElement(qs,{gap:"100"},o,P)))))}const tS=["key"];function nS(e){let{filters:t,appliedFilters:n,onClearAll:r,disabled:s,hideQueryField:c,disableFilters:l,mountedStateStyles:d,onAddFilterClick:u,closeOnChildOverlayClick:h,children:p}=e;const m=ji(),[f,g]=(0,i.useState)(!1),_=(0,i.useRef)(!1);(0,i.useEffect)(()=>{_.current=!0});const v=()=>g(e=>!e),b=null===n||void 0===n?void 0:n.map(e=>{let{key:t}=e;return t}),E=t.filter(e=>{let{pinned:t}=e;return t}).map(e=>{let{key:t}=e;return t}),y=t.filter(e=>{let{pinned:t,key:n}=e;return Boolean(t)||(null===b||void 0===b?void 0:b.includes(n))}),[S,T]=(0,i.useState)(y.map(e=>{let{key:t}=e;return t}));$E(t.length,()=>{T(y.map(e=>{let{key:t}=e;return t}))});const C=S.map(e=>t.find(t=>t.key===e)).reduce((e,t)=>t?[...e,t]:e,[]),w=e=>{let{key:t,onAction:n}=e;return()=>{setTimeout(()=>{T(e=>[...new Set([...e,t])]),null===n||void 0===n||n(),v()},0)}},R=e=>(0,a.A)((0,a.A)({},e),{},{content:e.label,onAction:w(e)}),A=t.filter(e=>!C.some(t=>{let{key:n}=t;return n===e.key})),I=A.filter(e=>!e.section&&!e.hidden).map(R),N=A.filter(e=>e.section).reduce((e,t)=>{const n=R(t),r=e.findIndex(e=>e.title===t.section);return-1===r?e.push({title:t.section,items:[n]}):e[r].items.push(n),e},[]),O=C.length>=1,P=i.createElement("div",null,i.createElement(ms,{type:"button",className:Zy.AddFilter,onClick:()=>{null===u||void 0===u||u(),v()},"aria-label":m.translate("Polaris.Filters.addFilter"),disabled:s||0===I.length&&0===N.length||l},i.createElement(Qi,{as:"span",variant:"bodySm",tone:s?"disabled":"base"},m.translate("Polaris.Filters.addFilter")," "),i.createElement(ZE,null))),k=t.some(e=>!e.pinned)||t.length!==S.length,D=C.map(e=>{let{key:t}=e,r=(0,o.A)(e,tS);const a=null===n||void 0===n?void 0:n.find(e=>{let{key:n}=e;return n===t});return i.createElement(eS,Object.assign({key:t},r,{initialActive:_.current&&!r.pinned&&!a,unsavedChanges:null===a||void 0===a?void 0:a.unsavedChanges,label:(null===a||void 0===a?void 0:a.label)||r.label,filterKey:t,selected:null===b||void 0===b?void 0:b.includes(t),onRemove:()=>{T(e=>e.filter(e=>{const n=e===t,r=E.includes(e);return!n||r})),null===a||void 0===a||a.onRemove(t)},disabled:r.disabled||l,closeOnChildOverlayClick:h}))}),x=k?i.createElement("div",{className:qr(Zy.AddFilterActivator,O&&Zy.AddFilterActivatorMultiple)},i.createElement(ts,{active:f&&!s,activator:P,onClose:v},i.createElement(Lc,{actionRole:"menuitem",items:I,sections:N}))):null,L=null!==n&&void 0!==n&&n.length?i.createElement("div",{className:qr(Zy.ClearAll,O&&k&&Zy.MultiplePinnedFilterClearAll)},i.createElement(fs,{size:"micro",onClick:()=>{T(E),null===r||void 0===r||r()},variant:"monochromePlain"},m.translate("Polaris.Filters.clearFilters"))):null;return i.createElement("div",{className:qr(Zy.FiltersWrapper,k&&O&&Zy.FiltersWrapperWithAddButton),"aria-live":"polite",style:d},i.createElement("div",{className:qr(Zy.FiltersInner)},i.createElement("div",{className:qr(Zy.FiltersStickyArea)},D,x,L)),c?i.createElement(ia,{paddingInlineEnd:"300",paddingBlockStart:"200",paddingBlockEnd:"200"},i.createElement(Bs,{align:"start",blockAlign:"center",gap:{xs:"400",md:"300"}},p)):null)}const rS="var(--p-motion-duration-150)",iS="-36px",oS={transition:"opacity ".concat(rS," var(--p-motion-ease)"),opacity:0},aS={entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0},unmounted:{opacity:0}},sS={transition:"opacity ".concat(rS," var(--p-motion-ease), margin ").concat(rS," var(--p-motion-ease)"),opacity:0,marginTop:iS},cS={entering:{opacity:1,marginTop:0},entered:{opacity:1,marginTop:0},exiting:{opacity:0,marginTop:iS},exited:{opacity:0,marginTop:iS},unmounted:{opacity:0,marginTop:iS}};function lS(e){let{queryValue:t,queryPlaceholder:n,focused:r,filters:o,appliedFilters:s,onQueryChange:c,onQueryClear:l,onQueryBlur:d,onQueryFocus:u,onClearAll:h,children:p,disabled:m,hideFilters:f,hideQueryField:g,disableQueryField:_,borderlessQueryField:v,loading:b,disableFilters:E,mountedState:y,onAddFilterClick:S,closeOnChildOverlayClick:T,selectedViewName:C}=e;const w=f||0===o.length,R=g?null:i.createElement("div",{className:Zy.Container},i.createElement(ia,{padding:"200"},i.createElement(Bs,{align:"start",blockAlign:"center",gap:{xs:"400",md:"300"}},i.createElement("div",{className:Zy.SearchField,style:y?(0,a.A)((0,a.A)({},oS),aS[y]):void 0},i.createElement(Qy,{onChange:c,onFocus:u,onBlur:d,onClear:l,value:t,placeholder:n,focused:r,disabled:m||_,borderlessQueryField:v,loading:b,selectedViewName:C})),p))),A=y&&!g?(0,a.A)((0,a.A)({},sS),cS[y]):void 0,I=w?null:i.createElement(nS,{filters:o,appliedFilters:s,onClearAll:h,disabled:m,hideQueryField:g,disableFilters:E,onAddFilterClick:S,closeOnChildOverlayClick:T,mountedStateStyles:A},p);return i.createElement("div",{className:qr(Zy.Filters,g&&Zy.hideQueryField)},R,I)}function dS(e){let{onClick:t,disabled:n}=e;const r=ji(),o=i.createElement(Qi,{as:"span",variant:"bodyMd",alignment:"center"},r.translate("Polaris.IndexFilters.EditColumnsButton.tooltip"));return i.createElement(Fs,{content:o,preferredPosition:"above",hoverDelay:400},i.createElement(fs,{size:"slim",onClick:t,disabled:n,icon:ky,accessibilityLabel:r.translate("Polaris.IndexFilters.EditColumnsButton.accessibilityLabel")}))}const uS=["INPUT","SELECT","TEXTAREA"],hS={transition:"opacity ".concat(150,"ms var(--p-motion-ease)"),opacity:0},pS={entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0},unmounted:{opacity:0}};function mS(e){let{tabs:t,selected:n,onSelect:r,onSort:o,onSortKeyChange:s,onSortDirectionChange:c,onAddFilterClick:l,sortOptions:d,sortSelected:u,queryValue:h="",queryPlaceholder:p,primaryAction:m,cancelAction:f,filters:g,appliedFilters:_,onClearAll:v,onQueryChange:b,onQueryFocus:E,onQueryClear:y,onEditStart:S,disabled:T,disableQueryField:C,hideFilters:w,loading:R,mode:A,setMode:I,disableStickyMode:N,isFlushWhenSticky:O=!1,canCreateNewView:P=!0,onCreateNewView:k,filteringAccessibilityLabel:D,filteringAccessibilityTooltip:x,hideQueryField:L,closeOnChildOverlayClick:M,disableKeyboardShortcuts:U,showEditColumnsButton:F,autoFocusSearchField:j=!0}=e;const V=ji(),{mdDown:B}=Xi(),W=(0,i.useRef)(null),H=(0,i.useRef)(null),{value:G,setFalse:z,setTrue:K}=ti(A===QE.Filtering&&j);$E(A,e=>{e===QE.Filtering&&j?K():z()}),Zs("keydown",e=>{var t;if(U||L&&w)return;const{key:n}=e,r=null===(t=document)||void 0===t||null===(t=t.activeElement)||void 0===t?void 0:t.tagName;if(A!==QE.Default&&"Escape"===e.key&&(null===f||void 0===f||f.onAction(),I(QE.Default)),"f"===n&&A===QE.Default){if(r&&uS.includes(r))return;!function(){if(A!==QE.Default)return;ae(QE.Filtering)}(),e.preventDefault()}});const{intersectionRef:Y,measurerRef:q,indexFilteringHeight:X,isSticky:J}=function(e,t,n){const r="undefined"!==typeof window&&Boolean(window.IntersectionObserver),o={root:null,rootMargin:"".concat(n?"0px":"-56px"," 0px 0px 0px"),threshold:0},[a,s]=(0,i.useState)(0),[c,l]=(0,i.useState)(!1),d=(0,i.useRef)(null),u=(0,i.useRef)(null),h=(0,i.useRef)(r?new IntersectionObserver(e=>{e.forEach(e=>{l(!e.isIntersecting)})},o):null);return(0,i.useEffect)(()=>{function e(){const e=d.current;if(!e)return{height:0};const t=e.getBoundingClientRect().height;s(t)}e();const t=aa(e,250,{trailing:!0});return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[d,e]),(0,i.useEffect)(()=>{const e=h.current;if(!e)return;const t=u.current;return t&&e.observe(t),()=>{null===e||void 0===e||e.disconnect()}},[u]),{intersectionRef:u,measurerRef:d,isSticky:c&&!t,indexFilteringHeight:a}}(A,Boolean(N),O),Z=t.map(e=>{let{content:t}=e;return t}),Q=(0,i.useCallback)(e=>{null===o||void 0===o||o(e)},[o]),$=(0,i.useCallback)(e=>{b(e)},[b]),ee=(te=null===m||void 0===m?void 0:m.onAction,(0,i.useCallback)(async e=>{await(null===te||void 0===te?void 0:te(e))&&(I(QE.Default),null===ne||void 0===ne||ne())},[te,ne]));var te,ne;const re=(0,i.useCallback)(()=>{var e;null===f||void 0===f||null===(e=f.onAction)||void 0===e||e.call(f),I(QE.Default)},[f,I]),ie=(0,i.useMemo)(()=>m?(0,a.A)((0,a.A)({},m),{},{onAction:ee}):void 0,[ee,m]),oe=(0,i.useMemo)(()=>f?(0,a.A)((0,a.A)({},f),{},{onAction:re}):void 0,[f,re]),ae=(0,i.useCallback)(e=>{I(e),null===S||void 0===S||S(e)},[S,I]),se=(0,i.useMemo)(()=>oe||ie?i.createElement(ry,{primaryAction:ie,cancelAction:oe,viewNames:Z,disabled:T}):null,[ie,oe,T,Z]),ce=(0,i.useMemo)(()=>null!==d&&void 0!==d&&d.length?i.createElement(Ry,{choices:d,selected:u,onChange:Q,onChangeKey:s,onChangeDirection:c,disabled:T}):null,[Q,c,s,d,u,T]);const le=F?i.createElement(dS,{onClick:function(){ae(QE.EditingColumns)},disabled:T}):null,de=(null===m||void 0===m?void 0:m.loading)||(null===f||void 0===f?void 0:f.loading);function ue(){ae(QE.Filtering)}const he=U?"Polaris.IndexFilters.searchFilterTooltip":"Polaris.IndexFilters.searchFilterTooltipWithShortcut",pe=x||V.translate(he),me=D||V.translate("Polaris.IndexFilters.searchFilterAccessibilityLabel"),fe=R||de;function ge(){null===y||void 0===y||y()}function _e(){z()}function ve(){K(),null===E||void 0===E||E()}return i.createElement("div",{className:ey.IndexFiltersWrapper,style:{height:X}},i.createElement("div",{ref:Y}),i.createElement("div",{className:qr(ey.IndexFilters,J&&ey.IndexFiltersSticky,J&&O&&ey.IndexFiltersStickyFlush),ref:q},i.createElement(Cl,{nodeRef:W,in:A!==QE.Filtering,timeout:150},e=>i.createElement("div",{ref:W},A!==QE.Filtering?i.createElement(Iy,null,i.createElement(Bs,{align:"start",blockAlign:"center",gap:{xs:"0",md:"200"},wrap:!1},i.createElement("div",{className:qr(ey.TabsWrapper,B&&ey.SmallScreenTabsWrapper,fe&&ey.TabsWrapperLoading)},i.createElement("div",{className:ey.TabsInner,style:(0,a.A)((0,a.A)({},hS),pS[e])},i.createElement(qy,{tabs:t,selected:n,onSelect:r,disabled:Boolean(A!==QE.Default||T),canCreateNewView:P,onCreateNewView:k})),fe&&B&&i.createElement("div",{className:ey.TabsLoading},i.createElement(hs,{size:"small"}))),i.createElement("div",{className:ey.ActionWrap},fe&&!B&&i.createElement("div",{className:ey.DesktopLoading},fe?i.createElement(hs,{size:"small"}):null),A===QE.Default?i.createElement(i.Fragment,null,w&&L?null:i.createElement(Jy,{onClick:ue,label:me,tooltipContent:pe,disabled:T,hideFilters:w,hideQueryField:L,style:(0,a.A)((0,a.A)({},hS),pS[e])}),le,ce):null,A===QE.EditingColumns?se:null))):null)),i.createElement(Cl,{nodeRef:H,in:A===QE.Filtering,timeout:150},e=>i.createElement("div",{ref:H},A===QE.Filtering?i.createElement(lS,{queryValue:h,queryPlaceholder:p,onQueryChange:$,onQueryClear:ge,onQueryFocus:ve,onQueryBlur:_e,onAddFilterClick:l,filters:g,appliedFilters:_,onClearAll:v,disableFilters:T,hideFilters:w,hideQueryField:L,disableQueryField:T||C,loading:R||de,focused:G,mountedState:B?void 0:e,borderlessQueryField:!0,closeOnChildOverlayClick:M},i.createElement("div",{className:ey.ButtonWrap},i.createElement(Bs,{gap:"200",align:"start",blockAlign:"center"},i.createElement("div",{style:(0,a.A)((0,a.A)({},hS),pS[e])},se),ce))):null))))}var fS=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillRule:"evenodd",d:"M9.116 4.323a1.25 1.25 0 0 1 1.768 0l2.646 2.647a.75.75 0 0 1-1.06 1.06l-2.47-2.47-2.47 2.47a.75.75 0 1 1-1.06-1.06l2.646-2.647Z"}),i.createElement("path",{fillOpacity:.33,fillRule:"evenodd",d:"M9.116 15.677a1.25 1.25 0 0 0 1.768 0l2.646-2.647a.75.75 0 0 0-1.06-1.06l-2.47 2.47-2.47-2.47a.75.75 0 0 0-1.06 1.06l2.646 2.647Z"}))};fS.displayName="SortAscendingIcon";var gS=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{fillOpacity:.33,fillRule:"evenodd",d:"M9.116 4.823a1.25 1.25 0 0 1 1.768 0l2.646 2.647a.75.75 0 0 1-1.06 1.06l-2.47-2.47-2.47 2.47a.75.75 0 1 1-1.06-1.06l2.646-2.647Z"}),i.createElement("path",{fillRule:"evenodd",d:"M9.116 15.177a1.25 1.25 0 0 0 1.768 0l2.646-2.647a.75.75 0 0 0-1.06-1.06l-2.47 2.47-2.47-2.47a.75.75 0 0 0-1.06 1.06l2.646 2.647Z"}))};gS.displayName="SortDescendingIcon";var _S={IndexTable:"Polaris-IndexTable",IndexTableWrapper:"Polaris-IndexTable__IndexTableWrapper","IndexTableWrapper-scrollBarHidden":"Polaris-IndexTable__IndexTableWrapper--scrollBarHidden",IndexTableWrapperWithSelectAllActions:"Polaris-IndexTable__IndexTableWrapperWithSelectAllActions","LoadingContainer-enter":"Polaris-IndexTable__LoadingContainer--enter","LoadingContainer-enter-active":"Polaris-IndexTable--loadingContainerEnterActive","LoadingContainer-exit":"Polaris-IndexTable__LoadingContainer--exit","LoadingContainer-exit-active":"Polaris-IndexTable--loadingContainerExitActive",LoadingPanel:"Polaris-IndexTable__LoadingPanel",LoadingPanelRow:"Polaris-IndexTable__LoadingPanelRow",LoadingPanelText:"Polaris-IndexTable__LoadingPanelText",Table:"Polaris-IndexTable__Table","Table-scrolling":"Polaris-IndexTable__Table--scrolling","TableCell-first":"Polaris-IndexTable__TableCell--first","StickyTable-scrolling":"Polaris-IndexTable__StickyTable--scrolling",TableCell:"Polaris-IndexTable__TableCell","TableHeading-first":"Polaris-IndexTable__TableHeading--first","TableHeading-second":"Polaris-IndexTable__TableHeading--second","Table-sticky":"Polaris-IndexTable__Table--sticky",StickyTable:"Polaris-IndexTable__StickyTable","Table-unselectable":"Polaris-IndexTable__Table--unselectable",TableRow:"Polaris-IndexTable__TableRow","TableRow-unclickable":"Polaris-IndexTable__TableRow--unclickable",toneSuccess:"Polaris-IndexTable--toneSuccess","TableRow-child":"Polaris-IndexTable__TableRow--child",toneWarning:"Polaris-IndexTable--toneWarning",toneCritical:"Polaris-IndexTable--toneCritical",toneSubdued:"Polaris-IndexTable--toneSubdued","TableRow-subheader":"Polaris-IndexTable__TableRow--subheader","TableRow-selected":"Polaris-IndexTable__TableRow--selected","TableRow-hovered":"Polaris-IndexTable__TableRow--hovered","TableRow-disabled":"Polaris-IndexTable__TableRow--disabled",ZebraStriping:"Polaris-IndexTable__ZebraStriping",TableHeading:"Polaris-IndexTable__TableHeading","TableHeading-flush":"Polaris-IndexTable__TableHeading--flush","TableHeading-align-center":"Polaris-IndexTable--tableHeadingAlignCenter","TableHeading-align-end":"Polaris-IndexTable--tableHeadingAlignEnd","TableHeading-extra-padding-right":"Polaris-IndexTable--tableHeadingExtraPaddingRight","TableHeading-sortable":"Polaris-IndexTable__TableHeading--sortable",TableHeadingSortButton:"Polaris-IndexTable__TableHeadingSortButton",TableHeadingSortIcon:"Polaris-IndexTable__TableHeadingSortIcon","TableHeadingSortButton-heading-align-end":"Polaris-IndexTable--tableHeadingSortButtonHeadingAlignEnd","TableHeadingSortButton-heading-align-end-currently-sorted":"Polaris-IndexTable--tableHeadingSortButtonHeadingAlignEndCurrentlySorted","TableHeadingSortIcon-heading-align-end":"Polaris-IndexTable--tableHeadingSortIconHeadingAlignEnd","TableHeadingSortButton-heading-align-end-previously-sorted":"Polaris-IndexTable--tableHeadingSortButtonHeadingAlignEndPreviouslySorted","right-aligned-sort-button-slide-out":"Polaris-IndexTable--rightAlignedSortButtonSlideOut","reveal-right-aligned-sort-button-icon":"Polaris-IndexTable--revealRightAlignedSortButtonIcon",TableHeadingUnderline:"Polaris-IndexTable__TableHeadingUnderline",TableHeadingTooltipUnderlinePlaceholder:"Polaris-IndexTable__TableHeadingTooltipUnderlinePlaceholder","TableHeadingSortIcon-visible":"Polaris-IndexTable__TableHeadingSortIcon--visible",TableHeadingSortSvg:"Polaris-IndexTable__TableHeadingSortSvg",SortableTableHeadingWithCustomMarkup:"Polaris-IndexTable__SortableTableHeadingWithCustomMarkup",SortableTableHeaderWrapper:"Polaris-IndexTable__SortableTableHeaderWrapper",ColumnHeaderCheckboxWrapper:"Polaris-IndexTable__ColumnHeaderCheckboxWrapper",FirstStickyHeaderElement:"Polaris-IndexTable__FirstStickyHeaderElement","TableHeading-unselectable":"Polaris-IndexTable__TableHeading--unselectable","TableCell-flush":"Polaris-IndexTable__TableCell--flush","Table-sticky-scrolling":"Polaris-IndexTable--tableStickyScrolling","StickyTableHeader-sticky-scrolling":"Polaris-IndexTable--stickyTableHeaderStickyScrolling","TableHeading-last":"Polaris-IndexTable__TableHeading--last","Table-sticky-last":"Polaris-IndexTable--tableStickyLast","StickyTableHeader-sticky-last":"Polaris-IndexTable--stickyTableHeaderStickyLast","Table-sortable":"Polaris-IndexTable__Table--sortable",StickyTableHeader:"Polaris-IndexTable__StickyTableHeader","StickyTableHeader-isSticky":"Polaris-IndexTable__StickyTableHeader--isSticky",StickyTableHeadings:"Polaris-IndexTable__StickyTableHeadings","StickyTableHeading-second":"Polaris-IndexTable__StickyTableHeading--second",unselectable:"Polaris-IndexTable--unselectable","StickyTableHeading-second-scrolling":"Polaris-IndexTable--stickyTableHeadingSecondScrolling",ScrollLeft:"Polaris-IndexTable__ScrollLeft",ScrollRight:"Polaris-IndexTable__ScrollRight","ScrollRight-onboarding":"Polaris-IndexTable__ScrollRight--onboarding",SelectAllActionsWrapper:"Polaris-IndexTable__SelectAllActionsWrapper",SelectAllActionsWrapperWithPagination:"Polaris-IndexTable__SelectAllActionsWrapperWithPagination",SelectAllActionsWrapperSticky:"Polaris-IndexTable__SelectAllActionsWrapperSticky",SelectAllActionsWrapperAtEnd:"Polaris-IndexTable__SelectAllActionsWrapperAtEnd",SelectAllActionsWrapperAtEndAppear:"Polaris-IndexTable__SelectAllActionsWrapperAtEndAppear",BulkActionsWrapper:"Polaris-IndexTable__BulkActionsWrapper",BulkActionsWrapperVisible:"Polaris-IndexTable__BulkActionsWrapperVisible",PaginationWrapper:"Polaris-IndexTable__PaginationWrapper",PaginationWrapperScrolledPastTop:"Polaris-IndexTable__PaginationWrapperScrolledPastTop",ScrollBarContainer:"Polaris-IndexTable__ScrollBarContainer",ScrollBarContainerWithPagination:"Polaris-IndexTable__ScrollBarContainerWithPagination",ScrollBarContainerScrolledPastTop:"Polaris-IndexTable__ScrollBarContainerScrolledPastTop",ScrollBarContainerWithSelectAllActions:"Polaris-IndexTable__ScrollBarContainerWithSelectAllActions",ScrollBarContainerSelectAllActionsSticky:"Polaris-IndexTable__ScrollBarContainerSelectAllActionsSticky",scrollBarContainerCondensed:"Polaris-IndexTable--scrollBarContainerCondensed",scrollBarContainerHidden:"Polaris-IndexTable--scrollBarContainerHidden",ScrollBar:"Polaris-IndexTable__ScrollBar",disableTextSelection:"Polaris-IndexTable--disableTextSelection",EmptySearchResultWrapper:"Polaris-IndexTable__EmptySearchResultWrapper",condensedRow:"Polaris-IndexTable--condensedRow",CondensedList:"Polaris-IndexTable__CondensedList",HeaderWrapper:"Polaris-IndexTable__HeaderWrapper","StickyTable-condensed":"Polaris-IndexTable__StickyTable--condensed","StickyTableHeader-condensed":"Polaris-IndexTable__StickyTableHeader--condensed",ScrollBarContent:"Polaris-IndexTable__ScrollBarContent"};const vS="All";let bS;!function(e){e.All="all",e.Page="page",e.Multi="multi",e.Single="single",e.Range="range"}(bS||(bS={}));const ES=(0,i.createContext)(void 0),yS=(0,i.createContext)(void 0),SS=(0,i.createContext)(void 0);function TS(){const e=(0,i.useContext)(yS);if(!e)throw new Error("Missing IndexProvider context");return e}function CS(){const e=(0,i.useContext)(ES);if(!e)throw new Error("Missing IndexProvider context");return e}function wS(e){let{children:t,resourceName:n,loading:r,onSelectionChange:o,selectedItemsCount:a=0,itemCount:s,hasMoreItems:c,condensed:l,selectable:d=!0,paginatedSelectAllText:u}=e;const{paginatedSelectAllText:h,bulkActionsLabel:p,bulkActionsAccessibilityLabel:m,resourceName:f,selectMode:g,bulkSelectState:_}=function(e){let{selectedItemsCount:t,itemCount:n,hasMoreItems:r,resourceName:i,defaultPaginatedSelectAllText:o}=e;const a=ji(),s=Boolean(t),c="All"===t||t>0,l={singular:a.translate("Polaris.IndexProvider.defaultItemSingular"),plural:a.translate("Polaris.IndexProvider.defaultItemPlural")},d=i||l,u=function(){if(s&&r)return t===vS?o||a.translate("Polaris.IndexProvider.allItemsSelected",{itemsLength:n,resourceNamePlural:d.plural.toLocaleLowerCase()}):void 0}(),h=function(){const e=t===vS?"".concat(n,"+"):t;return a.translate("Polaris.IndexProvider.selected",{selectedItemsCount:e})}(),p=function(){const e=n,r=t===e;return 1===e&&r?a.translate("Polaris.IndexProvider.a11yCheckboxDeselectAllSingle",{resourceNameSingular:d.singular}):1===e?a.translate("Polaris.IndexProvider.a11yCheckboxSelectAllSingle",{resourceNameSingular:d.singular}):r?a.translate("Polaris.IndexProvider.a11yCheckboxDeselectAllMultiple",{itemsLength:n,resourceNamePlural:d.plural}):a.translate("Polaris.IndexProvider.a11yCheckboxSelectAllMultiple",{itemsLength:n,resourceNamePlural:d.plural})}();let m="indeterminate";return t&&0!==t?t!==vS&&t!==n||(m=!0):m=void 0,{paginatedSelectAllText:u,bulkActionsLabel:h,bulkActionsAccessibilityLabel:p,resourceName:d,selectMode:c,bulkSelectState:m,selectable:s}}({selectedItemsCount:a,itemCount:s,hasMoreItems:c,resourceName:n,defaultPaginatedSelectAllText:u}),v=function(e){let{onSelectionChange:t=()=>{}}=e;const n=(0,i.useRef)(null);return(0,i.useCallback)((e,r,i,o)=>{const a=n.current;if(bS.Multi&&"number"===typeof o&&(n.current=o),e===bS.Single||e===bS.Multi&&("number"!==typeof a||"number"!==typeof o))t(bS.Single,r,i);else if(e===bS.Multi){const n=Math.min(a,o),i=Math.max(a,o);t(e,r,[n,i])}else e===bS.Page||e===bS.All?t(e,r):e===bS.Range&&t(bS.Range,r,i)},[t])}({onSelectionChange:o}),b=(0,i.useMemo)(()=>({itemCount:s,selectMode:g&&d,selectable:d,resourceName:f,loading:r,paginatedSelectAllText:h,hasMoreItems:c,bulkActionsLabel:p,bulkActionsAccessibilityLabel:m,bulkSelectState:_,selectedItemsCount:a,condensed:l}),[s,g,d,f,r,h,c,p,m,_,a,l]),E=(0,i.useMemo)(()=>({selectable:d,selectMode:g&&d,condensed:l}),[l,g,d]);return i.createElement(ES.Provider,{value:b},i.createElement(SS.Provider,{value:E},i.createElement(yS.Provider,{value:v},t)))}const RS=(0,i.memo)(function(e){let{children:t,className:n,flush:r,colSpan:o,headers:a,scope:s,as:c="td",id:l}=e;const d=qr(n,_S.TableCell,r&&_S["TableCell-flush"]);return i.createElement(c,{id:l,colSpan:o,headers:a,scope:s,className:d},t)});var AS="Polaris-IndexTable-Checkbox__TableCellContentContainer",IS="Polaris-IndexTable-Checkbox__Wrapper";const NS=(0,i.createContext)({}),OS=(0,i.createContext)(void 0),PS={scrollableContainer:null,canScrollLeft:!1,canScrollRight:!1},kS=(0,i.createContext)(PS),DS=(0,i.memo)(function(e){let{accessibilityLabel:t}=e;const n=ji(),{resourceName:r}=CS(),{itemId:o,selected:a,disabled:s,onInteraction:c}=(0,i.useContext)(NS),l=t||n.translate("Polaris.IndexTable.selectItem",{resourceName:r.singular});return i.createElement(xS,null,i.createElement("div",{className:AS},i.createElement("div",{className:IS,onClick:c,onKeyUp:LS},i.createElement(my,{id:"Select-".concat(o),label:l,labelHidden:!0,checked:a,disabled:s}))))});function xS(e){let{children:t}=e;const{position:n}=(0,i.useContext)(NS),r=(0,i.useRef)(null),o=(0,i.useCallback)(aa(()=>{if(0!==n||!r.current)return;const{width:e}=r.current.getBoundingClientRect();!function(e,t,n){if(!document)return;(n||document.documentElement).style.setProperty(e,t)}("--pc-checkbox-offset","".concat(e,"px"))}),[n]);(0,i.useEffect)(()=>{o()},[o]),(0,i.useEffect)(()=>{if(r.current)return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[o]);const a=qr(_S.TableCell,_S["TableCell-first"]);return i.createElement("td",{className:a,ref:r},t)}function LS(){}const MS=(0,i.memo)(function(e){let{children:t,selected:n,id:r,position:o,tone:a,disabled:s,selectionRange:c,rowType:l="data",accessibilityLabel:d,onNavigation:u,onClick:h}=e;const{selectable:p,selectMode:m,condensed:f}=function(){const e=(0,i.useContext)(SS);if(!e)throw new Error("Missing IndexProvider context");return e}(),g=TS(),{value:_,setTrue:v,setFalse:b}=ti(!1),E=(0,i.useCallback)(e=>{e.stopPropagation();let t=bS.Single;if("key"in e&&" "!==e.key||!g)return;e.nativeEvent.shiftKey?t=bS.Multi:c&&(t=bS.Range);g(t,!n,null!==c&&void 0!==c?c:r,o)},[r,g,n,c,o]),y=(0,i.useMemo)(()=>({itemId:r,selected:n,position:o,onInteraction:E,disabled:s}),[r,n,s,o,E]),S=(0,i.useRef)(null),T=(0,i.useRef)(!1),C=(0,i.useRef)(null),w=(0,i.useCallback)(e=>{C.current=e;const t=null===e||void 0===e?void 0:e.querySelector("[data-primary-link]");t&&(S.current=t)},[]),R=qr(_S.TableRow,"subheader"===l&&_S["TableRow-subheader"],"child"===l&&_S["TableRow-child"],p&&f&&_S.condensedRow,n&&_S["TableRow-selected"],_&&!f&&_S["TableRow-hovered"],s&&_S["TableRow-disabled"],a&&_S[Xr("tone",a)],!p&&!h&&!S.current&&_S["TableRow-unclickable"]);let A;(!s&&p||h||S.current)&&(A=e=>{if("subheader"!==l&&C.current&&!T.current)if(e.stopPropagation(),e.preventDefault(),h)h();else if(S.current&&!m){T.current=!0;const{ctrlKey:t,metaKey:n}=e.nativeEvent;if(u&&u(r),(t||n)&&S.current instanceof HTMLAnchorElement)return T.current=!1,void window.open(S.current.href,"_blank");S.current.dispatchEvent(new MouseEvent(e.type,e.nativeEvent))}else T.current=!1,E(e)});const I=f?"li":"tr",N=p?i.createElement(DS,{accessibilityLabel:d}):null;return i.createElement(NS.Provider,{value:y},i.createElement(OS.Provider,{value:_},i.createElement(I,{key:r,id:r,className:R,onMouseEnter:v,onMouseLeave:b,onClick:A,ref:w},N,t)))});function US(e,t){return e?Array.from(e.querySelectorAll(t)):[]}function FS(e){let{title:t,description:n,withIllustration:r}=e;const o=ji().translate("Polaris.EmptySearchResult.altText"),a=n?i.createElement("p",null,n):null,s=r?i.createElement(jc,{alt:o,source:"data:image/svg+xml,%3csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' d='M41.87 24a17.87 17.87 0 11-35.74 0 17.87 17.87 0 0135.74 0zm-3.15 18.96a24 24 0 114.24-4.24L59.04 54.8a3 3 0 11-4.24 4.24L38.72 42.96z' fill='%238C9196'/%3e%3c/svg%3e",draggable:!1}):null;return i.createElement(is,{alignment:"center",vertical:!0},s,i.createElement(Qi,{variant:"headingLg",as:"p"},t),i.createElement(Qi,{tone:"subdued",as:"span"},a))}var jS="Polaris-IndexTable-ScrollContainer";function VS(e){let{children:t,scrollableContainerRef:n,onScroll:r}=e;(0,i.useEffect)(()=>{n.current&&n.current.dispatchEvent(new Event("scroll"))},[n]);const[o,a]=(0,i.useState)(PS),s=(0,i.useCallback)(aa(()=>{if(!n.current)return;const e=n.current.scrollWidth-n.current.offsetWidth,t=n.current.scrollLeft>0,i=n.current.scrollLeft<e;r(t,i),a({scrollableContainer:n.current,canScrollLeft:t,canScrollRight:i})},40,{trailing:!0,leading:!0,maxWait:40}),[r,n]);return i.createElement(kS.Provider,{value:o},i.createElement("div",{className:jS,ref:n,onScroll:s},t))}function BS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const i=n.reduce((e,t)=>e+t,0),o=e.map((e,t)=>t),a=[],s=[];if(r>i)a.push(...o);else{let e=0,i=!1;o.forEach(o=>{const c=n[o];if(e+c>=r-t||i)return s.push(o),void(i=!0);a.push(o),e+=c})}return{visiblePromotedActions:a,hiddenPromotedActions:s}}function WS(e){return"title"in e&&"actions"in e}function HS(e){if(!e)return!1;for(const n of e)for(const e of n.items){var t;if("new"===(null===(t=e.badge)||void 0===t?void 0:t.tone))return!0}return!1}var GS={BulkActionsOuterLayout:"Polaris-BulkActions__BulkActionsOuterLayout",BulkActionsSelectAllWrapper:"Polaris-BulkActions__BulkActionsSelectAllWrapper",BulkActionsPromotedActionsWrapper:"Polaris-BulkActions__BulkActionsPromotedActionsWrapper",BulkActionsLayout:"Polaris-BulkActions__BulkActionsLayout","BulkActionsLayout--measuring":"Polaris-BulkActions--bulkActionsLayoutMeasuring",BulkActionsMeasurerLayout:"Polaris-BulkActions__BulkActionsMeasurerLayout",BulkActionButton:"Polaris-BulkActions__BulkActionButton",disabled:"Polaris-BulkActions--disabled",AllAction:"Polaris-BulkActions__AllAction"},zS="Polaris-Indicator",KS="Polaris-Indicator--pulseIndicator";function YS(e){let{pulse:t=!0}=e;const n=qr(zS,t&&KS);return i.createElement("span",{className:n})}function qS(e){let{handleMeasurement:t,url:n,external:r,onAction:o,content:a,disclosure:s,accessibilityLabel:c,disabled:l,destructive:d,indicator:u,showContentInButton:h,size:p}=e;const m=(0,i.useRef)(null);la(()=>{if(t&&m.current){const e=m.current.getBoundingClientRect().width;t(e)}});const f=s&&!h,g=f?void 0:a,_=i.createElement(fs,{external:r,url:n,accessibilityLabel:f?a:c,tone:d?"critical":void 0,disclosure:s&&h,onClick:o,disabled:l,size:p,icon:f?i.createElement($i,{source:Id,tone:"base"}):void 0},g);return i.createElement("div",{className:GS.BulkActionButton,ref:m},f?i.createElement(Fs,{content:a,preferredPosition:"below"},_):_,u&&i.createElement(YS,null))}function XS(e){let{title:t,actions:n,isNewBadgeInBadgeActions:r,size:o}=e;const{value:a,toggle:s}=ti(!1);return i.createElement(i.Fragment,null,i.createElement(ts,{active:a,activator:i.createElement(qS,{disclosure:!0,showContentInButton:!0,onAction:s,content:t,indicator:r,size:o}),onClose:s,preferInputActivator:!0},i.createElement(Lc,{items:n,onActionAnyItem:s})))}var JS="Polaris-CheckableButton",ZS="Polaris-CheckableButton__Checkbox",QS="Polaris-CheckableButton__Label";const $S=(0,i.forwardRef)(function(e,t){let{accessibilityLabel:n,label:r="",onToggleAll:o,selected:a,disabled:s,ariaLive:c}=e;const l=(0,i.useRef)(null);function d(){var e;null===l||void 0===l||null===(e=l.current)||void 0===e||e.focus()}return(0,i.useImperativeHandle)(t,()=>({focus:d})),i.createElement("div",{className:JS,onClick:o},i.createElement("div",{className:ZS},i.createElement(my,{label:n,labelHidden:!0,checked:a,disabled:s,onChange:o,ref:l})),r?i.createElement("span",{className:QS,"aria-live":c},i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium"},r)):null)});function eT(e){let{promotedActions:t=[],disabled:n,buttonSize:r,handleMeasurement:o}=e;const a=ji(),s=(0,i.useRef)(null),c=a.translate("Polaris.ResourceList.BulkActions.moreActionsActivatorLabel"),l=i.createElement(qS,{disclosure:!0,content:c}),d=(0,i.useCallback)(()=>{if(!s.current)return;const e=s.current.offsetWidth,t=s.current.children,n=Array.from(t).map(e=>Math.ceil(e.getBoundingClientRect().width)+4),r=n.pop()||0;o({containerWidth:e,disclosureWidth:r,hiddenActionsWidths:n})},[o]);(0,i.useEffect)(()=>{d()},[d,t]);const u=t.map((e,t)=>WS(e)?i.createElement(qS,{key:t,disclosure:!0,showContentInButton:!0,content:e.title,size:r}):i.createElement(qS,Object.assign({key:t,disabled:n},e,{size:r})));return Zs("resize",d),i.createElement("div",{className:GS.BulkActionsMeasurerLayout,ref:s},u,l)}const tT=(0,i.forwardRef)(function(e,t){let{promotedActions:n,actions:r,disabled:o,buttonSize:s,paginatedSelectAllAction:c,paginatedSelectAllText:l,label:d,accessibilityLabel:u,selected:h,onToggleAll:p,onMoreActionPopoverToggle:m,width:f,selectMode:g}=e;const _=ji(),[v,b]=(0,i.useState)(!1),[E,y]=(0,i.useReducer)((e,t)=>(0,a.A)((0,a.A)({},e),t),{disclosureWidth:0,containerWidth:1/0,actionsWidths:[],visiblePromotedActions:[],hiddenPromotedActions:[],hasMeasured:!1}),{visiblePromotedActions:S,hiddenPromotedActions:T,containerWidth:C,disclosureWidth:w,actionsWidths:R,hasMeasured:A}=E;(0,i.useEffect)(()=>{if(0===C||!n||0===n.length)return;const{visiblePromotedActions:e,hiddenPromotedActions:t}=BS(n,w,R,C);y({visiblePromotedActions:e,hiddenPromotedActions:t,hasMeasured:C!==1/0})},[C,w,n,R]);const I=!n||n&&0===S.length?_.translate("Polaris.ResourceList.BulkActions.actionsActivatorLabel"):_.translate("Polaris.ResourceList.BulkActions.moreActionsActivatorLabel"),N=c?i.createElement(ms,{className:GS.AllAction,onClick:c.onAction,size:"slim",disabled:o},i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium"},c.content)):null,O=l&&c,P={accessibilityLabel:u,label:O?l:d,selected:h,onToggleAll:p,disabled:o,ariaLive:O?"polite":void 0,ref:t},k=(0,i.useCallback)(()=>{null===m||void 0===m||m(v),b(e=>!e)},[m,v]),D=(0,i.useCallback)(e=>{const{hiddenActionsWidths:t,containerWidth:r,disclosureWidth:i}=e;if(!n||0===n.length)return;const{visiblePromotedActions:o,hiddenPromotedActions:a}=BS(n,i,t,r);y({visiblePromotedActions:o,hiddenPromotedActions:a,actionsWidths:t,containerWidth:r,disclosureWidth:i,hasMeasured:!0})},[n]),x=function(e){if(e&&0!==e.length)return function(e){const t=e.filter(e=>e.items);return e.length===t.length}(e)?e:function(e){const t=e.filter(e=>!e.items);return e.length===t.length}(e)?[{items:e}]:void 0}(r),L=n?n.filter((e,t)=>!!S.includes(t)).map((e,t)=>WS(e)?i.createElement(XS,Object.assign({key:t},e,{isNewBadgeInBadgeActions:HS(x),size:s})):i.createElement(qS,Object.assign({key:t,disabled:o},e,{size:s}))):null,M=T.map(e=>null===n||void 0===n?void 0:n[e]).reduce((e,t)=>t?WS(t)?e.concat(t.actions):e.concat(t):e,[]),U={items:M},F=(0,i.useMemo)(()=>{if(x)return x;if(!r)return[];let e=!0;return r.filter(e=>e).reduce((t,n)=>{if(function(e){return"items"in e}(n))return e=!1,t.concat(n);if(e){if(0===t.length)return[{items:[n]}];const e=t[t.length-1];return t.splice(t.length-1,1,{items:[...e.items,n]}),t}return e=!0,t.concat({items:[n]})},[])},[r,x]),j=i.createElement(qS,{disclosure:!0,showContentInButton:!L,onAction:k,content:I,disabled:o,indicator:HS(x),size:s}),V=F.length>0?i.createElement(ts,{active:v,activator:j,preferredAlignment:"right",onClose:k},i.createElement(Lc,{sections:U.items.length>0?[U,...F]:F,onActionAnyItem:k})):null,B=i.createElement(eT,{promotedActions:n,disabled:o,buttonSize:s,handleMeasurement:D});return i.createElement("div",{className:GS.BulkActions,style:f?{width:f}:void 0},i.createElement(Bs,{gap:"400",blockAlign:"center"},i.createElement("div",{className:GS.BulkActionsSelectAllWrapper},i.createElement($S,P),N),g?i.createElement("div",{className:GS.BulkActionsPromotedActionsWrapper},i.createElement(Bs,{gap:"100",blockAlign:"center"},i.createElement("div",{className:GS.BulkActionsOuterLayout},B,i.createElement("div",{className:qr(GS.BulkActionsLayout,!A&&GS["BulkActionsLayout--measuring"])},L)),V)):null))});function nT(e){let{children:t,onMount:n,fallback:r=null}=e;const o=ca(),a=o?t:r;return(0,i.useEffect)(()=>{o&&n&&n()},[o,n]),i.createElement(i.Fragment,null,a)}class rT extends i.Component{constructor(){var e;super(...arguments),e=this,this.state={isSticky:!1,style:{}},this.placeHolderNode=null,this.stickyNode=null,this.setPlaceHolderNode=e=>{this.placeHolderNode=e},this.setStickyNode=e=>{this.stickyNode=e},this.handlePositioning=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const{isSticky:o}=e.state;(t&&!o||!t&&o)&&(e.adjustPlaceHolderNode(t),e.setState({isSticky:!o},()=>null==e.props.onStickyChange?null:(e.props.onStickyChange(!o),null==e.props.boundingElement?null:void e.props.boundingElement.toggleAttribute("data-sticky-active"))));const a=t?{position:"fixed",top:n,left:r,width:i}:{};e.setState({style:a})},this.adjustPlaceHolderNode=e=>{this.placeHolderNode&&this.stickyNode&&(this.placeHolderNode.style.paddingBottom=e?"".concat(pa(this.stickyNode).height,"px"):"0px")}}componentDidMount(){const{boundingElement:e,offset:t=!1,disableWhenStacked:n=!1,stickyManager:r}=this.props;this.stickyNode&&this.placeHolderNode&&r.registerStickyItem({stickyNode:this.stickyNode,placeHolderNode:this.placeHolderNode,handlePositioning:this.handlePositioning,offset:t,boundingElement:e,disableWhenStacked:n})}componentWillUnmount(){const{stickyManager:e}=this.props;this.stickyNode&&e.unregisterStickyItem(this.stickyNode)}render(){const{style:e,isSticky:t}=this.state,{children:n}=this.props,r="function"===typeof n?n(t):n;return i.createElement("div",null,i.createElement("div",{ref:this.setPlaceHolderNode}),i.createElement("div",{ref:this.setStickyNode,style:e},r))}}function iT(e){const t=function(){const e=(0,i.useContext)(va);if(!e)throw new Ci("No StickyManager was provided.");return e}();return i.createElement(rT,Object.assign({},e,{stickyManager:t}))}const oT=["headings","bulkActions","promotedBulkActions","children","emptyState","sort","paginatedSelectAllActionText","lastColumnSticky","sortable","sortDirection","defaultSortDirection","sortColumnIndex","onSort","sortToggleLabels","hasZebraStriping","pagination"],aT=["children","selectable","itemCount","selectedItemsCount","resourceName","loading","hasMoreItems","condensed","onSelectionChange","paginatedSelectAllText"];function sT(e){let{headings:t,bulkActions:n=[],promotedBulkActions:r=[],children:s,emptyState:c,sort:l,paginatedSelectAllActionText:d,lastColumnSticky:u=!1,sortable:h,sortDirection:p,defaultSortDirection:m="descending",sortColumnIndex:f,onSort:g,sortToggleLabels:_,hasZebraStriping:v,pagination:b}=e,E=(0,o.A)(e,oT);const y=Ka(),{loading:S,bulkSelectState:T,resourceName:C,bulkActionsAccessibilityLabel:w,selectMode:R,selectable:A=E.selectable,paginatedSelectAllText:I,itemCount:N,hasMoreItems:O,selectedItemsCount:P,condensed:k}=CS(),D=TS(),x=ji(),{value:L,toggle:M}=ti(!1),U=(0,i.useRef)({top:0,left:0}),F=(0,i.useRef)([]),j=(0,i.useRef)(null),V=(0,i.useRef)(null),B=(0,i.useRef)(null),W=(0,i.useRef)(null),H=(0,i.useRef)(null),[G,z]=(0,i.useState)(!1),[K,Y]=(0,i.useState)(null),[q,X]=(0,i.useState)(!0),J=(0,i.useRef)([]),Z=(0,i.useRef)([]),Q=(0,i.useRef)(null),$=(0,i.useRef)(null),ee=(0,i.useRef)(null),te=(0,i.useRef)(null),ne=(0,i.useRef)(null),re=(0,i.useRef)(!1),ie=(0,i.useRef)(!1),oe=(0,i.useRef)(f),ae=(0,i.useRef)(!1),se=(0,i.useRef)(0),ce=(0,i.useRef)(!1);P!==se.current&&(ae.current=!0,se.current=P),ce.current||0===P||(ce.current=!0);const le=(0,i.useCallback)(e=>{null===e||G||z(!0),B.current=e},[G]),de=(0,i.useCallback)(()=>{D(P===vS?bS.Page:bS.All,!0)},[D,P]),ue=(0,i.useMemo)(()=>aa(()=>{var e;if(!V.current||!j.current)return;const t=j.current.getBoundingClientRect();if(U.current={top:t.top,left:t.left},F.current=J.current.map(e=>({offsetWidth:e.offsetWidth||0,offsetLeft:e.offsetLeft||0})),0!==J.current.length){var n;if(A&&J.current.length>1)J.current[1].style.left="".concat(F.current[0].offsetWidth,"px"),null!==(n=Z.current)&&void 0!==n&&n.length&&(Z.current[1].style.left="".concat(F.current[0].offsetWidth,"px"));null!==(e=Z.current)&&void 0!==e&&e.length&&Z.current.forEach((e,t)=>{var n;e.style.minWidth="".concat((null===(n=F.current[t])||void 0===n?void 0:n.offsetWidth)||0,"px")})}}),[A]),he=(0,i.useCallback)(()=>{var e,t;te.current&&V.current&&G&&(te.current.style.setProperty("--pc-index-table-scroll-bar-content-width","".concat(V.current.offsetWidth-16,"px")),X((null===(e=ne.current)||void 0===e?void 0:e.offsetWidth)===(null===(t=V.current)||void 0===t?void 0:t.offsetWidth)))},[G]),pe=(0,i.useCallback)(aa(he,300,{trailing:!0}),[he]),[me,fe]=(0,i.useState)(!0),ge=(0,i.useCallback)(aa(()=>{if(!u||!V.current||!j.current)return;const e=V.current.getBoundingClientRect(),t=j.current.getBoundingClientRect();fe(e.width>t.width)}),[u]);(0,i.useEffect)(()=>{ge()},[ge]);const[_e,ve]=(0,i.useState)(!0),be=(0,i.useCallback)(()=>{if(!j.current||!J.current.length)return;const e=j.current.getBoundingClientRect(),t=A?J.current[0].getBoundingClientRect().width:0,n=J.current[A?1:0].getBoundingClientRect().width,r=A?J.current.length>2:1,i=u&&r?J.current[J.current.length-1].getBoundingClientRect().width:0;ve(e.width>n+t+i+100)},[u,A]);(0,i.useEffect)(()=>{G&&be()},[be,G]);const Ee=(0,i.useCallback)(()=>{var e;null===(e=te.current)||void 0===e||e.style.setProperty("--pc-index-table-scroll-bar-content-width","0px"),ue(),pe(),ge(),be()},[ue,pe,ge,be]),ye=(0,i.useCallback)((e,t)=>{j.current&&te.current&&(re.current||(ie.current=!0,te.current.scrollLeft=j.current.scrollLeft),re.current=!1,ee.current&&(ee.current.scrollLeft=j.current.scrollLeft),(e&&!L||!e&&L)&&M(),fe(t))},[L,M]),Se=(0,i.useCallback)(()=>{j.current&&te.current&&(ie.current||(re.current=!0,j.current.scrollLeft=te.current.scrollLeft),ie.current=!1)},[]);(0,i.useLayoutEffect)(()=>{J.current=US(V.current,"[data-index-table-heading]"),Z.current=US(Q.current,"[data-index-table-sticky-heading]"),ue()},[t,ue,$,G]),(0,i.useEffect)(()=>{he(),Y(k?W.current:V.current)},[G,he,k]);const Te=t.map((e,t)=>qe(e,t,"th",{"data-index-table-heading":!0},e.id)),Ce=t.map((e,t)=>qe(e,t,"div",{"data-index-table-sticky-heading":!0})),[we,Re]=(0,i.useState)(P===vS?"".concat(N,"+"):P);(0,i.useEffect)(()=>{(P===vS||P>0)&&Re(P===vS?"".concat(N,"+"):P)},[P,N]);const Ae=x.translate("Polaris.IndexTable.selected",{selectedItemsCount:we}),Ie=(0,i.useCallback)(()=>{D(bS.Page,Boolean(!T||"indeterminate"===T))},[T,D]),Ne=function(){if(!A||!O)return;const e=null!==d&&void 0!==d?d:x.translate("Polaris.IndexTable.selectAllItems",{itemsLength:N,resourceNamePlural:C.plural.toLocaleLowerCase()});return{content:P===vS?x.translate("Polaris.IndexTable.undo"):e,onAction:de}}(),Oe={enter:_S["LoadingContainer-enter"],enterActive:_S["LoadingContainer-enter-active"],exit:_S["LoadingContainer-exit"],exitActive:_S["LoadingContainer-exit-active"]},Pe=i.createElement(Il,{in:S,classNames:Oe,timeout:parseInt(y.motion["motion-duration-100"],10),nodeRef:H,appear:!0,unmountOnExit:!0},i.createElement("div",{className:_S.LoadingPanel,ref:H},i.createElement("div",{className:_S.LoadingPanelRow},i.createElement(hs,{size:"small"}),i.createElement("span",{className:_S.LoadingPanelText},x.translate("Polaris.IndexTable.resourceLoadingAccessibilityLabel",{resourceNamePlural:C.plural.toLocaleLowerCase()}))))),ke=qr(_S.StickyTable,L&&_S["StickyTable-scrolling"],k&&_S["StickyTable-condensed"]),De=!k||P,xe=De?r:[],Le=De?n:[],Me=i.createElement("div",{className:ke,role:"presentation"},i.createElement(iT,{boundingElement:K},e=>{const t=qr(_S.StickyTableHeader,e&&_S["StickyTableHeader-isSticky"],_e&&_S["StickyTableHeader-sticky"],L&&_S["StickyTableHeader-scrolling"],_e&&u&&_S["StickyTableHeader-sticky-last"],_e&&u&&me&&_S["StickyTableHeader-sticky-scrolling"]),n=qr(_S.BulkActionsWrapper,R&&_S.BulkActionsWrapperVisible,k&&_S["StickyTableHeader-condensed"],e&&_S["StickyTableHeader-isSticky"]),r=De&&!k?i.createElement("div",{className:n},i.createElement(tT,{selectMode:R,onToggleAll:Ie,paginatedSelectAllText:I,paginatedSelectAllAction:Ne,accessibilityLabel:w,selected:T,promotedActions:xe,actions:Le,onSelectModeToggle:k?Je:void 0,label:Ae,buttonSize:"micro"})):null,o=k?i.createElement("div",{className:qr(_S.HeaderWrapper,(!A||k)&&_S.unselectable)},Pe,l):i.createElement("div",{className:t,ref:Q},Pe,i.createElement("div",{className:_S.StickyTableHeadings,ref:ee},Ce));return i.createElement(i.Fragment,null,o,r)})),Ue=qr(_S.ScrollBarContainer,b&&_S.ScrollBarContainerWithPagination,k&&_S.scrollBarContainerCondensed,q&&_S.scrollBarContainerHidden),Fe=qr(V.current&&G&&_S.ScrollBarContent),je=N>0?i.createElement(nT,{onMount:he},i.createElement("div",{className:Ue,ref:ne},i.createElement("div",{onScroll:Se,className:_S.ScrollBar,ref:te},i.createElement("div",{className:Fe})))):null,Ve=null===h||void 0===h?void 0:h.some(e=>e),Be=qr(_S.Table,L&&_S["Table-scrolling"],R&&_S.disableTextSelection,!A&&_S["Table-unselectable"],_e&&_S["Table-sticky"],Ve&&_S["Table-sortable"],_e&&u&&_S["Table-sticky-last"],_e&&u&&me&&_S["Table-sticky-scrolling"],v&&_S.ZebraStriping),We=c||i.createElement(FS,{title:x.translate("Polaris.IndexTable.emptySearchTitle",{resourceNamePlural:C.plural}),description:x.translate("Polaris.IndexTable.emptySearchDescription"),withIllustration:!0}),He=i.createElement(i.Fragment,null,i.createElement(Aa,{event:"resize",handler:Ee}),Me),Ge=qr(_S.CondensedList,v&&_S.ZebraStriping),ze=k?i.createElement(i.Fragment,null,He,i.createElement("ul",{"data-selectmode":Boolean(R),className:Ge,ref:W},s)):i.createElement(i.Fragment,null,He,i.createElement(VS,{scrollableContainerRef:j,onScroll:ye},i.createElement("table",{ref:V,className:Be},i.createElement("thead",null,i.createElement("tr",{className:_S.HeadingRow},Te)),i.createElement("tbody",{ref:le},s)))),Ke=N>0?ze:i.createElement("div",{className:_S.EmptySearchResultWrapper},We),Ye=b?i.createElement("div",{className:_S.PaginationWrapper},i.createElement(ou,Object.assign({type:"table"},b))):null;return i.createElement(i.Fragment,null,i.createElement("div",{className:_S.IndexTable},i.createElement("div",{className:_S.IndexTableWrapper},!k&&Pe,Ke,je,Ye)));function qe(e,n,r,o,s){const c=0===n,l=n===t.length-1,d=null===h||void 0===h?void 0:h.some(e=>!0===e),u=e.alignment||"start",v=qr(_S.TableHeading,"center"===u&&_S["TableHeading-align-center"],"end"===u&&_S["TableHeading-align-end"],d&&_S["TableHeading-sortable"],c&&_S["TableHeading-second"],l&&!e.hidden&&_S["TableHeading-last"],!A&&_S["TableHeading-unselectable"],e.flush&&_S["TableHeading-flush"]),b=!1!==A&&c&&F.current&&F.current.length>0?{left:F.current[0].offsetWidth}:void 0,E=i.createElement(r,Object.assign({id:s,className:v,key:cT(e),style:b},o),function(e,t){var n;let r;const o={width:null!==(n=e.tooltipWidth)&&void 0!==n?n:"default",activatorWrapper:"div",dismissOnMouseOut:!0,persistOnClick:e.tooltipPersistsOnClick},s=(0,a.A)((0,a.A)({},o),{},{padding:"400",borderRadius:"200",content:e.tooltipContent,preferredPosition:"above"}),c=i.createElement(Qi,{as:"span",variant:"bodySm",fontWeight:"medium",visuallyHidden:e.hidden},e.title);r=e.new?i.createElement(is,{wrap:!1,alignment:"center"},c,i.createElement(Po,{tone:"new"},x.translate("Polaris.IndexTable.onboardingBadgeText"))):c;const l={"--pc-index-table-heading-extra-padding-right":e.paddingBlockEnd?"var(--p-space-".concat(e.paddingBlockEnd,")"):"0"};if(null!==h&&void 0!==h&&h[t]){var d;const n=t===f,a=!n&&t===oe.current,c=ae.current||!ce.current&&0!==P,u="ascending"===p;let h=null!==(d=e.defaultSortDirection)&&void 0!==d?d:m,v="ascending"===h?fS:gS;n&&(h=u?"descending":"ascending",v="ascending"===p?fS:gS);const b=i.createElement("span",{className:qr(_S.TableHeadingSortIcon,"end"===(null===e||void 0===e?void 0:e.alignment)&&_S["TableHeadingSortIcon-heading-align-end"],n&&_S["TableHeadingSortIcon-visible"])},i.createElement(v,{focusable:"false","aria-hidden":"true",className:_S.TableHeadingSortSvg})),E={onClick:()=>function(e,t){ae.current=!1,ce.current=!1,oe.current=f,null===g||void 0===g||g(e,t)}(t,h),className:qr(_S.TableHeadingSortButton,!n&&"end"===(null===e||void 0===e?void 0:e.alignment)&&_S["TableHeadingSortButton-heading-align-end"],n&&"end"===(null===e||void 0===e?void 0:e.alignment)&&_S["TableHeadingSortButton-heading-align-end-currently-sorted"],a&&!c&&"end"===(null===e||void 0===e?void 0:e.alignment)&&_S["TableHeadingSortButton-heading-align-end-previously-sorted"]),tabIndex:R?-1:0},y=i.createElement(ms,E,b,i.createElement("span",{className:qr(_&&R&&e.tooltipContent&&_S.TableHeadingTooltipUnderlinePlaceholder)},r));if(!_||R)return i.createElement("div",{className:_S.SortableTableHeadingWithCustomMarkup},y);const S=n?p:h,T=_[t][S];if(!e.tooltipContent)return i.createElement("div",{style:l,className:qr(e.paddingBlockEnd&&_S["TableHeading-extra-padding-right"])},i.createElement(Fs,Object.assign({},o,{content:T,preferredPosition:"above"}),y));if(e.tooltipContent)return i.createElement("div",{className:qr(_S.SortableTableHeadingWithCustomMarkup,e.paddingBlockEnd&&_S["TableHeading-extra-padding-right"]),style:l},i.createElement(ms,E,i.createElement(Fs,s,i.createElement("span",{className:_S.TableHeadingUnderline},r)),i.createElement(Fs,Object.assign({},o,{content:T,preferredPosition:"above"}),b)))}if(e.tooltipContent)return i.createElement("div",{style:l,className:qr(e.paddingBlockEnd&&_S["TableHeading-extra-padding-right"])},i.createElement(Fs,Object.assign({},s,{activatorWrapper:"span"}),i.createElement("span",{className:qr(_S.TableHeadingUnderline,_S.SortableTableHeaderWrapper)},r)));return i.createElement("div",{style:l,className:qr(e.paddingBlockEnd&&_S["TableHeading-extra-padding-right"])},r)}(e,n));if(0!==n||!A)return E;const y=qr(_S.TableHeading,d&&_S["TableHeading-sortable"],0===n&&_S["TableHeading-first"]);return[i.createElement(r,Object.assign({className:y,key:"".concat(e,"-").concat(n)},o),i.createElement("div",{className:_S.ColumnHeaderCheckboxWrapper},i.createElement(my,{label:x.translate("Polaris.IndexTable.selectAllLabel",{resourceNamePlural:C.plural}),labelHidden:!0,onChange:Xe,checked:T}))),E]}function Xe(e){D(bS.Page,e)}function Je(){D(bS.All,!1)}}function cT(e){return e.id?e.id:"string"===typeof e.title?e.title:""}function lT(e){let{children:t,selectable:n=!0,itemCount:r,selectedItemsCount:a=0,resourceName:s,loading:c,hasMoreItems:l,condensed:d,onSelectionChange:u,paginatedSelectAllText:h}=e,p=(0,o.A)(e,aT);return i.createElement(i.Fragment,null,i.createElement(wS,{selectable:n&&!d,itemCount:r,selectedItemsCount:a,resourceName:s,loading:c,hasMoreItems:l,condensed:d,onSelectionChange:u,paginatedSelectAllText:h},i.createElement(sT,p,t)))}lT.Cell=RS,lT.Row=MS;const dT=function(e){let{itemStrings:t=[],sortOptions:n=[],data:r=[],headings:o=[],renderRow:a,resourceName:s={singular:"item",plural:"items"},queryPlaceholder:c="Search items",onTabChange:l,onQueryChange:d,onSortChange:u}=e;const h=t.map((e,t)=>({content:e,index:t,onAction:()=>{},id:"".concat(e,"-").concat(t),isLocked:0===t})),[p,m]=(0,i.useState)(0),[f,g]=(0,i.useState)(n.length>0?[n[0].value]:[]),{mode:_,setMode:v}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:QE.Default;const[t,n]=(0,i.useState)(e);return{mode:t,setMode:n}}(),[b,E]=(0,i.useState)(""),y=(0,i.useCallback)(e=>{m(e),l&&l(e)},[l]),S=(0,i.useCallback)(e=>{E(e),d&&d(e)},[d]),T=(0,i.useCallback)(()=>{E(""),d&&d("")},[d]),C=(0,i.useCallback)(e=>{g(e),u&&u(e)},[u]),w=null===r||void 0===r?void 0:r.map((e,t)=>a?a(e,t):null).filter(Boolean);return(0,ad.jsxs)(Xu,{children:[(0,ad.jsx)(mS,{sortOptions:n,sortSelected:f,queryValue:b,queryPlaceholder:c,onQueryChange:S,onQueryClear:T,onSort:C,cancelAction:{onAction:()=>!0,disabled:!1,loading:!1},tabs:h,selected:p,onSelect:y,canCreateNewView:!1,filters:[],appliedFilters:[],onClearAll:T,mode:_,setMode:v}),(0,ad.jsx)(lT,{condensed:Xi().smDown,selectable:!1,resourceName:s,itemCount:(null===r||void 0===r?void 0:r.length)||0,headings:o,children:w})]})};function uT(e){let{isUserAlertVisible:t,setIsUserAlertVisible:n,handleDelete:r,consultantId:i}=e;const o=()=>{n(!1)};return(0,ad.jsx)(Xl,{activator:!0,open:t,onClose:o,title:"Delete Consultant",primaryAction:{content:"Delete Consultant",onAction:()=>r(i)},secondaryActions:[{content:"Cancel",onAction:o}],children:(0,ad.jsx)(Xl.Section,{children:(0,ad.jsx)(as,{children:(0,ad.jsx)("p",{children:"Are you sure you want to delete this consultant?"})})})})}function hT(e){let{active:t,setActive:n,toastContent:r}=e;const i=t?(0,ad.jsx)(Jc,{content:r,onDismiss:()=>{n(!1)}}):null;return(0,ad.jsx)(pu,{children:i})}const pT=function(){const e=he(),[t,n]=(0,i.useState)(!0),[r,o]=(0,i.useState)(0),[a,s]=(0,i.useState)(""),[c,l]=(0,i.useState)(["name asc"]),[d,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)([]),[m,f]=(0,i.useState)(null),[g,_]=(0,i.useState)(!1),[v,b]=(0,i.useState)(""),[E,y]=(0,i.useState)(!1),[S,T]=(0,i.useState)(null),C=tv(),{consultants:w,loading:R}=iv(e=>e.consultants);(0,i.useEffect)(()=>{const e=localStorage.getItem("doamin_V_id");T(e)},[]),console.log("adminIdLocal",S),(0,i.useEffect)(()=>{C(PE(S))},[C,E,S]);const A=(null===w||void 0===w?void 0:w.findConsultant)||[],I=(0,i.useMemo)(()=>A?A.filter(e=>{let t=!0;if(0!==r){var n;const i=jE[r].toLowerCase();t=(null===(n=e.type)||void 0===n?void 0:n.toLowerCase())===i}let i=!0;if(a.trim()){var o,s,c,l,d;const t=a.toLowerCase();i=(null===(o=e.name)||void 0===o?void 0:o.toLowerCase().includes(t))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(c=e.contact)||void 0===c?void 0:c.toLowerCase().includes(t))||(null===(l=e.phone)||void 0===l?void 0:l.toLowerCase().includes(t))||(null===(d=e.profession)||void 0===d?void 0:d.toLowerCase().includes(t))}return t&&i}):[],[A,r,a,jE]),N=(0,i.useMemo)(()=>{if(!I.length||!c[0])return I;const[e,t]=c[0].split(" "),n=[...I];return n.sort((n,r)=>{let i=n[e],o=r[e];return"experience"===e||"conversionFees"===e?(i=parseFloat(i)||0,o=parseFloat(o)||0):(i=String(i||"").toLowerCase(),o=String(o||"").toLowerCase()),"asc"===t?i>o?1:i<o?-1:0:i<o?1:i>o?-1:0}),n},[I,c]),O=(0,i.useCallback)(e=>{console.log("consultant _id",e)},[]),P=(0,i.useCallback)(t=>{e("/add-consultant?id=".concat(t))},[e]),k=(0,i.useCallback)(e=>{f(e),u(!0)},[]),D=(0,i.useCallback)((e,t)=>{const{_id:n,fullname:r,email:i,phone:o,contact:a,profession:s,experience:c,fees:l,consultantStatus:d}=e,u=o||a;return(0,ad.jsxs)(lT.Row,{_id:n,position:t,children:[(0,ad.jsx)(lT.Cell,{children:(0,ad.jsx)(Qi,{as:"span",alignment:"start",variant:"bodyMd",fontWeight:"bold",numeric:!0,children:t+1})}),(0,ad.jsx)(lT.Cell,{children:(0,ad.jsx)(YE,{source:null!==e&&void 0!==e&&e.profileImage?"".concat(e.profileImage.replace(/\\/g,"/")):"/images/flag/teamdefault.png",size:"small"})}),(0,ad.jsx)(lT.Cell,{children:(0,ad.jsx)(Qi,{variant:"bodyMd",as:"span",children:r})}),(0,ad.jsx)(lT.Cell,{children:i}),(0,ad.jsx)(lT.Cell,{children:u}),(0,ad.jsx)(lT.Cell,{children:s}),(0,ad.jsx)(lT.Cell,{children:c}),(0,ad.jsx)(lT.Cell,{children:(0,ad.jsxs)(Qi,{as:"span",alignment:"center",numeric:!0,children:["$",l]})}),(0,ad.jsx)(lT.Cell,{children:(0,ad.jsxs)("label",{onClick:()=>(async e=>{try{const t=await AE.put("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/api-consultant-update-status/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"}});console.log("___",t.status),200===t.status&&(console.log("active is on "),C(PE(S)),y(e=>!e))}catch(t){console.error("Failed to update")}})(n),style:{position:"relative",display:"inline-block",width:"36px",height:"20px",cursor:"pointer"},children:[(0,ad.jsx)("input",{type:"checkbox",checked:d,onChange:()=>{console.log("Clicked ID:",n)},style:{opacity:0,width:0,height:0}}),(0,ad.jsx)("span",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:d?"var(--p-color-bg-fill-brand)":"var(--p-color-bg-fill-selected)",borderRadius:"11px",transition:"background-color 0.2s ease"},children:(0,ad.jsx)("span",{style:{position:"absolute",height:"16px",width:"16px",left:d?"18px":"2px",top:"2px",backgroundColor:"#FFFFFF",borderRadius:"50%",transition:"left 0.2s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"}})})]})}),(0,ad.jsx)(lT.Cell,{children:(0,ad.jsxs)(iu,{children:[(0,ad.jsx)(fs,{variant:"tertiary",icon:qE,accessibilityLabel:"Edit consultant",onClick:e=>{e.stopPropagation(),P(n)}}),(0,ad.jsx)(fs,{variant:"tertiary",icon:XE,accessibilityLabel:"Duplicate consultant"}),(0,ad.jsx)(fs,{variant:"tertiary",icon:JE,tone:"critical",accessibilityLabel:"Delete consultant",onClick:e=>{e.stopPropagation(),k(n)}})]})})]},n)},[O,P,k,E]);return(0,ad.jsxs)(i.Fragment,{children:[(0,ad.jsx)(uT,{isUserAlertVisible:d,setIsUserAlertVisible:u,handleDelete:async()=>{try{const e="".concat("https://test-online-consultation.zend-apps.com","/api-consultant/delete-consultant/").concat(m);(await fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok?(_(!0),b("Consultant deleted successfully"),u(!1),y(e=>!e)):console.log("Failed to delete consultant")}catch(e){console.error("Error deleting consultant:",e)}},consultantId:m}),(0,ad.jsx)(hT,{active:g,setActive:_,toastContent:v}),(0,ad.jsx)(pu,{title:"Consultant List",primaryAction:{icon:ZE,content:"Add Consultant",url:"/add-consultant"},secondaryActions:[{content:"Publish App",external:!0,icon:ch}],children:(0,ad.jsxs)(gu,{children:[t&&(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Tu,{title:"Hi om suman. Welcome To: Your Shopify Store",tone:"info",onDismiss:()=>n(!1),icon:lh,children:(0,ad.jsxs)(qs,{gap:"200",children:[(0,ad.jsx)("p",{children:"Make sure you know how these changes affect your store."}),(0,ad.jsx)("p",{children:"Make sure you know how these changes affect your store."})]})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(dT,{itemStrings:jE,sortOptions:UE,data:N,headings:FE,renderRow:D,resourceName:{singular:"consultant",plural:"consultants"},queryPlaceholder:"Search consultants",onTabChange:o,onQueryChange:s,onSortChange:l})})]})})]})};var mT={Tag:"Polaris-Tag",disabled:"Polaris-Tag--disabled",clickable:"Polaris-Tag--clickable",linkable:"Polaris-Tag--linkable",removable:"Polaris-Tag--removable",Button:"Polaris-Tag__Button",Link:"Polaris-Tag__Link",segmented:"Polaris-Tag--segmented",Text:"Polaris-Tag__Text",sizeLarge:"Polaris-Tag--sizeLarge",overlay:"Polaris-Tag--overlay"};function fT(e){let{children:t,disabled:n=!1,onClick:r,onRemove:o,accessibilityLabel:a,url:s,size:c}=e;const l=ji(),d=o&&s,u=qr(mT.Tag,n&&mT.disabled,r&&mT.clickable,o&&mT.removable,s&&!n&&mT.linkable,d&&mT.segmented,c&&mT[Xr("size",c)]);let h=a;h||(h="string"===typeof t?t:void 0);const p=i.createElement(Qi,{as:"span",variant:"bodySm",truncate:!0},i.createElement("span",{title:h,className:mT.Text},t));if(r)return i.createElement("button",{type:"button",disabled:n,className:u,onClick:r},p);const m=l.translate("Polaris.Tag.ariaLabel",{children:h||""}),f=o?i.createElement("button",{type:"button","aria-label":m,className:qr(mT.Button,d&&mT.segmented),onClick:o,onMouseUp:Lo,disabled:n},i.createElement($i,{source:Zu})):null,g=s&&!n?i.createElement("a",{className:qr(mT.Link,d&&mT.segmented),href:s},p):p;return i.createElement("span",{className:u,"aria-disabled":n},g,"large"===c&&i.createElement("span",{className:mT.overlay}),f)}var gT=function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 20 20"},e),i.createElement("path",{d:"M16.5 6.26a.75.75 0 0 1-1.5 0v-.51a.75.75 0 0 0-.75-.75h-8.5a.75.75 0 0 0-.75.75v.51a.75.75 0 0 1-1.5 0v-.51a2.25 2.25 0 0 1 2.25-2.25h8.5a2.25 2.25 0 0 1 2.25 2.25v.51Z"}),i.createElement("path",{d:"M10.75 16.01a.75.75 0 0 1-1.5 0v-6.69l-1.72 1.72a.75.75 0 1 1-1.06-1.06l3-3a.75.75 0 0 1 1.06 0l3 3a.75.75 0 1 1-1.06 1.06l-1.72-1.72v6.69Z"}))};function _T(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase();return e.charAt(0).toUpperCase()+e.slice(1)}gT.displayName="UploadIcon";const vT=["dragover","dragenter","drop"];function bT(e,t){return"application/x-moz-file"===e.type||function(e,t){if(e&&t){const n=e.name||"",r=e.type||"",i=r.replace(/\/.*$/,"");return(Array.isArray(t)?t:t.split(",")).some(e=>{const t=e.trim();return t.startsWith(".")?n.toLowerCase().endsWith(t.toLowerCase()):t.endsWith("/*")?i===t.replace(/\/.*$/,""):r===t})}return!0}(e,t)}function ET(e){if(function(e){return vT.indexOf(e.type)>0}(e)&&e.dataTransfer){const t=e.dataTransfer;if(t.files&&t.files.length)return Array.from(t.files);if(t.items&&t.items.length)return Array.from(t.items)}else if(function(e){return Object.prototype.hasOwnProperty.call(e,"target")}(e)&&e.target.files)return Array.from(e.target.files);return[]}const yT=!0;function ST(e){return e?"allowMultiple":"single"}const TT=(0,i.createContext)({disabled:!1,focused:!1,size:"extraLarge",type:"file",measuring:!1,allowMultiple:yT});var CT={DropZone:"Polaris-DropZone",focused:"Polaris-DropZone--focused",noOutline:"Polaris-DropZone--noOutline",hasOutline:"Polaris-DropZone--hasOutline",isDisabled:"Polaris-DropZone--isDisabled",isDragging:"Polaris-DropZone--isDragging",sizeLarge:"Polaris-DropZone--sizeLarge",sizeMedium:"Polaris-DropZone--sizeMedium",sizeSmall:"Polaris-DropZone--sizeSmall",measuring:"Polaris-DropZone--measuring",Container:"Polaris-DropZone__Container",Overlay:"Polaris-DropZone__Overlay",hasError:"Polaris-DropZone--hasError"},wT={FileUpload:"Polaris-DropZone-FileUpload",large:"Polaris-DropZone-FileUpload--large",small:"Polaris-DropZone-FileUpload--small",ActionTitle:"Polaris-DropZone-FileUpload__ActionTitle","ActionTitle-disabled":"Polaris-DropZone-FileUpload__ActionTitle--disabled","ActionTitle-focused":"Polaris-DropZone-FileUpload__ActionTitle--focused",UploadIcon:"Polaris-DropZone-FileUpload__UploadIcon",disabled:"Polaris-DropZone-FileUpload--disabled"};const RT=function(e){let{dropOnPage:t,label:n,labelAction:r,labelHidden:o,children:a,disabled:s=!1,outline:c=!0,accept:l,active:d,overlay:u=!0,allowMultiple:h=yT,overlayText:p,errorOverlayText:m,id:f,type:g="file",onClick:_,error:v,openFileDialog:b,variableHeight:E,onFileDialogClose:y,customValidator:S,onDrop:T,onDropAccepted:C,onDropRejected:w,onDragEnter:R,onDragOver:A,onDragLeave:I}=e;const N=(0,i.useRef)(null),O=(0,i.useRef)(null),P=(0,i.useRef)([]),k=(0,i.useCallback)(aa(()=>{if(!N.current)return;if(E)return void H(!1);let e="large";const t=N.current.getBoundingClientRect().width;t<100?e="small":t<160&&(e="medium"),B(e),W&&H(!1)},50,{trailing:!0}),[]),[D,x]=(0,i.useState)(!1),[L,M]=(0,i.useState)(!1),{value:U,setTrue:F,setFalse:j}=ti(!1),[V,B]=(0,i.useState)("large"),[W,H]=(0,i.useState)(!0),G=ji(),z=(0,i.useCallback)(e=>{const t=[],n=[];return Array.from(e).forEach(e=>{!bT(e,l)||S&&!S(e)?n.push(e):t.push(e)}),h||(t.splice(1,t.length),n.push(...t.slice(1))),{files:e,acceptedFiles:t,rejectedFiles:n}},[l,h,S]),K=(0,i.useCallback)(e=>{if(AT(e),s)return;const t=ET(e),{files:n,acceptedFiles:r,rejectedFiles:i}=z(t);P.current=[],x(!1),M(i.length>0),T&&T(n,r,i),C&&r.length&&C(r),w&&i.length&&w(i),e.target&&"value"in e.target&&(e.target.value="")},[s,z,T,C,w]),Y=(0,i.useCallback)(e=>{if(AT(e),s)return;const t=ET(e);if(e.target&&!P.current.includes(e.target)&&P.current.push(e.target),D)return;const{rejectedFiles:n}=z(t);x(!0),M(n.length>0),R&&R()},[s,D,z,R]),q=(0,i.useCallback)(e=>{AT(e),s||A&&A()},[s,A]),X=(0,i.useCallback)(e=>{e.preventDefault(),s||(P.current=P.current.filter(n=>{const r=t&&!Vi?document:N.current;return n!==e.target&&r&&r.contains(n)}),P.current.length>0||(x(!1),M(!1),I&&I()))},[t,s,I]),J=t&&!Vi?document:N.current;Zs("drop",K,J),Zs("dragover",q,J),Zs("dragenter",Y,J),Zs("dragleave",X,J),Zs("resize",k,Vi?null:window),la(()=>{k()});const Z=(0,i.useId)(),Q=null!==f&&void 0!==f?f:Z,$=_T(g),ee=ST(h),te=void 0===p?G.translate("Polaris.DropZone.".concat(ee,".overlayText").concat($)):p,ne=void 0===m?G.translate("Polaris.DropZone.errorOverlayText".concat($)):m,re=n||G.translate("Polaris.DropZone.".concat(ee,".label").concat($)),ie=!n||o,oe=qr(CT.DropZone,c&&CT.hasOutline,!c&&CT.noOutline,U&&CT.focused,(d||D)&&CT.isDragging,s&&CT.isDisabled,(L||v)&&CT.hasError,!E&&CT[Xr("size",V)],W&&CT.measuring),ae=(d||D)&&!L&&!v&&u&&ue(gT,te),se=D&&(L||v)&&ue(sc,ne,"critical"),ce=(0,i.useMemo)(()=>({disabled:s,focused:U,size:V,type:g||"file",measuring:W,allowMultiple:h}),[s,U,W,V,g,h]),le=(0,i.useCallback)(()=>{O.current&&O.current.click()},[O]),de=(0,i.useCallback)(()=>{le(),null===y||void 0===y||y()},[le,y]);function ue(e,t,n){return i.createElement("div",{className:CT.Overlay},i.createElement(qs,{gap:"200",inlineAlign:"center"},"small"===V&&i.createElement($i,{source:e,tone:n}),("medium"===V||"large"===V)&&i.createElement(Qi,{variant:"bodySm",as:"p",fontWeight:"bold"},t)))}return(0,i.useEffect)(()=>{b&&de()},[b,de]),i.createElement(TT.Provider,{value:ce},i.createElement(Sc,{id:Q,label:re,action:r,labelHidden:ie},i.createElement("div",{ref:N,className:oe,"aria-disabled":s,onClick:function(e){if(!s)return _?_(e):le()},onDragStart:AT},ae,se,i.createElement(Qi,{variant:"bodySm",as:"span",visuallyHidden:!0},i.createElement("input",{id:Q,accept:l,disabled:s,multiple:h,onChange:K,onFocus:F,onBlur:j,type:"file",ref:O,autoComplete:"off"})),i.createElement("div",{className:CT.Container},a))))};function AT(e){e.preventDefault(),e.stopPropagation()}RT.FileUpload=function(e){const t=ji(),{size:n,measuring:r,type:o,disabled:a,allowMultiple:s}=(0,i.useContext)(TT),c=_T(o),l=ST(s),{actionTitle:d=t.translate("Polaris.DropZone.".concat(l,".actionTitle").concat(c)),actionHint:u}=e,h=i.createElement(fs,{disabled:a},d),p=qr(wT.FileUpload,r&&wT.measuring,"large"===n&&wT.large,"small"===n&&wT.small),m=u&&i.createElement(Qi,{variant:"bodySm",as:"p",tone:"subdued"},u);let f;switch(n){case"large":case"medium":f=i.createElement(qs,{inlineAlign:"center",gap:"200"},h,m);break;case"small":f=i.createElement("div",{className:qr(wT.UploadIcon,a&&wT.disabled)},i.createElement($i,{source:gT}))}return i.createElement("div",{className:p},f)};var IT={Select:"Polaris-Select",disabled:"Polaris-Select--disabled",error:"Polaris-Select--error",Backdrop:"Polaris-Select__Backdrop",Input:"Polaris-Select__Input",Content:"Polaris-Select__Content",InlineLabel:"Polaris-Select__InlineLabel",Icon:"Polaris-Select__Icon",SelectedOption:"Polaris-Select__SelectedOption",Prefix:"Polaris-Select__Prefix",hover:"Polaris-Select--hover",toneMagic:"Polaris-Select--toneMagic"};const NT=["value","label","prefix","key"],OT="";function PT(e){let{options:t,label:n,labelAction:r,labelHidden:o,labelInline:a,disabled:s,helpText:c,placeholder:l,id:d,name:u,value:h=OT,error:p,onChange:m,onFocus:f,onBlur:g,requiredIndicator:_,tone:v}=e;const{value:b,toggle:E}=ti(!1),y=(0,i.useId)(),S=null!==d&&void 0!==d?d:y,T=!!a||o,C=qr(IT.Select,p&&IT.error,v&&IT[Xr("tone",v)],s&&IT.disabled),w=(0,i.useCallback)(e=>{E(),null===f||void 0===f||f(e)},[f,E]),R=(0,i.useCallback)(e=>{E(),null===g||void 0===g||g(e)},[g,E]),A=m?e=>m(e.currentTarget.value,S):void 0,I=[];c&&I.push(Tc(S)),p&&I.push("".concat(S,"Error"));let N=(t||[]).map(LT);l&&(N=[{label:l,value:OT,disabled:!0},...N]);const O=a&&i.createElement(ia,{paddingInlineEnd:"100"},i.createElement(Qi,{as:"span",variant:"bodyMd",tone:v&&"magic"===v&&!b?"magic-subdued":"subdued",truncate:!0},n)),P=function(e,t){const n=function(e){let t=[];return e.forEach(e=>{DT(e)?t=t.concat(e.options):t.push(e)}),t}(e);let r=n.find(e=>t===e.value);void 0===r&&(r=n.find(e=>!e.hidden));return r||{value:"",label:""}}(N,h),k=P.prefix&&i.createElement("div",{className:IT.Prefix},P.prefix),D=i.createElement("div",{className:IT.Content,"aria-hidden":!0,"aria-disabled":s},O,k,i.createElement("span",{className:IT.SelectedOption},P.label),i.createElement("span",{className:IT.Icon},i.createElement($i,{source:ls}))),x=N.map(UT);return i.createElement(Sc,{id:S,label:n,error:p,action:r,labelHidden:T,helpText:c,requiredIndicator:_,disabled:s},i.createElement("div",{className:C},i.createElement("select",{id:S,name:u,value:h,className:IT.Input,disabled:s,onFocus:w,onBlur:R,onChange:A,"aria-invalid":Boolean(p),"aria-describedby":I.length?I.join(" "):void 0,"aria-required":_},x),D,i.createElement("div",{className:IT.Backdrop})))}function kT(e){return"string"===typeof e}function DT(e){return"object"===typeof e&&"options"in e&&null!=e.options}function xT(e){return{label:e,value:e}}function LT(e){if(kT(e))return xT(e);if(DT(e)){const{title:t,options:n}=e;return{title:t,options:n.map(e=>kT(e)?xT(e):e)}}return e}function MT(e){const{value:t,label:n,prefix:r,key:a}=e,s=(0,o.A)(e,NT);return i.createElement("option",Object.assign({key:null!==a&&void 0!==a?a:t,value:t},s),n)}function UT(e){if(DT(e)){const{title:t,options:n}=e;return i.createElement("optgroup",{label:t,key:t},n.map(MT))}return MT(e)}const FT=function(){const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)(!1),[o,s]=(0,i.useState)(""),[c,l]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(null),[m,f]=(0,i.useState)(null),[g,_]=(0,i.useState)(null),[v,b]=(0,i.useState)(!1),E=(0,i.useRef)(null);console.log("adminIdLocal__________ADD CONSULTANT",n);const[y,S]=(0,i.useState)({fullName:"",email:"",password:"",phoneNumber:"",profession:"",profileImage:"",specialization:"",licenseIdNumber:"",yearOfExperience:"",chargingPerMinute:"",languages:[],displayName:"",gender:"male",houseNumber:"",streetArea:"",landmark:"",address:"",pincode:"",dateOfBirth:"",pancardNumber:"",chatPerMinute:"",videoPerMinute:"",voicePerMinute:""}),[T,C]=(0,i.useState)(""),[w,R]=(0,i.useState)(!1),[A]=Et(),[I,N]=(0,i.useState)(null),O=A.get("id"),P=new URLSearchParams(window.location.search).get("adminId");console.log("adminId",P),(0,i.useEffect)(()=>{const e=localStorage.getItem("doamin_V_id");N(e),console.log("adminIdLocal",I)},[]),console.log("adminIdLocal",localStorage.getItem("doamin_V_id")),(0,i.useEffect)(()=>{O&&b(!0)},[O]),console.log("consultantDetails",g);const k=(0,i.useCallback)(e=>t=>{S(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t}))},[]),D=(0,i.useCallback)(e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&(p(URL.createObjectURL(n)),u(n))},[]),x=(0,i.useCallback)((e,t,n)=>{t.length>0&&u(t[0])},[]),L=(0,i.useCallback)(e=>{C(e),R(!0)},[]),M=(0,i.useCallback)(()=>{R(!0)},[]),U=(0,i.useCallback)(e=>{y.languages.includes(e)||S(t=>(0,a.A)((0,a.A)({},t),{},{languages:[...t.languages,e]})),C(""),R(!1)},[y.languages]),F=(0,i.useCallback)(e=>{S(t=>(0,a.A)((0,a.A)({},t),{},{languages:t.languages.filter(t=>t!==e)}))},[]),j=VE.filter(e=>{const t=0===T.length||e.toLowerCase().includes(T.toLowerCase()),n=!y.languages.includes(e);return t&&n}),V=(0,ad.jsx)(qs,{gap:"200",children:y.languages.length>0&&(0,ad.jsxs)(qs,{gap:"100",children:[(0,ad.jsx)(Qi,{variant:"bodySm",tone:"subdued",fontWeight:"medium",children:"Selected Tags:"}),(0,ad.jsx)(is,{spacing:"extraTight",alignment:"center",wrap:!0,children:y.languages.map(e=>(0,ad.jsx)(fT,{onRemove:()=>F(e),children:e},e))})]})}),B=w&&j.length>0&&(0,ad.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"1px solid #e1e3e5",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto",marginTop:"4px"},children:j.map(e=>(0,ad.jsx)("div",{onClick:()=>U(e),style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #e1e3e5"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f6f6f7"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="white"},children:(0,ad.jsx)(Qi,{variant:"bodyMd",children:e})},e))}),W=(0,i.useCallback)(()=>{var e;null===(e=E.current)||void 0===e||e.click()},[]),H=(0,i.useCallback)(async()=>{r(!0),s(""),l(!1);const e=new FormData;d&&e.append("profileImage",d),Object.keys(y).forEach(t=>{const n=y[t];""!==n&&null!==n&&void 0!==n&&"profileImage"!==t&&(Array.isArray(n)?e.append(t,JSON.stringify(n)):e.append(t,n))});for(let n of e.entries())console.log(n[0]+": "+n[1]);try{const t=await fetch("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/add-consultant/").concat(I),{method:"POST",body:e}),n=await t.json();console.log("responseData",n),t.ok?(l(!0),C(""),u(null),p(null)):s((null===n||void 0===n?void 0:n.message)||"Failed to submit consultant data. Please try again.")}catch(t){console.error("Error submitting consultant data:",t),s(t.message||"Failed to submit consultant data. Please try again.")}finally{r(!1)}},[y,d]);return(0,i.useEffect)(()=>{O&&(async()=>{if(O)try{const e=await fetch("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/consultantid/").concat(O)),t=await e.json();console.log("responseData",t),e.ok&&t.consultant&&_(t.consultant)}catch(e){console.error("Error fetching consultant:",e)}})()},[O]),(0,i.useEffect)(()=>{if(g&&g.email){let e="";if(g.dateOfBirth){const t=new Date(g.dateOfBirth);e=isNaN(t.getTime())?g.dateOfBirth:t.toISOString().split("T")[0]}if(S({fullName:g.fullname||g.fullName||"",email:g.email||"",password:g.password||"",phoneNumber:g.phone||g.phoneNumber||g.contact||"",profession:g.profession||"",profileImage:g.profileImage||"",specialization:g.specialization||"",licenseIdNumber:g.licenseNo||g.licenseIdNumber||"",yearOfExperience:g.experience||g.yearOfExperience||"",chargingPerMinute:g.fees||g.chargingPerMinute||"",languages:Array.isArray(g.language)?g.language:Array.isArray(g.languages)?g.languages:[],displayName:g.displayName||"",gender:g.gender||"male",houseNumber:g.houseNumber||"",streetArea:g.streetArea||"",landmark:g.landmark||"",address:g.address||"",pincode:g.pincode||"",dateOfBirth:e,pancardNumber:g.pan_cardNumber||g.pancardNumber||"",chatPerMinute:g.chatPerMinute||"",videoPerMinute:g.videoPerMinute||"",voicePerMinute:g.voicePerMinute||""}),g.profileImage){let e=g.profileImage.replace(/\\/g,"/");if(!e.startsWith("http")){const t="https://test-online-consultation.zend-apps.com".replace(/\/$/,"");e=e.replace(/^\//,""),e="".concat(t,"/").concat(e)}console.log("Profile image URL:",e),p(e),f(e)}}},[g]),(0,ad.jsx)(pu,{backAction:{content:"Consultant List",url:"/consultant-list"},title:v?"Update Consultant settings":"Add Consultant settings",secondaryActions:[{content:"Publish App",external:!0,icon:ch}],children:(0,ad.jsxs)(gu,{children:[e&&(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Tu,{title:"Hi Admin. Welcome To: Your Shopify Store",tone:"info",onDismiss:()=>t(!1),icon:lh,children:(0,ad.jsxs)(qs,{gap:"200",children:[(0,ad.jsx)("p",{children:"Make sure you know how these changes affect your store."}),(0,ad.jsx)("p",{children:"Make sure you know how these changes affect your store."})]})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Xu,{title:"Add Consultant settings",sectioned:!0,children:(0,ad.jsxs)(nd,{children:[(0,ad.jsx)(nd.Group,{children:(0,ad.jsxs)(Ou,{children:[(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:6,xl:6},children:(0,ad.jsxs)(nd,{children:[(0,ad.jsx)(nd.Group,{children:(0,ad.jsx)(Dc,{label:"Full Name",value:y.fullName,onChange:k("fullName"),autoComplete:"off"})}),(0,ad.jsx)(nd.Group,{children:(0,ad.jsx)(Dc,{label:"Email",type:"email",value:y.email,onChange:k("email"),autoComplete:"email"})}),(0,ad.jsx)(nd.Group,{children:(0,ad.jsx)(Dc,{label:"Password",type:"password",value:y.password,onChange:k("password"),autoComplete:"off"})})]})}),(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:6,xl:6},children:(0,ad.jsxs)("div",{style:{width:200,height:"auto",margin:"auto"},children:[(0,ad.jsx)("input",{ref:E,type:"file",accept:"image/*",onChange:D,style:{display:"none"}}),(0,ad.jsx)(RT,{onDrop:x,accept:"image/*",type:"image",allowMultiple:!1,children:h?(0,ad.jsx)("div",{style:{width:"100%",height:"100%",textAlign:"center",padding:"10px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,ad.jsx)("img",{src:h||"./images/teamdefault.png",alt:"Profile Preview",style:{width:90,height:90,borderRadius:"8px",objectFit:"cover"}})}):(0,ad.jsx)("div",{style:{width:"100%",height:"100%",textAlign:"center",padding:"10px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,ad.jsx)("img",{src:"./images\\flag\\teamdefault.png",alt:"Default Profile",style:{width:90,height:90,borderRadius:"8px",objectFit:"cover"}})})}),(0,ad.jsx)("div",{style:{marginTop:"8px",textAlign:"center"},children:(0,ad.jsx)(fs,{size:"slim",onClick:W,children:"Upload Image"})})]})})]})}),(0,ad.jsxs)(nd.Group,{children:[(0,ad.jsx)(Dc,{label:"Phone Number",type:"tel",value:y.phoneNumber,onChange:k("phoneNumber"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Profession",value:y.profession,onChange:k("profession"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Specialization",value:y.specialization,onChange:k("specialization"),autoComplete:"off"})]}),(0,ad.jsxs)(nd.Group,{children:[(0,ad.jsx)(Dc,{label:"License / ID Number",value:y.licenseIdNumber,onChange:k("licenseIdNumber"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Year of Experience",value:y.yearOfExperience,onChange:k("yearOfExperience"),autoComplete:"off"})]})]})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Xu,{title:"Add your consultant charges",sectioned:!0,children:(0,ad.jsx)(nd,{children:(0,ad.jsxs)(nd.Group,{children:[(0,ad.jsx)(Dc,{type:"number",label:"Chat per minute",value:y.chatPerMinute,onChange:k("chatPerMinute"),autoComplete:"off"}),(0,ad.jsx)(Dc,{type:"number",label:"Video per minute",value:y.videoPerMinute,onChange:k("videoPerMinute"),autoComplete:"off"}),(0,ad.jsx)(Dc,{type:"number",label:"Voice per minute",value:y.voicePerMinute,onChange:k("voicePerMinute"),autoComplete:"off"})]})})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)("div",{className:"language-card-wrapper",children:(0,ad.jsx)(Xu,{title:"Add your consultant Language",sectioned:!0,children:(0,ad.jsx)(nd,{children:(0,ad.jsx)(nd.Group,{children:(0,ad.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,ad.jsx)(Dc,{label:"Tags",value:T,onChange:L,onFocus:M,onBlur:()=>{setTimeout(()=>R(!1),200)},placeholder:"Search tags",autoComplete:"off",verticalContent:V}),B]})})})})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsxs)(Xu,{title:"Add your consultant details",sectioned:!0,children:[(0,ad.jsxs)(nd,{children:[(0,ad.jsxs)(nd.Group,{children:[(0,ad.jsx)(Dc,{label:"Display Name",value:y.displayName,onChange:k("displayName"),autoComplete:"off"}),(0,ad.jsx)(PT,{label:"Gender",options:BE,onChange:k("gender"),value:y.gender}),(0,ad.jsx)(Dc,{label:"House Number",value:y.houseNumber,onChange:k("houseNumber"),autoComplete:"off"})]}),(0,ad.jsxs)(nd.Group,{children:[(0,ad.jsx)(Dc,{label:"Street Area",value:y.streetArea,onChange:k("streetArea"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Landmark",value:y.landmark,onChange:k("landmark"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Address",value:y.address,onChange:k("address"),autoComplete:"off"})]}),(0,ad.jsxs)(nd.Group,{children:[(0,ad.jsx)(Dc,{label:"Pincode",value:y.pincode,type:"number",onChange:k("pincode"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Date of Birth",type:"date",value:y.dateOfBirth,onChange:k("dateOfBirth"),autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Pancard Number",value:y.pancardNumber,onChange:k("pancardNumber"),autoComplete:"off"})]})]}),(0,ad.jsx)("div",{style:{marginTop:"20px",display:"flex",gap:"10px",justifyContent:"flex-end"},children:v?(0,ad.jsx)(fs,{primary:!0,onClick:H,loading:n,disabled:n,children:n?"Updating...":"Update"}):(0,ad.jsx)(fs,{primary:!0,onClick:H,loading:n,disabled:n,children:n?"Submitting...":"Submit"})}),o&&(0,ad.jsx)("div",{style:{marginTop:"16px"},children:(0,ad.jsx)(Tu,{tone:"critical",onDismiss:()=>s(""),children:(0,ad.jsx)("p",{children:o})})}),c&&(0,ad.jsx)("div",{style:{marginTop:"16px"},children:(0,ad.jsx)(Tu,{tone:"success",onDismiss:()=>l(!1),children:(0,ad.jsx)("p",{children:"Consultant added successfully!"})})})]})})]})})},jT=e=>{let{title:t,description:n,price:r,features:i,featuredText:o,button:s,frequency:c}=e;return(0,ad.jsxs)("div",{style:{borderRadius:".75rem",position:"relative",zIndex:"0"},children:[o?(0,ad.jsx)("div",{style:{position:"absolute",width:"100px",height:"100px",overflow:"hidden",left:"unset",bottom:"unset",top:"0",right:"0",transform:"rotate(90deg)",fontSize:"14px",opacity:"1",zIndex:"3"},children:(0,ad.jsx)("span",{style:{position:"absolute",top:"20px",right:"-37px",transform:"rotate(-45deg)",backgroundColor:"var(--p-color-bg-fill-success)",display:"block",width:"200px",padding:"10px 0",lineHeight:"14px",boxShadow:"0 5px 10px rgba(0, 0, 0, .1)",textAlign:"center",textShadow:"0 1px 1px rgba(0, 0, 0, .2)",color:"#fff"},children:o})}):null,(0,ad.jsx)(__,{children:(0,ad.jsxs)(qs,{gap:"400",children:[(0,ad.jsxs)(qs,{gap:"200",align:"start",children:[(0,ad.jsx)(Qi,{as:"h3",variant:"headingLg",children:t}),n?(0,ad.jsx)(Qi,{as:"p",variant:"bodySm",tone:"subdued",children:n}):null]}),(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"end",gap:"8px"},children:[(0,ad.jsx)(Qi,{as:"h2",variant:"heading2xl",children:r}),(0,ad.jsx)(ia,{paddingBlockEnd:"200",children:(0,ad.jsxs)(Qi,{as:"span",variant:"bodySm",children:["/ ",c]})})]}),(0,ad.jsx)(qs,{gap:"100",children:null===i||void 0===i?void 0:i.map((e,t)=>(0,ad.jsxs)(Bs,{align:"start",gap:"200",wrap:!1,children:[(0,ad.jsx)("div",{style:{margin:0,backgroundColor:"var(--p-color-bg)",borderRadius:"var(--p-border-radius-full)"},children:(0,ad.jsx)($i,{source:vu,tone:"success"})}),(0,ad.jsx)(Qi,{tone:"subdued",as:"p",variant:"bodyMd",children:e},t)]},t))}),(0,ad.jsx)(ia,{paddingBlockStart:"200",paddingBlockEnd:"200",children:(0,ad.jsx)(iu,{fullWidth:!0,children:(0,ad.jsx)(fs,(0,a.A)((0,a.A)({},s.props),{},{children:s.content}))})})]})})]})};const VT=function(){const[e,t]=(0,i.useState)(!0);return(0,ad.jsx)(pu,{title:"Pricing",secondaryActions:[{content:"Publish App",external:!0,icon:ch}],children:(0,ad.jsxs)(gu,{children:[e&&(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Tu,{onDismiss:()=>t(!1),children:(0,ad.jsxs)("p",{children:["Use your finance report to get detailed information about your business."," ",(0,ad.jsx)(So,{url:"",children:"Let us know what you think"})]})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsxs)(Ou,{children:[(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:4,xl:4},children:(0,ad.jsx)(jT,{title:"Standard",description:"This is a great plan for stores that are just starting out",features:["Process up to 1,000 orders/mo","Amazing feature","Another really cool feature","24/7 Customer Support","Free Setup Guide","Free 100% Money Back Guarantee","Free 30 Day Trial","Free 100% Money Back Guarantee","Free 100% Money Back Guarantee"],price:"$19",frequency:"month",button:{content:"Select Plan",props:{variant:"primary",onClick:()=>console.log("clicked plan!")}}})}),(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:4,xl:4},children:(0,ad.jsx)(jT,{title:"Advanced",featuredText:"Most Popular",description:"For stores that are growing and need a reliable solution to scale with them",features:["Process up to 10,000 orders/mo","Amazing feature","Another really cool feature","24/7 Customer Support","Free Setup Guide","Free 100% Money Back Guarantee","Free 30 Day Trial","Free 100% Money Back Guarantee","Free 100% Money Back Guarantee"],price:"$49",frequency:"month",button:{content:"Select Plan",props:{variant:"primary",onClick:()=>console.log("clicked plan!")}}})}),(0,ad.jsx)(Ou.Cell,{columnSpan:{xs:6,sm:3,md:3,lg:4,xl:4},children:(0,ad.jsx)(jT,{title:"Premium",description:"The best of the best, for stores that have the highest order processing needs",features:["Process up to 100,000 orders/mo","Amazing feature","Another really cool feature","24/7 Customer Support","Free Setup Guide","Free 100% Money Back Guarantee","Free 30 Day Trial","Free 100% Money Back Guarantee","Free 100% Money Back Guarantee"],price:"$99",frequency:"month",button:{content:"Select Plan",props:{variant:"primary",onClick:()=>console.log("clicked plan!")}}})})]})})]})})};const BT=function(){const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)(0),o=[{id:0,title:"How can I change app status?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["Simply go to the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Dashboard"})," menu and click on the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"App Status"})," button to Enable/Disable the consultant management system."]})})},{id:1,title:"How do I add a new consultant?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["Navigate to the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Consultant List"})," page and click on the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Add Consultant"})," button. Fill in all the required details including name, email, contact number, profession, years of experience, and conversion fees. Once you submit the form, the consultant will be added to your list."]})})},{id:2,title:"How do I manage consultant status (Active/Inactive)?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["You can easily toggle a consultant's status using the toggle switch in the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Status"})," column of the consultant table. Click the toggle to switch between Active and Inactive states. Active consultants are available for consultations, while inactive consultants are temporarily disabled."]})})},{id:3,title:"How do I filter consultants by consultation type?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["Use the filter tabs at the top of the consultant list: ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"All"}),", ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Chat"}),", ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Voice Call"}),", and ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Video Call"}),". Click on any tab to view consultants filtered by their consultation type. You can also use the search bar to find consultants by name, email, contact, or profession."]})})},{id:4,title:"How do I edit consultant information?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["Click on the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Edit"})," icon in the Action column next to the consultant you want to modify. This will allow you to update their contact information, profession, experience, conversion fees, and consultation type. Save your changes to update the consultant's profile."]})})},{id:5,title:"How do I delete a consultant?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["Click on the ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Delete"})," icon in the Action column next to the consultant you want to remove. Confirm the deletion when prompted. Please note that this action cannot be undone, and all consultation history for that consultant will be removed."]})})},{id:6,title:"What information is displayed on the Dashboard?",content:(0,ad.jsx)(qs,{gap:"300",children:(0,ad.jsxs)(Qi,{variant:"bodyMd",as:"p",children:["The Dashboard displays key metrics including: ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Total Clients"}),", ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Conversion Rate"}),", ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Total Consultations"}),", and ",(0,ad.jsx)("span",{className:"Polaris-Text--bold",children:"Total Revenue"}),". These statistics help you track your consultant management performance and make informed decisions."]})})}];return(0,ad.jsx)(pu,{title:"Faq",secondaryActions:[{content:"Add Consultant",external:!0,icon:ch}],children:(0,ad.jsxs)(gu,{children:[e&&(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(Tu,{title:"Welcome to Consultant Management System",tone:"info",onDismiss:()=>t(!1),icon:lh,children:(0,ad.jsxs)(qs,{gap:"200",children:[(0,ad.jsx)("p",{children:"Find answers to common questions about managing your consultants."}),(0,ad.jsx)("p",{children:"Learn how to add, edit, and manage consultants effectively."})]})})}),(0,ad.jsx)(gu.Section,{children:(0,ad.jsx)(__,{padding:"0",children:o.map(e=>{let{title:t,id:i,content:o}=e;const a=n===i;return(0,ad.jsxs)(ia,{borderBlockEndWidth:"025",borderColor:"border",background:"bg-surface-secondary",children:[(0,ad.jsx)(ia,{paddingBlock:"300",paddingInline:"400",children:(0,ad.jsx)("div",{style:{cursor:"pointer"},onClick:()=>r(e=>i===e?null:i),children:(0,ad.jsxs)(Bs,{align:"space-between",blockAlign:"center",children:[(0,ad.jsx)(Qi,{variant:"headingMd",as:"p",children:t}),a?(0,ad.jsx)(ss,{width:"1.5rem",height:"1.5rem"}):(0,ad.jsx)(cs,{width:"1.5rem",height:"1.5rem"})]})})}),(0,ad.jsx)(T_,{open:a,id:i.toString(),children:(0,ad.jsx)(ia,{padding:"400",background:"bg-surface",children:o})})]},i)})})})]})})},WT=(0,ov.Z0)({name:"socket",initialState:{isConnected:!1,activeUsers:[],messages:[],insufficientBalance:null,isChatAccepted:null,chatTimer:{transactionId:null,startTime:null,isRunning:!1,userId:null,shopId:null,consultantId:null},autoChatEnded:null,incomingCall:null,callAccepted:null,callEnded:null,callRejected:null},reducers:{setConnected:(e,t)=>{e.isConnected=t.payload},setActiveUsers:(e,t)=>{e.activeUsers=t.payload},addMessage:(e,t)=>{console.log("addMessage",t.payload),e.messages.push(t.payload)},markMessagesSeen:(e,t)=>{const{senderId:n}=t.payload;e.messages=e.messages.map(e=>e.senderId===n?(0,a.A)((0,a.A)({},e),{},{seen:!0}):e)},setInsufficientBalanceError:(e,t)=>{e.insufficientBalance=t.payload},setChatAccepted:(e,t)=>{e.isChatAccepted=t.payload},setChatTimerStarted:(e,t)=>{Object.assign(e.chatTimer,{transactionId:t.payload.transactionId,startTime:t.payload.startTime,isRunning:!0,userId:t.payload.userId,shopId:t.payload.shopId,consultantId:t.payload.consultantId})},setChatTimerStopped:e=>{e.chatTimer={transactionId:null,startTime:null,isRunning:!1,userId:null,shopId:null,consultantId:null}},setAutoChatEnded:(e,t)=>{e.autoChatEnded=t.payload},setIncomingCall:(e,t)=>{e.incomingCall=t.payload},setCallAccepted:(e,t)=>{e.callAccepted=t.payload,console.log("setCallAccepted",e.callAccepted)},setCallEnded:(e,t)=>{e.callEnded=t.payload},setCallRejected:(e,t)=>{e.callRejected=t.payload,e.callRejected&&localStorage.setItem("callRejected",!0)},clearMessages:e=>{e.messages=[]},connectSocket:(e,t)=>{}}}),{setConnected:HT,setActiveUsers:GT,addMessage:zT,markMessagesSeen:KT,setInsufficientBalanceError:YT,setChatAccepted:qT,setChatTimerStarted:XT,setChatTimerStopped:JT,setAutoChatEnded:ZT,setIncomingCall:QT,setCallAccepted:$T,setCallEnded:eC,setCallRejected:tC,clearMessages:nC,connectSocket:rC}=WT.actions,iC=WT.reducer,oC=Object.create(null);oC.open="0",oC.close="1",oC.ping="2",oC.pong="3",oC.message="4",oC.upgrade="5",oC.noop="6";const aC=Object.create(null);Object.keys(oC).forEach(e=>{aC[oC[e]]=e});const sC={type:"error",data:"parser error"},cC="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),lC="function"===typeof ArrayBuffer,dC=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,uC=(e,t,n)=>{let{type:r,data:i}=e;return cC&&i instanceof Blob?t?n(i):hC(i,n):lC&&(i instanceof ArrayBuffer||dC(i))?t?n(i):hC(new Blob([i]),n):n(oC[r]+(i||""))},hC=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function pC(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let mC;const fC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gC="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let n=0;n<64;n++)gC[fC.charCodeAt(n)]=n;const _C="function"===typeof ArrayBuffer,vC=(e,t)=>{if("string"!==typeof e)return{type:"message",data:EC(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:bC(e.substring(1),t)};return aC[n]?e.length>1?{type:aC[n],data:e.substring(1)}:{type:aC[n]}:sC},bC=(e,t)=>{if(_C){const n=(e=>{let t,n,r,i,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const l=new ArrayBuffer(a),d=new Uint8Array(l);for(t=0;t<s;t+=4)n=gC[e.charCodeAt(t)],r=gC[e.charCodeAt(t+1)],i=gC[e.charCodeAt(t+2)],o=gC[e.charCodeAt(t+3)],d[c++]=n<<2|r>>4,d[c++]=(15&r)<<4|i>>2,d[c++]=(3&i)<<6|63&o;return l})(e);return EC(n,t)}return{base64:!0,data:e}},EC=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,yC=String.fromCharCode(30);function SC(){return new TransformStream({transform(e,t){!function(e,t){cC&&e.data instanceof Blob?e.data.arrayBuffer().then(pC).then(t):lC&&(e.data instanceof ArrayBuffer||dC(e.data))?t(pC(e.data)):uC(e,!1,e=>{mC||(mC=new TextEncoder),t(mC.encode(e))})}(e,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!==typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)})}})}let TC;function CC(e){return e.reduce((e,t)=>e+t.length,0)}function wC(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function RC(e){if(e)return function(e){for(var t in RC.prototype)e[t]=RC.prototype[t];return e}(e)}RC.prototype.on=RC.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},RC.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},RC.prototype.off=RC.prototype.removeListener=RC.prototype.removeAllListeners=RC.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},RC.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},RC.prototype.emitReserved=RC.prototype.emit,RC.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},RC.prototype.hasListeners=function(e){return!!this.listeners(e).length};const AC="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),IC="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function NC(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const OC=IC.setTimeout,PC=IC.clearTimeout;function kC(e,t){t.useNativeTimers?(e.setTimeoutFn=OC.bind(IC),e.clearTimeoutFn=PC.bind(IC)):(e.setTimeoutFn=IC.setTimeout.bind(IC),e.clearTimeoutFn=IC.clearTimeout.bind(IC))}function DC(e){return"string"===typeof e?function(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}function xC(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class LC extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class MC extends RC{constructor(e){super(),this.writable=!1,kC(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new LC(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=vC(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class UC extends MC{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(yC),r=[];for(let i=0;i<n.length;i++){const e=vC(n[i],t);if(r.push(e),"error"===e.type)break}return r})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach((e,o)=>{uC(e,!1,e=>{r[o]=e,++i===n&&t(r.join(yC))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=xC()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let FC=!1;try{FC="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(ex){}const jC=FC;function VC(){}class BC extends UC{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class WC extends RC{constructor(e,t,n){super(),this.createRequest=e,kC(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=NC(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch($D){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch($D){}try{n.setRequestHeader("Accept","*/*")}catch($D){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"===typeof n.status?n.status:0)},0))},n.send(this._data)}catch($D){return void this.setTimeoutFn(()=>{this._onError($D)},0)}"undefined"!==typeof document&&(this._index=WC.requestsCount++,WC.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=VC,e)try{this._xhr.abort()}catch($D){}"undefined"!==typeof document&&delete WC.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(WC.requestsCount=0,WC.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",HC);else if("function"===typeof addEventListener){addEventListener("onpagehide"in IC?"pagehide":"unload",HC,!1)}function HC(){for(let e in WC.requests)WC.requests.hasOwnProperty(e)&&WC.requests[e].abort()}const GC=function(){const e=zC({xdomain:!1});return e&&null!==e.responseType}();function zC(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||jC))return new XMLHttpRequest}catch($D){}if(!t)try{return new(IC[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch($D){}}const KC="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class YC extends MC{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=KC?{}:NC(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(ex){return this.emitReserved("error",ex)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;uC(n,this.supportsBinary,e=>{try{this.doWrite(n,e)}catch($D){}r&&AC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=xC()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const qC=IC.WebSocket||IC.MozWebSocket;const XC={websocket:class extends YC{createSocket(e,t,n){return KC?new qC(e,t,n):t?new qC(e,t):new qC(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends MC{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(ex){return this.emitReserved("error",ex)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){TC||(TC=new TextDecoder);const n=[];let r=0,i=-1,o=!1;return new TransformStream({transform(a,s){for(n.push(a);;){if(0===r){if(CC(n)<1)break;const e=wC(n,1);o=128===(128&e[0]),i=127&e[0],r=i<126?3:126===i?1:2}else if(1===r){if(CC(n)<2)break;const e=wC(n,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(CC(n)<8)break;const e=wC(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){s.enqueue(sC);break}i=o*Math.pow(2,32)+t.getUint32(4),r=3}else{if(CC(n)<i)break;const e=wC(n,i);s.enqueue(vC(o?e:TC.decode(e),t)),r=0}if(0===i||i>e){s.enqueue(sC);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=SC();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{n.read().then(e=>{let{done:t,value:n}=e;t||(this.onPacket(n),i())}).catch(e=>{})};i();const o={type:"open"};this.query.sid&&(o.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&AC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends BC{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=GC&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new WC(zC,this.uri(),e)}}},JC=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ZC=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function QC(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=JC.exec(e||""),o={},a=14;for(;a--;)o[ZC[a]]=i[a]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(n[t]=r)}),n}(0,o.query),o}const $C="function"===typeof addEventListener&&"function"===typeof removeEventListener,ew=[];$C&&addEventListener("offline",()=>{ew.forEach(e=>e())},!1);class tw extends RC{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const n=QC(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=QC(t.host).host);kC(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let r=0,i=n.length;r<i;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),$C&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ew.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&tw.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",tw.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=DC(n)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,AC(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(tw.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),$C&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=ew.indexOf(this._offlineEventListener);-1!==e&&ew.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}tw.protocol=4;class nw extends tw{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;tw.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;tw.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function i(){n||(n=!0,l(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,i(),this.emitReserved("upgradeError",n)};function a(){o("transport closed")}function s(){o("socket closed")}function c(e){t&&e.name!==t.name&&i()}const l=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",a),this.off("close",s),this.off("upgrading",c)};t.once("open",r),t.once("error",o),t.once("close",a),this.once("close",s),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}class rw extends nw{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>XC[e]).filter(e=>!!e)),super(e,t)}}const iw="function"===typeof ArrayBuffer,ow=Object.prototype.toString,aw="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===ow.call(Blob),sw="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===ow.call(File);function cw(e){return iw&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||aw&&e instanceof Blob||sw&&e instanceof File}function lw(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(lw(e[t]))return!0;return!1}if(cw(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return lw(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&lw(e[n]))return!0;return!1}function dw(e){const t=[],n=e.data,r=e;return r.data=uw(n,t),r.attachments=t.length,{packet:r,buffers:t}}function uw(e,t){if(!e)return e;if(cw(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=uw(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=uw(e[r],t));return n}return e}function hw(e,t){return e.data=pw(e.data,t),delete e.attachments,e}function pw(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=pw(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=pw(e[n],t));return e}const mw=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],fw=5;var gw;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(gw||(gw={}));class _w{constructor(e){this.replacer=e}encode(e){return e.type!==gw.EVENT&&e.type!==gw.ACK||!lw(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===gw.EVENT?gw.BINARY_EVENT:gw.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==gw.BINARY_EVENT&&e.type!==gw.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=dw(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function vw(e){return"[object Object]"===Object.prototype.toString.call(e)}class bw extends RC{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===gw.BINARY_EVENT;n||t.type===gw.BINARY_ACK?(t.type=n?gw.EVENT:gw.ACK,this.reconstructor=new Ew(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!cw(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===gw[n.type])throw new Error("unknown packet type "+n.type);if(n.type===gw.BINARY_EVENT||n.type===gw.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!bw.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch($D){return!1}}static isPayloadValid(e,t){switch(e){case gw.CONNECT:return vw(t);case gw.DISCONNECT:return void 0===t;case gw.CONNECT_ERROR:return"string"===typeof t||vw(t);case gw.EVENT:case gw.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===mw.indexOf(t[0]));case gw.ACK:case gw.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ew{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=hw(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function yw(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Sw=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Tw extends RC{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[yw(e,"open",this.onopen.bind(this)),yw(e,"packet",this.onpacket.bind(this)),yw(e,"error",this.onerror.bind(this)),yw(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,n,r;if(Sw.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(o.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(o),this;const s={type:gw.EVENT,data:o,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"===typeof o[o.length-1]){const e=this.ids++,t=o.pop();this._registerAckCallback(e,t),s.id=e}const c=null===(n=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===n?void 0:n.writable,l=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!c||(l?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var n,r=this;const i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===i)return void(this.acks[e]=t);const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},i),a=function(){r.io.clearTimeoutFn(o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(r,n)};a.withError=!0,this.acks[e]=a}emitWithAck(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise((t,r)=>{const i=(e,n)=>e?r(e):t(n);i.withError=!0,n.push(i),this.emit(e,...n)})}_addToQueue(e){var t=this;let n;"function"===typeof e[e.length-1]&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(function(e){if(r!==t._queue[0])return;if(null!==e)r.tryCount>t._opts.retries&&(t._queue.shift(),n&&n(e));else if(t._queue.shift(),n){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];n(null,...o)}return r.pending=!1,t._drainQueue()}),this._queue.push(r),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:gw.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case gw.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case gw.EVENT:case gw.BINARY_EVENT:this.onevent(e);break;case gw.ACK:case gw.BINARY_ACK:this.onack(e);break;case gw.DISCONNECT:this.ondisconnect();break;case gw.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];t.packet({type:gw.ACK,id:e,data:i})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:gw.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Cw(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Cw.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},Cw.prototype.reset=function(){this.attempts=0},Cw.prototype.setMin=function(e){this.ms=e},Cw.prototype.setMax=function(e){this.max=e},Cw.prototype.setJitter=function(e){this.jitter=e};class ww extends RC{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(n=e,e=void 0),(n=n||{}).path=n.path||"/socket.io",this.opts=n,kC(this,n),this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=n.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new Cw({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this._readyState="closed",this.uri=e;const i=n.parser||t;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==n.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new rw(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=yw(t,"open",function(){n.onopen(),e&&e()}),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=yw(t,"error",i);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(yw(e,"ping",this.onping.bind(this)),yw(e,"data",this.ondata.bind(this)),yw(e,"error",this.onerror.bind(this)),yw(e,"close",this.onclose.bind(this)),yw(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch($D){this.onclose("parse error",$D)}}ondecoded(e){AC(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Tw(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Rw={};function Aw(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=QC(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,o=n.path,a=Rw[i]&&o in Rw[i].nsps;let s;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?s=new ww(r,t):(Rw[i]||(Rw[i]=new ww(r,t)),s=Rw[i]),n.query&&!t.query&&(t.query=n.queryKey),s.socket(n.path,t)}Object.assign(Aw,{Manager:ww,Socket:Tw,io:Aw,connect:Aw});let Iw=null;const Nw=()=>(Iw||(Iw=Aw("https://test-online-consultation.zend-apps.com",{transports:["websocket"],withCredentials:!0,autoConnect:!1,reconnection:!0,reconnectionAttempts:10,reconnectionDelay:1e3})),Iw),Ow=Nw(),Pw=async e=>{let{receiverId:t,type:n,userId:r,shop:i}=e;const o=await(async e=>{let{userId:t,consultantId:n,type:r}=e;if(t&&n)try{return(await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api/users/shopify/users/checked-balance/").concat(t,"/").concat(n))).data.data}catch(i){return!1}else alert("Login to start the call")})({userId:r,consultantId:t,type:n});if(!o)return void alert("You have insufficient balance to consult with this consultant");if(!await Dw())return void alert("Please grant microphone permission to start the call");const a="channel-".concat(r.slice(-6),"-").concat(t.slice(-6)),s=Math.floor(1e6*Math.random()),c="".concat("https://test-online-consultation.zend-apps.com","/api/call/generate-token"),l=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelName:a,uid:s})}),d=await l.json();if(d.token){Ow.emit("call-user",{callerId:r,receiverId:t,channelName:a,callType:n||"voice"});const e=encodeURIComponent(d.token),o=d.appId?"&appId=".concat(d.appId):"",c="https://".concat(i,"/apps/consultant-theme"),l="https://focusing-monkey-home-calendar.trycloudflare.com".concat("/video/calling/page")+"?callerId=".concat(r)+"&receiverId=".concat(t)+"&callType=".concat(n||"voice")+"&uid=".concat(s)+"&channelName=".concat(a)+"&token=".concat(e)+o+"&userId=".concat(r)+"&returnUrl=".concat(encodeURIComponent(c));console.log("callUrl",l),window.top.location.href=l}};function kw(e){let{incomingCall:t}=e;const n=(0,i.useRef)(null);(0,i.useEffect)(()=>{t?n.current&&n.current.play().then(()=>{console.log("\ud83d\udd14 Ringtone playing")}).catch(e=>{console.log("\u274c Play blocked:",e)}):r()},[t]);const r=()=>{n.current&&(n.current.pause(),n.current.currentTime=0)};return(0,ad.jsx)(ad.Fragment,{children:(0,ad.jsx)("audio",{ref:n,src:"/sounds/discord_incoming_call.mp3",loop:!0,preload:"auto"})})}const Dw=async()=>{try{return(await navigator.permissions.query({name:"microphone"})).state}catch(e){return"prompt"}};const xw=function(){(0,i.useRef)(null),he();const e=tv(),[t,n]=(0,i.useState)(null),[r,o]=(0,i.useState)(null),[a,s]=(0,i.useState)(!0),{consultants:c,loading:l}=iv(e=>e.consultants),d=new URLSearchParams(window.location.search),u=d.get("shop");console.log("shop",u);const h=d.get("customerId"),p=d.get("shopid"),[m,f]=(0,i.useState)(!0),[g,_]=(0,i.useState)(!0),{insufficientBalance:v}=iv(e=>e.socket);(0,i.useEffect)(()=>{const e=setTimeout(()=>{f(!1)},100);return()=>clearTimeout(e)},[]),(0,i.useEffect)(()=>{localStorage.setItem("client_u_Identity",h),localStorage.setItem("shop_o_Identity",p)},[h,p]),(0,i.useEffect)(()=>{n(localStorage.getItem("client_u_Identity")),o(localStorage.getItem("shop_o_Identity"))},[]),(0,i.useEffect)(()=>{e(PE(p))},[e,p]),(0,i.useEffect)(()=>{e(rC(h))},[h]);const b=Array.isArray(null===c||void 0===c?void 0:c.findConsultant)?c.findConsultant:[],E=b&&b.map(e=>{let t=[];try{"string"===typeof e.language?t=JSON.parse(e.language):Array.isArray(e.language)&&(t=e.language.length>0&&"string"===typeof e.language[0]?JSON.parse(e.language[0]):e.language),Array.isArray(t)||(t=["English"])}catch($D){t=["English"]}return{id:e._id||e.id,name:e.displayName||e.fullname||"Consultant",image:e.profileImage||"",profession:e.profession||"Consultant",specialization:e.specialization||"",experience:parseInt(e.experience)||0,languages:t,rating:4.5,testimonials:0,isActive:e.isActive||!1,chatPrice:parseInt(e.fees)||500,audioPrice:parseInt(e.fees)||800,videoPrice:parseInt(e.fees)||1e3}});(0,i.useEffect)(()=>{if(!l){const e=()=>{const e=document.documentElement.scrollHeight;window.parent&&window.parent.postMessage({type:"AGORA_IFRAME_HEIGHT",height:e},"*")},t=setTimeout(e,300);return()=>clearTimeout(t)}},[l,E.length]);const y=e=>{const t=Math.floor(e),n=e%1!==0,r=5-t-(n?1:0);return(0,ad.jsxs)(ad.Fragment,{children:[Array.from({length:t},(e,t)=>(0,ad.jsx)("span",{className:"star-full",children:"\u2605"},"full-".concat(t))),n&&(0,ad.jsx)("span",{className:"star-half",children:"\u2605"}),Array.from({length:r},(e,t)=>(0,ad.jsx)("span",{className:"star-empty",children:"\u2605"},"empty-".concat(t)))]})},S=async e=>{let{receiverId:n,type:r}=e;await Pw({receiverId:n,type:r,userId:t,shop:u})};return m||l?(0,ad.jsx)("div",{className:"page-loader",children:(0,ad.jsxs)("div",{className:"loader-container",children:[(0,ad.jsx)("div",{className:"loader-spinner"}),(0,ad.jsx)("p",{className:"loader-text",children:"Loading consultants..."})]})}):(0,ad.jsx)(ad.Fragment,{children:(0,ad.jsxs)("div",{className:"container py-4",children:[(0,ad.jsx)("div",{className:"hero-section mb-5",children:(0,ad.jsxs)("div",{className:"hero-content",children:[(0,ad.jsxs)("div",{className:"hero-badge mb-3",children:[(0,ad.jsx)("span",{className:"hero-badge-icon",children:"\u2b50"}),(0,ad.jsx)("span",{children:"Trusted by Thousands"})]}),(0,ad.jsxs)("h1",{className:"hero-title",children:["Find Your Perfect ",(0,ad.jsx)("span",{className:"hero-title-highlight",children:"Consultant"})]}),(0,ad.jsx)("p",{className:"hero-description",children:"Connect with experienced professionals for guidance, support, and expert advice. Choose from our verified consultantsData and start your journey today."}),(0,ad.jsx)("div",{className:"hero-search-container mt-4 mb-4",children:(0,ad.jsxs)("div",{className:"hero-search-box",children:[(0,ad.jsxs)("svg",{className:"hero-search-icon",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("path",{d:"m21 21-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,ad.jsx)("input",{type:"text",className:"hero-search-input",placeholder:"Search by name, profession, or expertise..."}),(0,ad.jsx)("button",{className:"hero-search-btn",children:"Search"})]})}),(0,ad.jsxs)("div",{className:"hero-stats flex justify-content-center gap-4 flex-wrap mt-4",children:[(0,ad.jsxs)("div",{className:"hero-stat-item",children:[(0,ad.jsx)("div",{className:"hero-stat-icon",children:(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("circle",{cx:"9",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,ad.jsxs)("div",{className:"hero-stat-number",children:[E.length,"+"]}),(0,ad.jsx)("div",{className:"hero-stat-label",children:"Expert Consultants"})]}),(0,ad.jsxs)("div",{className:"hero-stat-item",children:[(0,ad.jsx)("div",{className:"hero-stat-icon",children:(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,ad.jsxs)("div",{className:"hero-stat-number",children:[E.reduce((e,t)=>e+t.testimonials,0),"+"]}),(0,ad.jsx)("div",{className:"hero-stat-label",children:"Happy Clients"})]}),(0,ad.jsxs)("div",{className:"hero-stat-item",children:[(0,ad.jsx)("div",{className:"hero-stat-icon",children:(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("polyline",{points:"12 6 12 12 16 14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,ad.jsx)("div",{className:"hero-stat-number",children:E.filter(e=>e.isActive).length}),(0,ad.jsx)("div",{className:"hero-stat-label",children:"Available Now"})]}),(0,ad.jsxs)("div",{className:"hero-stat-item",children:[(0,ad.jsx)("div",{className:"hero-stat-icon",children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ad.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,ad.jsx)("div",{className:"hero-stat-number",children:E.length>0?Math.round(E.reduce((e,t)=>e+t.rating,0)/E.length*10)/10:0}),(0,ad.jsx)("div",{className:"hero-stat-label",children:"Average Rating"})]})]}),(0,ad.jsxs)("div",{className:"hero-quick-filters mt-4",children:[(0,ad.jsx)("span",{className:"hero-filter-label",children:"Quick Filters:"}),(0,ad.jsxs)("div",{className:"hero-filter-tags",children:[(0,ad.jsx)("span",{className:"hero-filter-tag",children:"All"}),(0,ad.jsx)("span",{className:"hero-filter-tag",children:"Available Now"}),(0,ad.jsx)("span",{className:"hero-filter-tag",children:"Psychology"}),(0,ad.jsx)("span",{className:"hero-filter-tag",children:"Vedic"}),(0,ad.jsx)("span",{className:"hero-filter-tag",children:"Numerology"})]})]})]})}),(0,ad.jsx)("div",{className:"row",style:{gap:"1.5rem"},children:0===E.length?(0,ad.jsx)("div",{className:"col-12 text-center py-5",children:(0,ad.jsx)("p",{children:"No consultants found."})}):E.map(e=>{const t=r,n=e.id;return(0,ad.jsx)("div",{className:"col-lg-4 col-md-6 col-sm-12",children:(0,ad.jsx)("div",{className:"card shadow-sm border-0 consultant-card",onClick:()=>((e,t)=>{console.log("targetShop","rohit-12345839.myshopify.com","hostQuery",""),window.top.location.href="https://".concat(u,"/apps/consultant-theme/view-profile?consultantId=").concat(t,"&shopId=").concat(e).concat("")})(t,n),style:{cursor:"pointer"},children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsxs)("div",{className:"flex align-items-start mb-3",children:[(0,ad.jsxs)("div",{className:"me-3 position-relative flex-shrink-0",children:[(0,ad.jsx)("img",{src:e.image||"/images/flag/teamdefault.png",alt:e.name,className:"rounded-circle profile-image",onError:e=>{e.target.src="/images/flag/teamdefault.png"}}),e.isActive&&(0,ad.jsx)("span",{className:"active-status-dot"})]}),(0,ad.jsxs)("div",{className:"flex-grow-1",children:[(0,ad.jsxs)("div",{className:"flex align-items-center gap-2 mb-2",children:[(0,ad.jsx)("h5",{className:"card-title mb-0 fw-bold consultant-name",children:e.name}),(0,ad.jsxs)("span",{className:"experience-badge",children:[e.experience,"+ Years of Experience"]})]}),(0,ad.jsx)("p",{className:"mb-2 consultant-profession",children:e.profession}),(0,ad.jsxs)("div",{className:"flex align-items-center gap-2 flex-wrap",children:[(0,ad.jsx)("div",{className:"rating-stars",children:y(e.rating)}),(0,ad.jsx)("span",{className:"rating-text",children:e.rating}),(0,ad.jsxs)("span",{className:"testimonials-text",children:["(",e.testimonials," testimonials)"]})]})]})]}),(0,ad.jsx)("hr",{className:"card-divider"}),(0,ad.jsxs)("div",{className:"mb-0",children:[(0,ad.jsxs)("p",{className:"mb-2 consultant-info",children:[(0,ad.jsx)("strong",{children:"Speaks:"})," ",e.languages.join(", ")]}),(0,ad.jsxs)("div",{className:"mb-0",children:[(0,ad.jsx)("strong",{className:"consultant-info d-block mb-2",children:"Calling Options:"}),(0,ad.jsxs)("div",{className:"calling-options",children:[(0,ad.jsxs)("button",{className:"calling-option-btn chat-btn",onClick:t=>{var n;t.stopPropagation(),n=e.id,console.log("consultantView",n),window.top.location.href="https://".concat(u,"/apps/consultant-theme/chats-c?consultantId=").concat(n).concat("")},children:[(0,ad.jsxs)("div",{className:"calling-option-content",children:[(0,ad.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ad.jsx)("path",{d:"M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,ad.jsx)("span",{className:"calling-option-label",children:"Chat"})]}),(0,ad.jsxs)("span",{className:"calling-option-price",children:["INR ",e.chatPrice.toLocaleString()]})]}),(0,ad.jsxs)("button",{className:"calling-option-btn audio-btn",onClick:t=>{t.stopPropagation(),S({receiverId:e.id,type:"voice"})},children:[(0,ad.jsxs)("div",{className:"calling-option-content",children:[(0,ad.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-phone-icon lucide-phone",children:(0,ad.jsx)("path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384"})}),(0,ad.jsx)("span",{className:"calling-option-label",children:"Audio"})]}),(0,ad.jsxs)("span",{className:"calling-option-price",children:["INR ",e.audioPrice.toLocaleString()]})]}),(0,ad.jsxs)("button",{className:"calling-option-btn video-btn",onClick:t=>{t.stopPropagation(),S({receiverId:e.id,type:"video"})},children:[(0,ad.jsxs)("div",{className:"calling-option-content",children:[(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("path",{d:"M23 7L16 12L23 17V7Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("path",{d:"M14 5H3C1.9 5 1 5.9 1 7V17C1 18.1 1.9 19 3 19H14C15.1 19 16 18.1 16 17V7C16 5.9 15.1 5 14 5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,ad.jsx)("span",{className:"calling-option-label",children:"Video"})]}),(0,ad.jsxs)("span",{className:"calling-option-price",children:["INR ",e.videoPrice.toLocaleString()]})]})]})]})]})]})})},e.id)})})]})})};const Lw=function(){var e;he();const t=tv(),n=new URLSearchParams(window.location.search),r=n.get("consultantId"),o=n.get("shopId"),a=n.get("shop"),{consultantOverview:s,loading:c}=iv(e=>e.consultants);(0,i.useEffect)(()=>{t(kE({shop_id:o,consultant_id:r}))},[t,o,r]),(0,i.useEffect)(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})},[]);const l=null===s||void 0===s?void 0:s.consultant;console.log("consultantView",l);const d="".concat("https://test-online-consultation.zend-apps.com","/").concat(null===l||void 0===l||null===(e=l.profileImage)||void 0===e?void 0:e.replace("\\","/")),u={id:"691dbba35e388352e3203b0b",name:"Arlene McCoy",image:"https://images.pexels.com/photos/1704488/pexels-photo-1704488.jpeg?cs=srgb&dl=pexels-suliman-sallehi-1704488.jpg&fm=jpg",profession:"Psychologist - Adult, Adolescent",languages:["Hindi","English"],experience:12,rating:4.5,testimonials:23,startingPrice:1200,chatPrice:800,audioPrice:1200,videoPrice:1500,expertise:["Depression","Anxiety","Family","Couple"],isActive:!0,about:"Arlene McCoy is a licensed psychologist with over 12 years of experience in helping individuals, couples, and families navigate through life's challenges. She specializes in treating depression, anxiety disorders, and relationship issues. Her compassionate approach and evidence-based techniques have helped hundreds of clients achieve better mental health and well-being.",education:"Ph.D. in Clinical Psychology, Master's in Counseling Psychology",certifications:["Licensed Clinical Psychologist","Certified Family Therapist","Cognitive Behavioral Therapy Specialist"],reviews:[{name:"Rajesh Kumar",rating:5,comment:"Excellent therapist! Helped me overcome my anxiety.",date:"2 weeks ago"},{name:"Priya Sharma",rating:5,comment:"Very understanding and professional. Highly recommend!",date:"1 month ago"},{name:"Amit Patel",rating:4,comment:"Good experience overall. Would visit again.",date:"2 months ago"}]},h=async e=>{let{receiverId:t,type:n}=e;console.log("helloo???????????????????"),console.log("startCall_________________",t,n),await Pw({receiverId:t,type:n,userId:"69328ff18736b56002ef83df",shop:a})},p=e=>{const t=Math.floor(e),n=e%1!==0,r=5-t-(n?1:0);return(0,ad.jsxs)(ad.Fragment,{children:[Array.from({length:t},(e,t)=>(0,ad.jsx)("span",{className:"star-full",children:"\u2605"},"full-".concat(t))),n&&(0,ad.jsx)("span",{className:"star-half",children:"\u2605"}),Array.from({length:r},(e,t)=>(0,ad.jsx)("span",{className:"star-empty",children:"\u2605"},"empty-".concat(t)))]})},m=(e,t,n)=>{console.log("Selected ".concat(e," option for consultant ").concat(t," at price INR ").concat(n)),alert("You selected ".concat(e.toUpperCase()," call option.\nConsultant ID: ").concat(t,"\nPrice: INR ").concat(n.toLocaleString()))};return(0,ad.jsx)("div",{className:"view-profile-container",children:(0,ad.jsxs)("div",{className:"container py-4",children:[(0,ad.jsxs)("button",{className:"btn btn-link back-button mb-3",onClick:()=>(()=>{const e=a;console.log("targetShop",e,"hostQuery",""),window.top.location.href="https://".concat(e,"/apps/consultant-theme/consultant-cards").concat("")})(),children:[(0,ad.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px",verticalAlign:"middle"},children:(0,ad.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Consultants"]}),(0,ad.jsx)("div",{className:"card shadow-sm border-0 mb-4 profile-header-card",children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsxs)("div",{className:"flex align-items-start mb-3",children:[(0,ad.jsxs)("div",{className:"me-4 position-relative flex-shrink-0",children:[(0,ad.jsx)("img",{src:d,alt:null===l||void 0===l?void 0:l.fullname,className:"rounded-circle profile-image profile-image-large",onError:e=>{e.target.src="/images/teamdefault.png"}}),u.isActive&&(0,ad.jsx)("span",{className:"active-status-dot active-status-dot-large"})]}),(0,ad.jsxs)("div",{className:"flex-grow-1",children:[(0,ad.jsxs)("div",{className:"flex align-items-center gap-2 mb-3",children:[(0,ad.jsx)("h5",{className:"card-title mb-0 fw-bold consultant-name consultant-name-large",children:null===l||void 0===l?void 0:l.fullname}),(0,ad.jsxs)("span",{className:"experience-badge experience-badge-large",children:[null===l||void 0===l?void 0:l.experience,"+ Years of Experience"]})]}),(0,ad.jsx)("p",{className:"mb-3 consultant-profession consultant-profession-large",children:u.profession}),(0,ad.jsxs)("div",{className:"flex align-items-center gap-2 flex-wrap mb-3",children:[(0,ad.jsx)("div",{className:"rating-stars rating-stars-large",children:p(u.rating)}),(0,ad.jsx)("span",{className:"rating-text rating-text-large",children:u.rating}),(0,ad.jsxs)("span",{className:"testimonials-text testimonials-text-large",children:["(",u.testimonials," testimonials)"]})]})]})]}),(0,ad.jsx)("hr",{className:"card-divider"}),(0,ad.jsxs)("div",{className:"mb-0",children:[(0,ad.jsxs)("p",{className:"mb-2 consultant-info",children:[(0,ad.jsx)("strong",{children:"Speaks:"})," ",u.languages.join(", ")]}),(0,ad.jsxs)("div",{className:"mb-0",children:[(0,ad.jsx)("strong",{className:"consultant-info d-block mb-2",children:"Calling Options:"}),(0,ad.jsxs)("div",{className:"calling-options",children:[(0,ad.jsxs)("button",{className:"calling-option-btn chat-btn border-0",onClick:e=>{e.stopPropagation(),(e=>{console.log("consultantView______",e);const t=a;console.log("targetShop",t,"hostQuery",""),window.top.location.href="https://".concat(t,"/apps/consultant-theme/chats-c?consultantId=").concat(e).concat("")})(null===l||void 0===l?void 0:l._id)},children:[(0,ad.jsxs)("div",{className:"calling-option-content",children:[(0,ad.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ad.jsx)("path",{d:"M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,ad.jsx)("span",{className:"calling-option-label",children:"Chat"})]}),(0,ad.jsxs)("span",{className:"calling-option-price",children:["Coins ",null===l||void 0===l?void 0:l.chatCost," per min"]})]}),(0,ad.jsxs)("button",{className:"calling-option-btn audio-btn",onClick:e=>{h({receiverId:null===l||void 0===l?void 0:l._id,type:"voice"})},children:[(0,ad.jsxs)("div",{className:"calling-option-content",children:[(0,ad.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-phone-icon lucide-phone",children:(0,ad.jsx)("path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384"})}),(0,ad.jsx)("span",{className:"calling-option-label",children:"Voice Call"})]}),(0,ad.jsxs)("span",{className:"calling-option-price",children:["INR ",null===l||void 0===l?void 0:l.voiceCallCost]})]}),(0,ad.jsxs)("button",{className:"calling-option-btn video-btn",onClick:e=>{h({receiverId:null===l||void 0===l?void 0:l._id,type:"video"})},children:[(0,ad.jsxs)("div",{className:"calling-option-content",children:[(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("path",{d:"M23 7L16 12L23 17V7Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("path",{d:"M14 5H3C1.9 5 1 5.9 1 7V17C1 18.1 1.9 19 3 19H14C15.1 19 16 18.1 16 17V7C16 5.9 15.1 5 14 5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,ad.jsx)("span",{className:"calling-option-label",children:"Video"})]}),(0,ad.jsxs)("span",{className:"calling-option-price",children:["INR ",null===l||void 0===l?void 0:l.videoCallCost]})]})]})]})]})]})}),(0,ad.jsxs)("div",{className:"row",children:[(0,ad.jsxs)("div",{className:"col-lg-8",children:[(0,ad.jsx)("div",{className:"card shadow-sm border-0 mb-4",children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsx)("h3",{className:"section-title mb-3",children:"About"}),(0,ad.jsx)("p",{className:"about-text",children:u.about})]})}),(0,ad.jsx)("div",{className:"card shadow-sm border-0 mb-4",children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsx)("h3",{className:"section-title mb-3",children:"Education & Certifications"}),(0,ad.jsxs)("div",{className:"mb-3",children:[(0,ad.jsx)("h5",{className:"subsection-title",children:"Education"}),(0,ad.jsx)("p",{className:"info-text",children:u.education})]}),(0,ad.jsxs)("div",{children:[(0,ad.jsx)("h5",{className:"subsection-title",children:"Certifications"}),(0,ad.jsx)("ul",{className:"certifications-list",children:u.certifications.map((e,t)=>(0,ad.jsx)("li",{children:e},t))})]})]})}),(0,ad.jsx)("div",{className:"card shadow-sm border-0 mb-4",children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsx)("h3",{className:"section-title mb-3",children:"Reviews & Testimonials"}),(0,ad.jsx)("div",{className:"reviews-list",children:u.reviews.map((e,t)=>(0,ad.jsxs)("div",{className:"review-item",children:[(0,ad.jsx)("div",{className:"flex justify-content-between align-items-start mb-2",children:(0,ad.jsxs)("div",{children:[(0,ad.jsx)("h6",{className:"reviewer-name mb-1",children:e.name}),(0,ad.jsxs)("div",{className:"flex align-items-center gap-2",children:[(0,ad.jsx)("div",{className:"rating-stars-small",children:p(e.rating)}),(0,ad.jsx)("span",{className:"review-date",children:e.date})]})]})}),(0,ad.jsx)("p",{className:"review-comment mb-0",children:e.comment})]},t))})]})})]}),(0,ad.jsxs)("div",{className:"col-lg-4",children:[(0,ad.jsx)("div",{className:"card shadow-sm border-0 mb-4",children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsx)("h3",{className:"section-title mb-3",children:"Expertise"}),(0,ad.jsx)("div",{className:"expertise-tags",children:u.expertise.map((e,t)=>(0,ad.jsx)("span",{className:"expertise-tag",children:e},t))})]})}),(0,ad.jsx)("div",{className:"card shadow-sm border-0",children:(0,ad.jsxs)("div",{className:"card-body p-4",children:[(0,ad.jsx)("h3",{className:"section-title mb-3",children:"Calling Options"}),(0,ad.jsxs)("div",{className:"calling-options-profile-sidebar",children:[(0,ad.jsx)("button",{className:"calling-option-btn chat-btn",onClick:()=>m("chat",u.id,u.chatPrice),title:"Chat - INR ".concat(u.chatPrice.toLocaleString()),children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ad.jsx)("path",{d:"M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,ad.jsx)("button",{className:"calling-option-btn audio-btn",onClick:()=>m("audio",u.id,u.audioPrice),title:"Audio Call - INR ".concat(u.audioPrice.toLocaleString()),children:(0,ad.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-phone-icon lucide-phone",children:(0,ad.jsx)("path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384"})})}),(0,ad.jsx)("button",{className:"calling-option-btn video-btn",onClick:()=>m("video",u.id,u.videoPrice),title:"Video Call - INR ".concat(u.videoPrice.toLocaleString()),children:(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ad.jsx)("path",{d:"M23 7L16 12L23 17V7Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,ad.jsx)("path",{d:"M14 5H3C1.9 5 1 5.9 1 7V17C1 18.1 1.9 19 3 19H14C15.1 19 16 18.1 16 17V7C16 5.9 15.1 5 14 5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]})})]})]})]})})},Mw="TabNavigation_dashboardWrapper__2J9DL",Uw="TabNavigation_videoCallMode__sy9Mc",Fw="TabNavigation_mainContainer__jOtzd",jw="TabNavigation_contentArea__GPd-p",Vw="TabNavigation_content__VLV5E",Bw="TabNavigation_mobileToggleButton__O2ofP",Ww="TabNavigation_mobileOverlay__LFZzH",Hw="TabNavigation_sideNav__pqkQi",Gw="TabNavigation_profileSection__23O-y",zw="TabNavigation_profileImage__cg25O",Kw="TabNavigation_profileDetails__qdBko",Yw="TabNavigation_profileName__YnNK3",qw="TabNavigation_profileEmail__kafhN",Xw="TabNavigation_profileButton__pyDfk",Jw="TabNavigation_navTabs__tc31J",Zw="TabNavigation_navTabList__xuGyF",Qw="TabNavigation_navTab__QnxQ6",$w="TabNavigation_navTabIcon__T8djE",eR="TabNavigation_navTabActive__cejUz",tR="TabNavigation_navTabLabel__cCWj2",nR="TabNavigation_sideNavOpen__-oC7N",rR="DashboardPage_pageContainer__S5V5N",iR="DashboardPage_headerSection__xHjf3",oR="DashboardPage_pageTitle__F144D",aR="DashboardPage_pageDescription__IqSQ7",sR="DashboardPage_statsGrid__Y8t1L",cR="DashboardPage_statCard__I9o4D",lR="DashboardPage_statCardBody__+pvHE",dR="DashboardPage_statHeader__3oubU",uR="DashboardPage_statLabel__-pjJ9",hR="DashboardPage_statValue__iFaEy",pR="DashboardPage_statIcon__kswHc",mR="DashboardPage_statFooter__+C8Xz",fR="DashboardPage_statChange__mMuCS",gR="DashboardPage_statChangeSuccess__wdtY6",_R="DashboardPage_contentGrid__QgDdq",vR="DashboardPage_chartCardBody__72h1A",bR="DashboardPage_tableCardBody__bKxSn",ER="DashboardPage_chartHeader__xuc+r",yR="DashboardPage_chartTitle__GGxjP",SR="DashboardPage_chartSubtitle__tuWvT",TR="DashboardPage_chartContainer__ymUR-",CR="DashboardPage_quickStatsTitle__uHOOr",wR="DashboardPage_tableHeader__fNowt",RR="DashboardPage_tableTitle__JcuiO",AR="DashboardPage_tableSubtitle__yq3nr",IR="DashboardPage_tableWrapper__r0z2P",NR="DashboardPage_table__YDSqM",OR="DashboardPage_tableHeadCell__F3g7d",PR="DashboardPage_tableCell__9fd2V",kR="DashboardPage_userAvatar__bRCgm",DR="DashboardPage_viewButton__2ua1E",xR="DashboardPage_chartCard__Fh6fy",LR="DashboardPage_chartSelect__pUuLR",MR="DashboardPage_chartLabels__ia5nb",UR="DashboardPage_quickStatsCard__YY78y",FR="DashboardPage_statItem__e42Xl",jR="DashboardPage_statItemHeader__ufCAy",VR="DashboardPage_progressBar__okVuO",BR="DashboardPage_progressFill__EW1zs",WR="DashboardPage_progressPrimary__mxoi5",HR="DashboardPage_progressSuccess__fSCcj",GR="DashboardPage_progressWarning__KYft0",zR="DashboardPage_progressInfo__tOgD3",KR="DashboardPage_tableCard__blvul",YR="DashboardPage_tableButton__LCH48",qR="DashboardPage_tableHead__W3Ypl",XR="DashboardPage_tableHeadCellRight__XlXA+",JR="DashboardPage_tableRow__JJiFz",ZR="DashboardPage_tableCellRight__tw7cD",QR="DashboardPage_userInfo__br16M",$R="DashboardPage_userName__bC0Et",eA="DashboardPage_badge__Gp+hX",tA="DashboardPage_badgePrimary__69H0y",nA="DashboardPage_badgeSuccess__BB3Nw",rA="DashboardPage_badgeWarning__i716l",iA="DashboardPage_amount__SqSDK",oA="DashboardPage_flex__dEfrQ",aA="DashboardPage_flexBetween__S214M",sA="DashboardPage_flexCenter__YGMfR",cA="DashboardPage_flexStart__J3t2K",lA="DashboardPage_textMuted__6Pq9k",dA="DashboardPage_textPrimary__zEPIA",uA="DashboardPage_badgeSecondary__ykJ5L",hA=()=>{const e=124,t=18,n=45200,r=4.8,i=[45,52,48,61,55,68,72,65,70,75,80,78];return(0,ad.jsxs)("div",{className:rR,children:[(0,ad.jsxs)("div",{className:iR,children:[(0,ad.jsx)("h1",{className:oR,children:"Dashboard Overview"}),(0,ad.jsx)("p",{className:aR,children:"Welcome back! Here's what's happening with your consultancy today."})]}),(0,ad.jsxs)("div",{className:sR,children:[(0,ad.jsx)("div",{className:cR,children:(0,ad.jsxs)("div",{className:lR,children:[(0,ad.jsxs)("div",{className:"".concat(dR," ").concat(aA," ").concat(cA),children:[(0,ad.jsxs)("div",{children:[(0,ad.jsx)("p",{className:uR,children:"Total Clients"}),(0,ad.jsx)("h3",{className:hR,children:e})]}),(0,ad.jsx)("div",{className:pR,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,ad.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,ad.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),(0,ad.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})})]}),(0,ad.jsx)("div",{className:"".concat(mR," ").concat(oA," ").concat(sA),children:(0,ad.jsxs)("span",{className:"".concat(fR," ").concat(gR),style:{fontSize:"13px",fontWeight:"600"},children:[(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",style:{display:"inline",marginRight:"4px"},children:[(0,ad.jsx)("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),(0,ad.jsx)("polyline",{points:"17 6 23 6 23 12"})]}),"+12% from last month"]})})]})}),(0,ad.jsx)("div",{className:cR,children:(0,ad.jsxs)("div",{className:lR,children:[(0,ad.jsxs)("div",{className:"".concat(dR," ").concat(aA," ").concat(cA),children:[(0,ad.jsxs)("div",{children:[(0,ad.jsx)("p",{className:uR,children:"Active Consultations"}),(0,ad.jsx)("h3",{className:hR,children:t})]}),(0,ad.jsx)("div",{className:pR,style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,ad.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})})]}),(0,ad.jsx)("div",{className:"".concat(mR," ").concat(oA," ").concat(sA),children:(0,ad.jsxs)("span",{className:"".concat(fR," ").concat(dA),style:{fontSize:"13px",fontWeight:"600"},children:[(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",style:{display:"inline",marginRight:"4px"},children:[(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,ad.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),"8 pending reviews"]})})]})}),(0,ad.jsx)("div",{className:cR,children:(0,ad.jsxs)("div",{className:lR,children:[(0,ad.jsxs)("div",{className:"".concat(dR," ").concat(aA," ").concat(cA),children:[(0,ad.jsxs)("div",{children:[(0,ad.jsx)("p",{className:uR,children:"Monthly Revenue"}),(0,ad.jsxs)("h3",{className:hR,children:["$",(n/1e3).toFixed(1),"k"]})]}),(0,ad.jsx)("div",{className:pR,style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},children:(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,ad.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})})]}),(0,ad.jsx)("div",{className:"".concat(mR," ").concat(oA," ").concat(sA),children:(0,ad.jsxs)("span",{className:"".concat(fR," ").concat(gR),style:{fontSize:"13px",fontWeight:"600"},children:[(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",style:{display:"inline",marginRight:"4px"},children:[(0,ad.jsx)("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),(0,ad.jsx)("polyline",{points:"17 6 23 6 23 12"})]}),"+18% from last month"]})})]})}),(0,ad.jsx)("div",{className:cR,children:(0,ad.jsxs)("div",{className:lR,children:[(0,ad.jsxs)("div",{className:"".concat(dR," ").concat(aA," ").concat(cA),children:[(0,ad.jsxs)("div",{children:[(0,ad.jsx)("p",{className:uR,children:"Average Rating"}),(0,ad.jsx)("h3",{className:hR,children:r})]}),(0,ad.jsx)("div",{className:pR,style:{background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)"},children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,ad.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})})]}),(0,ad.jsxs)("div",{className:"".concat(mR," ").concat(oA," ").concat(sA),children:[(0,ad.jsx)("div",{className:oA,children:[...Array(5)].map((e,t)=>(0,ad.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:t<Math.floor(r)?"#ffc107":"#e9ecef",stroke:t<Math.floor(r)?"#ffc107":"#e9ecef",style:{marginRight:"2px"},children:(0,ad.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})},t))}),(0,ad.jsx)("span",{className:lA,style:{fontSize:"13px",marginLeft:"8px"},children:"Based on 89 reviews"})]})]})})]}),(0,ad.jsxs)("div",{className:_R,children:[(0,ad.jsx)("div",{className:xR,children:(0,ad.jsxs)("div",{className:vR,children:[(0,ad.jsxs)("div",{className:"".concat(ER," ").concat(aA," ").concat(sA),children:[(0,ad.jsxs)("div",{children:[(0,ad.jsx)("h5",{className:yR,children:"Revenue Overview"}),(0,ad.jsx)("p",{className:SR,children:"Last 12 months performance"})]}),(0,ad.jsxs)("select",{className:LR,children:[(0,ad.jsx)("option",{children:"Last 12 Months"}),(0,ad.jsx)("option",{children:"Last 6 Months"}),(0,ad.jsx)("option",{children:"Last 3 Months"})]})]}),(0,ad.jsx)("div",{className:TR,children:(0,ad.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 400 200",preserveAspectRatio:"none",style:{overflow:"visible"},children:[(0,ad.jsx)("defs",{children:(0,ad.jsxs)("linearGradient",{id:"chartGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,ad.jsx)("stop",{offset:"0%",stopColor:"#4a90e2",stopOpacity:"0.3"}),(0,ad.jsx)("stop",{offset:"100%",stopColor:"#4a90e2",stopOpacity:"0.05"})]})}),[0,1,2,3,4].map(e=>(0,ad.jsx)("line",{x1:"0",y1:40+40*e,x2:"400",y2:40+40*e,stroke:"#e9ecef",strokeWidth:"1"},e)),(0,ad.jsx)("path",{d:"M 0,".concat(200-i[0]/100*120," ").concat(i.map((e,t)=>"L ".concat((t+1)*(400/i.length),",").concat(200-e/100*120)).join(" ")," L 400,200 L 0,200 Z"),fill:"url(#chartGradient)"}),(0,ad.jsx)("polyline",{points:i.map((e,t)=>"".concat((t+.5)*(400/i.length),",").concat(200-e/100*120)).join(" "),fill:"none",stroke:"#4a90e2",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),i.map((e,t)=>(0,ad.jsx)("circle",{cx:(t+.5)*(400/i.length),cy:200-e/100*120,r:"4",fill:"#4a90e2",stroke:"white",strokeWidth:"2"},t))]})}),(0,ad.jsx)("div",{className:"".concat(MR," ").concat(aA),children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((e,t)=>(0,ad.jsx)("span",{children:e},t))})]})}),(0,ad.jsx)("div",{className:UR,children:(0,ad.jsxs)("div",{className:vR,children:[(0,ad.jsx)("h5",{className:CR,children:"Quick Stats"}),(0,ad.jsxs)("div",{className:FR,children:[(0,ad.jsxs)("div",{className:"".concat(jR," ").concat(aA," ").concat(sA),children:[(0,ad.jsx)("span",{className:lA,style:{fontSize:"14px"},children:"Consultations Today"}),(0,ad.jsx)("span",{style:{fontSize:"18px",fontWeight:"600",color:"#212529"},children:"5"})]}),(0,ad.jsx)("div",{className:VR,children:(0,ad.jsx)("div",{className:"".concat(BR," ").concat(WR),style:{width:"62%"}})})]}),(0,ad.jsxs)("div",{className:FR,children:[(0,ad.jsxs)("div",{className:"".concat(jR," ").concat(aA," ").concat(sA),children:[(0,ad.jsx)("span",{className:lA,style:{fontSize:"14px"},children:"Response Rate"}),(0,ad.jsx)("span",{style:{fontSize:"18px",fontWeight:"600",color:"#212529"},children:"94%"})]}),(0,ad.jsx)("div",{className:VR,children:(0,ad.jsx)("div",{className:"".concat(BR," ").concat(HR),style:{width:"94%"}})})]}),(0,ad.jsxs)("div",{className:FR,children:[(0,ad.jsxs)("div",{className:"".concat(jR," ").concat(aA," ").concat(sA),children:[(0,ad.jsx)("span",{className:lA,style:{fontSize:"14px"},children:"Client Satisfaction"}),(0,ad.jsx)("span",{style:{fontSize:"18px",fontWeight:"600",color:"#212529"},children:"96%"})]}),(0,ad.jsx)("div",{className:VR,children:(0,ad.jsx)("div",{className:"".concat(BR," ").concat(GR),style:{width:"96%"}})})]}),(0,ad.jsxs)("div",{className:FR,children:[(0,ad.jsxs)("div",{className:"".concat(jR," ").concat(aA," ").concat(sA),children:[(0,ad.jsx)("span",{className:lA,style:{fontSize:"14px"},children:"Completion Rate"}),(0,ad.jsx)("span",{style:{fontSize:"18px",fontWeight:"600",color:"#212529"},children:"88%"})]}),(0,ad.jsx)("div",{className:VR,children:(0,ad.jsx)("div",{className:"".concat(BR," ").concat(zR),style:{width:"88%"}})})]})]})})]}),(0,ad.jsx)("div",{className:KR,children:(0,ad.jsxs)("div",{className:bR,children:[(0,ad.jsxs)("div",{className:"".concat(wR," ").concat(aA," ").concat(sA),children:[(0,ad.jsxs)("div",{children:[(0,ad.jsx)("h5",{className:RR,children:"Recent Consultations"}),(0,ad.jsx)("p",{className:AR,children:"Latest client interactions and consultations"})]}),(0,ad.jsx)("button",{className:YR,style:{fontSize:"13px"},children:"View All"})]}),(0,ad.jsx)("div",{className:IR,children:(0,ad.jsxs)("table",{className:NR,children:[(0,ad.jsx)("thead",{className:qR,children:(0,ad.jsxs)("tr",{children:[(0,ad.jsx)("th",{className:OR,children:"Client"}),(0,ad.jsx)("th",{className:OR,children:"Type"}),(0,ad.jsx)("th",{className:OR,children:"Date"}),(0,ad.jsx)("th",{className:OR,children:"Status"}),(0,ad.jsx)("th",{className:"".concat(OR," ").concat(XR),children:"Amount"}),(0,ad.jsx)("th",{className:"".concat(OR," ").concat(XR),children:"Action"})]})}),(0,ad.jsx)("tbody",{children:[{id:1,client:"Sarah Johnson",type:"Business Strategy",date:"2024-01-15",status:"Active",amount:1200},{id:2,client:"Michael Chen",type:"Financial Planning",date:"2024-01-14",status:"Completed",amount:850},{id:3,client:"Emily Rodriguez",type:"Marketing Consultation",date:"2024-01-13",status:"Active",amount:950},{id:4,client:"David Kim",type:"Technology Advisory",date:"2024-01-12",status:"Scheduled",amount:1500},{id:5,client:"Lisa Anderson",type:"HR Consulting",date:"2024-01-11",status:"Completed",amount:1100}].map(e=>{return(0,ad.jsxs)("tr",{className:JR,children:[(0,ad.jsx)("td",{className:PR,children:(0,ad.jsxs)("div",{className:"".concat(QR," ").concat(oA," ").concat(sA),children:[(0,ad.jsx)("div",{className:kR,children:e.client.split(" ").map(e=>e[0]).join("")}),(0,ad.jsx)("div",{children:(0,ad.jsx)("div",{className:$R,children:e.client})})]})}),(0,ad.jsx)("td",{className:PR,style:{fontSize:"14px",color:"#6c757d"},children:e.type}),(0,ad.jsx)("td",{className:PR,style:{fontSize:"14px",color:"#6c757d"},children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,ad.jsx)("td",{className:PR,children:(0,ad.jsx)("span",{className:"".concat(eA," ").concat((t=e.status,{Active:tA,Completed:nA,Scheduled:rA}[t]||uA)),children:e.status})}),(0,ad.jsxs)("td",{className:"".concat(PR," ").concat(ZR," ").concat(iA),children:["$",e.amount.toLocaleString()]}),(0,ad.jsx)("td",{className:"".concat(PR," ").concat(ZR),children:(0,ad.jsx)("button",{className:DR,children:"View"})})]},e.id);var t})})]})})]})})]})},pA="UsersPage_pageContainer__ybDOU",mA="UsersPage_headerSection__6K8NP",fA="UsersPage_pageTitle__wjmwi",gA="UsersPage_pageDescription__UiPPI",_A="UsersPage_searchCard__Dr0Ek",vA="UsersPage_searchCardBody__cE6Dr",bA="UsersPage_searchInputWrapper__KPZ85",EA="UsersPage_searchIcon__W-UZj",yA="UsersPage_searchInput__dRCcr",SA="UsersPage_resultsCount__rFjPj",TA="UsersPage_resultsText__DYJ8o",CA="UsersPage_tableCard__kdtGY",wA="UsersPage_tableCardBody__Zyzyx",RA="UsersPage_tableWrapper__1rKZM",AA="UsersPage_table__6C3Jw",IA="UsersPage_tableHead__w--oF",NA="UsersPage_tableHeadCell__Fc9VA",OA="UsersPage_tableHeadCellRight__Fohsl",PA="UsersPage_tableRow__5Z7AK",kA="UsersPage_tableCell__W4IyD",DA="UsersPage_tableCellRight__hRicR",xA="UsersPage_userInfo__hE-uR",LA="UsersPage_userAvatar__Of2VK",MA="UsersPage_userName__ypy6G",UA="UsersPage_userEmail__+sN5r",FA="UsersPage_badge__9p-I1",jA="UsersPage_badgeSuccess__mEjdI",VA="UsersPage_badgeSecondary__d7kVe",BA="UsersPage_badgeWarning__BzQIP",WA="UsersPage_starRating__QenHy",HA="UsersPage_stars__+k6UH",GA="UsersPage_ratingValue__wHLnH",zA="UsersPage_emptyState__JqjKr",KA="UsersPage_emptyIcon__cUPAH",YA="UsersPage_emptyText__26RDx",qA="UsersPage_emptySubtext__LRHZX",XA="UsersPage_pagination__A7gYI",JA="UsersPage_paginationInfo__L2Zvr",ZA="UsersPage_paginationNav__FBGl7",QA="UsersPage_paginationItem__YOoNW",$A="UsersPage_paginationLink__COARO",eI="UsersPage_paginationLinkActive__6KRgv",tI="UsersPage_paginationLinkDisabled__gmm4Q",nI="UsersPage_button__Z-cWG",rI="UsersPage_buttonIcon__aQMnZ",iI="UsersPage_flex__1sh7f",oI="UsersPage_flexCenter__ybCfP",aI="UsersPage_textMuted__TC8ja",sI=()=>{const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)("name"),[o,a]=(0,i.useState)("asc"),s=[{id:1,name:"Sarah Johnson",email:"sarah.johnson@example.com",role:"Senior Consultant",status:"Active",joinDate:"2023-01-15",consultations:45,rating:4.9,avatar:"SJ"}],c=(0,i.useMemo)(()=>s.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase())||t.role.toLowerCase().includes(e.toLowerCase())),[e]),l=(0,i.useMemo)(()=>[...c].sort((e,t)=>{let r=e[n],i=t[n];return"name"!==n&&"email"!==n&&"role"!==n||(r=r.toLowerCase(),i=i.toLowerCase()),"asc"===o?r>i?1:-1:r<i?-1:1}),[c,n,o]),d=e=>{n===e?a("asc"===o?"desc":"asc"):(r(e),a("asc"))},u=e=>{let{field:t}=e;return n!==t?(0,ad.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{opacity:.3,marginLeft:"4px"},children:[(0,ad.jsx)("path",{d:"M8 9l4-4 4 4"}),(0,ad.jsx)("path",{d:"M8 15l4 4 4-4"})]}):"asc"===o?(0,ad.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:(0,ad.jsx)("path",{d:"M8 9l4-4 4 4"})}):(0,ad.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"4px"},children:(0,ad.jsx)("path",{d:"M8 15l4 4 4-4"})})};return(0,ad.jsxs)("div",{className:pA,children:[(0,ad.jsxs)("div",{className:mA,children:[(0,ad.jsx)("h1",{className:fA,children:"User Management"}),(0,ad.jsx)("p",{className:gA,children:"Manage consultants, track performance, and monitor user activity."})]}),(0,ad.jsx)("div",{className:_A,children:(0,ad.jsxs)("div",{className:vA,children:[(0,ad.jsxs)("div",{className:bA,children:[(0,ad.jsxs)("svg",{className:EA,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,ad.jsx)("path",{d:"m21 21-4.35-4.35"})]}),(0,ad.jsx)("input",{type:"text",className:yA,placeholder:"Search users by name, email, or role...",value:e,onChange:e=>t(e.target.value)})]}),(0,ad.jsx)("div",{className:SA,children:(0,ad.jsxs)("div",{className:TA,children:["Showing ",(0,ad.jsx)("strong",{children:l.length})," of ",(0,ad.jsx)("strong",{children:s.length})," users"]})})]})}),(0,ad.jsx)("div",{className:CA,children:(0,ad.jsxs)("div",{className:wA,children:[(0,ad.jsx)("div",{className:RA,children:(0,ad.jsxs)("table",{className:AA,children:[(0,ad.jsx)("thead",{className:IA,children:(0,ad.jsxs)("tr",{children:[(0,ad.jsx)("th",{className:NA,onClick:()=>d("name"),children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["User",(0,ad.jsx)(u,{field:"name"})]})}),(0,ad.jsx)("th",{className:NA,onClick:()=>d("role"),children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["Role",(0,ad.jsx)(u,{field:"role"})]})}),(0,ad.jsx)("th",{className:NA,onClick:()=>d("status"),children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["Status",(0,ad.jsx)(u,{field:"status"})]})}),(0,ad.jsx)("th",{className:NA,children:"Consultations"}),(0,ad.jsx)("th",{className:NA,children:"Rating"}),(0,ad.jsx)("th",{className:NA,onClick:()=>d("joinDate"),children:(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["Join Date",(0,ad.jsx)(u,{field:"joinDate"})]})}),(0,ad.jsx)("th",{className:"".concat(NA," ").concat(OA),children:"Actions"})]})}),(0,ad.jsx)("tbody",{children:0===l.length?(0,ad.jsx)("tr",{children:(0,ad.jsx)("td",{colSpan:"7",className:zA,children:(0,ad.jsxs)("div",{children:[(0,ad.jsxs)("svg",{className:KA,width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,ad.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,ad.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,ad.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),(0,ad.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),(0,ad.jsx)("p",{className:YA,children:"No users found"}),(0,ad.jsx)("p",{className:qA,children:"Try adjusting your search or filter criteria"})]})})}):l.map(e=>{const t=(n=e.status,{Active:{class:jA,text:"Active"},Inactive:{class:VA,text:"Inactive"},Pending:{class:BA,text:"Pending"}}[n]||{class:VA,text:n});var n;return(0,ad.jsxs)("tr",{className:PA,children:[(0,ad.jsx)("td",{className:kA,children:(0,ad.jsxs)("div",{className:"".concat(xA," ").concat(iI," ").concat(oI),children:[(0,ad.jsx)("div",{className:LA,children:e.avatar}),(0,ad.jsxs)("div",{children:[(0,ad.jsx)("div",{className:MA,children:e.name}),(0,ad.jsx)("div",{className:UA,children:e.email})]})]})}),(0,ad.jsx)("td",{className:kA,style:{fontSize:"14px",color:"#212529"},children:e.role}),(0,ad.jsx)("td",{className:kA,children:(0,ad.jsx)("span",{className:"".concat(FA," ").concat(t.class),children:t.text})}),(0,ad.jsx)("td",{className:kA,style:{fontSize:"14px",color:"#212529",fontWeight:"500"},children:e.consultations}),(0,ad.jsx)("td",{className:kA,children:e.rating>0?(0,ad.jsxs)("div",{className:"".concat(WA," ").concat(iI," ").concat(oI),children:[(0,ad.jsx)("div",{className:HA,children:[...Array(5)].map((t,n)=>(0,ad.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:n<Math.floor(e.rating)?"#ffc107":"#e9ecef",stroke:n<Math.floor(e.rating)?"#ffc107":"#e9ecef",style:{marginRight:"1px"},children:(0,ad.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})},n))}),(0,ad.jsx)("span",{className:GA,children:e.rating})]}):(0,ad.jsx)("span",{className:aI,style:{fontSize:"13px"},children:"No ratings"})}),(0,ad.jsx)("td",{className:kA,style:{fontSize:"14px",color:"#6c757d"},children:new Date(e.joinDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,ad.jsx)("td",{className:"".concat(kA," ").concat(DA),children:(0,ad.jsx)("button",{className:nI,title:"View Details",children:(0,ad.jsxs)("svg",{className:rI,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})})]},e.id)})})]})}),l.length>0&&(0,ad.jsxs)("div",{className:XA,children:[(0,ad.jsxs)("div",{className:JA,children:["Showing ",(0,ad.jsx)("strong",{children:"1"})," to ",(0,ad.jsx)("strong",{children:l.length})," of ",(0,ad.jsx)("strong",{children:l.length})," results"]}),(0,ad.jsx)("nav",{children:(0,ad.jsxs)("ul",{className:ZA,children:[(0,ad.jsx)("li",{className:QA,children:(0,ad.jsx)("span",{className:"".concat($A," ").concat(tI),children:"Previous"})}),(0,ad.jsx)("li",{className:QA,children:(0,ad.jsx)("span",{className:"".concat($A," ").concat(eI),children:"1"})}),(0,ad.jsx)("li",{className:QA,children:(0,ad.jsx)("span",{className:$A,children:"2"})}),(0,ad.jsx)("li",{className:QA,children:(0,ad.jsx)("span",{className:$A,children:"Next"})})]})})]})]})})]})},cI={pageContainer:"ChatsPage_pageContainer__3+Jko",headerSection:"ChatsPage_headerSection__eIqXu",pageTitle:"ChatsPage_pageTitle__6KevE",pageDescription:"ChatsPage_pageDescription__nY+TU",chatLayout:"ChatsPage_chatLayout__L43Po",conversationsSidebar:"ChatsPage_conversationsSidebar__e8FPU",hideOnMobile:"ChatsPage_hideOnMobile__9FnBk",mainChatReqBox:"ChatsPage_mainChatReqBox__MCNma",chatRequestBox:"ChatsPage_chatRequestBox__TBwLx",chatIcon:"ChatsPage_chatIcon__uN0x4",chatRequestContent:"ChatsPage_chatRequestContent__t5w00",acceptBtn:"ChatsPage_acceptBtn__6am19",searchBar:"ChatsPage_searchBar__MIJLv",searchInputWrapper:"ChatsPage_searchInputWrapper__GruqU",searchIcon:"ChatsPage_searchIcon__BU5t-",searchInput:"ChatsPage_searchInput__0aMOM",conversationsList:"ChatsPage_conversationsList__sEftn",conversationItem:"ChatsPage_conversationItem__Yv2sW",conversationItemActive:"ChatsPage_conversationItemActive__f-4u4",conversationContent:"ChatsPage_conversationContent__DNLcx",avatarWrapper:"ChatsPage_avatarWrapper__oMRhf",conversationAvatar:"ChatsPage_conversationAvatar__0kbdQ",chatHeaderAvatar:"ChatsPage_chatHeaderAvatar__arc-B",onlineIndicator:"ChatsPage_onlineIndicator__o+vpu",conversationDetails:"ChatsPage_conversationDetails__NbPkB",conversationHeader:"ChatsPage_conversationHeader__DsJO7",conversationName:"ChatsPage_conversationName__WQ3AD",conversationTimestamp:"ChatsPage_conversationTimestamp__Fa6DZ",conversationMessage:"ChatsPage_conversationMessage__My1uY",messageText:"ChatsPage_messageText__J23oH",unreadBadge:"ChatsPage_unreadBadge__mkJ9x",unreadBadgeIcon:"ChatsPage_unreadBadgeIcon__C1awv",moreMenuWrapper:"ChatsPage_moreMenuWrapper__vSBYA",moreMenu:"ChatsPage_moreMenu__74FNG",moreMenuItem:"ChatsPage_moreMenuItem__A08mM",conversationStatus:"ChatsPage_conversationStatus__ukXKN",statusOnline:"ChatsPage_statusOnline__wfcz1",statusOffline:"ChatsPage_statusOffline__tutKz",chatWindow:"ChatsPage_chatWindow__Ow-JS",chatHeader:"ChatsPage_chatHeader__tz8QD",chatHeaderInfo:"ChatsPage_chatHeaderInfo__s5oU5",chatHeaderName:"ChatsPage_chatHeaderName__at1di",chatHeaderStatus:"ChatsPage_chatHeaderStatus__bv0q3",chatHeaderActions:"ChatsPage_chatHeaderActions__+K5qV",headerButton:"ChatsPage_headerButton__2xUOp",mobileBackButton:"ChatsPage_mobileBackButton__PcdPc",messagesArea:"ChatsPage_messagesArea__ebN-j",messageContainer:"ChatsPage_messageContainer__BGMet",messageContainerLeft:"ChatsPage_messageContainerLeft__701Oo",messageContainerRight:"ChatsPage_messageContainerRight__GTkTX",messageBubble:"ChatsPage_messageBubble__yBYlp",messageBubbleOwn:"ChatsPage_messageBubbleOwn__oSbkM",messageBubbleOther:"ChatsPage_messageBubbleOther__QzGGw",messageSender:"ChatsPage_messageSender__oorNA",messageTimestamp:"ChatsPage_messageTimestamp__S9qEK",messageInputArea:"ChatsPage_messageInputArea__UJyrJ",inputGroup:"ChatsPage_inputGroup__SoclN",messageInput:"ChatsPage_messageInput__UscX7",attachButton:"ChatsPage_attachButton__k0m2a",sendButton:"ChatsPage_sendButton__CcZKK",sendIcon:"ChatsPage_sendIcon__eq2Ey",emptyState:"ChatsPage_emptyState__NWWXd",emptyIcon:"ChatsPage_emptyIcon__hzB+t",emptyText:"ChatsPage_emptyText__leABk",emptyChatState:"ChatsPage_emptyChatState__m0m3S",emptyChatContent:"ChatsPage_emptyChatContent__YgqQG",emptyChatIcon:"ChatsPage_emptyChatIcon__fp5t3",emptyChatText:"ChatsPage_emptyChatText__vqeSu",flex:"ChatsPage_flex__Ms-LW",flexBetween:"ChatsPage_flexBetween__zPAzE",flexCenter:"ChatsPage_flexCenter__jXbIF",flexStart:"ChatsPage_flexStart__a18L4"};var lI={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},dI=i.createContext&&i.createContext(lI),uI=["attr","size","title"];function hI(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function pI(){return pI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pI.apply(this,arguments)}function mI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mI(Object(n),!0).forEach(function(t){gI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function gI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _I(e){return e&&e.map((e,t)=>i.createElement(e.tag,fI({key:t},e.attr),_I(e.child)))}function vI(e){return t=>i.createElement(bI,pI({attr:fI({},e.attr)},t),_I(e.child))}function bI(e){var t=t=>{var n,{attr:r,size:o,title:a}=e,s=hI(e,uI),c=o||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),i.createElement("svg",pI({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,s,{className:n,style:fI(fI({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&i.createElement("title",null,a),e.children)};return void 0!==dI?i.createElement(dI.Consumer,null,e=>t(e)):t(lI)}function EI(e){return vI({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"},child:[]}]})(e)}const yI=()=>{var e,t,n,r,o;const s=he(),[c,l]=(0,i.useState)(1),[d,u]=(0,i.useState)(""),[h,p]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),[g,_]=(0,i.useState)([]),[v,b]=(0,i.useState)([]),[E,y]=(0,i.useState)(null),[S,T]=(0,i.useState)(null),[C,w]=(0,i.useState)(null),[R,A]=(0,i.useState)(""),I=tv(),{chatHistory:N}=iv(e=>e.consultants),O=iv(e=>e.socket.messages),[P,k]=(0,i.useState)(!1),[D,x]=(0,i.useState)(null),[L,M]=(0,i.useState)(!1),[U,F]=(0,i.useState)(null),[j,V]=(0,i.useState)(null),B=(0,i.useRef)(null),W=(0,i.useRef)(null),H=(0,i.useRef)(null),G=(0,i.useRef)(null),[z,K]=(0,i.useState)(!1),{userInRequest:Y}=iv(e=>e.consultants),q=iv(e=>e.socket.isChatAccepted);console.log("isChatAccepted____ChatsPage",q),(0,i.useEffect)(()=>{const e=localStorage.getItem("client_u_Identity"),t=localStorage.getItem("shop_o_Identity");y(e),T(t)},[]),(0,i.useEffect)(()=>{const e=()=>{f(window.innerWidth<=768),window.innerWidth>768&&p(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const X=function(){G.current&&(G.current.scrollTop=G.current.scrollHeight)};(0,i.useEffect)(()=>{null!==N&&void 0!==N&&N.chatHistory&&(b(N.chatHistory),W.current=null,setTimeout(()=>{X("auto")},300))},[N]),(0,i.useEffect)(()=>{v.length>0&&G.current&&setTimeout(()=>{X("auto")},100)},[v]),(0,i.useEffect)(()=>{if(!C||!E||!O.length)return;const e=O[O.length-1];if(e._id===W.current)return;String(e.shop_id)===String(C.shopId)&&(String(e.senderId)===String(C.userId)&&String(e.receiverId)===String(E)||String(e.senderId)===String(E)&&String(e.receiverId)===String(C.userId))&&(W.current=e._id,b(t=>{if(t.some(t=>t._id===e._id))return t;const n=t.findIndex(t=>{var n;return(null===(n=t._id)||void 0===n?void 0:n.startsWith("temp-"))&&t.text===e.text&&String(t.senderId)===String(e.senderId)});if(-1!==n){const r=[...t];return r[n]=e,r}return[...t,e]}))},[O,C,E]),(0,i.useEffect)(()=>{if(c&&g.length>0){const e=g.find(e=>e.id===c);console.log(e)}},[c]);const J=C?g.find(e=>{var t,n;return String(null===(t=e.sender)||void 0===t?void 0:t.id)===String(C.userId)&&String(null===(n=e.shop)||void 0===n?void 0:n.id)===String(C.shopId)}):g.find(e=>e.id===c),Z=g.filter(e=>{var t,n;return null===(t=e.sender)||void 0===t||null===(n=t.fullname)||void 0===n?void 0:n.toLowerCase().includes(d.toLowerCase())});(0,i.useEffect)(()=>{(async()=>{if(S&&E)try{var e;const t=await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/get/chat-list/").concat(S,"/").concat(E));if(null!==(e=t.data)&&void 0!==e&&e.payload&&(_(t.data.payload),t.data.payload.length>0)){const e=t.data.payload[0];l(e.id)}}catch(t){console.log("error",t)}})()},[O,Y,S,E,j]);const Q=()=>{if(""!==R.trim()&&C){if(!Ow.connected)return console.warn("Socket not connected, attempting to reconnect..."),Ow.connect(),void setTimeout(()=>{Ow.connected?e():console.error("Failed to connect socket")},1e3);e()}function e(){const e={senderId:E||E,receiverId:null===C||void 0===C?void 0:C.userId,shop_id:S||(null===C||void 0===C?void 0:C.shopId),text:R,timestamp:(new Date).toISOString()};(0,a.A)({_id:"temp-".concat(Date.now())},e);Ow.emit("sendMessage",e),A(""),I(zT(e))}};(0,i.useEffect)(()=>{if(O&&O.length>0){const n=O[O.length-1];if(n._id===B.current)return;const r=String(n.senderId)!==String(E);let i=!0;if(C&&(i=String(n.shop_id)===String(C.shopId)&&(String(n.senderId)===String(C.userId)&&String(n.receiverId)===String(E)||String(n.senderId)===String(E)&&String(n.receiverId)===String(C.userId))),r){var e,t;const r=g.find(e=>{var t,r;return(null===(t=e.sender)||void 0===t?void 0:t.id)===n.senderId&&(null===(r=e.shop)||void 0===r?void 0:r.id)===n.shop_id}),i=(null===r||void 0===r||null===(e=r.sender)||void 0===e?void 0:e.fullname)||"User",o=null!==r&&void 0!==r&&null!==(t=r.sender)&&void 0!==t&&t.profileImage?"".concat("https://test-online-consultation.zend-apps.com","/").concat(r.sender.profileImage.replace("\\","/")):null;x({senderName:i,text:n.text,avatar:o}),k(!0),B.current=n._id,setTimeout(()=>{k(!1)},5e3)}}},[O,E,C,g]);const $=g.filter(e=>!1===e.isRequest),ee=g.filter(e=>!0===e.isRequest);console.log("isRequestModalClose",ee),console.log("isRequestModalOpen",$);(0,i.useEffect)(()=>{Ow&&Ow.on("userChatAccepted",e=>{console.log("acceptUserChat",e)})},[Ow]);const{chatTimer:te}=iv(e=>e.socket),[ne,re]=(0,i.useState)(0);return console.log("chatTimer____ChatsPage",te),(0,i.useEffect)(()=>{if(!te.isRunning||!te.startTime)return;const e=setInterval(()=>{const e=Math.floor((Date.now()-new Date(te.startTime))/1e3);re(e)},1e3);return!1===(null===te||void 0===te?void 0:te.isRunning)&&V(e=>!e),()=>clearInterval(e)},[te.isRunning,te.startTime]),(0,ad.jsx)(i.Fragment,{children:(0,ad.jsxs)("div",{className:cI.pageContainer,children:[(0,ad.jsxs)("div",{className:cI.headerSection,children:[(0,ad.jsx)("h1",{className:cI.pageTitle,children:"Messages"}),(0,ad.jsx)("p",{className:cI.pageDescription,children:"Communicate with clients and manage your conversations."})]}),(0,ad.jsxs)("div",{className:cI.chatLayout,children:[(0,ad.jsx)("div",{className:"".concat(cI.conversationsSidebar," ").concat(h?cI.hideOnMobile:""),children:(0,ad.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,ad.jsx)("div",{className:cI.searchBar,children:(0,ad.jsxs)("div",{className:cI.searchInputWrapper,children:[(0,ad.jsxs)("svg",{className:cI.searchIcon,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,ad.jsx)("path",{d:"m21 21-4.35-4.35"})]}),(0,ad.jsx)("input",{type:"text",className:cI.searchInput,placeholder:"Search conversations...",value:d,onChange:e=>u(e.target.value)})]})}),(0,ad.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},children:(0,ad.jsxs)("p",{onClick:()=>M(!L),style:{fontSize:"14px",fontWeight:"600",padding:"10px",cursor:"pointer"},children:[" ",(0,ad.jsx)("span",{style:{color:"#63ba77"},children:"Request"})," (",$.length,")"]})}),L?null===$||void 0===$?void 0:$.map(e=>{var t,n,r,o;const a="".concat("https://test-online-consultation.zend-apps.com","/").concat(null===e||void 0===e||null===(t=e.sender)||void 0===t||null===(n=t.profileImage)||void 0===n?void 0:n.replace("\\","/")),s=!(null===e||void 0===e||null===(r=e.sender)||void 0===r||!r.profileImage),l=new Date(null===e||void 0===e?void 0:e.updatedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0});return(0,ad.jsx)(i.Fragment,{children:(0,ad.jsx)("div",{className:"".concat(cI.conversationItem," ").concat(c===e.id?cI.conversationItemActive:""),children:(0,ad.jsxs)("div",{className:cI.conversationContent,children:[(0,ad.jsxs)("div",{className:cI.avatarWrapper,children:[(0,ad.jsx)("img",{src:s?a:"../images/team/team1.avif",alt:"profile",className:cI.conversationAvatar}),e.isOnline&&(0,ad.jsx)("div",{className:cI.onlineIndicator})]}),(0,ad.jsxs)("div",{className:cI.conversationDetails,children:[(0,ad.jsxs)("div",{className:"".concat(cI.conversationHeader," ").concat(cI.flexBetween," ").concat(cI.flexStart),children:[(0,ad.jsx)("div",{className:cI.conversationName,children:null===(o=e.sender)||void 0===o?void 0:o.fullname}),(0,ad.jsx)("div",{className:cI.conversationTimestamp,children:l})]}),(0,ad.jsxs)("div",{className:"".concat(cI.conversationMessage," ").concat(cI.flexBetween," ").concat(cI.flexCenter),children:[(0,ad.jsx)("div",{className:cI.messageText,children:null===e||void 0===e?void 0:e.lastMessage}),(0,ad.jsxs)("div",{className:cI.moreMenuWrapper,children:[(0,ad.jsx)("button",{type:"button",className:cI.unreadBadgeIcon,onClick:t=>{t.stopPropagation(),F(U===e.id?null:e.id)},children:(0,ad.jsx)(EI,{})}),U===e.id&&(0,ad.jsxs)("div",{className:cI.moreMenu,onClick:e=>e.stopPropagation(),children:[(0,ad.jsx)("button",{type:"button",className:cI.moreMenuItem,onClick:()=>{(e=>{I(LE({shopId:e.shop.id,userId:e.sender.id,consultantId:E}))})(e)},children:"Add"}),(0,ad.jsx)("button",{type:"button",className:cI.moreMenuItem,onClick:()=>{console.log("Remove clicked for",e.id),F(null)},children:"Remove"})]})]})]})]})]})},e.id)})}):(0,ad.jsx)("div",{className:cI.conversationsList,children:0===ee.length?(0,ad.jsx)("div",{className:cI.emptyState,children:(0,ad.jsxs)("div",{children:[(0,ad.jsx)("svg",{className:cI.emptyIcon,width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,ad.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),(0,ad.jsx)("p",{className:cI.emptyText,children:"Loading conversations..."})]})}):0===Z.length?(0,ad.jsx)("div",{className:cI.emptyState,children:(0,ad.jsxs)("div",{children:[(0,ad.jsx)("svg",{className:cI.emptyIcon,width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,ad.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),(0,ad.jsx)("p",{className:cI.emptyText,children:"No conversations found"})]})}):null===ee||void 0===ee?void 0:ee.map(e=>{var t,n,r,o;const a="".concat("https://test-online-consultation.zend-apps.com","/").concat(null===e||void 0===e||null===(t=e.sender)||void 0===t||null===(n=t.profileImage)||void 0===n?void 0:n.replace("\\","/")),s=!(null===e||void 0===e||null===(r=e.sender)||void 0===r||!r.profileImage),d=new Date(null===e||void 0===e?void 0:e.updatedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),u=null===e||void 0===e?void 0:e.isChatAccepted;return(0,ad.jsx)(i.Fragment,{children:(0,ad.jsx)("div",{onClick:()=>(e=>{console.log("chatData",e),localStorage.setItem("is_noti_true",e.userId),w(e),V(e);const t=g.find(t=>{var n,r;return(null===(n=t.sender)||void 0===n?void 0:n.id)===e.userId&&(null===(r=t.shop)||void 0===r?void 0:r.id)===e.shopId});t&&(l(t.id),m&&p(!0),window.scrollTo(0,0),I(DE({shopId:e.shopId,userId:e.userId,consultantId:E})))})({shopId:e.shop.id,userId:e.sender.id,isChatAccepted:u}),className:"".concat(cI.conversationItem," ").concat(c===e.id?cI.conversationItemActive:""),children:(0,ad.jsxs)("div",{className:cI.conversationContent,children:[(0,ad.jsxs)("div",{className:cI.avatarWrapper,children:[(0,ad.jsx)("img",{src:s?a:"../images/team/team1.avif",alt:"profile",className:cI.conversationAvatar}),e.isOnline&&(0,ad.jsx)("div",{className:cI.onlineIndicator})]}),(0,ad.jsxs)("div",{className:cI.conversationDetails,children:[(0,ad.jsxs)("div",{className:"".concat(cI.conversationHeader," ").concat(cI.flexBetween," ").concat(cI.flexStart),children:[(0,ad.jsx)("div",{className:cI.conversationName,children:null===(o=e.sender)||void 0===o?void 0:o.fullname}),(0,ad.jsx)("div",{className:cI.conversationTimestamp,children:d})]}),(0,ad.jsxs)("div",{className:"".concat(cI.conversationMessage," ").concat(cI.flexBetween," ").concat(cI.flexCenter),children:[(0,ad.jsx)("div",{className:cI.messageText,children:null===e||void 0===e?void 0:e.lastMessage}),(0,ad.jsx)("span",{className:cI.unreadBadge,children:"5+"})]}),(0,ad.jsx)("div",{className:"".concat(cI.conversationStatus," ").concat(e.isOnline?cI.statusOnline:cI.statusOffline),children:e.lastActive})]})]})},e.id)})})})]})}),(0,ad.jsx)("div",{className:"".concat(cI.chatWindow," ").concat(h?"":cI.hideOnMobile),children:(0,ad.jsx)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:J?(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsxs)("div",{className:"".concat(cI.chatHeader," ").concat(cI.flexBetween," ").concat(cI.flexCenter),children:[(0,ad.jsx)("button",{className:cI.mobileBackButton,onClick:()=>{p(!1)},"aria-label":"Back to conversations",children:(0,ad.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,ad.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),(0,ad.jsxs)("div",{className:"".concat(cI.chatHeaderInfo," ").concat(cI.flex," ").concat(cI.flexCenter),children:[(0,ad.jsxs)("div",{className:cI.avatarWrapper,children:[null!==J&&void 0!==J&&null!==(e=J.sender)&&void 0!==e&&e.profileImage?(0,ad.jsx)("img",{src:"".concat("https://test-online-consultation.zend-apps.com","/").concat(J.sender.profileImage.replace("\\","/")),alt:J.sender.fullname,className:cI.chatHeaderAvatar,style:{borderRadius:"50%",width:"40px",height:"40px",objectFit:"cover"}}):(0,ad.jsx)("div",{className:cI.chatHeaderAvatar,children:(null===J||void 0===J||null===(t=J.sender)||void 0===t||null===(n=t.fullname)||void 0===n||null===(r=n.charAt(0))||void 0===r?void 0:r.toUpperCase())||"U"}),(null===J||void 0===J?void 0:J.isOnline)&&(0,ad.jsx)("div",{className:cI.onlineIndicator})]}),(0,ad.jsxs)("div",{children:[(0,ad.jsx)("div",{className:cI.chatHeaderName,children:(null===J||void 0===J||null===(o=J.sender)||void 0===o?void 0:o.fullname)||"User"}),(0,ad.jsx)("div",{className:cI.chatHeaderStatus,style:{color:null!==J&&void 0!==J&&J.isOnline?"#10b981":"#6c757d"},children:null!==J&&void 0!==J&&J.isOnline?"Active now":(null===J||void 0===J?void 0:J.lastActive)||"Offline"})]})]}),te.isRunning&&(0,ad.jsx)("div",{className:cI.chatTimer,children:(0,ad.jsxs)("p",{children:[" Timer: ",ne]})}),(0,ad.jsxs)("div",{className:cI.chatHeaderActions,style:{display:"flex",gap:"8px"},children:[(0,ad.jsx)("button",{className:cI.headerButton,title:"Video Call",onClick:()=>s("/video/calling/page",{state:{conversation:J}}),children:(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("path",{d:"M23 7l-7 5 7 5V7z"}),(0,ad.jsx)("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]})}),(0,ad.jsx)("button",{className:cI.headerButton,title:"More Options",children:(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,ad.jsx)("circle",{cx:"19",cy:"12",r:"1"}),(0,ad.jsx)("circle",{cx:"5",cy:"12",r:"1"})]})})]})]}),(0,ad.jsx)("div",{className:cI.messagesArea,ref:G,children:"request"===(null===j||void 0===j?void 0:j.isChatAccepted)?(0,ad.jsx)("div",{className:cI.mainChatReqBox,children:(0,ad.jsxs)("div",{className:cI.chatRequestBox,children:[(0,ad.jsx)("div",{className:cI.chatIcon,children:"\ud83d\udcac"}),(0,ad.jsxs)("div",{className:cI.chatRequestContent,children:[(0,ad.jsx)("h4",{children:"New Chat Request"}),(0,ad.jsx)("p",{children:"A user wants to start a chat with you"})]}),(0,ad.jsx)("button",{onClick:()=>(e=>{if(!e||!E)return;const t={userId:e.userId,shopId:e.shopId,consultantId:E};Ow.emit("acceptUserChat",t),V(e=>!e)})(j),className:cI.acceptBtn,children:"Accept Chat"})]})}):0===v.length?(0,ad.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,ad.jsx)("p",{children:"No messages yet. Start the conversation!"})}):(0,ad.jsxs)(ad.Fragment,{children:[v.map(e=>{const t=e.senderId===E,n=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0});return(0,ad.jsx)("div",{className:"".concat(cI.messageContainer," ").concat(t?cI.messageContainerRight:cI.messageContainerLeft),children:(0,ad.jsxs)("div",{className:"".concat(cI.messageBubble," ").concat(t?cI.messageBubbleOwn:cI.messageBubbleOther),children:[(0,ad.jsx)("div",{className:cI.messageText,children:e.text}),(0,ad.jsx)("div",{className:cI.messageTimestamp,children:n})]})},e._id)}),(0,ad.jsx)("div",{ref:H})]})}),(0,ad.jsx)("div",{className:cI.messageInputArea,children:(0,ad.jsxs)("div",{className:cI.inputGroup,children:[(0,ad.jsx)("button",{className:cI.attachButton,title:"Attach File",children:(0,ad.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,ad.jsx)("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"})})}),(0,ad.jsx)("input",{onChange:e=>A(e.target.value),value:R,type:"text",className:cI.messageInput,placeholder:"Type a message...",onKeyPress:e=>{"Enter"===e.key&&R.trim()&&Q()}}),(0,ad.jsx)("button",{onClick:Q,className:cI.sendButton,title:"Send",children:(0,ad.jsxs)("svg",{className:cI.sendIcon,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,ad.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})})]}):(0,ad.jsx)("div",{className:cI.emptyChatState,children:(0,ad.jsxs)("div",{className:cI.emptyChatContent,children:[(0,ad.jsx)("svg",{className:cI.emptyChatIcon,width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,ad.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),(0,ad.jsx)("p",{className:cI.emptyChatText,children:"Select a conversation to start chatting"})]})})})})]})]})})},SI="VideoCallingPage_videoCallContainer__g6r0V",TI="VideoCallingPage_callHeader__klrXY",CI="VideoCallingPage_backButton__5yg69",wI="VideoCallingPage_callInfo__ft8w8",RI="VideoCallingPage_callAvatar__FIsru",AI="VideoCallingPage_callName__1ww0q",II="VideoCallingPage_callStatus__RypwJ",NI="VideoCallingPage_videoArea__SjErB",OI="VideoCallingPage_remoteVideo__Z2s1a",PI="VideoCallingPage_videoElement__U1n9A",kI="VideoCallingPage_videoPlaceholder__+sz7L",DI="VideoCallingPage_avatarLarge__mjpOz",xI="VideoCallingPage_videoPlaceholderText__MNeQz",LI="VideoCallingPage_videoPlaceholderTextSmall__RHrny",MI="VideoCallingPage_localVideo__kwolP",UI="VideoCallingPage_videoPlaceholderSmall__fbF2W",FI="VideoCallingPage_avatarSmall__H6pv6",jI="VideoCallingPage_callControls__cT9XF",VI="VideoCallingPage_controlButton__AhDzf",BI="VideoCallingPage_controlButtonActive__fDXU8",WI="VideoCallingPage_endCallButton__Quhz6";var HI=n(9416);let GI;const zI=()=>{GI=new Audio("https://assets.mixkit.co/sfx/preview/mixkit-classic-alarm-995.mp3"),GI.loop=!0,console.log("Using online ringtone")};const KI=function(){var e,t,r,o;const a=he(),s=(le(),tv()),c=(0,i.useRef)(null),l=(0,i.useRef)(null),[d,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(null),{callEnded:m}=iv(e=>e.socket),f=new URLSearchParams(window.location.search),g=f.get("receiverId"),_=f.get("callType")||"voice",v=f.get("token")?decodeURIComponent(f.get("token")):null,b=f.get("channelName"),E=f.get("callerId"),y=f.get("uid"),S=f.get("appId"),T=f.get("userId"),C=(0,i.useRef)(!1),{inCall:w,channel:R,type:A,muted:I,videoEnabled:N}=iv(e=>e.call);console.log("inCall",w);const O="video"===A||"video"===_,{callRejected:P}=iv(e=>e.socket);console.log("callRejected",P),(0,i.useEffect)(()=>{localStorage.setItem("userId",T)},[T]),(0,i.useEffect)(()=>{if(!T)return;const e=Nw();return e.connect(),e.on("connect",()=>{e.emit("register",T),console.log("\u2705 User registered from call page:",T)}),()=>{e.off("connect")}},[T]),(0,i.useEffect)(()=>{P&&D()},[P]),(0,i.useEffect)(()=>{const e=localStorage.getItem("client_u_Identity");p(E||e)},[E]),(0,i.useEffect)(()=>{const e=Nw(),t=localStorage.getItem("client_u_Identity");e.connected||(e.connect(),e.emit("register",t))},[]),(0,i.useEffect)(()=>{if(!h||!g||!b||!_)return;const e="call_started_".concat(b);console.log("callKey",e),console.log("effect triggered"),sessionStorage.getItem(e)||(console.log("calling user"),console.log("effect triggered"),sessionStorage.setItem(e,"true"))},[h,g,b,_]),(0,i.useEffect)(()=>{if(!C.current&&v&&b&&y){const e=S||"656422a01e774a4ba5b2dc0ac12e5fe5";console.log("Starting ".concat(_," call:"),{token:v,channel:b,uid:y,appId:e}),C.current=!0,s((0,HI.t3)({token:v,channel:b,uid:y,appId:e,callType:_})).unwrap().then(e=>{console.log("".concat(_," call started successfully:"),e)}).catch(e=>{console.error("".concat(_," call failed:"),e)}),zI(),(async()=>{GI||zI();try{GI.currentTime=0,await GI.play(),console.log("\ud83c\udfb5 Ringtone playing!")}catch($D){console.error("Ringtone error:",$D);const t=new(window.AudioContext||window.webkitAudioContext),n=t.createOscillator();n.frequency.value=800,n.connect(t.destination),n.start(),setTimeout(()=>n.stop(),1e3)}})()}},[s,v,b,y,S,_]),(0,i.useEffect)(()=>{if(O){let e=!1,t=0;const r=40,i=()=>{e||Promise.resolve().then(n.bind(n,9416)).then(n=>{const i=n.getLocalVideoTrack();if(i&&c.current)try{i.play(c.current).then(()=>{console.log("Local video playing successfully"),e=!0,t=r}).catch(e=>{console.error("Error playing local video:",e)})}catch(o){console.error("Error playing local video:",o)}else t<10&&console.log("Waiting for local video track...",{hasTrack:!!i,hasElement:!!c.current,inCall:w,type:A})})};i();const o=setInterval(()=>{e||i(),t++,t>=r&&clearInterval(o)},500);return()=>{clearInterval(o),e=!1}}},[O,w,A]),(0,i.useEffect)(()=>{if(O&&w){let e=0;const t=20,r=()=>{!l.current&&(e++,e<t)||Promise.resolve().then(n.bind(n,9416)).then(n=>{const r=n.getRemoteVideoTrack();if(r&&l.current)try{r.play(l.current),console.log("Remote video playing on element"),e=t}catch(i){console.error("Error playing remote video:",i)}})};r();const i=setInterval(()=>{r(),e++,e>=t&&clearInterval(i)},500);return()=>clearInterval(i)}},[O,w]),(0,i.useEffect)(()=>{const e=()=>{l.current&&Promise.resolve().then(n.bind(n,9416)).then(e=>{const t=e.getRemoteVideoTrack();t&&t.play(l.current).then(()=>{console.log("Remote video played via event")}).catch(e=>{console.error("Error playing remote video via event:",e)})})},t=()=>{console.log("Local video ready event received");const e=()=>{c.current?Promise.resolve().then(n.bind(n,9416)).then(t=>{const n=t.getLocalVideoTrack();n?n.play(c.current).then(()=>{console.log("Local video played via event successfully")}).catch(t=>{console.error("Error playing local video via event:",t),setTimeout(e,500)}):(console.log("Local video track not available, retrying..."),setTimeout(e,500))}):(console.log("Local video element not ready, retrying..."),setTimeout(e,500))};e()};return window.addEventListener("remote-video-ready",e),window.addEventListener("local-video-ready",t),()=>{window.removeEventListener("remote-video-ready",e),window.removeEventListener("local-video-ready",t)}},[]),(0,i.useEffect)(()=>{(async()=>{const e=E||h;if(e&&g)try{const t="".concat("https://test-online-consultation.zend-apps.com","/api/call/get-caller-receiver-details/").concat(e,"/").concat(g),n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}),r=await n.json();null!==r&&void 0!==r&&r.success&&u(null===r||void 0===r?void 0:r.payload)}catch(t){console.error("Failed to fetch caller details:",t)}})()},[E,h,g]);const k=null!==d&&void 0!==d&&null!==(e=d.receiver)&&void 0!==e&&e.profileImage?"".concat("https://test-online-consultation.zend-apps.com","/").concat(d.receiver.profileImage.replace("\\","/")):null,D=()=>{s((0,HI.go)()),Ow.emit("call-ended",{callerId:h,receiverId:g,channel:b,callType:A});const e=f.get("returnUrl");e?window.top.location.href=decodeURIComponent(e):a(-1)};return(0,i.useEffect)(()=>{m&&D()},[m]),console.log("callEnded",m),console.log("callerDetails",d),(0,ad.jsxs)("div",{className:SI,children:[(0,ad.jsxs)("div",{className:TI,children:[(0,ad.jsx)("button",{className:CI,onClick:D,"aria-label":"End call",children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,ad.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),(0,ad.jsxs)("div",{className:wI,children:[(0,ad.jsx)("div",{className:RI,children:(0,ad.jsx)("img",{className:RI,src:k,alt:"profile"})}),(0,ad.jsxs)("div",{children:[(0,ad.jsx)("div",{className:AI,children:null===d||void 0===d||null===(t=d.receiver)||void 0===t?void 0:t.fullname}),(0,ad.jsx)("div",{className:II})]})]})]}),(0,ad.jsxs)("div",{className:NI,children:[(0,ad.jsx)("div",{className:OI,children:O?(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsx)("div",{ref:l,"data-remote-video":!0,className:PI}),!w&&(0,ad.jsxs)("div",{className:kI,children:[k&&(0,ad.jsx)("div",{className:DI,children:(0,ad.jsx)("img",{className:DI,src:k,alt:"profile"})}),(0,ad.jsx)("p",{className:xI,children:(null===d||void 0===d||null===(r=d.receiver)||void 0===r?void 0:r.fullname)||"Waiting for video..."})]})]}):(0,ad.jsxs)("div",{className:kI,children:[k&&(0,ad.jsx)("div",{className:DI,children:(0,ad.jsx)("img",{className:DI,src:k,alt:"profile"})}),(0,ad.jsx)("p",{className:xI,children:(null===d||void 0===d||null===(o=d.receiver)||void 0===o?void 0:o.fullname)||"Calling..."}),P?(0,ad.jsx)("p",{className:xI,style:{color:"red"},children:"Call Rejected"}):(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsx)("p",{className:xI,children:w?"In Call":"Connecting..."}),(0,ad.jsx)("p",{className:xI,children:"voice"===A?"Voice Call":"Video Call"})]})]})}),O&&(0,ad.jsxs)("div",{className:MI,children:[(0,ad.jsx)("div",{ref:c,"data-local-video":!0,className:PI,style:{display:N?"block":"none",width:"100%",height:"100%",objectFit:"cover"}}),(0,ad.jsxs)("div",{className:UI,style:{display:N?"none":"flex"},children:[(0,ad.jsx)("div",{className:FI,children:"You"}),(0,ad.jsx)("p",{className:LI,children:"Camera Off"})]})]})]}),(0,ad.jsxs)("div",{className:jI,children:[(0,ad.jsx)("button",{className:"".concat(VI," ").concat(I?BI:""),title:I?"Unmute":"Mute",onClick:()=>{s((0,HI.K8)())},children:I?(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),(0,ad.jsx)("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),(0,ad.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),(0,ad.jsx)("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"})]})}),O&&(0,ad.jsx)("button",{className:"".concat(VI," ").concat(N?"":BI),title:N?"Turn Off Camera":"Turn On Camera",onClick:()=>{O&&s((0,HI.WM)())},children:N?(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M23 7l-7 5 7 5V7z"}),(0,ad.jsx)("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]}):(0,ad.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M23 7l-7 5 7 5V7z"}),(0,ad.jsx)("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"}),(0,ad.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]})}),(0,ad.jsx)("button",{className:"".concat(VI," ").concat(WI),onClick:D,title:"End Call",children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,ad.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})})})]})]})};function YI(){const e=tv(),t=localStorage.getItem("client_u_Identity")||localStorage.getItem("consultant_u_Identity"),{incomingCall:n,callEnded:r}=iv(e=>e.socket);if(console.log("incomingCall",n),!n)return console.log("No incoming call");const{callerId:i,callType:o,channelName:a,callerName:s}=n;return(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsx)(kw,{incomingCall:n}),(0,ad.jsxs)("div",{style:{position:"fixed",top:"20px",right:"20px",width:"320px",backgroundColor:"#ffffff",boxShadow:"0px 4px 14px rgba(0, 0, 0, 0.15)",borderRadius:"12px",zIndex:1e3,padding:"10px",fontFamily:"Arial, sans-serif"},children:[(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"12px"},children:[(0,ad.jsx)("img",{src:"https://imgs.search.brave.com/8vitWtK7-18taVi4PjQG1jZwM0baiJg4CfpjJVibqtw/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9wZnBt/YWtlci5jb20vaW1h/Z2VzL2xhbmRpbmcv/aGVhZHNob3RzL2Js/b2dfMC5qcGc",alt:"Caller Avatar",style:{width:"60px",height:"60px",borderRadius:"50%",marginRight:"12px",objectFit:"cover"}}),(0,ad.jsxs)("div",{children:[(0,ad.jsxs)("p",{style:{margin:0,fontSize:"15px",fontWeight:"600",color:"#222"},children:[o," call"]}),(0,ad.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#555"},children:[s," is calling you"]})]})]}),(0,ad.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,ad.jsx)("button",{onClick:async()=>{if(!await Dw())return void alert("Please grant microphone permission to start the call");const r=Math.floor(1e6*Math.random()),o="".concat("https://test-online-consultation.zend-apps.com","/api/call/generate-token"),s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelName:a,uid:r})}),c=await s.json();if(console.log("data____Reciver_____",c),c.token){Ow.emit("call-accepted",{callerId:i,receiverId:t,channelName:a,callType:n.callType,shopId:"690c374f605cb8b946503ccb"}),console.log("Call accepted",n),e(QT(null));const o=encodeURIComponent(c.token),s=c.appId?"&appId=".concat(c.appId):"",l=n.callType||"voice",d="https://rohit-12345839.myshopify.com/apps/consultant-theme/consultant-dashboard",u="https://focusing-monkey-home-calendar.trycloudflare.com/video/calling/page"+"?callerId=".concat(i)+"&receiverId=".concat(t)+"&callType=".concat(l)+"&uid=".concat(r)+"&channelName=".concat(a)+"&token=".concat(o)+s+"&userId=".concat(t)+"&returnUrl=".concat(encodeURIComponent(d));window.top.location.href=u}},style:{flex:1,backgroundColor:"#28a745",color:"#fff",border:"none",borderRadius:"8px",padding:"5px",fontSize:"14px",cursor:"pointer",marginRight:"8px",transition:"background 0.2s ease"},onMouseOver:e=>e.target.style.backgroundColor="#218838",onMouseOut:e=>e.target.style.backgroundColor="#28a745",children:"Accept"}),(0,ad.jsx)("button",{onClick:()=>{console.log("Call rejected",n),Ow.emit("reject-call",{callerId:i,receiverId:t,channelName:a,callType:n.callType}),e(QT(null))},style:{flex:1,backgroundColor:"#dc3545",color:"#fff",border:"none",borderRadius:"8px",padding:"5px",fontSize:"14px",cursor:"pointer",transition:"background 0.2s ease"},onMouseOver:e=>e.target.style.backgroundColor="#c82333",onMouseOut:e=>e.target.style.backgroundColor="#dc3545",children:"Reject"})]})]})]})}const qI=function(e){var t,n,r,o,a;let{children:s}=e;const c=he(),l=le(),[d,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)(null),[m,f]=(0,i.useState)(null),[g,_]=(0,i.useState)(null),v=tv(),{consultantOverview:b}=iv(e=>e.consultants);console.log("consultantOverview________________",b),(0,i.useEffect)(()=>{f(localStorage.getItem("client_u_Identity")),_(localStorage.getItem("shop_o_Identity"))},[]);const E=()=>{const e=document.documentElement.scrollHeight;window.parent&&window.parent.postMessage({type:"AGORA_IFRAME_HEIGHT",height:e},"*")};(0,i.useEffect)(()=>{v(kE({shop_id:g,consultant_id:m}))},[g,m]),(0,i.useEffect)(()=>{window.addEventListener("load",E),window.addEventListener("resize",E);const e=setTimeout(E,500);return()=>{window.removeEventListener("load",E),window.removeEventListener("resize",E),clearTimeout(e)}},[]),(0,i.useEffect)(()=>{v(rC(m))},[m]),(0,i.useEffect)(()=>{"consulant-chats"===new URLSearchParams(window.location.search).get("page")&&("/consulant-chats"===l.pathname||l.pathname.startsWith("/consulant-chats")||setTimeout(()=>{c("/consulant-chats",{replace:!0})},100))},[l.search,l.pathname,c]),(0,i.useEffect)(()=>{window.innerWidth<=768&&u(!1)},[l.pathname]),(0,i.useEffect)(()=>{const e=()=>{window.innerWidth>768&&u(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const y=()=>{u(!d)},S=[{label:"Dashboard",icon:(0,ad.jsx)(WE,{}),path:"/consultant-dashboard",active:"/consultant-dashboard"===l.pathname},{label:"Chats",icon:(0,ad.jsx)(HE,{}),path:"/consultant-chats-section",active:"/consultant-chats-section"===l.pathname}],T=("".concat("https://test-online-consultation.zend-apps.com","/").concat(null===b||void 0===b||null===(t=b.consultant)||void 0===t||null===(n=t.profileImage)||void 0===n?void 0:n.replace("\\","/")),"/video-call"===l.pathname||l.pathname.startsWith("/video-call"));return(0,ad.jsxs)("div",{className:"".concat(Mw," ").concat(T?Uw:""),children:[(0,ad.jsx)("button",{className:Bw,onClick:y,"aria-label":"Toggle navigation",children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d?(0,ad.jsx)("path",{d:"M18 6L6 18M6 6l12 12"}):(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsx)("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),(0,ad.jsx)("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),(0,ad.jsx)("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})})}),d&&(0,ad.jsx)("div",{className:Ww,onClick:y}),(0,ad.jsxs)("div",{className:Fw,children:[!T&&(0,ad.jsxs)("aside",{className:"".concat(Hw," ").concat(d?nR:""),children:[(0,ad.jsxs)("div",{className:Gw,children:[(0,ad.jsx)("div",{className:zw,children:(0,ad.jsx)("img",{src:"https://imgs.search.brave.com/9rELSNB2JEASiZPQlCef36aaHliToZj5fynVvObLBKg/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9jZG4t/aWNvbnMtcG5nLmZs/YXRpY29uLmNvbS8x/MjgvNTk4Ny81OTg3/ODExLnBuZw",alt:null===b||void 0===b||null===(r=b.consultant)||void 0===r?void 0:r.fullname})}),(0,ad.jsxs)("div",{className:Kw,children:[(0,ad.jsx)("div",{className:Yw,children:null===b||void 0===b||null===(o=b.consultant)||void 0===o?void 0:o.fullname}),(0,ad.jsx)("div",{className:qw,children:null===b||void 0===b||null===(a=b.consultant)||void 0===a?void 0:a.email})]}),(0,ad.jsxs)("button",{className:Xw,children:[(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,ad.jsx)("circle",{cx:"12",cy:"7",r:"4"})]}),"My Profile"]})]}),(0,ad.jsx)("nav",{className:Jw,children:(0,ad.jsx)("ul",{className:Zw,children:S.map((e,t)=>(0,ad.jsx)("li",{children:(0,ad.jsxs)("button",{className:"".concat(Qw," ").concat(e.active?eR:""),onClick:()=>(e=>{const t=new URLSearchParams(window.location.search).get("shop");console.log("targetShop",t,"hostQuery",""),window.top.location.href="https://".concat(t,"/apps/consultant-theme").concat(e).concat("")})(e.path),title:e.label,children:[(0,ad.jsx)("span",{className:$w,children:e.icon}),(0,ad.jsx)("span",{className:tR,children:e.label})]})},t))})})]}),(0,ad.jsx)("div",{className:jw,children:(0,ad.jsx)("main",{className:Vw,children:(()=>{const e=l.pathname;return"/users-page"===e||e.startsWith("/users-page")?(0,ad.jsx)(sI,{}):"/consulant-chats"===e||e.startsWith("/consulant-chats")?(0,ad.jsx)(yI,{}):"/video-call"===e||e.startsWith("/video-call")?(0,ad.jsx)(KI,{}):(0,ad.jsx)(hA,{})})()})})]})]})},XI="UserChat_chatPageContainer__I5XFe",JI="UserChat_container__FBrKJ",ZI="UserChat_avatarWrapper__rQs7C",QI="UserChat_onlineIndicator__YmT+e",$I="UserChat_chatWindow__Fcacm",eN="UserChat_chatWindowContent__-MsxQ",tN="UserChat_chatHeader__QzGwn",nN="UserChat_chatHeaderInfo__vb8cV",rN="UserChat_backButton__YTNv3",iN="UserChat_chatHeaderAvatar__81Gsb",oN="UserChat_chatHeaderName__Mp+OM",aN="UserChat_chatHeaderStatus__w9+QM",sN="UserChat_chatHeaderActions__DZsnf",cN="UserChat_headerButton__alvsc",lN="UserChat_messagesArea__pL0Kx",dN="UserChat_messageContainer__iB05W",uN="UserChat_messageContainerLeft__SmQWc",hN="UserChat_messageContainerRight__SLGsw",pN="UserChat_messageBubble__puhkk",mN="UserChat_messageBubbleOwn__y8Pjd",fN="UserChat_messageBubbleOther__0YsNF",gN="UserChat_messageSender__jof-M",_N="UserChat_messageText__xSPuu",vN="UserChat_messageTimestamp__GHQ-7",bN="UserChat_messageInputArea__yu0q5",EN="UserChat_inputGroup__qGSJd",yN="UserChat_attachButton__5xI87",SN="UserChat_messageInput__QV5AX",TN="UserChat_sendButton__39IV+",CN="UserChat_sendIcon__NgQki";function wN(e){let{show:t,setShow:n,insufficientBalance:r}=e;const i=()=>{n(!1)};return(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsx)("div",{className:"modal fade ".concat(t?"show d-block":""),style:{background:"rgba(0,0,0,0.5)"},children:(0,ad.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:(0,ad.jsxs)("div",{className:"modal-content",style:{borderRadius:"12px"},children:[(0,ad.jsxs)("div",{className:"modal-header",style:{borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,ad.jsx)("h5",{className:"modal-title",children:"Insufficient Balance"}),(0,ad.jsx)("button",{className:"btn",onClick:i,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"0px",borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer"},children:(0,ad.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,ad.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,ad.jsxs)("div",{className:"modal-body",children:[(0,ad.jsx)("p",{children:"Insufficient wallet balance"}),(0,ad.jsxs)("p",{className:"mb-1",children:["Your Balance: ",(0,ad.jsxs)("b",{children:["\u20b9",null===r||void 0===r?void 0:r.available]})]}),(0,ad.jsxs)("p",{children:["Required: ",(0,ad.jsxs)("b",{children:["\u20b9",null===r||void 0===r?void 0:r.required]})]})]}),(0,ad.jsxs)("div",{className:"modal-footer",style:{borderTop:"1px solid #eee"},children:[(0,ad.jsx)("button",{className:"btn btn-light",onClick:i,children:"Close"}),(0,ad.jsx)("button",{className:"btn",style:{backgroundColor:"#ff6d2d",color:"white",padding:"6px 18px",borderRadius:"6px"},children:"Add Money"})]})]})})}),t&&(0,ad.jsx)("div",{className:"modal-backdrop fade show"})]})}const RN=()=>{var e,t,n,r,o,s,c;const[l,d]=(0,i.useState)(),u=he(),h=tv(),[p,m]=(0,i.useState)(null),[f,g]=(0,i.useState)(null),[_,v]=(0,i.useState)(!1),[b,E]=(0,i.useState)(!1),y=new URLSearchParams(window.location.search),S=y.get("consultantId"),T=y.get("shop");(0,i.useEffect)(()=>{const e=localStorage.getItem("client_u_Identity"),t=localStorage.getItem("shop_o_Identity");m(e),g(t)},[]);const{consultantOverview:C}=iv(e=>e.consultants),{chatHistory:w}=iv(e=>e.consultants),{messages:R}=iv(e=>e.socket),A="".concat("https://test-online-consultation.zend-apps.com","/").concat(null===C||void 0===C||null===(e=C.consultant)||void 0===e||null===(t=e.profileImage)||void 0===t?void 0:t.replace("\\","/")),[I,N]=(0,i.useState)([]),O=(0,i.useRef)(null),P=(0,i.useRef)(null),[k,D]=(0,i.useState)(!1),[x,L]=(0,i.useState)(null),M=(0,i.useRef)(null),U=(0,i.useRef)(!0),{insufficientBalance:F}=iv(e=>e.socket);(0,i.useEffect)(()=>{F&&v(!0)},[F]),(0,i.useEffect)(()=>{h(kE({shop_id:f,consultant_id:S}))},[f,S]);const j=()=>{if(!P.current)return!0;const{scrollTop:e,scrollHeight:t,clientHeight:n}=P.current;return t-e-n<100},V=function(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||U.current)&&setTimeout(()=>{P.current&&(P.current.scrollTop=P.current.scrollHeight)},100)};(0,i.useEffect)(()=>{null!==w&&void 0!==w&&w.chatHistory&&(N(w.chatHistory),O.current=null,U.current=!0,setTimeout(()=>{V(!0)},400))},[w,_]),(0,i.useEffect)(()=>{p&&S&&f?R&&0!==R.length&&R.forEach(e=>{if(!e||!e._id)return void console.log("UserChat - Skipping invalid message:",e);if(e._id===O.current)return;const t=String(e.shop_id||e.shopId||""),n=String(f||""),r=String(e.senderId||""),i=String(e.receiverId||""),o=String(p||""),a=String(S||"");t===n&&(r===o&&i===a||r===a&&i===o)?(console.log("UserChat - \u2705 Processing new message for current chat:",e),O.current=e._id,N(t=>{if(t.some(t=>t._id===e._id))return console.log("UserChat - Message already exists, skipping"),t;const n=t.findIndex(t=>{var n;return(null===(n=t._id)||void 0===n?void 0:n.startsWith("temp-"))&&t.text===e.text&&String(t.senderId)===r});if(-1!==n){console.log("UserChat - Replacing temp message with real message");const r=[...t];return r[n]=e,r}return console.log("UserChat - Adding new message to chat"),[...t,e]})):console.log("UserChat -  Message doesn't belong to current chat")}):console.log("UserChat - Missing IDs:",{clientId:p,consultantId:S,shopId:f})},[R,p,S,f]),(0,i.useEffect)(()=>{var e,t;if(!p||!S||!f)return;if(!R||0===R.length)return;const n=R[R.length-1];if(!n)return;if(n._id&&n._id===M.current)return;if(!(String(n.senderId)===String(S)&&String(n.receiverId)===String(p)&&String(n.shop_id)===String(f)))return;const r={senderName:(null===C||void 0===C||null===(e=C.consultant)||void 0===e?void 0:e.fullname)||"Consultant",text:n.text||"",avatar:null!==C&&void 0!==C&&null!==(t=C.consultant)&&void 0!==t&&t.profileImage?"".concat("https://test-online-consultation.zend-apps.com","/").concat(C.consultant.profileImage.replace("\\","/")):null};L(r),D(!0),n._id&&(M.current=n._id)},[R,p,S,f,C]);const B=()=>{if(""!==l.trim()&&p&&S&&f){if(!Ow.connected)return console.warn("Socket not connected, attempting to reconnect..."),Ow.connect(),void setTimeout(()=>{Ow.connected?e():(console.error("Failed to connect socket"),alert("Connection lost. Please refresh the page."))},1e3);e()}function e(){const e={senderId:p,receiverId:S,shop_id:f,text:l,timestamp:(new Date).toISOString()},t=(0,a.A)({_id:"temp-".concat(Date.now())},e);N(e=>[...e,t]),Ow.emit("sendMessage",e),console.log("Message sent via socket:",e),d(""),U.current=!0,setTimeout(()=>{V(!0)},100)}};(0,i.useEffect)(()=>{f&&p&&S&&(h(DE({shopId:f,userId:p,consultantId:S})),N([]),O.current=null)},[h,f,p,S]),(0,i.useEffect)(()=>{if(I.length>0&&P.current&&(j()||U.current)){const e=setTimeout(()=>{V()},200);return()=>clearTimeout(e)}},[I.length]),(0,i.useEffect)(()=>{const e=P.current;if(!e)return;const t=()=>{j()?U.current=!0:U.current=!1};return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}},[]),(0,i.useEffect)(()=>{if(!p||!S||!f)return;const e=e=>{console.log("UserChat - Direct socket message received:",e);const t=String(e.shop_id||e.shopId||""),n=String(f||""),r=String(e.senderId||""),i=String(e.receiverId||""),o=String(p||""),a=String(S||"");if(t===n&&(r===o&&i===a||r===a&&i===o)&&e._id){if(console.log("UserChat - \u2705 Direct: Processing message for current chat"),e._id===O.current)return;O.current=e._id,N(t=>{if(t.some(t=>t._id===e._id))return t;const n=t.findIndex(t=>{var n;return(null===(n=t._id)||void 0===n?void 0:n.startsWith("temp-"))&&t.text===e.text&&String(t.senderId)===r});if(-1!==n){const r=[...t];return r[n]=e,r}return[...t,e]})}};return Ow.on("receiveMessage",e),()=>{Ow.off("receiveMessage",e)}},[p,S,f]),(0,i.useEffect)(()=>{p&&S&&0!==I.length&&(console.log("Marking messages as seen",p,S),Ow.emit("markSeen",{senderId:S,receiverId:p}))},[p,S]),console.log("chatMessagesData____UserChat",I);const{chatTimer:W}=iv(e=>e.socket),{autoChatEnded:H}=iv(e=>e.socket),[G,z]=(0,i.useState)(0);console.log("chatTimer____ChatsPage",W),(0,i.useEffect)(()=>{if(!W.isRunning||!W.startTime)return;const e=setInterval(()=>{const e=Math.floor((Date.now()-new Date(W.startTime))/1e3);z(e)},1e3);return()=>clearInterval(e)},[W.isRunning,W.startTime]);const K=Math.floor(G/60),Y=G%60;return(0,i.useEffect)(()=>{H&&(Ow.emit("endChat",{transactionId:W.transactionId,startTime:W.startTime,isRunning:W.isRunning,shopId:W.shopId,userId:p,consultantId:S}),z(0),E(!0))},[H]),(0,ad.jsxs)(i.Fragment,{children:[(0,ad.jsx)(wN,{show:_,setShow:v,insufficientBalance:F}),(0,ad.jsx)("div",{className:XI,children:(0,ad.jsx)("div",{className:JI,children:(0,ad.jsx)("div",{className:$I,children:(0,ad.jsxs)("div",{className:eN,children:[(0,ad.jsxs)("div",{className:tN,children:[(0,ad.jsxs)("div",{className:nN,children:[(0,ad.jsx)("button",{onCLick:()=>(()=>{const e=T;window.top.location.href="https://".concat(e,"/apps/consultant-theme/view-profile?consultantId=").concat(S,"&shopId=").concat(f).concat("")})(),className:rN,title:"Go Back",children:(0,ad.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,ad.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),(0,ad.jsxs)("div",{className:ZI,children:[(0,ad.jsx)("div",{className:iN,children:(0,ad.jsx)("img",{src:A,alt:null===C||void 0===C||null===(n=C.consultant)||void 0===n?void 0:n.fullname,className:iN})}),(null===C||void 0===C||null===(r=C.consultant)||void 0===r?void 0:r.isActive)&&(0,ad.jsx)("div",{className:QI})]}),(0,ad.jsxs)("div",{children:[(0,ad.jsx)("div",{className:oN,children:null===C||void 0===C||null===(o=C.consultant)||void 0===o?void 0:o.fullname}),(0,ad.jsx)("div",{className:aN,style:{color:null!==C&&void 0!==C&&null!==(s=C.consultant)&&void 0!==s&&s.isActive?"#10b981":"#6c757d"},children:null!==C&&void 0!==C&&null!==(c=C.consultant)&&void 0!==c&&c.isActive?"Active now":"Offline"})]})]}),(0,ad.jsxs)("div",{className:sN,children:[W.isRunning&&(0,ad.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",mr:"10px"},children:[(0,ad.jsxs)("p",{children:[" Timer: ",K,":",Y]}),(0,ad.jsx)("div",{children:(0,ad.jsx)("button",{onClick:()=>{Ow.emit("endChat",{transactionId:W.transactionId,startTime:W.startTime,isRunning:W.isRunning,shopId:W.shopId,userId:p,consultantId:S}),z(0),E(!0)},style:{padding:"5px 12px",backgroundColor:"#ff4d4f",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"Stop Chat"})})]}),(0,ad.jsx)("button",{className:cN,title:"Video Call",onClick:()=>u("/video-call",{state:{conversation:null===C||void 0===C?void 0:C.consultant}}),children:(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("path",{d:"M23 7l-7 5 7 5V7z"}),(0,ad.jsx)("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]})}),(0,ad.jsx)("button",{className:cN,title:"More Options",children:(0,ad.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,ad.jsx)("circle",{cx:"19",cy:"12",r:"1"}),(0,ad.jsx)("circle",{cx:"5",cy:"12",r:"1"})]})})]})]}),(0,ad.jsx)("div",{className:lN,ref:P,children:0===I.length?(0,ad.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"90vh"},children:(0,ad.jsx)("p",{children:"No messages yet. Start the conversation!"})}):(0,ad.jsx)(ad.Fragment,{children:I.map(e=>{var t;const n=e.senderId===p,r=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0});return(0,ad.jsx)("div",{className:"".concat(dN," ").concat(n?hN:uN),children:(0,ad.jsxs)("div",{className:"".concat(pN," ").concat(n?mN:fN),children:[!n&&(0,ad.jsx)("div",{className:gN,children:(null===C||void 0===C||null===(t=C.consultant)||void 0===t?void 0:t.fullname)||"Consultant"}),(0,ad.jsx)("div",{className:_N,children:e.text}),(0,ad.jsx)("div",{className:vN,children:r})]})},e._id)})})}),(0,ad.jsx)("div",{className:bN,children:(0,ad.jsxs)("div",{className:EN,children:[(0,ad.jsx)("button",{className:yN,title:"Attach File",children:(0,ad.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:(0,ad.jsx)("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"})})}),(0,ad.jsx)("input",{onChange:e=>d(e.target.value),value:l||"",type:"text",className:SN,placeholder:"Type a message...",onKeyPress:e=>{"Enter"===e.key&&null!==l&&void 0!==l&&l.trim()&&B()}}),(0,ad.jsx)("button",{onClick:B,className:TN,title:"Send",children:(0,ad.jsxs)("svg",{className:CN,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[(0,ad.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,ad.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})})]})})})})]})},AN="LoginForm_loginPageContainer__kO7EM",IN="LoginForm_loginContainer__j9YAi",NN="LoginForm_loginTitle__Qz6AW",ON="LoginForm_loginForm__wvelV",PN="LoginForm_formGroup__oFZK7",kN="LoginForm_formLabel__tEjMp",DN="LoginForm_formInput__fHjSt",xN="LoginForm_passwordInputWrapper__L1VUO",LN="LoginForm_passwordToggle__bky86",MN="LoginForm_inputError__hX3Pp",UN="LoginForm_errorMessage__GALWC",FN="LoginForm_forgotPasswordContainer__5z7pD",jN="LoginForm_forgotPassword__aaTnF",VN="LoginForm_submitButton__4oETW",BN="LoginForm_buttonLoading__Lvq1O",WN="LoginForm_spinner__w5ds6",HN="LoginForm_createAccountLink__sse4l",GN=e=>{let{userId:t,shopId:n}=e;const r="".concat(window.location.origin,"/fcm-token?userId=").concat(encodeURIComponent(t),"&shopId=").concat(encodeURIComponent(n));window.open(r,"fcmTokenWindow","width=600,height=500,scrollbars=yes")},zN=()=>{const e=he(),[t,n]=(0,i.useState)({email:"",password:""}),[r,o]=(0,i.useState)(!1),[s,c]=(0,i.useState)({}),[l,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(""),p=new URLSearchParams(window.location.search),m=p.get("shop"),f=p.get("host");console.log("shop",m),console.log("host",f),console.log("tokenStatus",u);const g=e=>{const{name:t,value:r}=e.target;n(e=>(0,a.A)((0,a.A)({},e),{},{[t]:r})),s[t]&&c(e=>(0,a.A)((0,a.A)({},e),{},{[t]:""}))};(0,i.useEffect)(()=>{const t=t=>{var n;t.origin===window.location.origin&&!0===(null===(n=t.data)||void 0===n?void 0:n.tokenGenerated)&&(console.log("\u2705 Token generated, message received"),((t,n)=>{const r=t,i=n?"?host=".concat(encodeURIComponent(n)):"";r?window.top.location.href="https://".concat(r,"/apps/consultant-theme/consultant-dashboard").concat(i):e("/consultant-dashboard")})(m,f))};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[]);return(0,ad.jsx)("div",{className:AN,children:(0,ad.jsxs)("div",{className:IN,children:[(0,ad.jsx)("h1",{className:NN,children:"Login"}),(0,ad.jsxs)("form",{className:ON,onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return t.email?/\S+@\S+\.\S+/.test(t.email)||(e.email="Email is invalid"):e.email="Email is required",t.password?t.password.length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",c(e),0===Object.keys(e).length})())try{var n,r;const e=await AE.post("".concat("https://test-online-consultation.zend-apps.com","/api-consultant/login-consultant"),t),{userData:i,token:o}=null===e||void 0===e?void 0:e.data;if(console.log("userData",e),console.log("token",null===e||void 0===e?void 0:e.data),200===e.status&&null!==(n=e.data)&&void 0!==n&&null!==(r=n.userData)&&void 0!==r&&r._id){const e=new URLSearchParams(window.location.search),t=(e.get("shop"),e.get("host"),null===i||void 0===i?void 0:i._id),n=null===i||void 0===i?void 0:i.shop_id;localStorage.setItem("client_u_Identity",t),localStorage.setItem("shop_o_Identity",n),localStorage.setItem("varify_tokem",o),GN({userId:t,shopId:n})}else c({email:"Invalid email or password"})}catch(ex){console.error("login error",ex),c({email:"Something went wrong. Please try again."})}},children:[(0,ad.jsxs)("div",{className:PN,children:[(0,ad.jsx)("label",{htmlFor:"email",className:kN,children:"Email"}),(0,ad.jsx)("input",{type:"email",id:"email",name:"email",className:"".concat(DN," ").concat(s.email?MN:""),value:t.email,onChange:g,autoComplete:"email"}),s.email&&(0,ad.jsx)("span",{className:UN,children:s.email})]}),(0,ad.jsxs)("div",{className:PN,children:[(0,ad.jsx)("label",{htmlFor:"password",className:kN,children:"Password"}),(0,ad.jsxs)("div",{className:xN,children:[(0,ad.jsx)("input",{type:r?"text":"password",id:"password",name:"password",className:"".concat(DN," ").concat(s.password?MN:""),value:t.password,onChange:g,autoComplete:"current-password"}),(0,ad.jsx)("button",{type:"button",className:LN,onClick:()=>o(!r),"aria-label":r?"Hide password":"Show password",children:r?(0,ad.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,ad.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,ad.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,ad.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]}),s.password&&(0,ad.jsx)("span",{className:UN,children:s.password})]}),(0,ad.jsx)("div",{className:FN,children:(0,ad.jsx)("a",{href:"#",className:jN,onClick:e=>e.preventDefault(),children:"Forgot your password?"})}),u&&(0,ad.jsx)("div",{style:{padding:"10px",marginBottom:"15px",backgroundColor:"#e7f3ff",borderRadius:"5px",textAlign:"center",fontSize:"14px",color:"#0066cc"},children:u}),(0,ad.jsx)("button",{type:"submit",className:"".concat(VN," ").concat(l?BN:""),disabled:l,children:l?(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsxs)("svg",{className:WN,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,ad.jsx)("line",{x1:"12",y1:"2",x2:"12",y2:"6"}),(0,ad.jsx)("line",{x1:"12",y1:"18",x2:"12",y2:"22"}),(0,ad.jsx)("line",{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}),(0,ad.jsx)("line",{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}),(0,ad.jsx)("line",{x1:"2",y1:"12",x2:"6",y2:"12"}),(0,ad.jsx)("line",{x1:"18",y1:"12",x2:"22",y2:"12"}),(0,ad.jsx)("line",{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}),(0,ad.jsx)("line",{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"})]}),u||"Signing in..."]}):"Log in"}),(0,ad.jsx)("div",{className:HN,children:(0,ad.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e("/signup")},children:"Create account"})})]})]})})};function KN(e){let{message:t,onClose:n}=e;return t?(0,ad.jsxs)(ad.Fragment,{children:[(0,ad.jsx)("style",{children:"\n          .bs-popup {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            width: 330px;\n            background: rgba(20,20,20,0.4);\n            backdrop-filter: blur(12px);\n            border-radius: 8px;\n            padding: 1rem;\n            z-index: 99999;\n            color: #fff;\n            animation: slideUp .4s ease forwards;\n          }\n  \n          @keyframes slideUp {\n            from { opacity: 0; transform: translateY(50px); }\n            to { opacity: 1; transform: translateY(0); }\n          }\n  \n          .bs-popup img {\n            width: 48px;\n            height: 48px;\n            border-radius: 50%;\n          }\n  \n          .bs-close-btn {\n            position: absolute;\n            top: 8px;\n            right: 12px;\n            font-size: 22px;\n            background: none;\n            border: none;\n            color: #fff;\n            cursor: pointer;\n          }\n        "}),(0,ad.jsxs)("div",{className:"bs-popup d-flex align-items-center gap-3",children:[(0,ad.jsx)("button",{className:"bs-close-btn",onClick:n,children:"\xd7"}),(0,ad.jsx)("img",{src:"https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg",alt:t.senderName||"User"}),(0,ad.jsxs)("div",{children:[(0,ad.jsx)("h5",{className:"fw-bold mb-1",children:t.senderName||"User"}),(0,ad.jsx)("p",{children:t.text||"New message received"})]})]})]}):null}function YN(){const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)(!1),o=(0,i.useRef)(null),[a,s]=(0,i.useState)(null);(0,i.useEffect)(()=>{const e=localStorage.getItem("client_u_Identity");e&&s(e)},[]);const c=iv(e=>e.socket.messages);return(0,i.useEffect)(()=>{if(!Array.isArray(c))return;if(0===c.length)return;if(!a)return;const e=c.length-1,n=c[e];if(!n)return;if(n.receiverId!==a)return;if(o.current===n._id)return;o.current=n._id,t(n),r(!0);const i=setTimeout(()=>{r(!1)},6e3);return()=>clearTimeout(i)},[c,a]),(0,ad.jsx)(ad.Fragment,{children:n&&e&&(0,ad.jsx)(KN,{message:e,onClose:()=>r(!1)})})}const qN={profileSection:"ProfileSection_profileSection__P-ufT",profileRight:"ProfileSection_profileRight__461rL",profileSectionHeader:"ProfileSection_profileSectionHeader__KkePF",profileImageContainer:"ProfileSection_profileImageContainer__LA28Z",profileTitle:"ProfileSection_profileTitle__BuzLb",profileImage:"ProfileSection_profileImage__xiwpg",profileNav:"ProfileSection_profileNav__tg6cr",profileNavButton:"ProfileSection_profileNavButton__c71GH",profileNavButtonActive:"ProfileSection_profileNavButtonActive__Z1tsl",profileContent:"ProfileSection_profileContent__8zdvq",profileLeft:"ProfileSection_profileLeft__K-nNi",profileBasicInfo:"ProfileSection_profileBasicInfo__EPrCh"},XN=()=>{var e,t,n;const[r,o]=(0,i.useState)(null),[a,s]=(0,i.useState)(null),c=new URLSearchParams(window.location.search),l=c.get("shop"),d=c.get("logged_in_customer_Id");console.log("loggedInCustomerId",d),console.log("shop",l),console.log("userId",r);const u=tv(),{userDetails:h}=iv(e=>e.users),p=null===h||void 0===h||null===(e=h.data)||void 0===e?void 0:e.walletBalance;(0,i.useEffect)(()=>{const e=localStorage.getItem("client_u_Identity");o(e)},[l]),(0,i.useEffect)(()=>{u(NE(r))},[r]);return(0,i.useEffect)(()=>{(async e=>{const t=await AE.get("".concat("https://test-online-consultation.zend-apps.com","/api/admin/get/vouchers/").concat(e));200===t.status&&s(t.data.data)})("690c374f605cb8b946503ccb")},[]),console.log("vo",a),(0,ad.jsxs)("div",{className:qN.profileSection,children:[(0,ad.jsxs)("div",{className:qN.profileSectionHeader,children:[(0,ad.jsx)("h1",{className:qN.profileTitle,children:"Profile Settings"}),(0,ad.jsx)("div",{className:qN.profileImageContainer,children:(0,ad.jsx)("div",{className:qN.profileImage,children:(0,ad.jsx)("img",{className:"h-100 w-100 object-fit-cover",src:"https://imgs.search.brave.com/LgLnG0YyKC78VZULy9IVIpVyQVnacpc2pmuro63xxSo/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9pbWcu/ZnJlZXBpay5jb20v/cHJlbWl1bS1waG90/by91c2VyLXByb2Zp/bGUtcG5nLXByb2Zl/c3Npb25hbC1idXNp/bmVzc3dvbWFuLXN0/aWNrZXItdHJhbnNw/YXJlbnQtYmFja2dy/b3VuZF81Mzg3Ni0x/MDQ5MDE3LmpwZz9z/ZW10PWFpc19oeWJy/aWQmdz03NDAmcT04/MA",alt:"profile"})})}),(0,ad.jsx)("div",{className:qN.profileName,children:(0,ad.jsxs)(nd,{children:[(0,ad.jsx)(Dc,{label:"Full Name",type:"text",value:null===h||void 0===h||null===(t=h.data)||void 0===t?void 0:t.fullname,autoComplete:"off"}),(0,ad.jsx)(Dc,{label:"Email",type:"text",value:null===h||void 0===h||null===(n=h.data)||void 0===n?void 0:n.email,autoComplete:"off"})]})})]}),(0,ad.jsxs)("div",{className:qN.profileRight,children:[(0,ad.jsxs)("div",{className:qN.profileNav,children:[(0,ad.jsx)(gt,{to:"voucher",className:e=>{let{isActive:t}=e;return t?"".concat(qN.profileNavButton," ").concat(qN.profileNavButtonActive):qN.profileNavButton},children:"Voucher"}),(0,ad.jsx)(gt,{to:"history",className:e=>{let{isActive:t}=e;return t?"".concat(qN.profileNavButton," ").concat(qN.profileNavButtonActive):qN.profileNavButton},children:"History"})]}),(0,ad.jsx)("div",{className:qN.profileContent,children:(0,ad.jsx)(Oe,{context:{shop:l,userId:r,walletBalance:p,voucherData:a}})})]})]})},JN="Voucher_voucherPage__oVPSR",ZN="Voucher_title__-xBpC",QN="Voucher_balanceSection__LaICg",$N="Voucher_balanceValue__Iazvl",eO="Voucher_sectionHeader__KI7le",tO="Voucher_sectionTitle__estLw",nO="Voucher_cardGrid__V3rDb",rO="Voucher_rechargeCard__jGYB4",iO="Voucher_rechargeCardHighlighted__CjWhF",oO="Voucher_badge__8uUOk",aO="Voucher_amount__ytI29",sO="Voucher_extra__YUyjJ";const cO=function(){var e;const{shop:t,userId:n,walletBalance:r,voucherData:o}=i.useContext(pe);return console.log("voucherData",o),(0,ad.jsxs)("div",{className:JN,children:[(0,ad.jsx)("h1",{className:ZN,children:"Add Money to Wallet"}),(0,ad.jsx)("div",{className:QN,children:(0,ad.jsxs)("span",{className:$N,children:["Coins : ",r]})}),(0,ad.jsx)("div",{className:eO,children:(0,ad.jsx)("h2",{className:tO,children:"Popular Recharge"})}),(0,ad.jsx)("div",{className:nO,children:null===o||void 0===o||null===(e=o.voucherCode)||void 0===e?void 0:e.map(e=>(0,ad.jsxs)("button",{type:"button",onClick:()=>(async e=>{const r=await AE.post("".concat("https://test-online-consultation.zend-apps.com","/api/draft-order/create-draft-order"),{amount:e,shop:t,title:"Recharge Amount",userId:n}),i=r.data;200===r.status?(q(i.invoiceUrl),window.open(i.invoiceUrl,"_blank")):console.log("error",r.data)})(e.totalCoin),className:"".concat(rO," ").concat(e.badge?iO:""),children:[e.extraCoin&&(0,ad.jsx)("span",{className:oO,children:e.extraCoin}),(0,ad.jsxs)("div",{className:aO,children:["\u20b9",e.totalCoin]}),(0,ad.jsxs)("div",{className:sO,children:["Extra : ",e.extraCoin]})]},e.id))})]})},lO=()=>(0,ad.jsxs)("div",{children:[(0,ad.jsx)("h2",{children:"History"}),(0,ad.jsx)("p",{children:"This is the history section of the user profile."})]});const dO=function(){return(0,ad.jsx)("div",{})};const uO=function(){const[e,t]=(0,i.useState)({totalCoin:"",extraCoin:""}),[n,r]=(0,i.useState)(!1),[o,s]=(0,i.useState)(""),[c,l]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),h=new URLSearchParams(window.location.search).get("adminId")||"690c374f605cb8b946503ccb",p=(0,i.useCallback)(e=>n=>{t(t=>(0,a.A)((0,a.A)({},t),{},{[e]:n})),o&&s(""),c&&l(!1)},[o,c]),m=(0,i.useCallback)(()=>e.totalCoin&&""!==e.totalCoin.trim()?isNaN(Number(e.totalCoin))||Number(e.totalCoin)<0?(s("Total Coin must be a valid positive number"),!1):e.extraCoin&&""!==e.extraCoin.trim()?!(isNaN(Number(e.extraCoin))||Number(e.extraCoin)<0)||(s("Extra Coin must be a valid positive number"),!1):(s("Extra Coin is required"),!1):(s("Total Coin is required"),!1),[e]),f=(0,i.useCallback)(async()=>{if(m()){r(!0),s(""),l(!1);try{const n={totalCoin:Number(e.totalCoin),extraCoin:Number(e.extraCoin)},r=await AE.post("".concat("https://test-online-consultation.zend-apps.com","/api/admin/admin/voucher/").concat(h),n,{headers:{"Content-Type":"application/json"}});var t;if(r.data&&(r.data.success||200===r.status))l(!0),u(n);else s((null===(t=r.data)||void 0===t?void 0:t.message)||"Failed to save voucher settings. Please try again.")}catch(o){var n,i;console.error("Error saving voucher settings:",o),s((null===(n=o.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||o.message||"Failed to save voucher settings. Please try again.")}finally{r(!1)}}},[e,h,m]),g=(0,i.useCallback)(()=>{l(!1),s("")},[]);return(0,ad.jsx)(pu,{title:"Voucher Settings",primaryAction:{content:"Save Settings",onAction:f,loading:n,disabled:n},children:(0,ad.jsx)(gu,{children:(0,ad.jsx)(gu.Section,{children:(0,ad.jsxs)(qs,{gap:"400",children:[c&&(0,ad.jsx)(Tu,{title:"Settings saved successfully",status:"success",onDismiss:g,children:(0,ad.jsx)("p",{children:"Voucher settings have been saved successfully."})}),o&&(0,ad.jsx)(Tu,{title:"Error saving settings",status:"critical",onDismiss:g,children:(0,ad.jsx)("p",{children:o})}),(0,ad.jsx)(Xu,{sectioned:!0,title:"Dynamic Card Coin Settings",children:(0,ad.jsxs)(nd,{children:[(0,ad.jsx)(Dc,{label:"Total Coin",type:"number",value:e.totalCoin,onChange:p("totalCoin"),placeholder:"Enter total coin amount",helpText:"Set the total coin amount for dynamic cards",autoComplete:"off",min:0,step:"1"}),(0,ad.jsx)(Dc,{label:"Extra Coin",type:"number",value:e.extraCoin,onChange:p("extraCoin"),placeholder:"Enter extra coin amount",helpText:"Set the extra coin amount for dynamic cards",autoComplete:"off",min:0,step:"1"}),(0,ad.jsx)("div",{style:{marginTop:"1rem"},children:(0,ad.jsx)(fs,{primary:!0,onClick:f,loading:n,disabled:n,children:d?"Update Settings":"Save Settings"})})]})}),d&&(0,ad.jsx)(Xu,{sectioned:!0,title:"Current Settings",children:(0,ad.jsxs)(qs,{gap:"200",children:[(0,ad.jsxs)("p",{children:[(0,ad.jsx)("strong",{children:"Total Coin:"})," ",d.totalCoin||e.totalCoin]}),(0,ad.jsxs)("p",{children:[(0,ad.jsx)("strong",{children:"Extra Coin:"})," ",d.extraCoin||e.extraCoin]})]})})]})})})})},hO=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},pO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],o=i+1<e.length,a=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=t>>2,d=(3&t)<<4|a>>4;let u=(15&a)<<2|c>>6,h=63&c;s||(h=64,o||(u=64)),r.push(n[l],n[d],n[u],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(hO(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const s=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==o||null==a||null==s)throw new mO;const c=t<<2|o>>4;if(r.push(c),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==s){const e=a<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class mO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fO=function(e){return function(e){const t=hO(e);return pO.encodeByteArray(t,!0)}(e).replace(/\./g,"")},gO=function(e){try{return pO.decodeString(e,!0)}catch($D){console.error("base64Decode failed: ",$D)}return null};const _O=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,vO=()=>{try{return _O()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_APP_ID:"656422a01e774a4ba5b2dc0ac12e5fe5",REACT_APP_BACKEND_HOST:"https://test-online-consultation.zend-apps.com",REACT_APP_FIREBASE_API_KEY:"AIzaSyCi61pDIUtbi7pvnxfFRNIpi8RjTHpFNxs",REACT_APP_FIREBASE_APP_ID:"1:465295888006:web:ae07e6f6667e0e6f838b07",REACT_APP_FIREBASE_AUTH_DOMAIN:"consultant-app-24ceb.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-9TD9Q1Q0PJ",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"465295888006",REACT_APP_FIREBASE_PROJECT_ID:"consultant-app-24ceb",REACT_APP_FIREBASE_STORAGE_BUCKET:"consultant-app-24ceb.firebasestorage.app",REACT_APP_FIREBASE_VAPID_KEY:"BB8E-fAs8w3xZZ3cL_R3jjnTHaNDu4LGcra1NJhX60UG0lxvzBHVzzblrvv7cm6FMaGo_o_r2hbiB1eibrtg1h0",REACT_APP_SHOPIFY_API_KEY:"1844b97873b270b025334fd34790185c"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch($D){return}const t=e&&gO(e[1]);return t&&JSON.parse(t)})()}catch($D){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat($D))}},bO=()=>{var e;return null===(e=vO())||void 0===e?void 0:e.config};class EO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function yO(){try{return"object"===typeof indexedDB}catch($D){return!1}}function SO(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class TO extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,TO.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,CO.prototype.create)}}class CO{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(wO,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",o="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new TO(n,o,t)}}const wO=/\{\$([^}]+)}/g;function RO(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(AO(n)&&AO(o)){if(!RO(n,o))return!1}else if(n!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function AO(e){return null!==e&&"object"===typeof e}function IO(e){return e&&e._delegate?e._delegate:e}class NO{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const OO="[DEFAULT]";class PO{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new EO;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch($D){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch($D){if(r)return null;throw $D}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:OO})}catch($D){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch($D){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:OO;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:OO;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:OO;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===OO?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:OO;return this.component?this.component.multipleInstances?e:OO:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class kO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PO(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const DO=[];var xO;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(xO||(xO={}));const LO={debug:xO.DEBUG,verbose:xO.VERBOSE,info:xO.INFO,warn:xO.WARN,error:xO.ERROR,silent:xO.SILENT},MO=xO.INFO,UO={[xO.DEBUG]:"log",[xO.VERBOSE]:"log",[xO.INFO]:"info",[xO.WARN]:"warn",[xO.ERROR]:"error"},FO=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=UO[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...o)};let jO,VO;const BO=new WeakMap,WO=new WeakMap,HO=new WeakMap,GO=new WeakMap,zO=new WeakMap;let KO={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return WO.get(e);if("objectStoreNames"===t)return e.objectStoreNames||HO.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return XO(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function YO(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(VO||(VO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(JO(this),n),XO(BO.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return XO(e.apply(JO(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.call(JO(this),t,...r);return HO.set(o,t.sort?t.sort():[t]),XO(o)}}function qO(e){return"function"===typeof e?YO(e):(e instanceof IDBTransaction&&function(e){if(WO.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});WO.set(e,t)}(e),t=e,(jO||(jO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,KO):e);var t}function XO(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(XO(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&BO.set(t,e)}).catch(()=>{}),zO.set(t,e),t}(e);if(GO.has(e))return GO.get(e);const t=qO(e);return t!==e&&(GO.set(e,t),zO.set(t,e)),t}const JO=e=>zO.get(e);function ZO(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),s=XO(a);return r&&a.addEventListener("upgradeneeded",e=>{r(XO(a.result),e.oldVersion,e.newVersion,XO(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}function QO(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),XO(n).then(()=>{})}const $O=["get","getKey","getAll","getAllKeys","count"],eP=["put","add","delete","clear"],tP=new Map;function nP(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(tP.get(t))return tP.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=eP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!$O.includes(n))return;const o=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let o=t.store;for(var a=arguments.length,s=new Array(a>1?a-1:0),c=1;c<a;c++)s[c-1]=arguments[c];return r&&(o=o.index(s.shift())),(await Promise.all([o[n](...s),i&&t.done]))[0]};return tP.set(t,o),o}KO=(e=>(0,a.A)((0,a.A)({},e),{},{get:(t,n,r)=>nP(t,n)||e.get(t,n,r),has:(t,n)=>!!nP(t,n)||e.has(t,n)}))(KO);class rP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const iP="@firebase/app",oP="0.14.6",aP=new class{constructor(e){this.name=e,this._logLevel=MO,this._logHandler=FO,this._userLogHandler=null,DO.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xO))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?LO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xO.DEBUG,...t),this._logHandler(this,xO.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xO.VERBOSE,...t),this._logHandler(this,xO.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xO.INFO,...t),this._logHandler(this,xO.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xO.WARN,...t),this._logHandler(this,xO.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xO.ERROR,...t),this._logHandler(this,xO.ERROR,...t)}}("@firebase/app"),sP="@firebase/app-compat",cP="@firebase/analytics-compat",lP="@firebase/analytics",dP="@firebase/app-check-compat",uP="@firebase/app-check",hP="@firebase/auth",pP="@firebase/auth-compat",mP="@firebase/database",fP="@firebase/data-connect",gP="@firebase/database-compat",_P="@firebase/functions",vP="@firebase/functions-compat",bP="@firebase/installations",EP="@firebase/installations-compat",yP="@firebase/messaging",SP="@firebase/messaging-compat",TP="@firebase/performance",CP="@firebase/performance-compat",wP="@firebase/remote-config",RP="@firebase/remote-config-compat",AP="@firebase/storage",IP="@firebase/storage-compat",NP="@firebase/firestore",OP="@firebase/ai",PP="@firebase/firestore-compat",kP="firebase",DP="[DEFAULT]",xP={[iP]:"fire-core",[sP]:"fire-core-compat",[lP]:"fire-analytics",[cP]:"fire-analytics-compat",[uP]:"fire-app-check",[dP]:"fire-app-check-compat",[hP]:"fire-auth",[pP]:"fire-auth-compat",[mP]:"fire-rtdb",[fP]:"fire-data-connect",[gP]:"fire-rtdb-compat",[_P]:"fire-fn",[vP]:"fire-fn-compat",[bP]:"fire-iid",[EP]:"fire-iid-compat",[yP]:"fire-fcm",[SP]:"fire-fcm-compat",[TP]:"fire-perf",[CP]:"fire-perf-compat",[wP]:"fire-rc",[RP]:"fire-rc-compat",[AP]:"fire-gcs",[IP]:"fire-gcs-compat",[NP]:"fire-fst",[PP]:"fire-fst-compat",[OP]:"fire-vertex","fire-js":"fire-js",[kP]:"fire-js-all"},LP=new Map,MP=new Map,UP=new Map;function FP(e,t){try{e.container.addComponent(t)}catch($D){aP.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),$D)}}function jP(e){const t=e.name;if(UP.has(t))return aP.debug("There were multiple attempts to register component ".concat(t,".")),!1;UP.set(t,e);for(const n of LP.values())FP(n,e);for(const n of MP.values())FP(n,e);return!0}function VP(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const BP=new CO("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class WP{constructor(e,t,n){this._isDeleted=!1,this._options=(0,a.A)({},e),this._config=(0,a.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new NO("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw BP.create("app-deleted",{appName:this._name})}}function HP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=(0,a.A)({name:DP,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw BP.create("bad-app-name",{appName:String(i)});if(n||(n=bO()),!n)throw BP.create("no-options");const o=LP.get(i);if(o){if(RO(n,o.options)&&RO(r,o.config))return o;throw BP.create("duplicate-app",{appName:i})}const s=new kO(i);for(const a of UP.values())s.addComponent(a);const c=new WP(n,r,s);return LP.set(i,c),c}function GP(e,t,n){var r;let i=null!==(r=xP[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void aP.warn(e.join(" "))}jP(new NO("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const zP="firebase-heartbeat-store";let KP=null;function YP(){return KP||(KP=ZO("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(zP)}catch($D){console.warn($D)}}}).catch(e=>{throw BP.create("idb-open",{originalErrorMessage:e.message})})),KP}async function qP(e,t){try{const n=(await YP()).transaction(zP,"readwrite"),r=n.objectStore(zP);await r.put(t,XP(e)),await n.done}catch($D){if($D instanceof TO)aP.warn($D.message);else{const t=BP.create("idb-set",{originalErrorMessage:null===$D||void 0===$D?void 0:$D.message});aP.warn(t.message)}}}function XP(e){return"".concat(e.name,"!").concat(e.options.appId)}class JP{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new QP(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ZP();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch($D){aP.warn($D)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ZP(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),$P(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),$P(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=fO(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch($D){return aP.warn($D),""}}}function ZP(){return(new Date).toISOString().substring(0,10)}class QP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!yO()&&SO().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await YP()).transaction(zP),n=await t.objectStore(zP).get(XP(e));return await t.done,n}catch($D){if($D instanceof TO)aP.warn($D.message);else{const t=BP.create("idb-get",{originalErrorMessage:null===$D||void 0===$D?void 0:$D.message});aP.warn(t.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return qP(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return qP(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function $P(e){return fO(JSON.stringify({version:2,heartbeats:e})).length}var ek;ek="",jP(new NO("platform-logger",e=>new rP(e),"PRIVATE")),jP(new NO("heartbeat",e=>new JP(e),"PRIVATE")),GP(iP,oP,ek),GP(iP,oP,"esm2020"),GP("fire-js","");const tk="@firebase/installations",nk="0.6.19",rk=1e4,ik="w:".concat(nk),ok="FIS_v2",ak=36e5,sk=new CO("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ck(e){return e instanceof TO&&e.code.includes("request-failed")}function lk(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function dk(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function uk(e,t){const n=(await t.json()).error;return sk.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function hk(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function pk(e,t){let{refreshToken:n}=t;const r=hk(e);return r.append("Authorization",function(e){return"".concat(ok," ").concat(e)}(n)),r}async function mk(e){const t=await e();return t.status>=500&&t.status<600?e():t}function fk(e){return new Promise(t=>{setTimeout(t,e)})}const gk=/^[cdef][\w-]{21}$/;function _k(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return gk.test(t)?t:""}catch(e){return""}}function vk(e){return"".concat(e.appName,"!").concat(e.appId)}const bk=new Map;function Ek(e,t){const n=vk(e);yk(n,t),function(e,t){const n=Tk();n&&n.postMessage({key:e,fid:t});Ck()}(n,t)}function yk(e,t){const n=bk.get(e);if(n)for(const r of n)r(t)}let Sk=null;function Tk(){return!Sk&&"BroadcastChannel"in self&&(Sk=new BroadcastChannel("[Firebase] FID Change"),Sk.onmessage=e=>{yk(e.data.key,e.data.fid)}),Sk}function Ck(){0===bk.size&&Sk&&(Sk.close(),Sk=null)}const wk="firebase-installations-store";let Rk=null;function Ak(){return Rk||(Rk=ZO("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(wk)}})),Rk}async function Ik(e,t){const n=vk(e),r=(await Ak()).transaction(wk,"readwrite"),i=r.objectStore(wk),o=await i.get(n);return await i.put(t,n),await r.done,o&&o.fid===t.fid||Ek(e,t.fid),t}async function Nk(e){const t=vk(e),n=(await Ak()).transaction(wk,"readwrite");await n.objectStore(wk).delete(t),await n.done}async function Ok(e,t){const n=vk(e),r=(await Ak()).transaction(wk,"readwrite"),i=r.objectStore(wk),o=await i.get(n),a=t(o);return void 0===a?await i.delete(n):await i.put(a,n),await r.done,!a||o&&o.fid===a.fid||Ek(e,a.fid),a}async function Pk(e){let t;const n=await Ok(e.appConfig,n=>{const r=function(e){const t=e||{fid:_k(),registrationStatus:0};return xk(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(sk.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const o=lk(n),a=hk(n),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const c={fid:i,authVersion:ok,appId:n.appId,sdkVersion:ik},l={method:"POST",headers:a,body:JSON.stringify(c)},d=await mk(()=>fetch(o,l));if(d.ok){const e=await d.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:dk(e.authToken)}}throw await uk("Create Installation",d)}(e,t);return Ik(e.appConfig,n)}catch($D){throw ck($D)&&409===$D.customData.serverCode?await Nk(e.appConfig):await Ik(e.appConfig,{fid:t.fid,registrationStatus:0}),$D}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:kk(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function kk(e){let t=await Dk(e.appConfig);for(;1===t.registrationStatus;)await fk(100),t=await Dk(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Pk(e);return n||t}return t}function Dk(e){return Ok(e,e=>{if(!e)throw sk.create("installation-not-found");return xk(e)})}function xk(e){return 1===(t=e).registrationStatus&&t.registrationTime+rk<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Lk(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return"".concat(lk(e),"/").concat(n,"/authTokens:generate")}(n,t),o=pk(n,t),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const s={installation:{sdkVersion:ik,appId:n.appId}},c={method:"POST",headers:o,body:JSON.stringify(s)},l=await mk(()=>fetch(i,c));if(l.ok){return dk(await l.json())}throw await uk("Generate Auth Token",l)}async function Mk(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await Ok(e.appConfig,r=>{if(!Fk(r))throw sk.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+ak}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await Uk(e.appConfig);for(;1===n.authToken.requestStatus;)await fk(100),n=await Uk(e.appConfig);const r=n.authToken;return 0===r.requestStatus?Mk(e,t):r}(e,n),r;{if(!navigator.onLine)throw sk.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return(0,a.A)((0,a.A)({},e),{},{authToken:t})}(r);return t=async function(e,t){try{const n=await Lk(e,t),r=(0,a.A)((0,a.A)({},t),{},{authToken:n});return await Ik(e.appConfig,r),n}catch($D){if(!ck($D)||401!==$D.customData.serverCode&&404!==$D.customData.serverCode){const n=(0,a.A)((0,a.A)({},t),{},{authToken:{requestStatus:0}});await Ik(e.appConfig,n)}else await Nk(e.appConfig);throw $D}}(e,n),n}});return t?await t:r.authToken}function Uk(e){return Ok(e,e=>{if(!Fk(e))throw sk.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+rk<Date.now()?(0,a.A)((0,a.A)({},e),{},{authToken:{requestStatus:0}}):e;var n})}function Fk(e){return void 0!==e&&2===e.registrationStatus}async function jk(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Pk(e);t&&await t}(n);return(await Mk(n,t)).token}function Vk(e){return sk.create("missing-app-config-values",{valueName:e})}const Bk="installations",Wk=e=>{const t=VP(e.getProvider("app").getImmediate(),Bk).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Pk(t);return r?r.catch(console.error):Mk(t).catch(console.error),n.fid}(t),getToken:e=>jk(t,e)}};jP(new NO(Bk,e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Vk("App Configuration");if(!e.name)throw Vk("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Vk(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:VP(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),jP(new NO("installations-internal",Wk,"PRIVATE")),GP(tk,nk),GP(tk,nk,"esm2020");const Hk="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Gk="google.c.a.c_id",zk=1e4;var Kk,Yk;function qk(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Xk(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(Kk||(Kk={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Yk||(Yk={}));const Jk="fcm_token_details_db",Zk="fcm_token_object_Store";const Qk="firebase-messaging-store";let $k=null;function eD(){return $k||($k=ZO("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Qk)}})),$k}async function tD(e){const t=rD(e),n=await eD(),r=await n.transaction(Qk).objectStore(Qk).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map(e=>e.name);if(!e.includes(Jk))return null}let t=null;const n=await ZO(Jk,5,{upgrade:async(n,r,i,o)=>{if(r<2)return;if(!n.objectStoreNames.contains(Zk))return;const a=o.objectStore(Zk),s=await a.index("fcmSenderId").get(e);if(await a.clear(),s)if(2===r){var c;const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(c=e.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:qk(e.vapidKey)}}}else if(3===r){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:qk(e.auth),p256dh:qk(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:qk(e.vapidKey)}}}else if(4===r){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:qk(e.auth),p256dh:qk(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:qk(e.vapidKey)}}}}});return n.close(),await QO(Jk),await QO("fcm_vapid_details_db"),await QO("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await nD(e,t),t}}async function nD(e,t){const n=rD(e),r=(await eD()).transaction(Qk,"readwrite");return await r.objectStore(Qk).put(t,n),await r.done,t}function rD(e){let{appConfig:t}=e;return t.appId}const iD=new CO("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function oD(e,t){const n={method:"DELETE",headers:await sD(e)};try{const r=await fetch("".concat(aD(e.appConfig),"/").concat(t),n),i=await r.json();if(i.error){const e=i.error.message;throw iD.create("token-unsubscribe-failed",{errorInfo:e})}}catch(ex){throw iD.create("token-unsubscribe-failed",{errorInfo:null===ex||void 0===ex?void 0:ex.toString()})}}function aD(e){let{projectId:t}=e;return"".concat("https://fcmregistrations.googleapis.com/v1","/projects/").concat(t,"/registrations")}async function sD(e){let{appConfig:t,installations:n}=e;const r=await n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(r)})}function cD(e){let{p256dh:t,auth:n,endpoint:r,vapidKey:i}=e;const o={web:{endpoint:r,auth:n,p256dh:t}};return i!==Hk&&(o.web.applicationPubKey=i),o}async function lD(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Xk(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:qk(t.getKey("auth")),p256dh:qk(t.getKey("p256dh"))},r=await tD(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,o=t.p256dh===e.p256dh;return n&&r&&i&&o}(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await sD(e),r=cD(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{const n=await fetch("".concat(aD(e.appConfig),"/").concat(t.token),i);o=await n.json()}catch(ex){throw iD.create("token-update-failed",{errorInfo:null===ex||void 0===ex?void 0:ex.toString()})}if(o.error){const e=o.error.message;throw iD.create("token-update-failed",{errorInfo:e})}if(!o.token)throw iD.create("token-update-no-token");return o.token}(e.firebaseDependencies,t),r=(0,a.A)((0,a.A)({},t),{},{token:n,createTime:Date.now()});return await nD(e.firebaseDependencies,r),n}catch($D){throw $D}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await oD(e.firebaseDependencies,r.token)}catch($D){console.warn($D)}return dD(e.firebaseDependencies,n)}return dD(e.firebaseDependencies,n)}async function dD(e,t){const n=await async function(e,t){const n=await sD(e),r=cD(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{const t=await fetch(aD(e.appConfig),i);o=await t.json()}catch(ex){throw iD.create("token-subscribe-failed",{errorInfo:null===ex||void 0===ex?void 0:ex.toString()})}if(o.error){const e=o.error.message;throw iD.create("token-subscribe-failed",{errorInfo:e})}if(!o.token)throw iD.create("token-subscribe-no-token");return o.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await nD(e,r),r.token}function uD(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const o=t.notification.icon;o&&(e.notification.icon=o)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,o,a;if(!t.fcmOptions&&(null===(n=t.notification)||void 0===n||!n.click_action))return;e.fcmOptions={};const s=null!==(r=null===(i=t.fcmOptions)||void 0===i?void 0:i.link)&&void 0!==r?r:null===(o=t.notification)||void 0===o?void 0:o.click_action;s&&(e.fcmOptions.link=s);const c=null===(a=t.fcmOptions)||void 0===a?void 0:a.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}(t,e),t}function hD(e){return iD.create("missing-app-config-values",{valueName:e})}!function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));n.join("")}("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class pD{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw hD("App Configuration Object");if(!e.name)throw hD("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw hD(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function mD(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch(()=>{}),await async function(e){return new Promise((t,n)=>{const r=setTimeout(()=>n(new Error("Service worker not registered after ".concat(zk," ms"))),zk),i=e.installing||e.waiting;e.active?(clearTimeout(r),t()):i?i.onstatechange=e=>{var n;"activated"===(null===(n=e.target)||void 0===n?void 0:n.state)&&(i.onstatechange=null,clearTimeout(r),t())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}(e.swRegistration)}catch($D){throw iD.create("failed-service-worker-registration",{browserErrorMessage:null===$D||void 0===$D?void 0:$D.message})}}async function fD(e,t){if(!navigator)throw iD.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw iD.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=Hk)}(e,null===t||void 0===t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await mD(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw iD.create("invalid-sw-registration");e.swRegistration=t}}(e,null===t||void 0===t?void 0:t.serviceWorkerRegistration),lD(e)}async function gD(e,t,n){const r=function(e){switch(e){case Yk.NOTIFICATION_CLICKED:return"notification_open";case Yk.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[Gk],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function _D(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===Yk.PUSH_RECEIVED&&("function"===typeof e.onMessageHandler?e.onMessageHandler(uD(n)):e.onMessageHandler.next(uD(n)));const r=n.data;(function(e){return"object"===typeof e&&!!e&&Gk in e})(r)&&"1"===r["google.c.a.e"]&&await gD(e,n.messageType,r)}const vD="@firebase/messaging",bD="0.12.23",ED=e=>{const t=new pD(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>_D(t,e)),t},yD=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>fD(t,e)}};async function SD(){try{await SO()}catch($D){return!1}return"undefined"!==typeof window&&yO()&&!("undefined"===typeof navigator||!navigator.cookieEnabled)&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}jP(new NO("messaging",ED,"PUBLIC")),jP(new NO("messaging-internal",yD,"PRIVATE")),GP(vD,bD),GP(vD,bD,"esm2020");GP("firebase","12.7.0","app");const TD=HP({apiKey:"AIzaSyCi61pDIUtbi7pvnxfFRNIpi8RjTHpFNxs",authDomain:"consultant-app-24ceb.firebaseapp.com",projectId:"consultant-app-24ceb",storageBucket:"consultant-app-24ceb.firebasestorage.app",messagingSenderId:"465295888006",appId:"1:465295888006:web:ae07e6f6667e0e6f838b07",measurementId:"G-9TD9Q1Q0PJ"}),CD=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DP;const t=LP.get(e);if(!t&&e===DP&&bO())return HP();if(!t)throw BP.create("no-app",{appName:e});return t}();return SD().then(e=>{if(!e)throw iD.create("unsupported-browser")},e=>{throw iD.create("indexed-db-unsupported")}),VP(IO(e),"messaging").getImmediate()}(TD);function wD(){return(0,i.useEffect)(()=>{(async()=>{try{if("granted"!==await Notification.requestPermission())return void console.log("\u274c Notification denied");const e=await async function(e,t){return fD(e=IO(e),t)}(CD,{vapidKey:"BB8E-fAs8w3xZZ3cL_R3jjnTHaNDu4LGcra1NJhX60UG0lxvzBHVzzblrvv7cm6FMaGo_o_r2hbiB1eibrtg1h0"});console.log("\u2705 FCM TOKEN:",e);const t=new URLSearchParams(window.location.search),n=t.get("userId"),r=t.get("shopId");await fetch("".concat("https://test-online-consultation.zend-apps.com","/api/save-fcm-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n,shopId:r,token:e})}),window.opener&&window.opener.postMessage({tokenGenerated:!0},window.location.origin),window.close()}catch(ex){console.log("\u274c FCM ERROR:",ex)}})()},[]),(0,ad.jsx)("div",{style:{padding:30,textAlign:"center"},children:(0,ad.jsx)("div",{className:"page-loader",children:(0,ad.jsxs)("div",{className:"loader-container",children:[(0,ad.jsx)("div",{className:"loader-spinner"}),(0,ad.jsx)("p",{className:"loader-text",children:"Loading "})]})})})}function RD(){return h_()?(0,ad.jsxs)("ui-nav-menu",{children:[(0,ad.jsx)("a",{href:"/",rel:"home",children:"Dashboard  "}),(0,ad.jsx)("a",{href:"/consultant-list",children:"Consultant List"}),(0,ad.jsx)("a",{href:"/pricing",children:"Pricing"}),(0,ad.jsx)("a",{href:"/faq",children:"FAQ"})]}):(console.warn("\u26a0\ufe0f AdminMenu: App Bridge not initialized, NavMenu will not render"),null)}function AD(){const e=new URLSearchParams(window.location.search).get("shop");console.log("shop",e);h_();(0,i.useEffect)(()=>{const e=e=>{e.data&&e.data.type&&"SHOW_TOAST"===e.data.type&&(console.log("REAL MESSAGE FROM IFRAME:",e.data),fetch("http://YOUR_BACKEND_DOMAIN:3000/logMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.data)}).catch(console.error))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[]);const t=new URLSearchParams(window.location.search);console.log("location",t);const n=()=>{window.parent&&window.parent.postMessage({type:"AGORA_IFRAME_HEIGHT",height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},"*")};return(0,i.useEffect)(()=>{n();const e=new ResizeObserver(()=>{n()});return e.observe(document.body),()=>e.disconnect()},[t]),(0,ad.jsx)(i.Fragment,{children:(0,ad.jsxs)(pt,{children:[(0,ad.jsx)(YN,{}),(0,ad.jsx)(YI,{}),(0,ad.jsxs)(De,{children:[(0,ad.jsxs)(Pe,{element:(0,ad.jsx)(cd,{}),children:[(0,ad.jsx)(Pe,{index:!0,element:(0,ad.jsx)(zE,{})}),(0,ad.jsx)(Pe,{path:"dashboard",element:(0,ad.jsx)(zE,{})}),(0,ad.jsx)(Pe,{path:"consultant-list",element:(0,ad.jsx)(pT,{})}),(0,ad.jsx)(Pe,{path:"add-consultant",element:(0,ad.jsx)(FT,{})}),(0,ad.jsx)(Pe,{path:"pricing",element:(0,ad.jsx)(VT,{})}),(0,ad.jsx)(Pe,{path:"admin-settings",element:(0,ad.jsx)(dO,{})}),(0,ad.jsx)(Pe,{path:"admin-settings/voucher",element:(0,ad.jsx)(uO,{})}),(0,ad.jsx)(Pe,{path:"faq",element:(0,ad.jsx)(BT,{})})]}),(0,ad.jsx)(Pe,{path:"/consultant-cards",element:(0,ad.jsx)(xw,{})}),(0,ad.jsx)(Pe,{path:"/view-profile",element:(0,ad.jsx)(Lw,{})}),(0,ad.jsx)(Pe,{path:"/consultant-dashboard/*",element:(0,ad.jsx)(qI,{})}),(0,ad.jsx)(Pe,{path:"/users-page/*",element:(0,ad.jsx)(qI,{})}),(0,ad.jsx)(Pe,{path:"/consulant-chats/*",element:(0,ad.jsx)(qI,{})}),(0,ad.jsx)(Pe,{path:"/video/calling/page",element:(0,ad.jsx)(KI,{})}),(0,ad.jsx)(Pe,{path:"/chats",element:(0,ad.jsx)(RN,{})}),(0,ad.jsx)(Pe,{path:"/login",element:(0,ad.jsx)(zN,{})}),(0,ad.jsx)(Pe,{path:"/fcm-token",element:(0,ad.jsx)(wD,{})}),(0,ad.jsxs)(Pe,{path:"/profile",element:(0,ad.jsx)(XN,{}),children:[(0,ad.jsx)(Pe,{index:!0,element:(0,ad.jsx)(cO,{})}),(0,ad.jsx)(Pe,{path:"voucher",element:(0,ad.jsx)(cO,{})}),(0,ad.jsx)(Pe,{path:"history",element:(0,ad.jsx)(lO,{})})]})]})]})})}const ID="data-lock-scrolling",ND="data-lock-scrolling-hidden",OD="data-lock-scrolling-wrapper";let PD=0;class kD{constructor(){this.scrollLocks=0,this.locked=!1}registerScrollLock(){this.scrollLocks+=1,this.handleScrollLocking()}unregisterScrollLock(){this.scrollLocks-=1,this.handleScrollLocking()}handleScrollLocking(){if(Vi)return;const{scrollLocks:e}=this,{body:t}=document,n=t.firstElementChild;0===e?(t.removeAttribute(ID),t.removeAttribute(ND),n&&n.removeAttribute(OD),window.scroll(0,PD),this.locked=!1):e>0&&!this.locked&&(PD=window.pageYOffset,t.setAttribute(ID,""),function(){const{body:e}=document;return e.scrollHeight>e.clientHeight}()||t.setAttribute(ND,""),n&&(n.setAttribute(OD,""),n.scrollTop=PD),this.locked=!0)}resetScrollPosition(){PD=0}}const DD=/\[(.*?)\]|(\w+)/g;function xD(e,t,n){if(null==e)return;const r=Array.isArray(t)?t:function(e){const t=[];let n;for(;n=DD.exec(e);){const[,e,r]=n;t.push(e||r)}return t}(t);let i=e;for(let o=0;o<r.length;o++){const e=i[r[o]];if(void 0===e)return n;i=e}return i}function LD(e,t){const n=Array.isArray(e)?[...e]:(0,a.A)({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(MD(t[r])&&MD(n[r])?n[r]=LD(n[r],t[r]):n[r]=t[r]);return n}function MD(e){return null!==e&&"object"===typeof e}const UD=/{([^}]*)}/g;class FD{constructor(e){this.translation={},this.translation=Array.isArray(e)?function(){let e={};for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=LD(e,i);return e}(...e.slice().reverse()):e}translate(e,t){const n=xD(this.translation,e,"");return n?t?n.replace(UD,n=>{const r=n.substring(1,n.length-1);if(void 0===t[r]){const n=JSON.stringify(t);throw new Error("Error in translation for key '".concat(e,"'. No replacement found for key '").concat(r,"'. The following replacements were passed: '").concat(n,"'"))}return t[r]}):n:""}translationKeyExists(e){return Boolean(xD(this.translation,e))}}const jD=(0,i.createContext)(void 0),VD=function(e){let{children:t}=e;const[n,r]=(0,i.useState)(Ki().matches),o=(0,i.useCallback)(aa(()=>{n!==Ki().matches&&r(!n)},40,{trailing:!0,leading:!0,maxWait:40}),[n]);(0,i.useEffect)(()=>{r(Ki().matches)},[]);const a=(0,i.useMemo)(()=>({isNavigationCollapsed:n}),[n]);return i.createElement(qd.Provider,{value:a},i.createElement(Aa,{event:"resize",handler:o}),t)};function BD(e,t){return i.createElement("div",{id:"PolarisPortalsContainer",ref:t})}const WD=(0,i.forwardRef)(BD);function HD(e){let{children:t,container:n}=e;const r=ca(),o=(0,i.useRef)(null),a=(0,i.useMemo)(()=>n?{container:n}:r?{container:o.current}:{container:null},[n,r]);return i.createElement(wa.Provider,{value:a},t,n?null:i.createElement(WD,{ref:o}))}function GD(e){let{children:t}=e;const[n,r]=(0,i.useState)([]),o=(0,i.useCallback)(e=>{r(t=>[...t,e])},[]),a=(0,i.useCallback)(e=>{let t=!0;return r(n=>{const r=[...n],i=r.indexOf(e);return-1===i?t=!1:r.splice(i,1),r}),t},[]),s=(0,i.useMemo)(()=>({trapFocusList:n,add:o,remove:a}),[o,n,a]);return i.createElement(Ol.Provider,{value:s},t)}const zD={tooltip:0,hovercard:0};function KD(e){let{children:t}=e;const[n,r]=(0,i.useState)(zD),o=(0,i.useCallback)(e=>{r(t=>(0,a.A)((0,a.A)({},t),{},{[e]:t[e]+1}))},[]),s=(0,i.useCallback)(e=>{r(t=>(0,a.A)((0,a.A)({},t),{},{[e]:t[e]-1}))},[]),c=(0,i.useMemo)(()=>({presenceList:Object.entries(n).reduce((e,t)=>{const[n,r]=t;return(0,a.A)((0,a.A)({},e),{},{[n]:r>=1})},{}),presenceCounter:n,addPresence:o,removePresence:s}),[o,s,n]);return i.createElement(ks.Provider,{value:c},t)}class YD extends i.Component{constructor(e){super(e),this.setBodyStyles=()=>{document.body.style.backgroundColor="var(--p-color-bg)",document.body.style.color="var(--p-color-text)"},this.setRootAttributes=()=>{const e=this.getThemeName();jr.forEach(t=>{document.documentElement.classList.toggle(Lr(t),t===e)})},this.getThemeName=()=>{var e;return null!==(e=this.props.theme)&&void 0!==e?e:Fr},this.stickyManager=new fa,this.scrollLockManager=new kD;const{i18n:t,linkComponent:n}=this.props;this.state={link:n,intl:new FD(t)}}componentDidMount(){if(null!=document){this.stickyManager.setContainer(document),this.setBodyStyles(),this.setRootAttributes();const e=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&(navigator.userAgent.includes("Version/16.1")||navigator.userAgent.includes("Version/16.2")||navigator.userAgent.includes("Version/16.3")),t=navigator.userAgent.includes("Shopify Mobile/iOS")&&(navigator.userAgent.includes("OS 16_1")||navigator.userAgent.includes("OS 16_2")||navigator.userAgent.includes("OS 16_3"));(e||t)&&document.documentElement.classList.add("Polaris-Safari-16-Font-Optical-Sizing-Patch")}!function(){var e,t;const n=document.createElement("div");n.setAttribute("style","position: absolute; opacity: 0; transform: translate3d(-9999px, -9999px, 0); pointer-events: none; width:".concat(30,"px; height:").concat(30,"px;"));const r=document.createElement("div");r.setAttribute("style","width:100%; height: ".concat(40,"; overflow:scroll; scrollbar-width: thin;")),n.appendChild(r),document.body.appendChild(n);const i=30-(null!==(e=null===(t=n.firstElementChild)||void 0===t?void 0:t.clientWidth)&&void 0!==e?e:0),o=Math.min(i,20);document.documentElement.style.setProperty("--pc-app-provider-scrollbar-width","".concat(o,"px")),document.body.removeChild(n)}()}componentDidUpdate(e){let{i18n:t,linkComponent:n}=e;const{i18n:r,linkComponent:i}=this.props;this.setRootAttributes(),r===t&&i===n||this.setState({link:i,intl:new FD(r)})}render(){const{children:e,features:t}=this.props,n=this.getThemeName(),{intl:r,link:o}=this.state;return i.createElement(Ga.Provider,{value:n},i.createElement(Ha.Provider,{value:za(n)},i.createElement(jD.Provider,{value:t},i.createElement(Fi.Provider,{value:r},i.createElement(wi.Provider,{value:this.scrollLockManager},i.createElement(va.Provider,{value:this.stickyManager},i.createElement(bo.Provider,{value:o},i.createElement(VD,null,i.createElement(HD,null,i.createElement(GD,null,i.createElement(KD,null,e)))))))))))}}const qD=JSON.parse('{"Polaris":{"ActionMenu":{"Actions":{"moreActions":"More actions"},"RollupActions":{"rollupButton":"View actions"}},"ActionList":{"SearchField":{"clearButtonLabel":"Clear","search":"Search","placeholder":"Search actions"}},"Avatar":{"label":"Avatar","labelWithInitials":"Avatar with initials {initials}"},"Autocomplete":{"spinnerAccessibilityLabel":"Loading","ellipsis":"{content}\u2026"},"Badge":{"PROGRESS_LABELS":{"incomplete":"Incomplete","partiallyComplete":"Partially complete","complete":"Complete"},"TONE_LABELS":{"info":"Info","success":"Success","warning":"Warning","critical":"Critical","attention":"Attention","new":"New","readOnly":"Read-only","enabled":"Enabled"},"progressAndTone":"{toneLabel} {progressLabel}"},"Banner":{"dismissButton":"Dismiss notification"},"Button":{"spinnerAccessibilityLabel":"Loading"},"Common":{"checkbox":"checkbox","undo":"Undo","cancel":"Cancel","clear":"Clear","close":"Close","submit":"Submit","more":"More"},"ContextualSaveBar":{"save":"Save","discard":"Discard"},"DataTable":{"sortAccessibilityLabel":"sort {direction} by","navAccessibilityLabel":"Scroll table {direction} one column","totalsRowHeading":"Totals","totalRowHeading":"Total"},"DatePicker":{"previousMonth":"Show previous month, {previousMonthName} {showPreviousYear}","nextMonth":"Show next month, {nextMonth} {nextYear}","today":"Today ","start":"Start of range","end":"End of range","months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"days":{"monday":"Monday","tuesday":"Tuesday","wednesday":"Wednesday","thursday":"Thursday","friday":"Friday","saturday":"Saturday","sunday":"Sunday"},"daysAbbreviated":{"monday":"Mo","tuesday":"Tu","wednesday":"We","thursday":"Th","friday":"Fr","saturday":"Sa","sunday":"Su"}},"DiscardConfirmationModal":{"title":"Discard all unsaved changes","message":"If you discard changes, you\u2019ll delete any edits you made since you last saved.","primaryAction":"Discard changes","secondaryAction":"Continue editing"},"DropZone":{"single":{"overlayTextFile":"Drop file to upload","overlayTextImage":"Drop image to upload","overlayTextVideo":"Drop video to upload","actionTitleFile":"Add file","actionTitleImage":"Add image","actionTitleVideo":"Add video","actionHintFile":"or drop file to upload","actionHintImage":"or drop image to upload","actionHintVideo":"or drop video to upload","labelFile":"Upload file","labelImage":"Upload image","labelVideo":"Upload video"},"allowMultiple":{"overlayTextFile":"Drop files to upload","overlayTextImage":"Drop images to upload","overlayTextVideo":"Drop videos to upload","actionTitleFile":"Add files","actionTitleImage":"Add images","actionTitleVideo":"Add videos","actionHintFile":"or drop files to upload","actionHintImage":"or drop images to upload","actionHintVideo":"or drop videos to upload","labelFile":"Upload files","labelImage":"Upload images","labelVideo":"Upload videos"},"errorOverlayTextFile":"File type is not valid","errorOverlayTextImage":"Image type is not valid","errorOverlayTextVideo":"Video type is not valid"},"EmptySearchResult":{"altText":"Empty search results"},"Frame":{"skipToContent":"Skip to content","navigationLabel":"Navigation","Navigation":{"closeMobileNavigationLabel":"Close navigation"}},"FullscreenBar":{"back":"Back","accessibilityLabel":"Exit fullscreen mode"},"Filters":{"moreFilters":"More filters","moreFiltersWithCount":"More filters ({count})","filter":"Filter {resourceName}","noFiltersApplied":"No filters applied","cancel":"Cancel","done":"Done","clearAllFilters":"Clear all filters","clear":"Clear","clearLabel":"Clear {filterName}","addFilter":"Add filter","clearFilters":"Clear all","searchInView":"in:{viewName}"},"FilterPill":{"clear":"Clear","unsavedChanges":"Unsaved changes - {label}"},"IndexFilters":{"searchFilterTooltip":"Search and filter","searchFilterTooltipWithShortcut":"Search and filter (F)","searchFilterAccessibilityLabel":"Search and filter results","sort":"Sort your results","addView":"Add a new view","newView":"Custom search","SortButton":{"ariaLabel":"Sort the results","tooltip":"Sort","title":"Sort by","sorting":{"asc":"Ascending","desc":"Descending","az":"A-Z","za":"Z-A"}},"EditColumnsButton":{"tooltip":"Edit columns","accessibilityLabel":"Customize table column order and visibility"},"UpdateButtons":{"cancel":"Cancel","update":"Update","save":"Save","saveAs":"Save as","modal":{"title":"Save view as","label":"Name","sameName":"A view with this name already exists. Please choose a different name.","save":"Save","cancel":"Cancel"}}},"IndexProvider":{"defaultItemSingular":"Item","defaultItemPlural":"Items","allItemsSelected":"All {itemsLength}+ {resourceNamePlural} are selected","selected":"{selectedItemsCount} selected","a11yCheckboxDeselectAllSingle":"Deselect {resourceNameSingular}","a11yCheckboxSelectAllSingle":"Select {resourceNameSingular}","a11yCheckboxDeselectAllMultiple":"Deselect all {itemsLength} {resourceNamePlural}","a11yCheckboxSelectAllMultiple":"Select all {itemsLength} {resourceNamePlural}"},"IndexTable":{"emptySearchTitle":"No {resourceNamePlural} found","emptySearchDescription":"Try changing the filters or search term","onboardingBadgeText":"New","resourceLoadingAccessibilityLabel":"Loading {resourceNamePlural}\u2026","selectAllLabel":"Select all {resourceNamePlural}","selected":"{selectedItemsCount} selected","undo":"Undo","selectAllItems":"Select all {itemsLength}+ {resourceNamePlural}","selectItem":"Select {resourceName}","selectButtonText":"Select","sortAccessibilityLabel":"sort {direction} by"},"Loading":{"label":"Page loading bar"},"Modal":{"iFrameTitle":"body markup","modalWarning":"These required properties are missing from Modal: {missingProps}"},"Page":{"Header":{"rollupActionsLabel":"View actions for {title}","pageReadyAccessibilityLabel":"{title}. This page is ready"}},"Pagination":{"previous":"Previous","next":"Next","pagination":"Pagination"},"ProgressBar":{"negativeWarningMessage":"Values passed to the progress prop shouldn\u2019t be negative. Resetting {progress} to 0.","exceedWarningMessage":"Values passed to the progress prop shouldn\u2019t exceed 100. Setting {progress} to 100."},"ResourceList":{"sortingLabel":"Sort by","defaultItemSingular":"item","defaultItemPlural":"items","showing":"Showing {itemsCount} {resource}","showingTotalCount":"Showing {itemsCount} of {totalItemsCount} {resource}","loading":"Loading {resource}","selected":"{selectedItemsCount} selected","allItemsSelected":"All {itemsLength}+ {resourceNamePlural} in your store are selected","allFilteredItemsSelected":"All {itemsLength}+ {resourceNamePlural} in this filter are selected","selectAllItems":"Select all {itemsLength}+ {resourceNamePlural} in your store","selectAllFilteredItems":"Select all {itemsLength}+ {resourceNamePlural} in this filter","emptySearchResultTitle":"No {resourceNamePlural} found","emptySearchResultDescription":"Try changing the filters or search term","selectButtonText":"Select","a11yCheckboxDeselectAllSingle":"Deselect {resourceNameSingular}","a11yCheckboxSelectAllSingle":"Select {resourceNameSingular}","a11yCheckboxDeselectAllMultiple":"Deselect all {itemsLength} {resourceNamePlural}","a11yCheckboxSelectAllMultiple":"Select all {itemsLength} {resourceNamePlural}","Item":{"actionsDropdownLabel":"Actions for {accessibilityLabel}","actionsDropdown":"Actions dropdown","viewItem":"View details for {itemName}"},"BulkActions":{"actionsActivatorLabel":"Actions","moreActionsActivatorLabel":"More actions"}},"SkeletonPage":{"loadingLabel":"Page loading"},"Tabs":{"newViewAccessibilityLabel":"Create new view","newViewTooltip":"Create view","toggleTabsLabel":"More views","Tab":{"rename":"Rename view","duplicate":"Duplicate view","edit":"Edit view","editColumns":"Edit columns","delete":"Delete view","copy":"Copy of {name}","deleteModal":{"title":"Delete view?","description":"This can\u2019t be undone. {viewName} view will no longer be available in your admin.","cancel":"Cancel","delete":"Delete view"}},"RenameModal":{"title":"Rename view","label":"Name","cancel":"Cancel","create":"Save","errors":{"sameName":"A view with this name already exists. Please choose a different name."}},"DuplicateModal":{"title":"Duplicate view","label":"Name","cancel":"Cancel","create":"Create view","errors":{"sameName":"A view with this name already exists. Please choose a different name."}},"CreateViewModal":{"title":"Create new view","label":"Name","cancel":"Cancel","create":"Create view","errors":{"sameName":"A view with this name already exists. Please choose a different name."}}},"Tag":{"ariaLabel":"Remove {children}"},"TextField":{"characterCount":"{count} characters","characterCountWithMaxLength":"{count} of {limit} characters used"},"TooltipOverlay":{"accessibilityLabel":"Tooltip: {label}"},"TopBar":{"toggleMenuLabel":"Toggle menu","SearchField":{"clearButtonLabel":"Clear","search":"Search"}},"MediaCard":{"dismissButton":"Dismiss","popoverButton":"Actions"},"VideoThumbnail":{"playButtonA11yLabel":{"default":"Play video","defaultWithDuration":"Play video of length {duration}","duration":{"hours":{"other":{"only":"{hourCount} hours","andMinutes":"{hourCount} hours and {minuteCount} minutes","andMinute":"{hourCount} hours and {minuteCount} minute","minutesAndSeconds":"{hourCount} hours, {minuteCount} minutes, and {secondCount} seconds","minutesAndSecond":"{hourCount} hours, {minuteCount} minutes, and {secondCount} second","minuteAndSeconds":"{hourCount} hours, {minuteCount} minute, and {secondCount} seconds","minuteAndSecond":"{hourCount} hours, {minuteCount} minute, and {secondCount} second","andSeconds":"{hourCount} hours and {secondCount} seconds","andSecond":"{hourCount} hours and {secondCount} second"},"one":{"only":"{hourCount} hour","andMinutes":"{hourCount} hour and {minuteCount} minutes","andMinute":"{hourCount} hour and {minuteCount} minute","minutesAndSeconds":"{hourCount} hour, {minuteCount} minutes, and {secondCount} seconds","minutesAndSecond":"{hourCount} hour, {minuteCount} minutes, and {secondCount} second","minuteAndSeconds":"{hourCount} hour, {minuteCount} minute, and {secondCount} seconds","minuteAndSecond":"{hourCount} hour, {minuteCount} minute, and {secondCount} second","andSeconds":"{hourCount} hour and {secondCount} seconds","andSecond":"{hourCount} hour and {secondCount} second"}},"minutes":{"other":{"only":"{minuteCount} minutes","andSeconds":"{minuteCount} minutes and {secondCount} seconds","andSecond":"{minuteCount} minutes and {secondCount} second"},"one":{"only":"{minuteCount} minute","andSeconds":"{minuteCount} minute and {secondCount} seconds","andSecond":"{minuteCount} minute and {secondCount} second"}},"seconds":{"other":"{secondCount} seconds","one":"{secondCount} second"}}}}}}'),XD=(0,ov.U1)({reducer:{users:OE,consultants:ME,socket:iC,call:HI.Ay,userBalance:OE}});function JD(e){let{children:t}=e;const n=tv();return(0,i.useEffect)(()=>{const e=Nw(),t=localStorage.getItem("client_u_Identity"),r=()=>{console.log("\u2705 ____Socket connected"),e.emit("register",t),n(HT(!0))},i=()=>{console.log("\u274c Socket disconnected"),n(HT(!1))};return e.connected||e.connect(),e.on("connect",r),e.on("disconnect",i),e.on("activeUsers",e=>n(GT(e))),e.on("receiveMessage",e=>n(zT(e))),e.on("seenUpdate",e=>n(KT(e))),e.on("balanceError",e=>n(YT(e))),e.on("userChatAccepted",e=>n(qT(e.message))),e.on("chatTimerStarted",e=>n(XT(e))),e.on("chatEnded",()=>n(JT())),e.on("autoChatEnded",e=>n(ZT(e))),e.on("incoming-call",e=>n(QT(e))),e.on("call-accepted-started",e=>n($T(e))),e.on("call-missed",e=>n(eC(e))),e.on("call-ended-rejected",e=>n(tC(e))),()=>{console.log("\ud83e\uddf9 Cleaning socket listeners"),e.off("connect",r),e.off("disconnect",i),e.off("activeUsers"),e.off("receiveMessage"),e.off("seenUpdate"),e.off("balanceError"),e.off("userChatAccepted"),e.off("chatTimerStarted"),e.off("chatEnded"),e.off("autoChatEnded"),e.off("incoming-call"),e.off("call-accepted-started"),e.off("call-missed"),e.off("call-ended-rejected")}},[n]),t}class ZD extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t)}render(){return this.state.hasError?(0,ad.jsx)("div",{className:"page-loader",children:(0,ad.jsxs)("div",{className:"loader-container",children:[(0,ad.jsx)("div",{className:"loader-spinner"}),(0,ad.jsx)("p",{className:"loader-text",children:"Loading..."})]})}):this.props.children}}const QD=ZD;"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js").then(e=>console.log("Service worker registered:",e.scope)).catch(e=>console.error("SW registration failed:",e));r.createRoot(document.getElementById("root")).render((0,ad.jsx)(QD,{children:(0,ad.jsxs)(p_,{children:[(0,ad.jsx)(RD,{}),(0,ad.jsx)(YD,{i18n:qD,children:(0,ad.jsx)(X_,{store:XD,children:(0,ad.jsx)(JD,{children:(0,ad.jsx)(AD,{})})})})]})}))})()})();
//# sourceMappingURL=main.09565c50.js.map